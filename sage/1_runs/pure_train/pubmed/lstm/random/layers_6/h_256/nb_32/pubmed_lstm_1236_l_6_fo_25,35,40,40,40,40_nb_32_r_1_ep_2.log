main start at this time 1648534171.866259
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0011265277862548828
random selection method range initialization spend 0.0002052783966064453
time for parepare:  5.626678466796875e-05
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0017757415771484375
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  2.8371810913085938e-05
----------------------check_connections_block total spend ----------------------------- 0.0049746036529541016
generate_one_block  0.001445770263671875
generate_one_block  0.0012316703796386719
generate_one_block  0.0012822151184082031
generate_one_block  0.001232147216796875
generate_one_block  0.0012149810791015625
generate_one_block  0.0012319087982177734
generate_one_block  0.0011456012725830078
generate_one_block  0.000978231430053711
generate_one_block  0.000942230224609375
generate_one_block  0.0009417533874511719
generate_one_block  0.0010724067687988281
generate_one_block  0.0009474754333496094
generate_one_block  0.0009500980377197266
generate_one_block  0.0009417533874511719
generate_one_block  0.0009515285491943359
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007865428924560547
gen group dst list time:  0.00010371208190917969
time for parepare:  0.0003399848937988281
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  8.463859558105469e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  6.508827209472656e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  8.153915405273438e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0002541542053222656
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  8.487701416015625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  8.463859558105469e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00011682510375976562
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.749961853027344e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00019216537475585938
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00028252601623535156
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00010251998901367188
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00016736984252929688
----------------------check_connections_block total spend ----------------------------- 0.005532979965209961
generate_one_block  0.0013396739959716797
generate_one_block  0.0013430118560791016
generate_one_block  0.0013091564178466797
generate_one_block  0.0015671253204345703
generate_one_block  0.0012857913970947266
generate_one_block  0.0013108253479003906
generate_one_block  0.001112222671508789
generate_one_block  0.0010924339294433594
generate_one_block  0.0011277198791503906
generate_one_block  0.0010023117065429688
generate_one_block  0.0010170936584472656
generate_one_block  0.001264333724975586
generate_one_block  0.0012099742889404297
generate_one_block  0.0010268688201904297
generate_one_block  0.0011241436004638672
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011968612670898438
gen group dst list time:  0.00016045570373535156
time for parepare:  0.0009338855743408203
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00026869773864746094
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0002732276916503906
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0003421306610107422
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00034880638122558594
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.0002560615539550781
r_  generation:  0.0018877983093261719
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.00032329559326171875
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0004487037658691406
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0003895759582519531
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.000293731689453125
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0005590915679931641
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0002186298370361328
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0003466606140136719
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  0.00011706352233886719
r_  generation:  0.0012903213500976562
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.00020003318786621094
r_  generation:  0.0017006397247314453
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  0.0001068115234375
r_  generation:  0.0007197856903076172
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.0008146762847900391
----------------------check_connections_block total spend ----------------------------- 0.017925024032592773
generate_one_block  0.0014204978942871094
generate_one_block  0.0013742446899414062
generate_one_block  0.0012965202331542969
generate_one_block  0.0028600692749023438
generate_one_block  0.0013213157653808594
generate_one_block  0.0014362335205078125
generate_one_block  0.0013742446899414062
generate_one_block  0.0012743473052978516
generate_one_block  0.0018918514251708984
generate_one_block  0.0011937618255615234
generate_one_block  0.0012979507446289062
generate_one_block  0.0024263858795166016
generate_one_block  0.002828359603881836
generate_one_block  0.0017421245574951172
generate_one_block  0.0017817020416259766
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002017498016357422
gen group dst list time:  0.0003223419189453125
time for parepare:  0.0017633438110351562
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0003986358642578125
mini_batch_src_global generation:  0.00012135505676269531
r_  generation:  0.0008919239044189453
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  0.00026106834411621094
r_  generation:  0.0020155906677246094
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.0014801025390625
local_output_nid generation:  0.0001747608184814453
local_in_edges_tensor generation:  0.00043463706970214844
mini_batch_src_global generation:  0.0008268356323242188
r_  generation:  0.007141828536987305
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  0.0003046989440917969
r_  generation:  0.0018012523651123047
local_output_nid generation:  7.700920104980469e-05
local_in_edges_tensor generation:  0.0002455711364746094
mini_batch_src_global generation:  0.0002446174621582031
r_  generation:  0.0024008750915527344
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.0020935535430908203
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  0.00017118453979492188
r_  generation:  0.001340627670288086
local_output_nid generation:  7.414817810058594e-05
local_in_edges_tensor generation:  0.00023508071899414062
mini_batch_src_global generation:  0.00027823448181152344
r_  generation:  0.0030493736267089844
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  0.0002276897430419922
r_  generation:  0.0017507076263427734
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  0.00020432472229003906
r_  generation:  0.0019195079803466797
local_output_nid generation:  0.00017976760864257812
local_in_edges_tensor generation:  0.00041031837463378906
mini_batch_src_global generation:  0.0006985664367675781
r_  generation:  0.00720977783203125
local_output_nid generation:  0.00014853477478027344
local_in_edges_tensor generation:  0.00035691261291503906
mini_batch_src_global generation:  0.0008094310760498047
r_  generation:  0.0063169002532958984
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.00029659271240234375
mini_batch_src_global generation:  0.0004475116729736328
r_  generation:  0.004074811935424805
local_output_nid generation:  0.00011539459228515625
local_in_edges_tensor generation:  0.0002753734588623047
mini_batch_src_global generation:  0.0003490447998046875
r_  generation:  0.0033686161041259766
----------------------check_connections_block total spend ----------------------------- 0.07167744636535645
generate_one_block  0.002321958541870117
generate_one_block  0.003481149673461914
generate_one_block  0.002961874008178711
generate_one_block  0.009625434875488281
generate_one_block  0.0028829574584960938
generate_one_block  0.0041348934173583984
generate_one_block  0.003845691680908203
generate_one_block  0.002635955810546875
generate_one_block  0.004996061325073242
generate_one_block  0.00339508056640625
generate_one_block  0.0035371780395507812
generate_one_block  0.010783910751342773
generate_one_block  0.009555339813232422
generate_one_block  0.006224632263183594
generate_one_block  0.005226612091064453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020699501037597656
gen group dst list time:  0.0017061233520507812
time for parepare:  0.0018489360809326172
local_output_nid generation:  0.00018596649169921875
local_in_edges_tensor generation:  0.0007681846618652344
mini_batch_src_global generation:  0.0004334449768066406
r_  generation:  0.003987312316894531
local_output_nid generation:  0.0003597736358642578
local_in_edges_tensor generation:  0.0006258487701416016
mini_batch_src_global generation:  0.0010488033294677734
r_  generation:  0.008673667907714844
local_output_nid generation:  0.0002722740173339844
local_in_edges_tensor generation:  0.0005142688751220703
mini_batch_src_global generation:  0.0008609294891357422
r_  generation:  0.0069446563720703125
local_output_nid generation:  0.0006561279296875
local_in_edges_tensor generation:  0.001018524169921875
mini_batch_src_global generation:  0.0014657974243164062
r_  generation:  0.01613306999206543
local_output_nid generation:  0.0002949237823486328
local_in_edges_tensor generation:  0.0004849433898925781
mini_batch_src_global generation:  0.0007638931274414062
r_  generation:  0.006345987319946289
local_output_nid generation:  0.00041866302490234375
local_in_edges_tensor generation:  0.0006847381591796875
mini_batch_src_global generation:  0.0008757114410400391
r_  generation:  0.010692358016967773
local_output_nid generation:  0.00044536590576171875
local_in_edges_tensor generation:  0.0006728172302246094
mini_batch_src_global generation:  0.0008695125579833984
r_  generation:  0.00852346420288086
local_output_nid generation:  0.00023245811462402344
local_in_edges_tensor generation:  0.0003848075866699219
mini_batch_src_global generation:  0.0005333423614501953
r_  generation:  0.004929304122924805
local_output_nid generation:  0.0003361701965332031
local_in_edges_tensor generation:  0.0005521774291992188
mini_batch_src_global generation:  0.0007994174957275391
r_  generation:  0.00992131233215332
local_output_nid generation:  0.00034880638122558594
local_in_edges_tensor generation:  0.0006096363067626953
mini_batch_src_global generation:  0.0009331703186035156
r_  generation:  0.009298563003540039
local_output_nid generation:  0.000324249267578125
local_in_edges_tensor generation:  0.0005581378936767578
mini_batch_src_global generation:  0.0008199214935302734
r_  generation:  0.008578062057495117
local_output_nid generation:  0.0007340908050537109
local_in_edges_tensor generation:  0.0026330947875976562
mini_batch_src_global generation:  0.0017647743225097656
r_  generation:  0.01971435546875
local_output_nid generation:  0.0007026195526123047
local_in_edges_tensor generation:  0.0011334419250488281
mini_batch_src_global generation:  0.0015292167663574219
r_  generation:  0.01660466194152832
local_output_nid generation:  0.0006308555603027344
local_in_edges_tensor generation:  0.0009291172027587891
mini_batch_src_global generation:  0.001440286636352539
r_  generation:  0.015287160873413086
local_output_nid generation:  0.0005159378051757812
local_in_edges_tensor generation:  0.0007846355438232422
mini_batch_src_global generation:  0.0010509490966796875
r_  generation:  0.011311531066894531
----------------------check_connections_block total spend ----------------------------- 0.2302248477935791
generate_one_block  0.006281137466430664
generate_one_block  0.011449575424194336
generate_one_block  0.010271787643432617
generate_one_block  0.01980423927307129
generate_one_block  0.00999593734741211
generate_one_block  0.014785289764404297
generate_one_block  0.012630224227905273
generate_one_block  0.007242918014526367
generate_one_block  0.01260519027709961
generate_one_block  0.013633251190185547
generate_one_block  0.012438535690307617
generate_one_block  0.02410721778869629
generate_one_block  0.022845745086669922
generate_one_block  0.020154953002929688
generate_one_block  0.014575958251953125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018391609191894531
gen group dst list time:  0.0043926239013671875
time for parepare:  0.001771688461303711
local_output_nid generation:  0.0005970001220703125
local_in_edges_tensor generation:  0.001264810562133789
mini_batch_src_global generation:  0.0011627674102783203
r_  generation:  0.012287616729736328
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.0017995834350585938
mini_batch_src_global generation:  0.0022363662719726562
r_  generation:  0.01850414276123047
local_output_nid generation:  0.0010271072387695312
local_in_edges_tensor generation:  0.0013842582702636719
mini_batch_src_global generation:  0.001682281494140625
r_  generation:  0.01892566680908203
local_output_nid generation:  0.0013079643249511719
local_in_edges_tensor generation:  0.0019338130950927734
mini_batch_src_global generation:  0.002015829086303711
r_  generation:  0.022632598876953125
local_output_nid generation:  0.0009281635284423828
local_in_edges_tensor generation:  0.001180410385131836
mini_batch_src_global generation:  0.001432180404663086
r_  generation:  0.01761341094970703
local_output_nid generation:  0.0010869503021240234
local_in_edges_tensor generation:  0.0015482902526855469
mini_batch_src_global generation:  0.001668691635131836
r_  generation:  0.019861459732055664
local_output_nid generation:  0.0009562969207763672
local_in_edges_tensor generation:  0.0014503002166748047
mini_batch_src_global generation:  0.0015740394592285156
r_  generation:  0.019456863403320312
local_output_nid generation:  0.0006701946258544922
local_in_edges_tensor generation:  0.0009243488311767578
mini_batch_src_global generation:  0.0012247562408447266
r_  generation:  0.013062238693237305
local_output_nid generation:  0.0009045600891113281
local_in_edges_tensor generation:  0.0012924671173095703
mini_batch_src_global generation:  0.0013191699981689453
r_  generation:  0.017559528350830078
local_output_nid generation:  0.0009427070617675781
local_in_edges_tensor generation:  0.0018525123596191406
mini_batch_src_global generation:  0.001688241958618164
r_  generation:  0.019205808639526367
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0012454986572265625
mini_batch_src_global generation:  0.001500844955444336
r_  generation:  0.018333911895751953
local_output_nid generation:  0.0013153553009033203
local_in_edges_tensor generation:  0.0021021366119384766
mini_batch_src_global generation:  0.0021038055419921875
r_  generation:  0.0246279239654541
local_output_nid generation:  0.0013403892517089844
local_in_edges_tensor generation:  0.0022459030151367188
mini_batch_src_global generation:  0.0019004344940185547
r_  generation:  0.023029565811157227
local_output_nid generation:  0.0015094280242919922
local_in_edges_tensor generation:  0.0020389556884765625
mini_batch_src_global generation:  0.0021467208862304688
r_  generation:  0.0240325927734375
local_output_nid generation:  0.0012121200561523438
local_in_edges_tensor generation:  0.0015311241149902344
mini_batch_src_global generation:  0.0016491413116455078
r_  generation:  0.019990921020507812
----------------------check_connections_block total spend ----------------------------- 0.4192192554473877
generate_one_block  0.015718460083007812
generate_one_block  0.025154829025268555
generate_one_block  0.024945497512817383
generate_one_block  0.028128862380981445
generate_one_block  0.021974802017211914
generate_one_block  0.02523064613342285
generate_one_block  0.025119304656982422
generate_one_block  0.01708197593688965
generate_one_block  0.02247762680053711
generate_one_block  0.025346994400024414
generate_one_block  0.02675461769104004
generate_one_block  0.03150033950805664
generate_one_block  0.028686046600341797
generate_one_block  0.02889537811279297
generate_one_block  0.025402307510375977
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

connection checking time:  0.744579553604126
block generation total time  0.704500675201416
average batch blocks generation time:  0.0469667116800944
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1405029296875 GB
    Memory Allocated: 0.04615926742553711  GigaBytes
Max Memory Allocated: 0.04615926742553711  GigaBytes

torch.Size([13716, 500])
torch.Size([5792, 256])
torch.Size([1737, 256])
torch.Size([306, 256])
torch.Size([116, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 1.4374699592590332  GigaBytes
Max Memory Allocated: 1.4374914169311523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6854248046875 GB
    Memory Allocated: 0.07159090042114258  GigaBytes
Max Memory Allocated: 1.443504810333252  GigaBytes

torch.Size([16363, 500])
torch.Size([8726, 256])
torch.Size([3520, 256])
torch.Size([509, 256])
torch.Size([117, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6776123046875 GB
    Memory Allocated: 2.391388416290283  GigaBytes
Max Memory Allocated: 2.3914108276367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 0.0708770751953125  GigaBytes
Max Memory Allocated: 2.3952713012695312  GigaBytes

torch.Size([15998, 500])
torch.Size([9282, 256])
torch.Size([2735, 256])
torch.Size([538, 256])
torch.Size([118, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7928466796875 GB
    Memory Allocated: 2.3345236778259277  GigaBytes
Max Memory Allocated: 2.3952713012695312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7928466796875 GB
    Memory Allocated: 0.07439899444580078  GigaBytes
Max Memory Allocated: 2.3952713012695312  GigaBytes

torch.Size([17641, 500])
torch.Size([13129, 256])
torch.Size([7271, 256])
torch.Size([2106, 256])
torch.Size([424, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 3.456909656524658  GigaBytes
Max Memory Allocated: 3.456972122192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 0.06907892227172852  GigaBytes
Max Memory Allocated: 3.4607601165771484  GigaBytes

torch.Size([15068, 500])
torch.Size([8435, 256])
torch.Size([2689, 256])
torch.Size([607, 256])
torch.Size([90, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 2.108353614807129  GigaBytes
Max Memory Allocated: 3.4607601165771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 0.07193803787231445  GigaBytes
Max Memory Allocated: 3.4607601165771484  GigaBytes

torch.Size([16496, 500])
torch.Size([10440, 256])
torch.Size([3947, 256])
torch.Size([740, 256])
torch.Size([127, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 2.6742310523986816  GigaBytes
Max Memory Allocated: 3.4607601165771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 0.07270383834838867  GigaBytes
Max Memory Allocated: 3.4607601165771484  GigaBytes

torch.Size([16946, 500])
torch.Size([9795, 256])
torch.Size([4220, 256])
torch.Size([612, 256])
torch.Size([168, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 2.4956130981445312  GigaBytes
Max Memory Allocated: 3.4607601165771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 0.06625986099243164  GigaBytes
Max Memory Allocated: 3.4607601165771484  GigaBytes

torch.Size([13306, 500])
torch.Size([6136, 256])
torch.Size([2298, 256])
torch.Size([444, 256])
torch.Size([102, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 1.6103992462158203  GigaBytes
Max Memory Allocated: 3.4607601165771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 0.06865692138671875  GigaBytes
Max Memory Allocated: 3.4607601165771484  GigaBytes

torch.Size([14760, 500])
torch.Size([8893, 256])
torch.Size([3710, 256])
torch.Size([897, 256])
torch.Size([156, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 2.4529542922973633  GigaBytes
Max Memory Allocated: 3.4607601165771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 0.0719609260559082  GigaBytes
Max Memory Allocated: 3.4607601165771484  GigaBytes

torch.Size([16542, 500])
torch.Size([9804, 256])
torch.Size([3673, 256])
torch.Size([444, 256])
torch.Size([87, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 2.5093698501586914  GigaBytes
Max Memory Allocated: 3.4607601165771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 0.06964588165283203  GigaBytes
Max Memory Allocated: 3.4607601165771484  GigaBytes

torch.Size([15312, 500])
torch.Size([9056, 256])
torch.Size([3724, 256])
torch.Size([556, 256])
torch.Size([160, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 2.3950276374816895  GigaBytes
Max Memory Allocated: 3.4607601165771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 0.0763697624206543  GigaBytes
Max Memory Allocated: 3.4607601165771484  GigaBytes

torch.Size([18632, 500])
torch.Size([15305, 256])
torch.Size([9806, 256])
torch.Size([2378, 256])
torch.Size([373, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0350341796875 GB
    Memory Allocated: 3.81387996673584  GigaBytes
Max Memory Allocated: 3.8139328956604004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 0.07481527328491211  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([17858, 500])
torch.Size([12921, 256])
torch.Size([7530, 256])
torch.Size([1801, 256])
torch.Size([438, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 3.488100528717041  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 0.07507753372192383  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([18058, 500])
torch.Size([14319, 256])
torch.Size([6129, 256])
torch.Size([1511, 256])
torch.Size([172, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 3.3082938194274902  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 0.07268571853637695  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([16900, 500])
torch.Size([11540, 256])
torch.Size([5275, 256])
torch.Size([1370, 256])
torch.Size([284, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 2.6411213874816895  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014706770579020182 |0.02556188901265462 |0.3401754061381022 |0.00015740394592285157 |0.4253664016723633 |0.01629781723022461 |
----------------------------------------------------------pseudo_mini_loss sum 2.010951280593872
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  483541
Number of first layer input nodes during this epoch:  243596
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 0.11492347717285156  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0008177757263183594
random selection method range initialization spend 0.0001685619354248047
time for parepare:  8.797645568847656e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  1.9550323486328125e-05
----------------------check_connections_block total spend ----------------------------- 0.003465414047241211
generate_one_block  0.0018301010131835938
generate_one_block  0.001277923583984375
generate_one_block  0.0012552738189697266
generate_one_block  0.0012471675872802734
generate_one_block  0.0013031959533691406
generate_one_block  0.001251220703125
generate_one_block  0.001271963119506836
generate_one_block  0.0011336803436279297
generate_one_block  0.0009641647338867188
generate_one_block  0.00099945068359375
generate_one_block  0.0009911060333251953
generate_one_block  0.0010280609130859375
generate_one_block  0.0009641647338867188
generate_one_block  0.0009860992431640625
generate_one_block  0.0010106563568115234
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007843971252441406
gen group dst list time:  0.00011444091796875
time for parepare:  0.0004439353942871094
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0002377033233642578
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  6.771087646484375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00011229515075683594
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0001990795135498047
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  8.630752563476562e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0001678466796875
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  7.343292236328125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  7.62939453125e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0001957416534423828
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0002789497375488281
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0002624988555908203
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00010180473327636719
----------------------check_connections_block total spend ----------------------------- 0.006298542022705078
generate_one_block  0.0013942718505859375
generate_one_block  0.0012791156768798828
generate_one_block  0.0013442039489746094
generate_one_block  0.001398324966430664
generate_one_block  0.0015485286712646484
generate_one_block  0.001239776611328125
generate_one_block  0.0012967586517333984
generate_one_block  0.0011374950408935547
generate_one_block  0.0017802715301513672
generate_one_block  0.0012066364288330078
generate_one_block  0.0013072490692138672
generate_one_block  0.0010421276092529297
generate_one_block  0.0010104179382324219
generate_one_block  0.001262664794921875
generate_one_block  0.0010683536529541016
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012936592102050781
gen group dst list time:  0.00020241737365722656
time for parepare:  0.0012695789337158203
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00037407875061035156
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.00030517578125
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00015878677368164062
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00031876564025878906
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0006325244903564453
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.0002071857452392578
r_  generation:  0.0013489723205566406
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  9.465217590332031e-05
r_  generation:  0.0004763603210449219
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.0001442432403564453
r_  generation:  0.0011904239654541016
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.00049591064453125
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0003933906555175781
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.00013518333435058594
r_  generation:  0.0011398792266845703
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00023412704467773438
mini_batch_src_global generation:  0.0002486705780029297
r_  generation:  0.0017976760864257812
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.00034689903259277344
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0002493858337402344
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0017764568328857422
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  0.000110626220703125
r_  generation:  0.0004901885986328125
----------------------check_connections_block total spend ----------------------------- 0.02132105827331543
generate_one_block  0.0015106201171875
generate_one_block  0.0011260509490966797
generate_one_block  0.0013124942779541016
generate_one_block  0.0016028881072998047
generate_one_block  0.0025968551635742188
generate_one_block  0.0015380382537841797
generate_one_block  0.0022706985473632812
generate_one_block  0.0014531612396240234
generate_one_block  0.0013463497161865234
generate_one_block  0.002150297164916992
generate_one_block  0.003235340118408203
generate_one_block  0.0013685226440429688
generate_one_block  0.001239776611328125
generate_one_block  0.0034694671630859375
generate_one_block  0.0016300678253173828
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020406246185302734
gen group dst list time:  0.0004336833953857422
time for parepare:  0.0017037391662597656
local_output_nid generation:  6.771087646484375e-05
local_in_edges_tensor generation:  0.0007216930389404297
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.0016262531280517578
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  0.00015616416931152344
r_  generation:  0.0008299350738525391
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  0.00019621849060058594
r_  generation:  0.0015594959259033203
local_output_nid generation:  0.00010538101196289062
local_in_edges_tensor generation:  0.0002880096435546875
mini_batch_src_global generation:  0.0003886222839355469
r_  generation:  0.0031147003173828125
local_output_nid generation:  0.0002999305725097656
local_in_edges_tensor generation:  0.0004899501800537109
mini_batch_src_global generation:  0.0008304119110107422
r_  generation:  0.006683826446533203
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.00024366378784179688
mini_batch_src_global generation:  0.0003676414489746094
r_  generation:  0.0039370059967041016
local_output_nid generation:  0.00018596649169921875
local_in_edges_tensor generation:  0.0004069805145263672
mini_batch_src_global generation:  0.0005106925964355469
r_  generation:  0.005090951919555664
local_output_nid generation:  8.845329284667969e-05
local_in_edges_tensor generation:  0.0002593994140625
mini_batch_src_global generation:  0.0003352165222167969
r_  generation:  0.0023360252380371094
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00022530555725097656
mini_batch_src_global generation:  0.00023818016052246094
r_  generation:  0.0017948150634765625
local_output_nid generation:  0.00018453598022460938
local_in_edges_tensor generation:  0.00035452842712402344
mini_batch_src_global generation:  0.0003800392150878906
r_  generation:  0.00431370735168457
local_output_nid generation:  0.00019788742065429688
local_in_edges_tensor generation:  0.00043320655822753906
mini_batch_src_global generation:  0.0006301403045654297
r_  generation:  0.006517887115478516
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  0.0003285408020019531
r_  generation:  0.001775979995727539
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  0.00018024444580078125
r_  generation:  0.0013885498046875
local_output_nid generation:  0.0003387928009033203
local_in_edges_tensor generation:  0.0005168914794921875
mini_batch_src_global generation:  0.0006473064422607422
r_  generation:  0.008223295211791992
local_output_nid generation:  0.00010752677917480469
local_in_edges_tensor generation:  0.0002722740173339844
mini_batch_src_global generation:  0.0004792213439941406
r_  generation:  0.0033349990844726562
----------------------check_connections_block total spend ----------------------------- 0.08084821701049805
generate_one_block  0.003942728042602539
generate_one_block  0.0023679733276367188
generate_one_block  0.003319263458251953
generate_one_block  0.0059967041015625
generate_one_block  0.0098876953125
generate_one_block  0.004557132720947266
generate_one_block  0.008663654327392578
generate_one_block  0.004260540008544922
generate_one_block  0.003677845001220703
generate_one_block  0.006796836853027344
generate_one_block  0.010378360748291016
generate_one_block  0.003469705581665039
generate_one_block  0.00299072265625
generate_one_block  0.01246023178100586
generate_one_block  0.005552530288696289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002589702606201172
gen group dst list time:  0.0018229484558105469
time for parepare:  0.0017888545989990234
local_output_nid generation:  0.00038504600524902344
local_in_edges_tensor generation:  0.0013327598571777344
mini_batch_src_global generation:  0.0008747577667236328
r_  generation:  0.007213592529296875
local_output_nid generation:  0.00023746490478515625
local_in_edges_tensor generation:  0.0004398822784423828
mini_batch_src_global generation:  0.0006117820739746094
r_  generation:  0.004593849182128906
local_output_nid generation:  0.00035953521728515625
local_in_edges_tensor generation:  0.0005688667297363281
mini_batch_src_global generation:  0.0005812644958496094
r_  generation:  0.005888700485229492
local_output_nid generation:  0.0006730556488037109
local_in_edges_tensor generation:  0.0008447170257568359
mini_batch_src_global generation:  0.0011184215545654297
r_  generation:  0.012026309967041016
local_output_nid generation:  0.0009698867797851562
local_in_edges_tensor generation:  0.0012946128845214844
mini_batch_src_global generation:  0.001592397689819336
r_  generation:  0.018003463745117188
local_output_nid generation:  0.0004723072052001953
local_in_edges_tensor generation:  0.0006780624389648438
mini_batch_src_global generation:  0.0010135173797607422
r_  generation:  0.00867772102355957
local_output_nid generation:  0.0009367465972900391
local_in_edges_tensor generation:  0.0011305809020996094
mini_batch_src_global generation:  0.0014317035675048828
r_  generation:  0.016640901565551758
local_output_nid generation:  0.00051116943359375
local_in_edges_tensor generation:  0.0006976127624511719
mini_batch_src_global generation:  0.0009415149688720703
r_  generation:  0.010809898376464844
local_output_nid generation:  0.0004341602325439453
local_in_edges_tensor generation:  0.0006194114685058594
mini_batch_src_global generation:  0.0008714199066162109
r_  generation:  0.007851839065551758
local_output_nid generation:  0.000701904296875
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.0011513233184814453
r_  generation:  0.014185428619384766
local_output_nid generation:  0.0009717941284179688
local_in_edges_tensor generation:  0.0011668205261230469
mini_batch_src_global generation:  0.0014166831970214844
r_  generation:  0.016473054885864258
local_output_nid generation:  0.00039124488830566406
local_in_edges_tensor generation:  0.0005400180816650391
mini_batch_src_global generation:  0.0009732246398925781
r_  generation:  0.008121252059936523
local_output_nid generation:  0.0004055500030517578
local_in_edges_tensor generation:  0.0005631446838378906
mini_batch_src_global generation:  0.0007052421569824219
r_  generation:  0.006710052490234375
local_output_nid generation:  0.0011553764343261719
local_in_edges_tensor generation:  0.0012764930725097656
mini_batch_src_global generation:  0.0014882087707519531
r_  generation:  0.03343033790588379
local_output_nid generation:  0.0014705657958984375
local_in_edges_tensor generation:  0.0013728141784667969
mini_batch_src_global generation:  0.0018115043640136719
r_  generation:  0.011527776718139648
----------------------check_connections_block total spend ----------------------------- 0.2657339572906494
generate_one_block  0.015131711959838867
generate_one_block  0.008027791976928711
generate_one_block  0.00935506820678711
generate_one_block  0.016062498092651367
generate_one_block  0.027526140213012695
generate_one_block  0.014196157455444336
generate_one_block  0.02117633819580078
generate_one_block  0.01601552963256836
generate_one_block  0.012726545333862305
generate_one_block  0.018676280975341797
generate_one_block  0.022657394409179688
generate_one_block  0.012944698333740234
generate_one_block  0.010404348373413086
generate_one_block  0.026365995407104492
generate_one_block  0.016337871551513672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019571781158447266
gen group dst list time:  0.004982709884643555
time for parepare:  0.002237558364868164
local_output_nid generation:  0.0010843276977539062
local_in_edges_tensor generation:  0.0017268657684326172
mini_batch_src_global generation:  0.0015997886657714844
r_  generation:  0.016045570373535156
local_output_nid generation:  0.0008368492126464844
local_in_edges_tensor generation:  0.001138925552368164
mini_batch_src_global generation:  0.0016868114471435547
r_  generation:  0.014689207077026367
local_output_nid generation:  0.0010242462158203125
local_in_edges_tensor generation:  0.0011744499206542969
mini_batch_src_global generation:  0.001371622085571289
r_  generation:  0.016211748123168945
local_output_nid generation:  0.0016274452209472656
local_in_edges_tensor generation:  0.0019843578338623047
mini_batch_src_global generation:  0.0021848678588867188
r_  generation:  0.021280288696289062
local_output_nid generation:  0.0020885467529296875
local_in_edges_tensor generation:  0.0022859573364257812
mini_batch_src_global generation:  0.002141237258911133
r_  generation:  0.025274276733398438
local_output_nid generation:  0.0013899803161621094
local_in_edges_tensor generation:  0.001399993896484375
mini_batch_src_global generation:  0.0017902851104736328
r_  generation:  0.018448591232299805
local_output_nid generation:  0.001989603042602539
local_in_edges_tensor generation:  0.0020630359649658203
mini_batch_src_global generation:  0.001996278762817383
r_  generation:  0.024205446243286133
local_output_nid generation:  0.001718282699584961
local_in_edges_tensor generation:  0.0017476081848144531
mini_batch_src_global generation:  0.0019927024841308594
r_  generation:  0.021069765090942383
local_output_nid generation:  0.0012481212615966797
local_in_edges_tensor generation:  0.001416921615600586
mini_batch_src_global generation:  0.001703500747680664
r_  generation:  0.01803302764892578
local_output_nid generation:  0.0017917156219482422
local_in_edges_tensor generation:  0.0020639896392822266
mini_batch_src_global generation:  0.0018634796142578125
r_  generation:  0.023000001907348633
local_output_nid generation:  0.0016384124755859375
local_in_edges_tensor generation:  0.002261638641357422
mini_batch_src_global generation:  0.001897573471069336
r_  generation:  0.02321171760559082
local_output_nid generation:  0.0012063980102539062
local_in_edges_tensor generation:  0.0013628005981445312
mini_batch_src_global generation:  0.0016210079193115234
r_  generation:  0.018221378326416016
local_output_nid generation:  0.0011055469512939453
local_in_edges_tensor generation:  0.0014133453369140625
mini_batch_src_global generation:  0.0015323162078857422
r_  generation:  0.0176849365234375
local_output_nid generation:  0.0024046897888183594
local_in_edges_tensor generation:  0.0025212764739990234
mini_batch_src_global generation:  0.002184152603149414
r_  generation:  0.02556633949279785
local_output_nid generation:  0.001445770263671875
local_in_edges_tensor generation:  0.0016820430755615234
mini_batch_src_global generation:  0.0016949176788330078
r_  generation:  0.019489288330078125
----------------------check_connections_block total spend ----------------------------- 0.4481513500213623
generate_one_block  0.021970748901367188
generate_one_block  0.02132701873779297
generate_one_block  0.023167133331298828
generate_one_block  0.02968430519104004
generate_one_block  0.03278493881225586
generate_one_block  0.025125980377197266
generate_one_block  0.031064748764038086
generate_one_block  0.027559995651245117
generate_one_block  0.02506089210510254
generate_one_block  0.029992103576660156
generate_one_block  0.030576705932617188
generate_one_block  0.02978038787841797
generate_one_block  0.025452136993408203
generate_one_block  0.033712148666381836
generate_one_block  0.026888608932495117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 0.11492347717285156  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

connection checking time:  0.8223531246185303
block generation total time  0.7972409725189209
average batch blocks generation time:  0.05314939816792806
block dataloader generation time/epoch 1.9010825157165527
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 0.10731315612792969  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([13160, 500])
torch.Size([7594, 256])
torch.Size([2312, 256])
torch.Size([452, 256])
torch.Size([78, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 2.0476765632629395  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 0.10774087905883789  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([13924, 500])
torch.Size([6249, 256])
torch.Size([1624, 256])
torch.Size([208, 256])
torch.Size([51, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 1.7619719505310059  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 0.11008596420288086  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([15136, 500])
torch.Size([7266, 256])
torch.Size([2731, 256])
torch.Size([410, 256])
torch.Size([106, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 2.0098094940185547  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 0.11455869674682617  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([17376, 500])
torch.Size([11285, 256])
torch.Size([5097, 256])
torch.Size([789, 256])
torch.Size([198, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 2.8795409202575684  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2147216796875 GB
    Memory Allocated: 0.11669635772705078  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([18353, 500])
torch.Size([15240, 256])
torch.Size([7887, 256])
torch.Size([2146, 256])
torch.Size([316, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 3.674705982208252  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2205810546875 GB
    Memory Allocated: 0.11085844039916992  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([15459, 500])
torch.Size([8669, 256])
torch.Size([3538, 256])
torch.Size([605, 256])
torch.Size([115, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2205810546875 GB
    Memory Allocated: 2.4629883766174316  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2205810546875 GB
    Memory Allocated: 0.11698675155639648  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([18558, 500])
torch.Size([14133, 256])
torch.Size([8131, 256])
torch.Size([1659, 256])
torch.Size([312, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2205810546875 GB
    Memory Allocated: 3.4674673080444336  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2205810546875 GB
    Memory Allocated: 0.11280107498168945  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([16462, 500])
torch.Size([10797, 256])
torch.Size([3732, 256])
torch.Size([733, 256])
torch.Size([107, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2205810546875 GB
    Memory Allocated: 2.71663236618042  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2205810546875 GB
    Memory Allocated: 0.11087989807128906  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([15497, 500])
torch.Size([8493, 256])
torch.Size([3367, 256])
torch.Size([469, 256])
torch.Size([127, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2205810546875 GB
    Memory Allocated: 2.3545942306518555  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2205810546875 GB
    Memory Allocated: 0.11472940444946289  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([17401, 500])
torch.Size([12876, 256])
torch.Size([5500, 256])
torch.Size([1506, 256])
torch.Size([272, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2205810546875 GB
    Memory Allocated: 3.1800060272216797  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2205810546875 GB
    Memory Allocated: 0.11525917053222656  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([17606, 500])
torch.Size([12757, 256])
torch.Size([7659, 256])
torch.Size([1857, 256])
torch.Size([452, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2283935546875 GB
    Memory Allocated: 3.4847264289855957  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2322998046875 GB
    Memory Allocated: 0.11064672470092773  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([15373, 500])
torch.Size([8386, 256])
torch.Size([3005, 256])
torch.Size([473, 256])
torch.Size([119, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2322998046875 GB
    Memory Allocated: 2.3529067039489746  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2322998046875 GB
    Memory Allocated: 0.110260009765625  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([15193, 500])
torch.Size([7952, 256])
torch.Size([2581, 256])
torch.Size([395, 256])
torch.Size([91, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2322998046875 GB
    Memory Allocated: 2.208042621612549  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2322998046875 GB
    Memory Allocated: 0.11723947525024414  GigaBytes
Max Memory Allocated: 3.817735195159912  GigaBytes

torch.Size([18576, 500])
torch.Size([15873, 256])
torch.Size([8961, 256])
torch.Size([2793, 256])
torch.Size([440, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4627685546875 GB
    Memory Allocated: 3.972135066986084  GigaBytes
Max Memory Allocated: 3.9721946716308594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4666748046875 GB
    Memory Allocated: 0.11217546463012695  GigaBytes
Max Memory Allocated: 3.9759883880615234  GigaBytes

torch.Size([16122, 500])
torch.Size([9482, 256])
torch.Size([4441, 256])
torch.Size([849, 256])
torch.Size([152, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4666748046875 GB
    Memory Allocated: 2.6780309677124023  GigaBytes
Max Memory Allocated: 3.9759883880615234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016004546483357748 |0.0045899232228597 |0.29937024116516114 |0.0001476287841796875 |0.4588777542114258 |0.013414382934570312 |
----------------------------------------------------------pseudo_mini_loss sum 2.6365811824798584
Total (block generation + training)time/epoch 13.649094581604004
Training time/epoch 11.74760913848877
Training time without block to device /epoch 11.678760290145874
Training time without total dataloading part /epoch 11.38934874534607
load block tensor time/epoch 0.2400681972503662
block to device time/epoch 0.06884884834289551
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  490451
Number of first layer input nodes during this epoch:  244196
