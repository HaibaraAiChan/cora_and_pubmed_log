main start at this time 1648534127.0273876
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0022263526916503906
random selection method range initialization spend 0.00018906593322753906
time for parepare:  4.4345855712890625e-05
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.001592874526977539
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.863739013671875e-05
----------------------check_connections_block total spend ----------------------------- 0.0025730133056640625
generate_one_block  0.0012238025665283203
generate_one_block  0.001001596450805664
generate_one_block  0.0010340213775634766
generate_one_block  0.0010144710540771484
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001173257827758789
gen group dst list time:  3.2901763916015625e-05
time for parepare:  0.000225067138671875
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0003826618194580078
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00021505355834960938
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0002257823944091797
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.00047850608825683594
----------------------check_connections_block total spend ----------------------------- 0.0027608871459960938
generate_one_block  0.0013885498046875
generate_one_block  0.0013127326965332031
generate_one_block  0.0012462139129638672
generate_one_block  0.0016427040100097656
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010712146759033203
gen group dst list time:  6.771087646484375e-05
time for parepare:  0.0007395744323730469
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  0.00017261505126953125
r_  generation:  0.0020058155059814453
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.0001704692840576172
r_  generation:  0.0012359619140625
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.0001361370086669922
r_  generation:  0.0014455318450927734
local_output_nid generation:  8.654594421386719e-05
local_in_edges_tensor generation:  0.000278472900390625
mini_batch_src_global generation:  0.0003399848937988281
r_  generation:  0.0034897327423095703
----------------------check_connections_block total spend ----------------------------- 0.013206720352172852
generate_one_block  0.003664731979370117
generate_one_block  0.0025298595428466797
generate_one_block  0.0027933120727539062
generate_one_block  0.005597114562988281
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021495819091796875
gen group dst list time:  0.00022339820861816406
time for parepare:  0.0013592243194580078
local_output_nid generation:  0.0002079010009765625
local_in_edges_tensor generation:  0.0008308887481689453
mini_batch_src_global generation:  0.0009951591491699219
r_  generation:  0.007873773574829102
local_output_nid generation:  0.00017189979553222656
local_in_edges_tensor generation:  0.0004329681396484375
mini_batch_src_global generation:  0.0007784366607666016
r_  generation:  0.005754709243774414
local_output_nid generation:  0.00017452239990234375
local_in_edges_tensor generation:  0.00041174888610839844
mini_batch_src_global generation:  0.0006773471832275391
r_  generation:  0.006824970245361328
local_output_nid generation:  0.0003733634948730469
local_in_edges_tensor generation:  0.0007622241973876953
mini_batch_src_global generation:  0.0012962818145751953
r_  generation:  0.013052940368652344
----------------------check_connections_block total spend ----------------------------- 0.050765037536621094
generate_one_block  0.011961936950683594
generate_one_block  0.0089874267578125
generate_one_block  0.010084867477416992
generate_one_block  0.017960786819458008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002069234848022461
gen group dst list time:  0.0007014274597167969
time for parepare:  0.0016312599182128906
local_output_nid generation:  0.0007302761077880859
local_in_edges_tensor generation:  0.0019752979278564453
mini_batch_src_global generation:  0.0015802383422851562
r_  generation:  0.017093658447265625
local_output_nid generation:  0.0007507801055908203
local_in_edges_tensor generation:  0.0016903877258300781
mini_batch_src_global generation:  0.0018630027770996094
r_  generation:  0.01613640785217285
local_output_nid generation:  0.0007064342498779297
local_in_edges_tensor generation:  0.001218557357788086
mini_batch_src_global generation:  0.001397848129272461
r_  generation:  0.01621103286743164
local_output_nid generation:  0.0011172294616699219
local_in_edges_tensor generation:  0.0019893646240234375
mini_batch_src_global generation:  0.00186920166015625
r_  generation:  0.022222518920898438
----------------------check_connections_block total spend ----------------------------- 0.10683679580688477
generate_one_block  0.023298978805541992
generate_one_block  0.022377967834472656
generate_one_block  0.022128582000732422
generate_one_block  0.029059886932373047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021123886108398438
gen group dst list time:  0.0011796951293945312
time for parepare:  0.0016317367553710938
local_output_nid generation:  0.0013473033905029297
local_in_edges_tensor generation:  0.0025873184204101562
mini_batch_src_global generation:  0.001986980438232422
r_  generation:  0.023250102996826172
local_output_nid generation:  0.0013980865478515625
local_in_edges_tensor generation:  0.002100706100463867
mini_batch_src_global generation:  0.0024101734161376953
r_  generation:  0.022916793823242188
local_output_nid generation:  0.0014107227325439453
local_in_edges_tensor generation:  0.0020494461059570312
mini_batch_src_global generation:  0.0018510818481445312
r_  generation:  0.022501468658447266
local_output_nid generation:  0.0015261173248291016
local_in_edges_tensor generation:  0.002509593963623047
mini_batch_src_global generation:  0.002000570297241211
r_  generation:  0.02558159828186035
----------------------check_connections_block total spend ----------------------------- 0.13898754119873047
generate_one_block  0.02941584587097168
generate_one_block  0.028927087783813477
generate_one_block  0.028778791427612305
generate_one_block  0.030869245529174805
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

connection checking time:  0.3125569820404053
block generation total time  0.2840266227722168
average batch blocks generation time:  0.0710066556930542
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.056659698486328125  GigaBytes
Max Memory Allocated: 0.056659698486328125  GigaBytes

torch.Size([18612, 500])
torch.Size([15339, 256])
torch.Size([9215, 256])
torch.Size([2906, 256])
torch.Size([675, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0897216796875 GB
    Memory Allocated: 3.8672537803649902  GigaBytes
Max Memory Allocated: 3.8673572540283203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2733154296875 GB
    Memory Allocated: 0.07585334777832031  GigaBytes
Max Memory Allocated: 3.8715906143188477  GigaBytes

torch.Size([18408, 500])
torch.Size([14600, 256])
torch.Size([8652, 256])
torch.Size([2128, 256])
torch.Size([506, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2733154296875 GB
    Memory Allocated: 3.585434913635254  GigaBytes
Max Memory Allocated: 3.8715906143188477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2733154296875 GB
    Memory Allocated: 0.0767664909362793  GigaBytes
Max Memory Allocated: 3.8715906143188477  GigaBytes

torch.Size([18370, 500])
torch.Size([14426, 256])
torch.Size([8276, 256])
torch.Size([2274, 256])
torch.Size([530, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2733154296875 GB
    Memory Allocated: 3.664217948913574  GigaBytes
Max Memory Allocated: 3.8715906143188477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2733154296875 GB
    Memory Allocated: 0.07793998718261719  GigaBytes
Max Memory Allocated: 3.8715906143188477  GigaBytes

torch.Size([19281, 500])
torch.Size([17857, 256])
torch.Size([13915, 256])
torch.Size([5199, 256])
torch.Size([1175, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8885498046875 GB
    Memory Allocated: 4.661198616027832  GigaBytes
Max Memory Allocated: 4.661352157592773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01950162649154663 |0.0876505970954895 |0.5258224606513977 |0.00018841028213500977 |0.5242681503295898 |0.015479326248168945 |
----------------------------------------------------------pseudo_mini_loss sum 2.0515310764312744
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  192701
Number of first layer input nodes during this epoch:  74671
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 0.12181425094604492  GigaBytes
Max Memory Allocated: 4.664963245391846  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007379055023193359
random selection method range initialization spend 0.00014543533325195312
time for parepare:  6.437301635742188e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  6.079673767089844e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  5.054473876953125e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.6716461181640625e-05
----------------------check_connections_block total spend ----------------------------- 0.0011339187622070312
generate_one_block  0.0016002655029296875
generate_one_block  0.001190185546875
generate_one_block  0.0011115074157714844
generate_one_block  0.0011966228485107422
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006015300750732422
gen group dst list time:  3.743171691894531e-05
time for parepare:  0.0003294944763183594
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0001819133758544922
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.00035881996154785156
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.00043582916259765625
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.00033020973205566406
----------------------check_connections_block total spend ----------------------------- 0.0030357837677001953
generate_one_block  0.0013365745544433594
generate_one_block  0.0016422271728515625
generate_one_block  0.0017049312591552734
generate_one_block  0.0016014575958251953
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010101795196533203
gen group dst list time:  8.392333984375e-05
time for parepare:  0.0008254051208496094
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.0003120899200439453
mini_batch_src_global generation:  0.00013875961303710938
r_  generation:  0.0009243488311767578
local_output_nid generation:  8.463859558105469e-05
local_in_edges_tensor generation:  0.00024127960205078125
mini_batch_src_global generation:  0.00030040740966796875
r_  generation:  0.002248048782348633
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  0.0003573894500732422
r_  generation:  0.0028667449951171875
local_output_nid generation:  8.654594421386719e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  0.0002720355987548828
r_  generation:  0.0025131702423095703
----------------------check_connections_block total spend ----------------------------- 0.01421046257019043
generate_one_block  0.0026099681854248047
generate_one_block  0.004318952560424805
generate_one_block  0.0052623748779296875
generate_one_block  0.004622220993041992
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002210855484008789
gen group dst list time:  0.00024390220642089844
time for parepare:  0.0014014244079589844
local_output_nid generation:  0.0001819133758544922
local_in_edges_tensor generation:  0.0007340908050537109
mini_batch_src_global generation:  0.0006146430969238281
r_  generation:  0.0050127506256103516
local_output_nid generation:  0.0003387928009033203
local_in_edges_tensor generation:  0.0006663799285888672
mini_batch_src_global generation:  0.0012352466583251953
r_  generation:  0.010854721069335938
local_output_nid generation:  0.00032591819763183594
local_in_edges_tensor generation:  0.0006237030029296875
mini_batch_src_global generation:  0.0009906291961669922
r_  generation:  0.010766744613647461
local_output_nid generation: Using backend: pytorch
 0.00033926963806152344
local_in_edges_tensor generation:  0.000629425048828125
mini_batch_src_global generation:  0.0009021759033203125
r_  generation:  0.010385513305664062
----------------------check_connections_block total spend ----------------------------- 0.05502438545227051
generate_one_block  0.009099245071411133
generate_one_block  0.015939950942993164
generate_one_block  0.015871286392211914
generate_one_block  0.016569852828979492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018117427825927734
gen group dst list time:  0.0007174015045166016
time for parepare:  0.0014271736145019531
local_output_nid generation:  0.0008356571197509766
local_in_edges_tensor generation:  0.0016028881072998047
mini_batch_src_global generation:  0.0012507438659667969
r_  generation:  0.01549839973449707
local_output_nid generation:  0.0010247230529785156
local_in_edges_tensor generation:  0.0023665428161621094
mini_batch_src_global generation:  0.002404451370239258
r_  generation:  0.02104663848876953
local_output_nid generation:  0.001041412353515625
local_in_edges_tensor generation:  0.0017960071563720703
mini_batch_src_global generation:  0.0017690658569335938
r_  generation:  0.02040886878967285
local_output_nid generation:  0.0010793209075927734
local_in_edges_tensor generation:  0.001661062240600586
mini_batch_src_global generation:  0.002113819122314453
r_  generation:  0.02013421058654785
----------------------check_connections_block total spend ----------------------------- 0.11494946479797363
generate_one_block  0.02259683609008789
generate_one_block  0.030773401260375977
generate_one_block  0.028896808624267578
generate_one_block  0.0285799503326416
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001932382583618164
gen group dst list time:  0.0014710426330566406
time for parepare:  0.0016586780548095703
local_output_nid generation:  0.0014338493347167969
local_in_edges_tensor generation:  0.0025975704193115234
mini_batch_src_global generation:  0.0017580986022949219
r_  generation:  0.022736549377441406
local_output_nid generation:  0.0015065670013427734
local_in_edges_tensor generation:  0.002374887466430664
mini_batch_src_global generation:  0.002588987350463867
r_  generation:  0.025525808334350586
local_output_nid generation:  0.001642465591430664
local_in_edges_tensor generation:  0.0024344921112060547
mini_batch_src_global generation:  0.0018818378448486328
r_  generation:  0.025178909301757812
local_output_nid generation:  0.0017218589782714844
local_in_edges_tensor generation:  0.0024085044860839844
mini_batch_src_global generation:  0.002275228500366211
r_  generation:  0.02497553825378418
----------------------check_connections_block total spend ----------------------------- 0.14540815353393555
generate_one_block  0.03164196014404297
generate_one_block  0.0344390869140625
generate_one_block  0.03342318534851074
generate_one_block  0.03290438652038574
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 0.12181425094604492  GigaBytes
Max Memory Allocated: 4.664963245391846  GigaBytes

connection checking time:  0.3326282501220703
block generation total time  0.3238346576690674
average batch blocks generation time:  0.08095866441726685
block dataloader generation time/epoch 0.7512171268463135
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 0.11631536483764648  GigaBytes
Max Memory Allocated: 4.664963245391846  GigaBytes

torch.Size([18196, 500])
torch.Size([13953, 256])
torch.Size([7515, 256])
torch.Size([1565, 256])
torch.Size([388, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 3.4638514518737793  GigaBytes
Max Memory Allocated: 4.664963245391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 0.11869573593139648  GigaBytes
Max Memory Allocated: 4.664963245391846  GigaBytes

torch.Size([19093, 500])
torch.Size([17082, 256])
torch.Size([12346, 256])
torch.Size([3797, 256])
torch.Size([759, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 4.337166786193848  GigaBytes
Max Memory Allocated: 4.664963245391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 0.11808300018310547  GigaBytes
Max Memory Allocated: 4.664963245391846  GigaBytes

torch.Size([18951, 500])
torch.Size([16551, 256])
torch.Size([11530, 256])
torch.Size([3777, 256])
torch.Size([917, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 4.298325538635254  GigaBytes
Max Memory Allocated: 4.664963245391846  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 0.11868143081665039  GigaBytes
Max Memory Allocated: 4.664963245391846  GigaBytes

torch.Size([18934, 500])
torch.Size([16643, 256])
torch.Size([10936, 256])
torch.Size([3727, 256])
torch.Size([779, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1287841796875 GB
    Memory Allocated: 4.274950981140137  GigaBytes
Max Memory Allocated: 4.664963245391846  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.022862553596496582 |0.0027346014976501465 |0.35969555377960205 |0.0001373887062072754 |0.5279061198234558 |0.012141704559326172 |
----------------------------------------------------------pseudo_mini_loss sum 1.959812045097351
Total (block generation + training)time/epoch 4.433138132095337
Training time/epoch 3.6817004680633545
Training time without block to device /epoch 3.670762062072754
Training time without total dataloading part /epoch 3.5630979537963867
load block tensor time/epoch 0.09145021438598633
block to device time/epoch 0.010938405990600586
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  197794
Number of first layer input nodes during this epoch:  75174
