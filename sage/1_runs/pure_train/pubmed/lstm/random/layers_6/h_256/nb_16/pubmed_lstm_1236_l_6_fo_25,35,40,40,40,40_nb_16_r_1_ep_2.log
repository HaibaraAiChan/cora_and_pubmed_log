main start at this time 1648534145.9205005
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001920461654663086
random selection method range initialization spend 0.00020122528076171875
time for parepare:  6.151199340820312e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00023555755615234375
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0015759468078613281
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.9325485229492188e-05
----------------------check_connections_block total spend ----------------------------- 0.003572702407836914
generate_one_block  0.001672506332397461
generate_one_block  0.0012869834899902344
generate_one_block  0.001232147216796875
generate_one_block  0.0012884140014648438
generate_one_block  0.0012347698211669922
generate_one_block  0.001245737075805664
generate_one_block  0.0012433528900146484
generate_one_block  0.0011343955993652344
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012736320495605469
gen group dst list time:  6.866455078125e-05
time for parepare:  0.0003345012664794922
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0001316070556640625
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.00032520294189453125
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00014138221740722656
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001361370086669922
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0001494884490966797
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00025582313537597656
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.00034308433532714844
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00017333030700683594
----------------------check_connections_block total spend ----------------------------- 0.004186868667602539
generate_one_block  0.0014193058013916016
generate_one_block  0.0016608238220214844
generate_one_block  0.0014560222625732422
generate_one_block  0.0014002323150634766
generate_one_block  0.0014069080352783203
generate_one_block  0.0015683174133300781
generate_one_block  0.0014581680297851562
generate_one_block  0.001108407974243164
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013213157653808594
gen group dst list time:  0.00012183189392089844
time for parepare:  0.001123189926147461
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0003001689910888672
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0005779266357421875
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00024700164794921875
mini_batch_src_global generation:  0.00023937225341796875
r_  generation:  0.0023033618927001953
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  0.00015091896057128906
r_  generation:  0.0008733272552490234
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0007944107055664062
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  0.00010466575622558594
r_  generation:  0.0008649826049804688
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.0002288818359375
mini_batch_src_global generation:  0.0002033710479736328
r_  generation:  0.001916646957397461
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.0002646446228027344
mini_batch_src_global generation:  0.00034308433532714844
r_  generation:  0.0024487972259521484
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  0.0001270771026611328
r_  generation:  0.0008623600006103516
----------------------check_connections_block total spend ----------------------------- 0.018248558044433594
generate_one_block  0.0016908645629882812
generate_one_block  0.0033566951751708984
generate_one_block  0.00176239013671875
generate_one_block  0.0016486644744873047
generate_one_block  0.0017821788787841797
generate_one_block  0.0028493404388427734
generate_one_block  0.0037055015563964844
generate_one_block  0.0018613338470458984
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021636486053466797
gen group dst list time:  0.00036263465881347656
time for parepare:  0.001973390579223633
local_output_nid generation:  0.00010085105895996094
local_in_edges_tensor generation:  0.0005748271942138672
mini_batch_src_global generation:  0.0003941059112548828
r_  generation:  0.0028028488159179688
local_output_nid generation:  0.0002124309539794922
local_in_edges_tensor generation:  0.0005478858947753906
mini_batch_src_global generation:  0.0010693073272705078
r_  generation:  0.008210420608520508
local_output_nid generation:  0.00013017654418945312
local_in_edges_tensor generation:  0.00033283233642578125
mini_batch_src_global generation:  0.0005092620849609375
r_  generation:  0.004040956497192383
local_output_nid generation:  0.00010085105895996094
local_in_edges_tensor generation:  0.0002980232238769531
mini_batch_src_global generation:  0.0003676414489746094
r_  generation:  0.0032634735107421875
local_output_nid generation:  0.00011014938354492188
local_in_edges_tensor generation:  0.00030517578125
mini_batch_src_global generation:  0.00039076805114746094
r_  generation:  0.00417017936706543
local_output_nid generation:  0.00020575523376464844
local_in_edges_tensor generation:  0.0004899501800537109
mini_batch_src_global generation:  0.0008294582366943359
r_  generation:  0.007992267608642578
local_output_nid generation:  0.00024247169494628906
local_in_edges_tensor generation:  0.0005626678466796875
mini_batch_src_global generation:  0.0011365413665771484
r_  generation:  0.010053396224975586
local_output_nid generation:  0.0001354217529296875
local_in_edges_tensor generation:  0.00032591819763183594
mini_batch_src_global generation:  0.000518798828125
r_  generation:  0.003866434097290039
----------------------check_connections_block total spend ----------------------------- 0.06790423393249512
generate_one_block  0.005316257476806641
generate_one_block  0.011276721954345703
generate_one_block  0.005860567092895508
generate_one_block  0.00529170036315918
generate_one_block  0.006639003753662109
generate_one_block  0.01201176643371582
generate_one_block  0.013369560241699219
generate_one_block  0.005933284759521484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002019643783569336
gen group dst list time:  0.0013227462768554688
time for parepare:  0.001886606216430664
local_output_nid generation:  0.0004849433898925781
local_in_edges_tensor generation:  0.0011591911315917969
mini_batch_src_global generation:  0.0010700225830078125
r_  generation:  0.010704278945922852
local_output_nid generation:  0.0007779598236083984
local_in_edges_tensor generation:  0.001314401626586914
mini_batch_src_global generation:  0.0017924308776855469
r_  generation:  0.018363475799560547
local_output_nid generation:  0.0006487369537353516
local_in_edges_tensor generation:  0.002198457717895508
mini_batch_src_global generation:  0.001270294189453125
r_  generation:  0.013860940933227539
local_output_nid generation:  0.0005605220794677734
local_in_edges_tensor generation:  0.0009539127349853516
mini_batch_src_global generation:  0.0008845329284667969
r_  generation:  0.011618375778198242
local_output_nid generation:  0.0005645751953125
local_in_edges_tensor generation:  0.00095367431640625
mini_batch_src_global generation:  0.0009715557098388672
r_  generation:  0.013816595077514648
local_output_nid generation:  0.0008780956268310547
local_in_edges_tensor generation:  0.0014717578887939453
mini_batch_src_global generation:  0.0017430782318115234
r_  generation:  0.019998788833618164
local_output_nid generation:  0.000934600830078125
local_in_edges_tensor generation:  0.0017504692077636719
mini_batch_src_global generation:  0.002063274383544922
r_  generation:  0.02099752426147461
local_output_nid generation:  0.0006380081176757812
local_in_edges_tensor generation:  0.0008327960968017578
mini_batch_src_global generation:  0.001135110855102539
r_  generation:  0.011214733123779297
----------------------check_connections_block total spend ----------------------------- 0.17688274383544922
generate_one_block  0.014513969421386719
generate_one_block  0.02410125732421875
generate_one_block  0.018502235412597656
generate_one_block  0.015240907669067383
generate_one_block  0.018281221389770508
generate_one_block  0.026119709014892578
generate_one_block  0.027661800384521484
generate_one_block  0.016762256622314453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017895698547363281
gen group dst list time:  0.002746105194091797
time for parepare:  0.001847982406616211
local_output_nid generation:  0.0010826587677001953
local_in_edges_tensor generation:  0.0018897056579589844
mini_batch_src_global generation:  0.0019092559814453125
r_  generation:  0.020401477813720703
local_output_nid generation:  0.0014204978942871094
local_in_edges_tensor generation:  0.0021524429321289062
mini_batch_src_global generation:  0.0026667118072509766
r_  generation:  0.024014711380004883
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.002164602279663086
mini_batch_src_global generation:  0.0018298625946044922
r_  generation:  0.022661209106445312
local_output_nid generation:  0.0013308525085449219
local_in_edges_tensor generation:  0.0017974376678466797
mini_batch_src_global generation:  0.0016326904296875
r_  generation:  0.020963668823242188
local_output_nid generation:  0.001348257064819336
local_in_edges_tensor generation:  0.002056121826171875
mini_batch_src_global generation:  0.0018858909606933594
r_  generation:  0.02178192138671875
local_output_nid generation:  0.0014803409576416016
local_in_edges_tensor generation:  0.0023632049560546875
mini_batch_src_global generation:  0.0021429061889648438
r_  generation:  0.024857521057128906
local_output_nid generation:  0.0017654895782470703
local_in_edges_tensor generation:  0.0025177001953125
mini_batch_src_global generation:  0.002074003219604492
r_  generation:  0.025734901428222656
local_output_nid generation:  0.0013325214385986328
local_in_edges_tensor generation:  0.0015687942504882812
mini_batch_src_global generation:  0.0017251968383789062
r_  generation:  0.01984095573425293
----------------------check_connections_block total spend ----------------------------- 0.2641468048095703
generate_one_block  0.025839805603027344
generate_one_block  0.03171682357788086
generate_one_block  0.0295565128326416
generate_one_block  0.02791285514831543
generate_one_block  0.02852177619934082
generate_one_block  0.03159618377685547
generate_one_block  0.03166985511779785
generate_one_block  0.025195598602294922
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

connection checking time:  0.5313692092895508
block generation total time  0.4890267848968506
average batch blocks generation time:  0.06112834811210632
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1463623046875 GB
    Memory Allocated: 0.05423450469970703  GigaBytes
Max Memory Allocated: 0.05423450469970703  GigaBytes

torch.Size([17345, 500])
torch.Size([10792, 256])
torch.Size([4580, 256])
torch.Size([783, 256])
torch.Size([232, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9490966796875 GB
    Memory Allocated: 2.711641788482666  GigaBytes
Max Memory Allocated: 2.711676597595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0233154296875 GB
    Memory Allocated: 0.07593536376953125  GigaBytes
Max Memory Allocated: 2.7174339294433594  GigaBytes

torch.Size([18407, 500])
torch.Size([14698, 256])
torch.Size([8560, 256])
torch.Size([2563, 256])
torch.Size([541, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9666748046875 GB
    Memory Allocated: 3.748318672180176  GigaBytes
Max Memory Allocated: 3.748399257659912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1385498046875 GB
    Memory Allocated: 0.07457494735717773  GigaBytes
Max Memory Allocated: 3.7521462440490723  GigaBytes

torch.Size([17643, 500])
torch.Size([12693, 256])
torch.Size([5653, 256])
torch.Size([1275, 256])
torch.Size([216, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1385498046875 GB
    Memory Allocated: 3.1040282249450684  GigaBytes
Max Memory Allocated: 3.7521462440490723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1385498046875 GB
    Memory Allocated: 0.07446527481079102  GigaBytes
Max Memory Allocated: 3.7521462440490723  GigaBytes

torch.Size([17533, 500])
torch.Size([11344, 256])
torch.Size([5456, 256])
torch.Size([1003, 256])
torch.Size([268, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1385498046875 GB
    Memory Allocated: 2.8211002349853516  GigaBytes
Max Memory Allocated: 3.7521462440490723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1385498046875 GB
    Memory Allocated: 0.07458257675170898  GigaBytes
Max Memory Allocated: 3.7521462440490723  GigaBytes

torch.Size([17382, 500])
torch.Size([12141, 256])
torch.Size([5780, 256])
torch.Size([1252, 256])
torch.Size([242, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1385498046875 GB
    Memory Allocated: 3.0966320037841797  GigaBytes
Max Memory Allocated: 3.7521462440490723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1385498046875 GB
    Memory Allocated: 0.07660198211669922  GigaBytes
Max Memory Allocated: 3.7521462440490723  GigaBytes

torch.Size([18729, 500])
torch.Size([15619, 256])
torch.Size([10564, 256])
torch.Size([2750, 256])
torch.Size([525, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2830810546875 GB
    Memory Allocated: 3.940366268157959  GigaBytes
Max Memory Allocated: 3.9404377937316895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3455810546875 GB
    Memory Allocated: 0.07688045501708984  GigaBytes
Max Memory Allocated: 3.944202423095703  GigaBytes

torch.Size([18834, 500])
torch.Size([16354, 256])
torch.Size([10364, 256])
torch.Size([3075, 256])
torch.Size([607, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 4.116013526916504  GigaBytes
Max Memory Allocated: 4.116183757781982  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 0.07277774810791016  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

torch.Size([16950, 500])
torch.Size([11404, 256])
torch.Size([5274, 256])
torch.Size([1372, 256])
torch.Size([284, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 2.6452488899230957  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015112459659576416 |0.04530876874923706 |0.4092257618904114 |0.0001558363437652588 |0.48628321290016174 |0.012435436248779297 |
----------------------------------------------------------pseudo_mini_loss sum 1.9041563272476196
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  321444
Number of first layer input nodes during this epoch:  142823
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 0.11446857452392578  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0009219646453857422
random selection method range initialization spend 0.00015664100646972656
time for parepare:  7.557868957519531e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.8358230590820312e-05
----------------------check_connections_block total spend ----------------------------- 0.001898050308227539
generate_one_block  0.001890420913696289
generate_one_block  0.0012602806091308594
generate_one_block  0.0013058185577392578
generate_one_block  0.0012443065643310547
generate_one_block  0.0012483596801757812
generate_one_block  0.0012316703796386719
generate_one_block  0.0012464523315429688
generate_one_block  0.001142740249633789
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007712841033935547
gen group dst list time:  6.175041198730469e-05
time for parepare:  0.00037932395935058594
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00014090538024902344
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.00023293495178222656
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00021982192993164062
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00023746490478515625
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0003006458282470703
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.00025844573974609375
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  9.202957153320312e-05
----------------------check_connections_block total spend ----------------------------- 0.004172563552856445
generate_one_block  0.0014045238494873047
generate_one_block  0.001516580581665039
generate_one_block  0.0017688274383544922
generate_one_block  0.0018558502197265625
generate_one_block  0.0015878677368164062
generate_one_block  0.001703500747680664
generate_one_block  0.0015337467193603516
generate_one_block  0.0011646747589111328
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012118816375732422
gen group dst list time:  0.00013375282287597656
time for parepare:  0.0011255741119384766
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00035691261291503906
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0003566741943359375
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  0.00012230873107910156
r_  generation:  0.0007770061492919922
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  0.00021004676818847656
r_  generation:  0.0014269351959228516
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  0.00017905235290527344
r_  generation:  0.0013344287872314453
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.0001475811004638672
r_  generation:  0.0012564659118652344
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  0.00023293495178222656
r_  generation:  0.0020334720611572266
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.0002224445343017578
mini_batch_src_global generation:  0.00024437904357910156
r_  generation:  0.0020966529846191406
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  0.00010800361633300781
r_  generation:  0.0004775524139404297
----------------------check_connections_block total spend ----------------------------- 0.017284870147705078
generate_one_block  0.0019419193267822266
generate_one_block  0.0021855831146240234
generate_one_block  0.003126859664916992
generate_one_block  0.0028655529022216797
generate_one_block  0.0026743412017822266
generate_one_block  0.003551959991455078
generate_one_block  0.003734588623046875
generate_one_block  0.001539468765258789
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019252300262451172
gen group dst list time:  0.000385284423828125
time for parepare:  0.0016205310821533203
local_output_nid generation:  9.131431579589844e-05
local_in_edges_tensor generation:  0.00064849853515625
mini_batch_src_global generation:  0.0003235340118408203
r_  generation:  0.0023262500762939453
local_output_nid generation:  0.00014591217041015625
local_in_edges_tensor generation:  0.0003268718719482422
mini_batch_src_global generation:  0.0005409717559814453
r_  generation:  0.004343509674072266
local_output_nid generation:  0.00032782554626464844
local_in_edges_tensor generation:  0.0007135868072509766
mini_batch_src_global generation:  0.0009140968322753906
r_  generation:  0.007755756378173828
local_output_nid generation:  0.0002465248107910156
local_in_edges_tensor generation:  0.0004246234893798828
mini_batch_src_global generation:  0.0006999969482421875
r_  generation:  0.006622791290283203
local_output_nid generation:  0.00021886825561523438
local_in_edges_tensor generation:  0.0003910064697265625
mini_batch_src_global generation:  0.0005908012390136719
r_  generation:  0.0055713653564453125
local_output_nid generation:  0.00023221969604492188
local_in_edges_tensor generation:  0.0010914802551269531
mini_batch_src_global generation:  0.0007228851318359375
r_  generation:  0.007327079772949219
local_output_nid generation:  0.0003178119659423828
local_in_edges_tensor generation:  0.0005354881286621094
mini_batch_src_global generation:  0.0010099411010742188
r_  generation:  0.009816169738769531
local_output_nid generation:  9.512901306152344e-05
local_in_edges_tensor generation:  0.000274658203125
mini_batch_src_global generation:  0.0005247592926025391
r_  generation:  0.003393888473510742
----------------------check_connections_block total spend ----------------------------- 0.07218074798583984
generate_one_block  0.005143642425537109
generate_one_block  0.007149457931518555
generate_one_block  0.01107931137084961
generate_one_block  0.010557413101196289
generate_one_block  0.008864164352416992
generate_one_block  0.011393070220947266
generate_one_block  0.013335466384887695
generate_one_block  0.0058171749114990234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002081155776977539
gen group dst list time:  0.0013294219970703125
time for parepare:  0.0018596649169921875
local_output_nid generation:  0.0005497932434082031
local_in_edges_tensor generation:  0.0014181137084960938
mini_batch_src_global generation:  0.0010323524475097656
r_  generation:  0.00985097885131836
local_output_nid generation:  0.0007886886596679688
local_in_edges_tensor generation:  0.0010528564453125
mini_batch_src_global generation:  0.0014104843139648438
r_  generation:  0.013995885848999023
local_output_nid generation:  0.0009708404541015625
local_in_edges_tensor generation:  0.0016503334045410156
mini_batch_src_global generation:  0.0017824172973632812
r_  generation:  0.018671035766601562
local_output_nid generation:  0.0010972023010253906
local_in_edges_tensor generation:  0.0013403892517089844
mini_batch_src_global generation:  0.0017583370208740234
r_  generation:  0.019264698028564453
local_output_nid generation:  0.0009226799011230469
local_in_edges_tensor generation:  0.0011115074157714844
mini_batch_src_global generation:  0.001384735107421875
r_  generation:  0.016957998275756836
local_output_nid generation:  0.0010640621185302734
local_in_edges_tensor generation:  0.0011889934539794922
mini_batch_src_global generation:  0.0015952587127685547
r_  generation:  0.018235445022583008
local_output_nid generation:  0.0011255741119384766
local_in_edges_tensor generation:  0.0016431808471679688
mini_batch_src_global generation:  0.0017578601837158203
r_  generation:  0.020368576049804688
local_output_nid generation:  0.0006318092346191406
local_in_edges_tensor generation:  0.0007295608520507812
mini_batch_src_global generation:  0.001161813735961914
r_  generation:  0.01100468635559082
----------------------check_connections_block total spend ----------------------------- 0.1889636516571045
generate_one_block  0.01504063606262207
generate_one_block  0.018884897232055664
generate_one_block  0.026920080184936523
generate_one_block  0.02608489990234375
generate_one_block  0.024692773818969727
generate_one_block  0.024129152297973633
generate_one_block  0.02823162078857422
generate_one_block  0.016465425491333008
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017681121826171875
gen group dst list time:  0.002756834030151367
time for parepare:  0.001909017562866211
local_output_nid generation:  0.001222848892211914
local_in_edges_tensor generation:  0.001847982406616211
mini_batch_src_global generation:  0.0016210079193115234
r_  generation:  0.018780231475830078
local_output_nid generation:  0.0013222694396972656
local_in_edges_tensor generation:  0.0017375946044921875
mini_batch_src_global generation:  0.002358675003051758
r_  generation:  0.022411108016967773
local_output_nid generation:  0.0016674995422363281
local_in_edges_tensor generation:  0.00251007080078125
mini_batch_src_global generation:  0.002100706100463867
r_  generation:  0.025234699249267578
local_output_nid generation:  0.0017583370208740234
local_in_edges_tensor generation:  0.002551555633544922
mini_batch_src_global generation:  0.002001047134399414
r_  generation:  0.025481462478637695
local_output_nid generation:  0.0016579627990722656
local_in_edges_tensor generation:  0.0018534660339355469
mini_batch_src_global generation:  0.0019273757934570312
r_  generation:  0.02394843101501465
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0018939971923828125
mini_batch_src_global generation:  0.0018994808197021484
r_  generation:  0.023804903030395508
local_output_nid generation:  0.0016565322875976562
local_in_edges_tensor generation:  0.002499103546142578
mini_batch_src_global generation: Using backend: pytorch
 0.0020215511322021484
r_  generation:  0.02585434913635254
local_output_nid generation:  0.0010592937469482422
local_in_edges_tensor generation:  0.0014634132385253906
mini_batch_src_global generation:  0.0016207695007324219
r_  generation:  0.019276857376098633
----------------------check_connections_block total spend ----------------------------- 0.2698090076446533
generate_one_block  0.025907039642333984
generate_one_block  0.03155946731567383
generate_one_block  0.033740997314453125
generate_one_block  0.03271365165710449
generate_one_block  0.03124094009399414
generate_one_block  0.031558990478515625
generate_one_block  0.033487796783447266
generate_one_block  0.0266110897064209
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 0.11446857452392578  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

connection checking time:  0.5524108409881592
block generation total time  0.5347650051116943
average batch blocks generation time:  0.06684562563896179
block dataloader generation time/epoch 1.2628662586212158
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 0.11082887649536133  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

torch.Size([15512, 500])
torch.Size([9652, 256])
torch.Size([3570, 256])
torch.Size([651, 256])
torch.Size([129, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 2.5130677223205566  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 0.11525869369506836  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

torch.Size([17988, 500])
torch.Size([12511, 256])
torch.Size([6475, 256])
torch.Size([1130, 256])
torch.Size([305, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 3.153334140777588  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 0.11668920516967773  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

torch.Size([18608, 500])
torch.Size([15539, 256])
torch.Size([8681, 256])
torch.Size([2486, 256])
torch.Size([423, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 3.8226237297058105  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 0.11704778671264648  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

torch.Size([18804, 500])
torch.Size([15598, 256])
torch.Size([9671, 256])
torch.Size([2249, 256])
torch.Size([418, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 3.8229846954345703  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 0.11599254608154297  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

torch.Size([18299, 500])
torch.Size([14171, 256])
torch.Size([7490, 256])
torch.Size([1930, 256])
torch.Size([399, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 3.5252857208251953  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 0.11599493026733398  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

torch.Size([18245, 500])
torch.Size([13864, 256])
torch.Size([8723, 256])
torch.Size([2170, 256])
torch.Size([567, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 3.7163100242614746  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 0.11714649200439453  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

torch.Size([18791, 500])
torch.Size([16172, 256])
torch.Size([9820, 256])
torch.Size([3071, 256])
torch.Size([534, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5975341796875 GB
    Memory Allocated: 4.076960563659668  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6014404296875 GB
    Memory Allocated: 0.11150550842285156  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

torch.Size([16061, 500])
torch.Size([9278, 256])
torch.Size([4334, 256])
torch.Size([777, 256])
torch.Size([152, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6014404296875 GB
    Memory Allocated: 2.64601469039917  GigaBytes
Max Memory Allocated: 4.11985445022583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01532834768295288 |0.0038282573223114014 |0.3306941092014313 |0.00014352798461914062 |0.4771198332309723 |0.010424137115478516 |
----------------------------------------------------------pseudo_mini_loss sum 2.4998021125793457
Total (block generation + training)time/epoch 7.916486501693726
Training time/epoch 6.653348922729492
Training time without block to device /epoch 6.622722864151001
Training time without total dataloading part /epoch 6.47408390045166
load block tensor time/epoch 0.12262678146362305
block to device time/epoch 0.03062605857849121
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  325605
Number of first layer input nodes during this epoch:  142308
