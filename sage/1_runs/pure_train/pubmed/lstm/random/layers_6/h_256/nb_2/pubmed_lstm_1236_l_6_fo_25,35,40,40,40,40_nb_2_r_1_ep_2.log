main start at this time 1648534099.3468516
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.002408266067504883
random selection method range initialization spend 0.0001742839813232422
time for parepare:  4.601478576660156e-05
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0016684532165527344
----------------------check_connections_block total spend ----------------------------- 0.002086639404296875
generate_one_block  0.0015583038330078125
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013885498046875
gen group dst list time:  2.002716064453125e-05
time for parepare:  0.00025916099548339844
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  0.00014972686767578125
r_  generation:  0.0011911392211914062
----------------------check_connections_block total spend ----------------------------- 0.002204418182373047
generate_one_block  0.0028204917907714844
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010676383972167969
gen group dst list time:  5.459785461425781e-05
time for parepare:  0.0007710456848144531
local_output_nid generation:  0.00017690658569335938
local_in_edges_tensor generation:  0.0005886554718017578
mini_batch_src_global generation:  0.0006282329559326172
r_  generation:  0.006970882415771484
----------------------check_connections_block total spend ----------------------------- 0.01126551628112793
generate_one_block  0.009879589080810547
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020737648010253906
gen group dst list time:  0.000152587890625
time for parepare:  0.001352071762084961
local_output_nid generation:  0.0005524158477783203
local_in_edges_tensor generation:  0.0014119148254394531
mini_batch_src_global generation:  0.0017387866973876953
r_  generation:  0.018259525299072266
----------------------check_connections_block total spend ----------------------------- 0.028530597686767578
generate_one_block  0.02354907989501953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002124309539794922
gen group dst list time:  0.0003135204315185547
time for parepare:  0.001428842544555664
local_output_nid generation:  0.0011265277862548828
local_in_edges_tensor generation:  0.0026133060455322266
mini_batch_src_global generation:  0.002162456512451172
r_  generation:  0.02574014663696289
----------------------check_connections_block total spend ----------------------------- 0.0397648811340332
generate_one_block  0.029692649841308594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020775794982910156
gen group dst list time:  0.0004096031188964844
time for parepare:  0.0015590190887451172
local_output_nid generation:  0.0014414787292480469
local_in_edges_tensor generation:  0.0028743743896484375
mini_batch_src_global generation:  0.002056121826171875
r_  generation:  0.0267941951751709
----------------------check_connections_block total spend ----------------------------- 0.0415799617767334
generate_one_block  0.03107595443725586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

connection checking time:  0.12334537506103516
block generation total time  0.09701776504516602
average batch blocks generation time:  0.09701776504516602
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1522216796875 GB
    Memory Allocated: 0.059180259704589844  GigaBytes
Max Memory Allocated: 0.059180259704589844  GigaBytes

torch.Size([19509, 500])
torch.Size([18691, 256])
torch.Size([16337, 256])
torch.Size([8137, 256])
torch.Size([2575, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.3885498046875 GB
    Memory Allocated: 5.181842803955078  GigaBytes
Max Memory Allocated: 5.18225622177124  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014155149459838867 |0.3493525981903076 |1.080355167388916 |0.0002963542938232422 |0.5993390083312988 |0.020439863204956055 |
----------------------------------------------------------pseudo_mini_loss sum 1.748085618019104
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  65603
Number of first layer input nodes during this epoch:  19509
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 6.7147216796875 GB
    Memory Allocated: 0.12431716918945312  GigaBytes
Max Memory Allocated: 5.185403347015381  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006806850433349609
random selection method range initialization spend 0.00013136863708496094
time for parepare:  5.245208740234375e-05
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0001163482666015625
----------------------check_connections_block total spend ----------------------------- 0.0005402565002441406
generate_one_block  0.001817941665649414
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005688667297363281
gen group dst list time:  2.2172927856445312e-05
time for parepare:  0.00028324127197265625
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00026297569274902344
mini_batch_src_global generation:  0.00013709068298339844
r_  generation:  0.0012030601501464844
----------------------check_connections_block total spend ----------------------------- 0.002285480499267578
generate_one_block  0.0032999515533447266
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001070261001586914
gen group dst list time:  5.817413330078125e-05
time for parepare:  0.0007371902465820312
local_output_nid generation:  0.00018668174743652344
local_in_edges_tensor generation:  0.0005922317504882812
mini_batch_src_global generation:  0.000682830810546875
r_  generation:  0.00726318359375
----------------------check_connections_block total spend ----------------------------- 0.011493206024169922
generate_one_block  0.011605978012084961
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002110719680786133
gen group dst list time:  0.00015997886657714844
time for parepare:  0.0013206005096435547
local_output_nid generation:  0.0005650520324707031
local_in_edges_tensor generation:  0.0016281604766845703
mini_batch_src_global generation:  0.0016362667083740234
r_  generation:  0.01832270622253418
----------------------check_connections_block total spend ----------------------------- 0.028703689575195312
generate_one_block  0.025899887084960938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002110719680786133
gen group dst list time:  0.00032329559326171875
time for parepare:  0.0015671253204345703
local_output_nid generation:  0.0011725425720214844
local_in_edges_tensor generation:  0.0024793148040771484
mini_batch_src_global generation:  0.002098560333251953
r_  generation:  0.02704453468322754Using backend: pytorch

----------------------check_connections_block total spend ----------------------------- 0.04116940498352051
generate_one_block  0.0347437858581543
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022051334381103516
gen group dst list time:  0.0004215240478515625
time for parepare:  0.0016276836395263672
local_output_nid generation:  0.0014188289642333984
local_in_edges_tensor generation:  0.0028192996978759766
mini_batch_src_global generation:  0.002044677734375
r_  generation:  0.027043581008911133
----------------------check_connections_block total spend ----------------------------- 0.04191851615905762
generate_one_block  0.03669166564941406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 6.7147216796875 GB
    Memory Allocated: 0.12431716918945312  GigaBytes
Max Memory Allocated: 5.185403347015381  GigaBytes

connection checking time:  0.12557029724121094
block generation total time  0.11224126815795898
average batch blocks generation time:  0.11224126815795898
block dataloader generation time/epoch 0.2791461944580078
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.7147216796875 GB
    Memory Allocated: 0.12007856369018555  GigaBytes
Max Memory Allocated: 5.185403347015381  GigaBytes

torch.Size([19513, 500])
torch.Size([18734, 256])
torch.Size([16289, 256])
torch.Size([8128, 256])
torch.Size([2586, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.7479248046875 GB
    Memory Allocated: 5.246829509735107  GigaBytes
Max Memory Allocated: 5.247243881225586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013934135437011719 |0.0021104812622070312 |0.418442964553833 |0.00014591217041015625 |0.6404304504394531 |0.009480953216552734 |
----------------------------------------------------------pseudo_mini_loss sum 1.95596182346344
Total (block generation + training)time/epoch 1.3732836246490479
Training time/epoch 1.0939247608184814
Training time without block to device /epoch 1.0918142795562744
Training time without total dataloading part /epoch 1.068500280380249
load block tensor time/epoch 0.013934135437011719
block to device time/epoch 0.0021104812622070312
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.1920928955078125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  65604
Number of first layer input nodes during this epoch:  19513
