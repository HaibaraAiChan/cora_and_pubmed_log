main start at this time 1648534112.0171428
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0014002323150634766
random selection method range initialization spend 0.00019812583923339844
time for parepare:  5.555152893066406e-05
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0015118122100830078
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  9.34600830078125e-05
----------------------check_connections_block total spend ----------------------------- 0.0023279190063476562
generate_one_block  0.001566171646118164
generate_one_block  0.0013859272003173828
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0008878707885742188
gen group dst list time:  3.266334533691406e-05
time for parepare:  0.0003032684326171875
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0006151199340820312
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  0.00013399124145507812
r_  generation:  0.000926971435546875
----------------------check_connections_block total spend ----------------------------- 0.0029671192169189453
generate_one_block  0.0021474361419677734
generate_one_block  0.0024209022521972656
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001260995864868164
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.0009095668792724609
local_output_nid generation:  0.00010967254638671875
local_in_edges_tensor generation:  0.000576019287109375
mini_batch_src_global generation:  0.0003631114959716797
r_  generation:  0.003903627395629883
local_output_nid generation:  0.0001575946807861328
local_in_edges_tensor generation:  0.0004169940948486328
mini_batch_src_global generation:  0.0007467269897460938
r_  generation:  0.00590062141418457
----------------------check_connections_block total spend ----------------------------- 0.01601266860961914
generate_one_block  0.00516200065612793
generate_one_block  0.0069234371185302734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002359628677368164
gen group dst list time:  0.0002567768096923828
time for parepare:  0.0017681121826171875
local_output_nid generation:  0.0004734992980957031
local_in_edges_tensor generation:  0.0012176036834716797
mini_batch_src_global generation:  0.0014967918395996094
r_  generation:  0.012659072875976562
local_output_nid generation:  0.0004642009735107422
local_in_edges_tensor generation:  0.0009377002716064453
mini_batch_src_global generation:  0.0017316341400146484
r_  generation:  0.01609945297241211
----------------------check_connections_block total spend ----------------------------- 0.04442620277404785
generate_one_block  0.016373395919799805
generate_one_block  0.022333145141601562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017621517181396484
gen group dst list time:  0.0005404949188232422
time for parepare:  0.0016608238220214844
local_output_nid generation:  0.001071929931640625
local_in_edges_tensor generation:  0.0020508766174316406
mini_batch_src_global generation:  0.001975536346435547
r_  generation:  0.022759199142456055
local_output_nid generation:  0.0011057853698730469
local_in_edges_tensor generation:  0.0017979145050048828
mini_batch_src_global generation:  0.0025200843811035156
r_  generation:  0.02490401268005371
----------------------check_connections_block total spend ----------------------------- 0.07067489624023438
generate_one_block  0.026964426040649414
generate_one_block  0.03170633316040039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018463134765625
gen group dst list time:  0.0007653236389160156
time for parepare:  0.0016772747039794922
local_output_nid generation:  0.0015392303466796875
local_in_edges_tensor generation:  0.0026552677154541016
mini_batch_src_global generation:  0.0021767616271972656
r_  generation:  0.02586507797241211
local_output_nid generation:  0.001428365707397461
local_in_edges_tensor generation:  0.002226591110229492
mini_batch_src_global generation:  0.0027284622192382812
r_  generation:  0.027452945709228516
----------------------check_connections_block total spend ----------------------------- 0.07940030097961426
generate_one_block  0.0314793586730957
generate_one_block  0.0335383415222168
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

connection checking time:  0.21348118782043457
block generation total time  0.17904877662658691
average batch blocks generation time:  0.08952438831329346
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1522216796875 GB
    Memory Allocated: 0.057403564453125  GigaBytes
Max Memory Allocated: 0.057403564453125  GigaBytes

torch.Size([19142, 500])
torch.Size([17278, 256])
torch.Size([12968, 256])
torch.Size([4513, 256])
torch.Size([1161, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6834716796875 GB
    Memory Allocated: 4.458335876464844  GigaBytes
Max Memory Allocated: 4.458508014678955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.9139404296875 GB
    Memory Allocated: 0.07817411422729492  GigaBytes
Max Memory Allocated: 4.462101936340332  GigaBytes

torch.Size([19358, 500])
torch.Size([18177, 256])
torch.Size([14844, 256])
torch.Size([6215, 256])
torch.Size([1651, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.2713623046875 GB
    Memory Allocated: 4.87012243270874  GigaBytes
Max Memory Allocated: 4.8703742027282715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017011523246765137 |0.1706303358078003 |0.724933385848999 |0.0001817941665649414 |0.5614625215530396 |0.011081695556640625 |
----------------------------------------------------------pseudo_mini_loss sum 2.0738327503204346
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  115664
Number of first layer input nodes during this epoch:  38500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 6.2733154296875 GB
    Memory Allocated: 0.12224674224853516  GigaBytes
Max Memory Allocated: 4.873806953430176  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005452632904052734
random selection method range initialization spend 0.0001266002655029297
time for parepare:  5.841255187988281e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  6.389617919921875e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012159347534179688Using backend: pytorch

mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  8.177757263183594e-05
----------------------check_connections_block total spend ----------------------------- 0.0008268356323242188
generate_one_block  0.0012600421905517578
generate_one_block  0.0012068748474121094
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005548000335693359
gen group dst list time:  2.9325485229492188e-05
time for parepare:  0.0002579689025878906
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0004992485046386719
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  0.00011229515075683594
r_  generation:  0.0008068084716796875
----------------------check_connections_block total spend ----------------------------- 0.002536296844482422
generate_one_block  0.0018978118896484375
generate_one_block  0.0034885406494140625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010428428649902344
gen group dst list time:  7.05718994140625e-05
time for parepare:  0.0007615089416503906
local_output_nid generation:  0.00012373924255371094
local_in_edges_tensor generation:  0.0003681182861328125
mini_batch_src_global generation:  0.0002903938293457031
r_  generation:  0.0030510425567626953
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.00034117698669433594
mini_batch_src_global generation:  0.0005359649658203125
r_  generation:  0.005129814147949219
----------------------check_connections_block total spend ----------------------------- 0.012920141220092773
generate_one_block  0.006270885467529297
generate_one_block  0.00784754753112793
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018825531005859375
gen group dst list time:  0.00019979476928710938
time for parepare:  0.0013382434844970703
local_output_nid generation:  0.00038051605224609375
local_in_edges_tensor generation:  0.0009779930114746094
mini_batch_src_global generation:  0.0010650157928466797
r_  generation:  0.013317346572875977
local_output_nid generation:  0.00046515464782714844
local_in_edges_tensor generation:  0.0009260177612304688
mini_batch_src_global generation:  0.0017173290252685547
r_  generation:  0.015263795852661133
----------------------check_connections_block total spend ----------------------------- 0.042617082595825195
generate_one_block  0.020142555236816406
generate_one_block  0.02333974838256836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017883777618408203
gen group dst list time:  0.00052642822265625
time for parepare:  0.0015385150909423828
local_output_nid generation:  0.0011544227600097656
local_in_edges_tensor generation:  0.002214670181274414
mini_batch_src_global generation:  0.0021791458129882812
r_  generation:  0.023550748825073242
local_output_nid generation:  0.0012187957763671875
local_in_edges_tensor generation:  0.0024805068969726562
mini_batch_src_global generation:  0.002790689468383789
r_  generation:  0.024321794509887695
----------------------check_connections_block total spend ----------------------------- 0.0727529525756836
generate_one_block  0.033982276916503906
generate_one_block  0.033754587173461914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002084970474243164
gen group dst list time:  0.0008745193481445312
time for parepare:  0.0016701221466064453
local_output_nid generation:  0.0016117095947265625
local_in_edges_tensor generation:  0.002686023712158203
mini_batch_src_global generation:  0.0019352436065673828
r_  generation:  0.026467323303222656
local_output_nid generation:  0.0015454292297363281
local_in_edges_tensor generation:  0.002489328384399414
mini_batch_src_global generation:  0.0028235912322998047
r_  generation:  0.028296947479248047
----------------------check_connections_block total spend ----------------------------- 0.08143901824951172
generate_one_block  0.03422427177429199
generate_one_block  0.035880088806152344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 6.2733154296875 GB
    Memory Allocated: 0.12224674224853516  GigaBytes
Max Memory Allocated: 4.873806953430176  GigaBytes

connection checking time:  0.2122654914855957
block generation total time  0.20082831382751465
average batch blocks generation time:  0.10041415691375732
block dataloader generation time/epoch 0.46961426734924316
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.2733154296875 GB
    Memory Allocated: 0.11877918243408203  GigaBytes
Max Memory Allocated: 4.873806953430176  GigaBytes

torch.Size([19274, 500])
torch.Size([17655, 256])
torch.Size([13601, 256])
torch.Size([4628, 256])
torch.Size([1120, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.2733154296875 GB
    Memory Allocated: 4.554985046386719  GigaBytes
Max Memory Allocated: 4.873806953430176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.2733154296875 GB
    Memory Allocated: 0.11906814575195312  GigaBytes
Max Memory Allocated: 4.873806953430176  GigaBytes

torch.Size([19350, 500])
torch.Size([18076, 256])
torch.Size([14177, 256])
torch.Size([5897, 256])
torch.Size([1615, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.2733154296875 GB
    Memory Allocated: 4.8461761474609375  GigaBytes
Max Memory Allocated: 4.873806953430176  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.019508719444274902 |0.0033570528030395508 |0.3984858989715576 |0.00016248226165771484 |0.5721409320831299 |0.01015615463256836 |
----------------------------------------------------------pseudo_mini_loss sum 2.462512969970703
Total (block generation + training)time/epoch 2.4811410903930664
Training time/epoch 2.0110418796539307
Training time without block to device /epoch 2.0043277740478516
Training time without total dataloading part /epoch 1.9517347812652588
load block tensor time/epoch 0.039017438888549805
block to device time/epoch 0.0067141056060791016
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  115748
Number of first layer input nodes during this epoch:  38624
