main start at this time 1648533706.6967556
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0020704269409179688
random selection method range initialization spend 0.0001571178436279297
time for parepare:  4.1961669921875e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0010101795196533203
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  6.4849853515625e-05
----------------------check_connections_block total spend ----------------------------- 0.001977682113647461
generate_one_block  0.0011734962463378906
generate_one_block  0.0010683536529541016
generate_one_block  0.0009891986846923828
generate_one_block  0.0010340213775634766
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013072490692138672
gen group dst list time:  3.170967102050781e-05
time for parepare:  0.0002219676971435547
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00038361549377441406
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.00041794776916503906
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00020170211791992188
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0002951622009277344
----------------------check_connections_block total spend ----------------------------- 0.0027527809143066406
generate_one_block  0.0014278888702392578
generate_one_block  0.0015513896942138672
generate_one_block  0.0012481212615966797
generate_one_block  0.0013015270233154297
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0009884834289550781
gen group dst list time:  7.033348083496094e-05
time for parepare:  0.0007331371307373047
local_output_nid generation:  6.532669067382812e-05
local_in_edges_tensor generation:  0.00032782554626464844
mini_batch_src_global generation:  0.0001804828643798828
r_  generation:  0.002071380615234375
local_output_nid generation:  7.05718994140625e-05
local_in_edges_tensor generation:  0.0002639293670654297
mini_batch_src_global generation:  0.0003581047058105469
r_  generation:  0.003038644790649414
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  0.00016832351684570312
r_  generation:  0.0011997222900390625
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.00017142295837402344
r_  generation:  0.0019757747650146484
----------------------check_connections_block total spend ----------------------------- 0.013272762298583984
generate_one_block  0.004287242889404297
generate_one_block  0.0048999786376953125
generate_one_block  0.0025115013122558594
generate_one_block  0.003322601318359375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002033233642578125
gen group dst list time:  0.00021195411682128906
time for parepare:  0.0014812946319580078
local_output_nid generation:  0.0002582073211669922
local_in_edges_tensor generation:  0.0009028911590576172
mini_batch_src_global generation:  0.001041412353515625
r_  generation:  0.009352445602416992
local_output_nid generation:  0.00032639503479003906
local_in_edges_tensor generation:  0.0008771419525146484
mini_batch_src_global generation:  0.0012922286987304688
r_  generation:  0.011080026626586914
local_output_nid generation:  0.0001804828643798828
local_in_edges_tensor generation:  0.00042510032653808594
mini_batch_src_global generation:  0.0007824897766113281
r_  generation:  0.007132530212402344
local_output_nid generation:  0.000209808349609375
local_in_edges_tensor generation:  0.00046706199645996094
mini_batch_src_global generation:  0.0008003711700439453
r_  generation:  0.008042335510253906
----------------------check_connections_block total spend ----------------------------- 0.053481101989746094
generate_one_block  0.014221906661987305
generate_one_block  0.015303373336791992
generate_one_block  0.010732412338256836
generate_one_block  0.012041807174682617
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022013187408447266
gen group dst list time:  0.0007922649383544922
time for parepare:  0.001649618148803711
local_output_nid generation:  0.0009639263153076172
local_in_edges_tensor generation:  0.002644062042236328
mini_batch_src_global generation:  0.0022284984588623047
r_  generation:  0.020418882369995117
local_output_nid generation:  0.0009381771087646484
local_in_edges_tensor generation:  0.0019834041595458984
mini_batch_src_global generation:  0.0026187896728515625
r_  generation:  0.0206296443939209
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0012917518615722656
mini_batch_src_global generation:  0.001636505126953125
r_  generation:  0.018528461456298828
local_output_nid generation:  0.0008382797241210938
local_in_edges_tensor generation:  0.0012409687042236328
mini_batch_src_global generation:  0.0015187263488769531
r_  generation:  0.019086837768554688
----------------------check_connections_block total spend ----------------------------- 0.11650323867797852
generate_one_block  0.02785778045654297
generate_one_block  0.029570817947387695
generate_one_block  0.025409698486328125
generate_one_block  0.0244903564453125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019071102142333984
gen group dst list time:  0.001451253890991211
time for parepare:  0.0016999244689941406
local_output_nid generation:  0.0014145374298095703
local_in_edges_tensor generation:  0.002708911895751953
mini_batch_src_global generation:  0.0021600723266601562
r_  generation:  0.025299549102783203
local_output_nid generation:  0.0015151500701904297
local_in_edges_tensor generation:  0.002990245819091797
mini_batch_src_global generation:  0.0026886463165283203
r_  generation:  0.025722742080688477
local_output_nid generation:  0.001529693603515625
local_in_edges_tensor generation:  0.0021533966064453125
mini_batch_src_global generation:  0.0023200511932373047
r_  generation:  0.024248838424682617
local_output_nid generation:  0.0013985633850097656
local_in_edges_tensor generation:  0.0019915103912353516
mini_batch_src_global generation:  0.0018372535705566406
r_  generation:  0.02385258674621582
----------------------check_connections_block total spend ----------------------------- 0.14605307579040527
generate_one_block  0.030080795288085938
generate_one_block  0.031032562255859375
generate_one_block  0.029868125915527344
generate_one_block  0.029532909393310547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

connection checking time:  0.3320629596710205
block generation total time  0.3006927967071533
average batch blocks generation time:  0.07517319917678833
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.04445648193359375  GigaBytes
Max Memory Allocated: 0.04445648193359375  GigaBytes

torch.Size([19033, 500])
torch.Size([16762, 16])
torch.Size([11865, 16])
torch.Size([3420, 16])
torch.Size([829, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9237060546875 GB
    Memory Allocated: 2.4918980598449707  GigaBytes
Max Memory Allocated: 2.586374282836914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.05264425277709961  GigaBytes
Max Memory Allocated: 2.586374282836914  GigaBytes

torch.Size([19020, 500])
torch.Size([17234, 16])
torch.Size([11433, 16])
torch.Size([4264, 16])
torch.Size([889, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1405029296875 GB
    Memory Allocated: 2.534572124481201  GigaBytes
Max Memory Allocated: 2.6211657524108887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1385498046875 GB
    Memory Allocated: 0.051946163177490234  GigaBytes
Max Memory Allocated: 2.6211657524108887  GigaBytes

torch.Size([18765, 500])
torch.Size([15527, 16])
torch.Size([10032, 16])
torch.Size([2267, 16])
torch.Size([502, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1385498046875 GB
    Memory Allocated: 2.4322314262390137  GigaBytes
Max Memory Allocated: 2.6211657524108887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1385498046875 GB
    Memory Allocated: 0.051724910736083984  GigaBytes
Max Memory Allocated: 2.6211657524108887  GigaBytes

torch.Size([18623, 500])
torch.Size([15346, 16])
torch.Size([9567, 16])
torch.Size([2795, 16])
torch.Size([630, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1385498046875 GB
    Memory Allocated: 2.398930072784424  GigaBytes
Max Memory Allocated: 2.6211657524108887  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018906891345977783 |0.08634704351425171 |0.48998361825942993 |0.00016689300537109375 |0.4777423143386841 |0.011332988739013672 |
----------------------------------------------------------pseudo_mini_loss sum 1.3399876356124878
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  199159
Number of first layer input nodes during this epoch:  75441
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.1385498046875 GB
    Memory Allocated: 0.06972122192382812  GigaBytes
Max Memory Allocated: 2.6211657524108887  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005445480346679688
random selection method range initialization spend 0.00013446807861328125
time for parepare:  6.198883056640625e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  5.602836608886719e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.5762786865234375e-05
----------------------check_connections_block total spend ----------------------------- 0.0010929107666015625
generate_one_block  0.0016071796417236328
generate_one_block  0.0011243820190429688
generate_one_block  0.0010755062103271484
generate_one_block  0.0012226104736328125
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005733966827392578
gen group dst list time:  3.62396240234375e-05
time for parepare:  0.0002808570861816406
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0003428459167480469
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0003209114074707031
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.0003516674041748047
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0003376007080078125
----------------------check_connections_block total spend ----------------------------- 0.003068208694458008
generate_one_block  0.0015804767608642578
generate_one_block  0.0015254020690917969
generate_one_block  0.0015528202056884766
generate_one_block  0.0015740394592285156
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010352134704589844
gen group dst list time:  8.606910705566406e-05
time for parepare:  0.0007984638214111328
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.00031757354736328125
mini_batch_src_global generation:  0.00025391578674316406
r_  generation:  0.002232789993286133
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  0.00023055076599121094
r_  generation:  0.0017495155334472656
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  0.000247955322265625
r_  generation:  0.0024750232696533203
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.00023317337036132812
mini_batch_src_global generation:  0.0002505779266357422
r_  generation:  0.0022187232971191406
----------------------check_connections_block total spend ----------------------------- 0.014101266860961914
generate_one_block  0.004421710968017578
generate_one_block  0.0032949447631835938
generate_one_block  0.00437617301940918
generate_one_block  0.003976345062255859
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0022430419921875
gen group dst list time:  0.0002548694610595703
time for parepare:  0.001386404037475586
local_output_nid generation:  0.0003139972686767578
local_in_edges_tensor generation:  0.0008511543273925781
mini_batch_src_global generation:  0.0008177757263183594
r_  generation:  0.008960485458374023
local_output_nid generation:  0.00026106834411621094
local_in_edges_tensor generation:  0.0005261898040771484
mini_batch_src_global generation:  0.0008113384246826172
r_  generation:  0.007313251495361328
local_output_nid generation:  0.00031185150146484375
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.0009829998016357422
r_  generation:  0.011421442031860352
local_output_nid generation: Using backend: pytorch
 0.0003266334533691406
local_in_edges_tensor generation:  0.0006206035614013672
mini_batch_src_global generation:  0.0009107589721679688
r_  generation:  0.010813236236572266
----------------------check_connections_block total spend ----------------------------- 0.056583404541015625
generate_one_block  0.013776063919067383
generate_one_block  0.011353731155395508
generate_one_block  0.014206409454345703
generate_one_block  0.017457962036132812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018630027770996094
gen group dst list time:  0.0007588863372802734
time for parepare:  0.0016205310821533203
local_output_nid generation:  0.0009195804595947266
local_in_edges_tensor generation:  0.0017070770263671875
mini_batch_src_global generation:  0.0016155242919921875
r_  generation:  0.019962787628173828
local_output_nid generation:  0.0009539127349853516
local_in_edges_tensor generation:  0.0017306804656982422
mini_batch_src_global generation:  0.002160787582397461
r_  generation:  0.01913309097290039
local_output_nid generation:  0.0010652542114257812
local_in_edges_tensor generation:  0.0018107891082763672
mini_batch_src_global generation:  0.0016963481903076172
r_  generation:  0.02060675621032715
local_output_nid generation:  0.0011858940124511719
local_in_edges_tensor generation:  0.0016002655029296875
mini_batch_src_global generation:  0.001931905746459961
r_  generation:  0.021897554397583008
----------------------check_connections_block total spend ----------------------------- 0.1199948787689209
generate_one_block  0.02750682830810547
generate_one_block  0.02703690528869629
generate_one_block  0.028325319290161133
generate_one_block  0.02940654754638672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002300262451171875
gen group dst list time:  0.0014421939849853516
time for parepare:  0.0017499923706054688
local_output_nid generation:  0.0027904510498046875
local_in_edges_tensor generation:  0.002798318862915039
mini_batch_src_global generation:  0.0020592212677001953
r_  generation:  0.024446725845336914
local_output_nid generation:  0.0015778541564941406
local_in_edges_tensor generation:  0.0027375221252441406
mini_batch_src_global generation:  0.00264739990234375
r_  generation:  0.025292158126831055
local_output_nid generation:  0.0017421245574951172
local_in_edges_tensor generation:  0.0026569366455078125
mini_batch_src_global generation:  0.0019290447235107422
r_  generation:  0.026582002639770508
local_output_nid generation:  0.0016736984252929688
local_in_edges_tensor generation:  0.002209901809692383
mini_batch_src_global generation:  0.0021164417266845703
r_  generation:  0.02556777000427246
----------------------check_connections_block total spend ----------------------------- 0.15196943283081055
generate_one_block  0.032611846923828125
generate_one_block  0.03538346290588379
generate_one_block  0.0361783504486084
generate_one_block  0.03361177444458008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.1385498046875 GB
    Memory Allocated: 0.06972122192382812  GigaBytes
Max Memory Allocated: 2.6211657524108887  GigaBytes

connection checking time:  0.345717191696167
block generation total time  0.32915711402893066
average batch blocks generation time:  0.08228927850723267
block dataloader generation time/epoch 0.7701776027679443
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1385498046875 GB
    Memory Allocated: 0.06736612319946289  GigaBytes
Max Memory Allocated: 2.6211657524108887  GigaBytes

torch.Size([18591, 500])
torch.Size([15450, 16])
torch.Size([9222, 16])
torch.Size([3031, 16])
torch.Size([663, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1658935546875 GB
    Memory Allocated: 2.422590732574463  GigaBytes
Max Memory Allocated: 2.6211657524108887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1658935546875 GB
    Memory Allocated: 0.06797122955322266  GigaBytes
Max Memory Allocated: 2.6211657524108887  GigaBytes

torch.Size([18941, 500])
torch.Size([16039, 16])
torch.Size([10007, 16])
torch.Size([2698, 16])
torch.Size([667, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1658935546875 GB
    Memory Allocated: 2.461763381958008  GigaBytes
Max Memory Allocated: 2.6211657524108887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1658935546875 GB
    Memory Allocated: 0.0681309700012207  GigaBytes
Max Memory Allocated: 2.6211657524108887  GigaBytes

torch.Size([18950, 500])
torch.Size([16499, 16])
torch.Size([10543, 16])
torch.Size([3304, 16])
torch.Size([694, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1658935546875 GB
    Memory Allocated: 2.509518623352051  GigaBytes
Max Memory Allocated: 2.6211657524108887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1658935546875 GB
    Memory Allocated: 0.06834650039672852  GigaBytes
Max Memory Allocated: 2.6211657524108887  GigaBytes

torch.Size([19053, 500])
torch.Size([16710, 16])
torch.Size([11991, 16])
torch.Size([3472, 16])
torch.Size([775, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1658935546875 GB
    Memory Allocated: 2.5193090438842773  GigaBytes
Max Memory Allocated: 2.6211657524108887  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023818910121917725 |0.0036544203758239746 |0.3641057014465332 |0.0001436471939086914 |0.49086636304855347 |0.012266159057617188 |
----------------------------------------------------------pseudo_mini_loss sum 1.4920661449432373
Total (block generation + training)time/epoch 4.327921152114868
Training time/epoch 3.557446002960205
Training time without block to device /epoch 3.542828321456909
Training time without total dataloading part /epoch 3.4327290058135986
load block tensor time/epoch 0.0952756404876709
block to device time/epoch 0.014617681503295898
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  197655
Number of first layer input nodes during this epoch:  75535
