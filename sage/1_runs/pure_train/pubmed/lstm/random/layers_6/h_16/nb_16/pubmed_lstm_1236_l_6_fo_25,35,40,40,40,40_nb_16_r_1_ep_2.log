main start at this time 1648533725.0291228
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0020606517791748047
random selection method range initialization spend 0.00020933151245117188
time for parepare:  4.2438507080078125e-05
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.002695322036743164
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  1.9788742065429688e-05
----------------------check_connections_block total spend ----------------------------- 0.004311800003051758
generate_one_block  0.0011837482452392578
generate_one_block  0.0009715557098388672
generate_one_block  0.0009722709655761719
generate_one_block  0.0010409355163574219
generate_one_block  0.0009694099426269531
generate_one_block  0.0009527206420898438
generate_one_block  0.0009405612945556641
generate_one_block  0.0009834766387939453
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0010972023010253906
gen group dst list time:  4.839897155761719e-05
time for parepare:  0.00024247169494628906
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0002543926239013672
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00011444091796875
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0003459453582763672
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00011324882507324219
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00010728836059570312
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.00011181831359863281
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.0001087188720703125
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00013494491577148438
----------------------check_connections_block total spend ----------------------------- 0.0032782554626464844
generate_one_block  0.0012843608856201172
generate_one_block  0.0010952949523925781
generate_one_block  0.0014655590057373047
generate_one_block  0.0010788440704345703
generate_one_block  0.0010793209075927734
generate_one_block  0.0010709762573242188
generate_one_block  0.0010652542114257812
generate_one_block  0.0011162757873535156
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010724067687988281
gen group dst list time:  8.559226989746094e-05
time for parepare:  0.0006749629974365234
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.0002913475036621094
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.001447916030883789
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0006532669067382812
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.00022125244140625
mini_batch_src_global generation:  0.0002548694610595703
r_  generation:  0.002494335174560547
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  0.0001533031463623047
r_  generation:  0.0008795261383056641
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0006313323974609375
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0005137920379638672
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005524158477783203
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.0011091232299804688
----------------------check_connections_block total spend ----------------------------- 0.013972759246826172
generate_one_block  0.0035462379455566406
generate_one_block  0.0017733573913574219
generate_one_block  0.0043795108795166016
generate_one_block  0.00205230712890625
generate_one_block  0.0016932487487792969
generate_one_block  0.001535177230834961
generate_one_block  0.0016138553619384766
generate_one_block  0.0023641586303710938
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0023071765899658203
gen group dst list time:  0.00024390220642089844
time for parepare:  0.0014982223510742188
local_output_nid generation:  0.00021076202392578125
local_in_edges_tensor generation:  0.00081634521484375
mini_batch_src_global generation:  0.0009336471557617188
r_  generation:  0.0073566436767578125
local_output_nid generation:  9.942054748535156e-05
local_in_edges_tensor generation:  0.00029468536376953125
mini_batch_src_global generation:  0.0005733966827392578
r_  generation:  0.004018306732177734
local_output_nid generation:  0.0002987384796142578
local_in_edges_tensor generation:  0.0006251335144042969
mini_batch_src_global generation:  0.000762939453125
r_  generation:  0.009798526763916016
local_output_nid generation:  0.00014972686767578125
local_in_edges_tensor generation:  0.0003592967987060547
mini_batch_src_global generation:  0.0006706714630126953
r_  generation:  0.005457401275634766
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.00027108192443847656
mini_batch_src_global generation:  0.0004286766052246094
r_  generation:  0.003937959671020508
local_output_nid generation:  8.988380432128906e-05
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  0.00031113624572753906
r_  generation:  0.0027070045471191406
local_output_nid generation:  0.000102996826171875
local_in_edges_tensor generation:  0.0002608299255371094
mini_batch_src_global generation:  0.0003476142883300781
r_  generation:  0.0037386417388916016
local_output_nid generation:  0.00011563301086425781
local_in_edges_tensor generation:  0.0003113746643066406
mini_batch_src_global generation:  0.0004894733428955078
r_  generation:  0.004978656768798828
----------------------check_connections_block total spend ----------------------------- 0.06306648254394531
generate_one_block  0.011859893798828125
generate_one_block  0.006257295608520508
generate_one_block  0.014403820037841797
generate_one_block  0.008054971694946289
generate_one_block  0.006570577621459961
generate_one_block  0.004506349563598633
generate_one_block  0.0060617923736572266
generate_one_block  0.007582426071166992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002168416976928711
gen group dst list time:  0.001283407211303711
time for parepare:  0.0016522407531738281
local_output_nid generation:  0.0008845329284667969
local_in_edges_tensor generation:  0.0024302005767822266
mini_batch_src_global generation:  0.001802682876586914
r_  generation:  0.01828765869140625
local_output_nid generation:  0.0005593299865722656
local_in_edges_tensor generation:  0.0010845661163330078
mini_batch_src_global generation:  0.0015006065368652344
r_  generation:  0.01232767105102539
local_output_nid generation:  0.0008838176727294922
local_in_edges_tensor generation:  0.00262451171875
mini_batch_src_global generation:  0.0015480518341064453
r_  generation:  0.019562244415283203
local_output_nid generation:  0.000553131103515625
local_in_edges_tensor generation:  0.0010366439819335938
mini_batch_src_global generation:  0.0014655590057373047
r_  generation:  0.014412879943847656
local_output_nid generation:  0.0006248950958251953
local_in_edges_tensor generation:  0.001094818115234375
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.015247106552124023
local_output_nid generation:  0.00046896934509277344
local_in_edges_tensor generation:  0.0007693767547607422
mini_batch_src_global generation:  0.0011267662048339844
r_  generation:  0.011621713638305664
local_output_nid generation:  0.0006189346313476562
local_in_edges_tensor generation:  0.0012736320495605469
mini_batch_src_global generation:  0.0016396045684814453
r_  generation:  0.013930559158325195
local_output_nid generation:  0.0004425048828125
local_in_edges_tensor generation:  0.0007457733154296875
mini_batch_src_global generation:  0.001096487045288086
r_  generation:  0.011392593383789062
----------------------check_connections_block total spend ----------------------------- 0.17293691635131836
generate_one_block  0.0252077579498291
generate_one_block  0.017165660858154297
generate_one_block  0.026508092880249023
generate_one_block  0.02004218101501465
generate_one_block  0.019437313079833984
generate_one_block  0.015627384185791016
generate_one_block  0.018648862838745117
generate_one_block  0.017293691635131836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018520355224609375
gen group dst list time:  0.0027267932891845703
time for parepare:  0.0017168521881103516
local_output_nid generation:  0.0013554096221923828
local_in_edges_tensor generation:  0.0028450489044189453
mini_batch_src_global generation:  0.0024118423461914062
r_  generation:  0.024598360061645508
local_output_nid generation:  0.001140594482421875
local_in_edges_tensor generation:  0.0021767616271972656
mini_batch_src_global generation:  0.0022864341735839844
r_  generation:  0.020276308059692383
local_output_nid generation:  0.0018129348754882812
local_in_edges_tensor generation:  0.002444028854370117
mini_batch_src_global generation:  0.00225067138671875
r_  generation:  0.026052236557006836
local_output_nid generation:  0.001470804214477539
local_in_edges_tensor generation:  0.0017848014831542969
mini_batch_src_global generation:  0.0018723011016845703
r_  generation:  0.02239990234375
local_output_nid generation:  0.0013937950134277344
local_in_edges_tensor generation:  0.002256631851196289
mini_batch_src_global generation:  0.0018227100372314453
r_  generation:  0.02339458465576172
local_output_nid generation:  0.0012874603271484375
local_in_edges_tensor generation:  0.0016374588012695312
mini_batch_src_global generation:  0.0017902851104736328
r_  generation:  0.021712779998779297
local_output_nid generation:  0.0013155937194824219
local_in_edges_tensor generation:  0.002040386199951172
mini_batch_src_global generation:  0.001999378204345703
r_  generation:  0.022582530975341797
local_output_nid generation:  0.00098419189453125
local_in_edges_tensor generation:  0.0013365745544433594
mini_batch_src_global generation:  0.0016636848449707031
r_  generation:  0.01793050765991211
----------------------check_connections_block total spend ----------------------------- 0.2620253562927246
generate_one_block  0.030341386795043945
generate_one_block  0.02622246742248535
generate_one_block  0.031029224395751953
generate_one_block  0.028003692626953125
generate_one_block  0.028653621673583984
generate_one_block  0.0273587703704834
generate_one_block  0.028183460235595703
generate_one_block  0.023896217346191406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

connection checking time:  0.5152797698974609
block generation total time  0.477130651473999
average batch blocks generation time:  0.05964133143424988
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.04406929016113281  GigaBytes
Max Memory Allocated: 0.04406929016113281  GigaBytes

torch.Size([18887, 500])
torch.Size([16129, 16])
torch.Size([10359, 16])
torch.Size([2659, 16])
torch.Size([586, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 2.4483375549316406  GigaBytes
Max Memory Allocated: 2.5525965690612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.0474858283996582  GigaBytes
Max Memory Allocated: 2.5525965690612793  GigaBytes

torch.Size([16840, 500])
torch.Size([11346, 16])
torch.Size([5906, 16])
torch.Size([1083, 16])
torch.Size([273, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9178466796875 GB
    Memory Allocated: 2.046891212463379  GigaBytes
Max Memory Allocated: 2.5525965690612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9178466796875 GB
    Memory Allocated: 0.05181598663330078  GigaBytes
Max Memory Allocated: 2.5525965690612793  GigaBytes

torch.Size([18899, 500])
torch.Size([16868, 16])
torch.Size([10580, 16])
torch.Size([3733, 16])
torch.Size([723, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1522216796875 GB
    Memory Allocated: 2.5095906257629395  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1502685546875 GB
    Memory Allocated: 0.04945802688598633  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

torch.Size([17557, 500])
torch.Size([13197, 16])
torch.Size([6328, 16])
torch.Size([1818, 16])
torch.Size([238, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1697998046875 GB
    Memory Allocated: 2.208280086517334  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1697998046875 GB
    Memory Allocated: 0.050536155700683594  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

torch.Size([18422, 500])
torch.Size([13516, 16])
torch.Size([7581, 16])
torch.Size([1144, 16])
torch.Size([291, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1697998046875 GB
    Memory Allocated: 2.2848010063171387  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1697998046875 GB
    Memory Allocated: 0.04926729202270508  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

torch.Size([17600, 500])
torch.Size([12147, 16])
torch.Size([4764, 16])
torch.Size([968, 16])
torch.Size([225, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1697998046875 GB
    Memory Allocated: 2.1313557624816895  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1697998046875 GB
    Memory Allocated: 0.050019264221191406  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

torch.Size([18168, 500])
torch.Size([13115, 16])
torch.Size([6361, 16])
torch.Size([1085, 16])
torch.Size([261, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1697998046875 GB
    Memory Allocated: 2.2407073974609375  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1697998046875 GB
    Memory Allocated: 0.04422330856323242  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

torch.Size([15108, 500])
torch.Size([9629, 16])
torch.Size([4922, 16])
torch.Size([1488, 16])
torch.Size([301, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1697998046875 GB
    Memory Allocated: 1.836524486541748  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023317545652389526 |0.04500687122344971 |0.38983070850372314 |0.00016063451766967773 |0.4320099949836731 |0.015271186828613281 |
----------------------------------------------------------pseudo_mini_loss sum 2.013500452041626
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  321461
Number of first layer input nodes during this epoch:  141481
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.1697998046875 GB
    Memory Allocated: 0.06197690963745117  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007147789001464844
random selection method range initialization spend 0.00015211105346679688
time for parepare:  7.319450378417969e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.0742416381835938e-05
----------------------check_connections_block total spend ----------------------------- 0.0018663406372070312
generate_one_block  0.0016241073608398438
generate_one_block  0.001172780990600586
generate_one_block  0.0010874271392822266
generate_one_block  0.0010592937469482422
generate_one_block  0.0010786056518554688
generate_one_block  0.0010623931884765625
generate_one_block  0.0010597705841064453
generate_one_block  0.0010406970977783203
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007159709930419922
gen group dst list time:  5.9604644775390625e-05
time for parepare:  0.0003554821014404297
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00026679039001464844
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0002357959747314453
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00012922286987304688
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.0001468658447265625
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00024247169494628906
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00016236305236816406
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00014209747314453125
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00017881393432617188
----------------------check_connections_block total spend ----------------------------- 0.003977298736572266
generate_one_block  0.0015416145324707031
generate_one_block  0.0013446807861328125
generate_one_block  0.0012755393981933594
generate_one_block  0.00135040283203125
generate_one_block  0.0014660358428955078
generate_one_block  0.0013315677642822266
generate_one_block  0.001214742660522461
generate_one_block  0.0013301372528076172
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013427734375
gen group dst list time:  0.00011920928955078125
time for parepare:  0.0009696483612060547
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00033736228942871094
mini_batch_src_global generation:  0.0002689361572265625
r_  generation:  0.0019538402557373047
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  0.00017523765563964844
r_  generation:  0.0010731220245361328
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0006465911865234375
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  0.00010633468627929688
r_  generation:  0.0007801055908203125
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.0019893646240234375
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  0.00013446807861328125
r_  generation:  0.0007672309875488281
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.0008323192596435547
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  0.0001361370086669922
r_  generation:  0.0011622905731201172
----------------------check_connections_block total spend ----------------------------- 0.016315698623657227
generate_one_block  0.0038852691650390625
generate_one_block  0.0024077892303466797
generate_one_block  0.0017702579498291016
generate_one_block  0.0020308494567871094
generate_one_block  0.00366973876953125
generate_one_block  0.0019114017486572266
generate_one_block  0.002110004425048828
generate_one_block  0.002591371536254883
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019986629486083984
gen group dst list time:  0.00033974647521972656
time for parepare:  0.0016145706176757812
local_output_nid generation:  0.0003142356872558594
local_in_edges_tensor generation:  0.0009965896606445312
mini_batch_src_global generation:  0.0010266304016113281
r_  generation:  0.007673978805541992
local_output_nid generation:  0.00021147727966308594
local_in_edges_tensor generation:  0.00039839744567871094
mini_batch_src_global generation:  0.0006327629089355469
r_  generation:  0.00455927848815918
local_output_nid generation:  0.00011968612670898438
local_in_edges_tensor generation:  0.0003075599670410156
mini_batch_src_global generation:  0.0003864765167236328
r_  generation:  0.0033416748046875
local_output_nid generation:  0.0001380443572998047
local_in_edges_tensor generation:  0.0003178119659423828
mini_batch_src_global generation:  0.0004055500030517578
r_  generation:  0.003983974456787109
local_output_nid generation:  0.000308990478515625
local_in_edges_tensor generation:  0.0005180835723876953
mini_batch_src_global generation:  0.0007421970367431641
r_  generation:  0.008016347885131836
local_output_nid generation:  0.00011491775512695312
local_in_edges_tensor generation:  0.0009734630584716797
mini_batch_src_global generation:  0.0004546642303466797
r_  generation:  0.003256082534790039
local_output_nid generation:  0.00017023086547851562
local_in_edges_tensor generation:  0.00037288665771484375
mini_batch_src_global generation:  0.000530242919921875
r_  generation:  0.005314350128173828
local_output_nid generation:  0.0001804828643798828
local_in_edges_tensor generation:  0.0003781318664550781
mini_batch_src_global generation:  0.0006482601165771484
r_  generation:  0.006369113922119141
----------------------check_connections_block total spend ----------------------------- 0.06608748435974121
generate_one_block  0.011506795883178711
generate_one_block  0.007146120071411133
generate_one_block  0.005954742431640625
generate_one_block  0.006946563720703125
generate_one_block  0.01198887825012207
generate_one_block  0.005620718002319336
generate_one_block  0.008510828018188477
generate_one_block  0.010268211364746094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00235748291015625
gen group dst list time:  0.0012269020080566406
time for parepare:  0.001798868179321289
local_output_nid generation:  0.0008723735809326172
local_in_edges_tensor generation:  0.0017468929290771484
mini_batch_src_global generation:  0.0014739036560058594
r_  generation:  0.015799760818481445
local_output_nid generation:  0.0007081031799316406
local_in_edges_tensor generation:  0.00102996826171875
mini_batch_src_global generation:  0.0013265609741210938
r_  generation:  0.01233363151550293
local_output_nid generation:  0.0006670951843261719
local_in_edges_tensor generation:  0.0009424686431884766
mini_batch_src_global generation:  0.0010302066802978516
r_  generation:  0.012363672256469727
local_output_nid generation:  0.0007750988006591797
local_in_edges_tensor generation:  0.0010666847229003906
mini_batch_src_global generation:  0.0012431144714355469
r_  generation:  0.014472007751464844
local_output_nid generation:  0.0009436607360839844
local_in_edges_tensor generation:  0.0015358924865722656
mini_batch_src_global generation:  0.0018570423126220703
r_  generation:  0.01832413673400879
local_output_nid generation:  0.0007171630859375
local_in_edges_tensor generation:  0.0008213520050048828
mini_batch_src_global generation:  0.0012271404266357422
r_  generation:  0.012207746505737305
local_output_nid generation:  0.0009210109710693359
local_in_edges_tensor generation:  0.001157522201538086
mini_batch_src_global generation:  0.0011603832244873047
r_  generation:  0.016439199447631836
local_output_nid generation:  0.0010373592376708984
local_in_edges_tensor generation:  0.0015459060668945312
mini_batch_src_global generation:  0.0016405582427978516
r_  generation:  0.018311500549316406
----------------------check_connections_block total spend ----------------------------- 0.17815423011779785
generate_one_block  0.021822214126586914
generate_one_block  0.017800092697143555
generate_one_block  0.017441987991333008
generate_one_block  0.02009415626525879
generate_one_block  0.027524471282958984
generate_one_block  0.017148494720458984
generate_one_block  0.02231287956237793
generate_one_block  0.025126934051513672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018074512481689453
gen group dst list time:  0.002674102783203125
time for parepare:  0.0018496513366699219
local_output_nid generation:  0.0014579296112060547
local_in_edges_tensor generation:  0.0023877620697021484
mini_batch_src_global generation:  0.0019578933715820312
r_  generation:  0.0225217342376709
local_output_nid generation:  0.0013053417205810547
local_in_edges_tensor generation:  0.002137899398803711
mini_batch_src_global generation:  0.002373933792114258
r_  generation:  0.02153754234313965
local_output_nid generation:  0.0013377666473388672
local_in_edges_tensor generation:  0.0017733573913574219
mini_batch_src_global generation:  0.0017108917236328125
r_  generation:  0.021381855010986328
local_output_nid generation:  0.0015130043029785156
local_in_edges_tensor generation:  0.0022668838500976562
mini_batch_src_global generation:  0.0021011829376220703
r_  generation:  0.022907495498657227
local_output_nid generation:  0.0016510486602783203
local_in_edges_tensor generation:  0.0023577213287353516
mini_batch_src_global generation:  0.0019009113311767578
r_  generation:  0.02445507049560547
local_output_nid generation:  0.0014276504516601562
local_in_edges_tensor generation:  0.001552581787109375
mini_batch_src_global generation:  0.0017523765563964844
r_  generation:  0.021079063415527344
local_output_nid generation:  0.0014190673828125
local_in_edges_tensor generation:  0.001920938491821289
mini_batch_src_global generation: Using backend: pytorch
 0.001888275146484375
r_  generation:  0.024173736572265625
local_output_nid generation:  0.0014421939849853516
local_in_edges_tensor generation:  0.00225830078125
mini_batch_src_global generation:  0.002000093460083008
r_  generation:  0.024324893951416016
----------------------check_connections_block total spend ----------------------------- 0.26682114601135254
generate_one_block  0.030243396759033203
generate_one_block  0.029354572296142578
generate_one_block  0.028668880462646484
generate_one_block  0.03104543685913086
generate_one_block  0.03259754180908203
generate_one_block  0.02819514274597168
generate_one_block  0.03040909767150879
generate_one_block  0.03216123580932617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.1697998046875 GB
    Memory Allocated: 0.06197690963745117  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

connection checking time:  0.5313558578491211
block generation total time  0.5111207962036133
average batch blocks generation time:  0.06389009952545166
block dataloader generation time/epoch 1.2079730033874512
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1697998046875 GB
    Memory Allocated: 0.06578207015991211  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

torch.Size([17669, 500])
torch.Size([13233, 16])
torch.Size([7085, 16])
torch.Size([2372, 16])
torch.Size([513, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 2.2521419525146484  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 0.06546783447265625  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

torch.Size([17786, 500])
torch.Size([12765, 16])
torch.Size([6091, 16])
torch.Size([1788, 16])
torch.Size([379, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 2.103579521179199  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 0.06450843811035156  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

torch.Size([17279, 500])
torch.Size([11493, 16])
torch.Size([5384, 16])
torch.Size([969, 16])
torch.Size([241, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 2.0832033157348633  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 0.06636333465576172  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

torch.Size([18216, 500])
torch.Size([13202, 16])
torch.Size([6606, 16])
torch.Size([1302, 16])
torch.Size([305, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 2.256932258605957  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 0.06654119491577148  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

torch.Size([18165, 500])
torch.Size([15169, 16])
torch.Size([8470, 16])
torch.Size([2666, 16])
torch.Size([484, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 2.3833751678466797  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 0.06551599502563477  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

torch.Size([17498, 500])
torch.Size([11368, 16])
torch.Size([5025, 16])
torch.Size([1040, 16])
torch.Size([307, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 2.095871925354004  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 0.06620645523071289  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

torch.Size([18079, 500])
torch.Size([13949, 16])
torch.Size([7175, 16])
torch.Size([1692, 16])
torch.Size([242, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 2.2966861724853516  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 0.06731843948364258  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

torch.Size([18626, 500])
torch.Size([14713, 16])
torch.Size([9273, 16])
torch.Size([1891, 16])
torch.Size([418, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 2.371511459350586  GigaBytes
Max Memory Allocated: 2.6013383865356445  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017210185527801514 |0.0026707053184509277 |0.3302271366119385 |0.00014197826385498047 |0.4386305809020996 |0.010458707809448242 |
----------------------------------------------------------pseudo_mini_loss sum 1.5400408506393433
Total (block generation + training)time/epoch 7.554250955581665
Training time/epoch 6.345722436904907
Training time without block to device /epoch 6.3243567943573
Training time without total dataloading part /epoch 6.162456274032593
load block tensor time/epoch 0.1376814842224121
block to device time/epoch 0.021365642547607422
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  321285
Number of first layer input nodes during this epoch:  143318
