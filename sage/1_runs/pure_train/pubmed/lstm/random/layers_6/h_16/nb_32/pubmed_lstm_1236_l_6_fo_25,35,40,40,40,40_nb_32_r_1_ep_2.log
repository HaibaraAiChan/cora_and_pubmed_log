main start at this time 1648533749.92612
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0020494461059570312
random selection method range initialization spend 0.0001926422119140625
time for parepare:  4.863739013671875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.0010294914245605469
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.1920928955078125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.606910705566406e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9311904907226562e-05
----------------------check_connections_block total spend ----------------------------- 0.0036878585815429688
generate_one_block  0.002040386199951172
generate_one_block  0.0010023117065429688
generate_one_block  0.0009894371032714844
generate_one_block  0.0009357929229736328
generate_one_block  0.0009920597076416016
generate_one_block  0.000986337661743164
generate_one_block  0.0009360313415527344
generate_one_block  0.0009353160858154297
generate_one_block  0.000985860824584961
generate_one_block  0.0009658336639404297
generate_one_block  0.0009710788726806641
generate_one_block  0.0009510517120361328
generate_one_block  0.0009305477142333984
generate_one_block  0.000934600830078125
generate_one_block  0.0009353160858154297
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0014069080352783203
gen group dst list time:  7.939338684082031e-05
time for parepare:  0.00031256675720214844
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001697540283203125
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  9.1552734375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  9.322166442871094e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00012993812561035156
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00023293495178222656
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  6.699562072753906e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  5.2928924560546875e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  7.224082946777344e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  8.296966552734375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00015854835510253906
----------------------check_connections_block total spend ----------------------------- 0.004523515701293945
generate_one_block  0.0012509822845458984
generate_one_block  0.0010852813720703125
generate_one_block  0.0011081695556640625
generate_one_block  0.00096893310546875
generate_one_block  0.00109100341796875
generate_one_block  0.0012824535369873047
generate_one_block  0.0010569095611572266
generate_one_block  0.0009806156158447266
generate_one_block  0.0010154247283935547
generate_one_block  0.0010402202606201172
generate_one_block  0.0010089874267578125
generate_one_block  0.000997304916381836
generate_one_block  0.0010716915130615234
generate_one_block  0.0009987354278564453
generate_one_block  0.0011200904846191406
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001270294189453125
gen group dst list time:  0.00011777877807617188
time for parepare:  0.0007150173187255859
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00030994415283203125
mini_batch_src_global generation:  9.34600830078125e-05
r_  generation:  0.0009741783142089844
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0005433559417724609
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0005147457122802734
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00014519691467285156
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0007047653198242188
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.002007722854614258
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.0005838871002197266
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003314018249511719
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0003955364227294922
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.0002963542938232422
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002918243408203125
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0002532005310058594
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003952980041503906
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0001819133758544922
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  0.00010228157043457031
r_  generation:  0.0011415481567382812
----------------------check_connections_block total spend ----------------------------- 0.015705585479736328
generate_one_block  0.0030624866485595703
generate_one_block  0.0017669200897216797
generate_one_block  0.0015141963958740234
generate_one_block  0.0011212825775146484
generate_one_block  0.0018281936645507812
generate_one_block  0.003542184829711914
generate_one_block  0.0016579627990722656
generate_one_block  0.0014548301696777344
generate_one_block  0.0017545223236083984
generate_one_block  0.001264810562133789
generate_one_block  0.0012896060943603516
generate_one_block  0.0012211799621582031
generate_one_block  0.00150299072265625
generate_one_block  0.001157522201538086
generate_one_block  0.0025048255920410156
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.003900766372680664
gen group dst list time:  0.00032067298889160156
time for parepare:  0.0015943050384521484
local_output_nid generation:  0.0001614093780517578
local_in_edges_tensor generation:  0.0015878677368164062
mini_batch_src_global generation:  0.0006556510925292969
r_  generation:  0.005263566970825195
local_output_nid generation:  0.00011229515075683594
local_in_edges_tensor generation:  0.00031948089599609375
mini_batch_src_global generation:  0.0005545616149902344
r_  generation:  0.003745555877685547
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.0002651214599609375
mini_batch_src_global generation:  0.0003764629364013672
r_  generation:  0.003574848175048828
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  0.00018596649169921875
r_  generation:  0.0011692047119140625
local_output_nid generation:  0.00011682510375976562
local_in_edges_tensor generation:  0.0003104209899902344
mini_batch_src_global generation:  0.000255584716796875
r_  generation:  0.0030786991119384766
local_output_nid generation:  0.00021386146545410156
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0007526874542236328
r_  generation:  0.007768869400024414
local_output_nid generation:  9.655952453613281e-05
local_in_edges_tensor generation:  0.0002720355987548828
mini_batch_src_global generation:  0.0004937648773193359
r_  generation:  0.003668069839477539
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.00023698806762695312
mini_batch_src_global generation:  0.0003223419189453125
r_  generation:  0.002748250961303711
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.0002675056457519531
r_  generation:  0.0024399757385253906
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.0002193450927734375
r_  generation:  0.0018644332885742188
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  0.00017571449279785156
r_  generation:  0.0015883445739746094
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  0.0001437664031982422
r_  generation:  0.001219034194946289
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  0.0002446174621582031
r_  generation:  0.002594470977783203
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  0.00018072128295898438
r_  generation:  0.0012559890747070312
local_output_nid generation:  0.000110626220703125
local_in_edges_tensor generation:  0.0003008842468261719
mini_batch_src_global generation:  0.00041794776916503906
r_  generation:  0.004819631576538086
----------------------check_connections_block total spend ----------------------------- 0.07213616371154785
generate_one_block  0.008591175079345703
generate_one_block  0.0059893131256103516
generate_one_block  0.005859851837158203
generate_one_block  0.002226591110229492
generate_one_block  0.004871368408203125
generate_one_block  0.011887073516845703
generate_one_block  0.005686759948730469
generate_one_block  0.004506826400756836
generate_one_block  0.004313945770263672
generate_one_block  0.0034127235412597656
generate_one_block  0.0028989315032958984
generate_one_block  0.0024614334106445312
generate_one_block  0.004647493362426758
generate_one_block  0.0033676624298095703
generate_one_block  0.007338523864746094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002602815628051758
gen group dst list time:  0.0015311241149902344
time for parepare:  0.0017952919006347656
local_output_nid generation:  0.0006716251373291016
local_in_edges_tensor generation:  0.0017116069793701172
mini_batch_src_global generation:  0.0013446807861328125
r_  generation:  0.013863801956176758
local_output_nid generation:  0.00045680999755859375
local_in_edges_tensor generation:  0.001071929931640625
mini_batch_src_global generation:  0.001348733901977539
r_  generation:  0.01251363754272461
local_output_nid generation:  0.0004508495330810547
local_in_edges_tensor generation:  0.0009517669677734375
mini_batch_src_global generation:  0.0009875297546386719
r_  generation:  0.01160883903503418
local_output_nid generation:  0.0001823902130126953
local_in_edges_tensor generation:  0.0003924369812011719
mini_batch_src_global generation:  0.0006403923034667969
r_  generation:  0.005020856857299805
local_output_nid generation:  0.00038695335388183594
local_in_edges_tensor generation:  0.0006775856018066406
mini_batch_src_global generation:  0.00072479248046875
r_  generation:  0.009285449981689453
local_output_nid generation:  0.0006542205810546875
local_in_edges_tensor generation:  0.0014944076538085938
mini_batch_src_global generation:  0.0018069744110107422
r_  generation:  0.017548799514770508
local_output_nid generation:  0.0004863739013671875
local_in_edges_tensor generation:  0.0007593631744384766
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.01276850700378418
local_output_nid generation:  0.0003383159637451172
local_in_edges_tensor generation:  0.000576019287109375
mini_batch_src_global generation:  0.0009336471557617188
r_  generation:  0.008612871170043945
local_output_nid generation:  0.0004773139953613281
local_in_edges_tensor generation:  0.0006921291351318359
mini_batch_src_global generation:  0.0009417533874511719
r_  generation:  0.010789155960083008
local_output_nid generation:  0.0003829002380371094
local_in_edges_tensor generation:  0.0006043910980224609
mini_batch_src_global generation:  0.0009102821350097656
r_  generation:  0.008945703506469727
local_output_nid generation:  0.0002384185791015625
local_in_edges_tensor generation:  0.000453948974609375
mini_batch_src_global generation:  0.0006906986236572266
r_  generation:  0.006955623626708984
local_output_nid generation:  0.00019860267639160156
local_in_edges_tensor generation:  0.0016379356384277344
mini_batch_src_global generation:  0.0005433559417724609
r_  generation:  0.005228281021118164
local_output_nid generation:  0.00038814544677734375
local_in_edges_tensor generation:  0.000675201416015625
mini_batch_src_global generation:  0.0009450912475585938
r_  generation:  0.010730981826782227
local_output_nid generation:  0.0002243518829345703
local_in_edges_tensor generation:  0.0004534721374511719
mini_batch_src_global generation:  0.0007734298706054688
r_  generation:  0.006927490234375
local_output_nid generation:  0.00038886070251464844
local_in_edges_tensor generation:  0.0007936954498291016
mini_batch_src_global generation:  0.0010793209075927734
r_  generation:  0.011527299880981445
----------------------check_connections_block total spend ----------------------------- 0.22347784042358398
generate_one_block  0.018656253814697266
generate_one_block  0.017396211624145508
generate_one_block  0.015311002731323242
generate_one_block  0.007784128189086914
generate_one_block  0.012801170349121094
generate_one_block  0.02313971519470215
generate_one_block  0.017022132873535156
generate_one_block  0.012871265411376953
generate_one_block  0.013502120971679688
generate_one_block  0.013029098510742188
generate_one_block  0.010059118270874023
generate_one_block  0.007554531097412109
generate_one_block  0.014997482299804688
generate_one_block  0.01011514663696289
generate_one_block  0.015874862670898438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018382072448730469
gen group dst list time:  0.004212617874145508
time for parepare:  0.0017061233520507812
local_output_nid generation:  0.0011615753173828125
local_in_edges_tensor generation:  0.0024063587188720703
mini_batch_src_global generation:  0.0019145011901855469
r_  generation:  0.021604537963867188
local_output_nid generation:  0.001064300537109375
local_in_edges_tensor generation:  0.002212047576904297
mini_batch_src_global generation:  0.0023860931396484375
r_  generation:  0.020661592483520508
local_output_nid generation:  0.000993967056274414
local_in_edges_tensor generation:  0.0017385482788085938
mini_batch_src_global generation:  0.001535654067993164
r_  generation:  0.018790483474731445
local_output_nid generation:  0.0005006790161132812
local_in_edges_tensor generation:  0.0007510185241699219
mini_batch_src_global generation:  0.0010595321655273438
r_  generation:  0.010904550552368164
local_output_nid generation:  0.00113677978515625
local_in_edges_tensor generation:  0.0015044212341308594
mini_batch_src_global generation:  0.0014028549194335938
r_  generation:  0.018912792205810547
local_output_nid generation:  0.0012378692626953125
local_in_edges_tensor generation:  0.0024347305297851562
mini_batch_src_global generation:  0.0021080970764160156
r_  generation:  0.02397942543029785
local_output_nid generation:  0.001184225082397461
local_in_edges_tensor generation:  0.0016758441925048828
mini_batch_src_global generation:  0.00171661376953125
r_  generation:  0.02109813690185547
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.0011303424835205078
mini_batch_src_global generation:  0.00142669677734375
r_  generation:  0.016521215438842773
local_output_nid generation:  0.0009756088256835938
local_in_edges_tensor generation:  0.0016679763793945312
mini_batch_src_global generation:  0.0018222332000732422
r_  generation:  0.020465850830078125
local_output_nid generation:  0.0009119510650634766
local_in_edges_tensor generation:  0.0017001628875732422
mini_batch_src_global generation:  0.001667022705078125
r_  generation:  0.019199609756469727
local_output_nid generation:  0.0007772445678710938
local_in_edges_tensor generation:  0.0010991096496582031
mini_batch_src_global generation:  0.001329183578491211
r_  generation:  0.016301393508911133
local_output_nid generation:  0.0006835460662841797
local_in_edges_tensor generation:  0.0009827613830566406
mini_batch_src_global generation:  0.001203298568725586
r_  generation:  0.013581514358520508
local_output_nid generation:  0.0009984970092773438
local_in_edges_tensor generation:  0.0018696784973144531
mini_batch_src_global generation:  0.0017592906951904297
r_  generation:  0.019866943359375
local_output_nid generation:  0.0007541179656982422
local_in_edges_tensor generation:  0.0012354850769042969
mini_batch_src_global generation:  0.0015406608581542969
r_  generation:  0.016676664352416992
local_output_nid generation:  0.0008716583251953125
local_in_edges_tensor generation:  0.001264810562133789
mini_batch_src_global generation:  0.001615762710571289
r_  generation:  0.01827383041381836
----------------------check_connections_block total spend ----------------------------- 0.4007549285888672
generate_one_block  0.027042388916015625
generate_one_block  0.027811288833618164
generate_one_block  0.02432394027709961
generate_one_block  0.014972925186157227
generate_one_block  0.02390766143798828
generate_one_block  0.030127763748168945
generate_one_block  0.027083635330200195
generate_one_block  0.021082639694213867
generate_one_block  0.026727676391601562
generate_one_block  0.025269031524658203
generate_one_block  0.023862123489379883
generate_one_block  0.017733097076416016
generate_one_block  0.02587151527404785
generate_one_block  0.021953344345092773
generate_one_block  0.023616313934326172
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

connection checking time:  0.7165980339050293
block generation total time  0.692279577255249
average batch blocks generation time:  0.0461519718170166
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.042583465576171875  GigaBytes
Max Memory Allocated: 0.042583465576171875  GigaBytes

torch.Size([18242, 500])
torch.Size([13255, 16])
torch.Size([7908, 16])
torch.Size([1827, 16])
torch.Size([395, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 2.178239345550537  GigaBytes
Max Memory Allocated: 2.288529872894287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 0.04821014404296875  GigaBytes
Max Memory Allocated: 2.288529872894287  GigaBytes

torch.Size([17234, 500])
torch.Size([11928, 16])
torch.Size([5240, 16])
torch.Size([1103, 16])
torch.Size([199, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6131591796875 GB
    Memory Allocated: 2.0994434356689453  GigaBytes
Max Memory Allocated: 2.288529872894287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6131591796875 GB
    Memory Allocated: 0.04556989669799805  GigaBytes
Max Memory Allocated: 2.288529872894287  GigaBytes

torch.Size([15856, 500])
torch.Size([10131, 16])
torch.Size([5257, 16])
torch.Size([878, 16])
torch.Size([216, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6131591796875 GB
    Memory Allocated: 1.9039158821105957  GigaBytes
Max Memory Allocated: 2.288529872894287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6131591796875 GB
    Memory Allocated: 0.03515768051147461  GigaBytes
Max Memory Allocated: 2.288529872894287  GigaBytes

torch.Size([10464, 500])
torch.Size([4937, 16])
torch.Size([1801, 16])
torch.Size([262, 16])
torch.Size([57, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6131591796875 GB
    Memory Allocated: 1.138117790222168  GigaBytes
Max Memory Allocated: 2.288529872894287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6131591796875 GB
    Memory Allocated: 0.04706907272338867  GigaBytes
Max Memory Allocated: 2.288529872894287  GigaBytes

torch.Size([16706, 500])
torch.Size([11131, 16])
torch.Size([4719, 16])
torch.Size([1322, 16])
torch.Size([278, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6131591796875 GB
    Memory Allocated: 1.8461432456970215  GigaBytes
Max Memory Allocated: 2.288529872894287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6131591796875 GB
    Memory Allocated: 0.05031728744506836  GigaBytes
Max Memory Allocated: 2.288529872894287  GigaBytes

torch.Size([18179, 500])
torch.Size([15081, 16])
torch.Size([8263, 16])
torch.Size([2743, 16])
torch.Size([450, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.3630800247192383  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.04781818389892578  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([17018, 500])
torch.Size([11909, 16])
torch.Size([5037, 16])
torch.Size([1134, 16])
torch.Size([151, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.095341205596924  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.041436195373535156  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([13710, 500])
torch.Size([8503, 16])
torch.Size([3316, 16])
torch.Size([831, 16])
torch.Size([88, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.6433420181274414  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.048270225524902344  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([17315, 500])
torch.Size([11174, 16])
torch.Size([5085, 16])
torch.Size([703, 16])
torch.Size([173, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.0569796562194824  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.04698324203491211  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([16667, 500])
torch.Size([9678, 16])
torch.Size([3979, 16])
torch.Size([484, 16])
torch.Size([121, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.931541919708252  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.043306827545166016  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([14769, 500])
torch.Size([8025, 16])
torch.Size([2727, 16])
torch.Size([469, 16])
torch.Size([133, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.6079435348510742  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.04134416580200195  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([13786, 500])
torch.Size([7145, 16])
torch.Size([2239, 16])
torch.Size([509, 16])
torch.Size([92, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.3220057487487793  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.04736661911010742  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([16835, 500])
torch.Size([10803, 16])
torch.Size([4834, 16])
torch.Size([724, 16])
torch.Size([189, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9901494979858398  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.043057918548583984  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([14635, 500])
torch.Size([8054, 16])
torch.Size([2400, 16])
torch.Size([388, 16])
torch.Size([72, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.6675333976745605  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.044316768646240234  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([15155, 500])
torch.Size([9808, 16])
torch.Size([4923, 16])
torch.Size([1510, 16])
torch.Size([301, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.8492379188537598  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016248416900634766 |0.024602524439493813 |0.3247578779856364 |0.00014828046162923176 |0.3922385851542155 |0.013685226440429688 |
----------------------------------------------------------pseudo_mini_loss sum 2.0457284450531006
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  474019
Number of first layer input nodes during this epoch:  236571
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.061898231506347656  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007474422454833984
random selection method range initialization spend 0.000156402587890625
time for parepare:  7.581710815429688e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  5.316734313964844e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.2411346435546875e-05
----------------------check_connections_block total spend ----------------------------- 0.003033161163330078
generate_one_block  0.0014040470123291016
generate_one_block  0.001168966293334961
generate_one_block  0.0010585784912109375
generate_one_block  0.0010907649993896484
generate_one_block  0.00104522705078125
generate_one_block  0.0010478496551513672
generate_one_block  0.0010809898376464844
generate_one_block  0.0010628700256347656
generate_one_block  0.001043558120727539
generate_one_block  0.0010409355163574219
generate_one_block  0.0010459423065185547
generate_one_block  0.0010612010955810547
generate_one_block  0.0009744167327880859
generate_one_block  0.0010204315185546875
generate_one_block  0.001031637191772461
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007746219635009766
gen group dst list time:  8.678436279296875e-05
time for parepare:  0.00036787986755371094
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0002357959747314453
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.00017786026000976562
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00011086463928222656
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.887580871582031e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0001780986785888672
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  8.082389831542969e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.151199340820312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  6.961822509765625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  9.202957153320312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00017595291137695312
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  7.987022399902344e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.700920104980469e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  9.5367431640625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00018143653869628906
----------------------check_connections_block total spend ----------------------------- 0.005355358123779297
generate_one_block  0.0014421939849853516
generate_one_block  0.0011897087097167969
generate_one_block  0.0010776519775390625
generate_one_block  0.0013699531555175781
generate_one_block  0.001148223876953125
generate_one_block  0.001100778579711914
generate_one_block  0.001146078109741211
generate_one_block  0.0011749267578125
generate_one_block  0.0020856857299804688
generate_one_block  0.0011281967163085938
generate_one_block  0.0011320114135742188
generate_one_block  0.0011477470397949219
generate_one_block  0.0010821819305419922
generate_one_block  0.0010645389556884766
generate_one_block  0.0012798309326171875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001344919204711914
gen group dst list time:  0.00015497207641601562
time for parepare:  0.001035451889038086
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.0003960132598876953
mini_batch_src_global generation:  0.00021266937255859375
r_  generation:  0.0013663768768310547
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  0.00013566017150878906
r_  generation:  0.0007174015045166016
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.000217437744140625
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  0.00010371208190917969
r_  generation:  0.0008962154388427734
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.00046825408935546875
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.00020575523376464844
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004177093505859375
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0004112720489501953
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0014452934265136719
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.0006830692291259766
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0004010200500488281
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0004646778106689453
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.00033283233642578125
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.000514984130859375
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.00013494491577148438
r_  generation:  0.0012059211730957031
----------------------check_connections_block total spend ----------------------------- 0.01859569549560547
generate_one_block  0.0030181407928466797
generate_one_block  0.002042531967163086
generate_one_block  0.0012543201446533203
generate_one_block  0.002204418182373047
generate_one_block  0.0015728473663330078
generate_one_block  0.0013120174407958984
generate_one_block  0.0015311241149902344
generate_one_block  0.0014829635620117188
generate_one_block  0.0027980804443359375
generate_one_block  0.001968860626220703
generate_one_block  0.001453399658203125
generate_one_block  0.0015668869018554688
generate_one_block  0.0014030933380126953
generate_one_block  0.001706838607788086
generate_one_block  0.002629518508911133
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001997709274291992
gen group dst list time:  0.0004177093505859375
time for parepare:  0.0017735958099365234
local_output_nid generation:  0.00021505355834960938
local_in_edges_tensor generation:  0.0009407997131347656
mini_batch_src_global generation:  0.0007932186126708984
r_  generation:  0.0056650638580322266
local_output_nid generation:  0.00014519691467285156
local_in_edges_tensor generation:  0.00037169456481933594
mini_batch_src_global generation:  0.0005536079406738281
r_  generation:  0.004575490951538086
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  0.0002522468566894531
r_  generation:  0.0014090538024902344
local_output_nid generation:  0.00015807151794433594
local_in_edges_tensor generation:  0.0003421306610107422
mini_batch_src_global generation:  0.00029969215393066406
r_  generation:  0.0034050941467285156
local_output_nid generation:  8.7738037109375e-05
local_in_edges_tensor generation:  0.0002799034118652344
mini_batch_src_global generation:  0.00030803680419921875
r_  generation:  0.0026426315307617188
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  0.0001647472381591797
r_  generation:  0.000858306884765625
local_output_nid generation:  8.153915405273438e-05
local_in_edges_tensor generation:  0.00026226043701171875
mini_batch_src_global generation:  0.0002257823944091797
r_  generation:  0.0022428035736083984
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  0.0002377033233642578
r_  generation:  0.001936197280883789
local_output_nid generation:  0.00015544891357421875
local_in_edges_tensor generation:  0.00039267539978027344
mini_batch_src_global generation:  0.0004756450653076172
r_  generation:  0.00509953498840332
local_output_nid generation:  0.00017142295837402344
local_in_edges_tensor generation:  0.00035500526428222656
mini_batch_src_global generation:  0.00048041343688964844
r_  generation:  0.004441976547241211
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.00023293495178222656
mini_batch_src_global generation:  0.00029349327087402344
r_  generation:  0.0018854141235351562
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.00024509429931640625
mini_batch_src_global generation:  0.0002269744873046875
r_  generation:  0.0018804073333740234
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  0.00019788742065429688
r_  generation:  0.0016951560974121094
local_output_nid generation:  0.00012230873107910156
local_in_edges_tensor generation:  0.0003037452697753906
mini_batch_src_global generation:  0.00037169456481933594
r_  generation:  0.0037407875061035156
local_output_nid generation:  0.00021004676818847656
local_in_edges_tensor generation:  0.00042819976806640625
mini_batch_src_global generation:  0.0006344318389892578
r_  generation:  0.006462812423706055
----------------------check_connections_block total spend ----------------------------- 0.07552170753479004
generate_one_block  0.009403705596923828
generate_one_block  0.007463216781616211
generate_one_block  0.003084421157836914
generate_one_block  0.006376028060913086
generate_one_block  0.005125522613525391
generate_one_block  0.0021283626556396484
generate_one_block  0.0044345855712890625
generate_one_block  0.004089832305908203
generate_one_block  0.008212089538574219
generate_one_block  0.0074269771575927734
generate_one_block  0.0036458969116210938
generate_one_block  0.0037577152252197266
generate_one_block  0.003381013870239258
generate_one_block  0.006520509719848633
generate_one_block  0.010901689529418945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002431154251098633
gen group dst list time:  0.0016982555389404297
time for parepare:  0.0018661022186279297
local_output_nid generation:  0.0007746219635009766
local_in_edges_tensor generation:  0.0018458366394042969
mini_batch_src_global generation:  0.0013689994812011719
r_  generation:  0.012619495391845703
local_output_nid generation:  0.0006067752838134766
local_in_edges_tensor generation:  0.0010004043579101562
mini_batch_src_global generation:  0.0013229846954345703
r_  generation:  0.012459039688110352
local_output_nid generation:  0.00033473968505859375
local_in_edges_tensor generation:  0.0005919933319091797
mini_batch_src_global generation:  0.0006823539733886719
r_  generation:  0.005776643753051758
local_output_nid generation:  0.0006134510040283203
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0009112358093261719
r_  generation:  0.011039972305297852
local_output_nid generation:  0.0005838871002197266
local_in_edges_tensor generation:  0.0008399486541748047
mini_batch_src_global generation:  0.0009274482727050781
r_  generation:  0.010540246963500977
local_output_nid generation:  0.0002143383026123047
local_in_edges_tensor generation:  0.0004220008850097656
mini_batch_src_global generation:  0.0006163120269775391
r_  generation:  0.004675149917602539
local_output_nid generation:  0.0004608631134033203
local_in_edges_tensor generation:  0.0007302761077880859
mini_batch_src_global generation:  0.0008692741394042969
r_  generation:  0.009901285171508789
local_output_nid generation:  0.0004899501800537109
local_in_edges_tensor generation:  0.0006697177886962891
mini_batch_src_global generation:  0.0007569789886474609
r_  generation:  0.007397651672363281
local_output_nid generation:  0.0006680488586425781
local_in_edges_tensor generation:  0.0008778572082519531
mini_batch_src_global generation:  0.00101470947265625
r_  generation:  0.012210607528686523
local_output_nid generation:  0.0008227825164794922
local_in_edges_tensor generation:  0.0010840892791748047
mini_batch_src_global generation:  0.001474142074584961
r_  generation:  0.015781641006469727
local_output_nid generation:  0.00038743019104003906
local_in_edges_tensor generation:  0.0005636215209960938
mini_batch_src_global generation:  0.00089263916015625
r_  generation:  0.007637739181518555
local_output_nid generation:  0.0004534721374511719
local_in_edges_tensor generation:  0.0005781650543212891
mini_batch_src_global generation:  0.0006344318389892578
r_  generation:  0.006505250930786133
local_output_nid generation:  0.00038123130798339844
local_in_edges_tensor generation:  0.0005254745483398438
mini_batch_src_global generation:  0.0006144046783447266
r_  generation:  0.006438016891479492
local_output_nid generation:  0.000667572021484375
local_in_edges_tensor generation:  0.0008602142333984375
mini_batch_src_global generation:  0.001081228256225586
r_  generation:  0.013009786605834961
local_output_nid generation:  0.0011448860168457031
local_in_edges_tensor generation:  0.001434326171875
mini_batch_src_global generation:  0.0015552043914794922
r_  generation:  0.018435955047607422
----------------------check_connections_block total spend ----------------------------- 0.23010802268981934
generate_one_block  0.02049088478088379
generate_one_block  0.018860340118408203
generate_one_block  0.010033130645751953
generate_one_block  0.015004634857177734
generate_one_block  0.015436649322509766
generate_one_block  0.007810354232788086
generate_one_block  0.01472330093383789
generate_one_block  0.011350154876708984
generate_one_block  0.017157793045043945
generate_one_block  0.023023128509521484
generate_one_block  0.01260995864868164
generate_one_block  0.010007143020629883
generate_one_block  0.010061264038085938
generate_one_block  0.018086910247802734
generate_one_block  0.02612018585205078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018553733825683594
gen group dst list time:  0.004328727722167969
time for parepare:  0.0019423961639404297
local_output_nid generation:  0.001373291015625
local_in_edges_tensor generation:  0.002119302749633789
mini_batch_src_global generation:  0.001779317855834961
r_  generation:  0.020607471466064453
local_output_nid generation:  0.0013041496276855469
local_in_edges_tensor generation:  0.0020368099212646484
mini_batch_src_global generation:  0.0023124217987060547
r_  generation:  0.020717382431030273
local_output_nid generation:  0.0009884834289550781
local_in_edges_tensor generation:  0.0012691020965576172
mini_batch_src_global generation:  0.0013763904571533203
r_  generation:  0.01570582389831543
local_output_nid generation:  0.0015132427215576172
local_in_edges_tensor generation:  0.0017273426055908203
mini_batch_src_global generation:  0.0015377998352050781
r_  generation:  0.02089381217956543
local_output_nid generation:  0.001336812973022461
local_in_edges_tensor generation:  0.0017023086547851562
mini_batch_src_global generation:  0.0017311573028564453
r_  generation:  0.0203702449798584
local_output_nid generation:  0.0007927417755126953
local_in_edges_tensor generation:  0.0010323524475097656
mini_batch_src_global generation:  0.0013952255249023438
r_  generation:  0.013598442077636719
local_output_nid generation:  0.0014584064483642578
local_in_edges_tensor generation:  0.0015196800231933594
mini_batch_src_global generation:  0.0014429092407226562
r_  generation:  0.020493507385253906
local_output_nid generation:  0.0010139942169189453
local_in_edges_tensor generation:  0.001482248306274414
mini_batch_src_global generation:  0.0015575885772705078
r_  generation:  0.018193960189819336
local_output_nid generation:  0.0012621879577636719
local_in_edges_tensor generation:  0.0015168190002441406
mini_batch_src_global generation:  0.0015637874603271484
r_  generation:  0.020333051681518555
local_output_nid generation:  0.001730203628540039
local_in_edges_tensor generation:  0.0022051334381103516
mini_batch_src_global generation:  0.0019421577453613281
r_  generation:  0.024083852767944336
local_output_nid generation:  0.0009737014770507812
local_in_edges_tensor generation:  0.001245260238647461
mini_batch_src_global generation:  0.0016241073608398438
r_  generation:  0.017349720001220703
local_output_nid generation:  0.0009894371032714844
local_in_edges_tensor generation:  0.0012569427490234375
mini_batch_src_global generation:  0.0014638900756835938
r_  generation:  0.016823530197143555
local_output_nid generation:  0.0010137557983398438
local_in_edges_tensor generation:  0.0012235641479492188
mini_batch_src_global generation:  0.001262664794921875
r_  generation:  0.016135692596435547
local_output_nid generation:  0.00128936767578125
local_in_edges_tensor generation:  0.0018074512481689453
mini_batch_src_global generation:  0.001737833023071289
r_  generation:  0.021227121353149414
local_output_nid generation:  0.0015370845794677734
local_in_edges_tensor generation:  0.0025959014892578125
mini_batch_src_global generation:  0.002209901809692383
r_  generation:  0.024732589721679688
----------------------check_connections_block total spend ----------------------------- 0.4261319637298584
generate_one_block  0.028584003448486328
generate_one_block  0.029023408889770508
generate_one_block  0.02231597900390625
generate_one_block  0.028285503387451172
generate_one_block  0.028005361557006836
generate_one_block  0.01899266242980957
generate_one_block  0.0276792049407959
generate_one_block  0.025528907775878906
generate_one_block  0.027446746826171875
generate_one_block  0.031787872314453125
generate_one_block  0.024274587631225586
generate_one_block  0.02596735954284668
generate_one_block  0.02243781089782715
generate_one_block  0.029252052307128906
generate_one_block  0.033203840255737305
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.061898231506347656  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

connection checking time:  0.7557127475738525
block generation total time  0.7660274505615234
average batch blocks generation time:  0.05106849670410156
block dataloader generation time/epoch 1.7857675552368164
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.06279468536376953  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([16411, 500])
torch.Size([10989, 16])
torch.Size([5396, 16])
torch.Size([1608, 16])
torch.Size([341, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.032021999359131  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.06287431716918945  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([16483, 500])
torch.Size([11312, 16])
torch.Size([5081, 16])
torch.Size([1231, 16])
torch.Size([187, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.0394067764282227  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.0595703125  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([14916, 500])
torch.Size([7518, 16])
torch.Size([2623, 16])
torch.Size([402, 16])
torch.Size([68, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.5007085800170898  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.06417465209960938  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([17226, 500])
torch.Size([11982, 16])
torch.Size([5114, 16])
torch.Size([1499, 16])
torch.Size([311, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.01556396484375  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.06310844421386719  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([16671, 500])
torch.Size([10329, 16])
torch.Size([4553, 16])
torch.Size([742, 16])
torch.Size([150, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.969437599182129  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.05355691909790039  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([11730, 500])
torch.Size([5393, 16])
torch.Size([1643, 16])
torch.Size([266, 16])
torch.Size([93, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.3256173133850098  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.0626077651977539  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([16411, 500])
torch.Size([10660, 16])
torch.Size([3665, 16])
torch.Size([731, 16])
torch.Size([119, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9947943687438965  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.06279277801513672  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([16584, 500])
torch.Size([8624, 16])
torch.Size([3856, 16])
torch.Size([608, 16])
torch.Size([188, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.7636990547180176  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.062652587890625  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([16351, 500])
torch.Size([10395, 16])
torch.Size([5215, 16])
torch.Size([1423, 16])
torch.Size([338, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9741697311401367  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.06543779373168945  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([17784, 500])
torch.Size([14271, 16])
torch.Size([6428, 16])
torch.Size([1503, 16])
torch.Size([153, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.3045740127563477  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.05936479568481445  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([14740, 500])
torch.Size([8017, 16])
torch.Size([2832, 16])
torch.Size([558, 16])
torch.Size([125, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.6981110572814941  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.06114768981933594  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([15658, 500])
torch.Size([8110, 16])
torch.Size([3217, 16])
torch.Size([631, 16])
torch.Size([194, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.6202058792114258  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.059844970703125  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([15044, 500])
torch.Size([8331, 16])
torch.Size([2851, 16])
torch.Size([614, 16])
torch.Size([107, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.5278902053833008  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.06396245956420898  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([17063, 500])
torch.Size([11375, 16])
torch.Size([5228, 16])
torch.Size([1102, 16])
torch.Size([135, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.0886001586914062  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 0.06717157363891602  GigaBytes
Max Memory Allocated: 2.4595751762390137  GigaBytes

torch.Size([18637, 500])
torch.Size([14828, 16])
torch.Size([9579, 16])
torch.Size([1920, 16])
torch.Size([418, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 2.376211643218994  GigaBytes
Max Memory Allocated: 2.481706142425537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014919360478719076 |0.0029729207356770835 |0.293711789449056 |0.00013515154520670573 |0.39233630498250327 |0.01118326187133789 |
----------------------------------------------------------pseudo_mini_loss sum 1.6404409408569336
Total (block generation + training)time/epoch 12.406086206436157
Training time/epoch 10.619893074035645
Training time without block to device /epoch 10.575299263000488
Training time without total dataloading part /epoch 10.303931951522827
load block tensor time/epoch 0.22379040718078613
block to device time/epoch 0.04459381103515625
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  479246
Number of first layer input nodes during this epoch:  241709
