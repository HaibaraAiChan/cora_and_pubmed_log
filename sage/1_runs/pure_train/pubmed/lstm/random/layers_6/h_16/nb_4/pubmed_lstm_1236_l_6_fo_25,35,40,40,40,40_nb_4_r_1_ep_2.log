main start at this time 1648533691.9868276
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.002108335494995117
random selection method range initialization spend 0.0002779960632324219
time for parepare:  4.8160552978515625e-05
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00021600723266601562
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0030612945556640625
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  5.53131103515625e-05
----------------------check_connections_block total spend ----------------------------- 0.0037767887115478516
generate_one_block  0.0014154911041259766
generate_one_block  0.00106048583984375
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0010671615600585938
gen group dst list time:  2.288818359375e-05
time for parepare:  0.0002484321594238281
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00021600723266601562
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.000762939453125
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0005009174346923828
----------------------check_connections_block total spend ----------------------------- 0.0024182796478271484
generate_one_block  0.0020322799682617188
generate_one_block  0.0016324520111083984
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0009889602661132812
gen group dst list time:  5.7220458984375e-05
time for parepare:  0.0006594657897949219
local_output_nid generation:  0.00013828277587890625
local_in_edges_tensor generation:  0.0005526542663574219
mini_batch_src_global generation:  0.00046372413635253906
r_  generation:  0.004589557647705078
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.0002551078796386719
mini_batch_src_global generation:  0.0003936290740966797
r_  generation:  0.0029168128967285156
----------------------check_connections_block total spend ----------------------------- 0.012208700180053711
generate_one_block  0.007709026336669922
generate_one_block  0.0048143863677978516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021560192108154297
gen group dst list time:  0.00017833709716796875
time for parepare:  0.0013477802276611328
local_output_nid generation:  0.0004456043243408203
local_in_edges_tensor generation:  0.001268625259399414
mini_batch_src_global generation:  0.0014960765838623047
r_  generation:  0.014559507369995117
local_output_nid generation:  0.0003120899200439453
local_in_edges_tensor generation:  0.0007655620574951172
mini_batch_src_global generation:  0.0013005733489990234
r_  generation:  0.011841058731079102
----------------------check_connections_block total spend ----------------------------- 0.040079593658447266
generate_one_block  0.02090144157409668
generate_one_block  0.017154693603515625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001926422119140625
gen group dst list time:  0.00047659873962402344
time for parepare:  0.0015261173248291016
local_output_nid generation:  0.001027822494506836
local_in_edges_tensor generation:  0.0022478103637695312
mini_batch_src_global generation:  0.002142190933227539
r_  generation:  0.023085355758666992
local_output_nid generation:  0.0009982585906982422
local_in_edges_tensor generation:  0.0021123886108398438
mini_batch_src_global generation:  0.002477884292602539
r_  generation:  0.02171158790588379
----------------------check_connections_block total spend ----------------------------- 0.06757926940917969
generate_one_block  0.029767513275146484
generate_one_block  0.027709484100341797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018460750579833984
gen group dst list time:  0.0007302761077880859
time for parepare:  0.0015864372253417969
local_output_nid generation:  0.0013883113861083984
local_in_edges_tensor generation:  0.002681255340576172
mini_batch_src_global generation:  0.0021407604217529297
r_  generation:  0.025662660598754883
local_output_nid generation:  0.0014233589172363281
local_in_edges_tensor generation:  0.0024209022521972656
mini_batch_src_global generation:  0.0026178359985351562
r_  generation:  0.025235652923583984
----------------------check_connections_block total spend ----------------------------- 0.07630801200866699
generate_one_block  0.03226804733276367
generate_one_block  0.03119969367980957
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

connection checking time:  0.1985938549041748
block generation total time  0.17518901824951172
average batch blocks generation time:  0.08759450912475586
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.04534292221069336  GigaBytes
Max Memory Allocated: 0.04534292221069336  GigaBytes

torch.Size([19349, 500])
torch.Size([18229, 16])
torch.Size([14711, 16])
torch.Size([6275, 16])
torch.Size([1627, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 2.613011360168457  GigaBytes
Max Memory Allocated: 2.678971290588379  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.05300760269165039  GigaBytes
Max Memory Allocated: 2.678971290588379  GigaBytes

torch.Size([19192, 500])
torch.Size([17207, 16])
torch.Size([12989, 16])
torch.Size([4330, 16])
torch.Size([1117, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 2.555765151977539  GigaBytes
Max Memory Allocated: 2.678971290588379  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02720355987548828 |0.1726924180984497 |0.6537317037582397 |0.00022804737091064453 |0.4912137985229492 |0.012151241302490234 |
----------------------------------------------------------pseudo_mini_loss sum 1.6483423709869385
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  115381
Number of first layer input nodes during this epoch:  38541
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.07148075103759766  GigaBytes
Max Memory Allocated: 2.678971290588379  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00054931640625
random selection method range initialization spend 0.00012540817260742188
time for parepare:  5.698204040527344e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012254714965820312Using backend: pytorch

mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  6.461143493652344e-05
----------------------check_connections_block total spend ----------------------------- 0.0008432865142822266
generate_one_block  0.001256704330444336
generate_one_block  0.0012485980987548828
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005447864532470703
gen group dst list time:  2.9802322387695312e-05
time for parepare:  0.0002675056457519531
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  7.462501525878906e-05
r_  generation:  0.0006325244903564453
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  0.00010538101196289062
r_  generation:  0.0006315708160400391
----------------------check_connections_block total spend ----------------------------- 0.002488851547241211
generate_one_block  0.0020058155059814453
generate_one_block  0.0020465850830078125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001013040542602539
gen group dst list time:  6.461143493652344e-05
time for parepare:  0.0007975101470947266
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.00041556358337402344
mini_batch_src_global generation:  0.0003657341003417969
r_  generation:  0.004991292953491211
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.00032210350036621094
mini_batch_src_global generation:  0.00046515464782714844
r_  generation:  0.004547834396362305
----------------------check_connections_block total spend ----------------------------- 0.014427900314331055
generate_one_block  0.007112979888916016
generate_one_block  0.0068395137786865234
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021200180053710938
gen group dst list time:  0.00020122528076171875
time for parepare:  0.0013723373413085938
local_output_nid generation:  0.0003991127014160156
local_in_edges_tensor generation:  0.0011224746704101562
mini_batch_src_global generation:  0.0012776851654052734
r_  generation:  0.013508319854736328
local_output_nid generation:  0.00045037269592285156
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0015401840209960938
r_  generation:  0.014673709869384766
----------------------check_connections_block total spend ----------------------------- 0.04239010810852051
generate_one_block  0.020427227020263672
generate_one_block  0.022874832153320312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017809867858886719
gen group dst list time:  0.0005061626434326172
time for parepare:  0.0014393329620361328
local_output_nid generation:  0.0010421276092529297
local_in_edges_tensor generation:  0.0022683143615722656
mini_batch_src_global generation:  0.0018618106842041016
r_  generation:  0.022637367248535156
local_output_nid generation:  0.0012133121490478516
local_in_edges_tensor generation:  0.0025336742401123047
mini_batch_src_global generation:  0.002789020538330078
r_  generation:  0.02406167984008789
----------------------check_connections_block total spend ----------------------------- 0.07068967819213867
generate_one_block  0.03323054313659668
generate_one_block  0.03321981430053711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021517276763916016
gen group dst list time:  0.0008666515350341797
time for parepare:  0.0016205310821533203
local_output_nid generation:  0.0015153884887695312
local_in_edges_tensor generation:  0.0028743743896484375
mini_batch_src_global generation:  0.0019197463989257812
r_  generation:  0.026445865631103516
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0026013851165771484
mini_batch_src_global generation:  0.0027189254760742188
r_  generation:  0.027677536010742188
----------------------check_connections_block total spend ----------------------------- 0.0805978775024414
generate_one_block  0.03477764129638672
generate_one_block  0.03519296646118164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.07148075103759766  GigaBytes
Max Memory Allocated: 2.678971290588379  GigaBytes

connection checking time:  0.21059441566467285
block generation total time  0.19772791862487793
average batch blocks generation time:  0.09886395931243896
block dataloader generation time/epoch 0.465747594833374
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.06890535354614258  GigaBytes
Max Memory Allocated: 2.678971290588379  GigaBytes

torch.Size([19265, 500])
torch.Size([17717, 16])
torch.Size([13434, 16])
torch.Size([5139, 16])
torch.Size([1306, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 2.5952553749084473  GigaBytes
Max Memory Allocated: 2.678971290588379  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.0691380500793457  GigaBytes
Max Memory Allocated: 2.678971290588379  GigaBytes

torch.Size([19352, 500])
torch.Size([18013, 16])
torch.Size([14306, 16])
torch.Size([5503, 16])
torch.Size([1439, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 2.617615222930908  GigaBytes
Max Memory Allocated: 2.6872119903564453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025429368019104004 |0.0035206079483032227 |0.4054074287414551 |0.00016951560974121094 |0.5231720209121704 |0.011893987655639648 |
----------------------------------------------------------pseudo_mini_loss sum 1.4205195903778076
Total (block generation + training)time/epoch 2.4033868312835693
Training time/epoch 1.9368946552276611
Training time without block to device /epoch 1.9298534393310547
Training time without total dataloading part /epoch 1.869391918182373
load block tensor time/epoch 0.05085873603820801
block to device time/epoch 0.007041215896606445
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  115829
Number of first layer input nodes during this epoch:  38617
