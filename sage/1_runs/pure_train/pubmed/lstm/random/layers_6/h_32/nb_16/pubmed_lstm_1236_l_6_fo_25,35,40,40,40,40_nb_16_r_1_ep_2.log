main start at this time 1648533828.4252834
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0016200542449951172
random selection method range initialization spend 0.00017595291137695312
time for parepare:  4.57763671875e-05
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.0011668205261230469
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.8358230590820312e-05
----------------------check_connections_block total spend ----------------------------- 0.002751588821411133
generate_one_block  0.0011837482452392578
generate_one_block  0.001066446304321289
generate_one_block  0.0010516643524169922
generate_one_block  0.0010573863983154297
generate_one_block  0.0009582042694091797
generate_one_block  0.0010104179382324219
generate_one_block  0.0009920597076416016
generate_one_block  0.0009467601776123047
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009722709655761719
gen group dst list time:  4.982948303222656e-05
time for parepare:  0.000244140625
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0001590251922607422
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00028514862060546875
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001277923583984375
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0001537799835205078
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  9.131431579589844e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00022125244140625
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001418590545654297
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  8.797645568847656e-05
----------------------check_connections_block total spend ----------------------------- 0.0032498836517333984
generate_one_block  0.0012052059173583984
generate_one_block  0.001355886459350586
generate_one_block  0.0012202262878417969
generate_one_block  0.0012161731719970703
generate_one_block  0.0010704994201660156
generate_one_block  0.001300811767578125
generate_one_block  0.0012316703796386719
generate_one_block  0.0010874271392822266
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011234283447265625
gen group dst list time:  9.107589721679688e-05
time for parepare:  0.0007436275482177734
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0007054805755615234
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.000274658203125
r_  generation:  0.002256155014038086
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  0.0001289844512939453
r_  generation:  0.0008223056793212891
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  0.00010633468627929688
r_  generation:  0.0010232925415039062
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.000518798828125
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  0.0001595020294189453
r_  generation:  0.0017783641815185547
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  0.0001518726348876953
r_  generation:  0.0012640953063964844
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  7.462501525878906e-05
r_  generation:  0.0003991127014160156
----------------------check_connections_block total spend ----------------------------- 0.014771699905395508
generate_one_block  0.001940011978149414
generate_one_block  0.003814220428466797
generate_one_block  0.0019989013671875
generate_one_block  0.0022034645080566406
generate_one_block  0.0016121864318847656
generate_one_block  0.003285646438598633
generate_one_block  0.0026047229766845703
generate_one_block  0.0014164447784423828
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002092599868774414
gen group dst list time:  0.00025343894958496094
time for parepare:  0.0016102790832519531
local_output_nid generation:  0.00010347366333007812
local_in_edges_tensor generation:  0.0006005764007568359
mini_batch_src_global generation:  0.0004749298095703125
r_  generation:  0.003869295120239258
local_output_nid generation:  0.0002205371856689453
local_in_edges_tensor generation:  0.0005452632904052734
mini_batch_src_global generation:  0.0010690689086914062
r_  generation:  0.008292436599731445
local_output_nid generation:  0.0001304149627685547
local_in_edges_tensor generation:  0.00036144256591796875
mini_batch_src_global generation:  0.0005736351013183594
r_  generation:  0.005033731460571289
local_output_nid generation:  0.00015401840209960938
local_in_edges_tensor generation:  0.0004127025604248047
mini_batch_src_global generation:  0.0005311965942382812
r_  generation:  0.005113363265991211
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.00026702880859375
mini_batch_src_global generation:  0.00036835670471191406
r_  generation:  0.003011941909790039
local_output_nid generation:  0.0001900196075439453
local_in_edges_tensor generation:  0.00042891502380371094
mini_batch_src_global generation:  0.0006611347198486328
r_  generation:  0.0075473785400390625
local_output_nid generation:  0.00020956993103027344
local_in_edges_tensor generation:  0.00045228004455566406
mini_batch_src_global generation:  0.0008537769317626953
r_  generation:  0.007337808609008789
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.0003120899200439453
r_  generation:  0.0017042160034179688
----------------------check_connections_block total spend ----------------------------- 0.06339621543884277
generate_one_block  0.006482362747192383
generate_one_block  0.011925458908081055
generate_one_block  0.007787942886352539
generate_one_block  0.00799417495727539
generate_one_block  0.004889249801635742
generate_one_block  0.011516332626342773
generate_one_block  0.010515689849853516
generate_one_block  0.002931833267211914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002283334732055664
gen group dst list time:  0.0011565685272216797
time for parepare:  0.0016911029815673828
local_output_nid generation:  0.0005021095275878906
local_in_edges_tensor generation:  0.0015070438385009766
mini_batch_src_global generation:  0.001268148422241211
r_  generation:  0.01196146011352539
local_output_nid generation:  0.0007793903350830078
local_in_edges_tensor generation:  0.0015635490417480469
mini_batch_src_global generation:  0.002028942108154297
r_  generation:  0.017388582229614258
local_output_nid generation:  0.0006527900695800781
local_in_edges_tensor generation:  0.0023393630981445312
mini_batch_src_global generation:  0.0015015602111816406
r_  generation:  0.015755414962768555
local_output_nid generation:  0.0006990432739257812
local_in_edges_tensor generation:  0.0010836124420166016
mini_batch_src_global generation:  0.0011453628540039062
r_  generation:  0.01374053955078125
local_output_nid generation:  0.000438690185546875
local_in_edges_tensor generation:  0.0007395744323730469
mini_batch_src_global generation:  0.0009434223175048828
r_  generation:  0.011783361434936523
local_output_nid generation:  0.0007128715515136719
local_in_edges_tensor generation:  0.0013725757598876953
mini_batch_src_global generation:  0.0013751983642578125
r_  generation:  0.016623258590698242
local_output_nid generation:  0.0007488727569580078
local_in_edges_tensor generation:  0.0012798309326171875
mini_batch_src_global generation:  0.001672506332397461
r_  generation:  0.017614126205444336
local_output_nid generation:  0.0002837181091308594
local_in_edges_tensor generation:  0.0004971027374267578
mini_batch_src_global generation:  0.0009129047393798828
r_  generation:  0.00699925422668457
----------------------check_connections_block total spend ----------------------------- 0.16582083702087402
generate_one_block  0.017203569412231445
generate_one_block  0.023535490036010742
generate_one_block  0.020493745803833008
generate_one_block  0.01756882667541504
generate_one_block  0.015348672866821289
generate_one_block  0.021721363067626953
generate_one_block  0.024116039276123047
generate_one_block  0.011834144592285156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018563270568847656
gen group dst list time:  0.002475261688232422
time for parepare:  0.0014829635620117188
local_output_nid generation:  0.001088857650756836
local_in_edges_tensor generation:  0.0022034645080566406
mini_batch_src_global generation:  0.0017735958099365234
r_  generation:  0.020401954650878906
local_output_nid generation:  0.0012464523315429688
local_in_edges_tensor generation:  0.002384662628173828
mini_batch_src_global generation:  0.0025758743286132812
r_  generation:  0.023445844650268555
local_output_nid generation:  0.0013427734375
local_in_edges_tensor generation:  0.0020966529846191406
mini_batch_src_global generation:  0.0018684864044189453
r_  generation:  0.02237415313720703
local_output_nid generation:  0.0013201236724853516
local_in_edges_tensor generation:  0.0018496513366699219
mini_batch_src_global generation:  0.0017154216766357422
r_  generation:  0.02170872688293457
local_output_nid generation:  0.0011730194091796875
local_in_edges_tensor generation:  0.0018315315246582031
mini_batch_src_global generation:  0.0016791820526123047
r_  generation:  0.019839048385620117
local_output_nid generation:  0.0012507438659667969
local_in_edges_tensor generation:  0.0019237995147705078
mini_batch_src_global generation:  0.0019888877868652344
r_  generation:  0.022951841354370117
local_output_nid generation:  0.0013659000396728516
local_in_edges_tensor generation:  0.002578258514404297
mini_batch_src_global generation:  0.002065420150756836
r_  generation:  0.02373957633972168
local_output_nid generation:  0.0009086132049560547
local_in_edges_tensor generation:  0.0013418197631835938
mini_batch_src_global generation:  0.0015799999237060547
r_  generation:  0.018066883087158203
----------------------check_connections_block total spend ----------------------------- 0.2517127990722656
generate_one_block  0.026807785034179688
generate_one_block  0.030179977416992188
generate_one_block  0.028918027877807617
generate_one_block  0.02710270881652832
generate_one_block  0.025647401809692383
generate_one_block  0.028858423233032227
generate_one_block  0.029959440231323242
generate_one_block  0.023348093032836914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

connection checking time:  0.49895143508911133
block generation total time  0.46525025367736816
average batch blocks generation time:  0.05815628170967102
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1346435546875 GB
    Memory Allocated: 0.04194450378417969  GigaBytes
Max Memory Allocated: 0.04194450378417969  GigaBytes

torch.Size([17671, 500])
torch.Size([12119, 32])
torch.Size([5555, 32])
torch.Size([1264, 32])
torch.Size([274, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5740966796875 GB
    Memory Allocated: 2.18803071975708  GigaBytes
Max Memory Allocated: 2.2439522743225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5740966796875 GB
    Memory Allocated: 0.0515594482421875  GigaBytes
Max Memory Allocated: 2.2439522743225098  GigaBytes

torch.Size([18623, 500])
torch.Size([15352, 32])
torch.Size([9008, 32])
torch.Size([2813, 32])
torch.Size([634, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 2.5064430236816406  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.05088520050048828  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

torch.Size([18364, 500])
torch.Size([14029, 32])
torch.Size([7634, 32])
torch.Size([1368, 32])
torch.Size([341, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 2.387190341949463  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.05072736740112305  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

torch.Size([18329, 500])
torch.Size([13352, 32])
torch.Size([7994, 32])
torch.Size([1852, 32])
torch.Size([384, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 2.2542686462402344  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.04751396179199219  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

torch.Size([16677, 500])
torch.Size([11246, 32])
torch.Size([4772, 32])
torch.Size([912, 32])
torch.Size([187, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 2.0781502723693848  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9139404296875 GB
    Memory Allocated: 0.05055093765258789  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

torch.Size([18117, 500])
torch.Size([14141, 32])
torch.Size([8283, 32])
torch.Size([2584, 32])
torch.Size([521, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 2.4019713401794434  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.05088472366333008  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

torch.Size([18286, 500])
torch.Size([15253, 32])
torch.Size([9073, 32])
torch.Size([2475, 32])
torch.Size([371, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 2.467646598815918  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0464634895324707  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

torch.Size([16222, 500])
torch.Size([9447, 32])
torch.Size([3037, 32])
torch.Size([669, 32])
torch.Size([180, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 1.8811655044555664  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021254241466522217 |0.04485851526260376 |0.388325572013855 |0.0001482069492340088 |0.42940425872802734 |0.012212276458740234 |
----------------------------------------------------------pseudo_mini_loss sum 1.8462133407592773
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  319769
Number of first layer input nodes during this epoch:  142289
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.06393909454345703  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006687641143798828
random selection method range initialization spend 0.0001499652862548828
time for parepare:  7.367134094238281e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.078315734863281e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  2.8848648071289062e-05
----------------------check_connections_block total spend ----------------------------- 0.001840353012084961
generate_one_block  0.0014557838439941406
generate_one_block  0.001157522201538086
generate_one_block  0.0010614395141601562
generate_one_block  0.0011067390441894531
generate_one_block  0.0011105537414550781
generate_one_block  0.0010743141174316406
generate_one_block  0.0011050701141357422
generate_one_block  0.0010790824890136719
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006380081176757812
gen group dst list time:  7.2479248046875e-05
time for parepare:  0.00034928321838378906
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00015878677368164062
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0002586841583251953
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00012040138244628906
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00019240379333496094
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.00030612945556640625
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00012540817260742188
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001838207244873047
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00013065338134765625
----------------------check_connections_block total spend ----------------------------- 0.0039751529693603516
generate_one_block  0.0013954639434814453
generate_one_block  0.0014586448669433594
generate_one_block  0.0011875629425048828
generate_one_block  0.0014312267303466797
generate_one_block  0.0015251636505126953
generate_one_block  0.0012094974517822266
generate_one_block  0.001325368881225586
generate_one_block  0.0011546611785888672
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012710094451904297
gen group dst list time:  0.00014543533325195312
time for parepare:  0.0009553432464599609
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.00034308433532714844
mini_batch_src_global generation:  0.0001373291015625
r_  generation:  0.0009150505065917969
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  0.00031113624572753906
r_  generation:  0.0019412040710449219
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  0.00012063980102539062
r_  generation:  0.0005524158477783203
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.0010449886322021484
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  0.00022268295288085938
r_  generation:  0.002092123031616211
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00021648406982421875
mini_batch_src_global generation:  0.00013518333435058594
r_  generation:  0.0007069110870361328
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  0.0001392364501953125
r_  generation:  0.0011022090911865234
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.0008971691131591797
----------------------check_connections_block total spend ----------------------------- 0.01645684242248535
generate_one_block  0.0025322437286376953
generate_one_block  0.003509521484375
generate_one_block  0.0016243457794189453
generate_one_block  0.002319812774658203
generate_one_block  0.003913402557373047
generate_one_block  0.0018525123596191406
generate_one_block  0.002498149871826172
generate_one_block  0.002332925796508789
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021245479583740234
gen group dst list time:  0.0003457069396972656
time for parepare:  0.0015773773193359375
local_output_nid generation:  0.00021600723266601562
local_in_edges_tensor generation:  0.0008666515350341797
mini_batch_src_global generation:  0.0007123947143554688
r_  generation:  0.0054912567138671875
local_output_nid generation:  0.0002696514129638672
local_in_edges_tensor generation:  0.0005216598510742188
mini_batch_src_global generation:  0.0009846687316894531
r_  generation:  0.007192373275756836
local_output_nid generation:  8.96453857421875e-05
local_in_edges_tensor generation:  0.0002675056457519531
mini_batch_src_global generation:  0.00036406517028808594
r_  generation:  0.002540111541748047
local_output_nid generation:  0.0001766681671142578
local_in_edges_tensor generation:  0.0003864765167236328
mini_batch_src_global generation:  0.00042557716369628906
r_  generation:  0.004847049713134766
local_output_nid generation:  0.0003147125244140625
local_in_edges_tensor generation:  0.0005662441253662109
mini_batch_src_global generation:  0.0007839202880859375
r_  generation:  0.00813150405883789
local_output_nid generation:  0.00012063980102539062
local_in_edges_tensor generation:  0.0010018348693847656
mini_batch_src_global generation:  0.0005009174346923828
r_  generation:  0.003716707229614258
local_output_nid generation:  0.00018167495727539062
local_in_edges_tensor generation:  0.0003924369812011719
mini_batch_src_global generation:  0.0005071163177490234
r_  generation:  0.005377769470214844
local_output_nid generation:  0.00020122528076171875
local_in_edges_tensor generation:  0.0004062652587890625
mini_batch_src_global generation:  0.0005555152893066406
r_  generation:  0.005395174026489258
----------------------check_connections_block total spend ----------------------------- 0.06632161140441895
generate_one_block  0.009477376937866211
generate_one_block  0.010903358459472656
generate_one_block  0.004694223403930664
generate_one_block  0.008135318756103516
generate_one_block  0.012303590774536133
generate_one_block  0.006459951400756836
generate_one_block  0.009242057800292969
generate_one_block  0.008401632308959961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0024733543395996094
gen group dst list time:  0.0012416839599609375
time for parepare:  0.0017864704132080078
local_output_nid generation:  0.0009834766387939453
local_in_edges_tensor generation:  0.002126455307006836
mini_batch_src_global generation:  0.0016202926635742188
r_  generation:  0.017166614532470703
local_output_nid generation:  0.0007846355438232422
local_in_edges_tensor generation:  0.0012969970703125
mini_batch_src_global generation:  0.0018684864044189453
r_  generation:  0.016016483306884766
local_output_nid generation:  0.0005674362182617188
local_in_edges_tensor generation:  0.0008375644683837891
mini_batch_src_global generation:  0.0010097026824951172
r_  generation:  0.009073734283447266
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.0011556148529052734
mini_batch_src_global generation:  0.0012018680572509766
r_  generation:  0.014316797256469727
local_output_nid generation:  0.0009157657623291016
local_in_edges_tensor generation:  0.0012793540954589844
mini_batch_src_global generation:  0.0014667510986328125
r_  generation:  0.017772197723388672
local_output_nid generation:  0.0011749267578125
local_in_edges_tensor generation:  0.0013077259063720703
mini_batch_src_global generation:  0.001415252685546875
r_  generation:  0.014592647552490234
local_output_nid generation:  0.0011017322540283203
local_in_edges_tensor generation:  0.0013580322265625
mini_batch_src_global generation:  0.0014874935150146484
r_  generation:  0.0166933536529541
local_output_nid generation:  0.0014138221740722656
local_in_edges_tensor generation:  0.0014848709106445312
mini_batch_src_global generation:  0.005491971969604492
r_  generation:  0.016817331314086914
----------------------check_connections_block total spend ----------------------------- 0.1877589225769043
generate_one_block  0.02493429183959961
generate_one_block  0.022731542587280273
generate_one_block  0.013847589492797852
generate_one_block  0.018109798431396484
generate_one_block  0.026497840881347656
generate_one_block  0.019286632537841797
generate_one_block  0.02251291275024414
generate_one_block  0.02329421043395996
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018835067749023438
gen group dst list time:  0.0027358531951904297
time for parepare:  0.0018248558044433594
local_output_nid generation:  0.0017104148864746094
local_in_edges_tensor generation:  0.0025992393493652344
mini_batch_src_global generation:  0.0021495819091796875
r_  generation:  0.023740530014038086
local_output_nid generation:  0.0015423297882080078
local_in_edges_tensor generation:  0.002407073974609375
mini_batch_src_global generation:  0.0025904178619384766
r_  generation:  0.0228424072265625
local_output_nid generation:  0.0012047290802001953
local_in_edges_tensor generation:  0.0018744468688964844
mini_batch_src_global generation:  0.001580953598022461
r_  generation:  0.01967024803161621
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.0020072460174560547
mini_batch_src_global generation:  0.001917123794555664
r_  generation:  0.022225141525268555
local_output_nid generation:  0.0015680789947509766
local_in_edges_tensor generation:  0.002084016799926758
mini_batch_src_global generation:  0.0020377635955810547
r_  generation:  0.024024009704589844
local_output_nid generation:  0.0014605522155761719
local_in_edges_tensor generation:  0.0018973350524902344
mini_batch_src_global generation:  0.0018157958984375
r_  generation:  0.022090911865234375
local_output_nid generation:  0.0014472007751464844
local_in_edges_tensor generation:  0.002285003662109375
mini_batch_src_global generation:  0.0018596649169921875Using backend: pytorch

r_  generation:  0.024245262145996094
local_output_nid generation:  0.0015485286712646484
local_in_edges_tensor generation:  0.0024962425231933594
mini_batch_src_global generation:  0.0018842220306396484
r_  generation:  0.02427387237548828
----------------------check_connections_block total spend ----------------------------- 0.26911449432373047
generate_one_block  0.03173232078552246
generate_one_block  0.03033900260925293
generate_one_block  0.026891708374023438
generate_one_block  0.02928924560546875
generate_one_block  0.03182530403137207
generate_one_block  0.028794050216674805
generate_one_block  0.031124114990234375
generate_one_block  0.030846834182739258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.06393909454345703  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

connection checking time:  0.5436270236968994
block generation total time  0.5129454135894775
average batch blocks generation time:  0.06411817669868469
block dataloader generation time/epoch 1.2236590385437012
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.06740427017211914  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

torch.Size([18388, 500])
torch.Size([14489, 32])
torch.Size([7982, 32])
torch.Size([1684, 32])
torch.Size([327, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 2.425642490386963  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.06640243530273438  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

torch.Size([17791, 500])
torch.Size([13582, 32])
torch.Size([7115, 32])
torch.Size([2065, 32])
torch.Size([445, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 2.3493833541870117  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.06404256820678711  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

torch.Size([16767, 500])
torch.Size([9920, 32])
torch.Size([4330, 32])
torch.Size([759, 32])
torch.Size([235, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 2.000363349914551  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.0671377182006836  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

torch.Size([18308, 500])
torch.Size([13191, 32])
torch.Size([7860, 32])
torch.Size([1680, 32])
torch.Size([431, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 2.272350788116455  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 0.06709623336791992  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

torch.Size([18151, 500])
torch.Size([14495, 32])
torch.Size([8257, 32])
torch.Size([2877, 32])
torch.Size([590, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9471435546875 GB
    Memory Allocated: 2.444115161895752  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9471435546875 GB
    Memory Allocated: 0.06626319885253906  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

torch.Size([17858, 500])
torch.Size([12267, 32])
torch.Size([6304, 32])
torch.Size([1047, 32])
torch.Size([283, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9471435546875 GB
    Memory Allocated: 2.2494349479675293  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9471435546875 GB
    Memory Allocated: 0.06701183319091797  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

torch.Size([18185, 500])
torch.Size([14354, 32])
torch.Size([6971, 32])
torch.Size([1875, 32])
torch.Size([365, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9471435546875 GB
    Memory Allocated: 2.4006423950195312  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9471435546875 GB
    Memory Allocated: 0.06643486022949219  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

torch.Size([17863, 500])
torch.Size([14940, 32])
torch.Size([6881, 32])
torch.Size([1954, 32])
torch.Size([232, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9471435546875 GB
    Memory Allocated: 2.404862403869629  GigaBytes
Max Memory Allocated: 2.507786750793457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01797071099281311 |0.0035729408264160156 |0.3306468427181244 |0.0001398026943206787 |0.4316089153289795 |0.010991334915161133 |
----------------------------------------------------------pseudo_mini_loss sum 1.8027935028076172
Total (block generation + training)time/epoch 7.530514717102051
Training time/epoch 6.306581258773804
Training time without block to device /epoch 6.277997732162476
Training time without total dataloading part /epoch 6.110155820846558
load block tensor time/epoch 0.14376568794250488
block to device time/epoch 0.028583526611328125
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  323454
Number of first layer input nodes during this epoch:  143311
