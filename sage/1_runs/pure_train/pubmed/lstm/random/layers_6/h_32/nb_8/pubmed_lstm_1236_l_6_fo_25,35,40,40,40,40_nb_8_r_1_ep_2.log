main start at this time 1648533810.166836
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001825094223022461
random selection method range initialization spend 0.0001914501190185547
time for parepare:  5.221366882324219e-05
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0013506412506103516
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.600120544433594e-05
----------------------check_connections_block total spend ----------------------------- 0.0024480819702148438
generate_one_block  0.001447439193725586
generate_one_block  0.0011897087097167969
generate_one_block  0.0011730194091796875
generate_one_block  0.0012319087982177734
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012962818145751953
gen group dst list time:  3.9577484130859375e-05
time for parepare:  0.0002665519714355469
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0005915164947509766
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.000335693359375
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00020265579223632812
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00041294097900390625
----------------------check_connections_block total spend ----------------------------- 0.003201723098754883
generate_one_block  0.0017962455749511719
generate_one_block  0.001562356948852539
generate_one_block  0.0013539791107177734
generate_one_block  0.0017230510711669922
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011990070343017578
gen group dst list time:  8.392333984375e-05
time for parepare:  0.000858306884765625
local_output_nid generation:  7.915496826171875e-05
local_in_edges_tensor generation:  0.00038743019104003906
mini_batch_src_global generation:  0.0003032684326171875
r_  generation:  0.0030641555786132812
local_output_nid generation:  9.226799011230469e-05
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  0.0002579689025878906
r_  generation:  0.001947164535522461
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  0.00014352798461914062
r_  generation:  0.0011196136474609375
local_output_nid generation:  8.535385131835938e-05
local_in_edges_tensor generation:  0.0002684593200683594
mini_batch_src_global generation:  0.0002892017364501953
r_  generation:  0.0029473304748535156
----------------------check_connections_block total spend ----------------------------- 0.015019655227661133
generate_one_block  0.004598855972290039
generate_one_block  0.0030465126037597656
generate_one_block  0.002244710922241211
generate_one_block  0.004728555679321289
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0023505687713623047
gen group dst list time:  0.00026869773864746094
time for parepare:  0.0017943382263183594
local_output_nid generation:  0.0003368854522705078
local_in_edges_tensor generation:  0.0010759830474853516
mini_batch_src_global generation:  0.0011696815490722656
r_  generation:  0.010677814483642578
local_output_nid generation:  0.0002155303955078125
local_in_edges_tensor generation:  0.0005156993865966797
mini_batch_src_global generation:  0.0010266304016113281
r_  generation:  0.008321523666381836
local_output_nid generation:  0.00016236305236816406
local_in_edges_tensor generation:  0.0003781318664550781
mini_batch_src_global generation:  0.0006339550018310547
r_  generation:  0.006225109100341797
local_output_nid generation:  0.0002942085266113281
local_in_edges_tensor generation:  0.0006117820739746094
mini_batch_src_global generation:  0.0010800361633300781
r_  generation:  0.011223793029785156
----------------------check_connections_block total spend ----------------------------- 0.0550079345703125
generate_one_block  0.013819217681884766
generate_one_block  0.012226343154907227
generate_one_block  0.009328842163085938
generate_one_block  0.01584792137145996
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002101898193359375
gen group dst list time:  0.0007994174957275391
time for parepare:  0.0016925334930419922
local_output_nid generation:  0.000835418701171875
local_in_edges_tensor generation:  0.0020804405212402344
mini_batch_src_global generation:  0.0019276142120361328
r_  generation:  0.018753767013549805
local_output_nid generation:  0.0009789466857910156
local_in_edges_tensor generation:  0.0019142627716064453
mini_batch_src_global generation:  0.0025136470794677734
r_  generation:  0.019730091094970703
local_output_nid generation:  0.0007054805755615234
local_in_edges_tensor generation:  0.001161336898803711
mini_batch_src_global generation:  0.001455545425415039
r_  generation:  0.016382694244384766
local_output_nid generation:  0.0009815692901611328
local_in_edges_tensor generation:  0.0016198158264160156
mini_batch_src_global generation:  0.0018856525421142578
r_  generation:  0.020938873291015625
----------------------check_connections_block total spend ----------------------------- 0.11302781105041504
generate_one_block  0.02493143081665039
generate_one_block  0.02776050567626953
generate_one_block  0.021743059158325195
generate_one_block  0.02665877342224121
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002094745635986328
gen group dst list time:  0.001295328140258789
time for parepare:  0.0017130374908447266
local_output_nid generation:  0.0014824867248535156
local_in_edges_tensor generation:  0.0028586387634277344
mini_batch_src_global generation:  0.002117156982421875
r_  generation:  0.02420830726623535
local_output_nid generation:  0.0014111995697021484
local_in_edges_tensor generation:  0.002773284912109375
mini_batch_src_global generation:  0.0026886463165283203
r_  generation:  0.024937152862548828
local_output_nid generation:  0.0014069080352783203
local_in_edges_tensor generation:  0.0020270347595214844
mini_batch_src_global generation:  0.0019571781158447266
r_  generation:  0.02312183380126953
local_output_nid generation:  0.0015454292297363281
local_in_edges_tensor generation:  0.0026586055755615234
mini_batch_src_global generation:  0.0022430419921875
r_  generation:  0.02548050880432129
----------------------check_connections_block total spend ----------------------------- 0.14525771141052246
generate_one_block  0.02964019775390625
generate_one_block  0.030624866485595703
generate_one_block  0.029201984405517578
generate_one_block  0.030882835388183594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

connection checking time:  0.331514835357666
block generation total time  0.2937202453613281
average batch blocks generation time:  0.07343006134033203
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.044338226318359375  GigaBytes
Max Memory Allocated: 0.044338226318359375  GigaBytes

torch.Size([18863, 500])
torch.Size([16159, 32])
torch.Size([10260, 32])
torch.Size([3575, 32])
torch.Size([883, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 2.569265842437744  GigaBytes
Max Memory Allocated: 2.569295883178711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 0.052542686462402344  GigaBytes
Max Memory Allocated: 2.569309711456299  GigaBytes

torch.Size([19127, 500])
torch.Size([16513, 32])
torch.Size([11358, 32])
torch.Size([2859, 32])
torch.Size([707, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1463623046875 GB
    Memory Allocated: 2.593830108642578  GigaBytes
Max Memory Allocated: 2.5942163467407227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1444091796875 GB
    Memory Allocated: 0.05081605911254883  GigaBytes
Max Memory Allocated: 2.5942163467407227  GigaBytes

torch.Size([18293, 500])
torch.Size([14360, 32])
torch.Size([7983, 32])
torch.Size([2013, 32])
torch.Size([356, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1444091796875 GB
    Memory Allocated: 2.404080867767334  GigaBytes
Max Memory Allocated: 2.5942163467407227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1444091796875 GB
    Memory Allocated: 0.05240917205810547  GigaBytes
Max Memory Allocated: 2.5942163467407227  GigaBytes

torch.Size([18978, 500])
torch.Size([17026, 32])
torch.Size([11761, 32])
torch.Size([4170, 32])
torch.Size([918, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2186279296875 GB
    Memory Allocated: 2.646615505218506  GigaBytes
Max Memory Allocated: 2.6466426849365234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.020469069480895996 |0.08668255805969238 |0.48581403493881226 |0.00016248226165771484 |0.4794485569000244 |0.012990236282348633 |
----------------------------------------------------------pseudo_mini_loss sum 2.017611503601074
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  196518
Number of first layer input nodes during this epoch:  75261
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.2186279296875 GB
    Memory Allocated: 0.07116556167602539  GigaBytes
Max Memory Allocated: 2.6466622352600098  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005910396575927734
random selection method range initialization spend 0.0001399517059326172
time for parepare:  6.103515625e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  5.4836273193359375e-05
----------------------check_connections_block total spend ----------------------------- 0.0011515617370605469
generate_one_block  0.0016057491302490234
generate_one_block  0.0010988712310791016
generate_one_block  0.0011200904846191406
generate_one_block  0.001287698745727539
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005762577056884766
gen group dst list time:  3.8623809814453125e-05
time for parepare:  0.0003170967102050781
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.00036907196044921875
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0002117156982421875
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0004532337188720703
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0003616809844970703
----------------------check_connections_block total spend ----------------------------- 0.0031478404998779297
generate_one_block  0.0016055107116699219
generate_one_block  0.0013439655303955078
generate_one_block  0.001773834228515625
generate_one_block  0.0015761852264404297
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010631084442138672
gen group dst list time:  8.916854858398438e-05
time for parepare:  0.000858306884765625
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.00040268898010253906
mini_batch_src_global generation:  0.0003299713134765625
r_  generation:  0.002537965774536133
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  0.00017452239990234375
r_  generation:  0.001043558120727539
local_output_nid generation:  0.00011515617370605469
local_in_edges_tensor generation:  0.00026416778564453125
mini_batch_src_global generation:  0.0002772808074951172
r_  generation:  0.0031540393829345703
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  0.00026869773864746094
r_  generation:  0.0022013187408447266
----------------------check_connections_block total spend ----------------------------- 0.014733076095581055
generate_one_block  0.004754543304443359
generate_one_block  0.0023069381713867188
generate_one_block  0.005402803421020508
generate_one_block  0.0040819644927978516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019459724426269531
gen group dst list time:  0.0002579689025878906
time for parepare:  0.001432180404663086
local_output_nid generation:  0.000331878662109375
local_in_edges_tensor generation:  0.0012004375457763672
mini_batch_src_global generation:  0.0010492801666259766
r_  generation:  0.009799480438232422
local_output_nid generation:  0.00017571449279785156
local_in_edges_tensor generation:  0.0003731250762939453
mini_batch_src_global generation:  0.0005972385406494141
r_  generation:  0.004926443099975586
local_output_nid generation:  0.00040149688720703125
local_in_edges_tensor generation:  0.0007028579711914062
mini_batch_src_global generation:  0.0008985996246337891
r_  generation:  0.012673139572143555
local_output_nid generation: Using backend: pytorch
 0.0003561973571777344
local_in_edges_tensor generation:  0.0006401538848876953
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.010565757751464844
----------------------check_connections_block total spend ----------------------------- 0.056749582290649414
generate_one_block  0.01510310173034668
generate_one_block  0.008093595504760742
generate_one_block  0.018378257751464844
generate_one_block  0.016306638717651367
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020864009857177734
gen group dst list time:  0.0007874965667724609
time for parepare:  0.001636505126953125
local_output_nid generation:  0.0010912418365478516
local_in_edges_tensor generation:  0.0025262832641601562
mini_batch_src_global generation:  0.0018925666809082031
r_  generation:  0.020372390747070312
local_output_nid generation:  0.0007243156433105469
local_in_edges_tensor generation:  0.0014142990112304688
mini_batch_src_global generation:  0.0018134117126464844
r_  generation:  0.015224695205688477
local_output_nid generation:  0.0012955665588378906
local_in_edges_tensor generation:  0.002098560333251953
mini_batch_src_global generation:  0.00185394287109375
r_  generation:  0.022800207138061523
local_output_nid generation:  0.0011701583862304688
local_in_edges_tensor generation:  0.001682281494140625
mini_batch_src_global generation:  0.0020627975463867188
r_  generation:  0.02136707305908203
----------------------check_connections_block total spend ----------------------------- 0.11917710304260254
generate_one_block  0.028044939041137695
generate_one_block  0.021767139434814453
generate_one_block  0.03087782859802246
generate_one_block  0.029963254928588867
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021004676818847656
gen group dst list time:  0.0015254020690917969
time for parepare:  0.0017426013946533203
local_output_nid generation:  0.0016674995422363281
local_in_edges_tensor generation:  0.0028913021087646484
mini_batch_src_global generation:  0.002038717269897461
r_  generation:  0.025165557861328125
local_output_nid generation:  0.0014801025390625
local_in_edges_tensor generation:  0.0021626949310302734
mini_batch_src_global generation:  0.002460479736328125
r_  generation:  0.023194313049316406
local_output_nid generation:  0.0017268657684326172
local_in_edges_tensor generation:  0.0027532577514648438
mini_batch_src_global generation:  0.002069234848022461
r_  generation:  0.02587127685546875
local_output_nid generation:  0.001848459243774414
local_in_edges_tensor generation:  0.0026984214782714844
mini_batch_src_global generation:  0.002125978469848633
r_  generation:  0.026087522506713867
----------------------check_connections_block total spend ----------------------------- 0.1489579677581787
generate_one_block  0.0327610969543457
generate_one_block  0.031850576400756836
generate_one_block  0.03412485122680664
generate_one_block  0.03421282768249512
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.2186279296875 GB
    Memory Allocated: 0.07116556167602539  GigaBytes
Max Memory Allocated: 2.6466622352600098  GigaBytes

connection checking time:  0.34276556968688965
block generation total time  0.32432985305786133
average batch blocks generation time:  0.08108246326446533
block dataloader generation time/epoch 0.7626404762268066
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2186279296875 GB
    Memory Allocated: 0.06821918487548828  GigaBytes
Max Memory Allocated: 2.6466622352600098  GigaBytes

torch.Size([18795, 500])
torch.Size([16010, 32])
torch.Size([10768, 32])
torch.Size([3087, 32])
torch.Size([721, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2186279296875 GB
    Memory Allocated: 2.578686237335205  GigaBytes
Max Memory Allocated: 2.6466622352600098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2186279296875 GB
    Memory Allocated: 0.06685113906860352  GigaBytes
Max Memory Allocated: 2.6466622352600098  GigaBytes

torch.Size([18322, 500])
torch.Size([13715, 32])
torch.Size([7073, 32])
torch.Size([1573, 32])
torch.Size([417, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2186279296875 GB
    Memory Allocated: 2.3669939041137695  GigaBytes
Max Memory Allocated: 2.6466622352600098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2186279296875 GB
    Memory Allocated: 0.06897306442260742  GigaBytes
Max Memory Allocated: 2.6466622352600098  GigaBytes

torch.Size([19196, 500])
torch.Size([17217, 32])
torch.Size([13286, 32])
torch.Size([4295, 32])
torch.Size([1027, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 2.700786590576172  GigaBytes
Max Memory Allocated: 2.7008118629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 0.06867790222167969  GigaBytes
Max Memory Allocated: 2.700831890106201  GigaBytes

torch.Size([19102, 500])
torch.Size([17376, 32])
torch.Size([11163, 32])
torch.Size([3827, 32])
torch.Size([706, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 2.666102409362793  GigaBytes
Max Memory Allocated: 2.700831890106201  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024656713008880615 |0.002996981143951416 |0.3534858822822571 |0.0001507401466369629 |0.4832414984703064 |0.011454582214355469 |
----------------------------------------------------------pseudo_mini_loss sum 1.2500669956207275
Total (block generation + training)time/epoch 4.24685263633728
Training time/epoch 3.4838953018188477
Training time without block to device /epoch 3.471907377243042
Training time without total dataloading part /epoch 3.3589670658111572
load block tensor time/epoch 0.09862685203552246
block to device time/epoch 0.011987924575805664
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  198032
Number of first layer input nodes during this epoch:  75415
