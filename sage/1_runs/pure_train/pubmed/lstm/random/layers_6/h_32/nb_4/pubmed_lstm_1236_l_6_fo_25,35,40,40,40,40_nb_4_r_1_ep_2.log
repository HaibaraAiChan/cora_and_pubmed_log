main start at this time 1648533795.5814195
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0021352767944335938
random selection method range initialization spend 0.00019598007202148438
time for parepare:  4.458427429199219e-05
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0015556812286376953
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  5.8650970458984375e-05
----------------------check_connections_block total spend ----------------------------- 0.0022470951080322266
generate_one_block  0.0013418197631835938
generate_one_block  0.0010967254638671875
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012483596801757812
gen group dst list time:  2.5033950805664062e-05
time for parepare:  0.00023794174194335938
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.0007188320159912109
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  9.1552734375e-05
r_  generation:  0.0005311965942382812
----------------------check_connections_block total spend ----------------------------- 0.002400636672973633
generate_one_block  0.002020597457885742
generate_one_block  0.001737833023071289
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001004934310913086
gen group dst list time:  6.127357482910156e-05
time for parepare:  0.0007319450378417969
local_output_nid generation:  0.00011563301086425781
local_in_edges_tensor generation:  0.0005490779876708984
mini_batch_src_global generation:  0.0003371238708496094
r_  generation:  0.004378318786621094
local_output_nid generation:  8.988380432128906e-05
local_in_edges_tensor generation:  0.0002853870391845703
mini_batch_src_global generation:  0.00048804283142089844
r_  generation:  0.003692150115966797
----------------------check_connections_block total spend ----------------------------- 0.012958526611328125
generate_one_block  0.006516218185424805
generate_one_block  0.005604743957519531
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020890235900878906
gen group dst list time:  0.00018262863159179688
time for parepare:  0.0013856887817382812
local_output_nid generation:  0.0004067420959472656
local_in_edges_tensor generation:  0.0011622905731201172
mini_batch_src_global generation:  0.0014667510986328125
r_  generation:  0.014436006546020508
local_output_nid generation:  0.00036835670471191406
local_in_edges_tensor generation:  0.0007839202880859375
mini_batch_src_global generation:  0.0015628337860107422
r_  generation:  0.013630151748657227
----------------------check_connections_block total spend ----------------------------- 0.042183637619018555
generate_one_block  0.020050048828125
generate_one_block  0.01910853385925293
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018308162689208984
gen group dst list time:  0.0004956722259521484
time for parepare:  0.0016391277313232422
local_output_nid generation:  0.001102447509765625
local_in_edges_tensor generation:  0.002246379852294922
mini_batch_src_global generation:  0.0021409988403320312
r_  generation:  0.02397751808166504
local_output_nid generation:  0.0010104179382324219
local_in_edges_tensor generation:  0.0020842552185058594
mini_batch_src_global generation:  0.0025510787963867188
r_  generation:  0.022847414016723633
----------------------check_connections_block total spend ----------------------------- 0.07018136978149414
generate_one_block  0.029662132263183594
generate_one_block  0.029139995574951172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001909494400024414
gen group dst list time:  0.0007598400115966797
time for parepare:  0.001644134521484375
local_output_nid generation:  0.0014646053314208984
local_in_edges_tensor generation:  0.002730131149291992
mini_batch_src_global generation:  0.0021495819091796875
r_  generation:  0.026006698608398438
local_output_nid generation:  0.0013494491577148438
local_in_edges_tensor generation:  0.002073049545288086
mini_batch_src_global generation:  0.0024712085723876953
r_  generation:  0.025885343551635742
----------------------check_connections_block total spend ----------------------------- 0.07718491554260254
generate_one_block  0.03216886520385742
generate_one_block  0.03231453895568848
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

connection checking time:  0.204909086227417
block generation total time  0.17832350730895996
average batch blocks generation time:  0.08916175365447998
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1405029296875 GB
    Memory Allocated: 0.04547309875488281  GigaBytes
Max Memory Allocated: 0.04547309875488281  GigaBytes

torch.Size([19332, 500])
torch.Size([18028, 32])
torch.Size([14776, 32])
torch.Size([5604, 32])
torch.Size([1558, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1600341796875 GB
    Memory Allocated: 2.7388510704040527  GigaBytes
Max Memory Allocated: 2.7388973236083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1619873046875 GB
    Memory Allocated: 0.05361318588256836  GigaBytes
Max Memory Allocated: 2.7388973236083984  GigaBytes

torch.Size([19179, 500])
torch.Size([17497, 32])
torch.Size([13232, 32])
torch.Size([5258, 32])
torch.Size([1245, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2166748046875 GB
    Memory Allocated: 2.701859951019287  GigaBytes
Max Memory Allocated: 2.7388973236083984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025571346282958984 |0.17160367965698242 |0.6553982496261597 |0.00021469593048095703 |0.5246583223342896 |0.011867761611938477 |
----------------------------------------------------------pseudo_mini_loss sum 1.7722097635269165
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  116065
Number of first layer input nodes during this epoch:  38511
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.2166748046875 GB
    Memory Allocated: 0.07206010818481445  GigaBytes
Max Memory Allocated: 2.7388973236083984  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005300045013427734
random selection method range initialization spend 0.00012683868408203125
time for parepare:  5.4836273193359375e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.103515625e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  Using backend: pytorch
0.00011682510375976562
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  8.463859558105469e-05
----------------------check_connections_block total spend ----------------------------- 0.0008130073547363281
generate_one_block  0.0012159347534179688
generate_one_block  0.0011820793151855469
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005505084991455078
gen group dst list time:  2.7894973754882812e-05
time for parepare:  0.00026679039001464844
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0005202293395996094
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0007739067077636719
----------------------check_connections_block total spend ----------------------------- 0.0025365352630615234
generate_one_block  0.0018739700317382812
generate_one_block  0.0021941661834716797
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010592937469482422
gen group dst list time:  7.677078247070312e-05
time for parepare:  0.0007219314575195312
local_output_nid generation:  0.00012993812561035156
local_in_edges_tensor generation:  0.0003807544708251953
mini_batch_src_global generation:  0.00032830238342285156
r_  generation:  0.0033419132232666016
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.0003464221954345703
mini_batch_src_global generation:  0.0005261898040771484
r_  generation:  0.004897117614746094
----------------------check_connections_block total spend ----------------------------- 0.01302027702331543
generate_one_block  0.006633758544921875
generate_one_block  0.007674455642700195
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020635128021240234
gen group dst list time:  0.00020647048950195312
time for parepare:  0.0013751983642578125
local_output_nid generation:  0.0003497600555419922
local_in_edges_tensor generation:  0.0010089874267578125
mini_batch_src_global generation:  0.0009903907775878906
r_  generation:  0.01257014274597168
local_output_nid generation:  0.0005209445953369141
local_in_edges_tensor generation:  0.0010302066802978516
mini_batch_src_global generation:  0.0017850399017333984
r_  generation:  0.01716303825378418
----------------------check_connections_block total spend ----------------------------- 0.04394340515136719
generate_one_block  0.018782615661621094
generate_one_block  0.024090290069580078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019218921661376953
gen group dst list time:  0.0005059242248535156
time for parepare:  0.0015408992767333984
local_output_nid generation:  0.0010695457458496094
local_in_edges_tensor generation:  0.0020842552185058594
mini_batch_src_global generation:  0.0017096996307373047
r_  generation:  0.022173404693603516
local_output_nid generation:  0.0012326240539550781
local_in_edges_tensor generation:  0.002379179000854492
mini_batch_src_global generation:  0.0027358531951904297
r_  generation:  0.02586221694946289
----------------------check_connections_block total spend ----------------------------- 0.07181668281555176
generate_one_block  0.030072927474975586
generate_one_block  0.03292036056518555
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019986629486083984
gen group dst list time:  0.0008306503295898438
time for parepare:  0.0016231536865234375
local_output_nid generation:  0.0015408992767333984
local_in_edges_tensor generation:  0.002827882766723633
mini_batch_src_global generation:  0.0017514228820800781
r_  generation:  0.0266268253326416
local_output_nid generation:  0.001512765884399414
local_in_edges_tensor generation:  0.0025720596313476562
mini_batch_src_global generation:  0.0028183460235595703
r_  generation:  0.026348352432250977
----------------------check_connections_block total spend ----------------------------- 0.07940983772277832
generate_one_block  0.033753156661987305
generate_one_block  0.03587603569030762
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.2166748046875 GB
    Memory Allocated: 0.07206010818481445  GigaBytes
Max Memory Allocated: 2.7388973236083984  GigaBytes

connection checking time:  0.21072673797607422
block generation total time  0.19387173652648926
average batch blocks generation time:  0.09693586826324463
block dataloader generation time/epoch 0.46230220794677734
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2166748046875 GB
    Memory Allocated: 0.06895637512207031  GigaBytes
Max Memory Allocated: 2.7388973236083984  GigaBytes

torch.Size([19104, 500])
torch.Size([17041, 32])
torch.Size([12558, 32])
torch.Size([4210, 32])
torch.Size([1128, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2166748046875 GB
    Memory Allocated: 2.6738295555114746  GigaBytes
Max Memory Allocated: 2.7388973236083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2166748046875 GB
    Memory Allocated: 0.06970739364624023  GigaBytes
Max Memory Allocated: 2.7388973236083984  GigaBytes

torch.Size([19401, 500])
torch.Size([18267, 32])
torch.Size([15001, 32])
torch.Size([6466, 32])
torch.Size([1671, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4119873046875 GB
    Memory Allocated: 2.787163734436035  GigaBytes
Max Memory Allocated: 2.787212371826172  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023383498191833496 |0.00306856632232666 |0.38467085361480713 |0.00015723705291748047 |0.5412305593490601 |0.010493040084838867 |
----------------------------------------------------------pseudo_mini_loss sum 1.4791967868804932
Total (block generation + training)time/epoch 2.3875410556793213
Training time/epoch 1.9246773719787598
Training time without block to device /epoch 1.9185402393341064
Training time without total dataloading part /epoch 1.8626103401184082
load block tensor time/epoch 0.04676699638366699
block to device time/epoch 0.00613713264465332
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  115202
Number of first layer input nodes during this epoch:  38505
