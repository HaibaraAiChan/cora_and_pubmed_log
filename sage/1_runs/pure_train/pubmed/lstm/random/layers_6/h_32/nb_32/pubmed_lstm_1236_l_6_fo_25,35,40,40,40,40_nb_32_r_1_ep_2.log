main start at this time 1648533853.1078668
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001850128173828125
random selection method range initialization spend 0.00020074844360351562
time for parepare:  4.458427429199219e-05
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  0.001462697982788086
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.239776611328125e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.58306884765625e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.702278137207031e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.9550323486328125e-05
----------------------check_connections_block total spend ----------------------------- 0.004090309143066406
generate_one_block  0.001146554946899414
generate_one_block  0.0009715557098388672
generate_one_block  0.001028299331665039
generate_one_block  0.0010251998901367188
generate_one_block  0.0009543895721435547
generate_one_block  0.0009405612945556641
generate_one_block  0.0009932518005371094
generate_one_block  0.0009598731994628906
generate_one_block  0.0009300708770751953
generate_one_block  0.0009505748748779297
generate_one_block  0.000985860824584961
generate_one_block  0.0009503364562988281
generate_one_block  0.00093841552734375
generate_one_block  0.0009405612945556641
generate_one_block  0.0009446144104003906
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013687610626220703
gen group dst list time:  7.367134094238281e-05
time for parepare:  0.0002701282501220703
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00015664100646972656
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001533031463623047
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  0.0001049041748046875
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0001842975616455078
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  8.988380432128906e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  6.246566772460938e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  8.440017700195312e-05
----------------------check_connections_block total spend ----------------------------- 0.004391193389892578
generate_one_block  0.0010712146759033203
generate_one_block  0.0011339187622070312
generate_one_block  0.001195669174194336
generate_one_block  0.0011496543884277344
generate_one_block  0.0010609626770019531
generate_one_block  0.0010347366333007812
generate_one_block  0.0009982585906982422
generate_one_block  0.0011374950408935547
generate_one_block  0.0009801387786865234
generate_one_block  0.0010666847229003906
generate_one_block  0.001068115234375
generate_one_block  0.0012259483337402344
generate_one_block  0.0010461807250976562
generate_one_block  0.0010178089141845703
generate_one_block  0.0010499954223632812
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010156631469726562
gen group dst list time:  0.00011277198791503906
time for parepare:  0.0006840229034423828
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00038623809814453125
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.00029659271240234375
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  0.00014209747314453125
r_  generation:  0.0014011859893798828
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0007729530334472656
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0003771781921386719
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00045800209045410156
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0002810955047607422
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0007152557373046875
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00013566017150878906
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0003559589385986328
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0004086494445800781
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  0.00013494491577148438
r_  generation:  0.0014257431030273438
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.0007252693176269531
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0005898475646972656
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.00038123130798339844
----------------------check_connections_block total spend ----------------------------- 0.015557050704956055
generate_one_block  0.0022335052490234375
generate_one_block  0.0013165473937988281
generate_one_block  0.002639293670654297
generate_one_block  0.00189208984375
generate_one_block  0.0013837814331054688
generate_one_block  0.0014698505401611328
generate_one_block  0.0012998580932617188
generate_one_block  0.0018458366394042969
generate_one_block  0.0014102458953857422
generate_one_block  0.0014045238494873047
generate_one_block  0.0015337467193603516
generate_one_block  0.002779722213745117
generate_one_block  0.0017940998077392578
generate_one_block  0.0016398429870605469
generate_one_block  0.0013747215270996094
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020427703857421875
gen group dst list time:  0.0003132820129394531
time for parepare:  0.0015995502471923828
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.0005257129669189453
mini_batch_src_global generation:  0.0003008842468261719
r_  generation:  0.002381563186645508
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.001432180404663086
local_output_nid generation:  0.0001227855682373047
local_in_edges_tensor generation:  0.0003542900085449219
mini_batch_src_global generation:  0.0005598068237304688
r_  generation:  0.004780292510986328
local_output_nid generation:  0.00012040138244628906
local_in_edges_tensor generation:  0.00030303001403808594
mini_batch_src_global generation:  0.00042724609375
r_  generation:  0.003423929214477539
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  0.0002956390380859375
r_  generation:  0.0025599002838134766
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  0.0002803802490234375
r_  generation:  0.0027761459350585938
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.0001933574676513672
r_  generation:  0.001539468765258789
local_output_nid generation:  0.00011038780212402344
local_in_edges_tensor generation:  0.00029277801513671875
mini_batch_src_global generation:  0.0003616809844970703
r_  generation:  0.004247903823852539
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  0.0002143383026123047
r_  generation:  0.001155853271484375
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.00018286705017089844
r_  generation:  0.0019505023956298828
local_output_nid generation:  8.654594421386719e-05
local_in_edges_tensor generation:  0.0002486705780029297
mini_batch_src_global generation:  0.0003275871276855469
r_  generation:  0.003509521484375
local_output_nid generation:  0.00013446807861328125
local_in_edges_tensor generation:  0.00042510032653808594
mini_batch_src_global generation:  0.0006923675537109375
r_  generation:  0.00590968132019043
local_output_nid generation:  0.0001220703125
local_in_edges_tensor generation:  0.0003039836883544922
mini_batch_src_global generation:  0.00043392181396484375
r_  generation:  0.003913164138793945
local_output_nid generation:  9.131431579589844e-05
local_in_edges_tensor generation:  0.0002567768096923828
mini_batch_src_global generation:  0.0004115104675292969
r_  generation:  0.0039675235748291016
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  0.0002319812774658203
r_  generation:  0.001653909683227539
----------------------check_connections_block total spend ----------------------------- 0.06896448135375977
generate_one_block  0.005491018295288086
generate_one_block  0.002911806106567383
generate_one_block  0.0076160430908203125
generate_one_block  0.0054035186767578125
generate_one_block  0.004460573196411133
generate_one_block  0.00488734245300293
generate_one_block  0.0027430057525634766
generate_one_block  0.0073354244232177734
generate_one_block  0.0025234222412109375
generate_one_block  0.0034728050231933594
generate_one_block  0.005962848663330078
generate_one_block  0.009254932403564453
generate_one_block  0.0060541629791259766
generate_one_block  0.006182432174682617
generate_one_block  0.0029554367065429688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022721290588378906
gen group dst list time:  0.0014524459838867188
time for parepare:  0.0016639232635498047
local_output_nid generation:  0.00030159950256347656
local_in_edges_tensor generation:  0.0011138916015625
mini_batch_src_global generation:  0.0009987354278564453
r_  generation:  0.00796818733215332
local_output_nid generation:  0.00029587745666503906
local_in_edges_tensor generation:  0.0005984306335449219
mini_batch_src_global generation:  0.0007288455963134766
r_  generation:  0.005986213684082031
local_output_nid generation:  0.00038695335388183594
local_in_edges_tensor generation:  0.0009281635284423828
mini_batch_src_global generation:  0.0009179115295410156
r_  generation:  0.010407686233520508
local_output_nid generation:  0.0005013942718505859
local_in_edges_tensor generation:  0.0009839534759521484
mini_batch_src_global generation:  0.0009272098541259766
r_  generation:  0.011438369750976562
local_output_nid generation:  0.0004115104675292969
local_in_edges_tensor generation:  0.0008246898651123047
mini_batch_src_global generation:  0.0008494853973388672
r_  generation:  0.011159658432006836
local_output_nid generation:  0.0004987716674804688
local_in_edges_tensor generation:  0.0007803440093994141
mini_batch_src_global generation:  0.00089263916015625
r_  generation:  0.011769771575927734
local_output_nid generation:  0.00022840499877929688
local_in_edges_tensor generation:  0.00041961669921875
mini_batch_src_global generation:  0.0006468296051025391
r_  generation:  0.00572657585144043
local_output_nid generation:  0.0006432533264160156
local_in_edges_tensor generation:  0.0009553432464599609
mini_batch_src_global generation:  0.0010361671447753906
r_  generation:  0.01307988166809082
local_output_nid generation:  0.000213623046875
local_in_edges_tensor generation:  0.00042724609375
mini_batch_src_global generation:  0.0007314682006835938
r_  generation:  0.0061872005462646484
local_output_nid generation:  0.0002837181091308594
local_in_edges_tensor generation:  0.0005083084106445312
mini_batch_src_global generation:  0.0007352828979492188
r_  generation:  0.008144378662109375
local_output_nid generation:  0.0004642009735107422
local_in_edges_tensor generation:  0.0007936954498291016
mini_batch_src_global generation:  0.001149892807006836
r_  generation:  0.01280665397644043
local_output_nid generation:  0.0005104541778564453
local_in_edges_tensor generation:  0.0026710033416748047
mini_batch_src_global generation:  0.0012247562408447266
r_  generation:  0.013578414916992188
local_output_nid generation:  0.0005056858062744141
local_in_edges_tensor generation:  0.0008370876312255859
mini_batch_src_global generation:  0.0010993480682373047
r_  generation:  0.013022422790527344
local_output_nid generation:  0.0004286766052246094
local_in_edges_tensor generation:  0.0007283687591552734
mini_batch_src_global generation:  0.0010950565338134766
r_  generation:  0.01131582260131836
local_output_nid generation:  0.000274658203125
local_in_edges_tensor generation:  0.0005316734313964844
mini_batch_src_global generation:  0.0007834434509277344
r_  generation:  0.006949901580810547
----------------------check_connections_block total spend ----------------------------- 0.21991181373596191
generate_one_block  0.012409210205078125
generate_one_block  0.00845646858215332
generate_one_block  0.013673067092895508
generate_one_block  0.015268087387084961
generate_one_block  0.015085935592651367
generate_one_block  0.015808820724487305
generate_one_block  0.008131027221679688
generate_one_block  0.01674652099609375
generate_one_block  0.009185075759887695
generate_one_block  0.012166738510131836
generate_one_block  0.01710367202758789
generate_one_block  0.019187211990356445
generate_one_block  0.018330812454223633
generate_one_block  0.015603303909301758
generate_one_block  0.010597944259643555
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017771720886230469
gen group dst list time:  0.004182338714599609
time for parepare:  0.0016906261444091797
local_output_nid generation:  0.00084686279296875
local_in_edges_tensor generation:  0.001764059066772461
mini_batch_src_global generation:  0.0015037059783935547
r_  generation:  0.016490459442138672
local_output_nid generation:  0.0007412433624267578
local_in_edges_tensor generation:  0.0015108585357666016
mini_batch_src_global generation:  0.0019288063049316406
r_  generation:  0.01628899574279785
local_output_nid generation:  0.0008821487426757812
local_in_edges_tensor generation:  0.0018613338470458984
mini_batch_src_global generation:  0.0015819072723388672
r_  generation:  0.01777029037475586
local_output_nid generation:  0.0012104511260986328
local_in_edges_tensor generation:  0.001711130142211914
mini_batch_src_global generation:  0.0020246505737304688
r_  generation:  0.020812511444091797
local_output_nid generation:  0.0010955333709716797
local_in_edges_tensor generation:  0.0016207695007324219
mini_batch_src_global generation:  0.001789093017578125
r_  generation:  0.020331859588623047
local_output_nid generation:  0.0011544227600097656
local_in_edges_tensor generation:  0.0016620159149169922
mini_batch_src_global generation:  0.001986980438232422
r_  generation:  0.020653724670410156
local_output_nid generation:  0.0007617473602294922
local_in_edges_tensor generation:  0.0010380744934082031
mini_batch_src_global generation:  0.001275777816772461
r_  generation:  0.013782024383544922
local_output_nid generation:  0.0011603832244873047
local_in_edges_tensor generation:  0.0017011165618896484
mini_batch_src_global generation:  0.001440286636352539
r_  generation:  0.021457433700561523
local_output_nid generation:  0.0006387233734130859
local_in_edges_tensor generation:  0.0011200904846191406
mini_batch_src_global generation:  0.00139617919921875
r_  generation:  0.014678239822387695
local_output_nid generation:  0.0009198188781738281
local_in_edges_tensor generation:  0.0013022422790527344
mini_batch_src_global generation:  0.0015277862548828125
r_  generation:  0.018329858779907227
local_output_nid generation:  0.0010423660278320312
local_in_edges_tensor generation:  0.0021660327911376953
mini_batch_src_global generation:  0.0019540786743164062
r_  generation:  0.02121448516845703
local_output_nid generation:  0.0010898113250732422
local_in_edges_tensor generation:  0.0021381378173828125
mini_batch_src_global generation:  0.0017802715301513672
r_  generation:  0.021291494369506836
local_output_nid generation:  0.0013477802276611328
local_in_edges_tensor generation:  0.002005338668823242
mini_batch_src_global generation:  0.0020341873168945312
r_  generation:  0.022971391677856445
local_output_nid generation:  0.0009608268737792969
local_in_edges_tensor generation:  0.0014052391052246094
mini_batch_src_global generation:  0.0016963481903076172
r_  generation:  0.019163131713867188
local_output_nid generation:  0.0009558200836181641
local_in_edges_tensor generation:  0.0013692378997802734
mini_batch_src_global generation:  0.0015788078308105469
r_  generation:  0.018951416015625
----------------------check_connections_block total spend ----------------------------- 0.4128603935241699
generate_one_block  0.02149224281311035
generate_one_block  0.02309584617614746
generate_one_block  0.023076772689819336
generate_one_block  0.02753591537475586
generate_one_block  0.026053667068481445
generate_one_block  0.02698516845703125
generate_one_block  0.01745748519897461
generate_one_block  0.026587963104248047
generate_one_block  0.020313262939453125
generate_one_block  0.023464441299438477
generate_one_block  0.030131816864013672
generate_one_block  0.02717900276184082
generate_one_block  0.028924942016601562
generate_one_block  0.024082422256469727
generate_one_block  0.024160146713256836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

connection checking time:  0.7216849327087402
block generation total time  0.6978042125701904
average batch blocks generation time:  0.0465202808380127
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1287841796875 GB
    Memory Allocated: 0.035843849182128906  GigaBytes
Max Memory Allocated: 0.035843849182128906  GigaBytes

torch.Size([14320, 500])
torch.Size([8721, 32])
torch.Size([2930, 32])
torch.Size([727, 32])
torch.Size([141, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1053466796875 GB
    Memory Allocated: 1.7399606704711914  GigaBytes
Max Memory Allocated: 1.7953987121582031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1053466796875 GB
    Memory Allocated: 0.04656982421875  GigaBytes
Max Memory Allocated: 1.7953987121582031  GigaBytes

torch.Size([16317, 500])
torch.Size([8110, 32])
torch.Size([3024, 32])
torch.Size([550, 32])
torch.Size([133, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2108154296875 GB
    Memory Allocated: 1.7273998260498047  GigaBytes
Max Memory Allocated: 1.8072667121887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2108154296875 GB
    Memory Allocated: 0.04436445236206055  GigaBytes
Max Memory Allocated: 1.8072667121887207  GigaBytes

torch.Size([14984, 500])
torch.Size([9432, 32])
torch.Size([4552, 32])
torch.Size([1405, 32])
torch.Size([312, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3260498046875 GB
    Memory Allocated: 1.8685073852539062  GigaBytes
Max Memory Allocated: 1.8921637535095215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3280029296875 GB
    Memory Allocated: 0.04948902130126953  GigaBytes
Max Memory Allocated: 1.8921637535095215  GigaBytes

torch.Size([17740, 500])
torch.Size([12035, 32])
torch.Size([5453, 32])
torch.Size([1440, 32])
torch.Size([322, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5076904296875 GB
    Memory Allocated: 2.1176180839538574  GigaBytes
Max Memory Allocated: 2.1819534301757812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5076904296875 GB
    Memory Allocated: 0.04777812957763672  GigaBytes
Max Memory Allocated: 2.1819534301757812  GigaBytes

torch.Size([16830, 500])
torch.Size([10906, 32])
torch.Size([4428, 32])
torch.Size([664, 32])
torch.Size([146, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5076904296875 GB
    Memory Allocated: 2.0791454315185547  GigaBytes
Max Memory Allocated: 2.1819534301757812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5076904296875 GB
    Memory Allocated: 0.048865318298339844  GigaBytes
Max Memory Allocated: 2.1819534301757812  GigaBytes

torch.Size([17402, 500])
torch.Size([11306, 32])
torch.Size([5299, 32])
torch.Size([768, 32])
torch.Size([199, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 2.133392333984375  GigaBytes
Max Memory Allocated: 2.196927070617676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.04089546203613281  GigaBytes
Max Memory Allocated: 2.196927070617676  GigaBytes

torch.Size([13330, 500])
torch.Size([7424, 32])
torch.Size([2355, 32])
torch.Size([606, 32])
torch.Size([103, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.3392419815063477  GigaBytes
Max Memory Allocated: 2.196927070617676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.0502471923828125  GigaBytes
Max Memory Allocated: 2.196927070617676  GigaBytes

torch.Size([18103, 500])
torch.Size([12525, 32])
torch.Size([7364, 32])
torch.Size([1393, 32])
torch.Size([283, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6580810546875 GB
    Memory Allocated: 2.185642719268799  GigaBytes
Max Memory Allocated: 2.235686779022217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6580810546875 GB
    Memory Allocated: 0.04163646697998047  GigaBytes
Max Memory Allocated: 2.235686779022217  GigaBytes

torch.Size([13691, 500])
torch.Size([6562, 32])
torch.Size([2220, 32])
torch.Size([255, 32])
torch.Size([50, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6580810546875 GB
    Memory Allocated: 1.5333547592163086  GigaBytes
Max Memory Allocated: 2.235686779022217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6580810546875 GB
    Memory Allocated: 0.045581817626953125  GigaBytes
Max Memory Allocated: 2.235686779022217  GigaBytes

torch.Size([15719, 500])
torch.Size([9620, 32])
torch.Size([3259, 32])
torch.Size([674, 32])
torch.Size([137, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6580810546875 GB
    Memory Allocated: 1.8944025039672852  GigaBytes
Max Memory Allocated: 2.235686779022217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6580810546875 GB
    Memory Allocated: 0.04872322082519531  GigaBytes
Max Memory Allocated: 2.235686779022217  GigaBytes

torch.Size([17291, 500])
torch.Size([11882, 32])
torch.Size([5201, 32])
torch.Size([1019, 32])
torch.Size([113, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6658935546875 GB
    Memory Allocated: 2.1759018898010254  GigaBytes
Max Memory Allocated: 2.235686779022217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6658935546875 GB
    Memory Allocated: 0.048252105712890625  GigaBytes
Max Memory Allocated: 2.235686779022217  GigaBytes

torch.Size([16976, 500])
torch.Size([12002, 32])
torch.Size([6229, 32])
torch.Size([1907, 32])
torch.Size([420, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6834716796875 GB
    Memory Allocated: 2.188138961791992  GigaBytes
Max Memory Allocated: 2.235686779022217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6834716796875 GB
    Memory Allocated: 0.04994010925292969  GigaBytes
Max Memory Allocated: 2.235686779022217  GigaBytes

torch.Size([17919, 500])
torch.Size([13785, 32])
torch.Size([5955, 32])
torch.Size([1462, 32])
torch.Size([219, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 2.301504135131836  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.046807289123535156  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([16291, 500])
torch.Size([10098, 32])
torch.Size([5185, 32])
torch.Size([1043, 32])
torch.Size([154, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 1.995314121246338  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.04659557342529297  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([16289, 500])
torch.Size([9589, 32])
torch.Size([3076, 32])
torch.Size([671, 32])
torch.Size([180, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 1.8959364891052246  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01429438591003418 |0.02493112881978353 |0.32555925051371254 |0.00014843940734863282 |0.39034433364868165 |0.01465296745300293 |
----------------------------------------------------------pseudo_mini_loss sum 2.1222469806671143
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  481581
Number of first layer input nodes during this epoch:  243202
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.06465911865234375  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007734298706054688
random selection method range initialization spend 0.0001633167266845703
time for parepare:  8.130073547363281e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.2901763916015625e-05
----------------------check_connections_block total spend ----------------------------- 0.0030975341796875
generate_one_block  0.001306772232055664
generate_one_block  0.001100778579711914
generate_one_block  0.0010976791381835938
generate_one_block  0.001066446304321289
generate_one_block  0.0010597705841064453
generate_one_block  0.0010683536529541016
generate_one_block  0.0010538101196289062
generate_one_block  0.0010652542114257812
generate_one_block  0.0010738372802734375
generate_one_block  0.0010726451873779297
generate_one_block  0.0010113716125488281
generate_one_block  0.0010528564453125
generate_one_block  0.001028299331665039
generate_one_block  0.001064300537109375
generate_one_block  0.0010652542114257812
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007798671722412109
gen group dst list time:  9.393692016601562e-05
time for parepare:  0.00037097930908203125
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00010776519775390625
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  8.177757263183594e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0002167224884033203
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  8.749961853027344e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00016260147094726562
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0001480579376220703
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00020003318786621094
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  8.177757263183594e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00014638900756835938
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00013327598571777344
----------------------check_connections_block total spend ----------------------------- 0.005570650100708008
generate_one_block  0.0013575553894042969
generate_one_block  0.001186370849609375
generate_one_block  0.0014095306396484375
generate_one_block  0.0011234283447265625
generate_one_block  0.0011911392211914062
generate_one_block  0.00109100341796875
generate_one_block  0.0010962486267089844
generate_one_block  0.0013022422790527344
generate_one_block  0.0019063949584960938
generate_one_block  0.0012505054473876953
generate_one_block  0.001165151596069336
generate_one_block  0.0010669231414794922
generate_one_block  0.0010859966278076172
generate_one_block  0.0012652873992919922
generate_one_block  0.0011997222900390625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013165473937988281
gen group dst list time:  0.00015497207641601562
time for parepare:  0.0010418891906738281
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0003948211669921875
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0005295276641845703
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  0.00010752677917480469
r_  generation:  0.0004718303680419922
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.00024437904357910156
mini_batch_src_global generation:  0.0002372264862060547
r_  generation:  0.0015864372253417969
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.0003914833068847656
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.00042819976806640625
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00016927719116210938
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.0002067089080810547
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0008976459503173828
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  0.000110626220703125
r_  generation:  0.0009067058563232422
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.0001678466796875
r_  generation:  0.0014507770538330078
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0004258155822753906
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0003094673156738281
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.000335693359375
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0007333755493164062
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.0001277923583984375
r_  generation:  0.0009887218475341797
----------------------check_connections_block total spend ----------------------------- 0.01894235610961914
generate_one_block  0.0019278526306152344
generate_one_block  0.0016362667083740234
generate_one_block  0.0030059814453125
generate_one_block  0.001493692398071289
generate_one_block  0.0015163421630859375
generate_one_block  0.0012826919555664062
generate_one_block  0.001230001449584961
generate_one_block  0.0021486282348632812
generate_one_block  0.0021665096282958984
generate_one_block  0.0028319358825683594
generate_one_block  0.0014874935150146484
generate_one_block  0.0013422966003417969
generate_one_block  0.0014147758483886719
generate_one_block  0.0019307136535644531
generate_one_block  0.0023910999298095703
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0022482872009277344
gen group dst list time:  0.00041174888610839844
time for parepare:  0.001840353012084961
local_output_nid generation:  0.00013184547424316406
local_in_edges_tensor generation:  0.0008597373962402344
mini_batch_src_global generation:  0.0004930496215820312
r_  generation:  0.0037703514099121094
local_output_nid generation:  0.00010085105895996094
local_in_edges_tensor generation:  0.0003006458282470703
mini_batch_src_global generation:  0.00035190582275390625
r_  generation:  0.002595186233520508
local_output_nid generation:  0.00018477439880371094
local_in_edges_tensor generation:  0.00044727325439453125
mini_batch_src_global generation:  0.0006535053253173828
r_  generation:  0.005685329437255859
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.0002734661102294922
mini_batch_src_global generation:  0.0003628730773925781
r_  generation:  0.002549409866333008
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.0002601146697998047
mini_batch_src_global generation:  0.0002503395080566406
r_  generation:  0.0017952919006347656
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.001056671142578125
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.00013685226440429688
r_  generation:  0.001142263412475586
local_output_nid generation:  0.00015807151794433594
local_in_edges_tensor generation:  0.00035953521728515625
mini_batch_src_global generation:  0.0004341602325439453
r_  generation:  0.00470280647277832
local_output_nid generation:  0.0002028942108154297
local_in_edges_tensor generation:  0.0003948211669921875
mini_batch_src_global generation:  0.0005190372467041016
r_  generation:  0.005218505859375
local_output_nid generation:  0.00019502639770507812
local_in_edges_tensor generation:  0.00041174888610839844
mini_batch_src_global generation:  0.0005855560302734375
r_  generation:  0.0056455135345458984
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.000274658203125
mini_batch_src_global generation:  0.0003917217254638672
r_  generation:  0.003625154495239258
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.00027441978454589844
mini_batch_src_global generation:  0.00023651123046875
r_  generation:  0.0016472339630126953
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.00026035308837890625
mini_batch_src_global generation:  0.00026488304138183594
r_  generation:  0.0021610260009765625
local_output_nid generation:  0.00014662742614746094
local_in_edges_tensor generation:  0.0003380775451660156
mini_batch_src_global generation:  0.00032782554626464844
r_  generation:  0.0031883716583251953
local_output_nid generation:  0.0002562999725341797
local_in_edges_tensor generation:  0.00046634674072265625
mini_batch_src_global generation:  0.0005152225494384766
r_  generation:  0.0057904720306396484
----------------------check_connections_block total spend ----------------------------- 0.07916760444641113
generate_one_block  0.007714748382568359
generate_one_block  0.004845142364501953
generate_one_block  0.008713245391845703
generate_one_block  0.004824161529541016
generate_one_block  0.0036542415618896484
generate_one_block  0.0026264190673828125
generate_one_block  0.002664804458618164
generate_one_block  0.008265256881713867
generate_one_block  0.008080482482910156
generate_one_block  0.009105443954467773
generate_one_block  0.005172252655029297
generate_one_block  0.003358602523803711
generate_one_block  0.00405120849609375
generate_one_block  0.005541563034057617
generate_one_block  0.0092620849609375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0074994564056396484
gen group dst list time:  0.003326416015625
time for parepare:  0.0028960704803466797
local_output_nid generation:  0.0015265941619873047
local_in_edges_tensor generation:  0.002358675003051758
mini_batch_src_global generation:  0.0020728111267089844
r_  generation:  0.013549566268920898
local_output_nid generation:  0.0004928112030029297
local_in_edges_tensor generation:  0.0010175704956054688
mini_batch_src_global generation:  0.0010845661163330078
r_  generation:  0.008174419403076172
local_output_nid generation:  0.0006234645843505859
local_in_edges_tensor generation:  0.0009920597076416016
mini_batch_src_global generation:  0.0011000633239746094
r_  generation:  0.011592626571655273
local_output_nid generation:  0.00046825408935546875
local_in_edges_tensor generation:  0.0009961128234863281
mini_batch_src_global generation:  0.0009319782257080078
r_  generation:  0.010497570037841797
local_output_nid generation:  0.0003864765167236328
local_in_edges_tensor generation:  0.0007987022399902344
mini_batch_src_global generation:  0.0007953643798828125
r_  generation:  0.007014036178588867
local_output_nid generation:  0.00026679039001464844
local_in_edges_tensor generation:  0.0006718635559082031
mini_batch_src_global generation:  0.00057220458984375
r_  generation:  0.0047740936279296875
local_output_nid generation:  0.0002980232238769531
local_in_edges_tensor generation:  0.0006413459777832031
mini_batch_src_global generation:  0.0006153583526611328
r_  generation:  0.005647182464599609
local_output_nid generation:  0.0009949207305908203
local_in_edges_tensor generation:  0.0011882781982421875
mini_batch_src_global generation:  0.00115966796875
r_  generation:  0.016688823699951172
local_output_nid generation:  0.0008106231689453125
local_in_edges_tensor generation:  0.0014522075653076172
mini_batch_src_global generation:  0.0018773078918457031
r_  generation:  0.015115022659301758
local_output_nid generation:  0.0006694793701171875
local_in_edges_tensor generation:  0.0010802745819091797
mini_batch_src_global generation:  0.0012278556823730469
r_  generation:  0.012679338455200195
local_output_nid generation:  0.0006756782531738281
local_in_edges_tensor generation:  0.0009496212005615234
mini_batch_src_global generation:  0.001176595687866211
r_  generation:  0.011474609375
local_output_nid generation:  0.00041747093200683594
local_in_edges_tensor generation:  0.0006916522979736328
mini_batch_src_global generation:  0.0008018016815185547
r_  generation:  0.006510019302368164
local_output_nid generation:  0.00035381317138671875
local_in_edges_tensor generation:  0.0006229877471923828
mini_batch_src_global generation:  0.0007479190826416016
r_  generation:  0.007022380828857422
local_output_nid generation:  0.0005688667297363281
local_in_edges_tensor generation:  0.0009453296661376953
mini_batch_src_global generation:  0.0009260177612304688
r_  generation:  0.010202884674072266
local_output_nid generation:  0.0009410381317138672
local_in_edges_tensor generation:  0.0012552738189697266
mini_batch_src_global generation:  0.001501321792602539
r_  generation:  0.017890214920043945
----------------------check_connections_block total spend ----------------------------- 0.24444222450256348
generate_one_block  0.031151771545410156
generate_one_block  0.013312816619873047
generate_one_block  0.016687870025634766
generate_one_block  0.015920162200927734
generate_one_block  0.01184701919555664
generate_one_block  0.008160114288330078
generate_one_block  0.00921940803527832
generate_one_block  0.019412994384765625
generate_one_block  0.024671077728271484
generate_one_block  0.018108367919921875
generate_one_block  0.02377605438232422
generate_one_block  0.011939048767089844
generate_one_block  0.012035131454467773
generate_one_block  0.016150474548339844
generate_one_block  0.02577376365661621
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.003311634063720703
gen group dst list time:  0.0042688846588134766
time for parepare:  0.0018355846405029297
local_output_nid generation:  0.0016286373138427734
local_in_edges_tensor generation:  0.002744913101196289
mini_batch_src_global generation:  0.0018725395202636719
r_  generation:  0.021686077117919922
local_output_nid generation:  0.0011584758758544922
local_in_edges_tensor generation:  0.0016355514526367188
mini_batch_src_global generation:  0.0019366741180419922
r_  generation:  0.017982959747314453
local_output_nid generation:  0.0012137889862060547
local_in_edges_tensor generation:  0.0016639232635498047
mini_batch_src_global generation:  0.0014514923095703125
r_  generation:  0.019222497940063477
local_output_nid generation:  0.001203775405883789
local_in_edges_tensor generation:  0.0017600059509277344
mini_batch_src_global generation:  0.0017957687377929688
r_  generation:  0.019578218460083008
local_output_nid generation:  0.0010752677917480469
local_in_edges_tensor generation:  0.0014522075653076172
mini_batch_src_global generation:  0.0015151500701904297
r_  generation:  0.01891946792602539
local_output_nid generation:  0.0007979869842529297
local_in_edges_tensor generation:  0.0010662078857421875
mini_batch_src_global generation:  0.0012433528900146484
r_  generation:  0.012948036193847656
local_output_nid generation:  0.0009558200836181641
local_in_edges_tensor generation:  0.0011639595031738281
mini_batch_src_global generation:  0.0011456012725830078
r_  generation:  0.014586687088012695
local_output_nid generation:  0.0014052391052246094
local_in_edges_tensor generation:  0.0017468929290771484
mini_batch_src_global generation:  0.0018885135650634766
r_  generation:  0.02205348014831543
local_output_nid generation:  0.0014591217041015625
local_in_edges_tensor generation:  0.0019533634185791016
mini_batch_src_global generation:  0.0020542144775390625
r_  generation:  0.02304840087890625
local_output_nid generation:  0.0011134147644042969
local_in_edges_tensor generation:  0.0017011165618896484
mini_batch_src_global generation:  0.0016548633575439453
r_  generation:  0.019399642944335938
local_output_nid generation:  0.001293182373046875
local_in_edges_tensor generation:  0.0017428398132324219
mini_batch_src_global generation:  0.0019080638885498047
r_  generation:  0.020495176315307617
local_output_nid generation:  0.000896453857421875
local_in_edges_tensor generation:  0.0012705326080322266
mini_batch_src_global generation:  0.00151824951171875
r_  generation:  0.016491174697875977
local_output_nid generation:  0.0007078647613525391
local_in_edges_tensor generation:  0.001046895980834961
mini_batch_src_global generation:  0.001279592514038086
r_  generation:  0.013979673385620117
local_output_nid generation:  0.0012505054473876953
local_in_edges_tensor generation:  0.0015609264373779297
mini_batch_src_global generation:  0.0014557838439941406
r_  generation:  0.019632577896118164
local_output_nid generation:  0.0016262531280517578
local_in_edges_tensor generation:  0.002076864242553711
mini_batch_src_global generation:  0.0018811225891113281
r_  generation:  0.02411651611328125
----------------------check_connections_block total spend ----------------------------- 0.4164884090423584
generate_one_block  0.0302736759185791
generate_one_block  0.024950742721557617
generate_one_block  0.02582693099975586
generate_one_block  0.026510238647460938
generate_one_block  0.025347232818603516
generate_one_block  0.018759489059448242
generate_one_block  0.020412683486938477
generate_one_block  0.029915571212768555
generate_one_block  0.03146815299987793
generate_one_block  0.027011871337890625
generate_one_block  0.027704954147338867
generate_one_block  0.026712656021118164
generate_one_block  0.02043604850769043
generate_one_block  0.0268402099609375
generate_one_block  0.0326993465423584
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.06465911865234375  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

connection checking time:  0.7646112442016602
block generation total time  0.787419319152832
average batch blocks generation time:  0.05249462127685547
block dataloader generation time/epoch 1.841585397720337
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.06610250473022461  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([17477, 500])
torch.Size([11838, 32])
torch.Size([5703, 32])
torch.Size([897, 32])
torch.Size([195, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 2.202439785003662  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.06363296508789062  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([15988, 500])
torch.Size([9773, 32])
torch.Size([3816, 32])
torch.Size([862, 32])
torch.Size([132, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 1.7830004692077637  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.0632791519165039  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([15971, 500])
torch.Size([10012, 32])
torch.Size([5050, 32])
torch.Size([1494, 32])
torch.Size([361, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 1.9751172065734863  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.06273698806762695  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([15750, 500])
torch.Size([10172, 32])
torch.Size([3723, 32])
torch.Size([681, 32])
torch.Size([83, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 1.9756011962890625  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.06195878982543945  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([15407, 500])
torch.Size([8322, 32])
torch.Size([3009, 32])
torch.Size([579, 32])
torch.Size([180, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 1.7875285148620605  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.05875968933105469  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([13800, 500])
torch.Size([5738, 32])
torch.Size([2078, 32])
torch.Size([263, 32])
torch.Size([66, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 1.2971816062927246  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.06029939651489258  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([14594, 500])
torch.Size([7359, 32])
torch.Size([2388, 32])
torch.Size([360, 32])
torch.Size([77, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 1.4411845207214355  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.06745767593383789  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([18185, 500])
torch.Size([12815, 32])
torch.Size([7587, 32])
torch.Size([1461, 32])
torch.Size([357, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 2.2411623001098633  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.0665578842163086  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([17663, 500])
torch.Size([13291, 32])
torch.Size([6200, 32])
torch.Size([1617, 32])
torch.Size([244, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 2.316636562347412  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.06307697296142578  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([15845, 500])
torch.Size([10284, 32])
torch.Size([5491, 32])
torch.Size([1676, 32])
torch.Size([358, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 2.0038928985595703  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.06533098220825195  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([17114, 500])
torch.Size([10715, 32])
torch.Size([4897, 32])
torch.Size([672, 32])
torch.Size([151, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 2.0864624977111816  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.06272125244140625  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([15379, 500])
torch.Size([7689, 32])
torch.Size([3039, 32])
torch.Size([461, 32])
torch.Size([131, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 1.668259620666504  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.05662679672241211  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([12361, 500])
torch.Size([6347, 32])
torch.Size([2665, 32])
torch.Size([560, 32])
torch.Size([108, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 1.4318513870239258  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.06491327285766602  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([16921, 500])
torch.Size([11236, 32])
torch.Size([4807, 32])
torch.Size([1311, 32])
torch.Size([264, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 1.9603042602539062  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 0.06745481491088867  GigaBytes
Max Memory Allocated: 2.3624649047851562  GigaBytes

torch.Size([18094, 500])
torch.Size([14916, 32])
torch.Size([7238, 32])
torch.Size([2037, 32])
torch.Size([232, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9764404296875 GB
    Memory Allocated: 2.4172115325927734  GigaBytes
Max Memory Allocated: 2.450685501098633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014858373006184896 |0.004688151677449544 |0.29566235542297364 |0.00014247894287109376 |0.3870877583821615 |0.011479377746582031 |
----------------------------------------------------------pseudo_mini_loss sum 1.6416995525360107
Total (block generation + training)time/epoch 12.439568281173706
Training time/epoch 10.597452402114868
Training time without block to device /epoch 10.527130126953125
Training time without total dataloading part /epoch 10.254868268966675
load block tensor time/epoch 0.22287559509277344
block to device time/epoch 0.07032227516174316
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  476974
Number of first layer input nodes during this epoch:  240549
