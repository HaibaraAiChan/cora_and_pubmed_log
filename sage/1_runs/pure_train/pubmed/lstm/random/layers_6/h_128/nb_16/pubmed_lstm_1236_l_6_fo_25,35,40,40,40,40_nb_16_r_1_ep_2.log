main start at this time 1648534038.8426647
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001230001449584961
random selection method range initialization spend 0.0001811981201171875
time for parepare:  4.887580871582031e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0011129379272460938
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.2874603271484375e-05
----------------------check_connections_block total spend ----------------------------- 0.002799510955810547
generate_one_block  0.001219034194946289
generate_one_block  0.0010600090026855469
generate_one_block  0.0010650157928466797
generate_one_block  0.0010859966278076172
generate_one_block  0.0010221004486083984
generate_one_block  0.0010399818420410156
generate_one_block  0.0010383129119873047
generate_one_block  0.0010111331939697266
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0008330345153808594
gen group dst list time:  5.269050598144531e-05
time for parepare:  0.00027298927307128906
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.000263214111328125
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00021839141845703125
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0003917217254638672
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0001609325408935547
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00018167495727539062
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.8160552978515625e-05
----------------------check_connections_block total spend ----------------------------- 0.003612041473388672
generate_one_block  0.0013592243194580078
generate_one_block  0.0013425350189208984
generate_one_block  0.0015840530395507812
generate_one_block  0.0012373924255371094
generate_one_block  0.0011417865753173828
generate_one_block  0.0012798309326171875
generate_one_block  0.001116037368774414
generate_one_block  0.0010602474212646484
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012459754943847656
gen group dst list time:  9.5367431640625e-05
time for parepare:  0.0008091926574707031
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00028014183044433594
mini_batch_src_global generation:  0.00011515617370605469
r_  generation:  0.001165628433227539
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  0.000156402587890625
r_  generation:  0.0013360977172851562
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00023674964904785156
mini_batch_src_global generation:  0.00026035308837890625
r_  generation:  0.0025014877319335938
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00017380714416503906
r_  generation:  0.0012354850769042969
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0005006790161132812
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  0.00012350082397460938
r_  generation:  0.0012798309326171875
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.000518798828125
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0002532005310058594
----------------------check_connections_block total spend ----------------------------- 0.014925479888916016
generate_one_block  0.002485036849975586
generate_one_block  0.0025708675384521484
generate_one_block  0.003941059112548828
generate_one_block  0.0024557113647460938
generate_one_block  0.0014848709106445312
generate_one_block  0.0024178028106689453
generate_one_block  0.0015015602111816406
generate_one_block  0.001199483871459961
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018303394317626953
gen group dst list time:  0.0002665519714355469
time for parepare:  0.001577615737915039
local_output_nid generation:  0.00014972686767578125
local_in_edges_tensor generation:  0.0005800724029541016
mini_batch_src_global generation:  0.0005474090576171875
r_  generation:  0.004664897918701172
local_output_nid generation:  0.0001900196075439453
local_in_edges_tensor generation:  0.00043964385986328125
mini_batch_src_global generation:  0.0008480548858642578
r_  generation:  0.00647425651550293
local_output_nid generation:  0.00021648406982421875
local_in_edges_tensor generation:  0.0005123615264892578
mini_batch_src_global generation:  0.0009582042694091797
r_  generation:  0.007428169250488281
local_output_nid generation:  0.00021314620971679688
local_in_edges_tensor generation:  0.00045108795166015625
mini_batch_src_global generation:  0.0006587505340576172
r_  generation:  0.0067021846771240234
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.00024580955505371094
mini_batch_src_global generation:  0.0004277229309082031
r_  generation:  0.0032312870025634766
local_output_nid generation:  0.00017189979553222656
local_in_edges_tensor generation:  0.00040268898010253906
mini_batch_src_global generation:  0.0005936622619628906
r_  generation:  0.0066416263580322266
local_output_nid generation:  8.678436279296875e-05
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  0.0004763603210449219
r_  generation:  0.003697633743286133
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.0002598762512207031
r_  generation:  0.0019121170043945312
----------------------check_connections_block total spend ----------------------------- 0.06195807456970215
generate_one_block  0.0075283050537109375
generate_one_block  0.00904989242553711
generate_one_block  0.010807275772094727
generate_one_block  0.010020017623901367
generate_one_block  0.005290985107421875
generate_one_block  0.010167598724365234
generate_one_block  0.005856037139892578
generate_one_block  0.003322601318359375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002103090286254883
gen group dst list time:  0.0013775825500488281
time for parepare:  0.0018374919891357422
local_output_nid generation:  0.0006096363067626953
local_in_edges_tensor generation:  0.0013365745544433594
mini_batch_src_global generation:  0.0014452934265136719
r_  generation:  0.01359105110168457
local_output_nid generation:  0.0008842945098876953
local_in_edges_tensor generation:  0.0016772747039794922
mini_batch_src_global generation:  0.0020825862884521484
r_  generation:  0.017750978469848633
local_output_nid generation:  0.0007739067077636719
local_in_edges_tensor generation:  0.0022852420806884766
mini_batch_src_global generation:  0.001527547836303711
r_  generation:  0.017377614974975586
local_output_nid generation:  0.0007789134979248047
local_in_edges_tensor generation:  0.0014231204986572266
mini_batch_src_global generation:  0.0016584396362304688
r_  generation:  0.018845796585083008
local_output_nid generation:  0.00044918060302734375
local_in_edges_tensor generation:  0.0007359981536865234
mini_batch_src_global generation:  0.0011668205261230469
r_  generation:  0.011353492736816406
local_output_nid generation:  0.0007374286651611328
local_in_edges_tensor generation:  0.0012066364288330078
mini_batch_src_global generation:  0.0012214183807373047
r_  generation:  0.017859458923339844
local_output_nid generation:  0.00046944618225097656
local_in_edges_tensor generation:  0.0010094642639160156
mini_batch_src_global generation:  0.0013017654418945312
r_  generation:  0.013523101806640625
local_output_nid generation:  0.00033926963806152344
local_in_edges_tensor generation:  0.0005843639373779297
mini_batch_src_global generation:  0.0009784698486328125
r_  generation:  0.008061647415161133
----------------------check_connections_block total spend ----------------------------- 0.17496490478515625
generate_one_block  0.017078161239624023
generate_one_block  0.024079561233520508
generate_one_block  0.02230691909790039
generate_one_block  0.02475714683532715
generate_one_block  0.01529383659362793
generate_one_block  0.023571014404296875
generate_one_block  0.01853775978088379
generate_one_block  0.014260530471801758
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018219947814941406
gen group dst list time:  0.0027582645416259766
time for parepare:  0.0017421245574951172
local_output_nid generation:  0.001287221908569336
local_in_edges_tensor generation:  0.002272367477416992
mini_batch_src_global generation:  0.0021038055419921875
r_  generation:  0.02264404296875
local_output_nid generation:  0.0013959407806396484
local_in_edges_tensor generation:  0.002675294876098633
mini_batch_src_global generation:  0.0027379989624023438
r_  generation:  0.024575471878051758
local_output_nid generation:  0.001415252685546875
local_in_edges_tensor generation:  0.002172708511352539
mini_batch_src_global generation:  0.002050638198852539
r_  generation:  0.023786067962646484
local_output_nid generation:  0.0016484260559082031
local_in_edges_tensor generation:  0.002201557159423828
mini_batch_src_global generation:  0.00225830078125
r_  generation:  0.024934768676757812
local_output_nid generation:  0.0010318756103515625
local_in_edges_tensor generation:  0.0014035701751708984
mini_batch_src_global generation:  0.0017087459564208984
r_  generation:  0.020084857940673828
local_output_nid generation:  0.0014865398406982422
local_in_edges_tensor generation:  0.00186920166015625
mini_batch_src_global generation:  0.0020058155059814453
r_  generation:  0.02407693862915039
local_output_nid generation:  0.0012350082397460938
local_in_edges_tensor generation:  0.0022182464599609375
mini_batch_src_global generation:  0.0018100738525390625
r_  generation:  0.022090435028076172
local_output_nid generation:  0.0009322166442871094
local_in_edges_tensor generation:  0.0012805461883544922
mini_batch_src_global generation:  0.001607656478881836
r_  generation:  0.01822376251220703
----------------------check_connections_block total spend ----------------------------- 0.2638084888458252
generate_one_block  0.027408599853515625
generate_one_block  0.031524658203125
generate_one_block  0.029005765914916992
generate_one_block  0.03038501739501953
generate_one_block  0.02549004554748535
generate_one_block  0.029045581817626953
generate_one_block  0.028354406356811523
generate_one_block  0.023554563522338867
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

connection checking time:  0.5192689895629883
block generation total time  0.47487378120422363
average batch blocks generation time:  0.059359222650527954
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1405029296875 GB
    Memory Allocated: 0.04572582244873047  GigaBytes
Max Memory Allocated: 0.04572582244873047  GigaBytes

torch.Size([18163, 500])
torch.Size([13501, 128])
torch.Size([6414, 128])
torch.Size([1857, 128])
torch.Size([443, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9920654296875 GB
    Memory Allocated: 2.638434410095215  GigaBytes
Max Memory Allocated: 2.638491630554199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9940185546875 GB
    Memory Allocated: 0.057900428771972656  GigaBytes
Max Memory Allocated: 2.6393661499023438  GigaBytes

torch.Size([18744, 500])
torch.Size([15125, 128])
torch.Size([9455, 128])
torch.Size([2086, 128])
torch.Size([502, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2283935546875 GB
    Memory Allocated: 2.9601259231567383  GigaBytes
Max Memory Allocated: 2.960160732269287  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2576904296875 GB
    Memory Allocated: 0.05693817138671875  GigaBytes
Max Memory Allocated: 2.9610719680786133  GigaBytes

torch.Size([18194, 500])
torch.Size([14001, 128])
torch.Size([8294, 128])
torch.Size([2477, 128])
torch.Size([701, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 2.965538501739502  GigaBytes
Max Memory Allocated: 2.9656529426574707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 0.05734682083129883  GigaBytes
Max Memory Allocated: 2.9664740562438965  GigaBytes

torch.Size([18412, 500])
torch.Size([15870, 128])
torch.Size([8492, 128])
torch.Size([2538, 128])
torch.Size([350, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5897216796875 GB
    Memory Allocated: 3.040048599243164  GigaBytes
Max Memory Allocated: 3.040081024169922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 0.05372047424316406  GigaBytes
Max Memory Allocated: 3.0409960746765137  GigaBytes

torch.Size([16677, 500])
torch.Size([10140, 128])
torch.Size([4762, 128])
torch.Size([862, 128])
torch.Size([185, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 2.3180971145629883  GigaBytes
Max Memory Allocated: 3.0409960746765137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 0.05668354034423828  GigaBytes
Max Memory Allocated: 3.0409960746765137  GigaBytes

torch.Size([18080, 500])
torch.Size([14462, 128])
torch.Size([8566, 128])
torch.Size([2287, 128])
torch.Size([424, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 2.924560546875  GigaBytes
Max Memory Allocated: 3.0409960746765137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 0.0552668571472168  GigaBytes
Max Memory Allocated: 3.0409960746765137  GigaBytes

torch.Size([17452, 500])
torch.Size([11757, 128])
torch.Size([5469, 128])
torch.Size([966, 128])
torch.Size([155, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 2.542813301086426  GigaBytes
Max Memory Allocated: 3.0409960746765137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 0.05181550979614258  GigaBytes
Max Memory Allocated: 3.0409960746765137  GigaBytes

torch.Size([15601, 500])
torch.Size([8819, 128])
torch.Size([3463, 128])
torch.Size([466, 128])
torch.Size([100, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 2.0510168075561523  GigaBytes
Max Memory Allocated: 3.0409960746765137  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01775568723678589 |0.04455763101577759 |0.3962869942188263 |0.00015467405319213867 |0.4629579484462738 |0.012796878814697266 |
----------------------------------------------------------pseudo_mini_loss sum 1.985422968864441
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  316669
Number of first layer input nodes during this epoch:  141323
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 0.07560539245605469  GigaBytes
Max Memory Allocated: 3.0409960746765137  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.000720977783203125
random selection method range initialization spend 0.00015878677368164062
time for parepare:  7.414817810058594e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.5735626220703125e-05
----------------------check_connections_block total spend ----------------------------- 0.0018758773803710938
generate_one_block  0.0014595985412597656
generate_one_block  0.0011484622955322266
generate_one_block  0.0011060237884521484
generate_one_block  0.0011057853698730469
generate_one_block  0.0011162757873535156
generate_one_block  0.0011060237884521484
generate_one_block  0.0010762214660644531
generate_one_block  0.0010597705841064453
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006902217864990234
gen group dst list time:  5.91278076171875e-05
time for parepare:  0.0003535747528076172
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0002148151397705078
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00019073486328125
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.0001971721649169922
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00024700164794921875
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.00036263465881347656
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00012564659118652344
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00012922286987304688
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  5.7220458984375e-05
----------------------check_connections_block total spend ----------------------------- 0.004024505615234375
generate_one_block  0.0014603137969970703
generate_one_block  0.0013108253479003906
generate_one_block  0.0014030933380126953
generate_one_block  0.0015110969543457031
generate_one_block  0.001608133316040039
generate_one_block  0.0012416839599609375
generate_one_block  0.0012557506561279297
generate_one_block  0.0010898113250732422
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013127326965332031
gen group dst list time:  0.00011801719665527344
time for parepare:  0.0009832382202148438
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.0003502368927001953
mini_batch_src_global generation:  0.0001671314239501953
r_  generation:  0.0011818408966064453
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.00016641616821289062
r_  generation:  0.00083160400390625
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  0.00019288063049316406
r_  generation:  0.0015518665313720703
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  0.00018453598022460938
r_  generation:  0.0013370513916015625
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00023865699768066406
mini_batch_src_global generation:  0.0002894401550292969
r_  generation:  0.002500772476196289
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  0.00015592575073242188
r_  generation:  0.0007693767547607422
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00011229515075683594
r_  generation:  0.0008175373077392578
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.00022554397583007812
----------------------check_connections_block total spend ----------------------------- 0.01640486717224121
generate_one_block  0.002790689468383789
generate_one_block  0.0020508766174316406
generate_one_block  0.0031714439392089844
generate_one_block  0.002618551254272461
generate_one_block  0.004087924957275391
generate_one_block  0.0018854141235351562
generate_one_block  0.0020246505737304688
generate_one_block  0.0012502670288085938
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001867055892944336
gen group dst list time:  0.00036787986755371094
time for parepare:  0.0016045570373535156
local_output_nid generation:  0.0002307891845703125
local_in_edges_tensor generation:  0.0007281303405761719
mini_batch_src_global generation:  0.0008378028869628906
r_  generation:  0.006253242492675781
local_output_nid generation:  0.0001723766326904297
local_in_edges_tensor generation:  0.0003590583801269531
mini_batch_src_global generation:  0.00052642822265625
r_  generation:  0.004027605056762695
local_output_nid generation:  0.00033020973205566406
local_in_edges_tensor generation:  0.0005736351013183594
mini_batch_src_global generation:  0.0008866786956787109
r_  generation:  0.008228778839111328
local_output_nid generation:  0.00021576881408691406
local_in_edges_tensor generation:  0.00039887428283691406
mini_batch_src_global generation:  0.0006418228149414062
r_  generation:  0.005504131317138672
local_output_nid generation:  0.0002574920654296875
local_in_edges_tensor generation:  0.0004734992980957031
mini_batch_src_global generation:  0.0007214546203613281
r_  generation:  0.007242441177368164
local_output_nid generation:  0.0001423358917236328
local_in_edges_tensor generation:  0.0009741783142089844
mini_batch_src_global generation:  0.0005576610565185547
r_  generation:  0.004571437835693359
local_output_nid generation:  0.00012993812561035156
local_in_edges_tensor generation:  0.00030303001403808594
mini_batch_src_global generation:  0.00046634674072265625
r_  generation:  0.00412297248840332
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.0002627372741699219
r_  generation:  0.0015664100646972656
----------------------check_connections_block total spend ----------------------------- 0.06441688537597656
generate_one_block  0.010186195373535156
generate_one_block  0.006380558013916016
generate_one_block  0.01270914077758789
generate_one_block  0.008667230606079102
generate_one_block  0.010906219482421875
generate_one_block  0.007692575454711914
generate_one_block  0.00680232048034668
generate_one_block  0.003124713897705078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023956298828125
gen group dst list time:  0.0012507438659667969
time for parepare:  0.0019326210021972656
local_output_nid generation:  0.0010526180267333984
local_in_edges_tensor generation:  0.0019767284393310547
mini_batch_src_global generation:  0.0015566349029541016
r_  generation:  0.01729416847229004
local_output_nid generation:  0.0006611347198486328
local_in_edges_tensor generation:  0.0010194778442382812
mini_batch_src_global generation:  0.0015769004821777344
r_  generation:  0.013393640518188477
local_output_nid generation:  0.0010743141174316406
local_in_edges_tensor generation:  0.0014944076538085938
mini_batch_src_global generation:  0.0019099712371826172
r_  generation:  0.02024531364440918
local_output_nid generation:  0.0010411739349365234
local_in_edges_tensor generation:  0.0012390613555908203
mini_batch_src_global generation:  0.0015039443969726562
r_  generation:  0.016733646392822266
local_output_nid generation:  0.0009167194366455078
local_in_edges_tensor generation:  0.0011529922485351562
mini_batch_src_global generation:  0.0014491081237792969
r_  generation:  0.016911029815673828
local_output_nid generation:  0.0007843971252441406
local_in_edges_tensor generation:  0.0009920597076416016
mini_batch_src_global generation:  0.0013184547424316406
r_  generation:  0.015456438064575195
local_output_nid generation:  0.0006814002990722656
local_in_edges_tensor generation:  0.0009245872497558594
mini_batch_src_global generation:  0.0012404918670654297
r_  generation:  0.013870954513549805
local_output_nid generation:  0.0004239082336425781
local_in_edges_tensor generation:  0.0005538463592529297
mini_batch_src_global generation:  0.0008549690246582031
r_  generation:  0.007590055465698242
----------------------check_connections_block total spend ----------------------------- 0.17855548858642578
generate_one_block  0.02266669273376465
generate_one_block  0.019579648971557617
generate_one_block  0.027677536010742188
generate_one_block  0.02238631248474121
generate_one_block  0.023983001708984375
generate_one_block  0.020965576171875
generate_one_block  0.01937103271484375
generate_one_block  0.012223958969116211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019290447235107422
gen group dst list time:  0.002724170684814453
time for parepare:  0.0019121170043945312
local_output_nid generation:  0.0015711784362792969
local_in_edges_tensor generation:  0.0030922889709472656
mini_batch_src_global generation:  0.0023491382598876953
r_  generation:  0.024109840393066406
local_output_nid generation:  0.0014808177947998047
local_in_edges_tensor generation:  0.0023958683013916016
mini_batch_src_global generation:  0.0025408267974853516
r_  generation:  0.022545337677001953
local_output_nid generation:  0.0017888545989990234
local_in_edges_tensor generation:  0.0026311874389648438
mini_batch_src_global generation:  0.00208282470703125
r_  generation:  0.025823354721069336
local_output_nid generation:  0.001756429672241211
local_in_edges_tensor generation:  0.0024192333221435547
mini_batch_src_global generation:  0.002039194107055664
r_  generation:  0.024488210678100586
local_output_nid generation:  0.0016570091247558594
local_in_edges_tensor generation:  0.001913309097290039
mini_batch_src_global generation:  0.001935720443725586
r_  generation:  0.02384209632873535
local_output_nid generation:  0.001434326171875
local_in_edges_tensor generation:  0.0018444061279296875
mini_batch_src_global generation:  0.0019276142120361328
r_  generation:  0.022759437561035156
local_output_nid generation:  0.0012905597686767578
local_in_edges_tensor generation:  0.0017566680908203125
mini_batch_src_global generation: Using backend: pytorch
 0.001796722412109375
r_  generation:  0.021725177764892578
local_output_nid generation:  0.0009837150573730469
local_in_edges_tensor generation:  0.0015811920166015625
mini_batch_src_global generation:  0.0015892982482910156
r_  generation:  0.01843571662902832
----------------------check_connections_block total spend ----------------------------- 0.2709469795227051
generate_one_block  0.031228065490722656
generate_one_block  0.031067371368408203
generate_one_block  0.032683610916137695
generate_one_block  0.03232979774475098
generate_one_block  0.03037405014038086
generate_one_block  0.030223846435546875
generate_one_block  0.029168367385864258
generate_one_block  0.02503204345703125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 0.07560539245605469  GigaBytes
Max Memory Allocated: 3.0409960746765137  GigaBytes

connection checking time:  0.534348726272583
block generation total time  0.508190393447876
average batch blocks generation time:  0.0635237991809845
block dataloader generation time/epoch 1.208878755569458
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 0.08078956604003906  GigaBytes
Max Memory Allocated: 3.0409960746765137  GigaBytes

torch.Size([18631, 500])
torch.Size([14252, 128])
torch.Size([8904, 128])
torch.Size([1764, 128])
torch.Size([444, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 2.8868494033813477  GigaBytes
Max Memory Allocated: 3.0409960746765137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 0.07812261581420898  GigaBytes
Max Memory Allocated: 3.0409960746765137  GigaBytes

torch.Size([17534, 500])
torch.Size([12547, 128])
torch.Size([5264, 128])
torch.Size([1361, 128])
torch.Size([289, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 2.5874905586242676  GigaBytes
Max Memory Allocated: 3.0409960746765137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 0.08098888397216797  GigaBytes
Max Memory Allocated: 3.0409960746765137  GigaBytes

torch.Size([18706, 500])
torch.Size([16274, 128])
torch.Size([9702, 128])
torch.Size([2823, 128])
torch.Size([421, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7322998046875 GB
    Memory Allocated: 3.1684494018554688  GigaBytes
Max Memory Allocated: 3.1684823036193848  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7322998046875 GB
    Memory Allocated: 0.08048868179321289  GigaBytes
Max Memory Allocated: 3.16939640045166  GigaBytes

torch.Size([18724, 500])
torch.Size([14502, 128])
torch.Size([8410, 128])
torch.Size([2039, 128])
torch.Size([511, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7322998046875 GB
    Memory Allocated: 2.8769240379333496  GigaBytes
Max Memory Allocated: 3.16939640045166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7322998046875 GB
    Memory Allocated: 0.0789937973022461  GigaBytes
Max Memory Allocated: 3.16939640045166  GigaBytes

torch.Size([17864, 500])
torch.Size([13737, 128])
torch.Size([7487, 128])
torch.Size([2478, 128])
torch.Size([629, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7322998046875 GB
    Memory Allocated: 2.927046298980713  GigaBytes
Max Memory Allocated: 3.16939640045166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7322998046875 GB
    Memory Allocated: 0.07877349853515625  GigaBytes
Max Memory Allocated: 3.16939640045166  GigaBytes

torch.Size([17838, 500])
torch.Size([12782, 128])
torch.Size([6556, 128])
torch.Size([1281, 128])
torch.Size([227, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7322998046875 GB
    Memory Allocated: 2.710376739501953  GigaBytes
Max Memory Allocated: 3.16939640045166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7322998046875 GB
    Memory Allocated: 0.07714700698852539  GigaBytes
Max Memory Allocated: 3.16939640045166  GigaBytes

torch.Size([17001, 500])
torch.Size([11918, 128])
torch.Size([5384, 128])
torch.Size([1275, 128])
torch.Size([267, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7322998046875 GB
    Memory Allocated: 2.558002471923828  GigaBytes
Max Memory Allocated: 3.16939640045166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7322998046875 GB
    Memory Allocated: 0.07448387145996094  GigaBytes
Max Memory Allocated: 3.16939640045166  GigaBytes

torch.Size([15620, 500])
torch.Size([8390, 128])
torch.Size([3032, 128])
torch.Size([406, 128])
torch.Size([83, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7322998046875 GB
    Memory Allocated: 2.031768798828125  GigaBytes
Max Memory Allocated: 3.16939640045166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01847216486930847 |0.003856062889099121 |0.32880347967147827 |0.00014922022819519043 |0.4624737799167633 |0.011841773986816406 |
----------------------------------------------------------pseudo_mini_loss sum 1.8963664770126343
Total (block generation + training)time/epoch 7.75829553604126
Training time/epoch 6.5491392612457275
Training time without block to device /epoch 6.518290758132935
Training time without total dataloading part /epoch 6.3432536125183105
load block tensor time/epoch 0.14777731895446777
block to device time/epoch 0.03084850311279297
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  317714
Number of first layer input nodes during this epoch:  141918
