main start at this time 1648534063.3295224
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.002407073974609375
random selection method range initialization spend 0.00032067298889160156
time for parepare:  4.506111145019531e-05
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.003580808639526367
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.1682510375976562e-05
----------------------check_connections_block total spend ----------------------------- 0.006338834762573242
generate_one_block  0.0013670921325683594
generate_one_block  0.0010361671447753906
generate_one_block  0.001039743423461914
generate_one_block  0.0009932518005371094
generate_one_block  0.001004934310913086
generate_one_block  0.001001596450805664
generate_one_block  0.0009927749633789062
generate_one_block  0.0009927749633789062
generate_one_block  0.0009434223175048828
generate_one_block  0.0009448528289794922
generate_one_block  0.0009982585906982422
generate_one_block  0.0009446144104003906
generate_one_block  0.0009789466857910156
generate_one_block  0.0009417533874511719
generate_one_block  0.0009388923645019531
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012364387512207031
gen group dst list time:  7.891654968261719e-05
time for parepare:  0.0002789497375488281
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00011277198791503906
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00017642974853515625
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00011873245239257812
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00010204315185546875
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00017976760864257812
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.000202178955078125
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  9.632110595703125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.628036499023438e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  4.57763671875e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00011897087097167969
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.57763671875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  4.38690185546875e-05
----------------------check_connections_block total spend ----------------------------- 0.004597663879394531
generate_one_block  0.0010993480682373047
generate_one_block  0.0012500286102294922
generate_one_block  0.0012154579162597656
generate_one_block  0.001127004623413086
generate_one_block  0.0012314319610595703
generate_one_block  0.0012557506561279297
generate_one_block  0.0011148452758789062
generate_one_block  0.0010619163513183594
generate_one_block  0.0010340213775634766
generate_one_block  0.0010640621185302734
generate_one_block  0.0012021064758300781
generate_one_block  0.0010607242584228516
generate_one_block  0.0010170936584472656
generate_one_block  0.0009870529174804688
generate_one_block  0.0009844303131103516
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001232147216796875
gen group dst list time:  0.00012087821960449219
time for parepare:  0.0007510185241699219
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00024056434631347656
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0003390312194824219
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.0008358955383300781
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0007696151733398438
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0005598068237304688
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.00014138221740722656
r_  generation:  0.0013382434844970703
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  0.00018739700317382812
r_  generation:  0.0014941692352294922
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.0008826255798339844
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0003578662872314453
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0002079010009765625
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002644062042236328
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0008606910705566406
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0003666877746582031
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002071857452392578
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.0002925395965576172
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00023984909057617188
----------------------check_connections_block total spend ----------------------------- 0.01621389389038086
generate_one_block  0.0015249252319335938
generate_one_block  0.001943349838256836
generate_one_block  0.0018177032470703125
generate_one_block  0.0016036033630371094
generate_one_block  0.002589702606201172
generate_one_block  0.0027658939361572266
generate_one_block  0.002089977264404297
generate_one_block  0.0013120174407958984
generate_one_block  0.0016162395477294922
generate_one_block  0.0013034343719482422
generate_one_block  0.0020170211791992188
generate_one_block  0.00136566162109375
generate_one_block  0.0011577606201171875
generate_one_block  0.0012934207916259766
generate_one_block  0.0012257099151611328
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021715164184570312
gen group dst list time:  0.00031113624572753906
time for parepare:  0.0016469955444335938
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.0004756450653076172
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.0013599395751953125
local_output_nid generation:  0.00011539459228515625
local_in_edges_tensor generation:  0.00034689903259277344
mini_batch_src_global generation:  0.00041961669921875
r_  generation:  0.003618955612182617
local_output_nid generation:  0.00011610984802246094
local_in_edges_tensor generation:  0.00033164024353027344
mini_batch_src_global generation:  0.0005085468292236328
r_  generation:  0.004220247268676758
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.00025153160095214844
mini_batch_src_global generation:  0.0003154277801513672
r_  generation:  0.0027778148651123047
local_output_nid generation:  0.00016117095947265625
local_in_edges_tensor generation:  0.0004086494445800781
mini_batch_src_global generation:  0.0004897117614746094
r_  generation:  0.005458831787109375
local_output_nid generation:  0.00013017654418945312
local_in_edges_tensor generation:  0.000347137451171875
mini_batch_src_global generation:  0.0006628036499023438
r_  generation:  0.00562739372253418
local_output_nid generation:  0.0001659393310546875
local_in_edges_tensor generation:  0.0003666877746582031
mini_batch_src_global generation:  0.0005452632904052734
r_  generation:  0.005387544631958008
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.0002894401550292969
r_  generation:  0.0019023418426513672
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  0.0001773834228515625
r_  generation:  0.0013055801391601562
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  0.00020623207092285156
r_  generation:  0.002012491226196289
local_output_nid generation:  0.00013256072998046875
local_in_edges_tensor generation:  0.00032830238342285156
mini_batch_src_global generation:  0.0004923343658447266
r_  generation:  0.005309104919433594
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  0.0003178119659423828
r_  generation:  0.0022301673889160156
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  0.00017762184143066406
r_  generation:  0.001397848129272461
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.000255584716796875
r_  generation:  0.0025947093963623047
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  0.00024628639221191406
r_  generation:  0.0018968582153320312
----------------------check_connections_block total spend ----------------------------- 0.07179093360900879
generate_one_block  0.0031020641326904297
generate_one_block  0.0056416988372802734
generate_one_block  0.007040500640869141
generate_one_block  0.004431486129760742
generate_one_block  0.008056402206420898
generate_one_block  0.008579492568969727
generate_one_block  0.008058309555053711
generate_one_block  0.003505706787109375
generate_one_block  0.002671957015991211
generate_one_block  0.003598928451538086
generate_one_block  0.007951736450195312
generate_one_block  0.004003286361694336
generate_one_block  0.0027282238006591797
generate_one_block  0.004410743713378906
generate_one_block  0.003416776657104492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002327442169189453
gen group dst list time:  0.0016083717346191406
time for parepare:  0.0017962455749511719
local_output_nid generation:  0.00023484230041503906
local_in_edges_tensor generation:  0.0009753704071044922
mini_batch_src_global generation:  0.0007340908050537109
r_  generation:  0.005914926528930664
local_output_nid generation:  0.0004870891571044922
local_in_edges_tensor generation:  0.0008981227874755859
mini_batch_src_global generation:  0.0011508464813232422
r_  generation:  0.011139869689941406
local_output_nid generation:  0.0006365776062011719
local_in_edges_tensor generation:  0.0015444755554199219
mini_batch_src_global generation:  0.0011105537414550781
r_  generation:  0.012856006622314453
local_output_nid generation:  0.0004467964172363281
local_in_edges_tensor generation:  0.0007469654083251953
mini_batch_src_global generation:  0.0009353160858154297
r_  generation:  0.010771512985229492
local_output_nid generation:  0.00058746337890625
local_in_edges_tensor generation:  0.0008876323699951172
mini_batch_src_global generation:  0.0010437965393066406
r_  generation:  0.012804031372070312
local_output_nid generation:  0.0005724430084228516
local_in_edges_tensor generation:  0.0008935928344726562
mini_batch_src_global generation:  0.0011899471282958984
r_  generation:  0.013663291931152344
local_output_nid generation:  0.0006742477416992188
local_in_edges_tensor generation:  0.0009491443634033203
mini_batch_src_global generation:  0.0015692710876464844
r_  generation:  0.01611495018005371
local_output_nid generation:  0.00035881996154785156
local_in_edges_tensor generation:  0.0005526542663574219
mini_batch_src_global generation:  0.0009992122650146484
r_  generation:  0.008777856826782227
local_output_nid generation:  0.0002627372741699219
local_in_edges_tensor generation:  0.0004794597625732422
mini_batch_src_global generation:  0.0006854534149169922
r_  generation:  0.006572723388671875
local_output_nid generation:  0.00026345252990722656
local_in_edges_tensor generation:  0.00045990943908691406
mini_batch_src_global generation:  0.0007169246673583984
r_  generation:  0.0075337886810302734
local_output_nid generation:  0.000530242919921875
local_in_edges_tensor generation:  0.0009732246398925781
mini_batch_src_global generation:  0.0011837482452392578
r_  generation:  0.01520538330078125
local_output_nid generation:  0.0004208087921142578
local_in_edges_tensor generation:  0.002404928207397461
mini_batch_src_global generation:  0.001008749008178711
r_  generation:  0.009128332138061523
local_output_nid generation:  0.00021958351135253906
local_in_edges_tensor generation:  0.00041985511779785156
mini_batch_src_global generation:  0.0006933212280273438
r_  generation:  0.006471157073974609
local_output_nid generation:  0.00034618377685546875
local_in_edges_tensor generation:  0.0006062984466552734
mini_batch_src_global generation:  0.0009741783142089844
r_  generation:  0.010154485702514648
local_output_nid generation:  0.00032258033752441406
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0009317398071289062
r_  generation:  0.008615255355834961
----------------------check_connections_block total spend ----------------------------- 0.22982144355773926
generate_one_block  0.009351491928100586
generate_one_block  0.014265060424804688
generate_one_block  0.01700592041015625
generate_one_block  0.014718770980834961
generate_one_block  0.01764225959777832
generate_one_block  0.01780843734741211
generate_one_block  0.022397279739379883
generate_one_block  0.013297557830810547
generate_one_block  0.010180234909057617
generate_one_block  0.010688066482543945
generate_one_block  0.01958775520324707
generate_one_block  0.013139963150024414
generate_one_block  0.010607719421386719
generate_one_block  0.0136566162109375
generate_one_block  0.012398004531860352
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019838809967041016
gen group dst list time:  0.004405498504638672
time for parepare:  0.0017290115356445312
local_output_nid generation:  0.0007758140563964844
local_in_edges_tensor generation:  0.001775979995727539
mini_batch_src_global generation:  0.0015494823455810547
r_  generation:  0.01632070541381836
local_output_nid generation:  0.0010912418365478516
local_in_edges_tensor generation:  0.002232074737548828
mini_batch_src_global generation:  0.0021872520446777344
r_  generation:  0.020445585250854492
local_output_nid generation:  0.0012123584747314453
local_in_edges_tensor generation:  0.0019490718841552734
mini_batch_src_global generation:  0.002017974853515625
r_  generation:  0.021384477615356445
local_output_nid generation:  0.001157999038696289
local_in_edges_tensor generation:  0.001802682876586914
mini_batch_src_global generation:  0.0018210411071777344
r_  generation:  0.02086806297302246
local_output_nid generation:  0.0011663436889648438
local_in_edges_tensor generation:  0.0016372203826904297
mini_batch_src_global generation:  0.0018832683563232422
r_  generation:  0.02090907096862793
local_output_nid generation:  0.00109100341796875
local_in_edges_tensor generation:  0.001619577407836914
mini_batch_src_global generation:  0.0017712116241455078
r_  generation:  0.020725727081298828
local_output_nid generation:  0.001371145248413086
local_in_edges_tensor generation:  0.0023195743560791016
mini_batch_src_global generation:  0.0022499561309814453
r_  generation:  0.02337503433227539
local_output_nid generation:  0.0009908676147460938
local_in_edges_tensor generation:  0.0015764236450195312
mini_batch_src_global generation:  0.001692056655883789
r_  generation:  0.01974201202392578
local_output_nid generation:  0.0007650852203369141
local_in_edges_tensor generation:  0.0011296272277832031
mini_batch_src_global generation:  0.0015363693237304688
r_  generation:  0.016733646392822266
local_output_nid generation:  0.0007309913635253906
local_in_edges_tensor generation:  0.0010378360748291016
mini_batch_src_global generation:  0.0013124942779541016
r_  generation:  0.015876054763793945
local_output_nid generation:  0.0011641979217529297
local_in_edges_tensor generation:  0.0018723011016845703
mini_batch_src_global generation:  0.0018658638000488281
r_  generation:  0.022006750106811523
local_output_nid generation:  0.0009908676147460938
local_in_edges_tensor generation:  0.0016665458679199219
mini_batch_src_global generation:  0.0017156600952148438
r_  generation:  0.01981329917907715
local_output_nid generation:  0.0007548332214355469
local_in_edges_tensor generation:  0.0011355876922607422
mini_batch_src_global generation:  0.0014717578887939453
r_  generation:  0.015474319458007812
local_output_nid generation:  0.0009589195251464844
local_in_edges_tensor generation:  0.001226186752319336
mini_batch_src_global generation:  0.001447916030883789
r_  generation:  0.018724441528320312
local_output_nid generation:  0.0008847713470458984
local_in_edges_tensor generation:  0.0013942718505859375
mini_batch_src_global generation:  0.0016453266143798828
r_  generation:  0.01823568344116211
----------------------check_connections_block total spend ----------------------------- 0.4216134548187256
generate_one_block  0.02152252197265625
generate_one_block  0.026682138442993164
generate_one_block  0.02737593650817871
generate_one_block  0.029040098190307617
generate_one_block  0.026552200317382812
generate_one_block  0.026024818420410156
generate_one_block  0.03005242347717285
generate_one_block  0.025325775146484375
generate_one_block  0.022383689880371094
generate_one_block  0.020989656448364258
generate_one_block  0.03190779685974121
generate_one_block  0.026475191116333008
generate_one_block  0.020343542098999023
generate_one_block  0.024474620819091797
generate_one_block  0.024277448654174805
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

connection checking time:  0.744037389755249
block generation total time  0.7197020053863525
average batch blocks generation time:  0.0479801336924235
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1346435546875 GB
    Memory Allocated: 0.03948068618774414  GigaBytes
Max Memory Allocated: 0.03948068618774414  GigaBytes

torch.Size([15017, 500])
torch.Size([7690, 128])
torch.Size([2293, 128])
torch.Size([481, 128])
torch.Size([132, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 1.8348727226257324  GigaBytes
Max Memory Allocated: 1.8348894119262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.055013179779052734  GigaBytes
Max Memory Allocated: 1.83624267578125  GigaBytes

torch.Size([17369, 500])
torch.Size([12073, 128])
torch.Size([5403, 128])
torch.Size([1528, 128])
torch.Size([317, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7166748046875 GB
    Memory Allocated: 2.357328414916992  GigaBytes
Max Memory Allocated: 2.3573760986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7186279296875 GB
    Memory Allocated: 0.05637216567993164  GigaBytes
Max Memory Allocated: 2.3582663536071777  GigaBytes

torch.Size([18050, 500])
torch.Size([12377, 128])
torch.Size([7237, 128])
torch.Size([1292, 128])
torch.Size([305, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9178466796875 GB
    Memory Allocated: 2.5382652282714844  GigaBytes
Max Memory Allocated: 2.5382866859436035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9178466796875 GB
    Memory Allocated: 0.05501604080200195  GigaBytes
Max Memory Allocated: 2.5392227172851562  GigaBytes

torch.Size([17095, 500])
torch.Size([11398, 128])
torch.Size([4467, 128])
torch.Size([936, 128])
torch.Size([203, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9178466796875 GB
    Memory Allocated: 2.4067025184631348  GigaBytes
Max Memory Allocated: 2.5392227172851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9178466796875 GB
    Memory Allocated: 0.05461263656616211  GigaBytes
Max Memory Allocated: 2.5392227172851562  GigaBytes

torch.Size([17068, 500])
torch.Size([11476, 128])
torch.Size([5901, 128])
torch.Size([1726, 128])
torch.Size([375, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0135498046875 GB
    Memory Allocated: 2.556281566619873  GigaBytes
Max Memory Allocated: 2.556324005126953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0155029296875 GB
    Memory Allocated: 0.05461454391479492  GigaBytes
Max Memory Allocated: 2.557234764099121  GigaBytes

torch.Size([17049, 500])
torch.Size([11453, 128])
torch.Size([6435, 128])
torch.Size([1646, 128])
torch.Size([379, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0408935546875 GB
    Memory Allocated: 2.603346824645996  GigaBytes
Max Memory Allocated: 2.6034321784973145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0428466796875 GB
    Memory Allocated: 0.0561375617980957  GigaBytes
Max Memory Allocated: 2.6042985916137695  GigaBytes

torch.Size([17787, 500])
torch.Size([14506, 128])
torch.Size([6985, 128])
torch.Size([1884, 128])
torch.Size([229, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2108154296875 GB
    Memory Allocated: 2.8383126258850098  GigaBytes
Max Memory Allocated: 2.8383312225341797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 0.05318021774291992  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

torch.Size([16429, 500])
torch.Size([10512, 128])
torch.Size([3447, 128])
torch.Size([656, 128])
torch.Size([123, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 2.238694190979004  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 0.05173635482788086  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

torch.Size([15251, 500])
torch.Size([7523, 128])
torch.Size([2640, 128])
torch.Size([362, 128])
torch.Size([102, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 1.8970246315002441  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 0.04906320571899414  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

torch.Size([14277, 500])
torch.Size([7697, 128])
torch.Size([2930, 128])
torch.Size([511, 128])
torch.Size([83, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 1.8578824996948242  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 0.05463457107543945  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

torch.Size([17048, 500])
torch.Size([13135, 128])
torch.Size([6645, 128])
torch.Size([1766, 128])
torch.Size([271, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 2.698800563812256  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 0.05422258377075195  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

torch.Size([16985, 500])
torch.Size([10138, 128])
torch.Size([4514, 128])
torch.Size([632, 128])
torch.Size([152, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 2.2384700775146484  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 0.048113346099853516  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

torch.Size([13804, 500])
torch.Size([7268, 128])
torch.Size([2385, 128])
torch.Size([388, 128])
torch.Size([70, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 1.742279052734375  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 0.05256080627441406  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

torch.Size([16080, 500])
torch.Size([9445, 128])
torch.Size([4121, 128])
torch.Size([626, 128])
torch.Size([85, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 2.214935779571533  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 0.05247974395751953  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

torch.Size([16076, 500])
torch.Size([9067, 128])
torch.Size([3642, 128])
torch.Size([483, 128])
torch.Size([99, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 2.1047868728637695  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017112064361572265 |0.024955224990844727 |0.3306699752807617 |0.00015125274658203124 |0.42268877029418944 |0.012194156646728516 |
----------------------------------------------------------pseudo_mini_loss sum 1.6053448915481567
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  488387
Number of first layer input nodes during this epoch:  245385
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 0.07539176940917969  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007612705230712891
random selection method range initialization spend 0.0001609325408935547
time for parepare:  7.62939453125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  5.6743621826171875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.0030236244201660156
generate_one_block  0.0014469623565673828
generate_one_block  0.0011394023895263672
generate_one_block  0.001104593276977539
generate_one_block  0.0010612010955810547
generate_one_block  0.0010662078857421875
generate_one_block  0.001069784164428711
generate_one_block  0.0010685920715332031
generate_one_block  0.0010783672332763672
generate_one_block  0.0010690689086914062
generate_one_block  0.0010669231414794922
generate_one_block  0.0010581016540527344
generate_one_block  0.0011067390441894531
generate_one_block  0.0009708404541015625
generate_one_block  0.0009837150573730469
generate_one_block  0.000972747802734375
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007750988006591797
gen group dst list time:  9.202957153320312e-05
time for parepare:  0.00037479400634765625
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00014162063598632812
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  8.726119995117188e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001614093780517578
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00011157989501953125
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00010275840759277344
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.000156402587890625
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00020241737365722656
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00019025802612304688
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  6.246566772460938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  6.771087646484375e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.482269287109375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00010418891906738281
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.626678466796875e-05
----------------------check_connections_block total spend ----------------------------- 0.005377769470214844
generate_one_block  0.001374959945678711
generate_one_block  0.0011627674102783203
generate_one_block  0.0012614727020263672
generate_one_block  0.0011000633239746094
generate_one_block  0.0012366771697998047
generate_one_block  0.0011987686157226562
generate_one_block  0.0011889934539794922
generate_one_block  0.0012423992156982422
generate_one_block  0.0018475055694580078
generate_one_block  0.0012180805206298828
generate_one_block  0.00103759765625
generate_one_block  0.001070261001586914
generate_one_block  0.0010306835174560547
generate_one_block  0.0011019706726074219
generate_one_block  0.0010154247283935547
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0014753341674804688
gen group dst list time:  0.000152587890625
time for parepare:  0.001043081283569336
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.00029730796813964844
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0007708072662353516
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.0004303455352783203
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.0006434917449951172
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0002396106719970703
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  0.0001125335693359375
r_  generation:  0.0010037422180175781
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  0.00012230873107910156
r_  generation:  0.0006711483001708984
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0005285739898681641
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.0008671283721923828
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  0.0001881122589111328
r_  generation:  0.0015168190002441406
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.0015110969543457031
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.0003986358642578125
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.00040340423583984375
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00019311904907226562
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0006744861602783203
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0002434253692626953
----------------------check_connections_block total spend ----------------------------- 0.018975257873535156
generate_one_block  0.002378225326538086
generate_one_block  0.0015606880187988281
generate_one_block  0.0018527507781982422
generate_one_block  0.0012292861938476562
generate_one_block  0.0024318695068359375
generate_one_block  0.0019683837890625
generate_one_block  0.0015840530395507812
generate_one_block  0.0020427703857421875
generate_one_block  0.002955198287963867
generate_one_block  0.002714395523071289
generate_one_block  0.0014526844024658203
generate_one_block  0.0014421939849853516
generate_one_block  0.001172780990600586
generate_one_block  0.0018558502197265625
generate_one_block  0.0012340545654296875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020918846130371094
gen group dst list time:  0.0004322528839111328
time for parepare:  0.001744985580444336
local_output_nid generation:  0.00016498565673828125
local_in_edges_tensor generation:  0.0006487369537353516
mini_batch_src_global generation:  0.0005838871002197266
r_  generation:  0.004449605941772461
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.000278472900390625
mini_batch_src_global generation:  0.0004017353057861328
r_  generation:  0.0029265880584716797
local_output_nid generation:  0.00012564659118652344
local_in_edges_tensor generation:  0.00032138824462890625
mini_batch_src_global generation:  0.0002834796905517578
r_  generation:  0.0026154518127441406
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.00020003318786621094
r_  generation:  0.0014770030975341797
local_output_nid generation:  0.00023293495178222656
local_in_edges_tensor generation:  0.0004661083221435547
mini_batch_src_global generation:  0.0005159378051757812
r_  generation:  0.0060231685638427734
local_output_nid generation:  0.00014472007751464844
local_in_edges_tensor generation:  0.0003566741943359375
mini_batch_src_global generation:  0.0005211830139160156
r_  generation:  0.004343986511230469
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.0002639293670654297
mini_batch_src_global generation:  0.0003345012664794922
r_  generation:  0.002648591995239258
local_output_nid generation:  0.00015425682067871094
local_in_edges_tensor generation:  0.0003437995910644531
mini_batch_src_global generation:  0.00034737586975097656
r_  generation:  0.003644704818725586
local_output_nid generation:  0.0002219676971435547
local_in_edges_tensor generation:  0.0004277229309082031
mini_batch_src_global generation:  0.0005664825439453125
r_  generation:  0.006059885025024414
local_output_nid generation:  0.00014472007751464844
local_in_edges_tensor generation:  0.0003426074981689453
mini_batch_src_global generation:  0.0005850791931152344
r_  generation:  0.005007743835449219
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.0002551078796386719
mini_batch_src_global generation:  0.0003743171691894531
r_  generation:  0.0027709007263183594
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.0002675056457519531
mini_batch_src_global generation:  0.0002827644348144531
r_  generation:  0.0023026466369628906
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  0.0001761913299560547
r_  generation:  0.001168966293334961
local_output_nid generation:  0.00011563301086425781
local_in_edges_tensor generation:  0.000301361083984375
mini_batch_src_global generation:  0.00031495094299316406
r_  generation:  0.003425121307373047
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  0.00022912025451660156
r_  generation:  0.0015804767608642578
----------------------check_connections_block total spend ----------------------------- 0.07837605476379395
generate_one_block  0.008320331573486328
generate_one_block  0.005149126052856445
generate_one_block  0.004212856292724609
generate_one_block  0.0033342838287353516
generate_one_block  0.009769439697265625
generate_one_block  0.007035255432128906
generate_one_block  0.00501251220703125
generate_one_block  0.0059757232666015625
generate_one_block  0.009361028671264648
generate_one_block  0.007914543151855469
generate_one_block  0.00502467155456543
generate_one_block  0.0043468475341796875
generate_one_block  0.0025832653045654297
generate_one_block  0.005845785140991211
generate_one_block  0.0031499862670898438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020856857299804688
gen group dst list time:  0.00188446044921875
time for parepare:  0.001979351043701172
local_output_nid generation:  0.0010154247283935547
local_in_edges_tensor generation:  0.0016086101531982422
mini_batch_src_global generation:  0.0012807846069335938
r_  generation:  0.013113975524902344
local_output_nid generation:  0.0005495548248291016
local_in_edges_tensor generation:  0.000835418701171875
mini_batch_src_global generation:  0.0011930465698242188
r_  generation:  0.009282588958740234
local_output_nid generation:  0.0004477500915527344
local_in_edges_tensor generation:  0.0007236003875732422
mini_batch_src_global generation:  0.0007262229919433594
r_  generation:  0.007340908050537109
local_output_nid generation:  0.00029277801513671875
local_in_edges_tensor generation:  0.0005092620849609375
mini_batch_src_global generation:  0.0007128715515136719
r_  generation:  0.006624460220336914
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0011868476867675781
mini_batch_src_global generation:  0.001653909683227539
r_  generation:  0.018079519271850586
local_output_nid generation:  0.000759124755859375
local_in_edges_tensor generation:  0.0010726451873779297
mini_batch_src_global generation:  0.0013530254364013672
r_  generation:  0.0148468017578125
local_output_nid generation:  0.0006871223449707031
local_in_edges_tensor generation:  0.0008275508880615234
mini_batch_src_global generation:  0.0010957717895507812
r_  generation:  0.01086282730102539
local_output_nid generation:  0.0006883144378662109
local_in_edges_tensor generation:  0.0009272098541259766
mini_batch_src_global generation:  0.0008528232574462891
r_  generation:  0.012068510055541992
local_output_nid generation:  0.0007834434509277344
local_in_edges_tensor generation:  0.0010344982147216797
mini_batch_src_global generation:  0.0013544559478759766
r_  generation:  0.015417814254760742
local_output_nid generation:  0.0005486011505126953
local_in_edges_tensor generation:  0.0007569789886474609
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.011685371398925781
local_output_nid generation:  0.0005311965942382812
local_in_edges_tensor generation:  0.0007295608520507812
mini_batch_src_global generation:  0.0008378028869628906
r_  generation:  0.01031041145324707
local_output_nid generation:  0.0005445480346679688
local_in_edges_tensor generation:  0.0007388591766357422
mini_batch_src_global generation:  0.0008690357208251953
r_  generation:  0.011067628860473633
local_output_nid generation:  0.0002551078796386719
local_in_edges_tensor generation:  0.0004975795745849609
mini_batch_src_global generation:  0.0007660388946533203
r_  generation:  0.0060427188873291016
local_output_nid generation:  0.0005464553833007812
local_in_edges_tensor generation:  0.0007207393646240234
mini_batch_src_global generation:  0.0010113716125488281
r_  generation:  0.011722803115844727
local_output_nid generation:  0.0003979206085205078
local_in_edges_tensor generation:  0.0006048679351806641
mini_batch_src_global generation:  0.0008640289306640625
r_  generation:  0.007723093032836914
----------------------check_connections_block total spend ----------------------------- 0.24499821662902832
generate_one_block  0.019266366958618164
generate_one_block  0.015413999557495117
generate_one_block  0.012004613876342773
generate_one_block  0.010523557662963867
generate_one_block  0.023878097534179688
generate_one_block  0.020682096481323242
generate_one_block  0.015070676803588867
generate_one_block  0.016492843627929688
generate_one_block  0.021073102951049805
generate_one_block  0.016068220138549805
generate_one_block  0.01465749740600586
generate_one_block  0.015862464904785156
generate_one_block  0.010238885879516602
generate_one_block  0.016124486923217773
generate_one_block  0.012260913848876953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017344951629638672
gen group dst list time:  0.004782438278198242
time for parepare:  0.001911163330078125
local_output_nid generation:  0.0015006065368652344
local_in_edges_tensor generation:  0.002361774444580078
mini_batch_src_global generation:  0.002036571502685547
r_  generation:  0.021714210510253906
local_output_nid generation:  0.0011067390441894531
local_in_edges_tensor generation:  0.0020411014556884766
mini_batch_src_global generation:  0.002287149429321289
r_  generation:  0.01941370964050293
local_output_nid generation:  0.0012717247009277344
local_in_edges_tensor generation:  0.0016756057739257812
mini_batch_src_global generation:  0.0015306472778320312
r_  generation:  0.0185396671295166
local_output_nid generation:  0.0009210109710693359
local_in_edges_tensor generation:  0.00119781494140625
mini_batch_src_global generation:  0.001346588134765625
r_  generation:  0.015717744827270508
local_output_nid generation:  0.0017294883728027344
local_in_edges_tensor generation:  0.0026106834411621094
mini_batch_src_global generation:  0.0019805431365966797
r_  generation:  0.02499246597290039
local_output_nid generation:  0.0015141963958740234
local_in_edges_tensor generation:  0.002318859100341797
mini_batch_src_global generation:  0.001981019973754883
r_  generation:  0.022705793380737305
local_output_nid generation:  0.0013208389282226562
local_in_edges_tensor generation:  0.0016608238220214844
mini_batch_src_global generation:  0.0017957687377929688
r_  generation:  0.020995140075683594
local_output_nid generation:  0.0013713836669921875
local_in_edges_tensor generation:  0.001711130142211914
mini_batch_src_global generation:  0.0018088817596435547
r_  generation:  0.02177739143371582
local_output_nid generation:  0.0013957023620605469
local_in_edges_tensor generation:  0.002140522003173828
mini_batch_src_global generation:  0.0019588470458984375
r_  generation:  0.022896289825439453
local_output_nid generation:  0.0010569095611572266
local_in_edges_tensor generation:  0.0014071464538574219
mini_batch_src_global generation:  0.001634836196899414
r_  generation:  0.01889657974243164
local_output_nid generation:  0.0010039806365966797
local_in_edges_tensor generation:  0.0013380050659179688
mini_batch_src_global generation:  0.001567840576171875
r_  generation:  0.018970251083374023
local_output_nid generation:  0.001270294189453125
local_in_edges_tensor generation:  0.0016317367553710938
mini_batch_src_global generation:  0.0017600059509277344
r_  generation:  0.020908117294311523
local_output_nid generation:  0.0008385181427001953
local_in_edges_tensor generation:  0.0011448860168457031
mini_batch_src_global generation:  0.0014486312866210938
r_  generation:  0.015461206436157227
local_output_nid generation:  0.0012273788452148438
local_in_edges_tensor generation:  0.0015110969543457031
mini_batch_src_global generation:  0.0014519691467285156
r_  generation:  0.01945781707763672
local_output_nid generation:  0.0009675025939941406
local_in_edges_tensor generation:  0.0013041496276855469
mini_batch_src_global generation:  0.0015766620635986328
r_  generation:  0.01827239990234375
----------------------check_connections_block total spend ----------------------------- 0.4389076232910156
generate_one_block  0.029526710510253906
generate_one_block  0.027045726776123047
generate_one_block  0.024292469024658203
generate_one_block  0.021157503128051758
generate_one_block  0.03257131576538086
generate_one_block  0.03025197982788086
generate_one_block  0.028708219528198242
generate_one_block  0.02850627899169922
generate_one_block  0.03074789047241211
generate_one_block  0.03260087966918945
generate_one_block  0.026622772216796875
generate_one_block  0.0329282283782959
generate_one_block  0.023247241973876953
generate_one_block  0.026793479919433594
generate_one_block  0.025730371475219727
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 0.07539176940917969  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

connection checking time:  0.7866349220275879
block generation total time  0.7933473587036133
average batch blocks generation time:  0.05288982391357422
block dataloader generation time/epoch 1.8626723289489746
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 0.07800054550170898  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

torch.Size([17972, 500])
torch.Size([11996, 128])
torch.Size([6986, 128])
torch.Size([1229, 128])
torch.Size([300, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 2.5117616653442383  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 0.07480096817016602  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

torch.Size([16330, 500])
torch.Size([9651, 128])
torch.Size([4529, 128])
torch.Size([670, 128])
torch.Size([148, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 2.209630012512207  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 0.07420969009399414  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

torch.Size([16066, 500])
torch.Size([9885, 128])
torch.Size([3467, 128])
torch.Size([1020, 128])
torch.Size([215, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 1.9977922439575195  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 0.0687112808227539  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

torch.Size([13155, 500])
torch.Size([7038, 128])
torch.Size([2275, 128])
torch.Size([347, 128])
torch.Size([74, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 1.765052318572998  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2127685546875 GB
    Memory Allocated: 0.07891368865966797  GigaBytes
Max Memory Allocated: 2.8392715454101562  GigaBytes

torch.Size([18317, 500])
torch.Size([15417, 128])
torch.Size([7729, 128])
torch.Size([2010, 128])
torch.Size([248, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 2.974991798400879  GigaBytes
Max Memory Allocated: 2.975008964538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.07781267166137695  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

torch.Size([17401, 500])
torch.Size([12499, 128])
torch.Size([6005, 128])
torch.Size([1276, 128])
torch.Size([176, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 2.633425712585449  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.07721853256225586  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

torch.Size([17604, 500])
torch.Size([10917, 128])
torch.Size([5185, 128])
torch.Size([766, 128])
torch.Size([213, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 2.3734278678894043  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.07769250869750977  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

torch.Size([17752, 500])
torch.Size([12075, 128])
torch.Size([5545, 128])
torch.Size([1427, 128])
torch.Size([307, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 2.467533588409424  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.07703971862792969  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

torch.Size([17357, 500])
torch.Size([13068, 128])
torch.Size([6435, 128])
torch.Size([1966, 128])
torch.Size([358, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 2.7613797187805176  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.0738072395324707  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

torch.Size([15659, 500])
torch.Size([9215, 128])
torch.Size([4850, 128])
torch.Size([1380, 128])
torch.Size([320, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 2.2915921211242676  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.07400941848754883  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

torch.Size([15901, 500])
torch.Size([8833, 128])
torch.Size([4081, 128])
torch.Size([646, 128])
torch.Size([115, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 2.1783790588378906  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.0757293701171875  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

torch.Size([16802, 500])
torch.Size([10913, 128])
torch.Size([4161, 128])
torch.Size([717, 128])
torch.Size([114, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 2.3661231994628906  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.06929969787597656  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

torch.Size([13494, 500])
torch.Size([6825, 128])
torch.Size([1943, 128])
torch.Size([301, 128])
torch.Size([70, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 1.6990833282470703  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.07382583618164062  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

torch.Size([15764, 500])
torch.Size([10150, 128])
torch.Size([4505, 128])
torch.Size([1060, 128])
torch.Size([199, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 2.3041229248046875  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.0735783576965332  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

torch.Size([15613, 500])
torch.Size([8336, 128])
torch.Size([3058, 128])
torch.Size([409, 128])
torch.Size([83, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 2.027900218963623  GigaBytes
Max Memory Allocated: 2.9759507179260254  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012059513727823894 |0.0034708658854166667 |0.30134973526000974 |0.00015268325805664062 |0.41824544270833336 |0.013330698013305664 |
----------------------------------------------------------pseudo_mini_loss sum 1.7302894592285156
Total (block generation + training)time/epoch 12.957459926605225
Training time/epoch 11.094515562057495
Training time without block to device /epoch 11.042452573776245
Training time without total dataloading part /epoch 10.809548616409302
load block tensor time/epoch 0.1808927059173584
block to device time/epoch 0.05206298828125
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  491280
Number of first layer input nodes during this epoch:  245187
