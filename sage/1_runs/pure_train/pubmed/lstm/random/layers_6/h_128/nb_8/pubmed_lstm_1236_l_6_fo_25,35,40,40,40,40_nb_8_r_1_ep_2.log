main start at this time 1648534020.4102366
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001993417739868164
random selection method range initialization spend 0.00017380714416503906
time for parepare:  4.3392181396484375e-05
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.001149892807006836
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  4.887580871582031e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2411346435546875e-05
----------------------check_connections_block total spend ----------------------------- 0.0021343231201171875
generate_one_block  0.0011670589447021484
generate_one_block  0.0010123252868652344
generate_one_block  0.0009918212890625
generate_one_block  0.0009543895721435547
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0010137557983398438
gen group dst list time:  3.314018249511719e-05
time for parepare:  0.00022721290588378906
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004367828369140625
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0005183219909667969
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00024056434631347656
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00011777877807617188
----------------------check_connections_block total spend ----------------------------- 0.0027551651000976562
generate_one_block  0.0014674663543701172
generate_one_block  0.001615285873413086
generate_one_block  0.001245737075805664
generate_one_block  0.0010819435119628906
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010499954223632812
gen group dst list time:  6.914138793945312e-05
time for parepare:  0.0007412433624267578
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00031948089599609375
mini_batch_src_global generation:  0.00016236305236816406
r_  generation:  0.0020101070404052734
local_output_nid generation:  9.202957153320312e-05
local_in_edges_tensor generation:  0.0002720355987548828
mini_batch_src_global generation:  0.0004425048828125
r_  generation:  0.0033049583435058594
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  0.00019311904907226562
r_  generation:  0.0015676021575927734
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  0.00010466575622558594
r_  generation:  0.0007915496826171875
----------------------check_connections_block total spend ----------------------------- 0.012593507766723633
generate_one_block  0.0034973621368408203
generate_one_block  0.005341291427612305
generate_one_block  0.0030448436737060547
generate_one_block  0.0018336772918701172
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019969940185546875
gen group dst list time:  0.00020599365234375
time for parepare:  0.0013990402221679688
local_output_nid generation:  0.00022840499877929688
local_in_edges_tensor generation:  0.0008764266967773438
mini_batch_src_global generation:  0.0009288787841796875
r_  generation:  0.007777214050292969
local_output_nid generation:  0.00032782554626464844
local_in_edges_tensor generation:  0.0007314682006835938
mini_batch_src_global generation:  0.0012698173522949219
r_  generation:  0.011126041412353516
local_output_nid generation:  0.00020885467529296875
local_in_edges_tensor generation:  0.0004754066467285156
mini_batch_src_global generation:  0.0008335113525390625
r_  generation:  0.008155107498168945
local_output_nid generation:  0.00012803077697753906
local_in_edges_tensor generation:  0.00031065940856933594
mini_batch_src_global generation:  0.0005545616149902344
r_  generation:  0.004942417144775391
----------------------check_connections_block total spend ----------------------------- 0.04803013801574707
generate_one_block  0.012053489685058594
generate_one_block  0.015215635299682617
generate_one_block  0.012071847915649414
generate_one_block  0.007921695709228516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018281936645507812
gen group dst list time:  0.00075531005859375
time for parepare:  0.0016624927520751953
local_output_nid generation:  0.0009222030639648438
local_in_edges_tensor generation:  0.0020720958709716797
mini_batch_src_global generation:  0.0017638206481933594
r_  generation:  0.01871204376220703
local_output_nid generation:  0.0009860992431640625
local_in_edges_tensor generation:  0.0020198822021484375
mini_batch_src_global generation:  0.0023462772369384766
r_  generation:  0.020244598388671875
local_output_nid generation:  0.0008189678192138672
local_in_edges_tensor generation:  0.0014951229095458984
mini_batch_src_global generation:  0.0015935897827148438
r_  generation:  0.018037796020507812
local_output_nid generation:  0.0006344318389892578
local_in_edges_tensor generation:  0.0010612010955810547
mini_batch_src_global generation:  0.0012960433959960938
r_  generation:  0.01458120346069336
----------------------check_connections_block total spend ----------------------------- 0.10661435127258301
generate_one_block  0.024091243743896484
generate_one_block  0.027960777282714844
generate_one_block  0.024016141891479492
generate_one_block  0.019667387008666992
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00189971923828125
gen group dst list time:  0.0013885498046875
time for parepare:  0.0016779899597167969
local_output_nid generation:  0.0013394355773925781
local_in_edges_tensor generation:  0.0026400089263916016
mini_batch_src_global generation:  0.0021085739135742188
r_  generation:  0.024076223373413086
local_output_nid generation:  0.0014119148254394531
local_in_edges_tensor generation:  0.0025429725646972656
mini_batch_src_global generation:  0.002807140350341797
r_  generation:  0.024825572967529297
local_output_nid generation:  0.0014023780822753906
local_in_edges_tensor generation:  0.0019872188568115234
mini_batch_src_global generation:  0.001985788345336914
r_  generation:  0.023764371871948242
local_output_nid generation:  0.0012378692626953125
local_in_edges_tensor generation:  0.0020897388458251953
mini_batch_src_global generation:  0.0016984939575195312
r_  generation:  0.022229909896850586
----------------------check_connections_block total spend ----------------------------- 0.1396317481994629
generate_one_block  0.02964472770690918
generate_one_block  0.03130078315734863
generate_one_block  0.02970409393310547
generate_one_block  0.028658628463745117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

connection checking time:  0.30962491035461426
block generation total time  0.2814340591430664
average batch blocks generation time:  0.0703585147857666
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1424560546875 GB
    Memory Allocated: 0.04768991470336914  GigaBytes
Max Memory Allocated: 0.04768991470336914  GigaBytes

torch.Size([19047, 500])
torch.Size([16221, 128])
torch.Size([10976, 128])
torch.Size([3216, 128])
torch.Size([839, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4041748046875 GB
    Memory Allocated: 3.142282485961914  GigaBytes
Max Memory Allocated: 3.142359733581543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4393310546875 GB
    Memory Allocated: 0.05911064147949219  GigaBytes
Max Memory Allocated: 3.1431946754455566  GigaBytes

torch.Size([18925, 500])
torch.Size([16980, 128])
torch.Size([11476, 128])
torch.Size([4344, 128])
torch.Size([1063, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.3864784240722656  GigaBytes
Max Memory Allocated: 3.38655424118042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.05795764923095703  GigaBytes
Max Memory Allocated: 3.387390613555908  GigaBytes

torch.Size([18420, 500])
torch.Size([15335, 128])
torch.Size([9739, 128])
torch.Size([2792, 128])
torch.Size([603, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.075974941253662  GigaBytes
Max Memory Allocated: 3.387390613555908  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.057088375091552734  GigaBytes
Max Memory Allocated: 3.387390613555908  GigaBytes

torch.Size([18064, 500])
torch.Size([13562, 128])
torch.Size([7243, 128])
torch.Size([1467, 128])
torch.Size([289, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7877345085144043  GigaBytes
Max Memory Allocated: 3.387390613555908  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021474003791809082 |0.0863911509513855 |0.502159833908081 |0.0001563429832458496 |0.48782503604888916 |0.012549638748168945 |
----------------------------------------------------------pseudo_mini_loss sum 1.6635172367095947
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  190957
Number of first layer input nodes during this epoch:  74456
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.08124446868896484  GigaBytes
Max Memory Allocated: 3.387390613555908  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005354881286621094
random selection method range initialization spend 0.0001304149627685547
time for parepare:  6.246566772460938e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  5.745887756347656e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.649162292480469e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.123283386230469e-05
----------------------check_connections_block total spend ----------------------------- 0.0011031627655029297
generate_one_block  0.0016052722930908203
generate_one_block  0.0011141300201416016
generate_one_block  0.0010821819305419922
generate_one_block  0.001215219497680664
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005719661712646484
gen group dst list time:  3.314018249511719e-05
time for parepare:  0.0003120899200439453
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0003528594970703125
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0003075599670410156
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.0005152225494384766
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00021719932556152344
----------------------check_connections_block total spend ----------------------------- 0.003148317337036133
generate_one_block  0.0016009807586669922
generate_one_block  0.001468658447265625
generate_one_block  0.0017962455749511719
generate_one_block  0.0013051033020019531
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010445117950439453
gen group dst list time:  9.012222290039062e-05
time for parepare:  0.0008776187896728516
local_output_nid generation:  8.821487426757812e-05
local_in_edges_tensor generation:  0.0003998279571533203
mini_batch_src_global generation:  0.00022530555725097656
r_  generation:  0.0018053054809570312
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  0.00028443336486816406
r_  generation:  0.0020356178283691406
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.0002675056457519531
mini_batch_src_global generation:  0.00035953521728515625
r_  generation:  0.003301858901977539
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.0001876354217529297
r_  generation:  0.0012362003326416016
----------------------check_connections_block total spend ----------------------------- 0.014029741287231445
generate_one_block  0.003882884979248047
generate_one_block  0.003952503204345703
generate_one_block  0.005429267883300781
generate_one_block  0.002627849578857422
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020508766174316406
gen group dst list time:  0.00023627281188964844
time for parepare:  0.0013599395751953125
local_output_nid generation:  0.00029730796813964844
local_in_edges_tensor generation:  0.0010111331939697266
mini_batch_src_global generation:  0.0009789466857910156
r_  generation:  0.008489370346069336
local_output_nid generation:  0.0003380775451660156
local_in_edges_tensor generation:  0.0006847381591796875
mini_batch_src_global generation:  0.0011067390441894531
r_  generation:  0.010559320449829102
local_output_nid generation:  0.0003428459167480469
local_in_edges_tensor generation:  0.0006399154663085938
mini_batch_src_global generation:  0.0009379386901855469
r_  generation:  0.011089324951171875
local_output_nid generation: Using backend: pytorch
 0.0002167224884033203
local_in_edges_tensor generation:  0.00041866302490234375
mini_batch_src_global generation:  0.000728607177734375
r_  generation:  0.006204366683959961
----------------------check_connections_block total spend ----------------------------- 0.05436897277832031
generate_one_block  0.01295328140258789
generate_one_block  0.014981508255004883
generate_one_block  0.016196012496948242
generate_one_block  0.010730743408203125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001813650131225586
gen group dst list time:  0.0007579326629638672
time for parepare:  0.001554250717163086
local_output_nid generation:  0.0010552406311035156
local_in_edges_tensor generation:  0.002435445785522461
mini_batch_src_global generation:  0.0019431114196777344
r_  generation:  0.01977682113647461
local_output_nid generation:  0.0010311603546142578
local_in_edges_tensor generation:  0.002235889434814453
mini_batch_src_global generation:  0.002522706985473633
r_  generation:  0.021135807037353516
local_output_nid generation:  0.0010352134704589844
local_in_edges_tensor generation:  0.0018537044525146484
mini_batch_src_global generation:  0.0018703937530517578
r_  generation:  0.0208280086517334
local_output_nid generation:  0.0008361339569091797
local_in_edges_tensor generation:  0.0011954307556152344
mini_batch_src_global generation:  0.0014979839324951172
r_  generation:  0.017530202865600586
----------------------check_connections_block total spend ----------------------------- 0.11802458763122559
generate_one_block  0.027318954467773438
generate_one_block  0.029811382293701172
generate_one_block  0.02818465232849121
generate_one_block  0.023828983306884766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021440982818603516
gen group dst list time:  0.0014562606811523438
time for parepare:  0.0017108917236328125
local_output_nid generation:  0.001636505126953125
local_in_edges_tensor generation:  0.0029485225677490234
mini_batch_src_global generation:  0.0021486282348632812
r_  generation:  0.024787425994873047
local_output_nid generation:  0.00162506103515625
local_in_edges_tensor generation:  0.002586841583251953
mini_batch_src_global generation:  0.002584695816040039
r_  generation:  0.025447845458984375
local_output_nid generation:  0.0018084049224853516
local_in_edges_tensor generation:  0.002614259719848633
mini_batch_src_global generation:  0.0020689964294433594
r_  generation:  0.025211811065673828
local_output_nid generation:  0.0015621185302734375
local_in_edges_tensor generation:  0.001979351043701172
mini_batch_src_global generation:  0.001953601837158203
r_  generation:  0.02383899688720703
----------------------check_connections_block total spend ----------------------------- 0.14752626419067383
generate_one_block  0.03299880027770996
generate_one_block  0.033888816833496094
generate_one_block  0.03280282020568848
generate_one_block  0.03192424774169922
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.08124446868896484  GigaBytes
Max Memory Allocated: 3.387390613555908  GigaBytes

connection checking time:  0.3370978832244873
block generation total time  0.31768369674682617
average batch blocks generation time:  0.07942092418670654
block dataloader generation time/epoch 0.7517213821411133
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.08153152465820312  GigaBytes
Max Memory Allocated: 3.387390613555908  GigaBytes

torch.Size([19070, 500])
torch.Size([16324, 128])
torch.Size([11061, 128])
torch.Size([2892, 128])
torch.Size([723, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.191392421722412  GigaBytes
Max Memory Allocated: 3.387390613555908  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.08158159255981445  GigaBytes
Max Memory Allocated: 3.387390613555908  GigaBytes

torch.Size([19035, 500])
torch.Size([17059, 128])
torch.Size([11652, 128])
torch.Size([3616, 128])
torch.Size([698, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.3332695960998535  GigaBytes
Max Memory Allocated: 3.387390613555908  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.08142280578613281  GigaBytes
Max Memory Allocated: 3.387390613555908  GigaBytes

torch.Size([18935, 500])
torch.Size([16557, 128])
torch.Size([11136, 128])
torch.Size([3816, 128])
torch.Size([981, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.3389816284179688  GigaBytes
Max Memory Allocated: 3.387390613555908  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.08038473129272461  GigaBytes
Max Memory Allocated: 3.387390613555908  GigaBytes

torch.Size([18524, 500])
torch.Size([14837, 128])
torch.Size([8126, 128])
torch.Size([2052, 128])
torch.Size([439, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.977735996246338  GigaBytes
Max Memory Allocated: 3.387390613555908  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021579086780548096 |0.0026973485946655273 |0.36274611949920654 |0.00018298625946044922 |0.49637269973754883 |0.012188196182250977 |
----------------------------------------------------------pseudo_mini_loss sum 1.7029768228530884
Total (block generation + training)time/epoch 4.3147571086883545
Training time/epoch 3.562779426574707
Training time without block to device /epoch 3.551990032196045
Training time without total dataloading part /epoch 3.4493954181671143
load block tensor time/epoch 0.08631634712219238
block to device time/epoch 0.01078939437866211
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  197890
Number of first layer input nodes during this epoch:  75564
