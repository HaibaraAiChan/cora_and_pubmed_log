main start at this time 1648534005.7457378
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005335807800292969
random selection method range initialization spend 0.0001647472381591797
time for parepare:  4.553794860839844e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0009064674377441406
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  4.38690185546875e-05
----------------------check_connections_block total spend ----------------------------- 0.0015292167663574219
generate_one_block  0.0012259483337402344
generate_one_block  0.0010378360748291016
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005278587341308594
gen group dst list time:  2.5033950805664062e-05
time for parepare:  0.0002346038818359375
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.0008823871612548828
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.000362396240234375
----------------------check_connections_block total spend ----------------------------- 0.0024161338806152344
generate_one_block  0.002170562744140625
generate_one_block  0.0014493465423583984
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011022090911865234
gen group dst list time:  5.9604644775390625e-05
time for parepare:  0.0007352828979492188
local_output_nid generation:  0.0001239776611328125
local_in_edges_tensor generation:  0.0006022453308105469
mini_batch_src_global generation:  0.0004138946533203125
r_  generation:  0.005292654037475586
local_output_nid generation:  6.604194641113281e-05
local_in_edges_tensor generation:  0.0002372264862060547
mini_batch_src_global generation:  0.00034165382385253906
r_  generation:  0.0023386478424072266
----------------------check_connections_block total spend ----------------------------- 0.012265682220458984
generate_one_block  0.007560253143310547
generate_one_block  0.0038971900939941406
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001798868179321289
gen group dst list time:  0.0001811981201171875
time for parepare:  0.001283407211303711
local_output_nid generation:  0.0004444122314453125
local_in_edges_tensor generation:  0.001302957534790039
mini_batch_src_global generation:  0.0015344619750976562
r_  generation:  0.015427112579345703
local_output_nid generation:  0.00028204917907714844
local_in_edges_tensor generation:  0.0006339550018310547
mini_batch_src_global generation:  0.0012538433074951172
r_  generation:  0.010818719863891602
----------------------check_connections_block total spend ----------------------------- 0.0396573543548584
generate_one_block  0.024851083755493164
generate_one_block  0.015170097351074219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.004389762878417969
gen group dst list time:  0.0004913806915283203
time for parepare:  0.0018310546875
local_output_nid generation:  0.001092672348022461
local_in_edges_tensor generation:  0.003844738006591797
mini_batch_src_global generation:  0.0022542476654052734
r_  generation:  0.024062156677246094
local_output_nid generation:  0.0009396076202392578
local_in_edges_tensor generation:  0.002016782760620117
mini_batch_src_global generation:  0.0023975372314453125
r_  generation:  0.02131199836730957
----------------------check_connections_block total spend ----------------------------- 0.07034635543823242
generate_one_block  0.029657840728759766
generate_one_block  0.027591943740844727
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022649765014648438
gen group dst list time:  0.0007479190826416016
time for parepare:  0.0015797615051269531
local_output_nid generation:  0.0014007091522216797
local_in_edges_tensor generation:  0.0026464462280273438
mini_batch_src_global generation:  0.0020949840545654297
r_  generation:  0.026172637939453125
local_output_nid generation:  0.0013339519500732422
local_in_edges_tensor generation:  0.0022537708282470703
mini_batch_src_global generation:  0.002550840377807617
r_  generation:  0.025038480758666992
----------------------check_connections_block total spend ----------------------------- 0.07636713981628418
generate_one_block  0.03192591667175293
generate_one_block  0.03078746795654297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

connection checking time:  0.20105266571044922
block generation total time  0.17506170272827148
average batch blocks generation time:  0.08753085136413574
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1424560546875 GB
    Memory Allocated: 0.048711299896240234  GigaBytes
Max Memory Allocated: 0.048711299896240234  GigaBytes

torch.Size([19365, 500])
torch.Size([18255, 128])
torch.Size([14910, 128])
torch.Size([6484, 128])
torch.Size([1836, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8905029296875 GB
    Memory Allocated: 3.6692423820495605  GigaBytes
Max Memory Allocated: 3.669388771057129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0408935546875 GB
    Memory Allocated: 0.05907297134399414  GigaBytes
Max Memory Allocated: 3.670097827911377  GigaBytes

torch.Size([18940, 500])
torch.Size([16690, 128])
torch.Size([11816, 128])
torch.Size([3676, 128])
torch.Size([874, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0408935546875 GB
    Memory Allocated: 3.311418056488037  GigaBytes
Max Memory Allocated: 3.670097827911377  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02416551113128662 |0.17423474788665771 |0.6761690378189087 |0.00018155574798583984 |0.5463923215866089 |0.012005805969238281 |
----------------------------------------------------------pseudo_mini_loss sum 1.8951165676116943
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  113201
Number of first layer input nodes during this epoch:  38305
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 5.0408935546875 GB
    Memory Allocated: 0.0839700698852539  GigaBytes
Max Memory Allocated: 3.670097827911377  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005509853363037109
random selection method range initialization spend 0.00012874603271484375
time for parepare:  5.555152893066406e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00011968612670898438
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  7.128715515136719e-05
----------------------check_connections_block total spend ----------------------------- 0.0008258819580078125
generate_one_block  0.0012214183807373047
generate_one_block  0.001146078109741211
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005662441253662109
gen group dst list time:  2.86102294921875e-05
time for parepare:  0.0002779960632324219
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0006124973297119141
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.000690460205078125
----------------------check_connections_block total spend ----------------------------- 0.002510547637939453
generate_one_block  0.0020117759704589844
generate_one_block  0.002071380615234375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001041412353515625
gen group dst list time:  7.772445678710938e-05
time for parepare:  0.0007331371307373047
local_output_nid generation:  0.00015091896057128906
local_in_edges_tensor generation:  0.00041484832763671875
mini_batch_src_global generation:  0.0003352165222167969
r_  generation:  0.0036911964416503906
local_output_nid generation:  0.000133514404296875
local_in_edges_tensor generation:  0.0003192424774169922
mini_batch_src_global generation:  0.0004987716674804688
r_  generation:  0.004341840744018555
----------------------check_connections_block total spend ----------------------------- 0.01275491714477539
generate_one_block  0.006963253021240234
generate_one_block  0.006717205047607422
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021779537200927734
gen group dst list time:  0.0002014636993408203
time for parepare:  0.001359701156616211
local_output_nid generation:  0.00042819976806640625
local_in_edges_tensor generation:  0.0011699199676513672
mini_batch_src_global generation:  0.0011997222900390625
r_  generation:  0.014058589935302734
local_output_nid generation:  0.0004150867462158203
local_in_edges_tensor generation:  0.0008146762847900391
mini_batch_src_global generation:  0.0014967918395996094
r_  generation:  0.013223886489868164
----------------------check_connections_block total spend ----------------------------- 0.0411069393157959
generate_one_block  0.022799968719482422
generate_one_block  0.019998550415039062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018544197082519531
gen group dst list time:  0.0005044937133789062
time for parepare:  0.0014834403991699219
local_output_nid generation:  0.0011706352233886719
local_in_edges_tensor generation:  0.002284526824951172
mini_batch_src_global generation:  0.0019521713256835938
r_  generation:  0.024597644805908203
local_output_nid generation:  0.0010869503021240234
local_in_edges_tensor generation:  0.002281665802001953
mini_batch_src_global generation:  0.0026178359985351562
r_  generation:  0.022716045379638672
----------------------check_connections_block total spend ----------------------------- 0.07089805603027344
generate_one_block  0.034334659576416016
generate_one_block  0.03134727478027344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021598339080810547
gen group dst list time:  0.0008330345153808594
time for parepare:  0.0017061233520507812
local_output_nid generation:  0.0015082359313964844
local_in_edges_tensor generation:  0.00289154052734375
mini_batch_src_global generation:  0.0019884109497070312
r_  generation:  0.026566743850708008
local_output_nid generation:  0.0016558170318603516
local_in_edges_tensor generation:  0.0036439895629882812
mini_batch_src_global generation:  0.0025887489318847656
r_  generation:  0.0263364315032959
----------------------check_connections_block total spend ----------------------------- 0.08050894737243652
generate_one_block  0.034954071044921875
generate_one_block  0.03513002395629883
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.0408935546875 GB
    Memory Allocated: 0.0839700698852539  GigaBytes
Max Memory Allocated: 3.670097827911377  GigaBytes

connection checking time:  0.2077794075012207
block generation total time  0.19632816314697266
average batch blocks generation time:  0.09816408157348633
block dataloader generation time/epoch 0.46747803688049316
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0408935546875 GB
    Memory Allocated: 0.08241939544677734  GigaBytes
Max Memory Allocated: 3.670097827911377  GigaBytes

torch.Size([19383, 500])
torch.Size([18289, 128])
torch.Size([14475, 128])
torch.Size([5502, 128])
torch.Size([1384, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2225341796875 GB
    Memory Allocated: 3.5973315238952637  GigaBytes
Max Memory Allocated: 3.670097827911377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2225341796875 GB
    Memory Allocated: 0.08205747604370117  GigaBytes
Max Memory Allocated: 3.670097827911377  GigaBytes

torch.Size([19206, 500])
torch.Size([17442, 128])
torch.Size([12795, 128])
torch.Size([5045, 128])
torch.Size([1380, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2225341796875 GB
    Memory Allocated: 3.525259017944336  GigaBytes
Max Memory Allocated: 3.670097827911377  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02049839496612549 |0.0029009580612182617 |0.3858534097671509 |0.00015938282012939453 |0.5682231187820435 |0.012058496475219727 |
----------------------------------------------------------pseudo_mini_loss sum 1.4712566137313843
Total (block generation + training)time/epoch 2.444474220275879
Training time/epoch 1.9765403270721436
Training time without block to device /epoch 1.970738410949707
Training time without total dataloading part /epoch 1.9205303192138672
load block tensor time/epoch 0.04099678993225098
block to device time/epoch 0.0058019161224365234
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  115257
Number of first layer input nodes during this epoch:  38589
