main start at this time 1648533958.8584917
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008460521697998047  GigaBytes
Max Memory Allocated: 0.008460521697998047  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0015785694122314453
random selection method range initialization spend 0.0001926422119140625
time for parepare:  4.553794860839844e-05
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.001180410385131836
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.1920928955078125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.4543533325195312e-05
----------------------check_connections_block total spend ----------------------------- 0.003924369812011719
generate_one_block  0.0011835098266601562
generate_one_block  0.001020669937133789
generate_one_block  0.0010950565338134766
generate_one_block  0.0010383129119873047
generate_one_block  0.0010409355163574219
generate_one_block  0.0010378360748291016
generate_one_block  0.0010480880737304688
generate_one_block  0.0009918212890625
generate_one_block  0.0010063648223876953
generate_one_block  0.0009768009185791016
generate_one_block  0.0009739398956298828
generate_one_block  0.0009398460388183594
generate_one_block  0.0009312629699707031
generate_one_block  0.000986337661743164
generate_one_block  0.0009496212005615234
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009686946868896484
gen group dst list time:  8.320808410644531e-05
time for parepare:  0.00029277801513671875
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00010275840759277344
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  6.651878356933594e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.440017700195312e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  8.20159912109375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00014543533325195312
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00024509429931640625
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00020265579223632812
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.723403930664062e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.6743621826171875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  0.0001068115234375
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  7.82012939453125e-05
----------------------check_connections_block total spend ----------------------------- 0.004677534103393555
generate_one_block  0.0011830329895019531
generate_one_block  0.001157999038696289
generate_one_block  0.0011448860168457031
generate_one_block  0.0011305809020996094
generate_one_block  0.0011827945709228516
generate_one_block  0.0010890960693359375
generate_one_block  0.0013897418975830078
generate_one_block  0.0010254383087158203
generate_one_block  0.0012090206146240234
generate_one_block  0.0010535717010498047
generate_one_block  0.0009925365447998047
generate_one_block  0.0010745525360107422
generate_one_block  0.0010423660278320312
generate_one_block  0.0009758472442626953
generate_one_block  0.0010280609130859375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011019706726074219
gen group dst list time:  0.00012540817260742188
time for parepare:  0.0007941722869873047
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0002570152282714844
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.00036072731018066406
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004565715789794922
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  9.274482727050781e-05
r_  generation:  0.0006210803985595703
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0003719329833984375
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0007803440093994141
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003032684326171875
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  0.00019359588623046875
r_  generation:  0.001840353012084961
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.00014925003051757812
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  0.00013756752014160156
r_  generation:  0.0015463829040527344
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0004966259002685547
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.00036406517028808594
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  7.390975952148438e-05
r_  generation:  0.0006937980651855469
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.00043702125549316406
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002162456512451172
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.0006921291351318359
----------------------check_connections_block total spend ----------------------------- 0.016684770584106445
generate_one_block  0.0015697479248046875
generate_one_block  0.0014650821685791016
generate_one_block  0.0017037391662597656
generate_one_block  0.0013146400451660156
generate_one_block  0.0018045902252197266
generate_one_block  0.0012676715850830078
generate_one_block  0.003175020217895508
generate_one_block  0.001056671142578125
generate_one_block  0.0031125545501708984
generate_one_block  0.001497030258178711
generate_one_block  0.0013566017150878906
generate_one_block  0.0017178058624267578
generate_one_block  0.0014417171478271484
generate_one_block  0.001184225082397461
generate_one_block  0.0017185211181640625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021266937255859375
gen group dst list time:  0.0003101825714111328
time for parepare:  0.0016641616821289062
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.0004565715789794922
mini_batch_src_global generation:  0.00014448165893554688
r_  generation:  0.0010745525360107422
local_output_nid generation:  8.702278137207031e-05
local_in_edges_tensor generation:  0.0002872943878173828
mini_batch_src_global generation:  0.0003440380096435547
r_  generation:  0.0027980804443359375
local_output_nid generation:  0.00012826919555664062
local_in_edges_tensor generation:  0.0003371238708496094
mini_batch_src_global generation:  0.0004220008850097656
r_  generation:  0.0038805007934570312
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.0018093585968017578
local_output_nid generation:  0.00011134147644042969
local_in_edges_tensor generation:  0.00032711029052734375
mini_batch_src_global generation:  0.00042128562927246094
r_  generation:  0.004191398620605469
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  0.0002205371856689453
r_  generation:  0.0015773773193359375
local_output_nid generation:  0.00021076202392578125
local_in_edges_tensor generation:  0.0005052089691162109
mini_batch_src_global generation:  0.0006437301635742188
r_  generation:  0.007401466369628906
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  0.0002307891845703125
r_  generation:  0.0006225109100341797
local_output_nid generation:  0.0001494884490966797
local_in_edges_tensor generation:  0.000354766845703125
mini_batch_src_global generation:  0.0004737377166748047
r_  generation:  0.005411386489868164
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  0.0004119873046875
r_  generation:  0.0034461021423339844
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  0.0003082752227783203
r_  generation:  0.0027379989624023438
local_output_nid generation:  0.00010991096496582031
local_in_edges_tensor generation:  0.00028061866760253906
mini_batch_src_global generation:  0.0003914833068847656
r_  generation:  0.004225730895996094
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  0.0002951622009277344
r_  generation:  0.002315998077392578
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  0.0001735687255859375
r_  generation:  0.0013494491577148438
local_output_nid generation:  0.00010204315185546875
local_in_edges_tensor generation:  0.0002734661102294922
mini_batch_src_global generation:  0.00034737586975097656
r_  generation:  0.003987789154052734
----------------------check_connections_block total spend ----------------------------- 0.07133245468139648
generate_one_block  0.0035898685455322266
generate_one_block  0.004402637481689453
generate_one_block  0.005986690521240234
generate_one_block  0.003179788589477539
generate_one_block  0.006455898284912109
generate_one_block  0.0028738975524902344
generate_one_block  0.011395931243896484
generate_one_block  0.0016951560974121094
generate_one_block  0.008089780807495117
generate_one_block  0.005468130111694336
generate_one_block  0.004641056060791016
generate_one_block  0.006699085235595703
generate_one_block  0.004155635833740234
generate_one_block  0.0026848316192626953
generate_one_block  0.007048130035400391
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002285003662109375
gen group dst list time:  0.0015926361083984375
time for parepare:  0.0018229484558105469
local_output_nid generation:  0.000156402587890625
local_in_edges_tensor generation:  0.0007727146148681641
mini_batch_src_global generation:  0.0004067420959472656
r_  generation:  0.0031654834747314453
local_output_nid generation:  0.0004086494445800781
local_in_edges_tensor generation:  0.0008642673492431641
mini_batch_src_global generation:  0.0011563301086425781
r_  generation:  0.010927677154541016
local_output_nid generation:  0.0005414485931396484
local_in_edges_tensor generation:  0.0013124942779541016
mini_batch_src_global generation:  0.0012326240539550781
r_  generation:  0.012535333633422852
local_output_nid generation:  0.0002875328063964844
local_in_edges_tensor generation:  0.0005285739898681641
mini_batch_src_global generation:  0.0007252693176269531
r_  generation:  0.005945444107055664
local_output_nid generation:  0.0006220340728759766
local_in_edges_tensor generation:  0.0009477138519287109
mini_batch_src_global generation:  0.0010602474212646484
r_  generation:  0.01293039321899414
local_output_nid generation:  0.00029158592224121094
local_in_edges_tensor generation:  0.000537872314453125
mini_batch_src_global generation:  0.0007755756378173828
r_  generation:  0.006704807281494141
local_output_nid generation:  0.000743865966796875
local_in_edges_tensor generation:  0.0013937950134277344
mini_batch_src_global generation:  0.001718282699584961
r_  generation:  0.017983675003051758
local_output_nid generation:  0.00012564659118652344
local_in_edges_tensor generation:  0.00027751922607421875
mini_batch_src_global generation:  0.0005350112915039062
r_  generation:  0.002847433090209961
local_output_nid generation:  0.0005559921264648438
local_in_edges_tensor generation:  0.0008394718170166016
mini_batch_src_global generation:  0.0009424686431884766
r_  generation:  0.01239156723022461
local_output_nid generation:  0.0004680156707763672
local_in_edges_tensor generation:  0.0007112026214599609
mini_batch_src_global generation:  0.0011301040649414062
r_  generation:  0.01076960563659668
local_output_nid generation:  0.0004742145538330078
local_in_edges_tensor generation:  0.0007956027984619141
mini_batch_src_global generation:  0.0008692741394042969
r_  generation:  0.011092424392700195
local_output_nid generation:  0.0006186962127685547
local_in_edges_tensor generation:  0.0028076171875
mini_batch_src_global generation:  0.0015597343444824219
r_  generation:  0.014840841293334961
local_output_nid generation:  0.00043892860412597656
local_in_edges_tensor generation:  0.0007164478302001953
mini_batch_src_global generation:  0.0009377002716064453
r_  generation:  0.0090484619140625
local_output_nid generation:  0.00028634071350097656
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.0006806850433349609
r_  generation:  0.006354808807373047
local_output_nid generation:  0.00047278404235839844
local_in_edges_tensor generation:  0.0008237361907958984
mini_batch_src_global generation:  0.0011615753173828125
r_  generation:  0.013671159744262695
----------------------check_connections_block total spend ----------------------------- 0.22451543807983398
generate_one_block  0.0063283443450927734
generate_one_block  0.014235496520996094
generate_one_block  0.0174863338470459
generate_one_block  0.009107828140258789
generate_one_block  0.015906572341918945
generate_one_block  0.010634183883666992
generate_one_block  0.02357172966003418
generate_one_block  0.0046651363372802734
generate_one_block  0.016619443893432617
generate_one_block  0.015293598175048828
generate_one_block  0.015351295471191406
generate_one_block  0.020397663116455078
generate_one_block  0.013960599899291992
generate_one_block  0.00960087776184082
generate_one_block  0.017098188400268555
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021381378173828125
gen group dst list time:  0.0042269229888916016
time for parepare:  0.0017962455749511719
local_output_nid generation:  0.0004744529724121094
local_in_edges_tensor generation:  0.0013856887817382812
mini_batch_src_global generation:  0.0011086463928222656
r_  generation:  0.01028752326965332
local_output_nid generation:  0.0011491775512695312
local_in_edges_tensor generation:  0.001953601837158203
mini_batch_src_global generation:  0.0023539066314697266
r_  generation:  0.020165681838989258
local_output_nid generation:  0.0012598037719726562
local_in_edges_tensor generation:  0.001949310302734375
mini_batch_src_global generation:  0.0020825862884521484
r_  generation:  0.022441625595092773
local_output_nid generation:  0.0008003711700439453
local_in_edges_tensor generation:  0.0010178089141845703
mini_batch_src_global generation:  0.0013797283172607422
r_  generation:  0.014765262603759766
local_output_nid generation:  0.0012540817260742188
local_in_edges_tensor generation:  0.0016460418701171875
mini_batch_src_global generation:  0.0018303394317626953
r_  generation:  0.021520376205444336
local_output_nid generation:  0.0008258819580078125
local_in_edges_tensor generation:  0.001222372055053711
mini_batch_src_global generation:  0.0015630722045898438
r_  generation:  0.01773858070373535
local_output_nid generation:  0.0013780593872070312
local_in_edges_tensor generation:  0.00235748291015625
mini_batch_src_global generation:  0.0021784305572509766
r_  generation:  0.024295568466186523
local_output_nid generation:  0.00040841102600097656
local_in_edges_tensor generation:  0.0006492137908935547
mini_batch_src_global generation:  0.001081228256225586
r_  generation:  0.008724212646484375
local_output_nid generation:  0.0010519027709960938
local_in_edges_tensor generation:  0.0013282299041748047
mini_batch_src_global generation:  0.0014226436614990234
r_  generation:  0.019585132598876953
local_output_nid generation:  0.0009570121765136719
local_in_edges_tensor generation:  0.0018186569213867188
mini_batch_src_global generation:  0.0014538764953613281
r_  generation:  0.01831531524658203
local_output_nid generation:  0.0009958744049072266
local_in_edges_tensor generation:  0.001312255859375
mini_batch_src_global generation:  0.0016846656799316406
r_  generation:  0.019894838333129883
local_output_nid generation:  0.0012276172637939453
local_in_edges_tensor generation:  0.002209901809692383
mini_batch_src_global generation:  0.002107858657836914
r_  generation:  0.02308034896850586
local_output_nid generation:  0.0010066032409667969
local_in_edges_tensor generation:  0.001550912857055664
mini_batch_src_global generation:  0.0016775131225585938
r_  generation:  0.019875288009643555
local_output_nid generation:  0.000804901123046875
local_in_edges_tensor generation:  0.0011544227600097656
mini_batch_src_global generation:  0.0014867782592773438
r_  generation:  0.01784825325012207
local_output_nid generation:  0.0011494159698486328
local_in_edges_tensor generation:  0.0018870830535888672
mini_batch_src_global generation:  0.0017437934875488281
r_  generation:  0.021584510803222656
----------------------check_connections_block total spend ----------------------------- 0.4077897071838379
generate_one_block  0.01340174674987793
generate_one_block  0.024752140045166016
generate_one_block  0.02921128273010254
generate_one_block  0.019188642501831055
generate_one_block  0.02690267562866211
generate_one_block  0.02349567413330078
generate_one_block  0.031025409698486328
generate_one_block  0.013228654861450195
generate_one_block  0.02348637580871582
generate_one_block  0.024049043655395508
generate_one_block  0.028440475463867188
generate_one_block  0.029932498931884766
generate_one_block  0.025562047958374023
generate_one_block  0.02311110496520996
generate_one_block  0.026836395263671875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008460521697998047  GigaBytes
Max Memory Allocated: 0.008460521697998047  GigaBytes

connection checking time:  0.7249999046325684
block generation total time  0.6933131217956543
average batch blocks generation time:  0.04622087478637695
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1229248046875 GB
    Memory Allocated: 0.03029632568359375  GigaBytes
Max Memory Allocated: 0.03029632568359375  GigaBytes

torch.Size([11184, 500])
torch.Size([4607, 64])
torch.Size([1354, 64])
torch.Size([506, 64])
torch.Size([146, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3123779296875 GB
    Memory Allocated: 1.0275521278381348  GigaBytes
Max Memory Allocated: 1.0442886352539062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.04814577102661133  GigaBytes
Max Memory Allocated: 1.0442886352539062  GigaBytes

torch.Size([16320, 500])
torch.Size([11054, 64])
torch.Size([4041, 64])
torch.Size([893, 64])
torch.Size([115, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5018310546875 GB
    Memory Allocated: 2.1197052001953125  GigaBytes
Max Memory Allocated: 2.1197166442871094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5018310546875 GB
    Memory Allocated: 0.0509181022644043  GigaBytes
Max Memory Allocated: 2.1199398040771484  GigaBytes

torch.Size([17757, 500])
torch.Size([12914, 64])
torch.Size([5454, 64])
torch.Size([1413, 64])
torch.Size([175, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6893310546875 GB
    Memory Allocated: 2.326502799987793  GigaBytes
Max Memory Allocated: 2.3265175819396973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6912841796875 GB
    Memory Allocated: 0.04497528076171875  GigaBytes
Max Memory Allocated: 2.3267364501953125  GigaBytes

torch.Size([14775, 500])
torch.Size([7412, 64])
torch.Size([3097, 64])
torch.Size([525, 64])
torch.Size([171, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6912841796875 GB
    Memory Allocated: 1.4866533279418945  GigaBytes
Max Memory Allocated: 2.3267364501953125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6912841796875 GB
    Memory Allocated: 0.05112171173095703  GigaBytes
Max Memory Allocated: 2.3267364501953125  GigaBytes

torch.Size([17872, 500])
torch.Size([12013, 64])
torch.Size([7014, 64])
torch.Size([1303, 64])
torch.Size([316, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6912841796875 GB
    Memory Allocated: 2.235893726348877  GigaBytes
Max Memory Allocated: 2.3267364501953125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6912841796875 GB
    Memory Allocated: 0.04601144790649414  GigaBytes
Max Memory Allocated: 2.3267364501953125  GigaBytes

torch.Size([15277, 500])
torch.Size([8002, 64])
torch.Size([2808, 64])
torch.Size([494, 64])
torch.Size([127, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6912841796875 GB
    Memory Allocated: 1.803746223449707  GigaBytes
Max Memory Allocated: 2.3267364501953125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6912841796875 GB
    Memory Allocated: 0.05240917205810547  GigaBytes
Max Memory Allocated: 2.3267364501953125  GigaBytes

torch.Size([18384, 500])
torch.Size([14884, 64])
torch.Size([8420, 64])
torch.Size([2628, 64])
torch.Size([528, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 2.6390304565429688  GigaBytes
Max Memory Allocated: 2.6390581130981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.03870439529418945  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([11046, 500])
torch.Size([3858, 64])
torch.Size([1137, 64])
torch.Size([190, 64])
torch.Size([62, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.9504098892211914  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.04743385314941406  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([15866, 500])
torch.Size([9919, 64])
torch.Size([5387, 64])
torch.Size([1640, 64])
torch.Size([366, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 2.1140828132629395  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.04529571533203125  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([14798, 500])
torch.Size([9311, 64])
torch.Size([4113, 64])
torch.Size([995, 64])
torch.Size([116, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 1.9425873756408691  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.04888439178466797  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([16715, 500])
torch.Size([10122, 64])
torch.Size([4479, 64])
torch.Size([657, 64])
torch.Size([105, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 2.097400188446045  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.050994873046875  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([17743, 500])
torch.Size([13219, 64])
torch.Size([6084, 64])
torch.Size([1248, 64])
torch.Size([242, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 2.418229579925537  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.049501895904541016  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([17076, 500])
torch.Size([10120, 64])
torch.Size([4619, 64])
torch.Size([690, 64])
torch.Size([186, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 2.0704236030578613  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.046944618225097656  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([15783, 500])
torch.Size([8447, 64])
torch.Size([2854, 64])
torch.Size([393, 64])
torch.Size([93, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 1.8139419555664062  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.049635887145996094  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([17045, 500])
torch.Size([11979, 64])
torch.Size([5430, 64])
torch.Size([1246, 64])
torch.Size([164, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 2.286740303039551  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013390684127807617 |0.024256420135498048 |0.3328688621520996 |0.0001605987548828125 |0.3786021073659261 |0.01243281364440918 |
----------------------------------------------------------pseudo_mini_loss sum 1.7200324535369873
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  469883
Number of first layer input nodes during this epoch:  237641
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.06884956359863281  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0008375644683837891
random selection method range initialization spend 0.00016641616821289062
time for parepare:  8.487701416015625e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.8133392333984375e-05
----------------------check_connections_block total spend ----------------------------- 0.003097057342529297
generate_one_block  0.0013022422790527344
generate_one_block  0.0011031627655029297
generate_one_block  0.0010967254638671875
generate_one_block  0.0011053085327148438
generate_one_block  0.001068115234375
generate_one_block  0.0011034011840820312
generate_one_block  0.0010852813720703125
generate_one_block  0.0010700225830078125
generate_one_block  0.0010645389556884766
generate_one_block  0.0010695457458496094
generate_one_block  0.0010423660278320312
generate_one_block  0.0010650157928466797
generate_one_block  0.0010056495666503906
generate_one_block  0.0010707378387451172
generate_one_block  0.0009946823120117188
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0008070468902587891
gen group dst list time:  9.012222290039062e-05
time for parepare:  0.0003833770751953125
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00015020370483398438
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00015091896057128906
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  5.316734313964844e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00021886825561523438
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  6.031990051269531e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00013637542724609375
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00010323524475097656
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.224082946777344e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.127357482910156e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  8.702278137207031e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00015497207641601562
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  8.130073547363281e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  6.580352783203125e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001316070556640625
----------------------check_connections_block total spend ----------------------------- 0.005415678024291992
generate_one_block  0.0013959407806396484
generate_one_block  0.0013108253479003906
generate_one_block  0.001131296157836914
generate_one_block  0.001421213150024414
generate_one_block  0.0011584758758544922
generate_one_block  0.0012955665588378906
generate_one_block  0.0012288093566894531
generate_one_block  0.001149892807006836
generate_one_block  0.0020704269409179688
generate_one_block  0.0010919570922851562
generate_one_block  0.0011417865753173828
generate_one_block  0.0012590885162353516
generate_one_block  0.0010783672332763672
generate_one_block  0.0011115074157714844
generate_one_block  0.0011360645294189453
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013425350189208984
gen group dst list time:  0.00015878677368164062
time for parepare:  0.0010704994201660156
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.0003867149353027344
mini_batch_src_global generation:  0.0001277923583984375
r_  generation:  0.0007836818695068359
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  0.0001392364501953125
r_  generation:  0.0008401870727539062
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.00020694732666015625
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  0.00021576881408691406
r_  generation:  0.0018467903137207031
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.0003924369812011719
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0006518363952636719
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.0006866455078125
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.0004436969757080078
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.00046062469482421875
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0002903938293457031
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0005218982696533203
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  0.00013518333435058594
r_  generation:  0.0012886524200439453
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  9.369850158691406e-05
r_  generation:  0.00041103363037109375
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.00044345855712890625
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0006620883941650391
----------------------check_connections_block total spend ----------------------------- 0.0189511775970459
generate_one_block  0.0023031234741210938
generate_one_block  0.002087116241455078
generate_one_block  0.001291036605834961
generate_one_block  0.003614187240600586
generate_one_block  0.0014519691467285156
generate_one_block  0.0019180774688720703
generate_one_block  0.0018770694732666016
generate_one_block  0.0015578269958496094
generate_one_block  0.001608133316040039
generate_one_block  0.0012888908386230469
generate_one_block  0.0016825199127197266
generate_one_block  0.002555370330810547
generate_one_block  0.0014834403991699219
generate_one_block  0.001569986343383789
generate_one_block  0.0018222332000732422
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018420219421386719
gen group dst list time:  0.0003993511199951172
time for parepare:  0.0017466545104980469
local_output_nid generation:  0.0001690387725830078
local_in_edges_tensor generation:  0.0008399486541748047
mini_batch_src_global generation:  0.0004553794860839844
r_  generation:  0.003544330596923828
local_output_nid generation:  0.00015211105346679688
local_in_edges_tensor generation:  0.000377655029296875
mini_batch_src_global generation:  0.0006265640258789062
r_  generation:  0.004708766937255859
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  0.0002586841583251953
r_  generation:  0.0015344619750976562
local_output_nid generation:  0.00028395652770996094
local_in_edges_tensor generation:  0.0005197525024414062
mini_batch_src_global generation:  0.0006852149963378906
r_  generation:  0.007510662078857422
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.00025177001953125
mini_batch_src_global generation:  0.00042438507080078125
r_  generation:  0.002696990966796875
local_output_nid generation:  0.000118255615234375
local_in_edges_tensor generation:  0.0002968311309814453
mini_batch_src_global generation:  0.00034999847412109375
r_  generation:  0.003343343734741211
local_output_nid generation:  0.00011873245239257812
local_in_edges_tensor generation:  0.0003018379211425781
mini_batch_src_global generation:  0.00041747093200683594
r_  generation:  0.004010915756225586
local_output_nid generation:  0.0001125335693359375
local_in_edges_tensor generation:  0.0002760887145996094
mini_batch_src_global generation:  0.0003681182861328125
r_  generation:  0.0030655860900878906
local_output_nid generation:  9.369850158691406e-05
local_in_edges_tensor generation:  0.00025916099548339844
mini_batch_src_global generation:  0.0003063678741455078
r_  generation:  0.0026493072509765625
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.0012178421020507812
local_output_nid generation:  9.608268737792969e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.0026307106018066406
local_output_nid generation:  0.00015878677368164062
local_in_edges_tensor generation:  0.000347137451171875
mini_batch_src_global generation:  0.0004851818084716797
r_  generation:  0.0048868656158447266
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.0002446174621582031
mini_batch_src_global generation:  0.00031304359436035156
r_  generation:  0.0020928382873535156
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.0002601146697998047
mini_batch_src_global generation:  0.0003218650817871094
r_  generation:  0.003201007843017578
local_output_nid generation:  0.00012636184692382812
local_in_edges_tensor generation:  0.00029659271240234375
mini_batch_src_global generation:  0.00029087066650390625
r_  generation:  0.002702474594116211
----------------------check_connections_block total spend ----------------------------- 0.07731342315673828
generate_one_block  0.006364107131958008
generate_one_block  0.0076863765716552734
generate_one_block  0.0028803348541259766
generate_one_block  0.011976003646850586
generate_one_block  0.004849910736083984
generate_one_block  0.005814313888549805
generate_one_block  0.00673365592956543
generate_one_block  0.005228281021118164
generate_one_block  0.00487518310546875
generate_one_block  0.00272369384765625
generate_one_block  0.00489044189453125
generate_one_block  0.007756233215332031
generate_one_block  0.004213809967041016
generate_one_block  0.00561213493347168
generate_one_block  0.0047113895416259766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021245479583740234
gen group dst list time:  0.0017375946044921875
time for parepare:  0.0017960071563720703
local_output_nid generation:  0.0007069110870361328
local_in_edges_tensor generation:  0.0015873908996582031
mini_batch_src_global generation:  0.0011425018310546875
r_  generation:  0.010373115539550781
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0011451244354248047
mini_batch_src_global generation:  0.001287221908569336
r_  generation:  0.014410018920898438
local_output_nid generation:  0.00030422210693359375
local_in_edges_tensor generation:  0.0005388259887695312
mini_batch_src_global generation:  0.0007567405700683594
r_  generation:  0.006196498870849609
local_output_nid generation:  0.0009045600891113281
local_in_edges_tensor generation:  0.0011775493621826172
mini_batch_src_global generation:  0.001432657241821289
r_  generation:  0.01786947250366211
local_output_nid generation:  0.0004737377166748047
local_in_edges_tensor generation:  0.0006461143493652344
mini_batch_src_global generation:  0.0010759830474853516
r_  generation:  0.008991003036499023
local_output_nid generation:  0.0006566047668457031
local_in_edges_tensor generation:  0.0008249282836914062
mini_batch_src_global generation:  0.0011889934539794922
r_  generation:  0.013111591339111328
local_output_nid generation:  0.0007393360137939453
local_in_edges_tensor generation:  0.0012121200561523438
mini_batch_src_global generation:  0.0011992454528808594
r_  generation:  0.014273405075073242
local_output_nid generation:  0.0004742145538330078
local_in_edges_tensor generation:  0.0006456375122070312
mini_batch_src_global generation:  0.0010497570037841797
r_  generation:  0.010903596878051758
local_output_nid generation:  0.0006213188171386719
local_in_edges_tensor generation:  0.0008230209350585938
mini_batch_src_global generation:  0.0009233951568603516
r_  generation:  0.012093544006347656
local_output_nid generation:  0.00030350685119628906
local_in_edges_tensor generation:  0.00045299530029296875
mini_batch_src_global generation:  0.0006952285766601562
r_  generation:  0.005308866500854492
local_output_nid generation:  0.0006053447723388672
local_in_edges_tensor generation:  0.0007579326629638672
mini_batch_src_global generation:  0.0009429454803466797
r_  generation:  0.011780023574829102
local_output_nid generation:  0.0006155967712402344
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.0009837150573730469
r_  generation:  0.011956453323364258
local_output_nid generation:  0.0005304813385009766
local_in_edges_tensor generation:  0.0007100105285644531
mini_batch_src_global generation:  0.0009105205535888672
r_  generation:  0.008162975311279297
local_output_nid generation:  0.0005662441253662109
local_in_edges_tensor generation:  0.0006823539733886719
mini_batch_src_global generation:  0.0009622573852539062
r_  generation:  0.011348485946655273
local_output_nid generation:  0.0005052089691162109
local_in_edges_tensor generation:  0.0006604194641113281
mini_batch_src_global generation:  0.0008800029754638672
r_  generation:  0.008780956268310547
----------------------check_connections_block total spend ----------------------------- 0.24294710159301758
generate_one_block  0.01701498031616211
generate_one_block  0.017233848571777344
generate_one_block  0.01068878173828125
generate_one_block  0.025484561920166016
generate_one_block  0.015050172805786133
generate_one_block  0.017493009567260742
generate_one_block  0.019832134246826172
generate_one_block  0.015769243240356445
generate_one_block  0.017101287841796875
generate_one_block  0.008844852447509766
generate_one_block  0.015511751174926758
generate_one_block  0.017451763153076172
generate_one_block  0.013169050216674805
generate_one_block  0.014838695526123047
generate_one_block  0.013048171997070312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018112659454345703
gen group dst list time:  0.004639625549316406
time for parepare:  0.0018837451934814453
local_output_nid generation:  0.0013933181762695312
local_in_edges_tensor generation:  0.0020720958709716797
mini_batch_src_global generation:  0.0016372203826904297
r_  generation:  0.019864320755004883
local_output_nid generation:  0.0013756752014160156
local_in_edges_tensor generation:  0.0021283626556396484
mini_batch_src_global generation:  0.0024023056030273438
r_  generation:  0.02165365219116211
local_output_nid generation:  0.0008151531219482422
local_in_edges_tensor generation:  0.001028299331665039
mini_batch_src_global generation:  0.0013055801391601562
r_  generation:  0.014452457427978516
local_output_nid generation:  0.0016198158264160156
local_in_edges_tensor generation:  0.0020132064819335938
mini_batch_src_global generation:  0.0020182132720947266
r_  generation:  0.024112701416015625
local_output_nid generation:  0.0010292530059814453
local_in_edges_tensor generation:  0.001413106918334961
mini_batch_src_global generation:  0.0015716552734375
r_  generation:  0.017459392547607422
local_output_nid generation:  0.0015096664428710938
local_in_edges_tensor generation:  0.0016484260559082031
mini_batch_src_global generation:  0.0017287731170654297
r_  generation:  0.021080732345581055
local_output_nid generation:  0.001430511474609375
local_in_edges_tensor generation:  0.0017437934875488281
mini_batch_src_global generation:  0.001827239990234375
r_  generation:  0.021966218948364258
local_output_nid generation:  0.0010886192321777344
local_in_edges_tensor generation:  0.001348257064819336
mini_batch_src_global generation:  0.0015878677368164062
r_  generation:  0.01883673667907715
local_output_nid generation:  0.0013713836669921875
local_in_edges_tensor generation:  0.0016279220581054688
mini_batch_src_global generation:  0.0018305778503417969
r_  generation:  0.021941661834716797
local_output_nid generation:  0.0008075237274169922
local_in_edges_tensor generation:  0.0010437965393066406
mini_batch_src_global generation:  0.0014815330505371094
r_  generation:  0.016104459762573242
local_output_nid generation:  0.0013623237609863281
local_in_edges_tensor generation:  0.0015659332275390625
mini_batch_src_global generation:  0.0016608238220214844
r_  generation:  0.021895647048950195
local_output_nid generation:  0.0011589527130126953
local_in_edges_tensor generation:  0.0017240047454833984
mini_batch_src_global generation:  0.0016145706176757812
r_  generation:  0.019862651824951172
local_output_nid generation:  0.0010502338409423828
local_in_edges_tensor generation:  0.00146484375
mini_batch_src_global generation:  0.0015399456024169922
r_  generation:  0.018936634063720703
local_output_nid generation:  0.0010330677032470703
local_in_edges_tensor generation:  0.0015637874603271484
mini_batch_src_global generation:  0.0016109943389892578
r_  generation:  0.019999027252197266
local_output_nid generation:  0.001173257827758789
local_in_edges_tensor generation:  0.0013952255249023438
mini_batch_src_global generation:  0.001535654067993164
r_  generation:  0.018825292587280273
----------------------check_connections_block total spend ----------------------------- 0.4314446449279785
generate_one_block  0.026746749877929688
generate_one_block  0.02992725372314453
generate_one_block  0.020183563232421875
generate_one_block  0.03142666816711426
generate_one_block  0.023437976837158203
generate_one_block  0.028074026107788086
generate_one_block  0.02975773811340332
generate_one_block  0.0248258113861084
generate_one_block  0.02928328514099121
generate_one_block  0.022598743438720703
generate_one_block  0.02883744239807129
generate_one_block  0.02982640266418457
generate_one_block  0.02649855613708496
generate_one_block  0.027081727981567383
generate_one_block  0.025221586227416992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.06884956359863281  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

connection checking time:  0.7760720252990723
block generation total time  0.7756679058074951
average batch blocks generation time:  0.051711193720499676
block dataloader generation time/epoch 1.8460190296173096
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.06647920608520508  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([16728, 500])
torch.Size([10861, 64])
torch.Size([4810, 64])
torch.Size([1297, 64])
torch.Size([292, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 2.0001120567321777  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.06880903244018555  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([17899, 500])
torch.Size([12123, 64])
torch.Size([7059, 64])
torch.Size([1324, 64])
torch.Size([330, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 2.2679495811462402  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.058638572692871094  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([12645, 500])
torch.Size([6316, 64])
torch.Size([2242, 64])
torch.Size([332, 64])
torch.Size([57, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 1.4853873252868652  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 0.0691823959350586  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([17931, 500])
torch.Size([14768, 64])
torch.Size([7757, 64])
torch.Size([2417, 64])
torch.Size([385, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 2.6197543144226074  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 0.06241893768310547  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([14172, 500])
torch.Size([8123, 64])
torch.Size([3750, 64])
torch.Size([583, 64])
torch.Size([110, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 1.819685935974121  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 0.0663461685180664  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([16587, 500])
torch.Size([11315, 64])
torch.Size([5005, 64])
torch.Size([1040, 64])
torch.Size([230, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 2.208507537841797  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 0.06768417358398438  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([17271, 500])
torch.Size([11986, 64])
torch.Size([5948, 64])
torch.Size([1066, 64])
torch.Size([209, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 2.3255200386047363  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 0.06267976760864258  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([14550, 500])
torch.Size([9443, 64])
torch.Size([3717, 64])
torch.Size([901, 64])
torch.Size([106, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 1.9487261772155762  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 0.06795406341552734  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([17466, 500])
torch.Size([11824, 64])
torch.Size([4856, 64])
torch.Size([852, 64])
torch.Size([141, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 2.2817277908325195  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 0.06243276596069336  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([14486, 500])
torch.Size([6662, 64])
torch.Size([2172, 64])
torch.Size([368, 64])
torch.Size([101, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 1.6193361282348633  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 0.06810760498046875  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([17553, 500])
torch.Size([11820, 64])
torch.Size([4553, 64])
torch.Size([887, 64])
torch.Size([168, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 2.2668590545654297  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 0.0647578239440918  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([15564, 500])
torch.Size([10186, 64])
torch.Size([4782, 64])
torch.Size([1507, 64])
torch.Size([309, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 2.100964069366455  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 0.06555318832397461  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([16256, 500])
torch.Size([9354, 64])
torch.Size([4041, 64])
torch.Size([616, 64])
torch.Size([138, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 1.993703842163086  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 0.0661778450012207  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([16534, 500])
torch.Size([9657, 64])
torch.Size([4523, 64])
torch.Size([745, 64])
torch.Size([131, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 2.0868735313415527  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 0.06517362594604492  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

torch.Size([16064, 500])
torch.Size([10149, 64])
torch.Size([3953, 64])
torch.Size([1064, 64])
torch.Size([223, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 1.8684439659118652  GigaBytes
Max Memory Allocated: 2.639256000518799  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014170058568318685 |0.0031854788462320964 |0.3085278828938802 |0.000144497553507487 |0.39023098945617674 |0.01380610466003418 |
----------------------------------------------------------pseudo_mini_loss sum 1.8448909521102905
Total (block generation + training)time/epoch 12.657167673110962
Training time/epoch 10.810779571533203
Training time without block to device /epoch 10.762997388839722
Training time without total dataloading part /epoch 10.497356653213501
load block tensor time/epoch 0.21255087852478027
block to device time/epoch 0.047782182693481445
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  483747
Number of first layer input nodes during this epoch:  241706
