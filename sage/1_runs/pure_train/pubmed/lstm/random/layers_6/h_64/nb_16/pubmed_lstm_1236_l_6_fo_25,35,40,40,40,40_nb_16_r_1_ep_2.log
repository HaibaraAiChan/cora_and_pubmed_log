main start at this time 1648533933.4267788
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008460521697998047  GigaBytes
Max Memory Allocated: 0.008460521697998047  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0019469261169433594
random selection method range initialization spend 0.00020623207092285156
time for parepare:  5.9604644775390625e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00021457672119140625
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.001617431640625
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.7881393432617188e-05
----------------------check_connections_block total spend ----------------------------- 0.0035986900329589844
generate_one_block  0.0015132427215576172
generate_one_block  0.0012760162353515625
generate_one_block  0.001257181167602539
generate_one_block  0.0013010501861572266
generate_one_block  0.0012545585632324219
generate_one_block  0.0012297630310058594
generate_one_block  0.001218557357788086
generate_one_block  0.0011434555053710938
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012054443359375
gen group dst list time:  7.009506225585938e-05
time for parepare:  0.0003254413604736328
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0001862049102783203
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0001811981201171875
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00023436546325683594
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.00033283233642578125
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00031447410583496094
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00018477439880371094
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00013971328735351562
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  9.846687316894531e-05
----------------------check_connections_block total spend ----------------------------- 0.004217863082885742
generate_one_block  0.0015118122100830078
generate_one_block  0.0014414787292480469
generate_one_block  0.0015780925750732422
generate_one_block  0.0016710758209228516
generate_one_block  0.0016469955444335938
generate_one_block  0.0014696121215820312
generate_one_block  0.0011670589447021484
generate_one_block  0.0010306835174560547
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012347698211669922
gen group dst list time:  0.000118255615234375
time for parepare:  0.0009512901306152344
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00028228759765625
mini_batch_src_global generation:  0.00010752677917480469
r_  generation:  0.0009315013885498047
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  0.0001404285430908203
r_  generation:  0.0010175704956054688
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00012183189392089844
r_  generation:  0.0010998249053955078
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  0.00020599365234375
r_  generation:  0.001990795135498047
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  0.00025010108947753906
r_  generation:  0.001996755599975586
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0010302066802978516
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0006465911865234375
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.0006902217864990234
----------------------check_connections_block total spend ----------------------------- 0.015978574752807617
generate_one_block  0.00194549560546875
generate_one_block  0.002155780792236328
generate_one_block  0.002225160598754883
generate_one_block  0.0033299922943115234
generate_one_block  0.003264188766479492
generate_one_block  0.0020890235900878906
generate_one_block  0.0016722679138183594
generate_one_block  0.0017578601837158203
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0017843246459960938
gen group dst list time:  0.00027251243591308594
time for parepare:  0.0016303062438964844
local_output_nid generation:  0.0001373291015625
local_in_edges_tensor generation:  0.0005326271057128906
mini_batch_src_global generation:  0.0004470348358154297
r_  generation:  0.0036962032318115234
local_output_nid generation:  0.00016450881958007812
local_in_edges_tensor generation:  0.0003845691680908203
mini_batch_src_global generation:  0.0006277561187744141
r_  generation:  0.0050182342529296875
local_output_nid generation:  0.00015473365783691406
local_in_edges_tensor generation:  0.00039649009704589844
mini_batch_src_global generation:  0.0006248950958251953
r_  generation:  0.0055963993072509766
local_output_nid generation:  0.00022482872009277344
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0008230209350585938
r_  generation:  0.007632732391357422
local_output_nid generation:  0.0001761913299560547
local_in_edges_tensor generation:  0.000408172607421875
mini_batch_src_global generation:  0.0006814002990722656
r_  generation:  0.006591796875
local_output_nid generation:  0.00014829635620117188
local_in_edges_tensor generation:  0.0003464221954345703
mini_batch_src_global generation:  0.0005669593811035156
r_  generation:  0.0053708553314208984
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.0002582073211669922
mini_batch_src_global generation:  0.0003905296325683594
r_  generation:  0.0032608509063720703
local_output_nid generation:  0.00010728836059570312
local_in_edges_tensor generation:  0.00028014183044433594
mini_batch_src_global generation:  0.0003993511199951172
r_  generation:  0.004062175750732422
----------------------check_connections_block total spend ----------------------------- 0.06245231628417969
generate_one_block  0.0066623687744140625
generate_one_block  0.007340431213378906
generate_one_block  0.008473634719848633
generate_one_block  0.011391639709472656
generate_one_block  0.009449958801269531
generate_one_block  0.008551359176635742
generate_one_block  0.005311489105224609
generate_one_block  0.0063838958740234375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020608901977539062
gen group dst list time:  0.0013623237609863281
time for parepare:  0.0018656253814697266
local_output_nid generation:  0.0005152225494384766
local_in_edges_tensor generation:  0.0012395381927490234
mini_batch_src_global generation:  0.001262664794921875
r_  generation:  0.012569904327392578
local_output_nid generation:  0.0006864070892333984
local_in_edges_tensor generation:  0.0016400814056396484
mini_batch_src_global generation:  0.0016314983367919922
r_  generation:  0.014745235443115234
local_output_nid generation:  0.0008494853973388672
local_in_edges_tensor generation:  0.0024154186248779297
mini_batch_src_global generation:  0.0013773441314697266
r_  generation:  0.01679205894470215
local_output_nid generation:  0.0007829666137695312
local_in_edges_tensor generation:  0.0014107227325439453
mini_batch_src_global generation:  0.0016667842864990234
r_  generation:  0.018166780471801758
local_output_nid generation:  0.0005657672882080078
local_in_edges_tensor generation:  0.0008809566497802734
mini_batch_src_global generation:  0.0012469291687011719
r_  generation:  0.014693975448608398
local_output_nid generation:  0.0007216930389404297
local_in_edges_tensor generation:  0.0011105537414550781
mini_batch_src_global generation:  0.0013079643249511719
r_  generation:  0.01841568946838379
local_output_nid generation:  0.0005376338958740234
local_in_edges_tensor generation:  0.000865936279296875
mini_batch_src_global generation:  0.001432657241821289
r_  generation:  0.01586008071899414
local_output_nid generation:  0.00045418739318847656
local_in_edges_tensor generation:  0.0008656978607177734
mini_batch_src_global generation:  0.0014352798461914062
r_  generation:  0.01637578010559082
----------------------check_connections_block total spend ----------------------------- 0.18523406982421875
generate_one_block  0.01660633087158203
generate_one_block  0.020726919174194336
generate_one_block  0.02185988426208496
generate_one_block  0.02447342872619629
generate_one_block  0.019165515899658203
generate_one_block  0.024283647537231445
generate_one_block  0.01965498924255371
generate_one_block  0.022809982299804688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021216869354248047
gen group dst list time:  0.0034322738647460938
time for parepare:  0.0018663406372070312
local_output_nid generation:  0.001218557357788086
local_in_edges_tensor generation:  0.0022170543670654297
mini_batch_src_global generation:  0.0023889541625976562
r_  generation:  0.023776769638061523
local_output_nid generation:  0.001481771469116211
local_in_edges_tensor generation:  0.002486705780029297
mini_batch_src_global generation:  0.0030298233032226562
r_  generation:  0.026051044464111328
local_output_nid generation:  0.001529693603515625
local_in_edges_tensor generation:  0.0024764537811279297
mini_batch_src_global generation:  0.0023560523986816406
r_  generation:  0.026627540588378906
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0022439956665039062
mini_batch_src_global generation:  0.0020704269409179688
r_  generation:  0.024762392044067383
local_output_nid generation:  0.0012369155883789062
local_in_edges_tensor generation:  0.0015406608581542969
mini_batch_src_global generation:  0.0016846656799316406
r_  generation:  0.02141594886779785
local_output_nid generation:  0.0014538764953613281
local_in_edges_tensor generation:  0.0019061565399169922
mini_batch_src_global generation:  0.0018992424011230469
r_  generation:  0.02364969253540039
local_output_nid generation:  0.0012712478637695312
local_in_edges_tensor generation:  0.0022161006927490234
mini_batch_src_global generation:  0.001827239990234375
r_  generation:  0.022372722625732422
local_output_nid generation:  0.0012295246124267578
local_in_edges_tensor generation:  0.0017926692962646484
mini_batch_src_global generation:  0.0017039775848388672
r_  generation:  0.0216214656829834
----------------------check_connections_block total spend ----------------------------- 0.2795124053955078
generate_one_block  0.026911258697509766
generate_one_block  0.03036212921142578
generate_one_block  0.03068065643310547
generate_one_block  0.030887842178344727
generate_one_block  0.027184486389160156
generate_one_block  0.029249906539916992
generate_one_block  0.029250621795654297
generate_one_block  0.027057409286499023
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008460521697998047  GigaBytes
Max Memory Allocated: 0.008460521697998047  GigaBytes

connection checking time:  0.5473952293395996
block generation total time  0.4946863651275635
average batch blocks generation time:  0.061835795640945435
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1346435546875 GB
    Memory Allocated: 0.04142189025878906  GigaBytes
Max Memory Allocated: 0.04142189025878906  GigaBytes

torch.Size([17204, 500])
torch.Size([12179, 64])
torch.Size([4921, 64])
torch.Size([1385, 64])
torch.Size([261, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6326904296875 GB
    Memory Allocated: 2.2561755180358887  GigaBytes
Max Memory Allocated: 2.2562026977539062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6326904296875 GB
    Memory Allocated: 0.05220746994018555  GigaBytes
Max Memory Allocated: 2.2564024925231934  GigaBytes

torch.Size([18392, 500])
torch.Size([13992, 64])
torch.Size([7059, 64])
torch.Size([1790, 64])
torch.Size([344, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 2.4702210426330566  GigaBytes
Max Memory Allocated: 2.4702401161193848  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 0.05280733108520508  GigaBytes
Max Memory Allocated: 2.4704513549804688  GigaBytes

torch.Size([18674, 500])
torch.Size([14431, 64])
torch.Size([8812, 64])
torch.Size([1763, 64])
torch.Size([443, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0018310546875 GB
    Memory Allocated: 2.558328151702881  GigaBytes
Max Memory Allocated: 2.558350086212158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0018310546875 GB
    Memory Allocated: 0.052631378173828125  GigaBytes
Max Memory Allocated: 2.5585556030273438  GigaBytes

torch.Size([18494, 500])
torch.Size([15094, 64])
torch.Size([8757, 64])
torch.Size([2719, 64])
torch.Size([587, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.6632237434387207  GigaBytes
Max Memory Allocated: 2.6632513999938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 0.0495600700378418  GigaBytes
Max Memory Allocated: 2.6634469032287598  GigaBytes

torch.Size([16941, 500])
torch.Size([11712, 64])
torch.Size([6265, 64])
torch.Size([2131, 64])
torch.Size([469, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 2.3284263610839844  GigaBytes
Max Memory Allocated: 2.6634469032287598  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 0.05193948745727539  GigaBytes
Max Memory Allocated: 2.6634469032287598  GigaBytes

torch.Size([18198, 500])
torch.Size([14097, 64])
torch.Size([7637, 64])
torch.Size([1651, 64])
torch.Size([341, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 2.5330910682678223  GigaBytes
Max Memory Allocated: 2.6634469032287598  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 0.05134296417236328  GigaBytes
Max Memory Allocated: 2.6634469032287598  GigaBytes

torch.Size([17981, 500])
torch.Size([12319, 64])
torch.Size([5990, 64])
torch.Size([997, 64])
torch.Size([286, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 2.3366103172302246  GigaBytes
Max Memory Allocated: 2.6634469032287598  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 0.04966163635253906  GigaBytes
Max Memory Allocated: 2.6634469032287598  GigaBytes

torch.Size([17058, 500])
torch.Size([11938, 64])
torch.Size([5443, 64])
torch.Size([1237, 64])
torch.Size([164, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 2.287590503692627  GigaBytes
Max Memory Allocated: 2.6634469032287598  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017739951610565186 |0.04617789387702942 |0.3997565507888794 |0.00015366077423095703 |0.43966174125671387 |0.014461994171142578 |
----------------------------------------------------------pseudo_mini_loss sum 2.1362016201019287
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  320513
Number of first layer input nodes during this epoch:  142942
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 0.06905889511108398  GigaBytes
Max Memory Allocated: 2.6634469032287598  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00096893310546875
random selection method range initialization spend 0.00016832351684570312
time for parepare:  8.7738037109375e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  9.1552734375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.0994415283203125e-05
----------------------check_connections_block total spend ----------------------------- 0.0021936893463134766
generate_one_block  0.0020418167114257812
generate_one_block  0.0014908313751220703
generate_one_block  0.0014941692352294922
generate_one_block  0.001459360122680664
generate_one_block  0.0014185905456542969
generate_one_block  0.001432657241821289
generate_one_block  0.0013942718505859375
generate_one_block  0.0012311935424804688
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00075531005859375
gen group dst list time:  7.271766662597656e-05
time for parepare:  0.0006203651428222656
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00025177001953125
mini_batch_src_global generation:  0.00010466575622558594
r_  generation:  0.0003590583801269531
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  0.0001068115234375
r_  generation:  0.0003376007080078125
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00015783309936523438
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00021147727966308594
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0001747608184814453
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0001385211944580078
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00028061866760253906
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001442432403564453
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00015401840209960938
----------------------check_connections_block total spend ----------------------------- 0.005062103271484375
generate_one_block  0.0023005008697509766
generate_one_block  0.0020737648010253906
generate_one_block  0.0018374919891357422
generate_one_block  0.001895904541015625
generate_one_block  0.001514434814453125
generate_one_block  0.0016548633575439453
generate_one_block  0.0013494491577148438
generate_one_block  0.0011985301971435547
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011432170867919922
gen group dst list time:  0.0001595020294189453
time for parepare:  0.00135040283203125
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.0003848075866699219
mini_batch_src_global generation:  0.0003695487976074219
r_  generation:  0.0019180774688720703
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00025844573974609375
mini_batch_src_global generation:  0.0005245208740234375
r_  generation:  0.0021610260009765625
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  0.00015473365783691406
r_  generation:  0.0010235309600830078
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  0.00014662742614746094
r_  generation:  0.0011169910430908203
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  0.0001163482666015625
r_  generation:  0.0007114410400390625
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  0.00018072128295898438
r_  generation:  0.0017676353454589844
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.0001373291015625
r_  generation:  0.0008013248443603516
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0006668567657470703
----------------------check_connections_block total spend ----------------------------- 0.0188596248626709
generate_one_block  0.003506183624267578
generate_one_block  0.003821849822998047
generate_one_block  0.0022706985473632812
generate_one_block  0.0024597644805908203
generate_one_block  0.001873016357421875
generate_one_block  0.003267526626586914
generate_one_block  0.0019788742065429688
generate_one_block  0.0018162727355957031
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018877983093261719
gen group dst list time:  0.0003705024719238281
time for parepare:  0.0016553401947021484
local_output_nid generation:  0.0003364086151123047
local_in_edges_tensor generation:  0.0009312629699707031
mini_batch_src_global generation:  0.0008273124694824219
r_  generation:  0.006940364837646484
local_output_nid generation:  0.00029015541076660156
local_in_edges_tensor generation:  0.0006194114685058594
mini_batch_src_global generation:  0.0011172294616699219
r_  generation:  0.008437395095825195
local_output_nid generation:  0.0001678466796875
local_in_edges_tensor generation:  0.0003554821014404297
mini_batch_src_global generation:  0.00058746337890625
r_  generation:  0.005032539367675781
local_output_nid generation:  0.00020885467529296875
local_in_edges_tensor generation:  0.0003910064697265625
mini_batch_src_global generation:  0.0005931854248046875
r_  generation:  0.0059511661529541016
local_output_nid generation:  0.0001342296600341797
local_in_edges_tensor generation:  0.00029969215393066406
mini_batch_src_global generation:  0.000431060791015625
r_  generation:  0.0036716461181640625
local_output_nid generation:  0.0003535747528076172
local_in_edges_tensor generation:  0.0011026859283447266
mini_batch_src_global generation:  0.0006501674652099609
r_  generation:  0.007055521011352539
local_output_nid generation:  0.00013685226440429688
local_in_edges_tensor generation:  0.0003132820129394531
mini_batch_src_global generation:  0.0005650520324707031
r_  generation:  0.004824638366699219
local_output_nid generation:  0.00010824203491210938
local_in_edges_tensor generation:  0.0002665519714355469
mini_batch_src_global generation:  0.0003528594970703125
r_  generation:  0.002732515335083008
----------------------check_connections_block total spend ----------------------------- 0.06877589225769043
generate_one_block  0.01063227653503418
generate_one_block  0.012347936630249023
generate_one_block  0.008370637893676758
generate_one_block  0.009398221969604492
generate_one_block  0.006052732467651367
generate_one_block  0.01076960563659668
generate_one_block  0.008022308349609375
generate_one_block  0.004649162292480469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002174854278564453
gen group dst list time:  0.0012743473052978516
time for parepare:  0.0017673969268798828
local_output_nid generation:  0.0011379718780517578
local_in_edges_tensor generation:  0.0018260478973388672
mini_batch_src_global generation:  0.0019490718841552734
r_  generation:  0.017080307006835938
local_output_nid generation:  0.0009059906005859375
local_in_edges_tensor generation:  0.0016410350799560547
mini_batch_src_global generation:  0.002122640609741211
r_  generation:  0.01844024658203125
local_output_nid generation:  0.0008041858673095703
local_in_edges_tensor generation:  0.0014319419860839844
mini_batch_src_global generation:  0.0013341903686523438
r_  generation:  0.0157623291015625
local_output_nid generation:  0.0009200572967529297
local_in_edges_tensor generation:  0.0010499954223632812
mini_batch_src_global generation:  0.0014412403106689453
r_  generation:  0.016495227813720703
local_output_nid generation:  0.0007569789886474609
local_in_edges_tensor generation:  0.0009272098541259766
mini_batch_src_global generation:  0.0011725425720214844
r_  generation:  0.013934135437011719
local_output_nid generation:  0.0009632110595703125
local_in_edges_tensor generation:  0.0011539459228515625
mini_batch_src_global generation:  0.0015041828155517578
r_  generation:  0.017656564712524414
local_output_nid generation:  0.0008878707885742188
local_in_edges_tensor generation:  0.001134634017944336
mini_batch_src_global generation:  0.0013833045959472656
r_  generation:  0.015799760818481445
local_output_nid generation:  0.0005114078521728516
local_in_edges_tensor generation:  0.0006299018859863281
mini_batch_src_global generation:  0.0008566379547119141
r_  generation:  0.008493661880493164
----------------------check_connections_block total spend ----------------------------- 0.18224477767944336
generate_one_block  0.021917343139648438
generate_one_block  0.026956796646118164
generate_one_block  0.02112269401550293
generate_one_block  0.022629976272583008
generate_one_block  0.021053314208984375
generate_one_block  0.02470564842224121
generate_one_block  0.021448612213134766
generate_one_block  0.01312708854675293
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0016908645629882812
gen group dst list time:  0.002775430679321289
time for parepare:  0.001836538314819336
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.002305269241333008
mini_batch_src_global generation:  0.002021312713623047
r_  generation:  0.023720979690551758
local_output_nid generation:  0.0016455650329589844
local_in_edges_tensor generation:  0.002705812454223633
mini_batch_src_global generation:  0.002607583999633789
r_  generation:  0.03113412857055664
local_output_nid generation:  0.0029532909393310547
local_in_edges_tensor generation:  0.0022945404052734375
mini_batch_src_global generation:  0.0032205581665039062
r_  generation:  0.02456188201904297
local_output_nid generation:  0.002067089080810547
local_in_edges_tensor generation:  0.0027091503143310547
mini_batch_src_global generation:  0.002184629440307617
r_  generation:  0.024979829788208008
local_output_nid generation:  0.0018815994262695312
local_in_edges_tensor generation:  0.0020668506622314453
mini_batch_src_global generation:  0.0021893978118896484
r_  generation:  0.024746417999267578
local_output_nid generation:  0.001950979232788086
local_in_edges_tensor generation:  0.0027353763580322266
mini_batch_src_global generation:  0.002415180206298828
r_  generation:  0.033582210540771484
local_output_nid generation:  0.001695871353149414
local_in_edges_tensor generation:  0.0020971298217773438
mini_batch_src_global generation:  0.0018153190612792969
r_  generation:  0.02277517318725586
local_output_nid generation:  0.0012309551239013672
local_in_edges_tensor generation:  0.0014235973358154297
mini_batch_src_global generation:  0.0015778541564941406
r_  generation: Using backend: pytorch
 0.018114328384399414
----------------------check_connections_block total spend ----------------------------- 0.3030846118927002
generate_one_block  0.0331883430480957
generate_one_block  0.03368544578552246
generate_one_block  0.029766321182250977
generate_one_block  0.030601978302001953
generate_one_block  0.046021223068237305
generate_one_block  0.04981374740600586
generate_one_block  0.04466104507446289
generate_one_block  0.03145003318786621
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 0.06905889511108398  GigaBytes
Max Memory Allocated: 2.6634469032287598  GigaBytes

connection checking time:  0.5780270099639893
block generation total time  0.5772116184234619
average batch blocks generation time:  0.07215145230293274
block dataloader generation time/epoch 1.3452906608581543
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 0.07039499282836914  GigaBytes
Max Memory Allocated: 2.6634469032287598  GigaBytes

torch.Size([18554, 500])
torch.Size([14287, 64])
torch.Size([9222, 64])
torch.Size([2435, 64])
torch.Size([615, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 2.516511917114258  GigaBytes
Max Memory Allocated: 2.6634469032287598  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 0.0702509880065918  GigaBytes
Max Memory Allocated: 2.6634469032287598  GigaBytes

torch.Size([18379, 500])
torch.Size([15381, 64])
torch.Size([8457, 64])
torch.Size([2618, 64])
torch.Size([442, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.699069023132324  GigaBytes
Max Memory Allocated: 2.6990933418273926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 0.06760883331298828  GigaBytes
Max Memory Allocated: 2.699295997619629  GigaBytes

torch.Size([17094, 500])
torch.Size([12503, 64])
torch.Size([6697, 64])
torch.Size([1495, 64])
torch.Size([340, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 2.3652076721191406  GigaBytes
Max Memory Allocated: 2.699295997619629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 0.06887245178222656  GigaBytes
Max Memory Allocated: 2.699295997619629  GigaBytes

torch.Size([17734, 500])
torch.Size([13263, 64])
torch.Size([7427, 64])
torch.Size([1849, 64])
torch.Size([314, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 2.484057903289795  GigaBytes
Max Memory Allocated: 2.699295997619629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 0.06904029846191406  GigaBytes
Max Memory Allocated: 2.699295997619629  GigaBytes

torch.Size([17904, 500])
torch.Size([12796, 64])
torch.Size([6018, 64])
torch.Size([1213, 64])
torch.Size([243, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 2.395514965057373  GigaBytes
Max Memory Allocated: 2.699295997619629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 0.07008934020996094  GigaBytes
Max Memory Allocated: 2.699295997619629  GigaBytes

torch.Size([18329, 500])
torch.Size([14679, 64])
torch.Size([8005, 64])
torch.Size([2336, 64])
torch.Size([475, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 2.628635883331299  GigaBytes
Max Memory Allocated: 2.699295997619629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 0.06938695907592773  GigaBytes
Max Memory Allocated: 2.699295997619629  GigaBytes

torch.Size([18042, 500])
torch.Size([12880, 64])
torch.Size([7268, 64])
torch.Size([1331, 64])
torch.Size([269, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 2.448770523071289  GigaBytes
Max Memory Allocated: 2.699295997619629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 0.0652017593383789  GigaBytes
Max Memory Allocated: 2.699295997619629  GigaBytes

torch.Size([15982, 500])
torch.Size([10139, 64])
torch.Size([3955, 64])
torch.Size([1067, 64])
torch.Size([223, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2498779296875 GB
    Memory Allocated: 1.8654499053955078  GigaBytes
Max Memory Allocated: 2.699295997619629  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01957690715789795 |0.004608422517776489 |0.33877408504486084 |0.00015291571617126465 |0.4468105137348175 |0.009331941604614258 |
----------------------------------------------------------pseudo_mini_loss sum 1.9753063917160034
Total (block generation + training)time/epoch 7.8630383014678955
Training time/epoch 6.517352342605591
Training time without block to device /epoch 6.480484962463379
Training time without total dataloading part /epoch 6.295232057571411
load block tensor time/epoch 0.1566152572631836
block to device time/epoch 0.036867380142211914
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  322617
Number of first layer input nodes during this epoch:  142018
