main start at this time 1648533914.9181762
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008460521697998047  GigaBytes
Max Memory Allocated: 0.008460521697998047  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0030896663665771484
random selection method range initialization spend 0.00017547607421875
time for parepare:  4.482269287109375e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0013201236724853516
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.5987625122070312e-05
----------------------check_connections_block total spend ----------------------------- 0.0022840499877929688
generate_one_block  0.0011475086212158203
generate_one_block  0.0010111331939697266
generate_one_block  0.0009894371032714844
generate_one_block  0.0009665489196777344
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0014808177947998047
gen group dst list time:  2.9802322387695312e-05
time for parepare:  0.0002162456512451172
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00031495094299316406
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.000396728515625
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0003380775451660156
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.000213623046875
----------------------check_connections_block total spend ----------------------------- 0.0026547908782958984
generate_one_block  0.0013036727905273438
generate_one_block  0.0015118122100830078
generate_one_block  0.0013706684112548828
generate_one_block  0.0012218952178955078
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001056671142578125
gen group dst list time:  6.628036499023438e-05
time for parepare:  0.0006899833679199219
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.00029468536376953125
mini_batch_src_global generation:  0.00013446807861328125
r_  generation:  0.00145721435546875
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.0002460479736328125
mini_batch_src_global generation:  0.0003306865692138672
r_  generation:  0.0025599002838134766
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  0.00026726722717285156
r_  generation:  0.002311229705810547
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.00017452239990234375
r_  generation:  0.001489400863647461
----------------------check_connections_block total spend ----------------------------- 0.012701034545898438
generate_one_block  0.003396749496459961
generate_one_block  0.004364967346191406
generate_one_block  0.004002571105957031
generate_one_block  0.0029196739196777344
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002107381820678711
gen group dst list time:  0.0002086162567138672
time for parepare:  0.0014955997467041016
local_output_nid generation:  0.00023412704467773438
local_in_edges_tensor generation:  0.0008153915405273438
mini_batch_src_global generation:  0.0007920265197753906
r_  generation:  0.006663084030151367
local_output_nid generation:  0.00030612945556640625
local_in_edges_tensor generation:  0.0006771087646484375
mini_batch_src_global generation:  0.0012035369873046875
r_  generation:  0.010819196701049805
local_output_nid generation:  0.0002186298370361328
local_in_edges_tensor generation:  0.0005576610565185547
mini_batch_src_global generation:  0.0009052753448486328
r_  generation:  0.00855398178100586
local_output_nid generation:  0.0002193450927734375
local_in_edges_tensor generation:  0.00045752525329589844
mini_batch_src_global generation:  0.0007882118225097656
r_  generation:  0.007716655731201172
----------------------check_connections_block total spend ----------------------------- 0.05077862739562988
generate_one_block  0.01070261001586914
generate_one_block  0.015961170196533203
generate_one_block  0.01207590103149414
generate_one_block  0.011342048645019531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021042823791503906
gen group dst list time:  0.00077056884765625
time for parepare:  0.0016832351684570312
local_output_nid generation:  0.0007746219635009766
local_in_edges_tensor generation:  0.0016798973083496094
mini_batch_src_global generation:  0.0016362667083740234
r_  generation:  0.01705455780029297
local_output_nid generation:  0.0009763240814208984
local_in_edges_tensor generation:  0.0023746490478515625
mini_batch_src_global generation:  0.0025238990783691406
r_  generation:  0.021258115768432617
local_output_nid generation:  0.0007708072662353516
local_in_edges_tensor generation:  0.001371622085571289
mini_batch_src_global generation:  0.0014767646789550781
r_  generation:  0.01709294319152832
local_output_nid generation:  0.0008544921875
local_in_edges_tensor generation:  0.0013804435729980469
mini_batch_src_global generation:  0.0016942024230957031
r_  generation:  0.018197059631347656
----------------------check_connections_block total spend ----------------------------- 0.10933256149291992
generate_one_block  0.023200273513793945
generate_one_block  0.02858281135559082
generate_one_block  0.022760629653930664
generate_one_block  0.023857593536376953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020904541015625
gen group dst list time:  0.0012998580932617188
time for parepare:  0.0015003681182861328
local_output_nid generation:  0.0013854503631591797
local_in_edges_tensor generation:  0.0030357837677001953
mini_batch_src_global generation:  0.002223491668701172
r_  generation:  0.023810148239135742
local_output_nid generation:  0.0014111995697021484
local_in_edges_tensor generation:  0.0028481483459472656
mini_batch_src_global generation:  0.0025103092193603516
r_  generation:  0.02457571029663086
local_output_nid generation:  0.001386404037475586
local_in_edges_tensor generation:  0.002218961715698242
mini_batch_src_global generation:  0.0018696784973144531
r_  generation:  0.0228421688079834
local_output_nid generation:  0.0014138221740722656
local_in_edges_tensor generation:  0.0020041465759277344
mini_batch_src_global generation:  0.0020215511322021484
r_  generation:  0.023696422576904297
----------------------check_connections_block total spend ----------------------------- 0.14046549797058105
generate_one_block  0.030042171478271484
generate_one_block  0.031107425689697266
generate_one_block  0.028813838958740234
generate_one_block  0.02943873405456543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008460521697998047  GigaBytes
Max Memory Allocated: 0.008460521697998047  GigaBytes

connection checking time:  0.3159325122833252
block generation total time  0.2879772186279297
average batch blocks generation time:  0.07199430465698242
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.04486656188964844  GigaBytes
Max Memory Allocated: 0.04486656188964844  GigaBytes

torch.Size([18830, 500])
torch.Size([16046, 64])
torch.Size([9262, 64])
torch.Size([2930, 64])
torch.Size([590, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1033935546875 GB
    Memory Allocated: 2.698345184326172  GigaBytes
Max Memory Allocated: 2.6983838081359863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.054125308990478516  GigaBytes
Max Memory Allocated: 2.698563575744629  GigaBytes

torch.Size([19165, 500])
torch.Size([17100, 64])
torch.Size([12942, 64])
torch.Size([4024, 64])
torch.Size([970, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4412841796875 GB
    Memory Allocated: 2.9126882553100586  GigaBytes
Max Memory Allocated: 2.912731647491455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4393310546875 GB
    Memory Allocated: 0.05339670181274414  GigaBytes
Max Memory Allocated: 2.912899971008301  GigaBytes

torch.Size([18502, 500])
torch.Size([14782, 64])
torch.Size([9304, 64])
torch.Size([2865, 64])
torch.Size([709, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4393310546875 GB
    Memory Allocated: 2.6811890602111816  GigaBytes
Max Memory Allocated: 2.912899971008301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4393310546875 GB
    Memory Allocated: 0.05335521697998047  GigaBytes
Max Memory Allocated: 2.912899971008301  GigaBytes

torch.Size([18858, 500])
torch.Size([15787, 64])
torch.Size([10006, 64])
torch.Size([2710, 64])
torch.Size([579, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4393310546875 GB
    Memory Allocated: 2.733170986175537  GigaBytes
Max Memory Allocated: 2.912899971008301  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021889865398406982 |0.08884763717651367 |0.5358532667160034 |0.00018447637557983398 |0.4638081192970276 |0.016963720321655273 |
----------------------------------------------------------pseudo_mini_loss sum 1.716528058052063
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  196317
Number of first layer input nodes during this epoch:  75355
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.4393310546875 GB
    Memory Allocated: 0.07362174987792969  GigaBytes
Max Memory Allocated: 2.912899971008301  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006365776062011719
random selection method range initialization spend 0.00015974044799804688
time for parepare:  6.079673767089844e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  3.3855438232421875e-05
----------------------check_connections_block total spend ----------------------------- 0.00128936767578125
generate_one_block  0.0013191699981689453
generate_one_block  0.0011510848999023438
generate_one_block  0.0011730194091796875
generate_one_block  0.0013048648834228516
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006134510040283203
gen group dst list time:  3.790855407714844e-05
time for parepare:  0.00028967857360839844
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.00045871734619140625
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0003058910369873047
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.00034809112548828125
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00022292137145996094
----------------------check_connections_block total spend ----------------------------- 0.003149271011352539
generate_one_block  0.0017855167388916016
generate_one_block  0.0015954971313476562
generate_one_block  0.0015845298767089844
generate_one_block  0.0014510154724121094
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010771751403808594
gen group dst list time:  8.726119995117188e-05
time for parepare:  0.0008194446563720703
local_output_nid generation:  0.00010895729064941406
local_in_edges_tensor generation:  0.00042176246643066406
mini_batch_src_global generation:  0.00036644935607910156
r_  generation:  0.0027489662170410156
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.00022482872009277344
mini_batch_src_global generation:  0.00025153160095214844
r_  generation:  0.00189208984375
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.00024127960205078125
mini_batch_src_global generation:  0.0003173351287841797
r_  generation:  0.0024633407592773438
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  0.00017881393432617188
r_  generation:  0.0013527870178222656
----------------------check_connections_block total spend ----------------------------- 0.01415109634399414
generate_one_block  0.0056667327880859375
generate_one_block  0.0038347244262695312
generate_one_block  0.004483222961425781
generate_one_block  0.0029587745666503906
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002179384231567383
gen group dst list time:  0.000255584716796875
time for parepare:  0.0013763904571533203
local_output_nid generation:  0.0003437995910644531
local_in_edges_tensor generation:  0.0011184215545654297
mini_batch_src_global generation:  0.0011966228485107422
r_  generation:  0.010917425155639648
local_output_nid generation:  0.0002894401550292969
local_in_edges_tensor generation:  0.0006618499755859375
mini_batch_src_global generation:  0.0009741783142089844
r_  generation:  0.009191036224365234
local_output_nid generation:  0.0003352165222167969
local_in_edges_tensor generation:  0.0007503032684326172
mini_batch_src_global generation:  0.0008730888366699219
r_  generation:  0.010206460952758789
local_output_nid generation: Using backend: pytorch
 0.0002522468566894531
local_in_edges_tensor generation:  0.0004949569702148438
mini_batch_src_global generation:  0.0008001327514648438
r_  generation:  0.00704503059387207
----------------------check_connections_block total spend ----------------------------- 0.055947303771972656
generate_one_block  0.01811528205871582
generate_one_block  0.01446223258972168
generate_one_block  0.015301942825317383
generate_one_block  0.01221156120300293
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001920938491821289
gen group dst list time:  0.0007746219635009766
time for parepare:  0.0015282630920410156
local_output_nid generation:  0.0010917186737060547
local_in_edges_tensor generation:  0.0024542808532714844
mini_batch_src_global generation:  0.001990079879760742
r_  generation:  0.021460533142089844
local_output_nid generation:  0.0009784698486328125
local_in_edges_tensor generation:  0.00189971923828125
mini_batch_src_global generation:  0.002309560775756836
r_  generation:  0.019544363021850586
local_output_nid generation:  0.0010607242584228516
local_in_edges_tensor generation:  0.0015444755554199219
mini_batch_src_global generation:  0.0017323493957519531
r_  generation:  0.020165205001831055
local_output_nid generation:  0.001020193099975586
local_in_edges_tensor generation:  0.0015773773193359375
mini_batch_src_global generation:  0.0016396045684814453
r_  generation:  0.018606901168823242
----------------------check_connections_block total spend ----------------------------- 0.11829638481140137
generate_one_block  0.03002762794494629
generate_one_block  0.02761363983154297
generate_one_block  0.027744054794311523
generate_one_block  0.02555561065673828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020411014556884766
gen group dst list time:  0.0015025138854980469
time for parepare:  0.0016672611236572266
local_output_nid generation:  0.001626729965209961
local_in_edges_tensor generation:  0.0028853416442871094
mini_batch_src_global generation:  0.002088308334350586
r_  generation:  0.025478839874267578
local_output_nid generation:  0.0015096664428710938
local_in_edges_tensor generation:  0.0027549266815185547
mini_batch_src_global generation:  0.0026395320892333984
r_  generation:  0.02452683448791504
local_output_nid generation:  0.0016660690307617188
local_in_edges_tensor generation:  0.002404451370239258
mini_batch_src_global generation:  0.0021293163299560547
r_  generation:  0.0249941349029541
local_output_nid generation:  0.0016808509826660156
local_in_edges_tensor generation:  0.0021660327911376953
mini_batch_src_global generation:  0.0019278526306152344
r_  generation:  0.024211883544921875
----------------------check_connections_block total spend ----------------------------- 0.14736485481262207
generate_one_block  0.03345322608947754
generate_one_block  0.032670021057128906
generate_one_block  0.03254103660583496
generate_one_block  0.031920671463012695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.4393310546875 GB
    Memory Allocated: 0.07362174987792969  GigaBytes
Max Memory Allocated: 2.912899971008301  GigaBytes

connection checking time:  0.3389089107513428
block generation total time  0.32497692108154297
average batch blocks generation time:  0.08124423027038574
block dataloader generation time/epoch 0.760317325592041
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4393310546875 GB
    Memory Allocated: 0.07224559783935547  GigaBytes
Max Memory Allocated: 2.912899971008301  GigaBytes

torch.Size([19242, 500])
torch.Size([17085, 64])
torch.Size([12696, 64])
torch.Size([3768, 64])
torch.Size([951, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4393310546875 GB
    Memory Allocated: 2.921633243560791  GigaBytes
Max Memory Allocated: 2.921675682067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4393310546875 GB
    Memory Allocated: 0.07143259048461914  GigaBytes
Max Memory Allocated: 2.921847343444824  GigaBytes

torch.Size([18671, 500])
torch.Size([16141, 64])
torch.Size([10553, 64])
torch.Size([3238, 64])
torch.Size([650, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4412841796875 GB
    Memory Allocated: 2.782151699066162  GigaBytes
Max Memory Allocated: 2.921847343444824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4412841796875 GB
    Memory Allocated: 0.0716848373413086  GigaBytes
Max Memory Allocated: 2.921847343444824  GigaBytes

torch.Size([18979, 500])
torch.Size([16537, 64])
torch.Size([10800, 64])
torch.Size([3656, 64])
torch.Size([747, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4647216796875 GB
    Memory Allocated: 2.8485188484191895  GigaBytes
Max Memory Allocated: 2.921847343444824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4647216796875 GB
    Memory Allocated: 0.07132387161254883  GigaBytes
Max Memory Allocated: 2.921847343444824  GigaBytes

torch.Size([18764, 500])
torch.Size([15485, 64])
torch.Size([9767, 64])
torch.Size([2382, 64])
torch.Size([534, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4647216796875 GB
    Memory Allocated: 2.713447093963623  GigaBytes
Max Memory Allocated: 2.921847343444824  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02567291259765625 |0.0028916597366333008 |0.44296932220458984 |0.00018465518951416016 |0.4639354944229126 |0.01577281951904297 |
----------------------------------------------------------pseudo_mini_loss sum 1.6569308042526245
Total (block generation + training)time/epoch 4.5346291065216064
Training time/epoch 3.7740776538848877
Training time without block to device /epoch 3.7625110149383545
Training time without total dataloading part /epoch 3.6441307067871094
load block tensor time/epoch 0.102691650390625
block to device time/epoch 0.011566638946533203
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  201003
Number of first layer input nodes during this epoch:  75656
