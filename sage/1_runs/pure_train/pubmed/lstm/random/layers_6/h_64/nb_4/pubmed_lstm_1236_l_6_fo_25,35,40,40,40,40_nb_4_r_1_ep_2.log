main start at this time 1648533900.2271993
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008460521697998047  GigaBytes
Max Memory Allocated: 0.008460521697998047  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0026493072509765625
random selection method range initialization spend 0.00021076202392578125
time for parepare:  5.340576171875e-05
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0013213157653808594
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  6.151199340820312e-05
----------------------check_connections_block total spend ----------------------------- 0.002079486846923828
generate_one_block  0.0014946460723876953
generate_one_block  0.0013108253479003906
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0016188621520996094
gen group dst list time:  2.956390380859375e-05
time for parepare:  0.0002837181091308594
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  0.00010561943054199219
r_  generation:  0.0008254051208496094
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  0.00010561943054199219
r_  generation:  0.0006656646728515625
----------------------check_connections_block total spend ----------------------------- 0.002869129180908203
generate_one_block  0.0023322105407714844
generate_one_block  0.0020821094512939453
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012385845184326172
gen group dst list time:  7.605552673339844e-05
time for parepare:  0.0008580684661865234
local_output_nid generation:  0.0001373291015625
local_in_edges_tensor generation:  0.0006272792816162109
mini_batch_src_global generation:  0.00044655799865722656
r_  generation:  0.004906177520751953
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.00034689903259277344
mini_batch_src_global generation:  0.0006020069122314453
r_  generation:  0.004411458969116211
----------------------check_connections_block total spend ----------------------------- 0.014995336532592773
generate_one_block  0.0067560672760009766
generate_one_block  0.0055539608001708984
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002331256866455078
gen group dst list time:  0.00023794174194335938
time for parepare:  0.0018055438995361328
local_output_nid generation:  0.0005972385406494141
local_in_edges_tensor generation:  0.0014948844909667969
mini_batch_src_global generation:  0.0017499923706054688
r_  generation:  0.02472519874572754
local_output_nid generation:  0.0003960132598876953
local_in_edges_tensor generation:  0.0008449554443359375
mini_batch_src_global generation:  0.0018048286437988281
r_  generation:  0.012644529342651367
----------------------check_connections_block total spend ----------------------------- 0.05418658256530762
generate_one_block  0.020419836044311523
generate_one_block  0.017589330673217773
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018260478973388672
gen group dst list time:  0.00046706199645996094
time for parepare:  0.001676797866821289
local_output_nid generation:  0.0011570453643798828
local_in_edges_tensor generation:  0.0023283958435058594
mini_batch_src_global generation:  0.002314329147338867
r_  generation:  0.023991823196411133
local_output_nid generation:  0.0009758472442626953
local_in_edges_tensor generation:  0.002013683319091797
mini_batch_src_global generation:  0.0024750232696533203
r_  generation:  0.022324562072753906
----------------------check_connections_block total spend ----------------------------- 0.0698695182800293
generate_one_block  0.029203176498413086
generate_one_block  0.028324604034423828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018231868743896484
gen group dst list time:  0.0007123947143554688
time for parepare:  0.0016772747039794922
local_output_nid generation:  0.001491546630859375
local_in_edges_tensor generation:  0.002597808837890625
mini_batch_src_global generation:  0.002129077911376953
r_  generation:  0.026111602783203125
local_output_nid generation:  0.0014472007751464844
local_in_edges_tensor generation:  0.00250244140625
mini_batch_src_global generation:  0.002702474594116211
r_  generation:  0.02536940574645996
----------------------check_connections_block total spend ----------------------------- 0.07753324508666992
generate_one_block  0.031877994537353516
generate_one_block  0.03204083442687988
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008460521697998047  GigaBytes
Max Memory Allocated: 0.008460521697998047  GigaBytes

connection checking time:  0.2194538116455078
block generation total time  0.17618012428283691
average batch blocks generation time:  0.08809006214141846
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1405029296875 GB
    Memory Allocated: 0.046222686767578125  GigaBytes
Max Memory Allocated: 0.046222686767578125  GigaBytes

torch.Size([19376, 500])
torch.Size([18227, 64])
torch.Size([14747, 64])
torch.Size([6020, 64])
torch.Size([1531, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 3.034928321838379  GigaBytes
Max Memory Allocated: 3.0350022315979004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3787841796875 GB
    Memory Allocated: 0.05469083786010742  GigaBytes
Max Memory Allocated: 3.035118579864502  GigaBytes

torch.Size([19150, 500])
torch.Size([17020, 64])
torch.Size([12717, 64])
torch.Size([4504, 64])
torch.Size([1241, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4315185546875 GB
    Memory Allocated: 2.9331250190734863  GigaBytes
Max Memory Allocated: 3.035118579864502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024530649185180664 |0.17393505573272705 |0.6488302946090698 |0.00021374225616455078 |0.5090444087982178 |0.011779546737670898 |
----------------------------------------------------------pseudo_mini_loss sum 1.694124460220337
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  114889
Number of first layer input nodes during this epoch:  38526
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.4315185546875 GB
    Memory Allocated: 0.07494735717773438  GigaBytes
Max Memory Allocated: 3.035118579864502  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.000545501708984375
random selection method range initialization spend 0.000125885009765625
time for parepare:  5.459785461425781e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011897087097167969Using backend: pytorch

mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  6.079673767089844e-05
----------------------check_connections_block total spend ----------------------------- 0.0008130073547363281
generate_one_block  0.0012521743774414062
generate_one_block  0.0011432170867919922
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005619525909423828
gen group dst list time:  2.9087066650390625e-05
time for parepare:  0.0002455711364746094
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  9.107589721679688e-05
r_  generation:  0.0007381439208984375
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.0005705356597900391
----------------------check_connections_block total spend ----------------------------- 0.0024924278259277344
generate_one_block  0.0021910667419433594
generate_one_block  0.0019190311431884766
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010235309600830078
gen group dst list time:  6.914138793945312e-05
time for parepare:  0.0007469654083251953
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.00042939186096191406
mini_batch_src_global generation:  0.000415802001953125
r_  generation:  0.004628419876098633
local_output_nid generation:  0.00011134147644042969
local_in_edges_tensor generation:  0.000293731689453125
mini_batch_src_global generation:  0.00042939186096191406
r_  generation:  0.003699779510498047
----------------------check_connections_block total spend ----------------------------- 0.013010025024414062
generate_one_block  0.008087158203125
generate_one_block  0.006046295166015625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020203590393066406
gen group dst list time:  0.00020647048950195312
time for parepare:  0.0013427734375
local_output_nid generation:  0.00044727325439453125
local_in_edges_tensor generation:  0.0012989044189453125
mini_batch_src_global generation:  0.0013344287872314453
r_  generation:  0.015452384948730469
local_output_nid generation:  0.0004324913024902344
local_in_edges_tensor generation:  0.0007963180541992188
mini_batch_src_global generation:  0.0015048980712890625
r_  generation:  0.013439655303955078
----------------------check_connections_block total spend ----------------------------- 0.0443115234375
generate_one_block  0.022934913635253906
generate_one_block  0.02022242546081543
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018529891967773438
gen group dst list time:  0.0005147457122802734
time for parepare:  0.001477956771850586
local_output_nid generation:  0.001157522201538086
local_in_edges_tensor generation:  0.002332925796508789
mini_batch_src_global generation:  0.002084016799926758
r_  generation:  0.025415897369384766
local_output_nid generation:  0.0011327266693115234
local_in_edges_tensor generation:  0.002274751663208008
mini_batch_src_global generation:  0.002624034881591797
r_  generation:  0.022913217544555664
----------------------check_connections_block total spend ----------------------------- 0.07220268249511719
generate_one_block  0.03358173370361328
generate_one_block  0.03248429298400879
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018050670623779297
gen group dst list time:  0.0008873939514160156
time for parepare:  0.001644134521484375
local_output_nid generation:  0.0015385150909423828
local_in_edges_tensor generation:  0.0029582977294921875
mini_batch_src_global generation:  0.002279520034790039
r_  generation:  0.026596546173095703
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0025365352630615234
mini_batch_src_global generation:  0.0027022361755371094
r_  generation:  0.02623772621154785
----------------------check_connections_block total spend ----------------------------- 0.07978677749633789
generate_one_block  0.03640127182006836
generate_one_block  0.03428459167480469
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.4315185546875 GB
    Memory Allocated: 0.07494735717773438  GigaBytes
Max Memory Allocated: 3.035118579864502  GigaBytes

connection checking time:  0.21180343627929688
block generation total time  0.19815278053283691
average batch blocks generation time:  0.09907639026641846
block dataloader generation time/epoch 0.4669661521911621
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4315185546875 GB
    Memory Allocated: 0.07370710372924805  GigaBytes
Max Memory Allocated: 3.035118579864502  GigaBytes

torch.Size([19406, 500])
torch.Size([18238, 64])
torch.Size([14705, 64])
torch.Size([5820, 64])
torch.Size([1545, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4432373046875 GB
    Memory Allocated: 3.070814609527588  GigaBytes
Max Memory Allocated: 3.070887565612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 0.0723109245300293  GigaBytes
Max Memory Allocated: 3.0710058212280273  GigaBytes

torch.Size([19228, 500])
torch.Size([17648, 64])
torch.Size([13235, 64])
torch.Size([5019, 64])
torch.Size([1244, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 2.9882431030273438  GigaBytes
Max Memory Allocated: 3.0710058212280273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024157285690307617 |0.0033216476440429688 |0.39253854751586914 |0.00016701221466064453 |0.5261025428771973 |0.011558055877685547 |
----------------------------------------------------------pseudo_mini_loss sum 1.5923482179641724
Total (block generation + training)time/epoch 2.381183385848999
Training time/epoch 1.9135475158691406
Training time without block to device /epoch 1.9069042205810547
Training time without total dataloading part /epoch 1.8491742610931396
load block tensor time/epoch 0.048314571380615234
block to device time/epoch 0.0066432952880859375
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  116445
Number of first layer input nodes during this epoch:  38634
