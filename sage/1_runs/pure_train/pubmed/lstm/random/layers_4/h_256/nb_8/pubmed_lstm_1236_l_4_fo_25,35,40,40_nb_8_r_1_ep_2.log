main start at this time 1648531245.6890988
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0447998046875 GB
    Memory Allocated: 0.015297412872314453  GigaBytes
Max Memory Allocated: 0.015297412872314453  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.002208709716796875
random selection method range initialization spend 0.00017833709716796875
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.001477956771850586
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.1696090698242188e-05
----------------------check_connections_block total spend ----------------------------- 0.002531290054321289
generate_one_block  0.0014142990112304688
generate_one_block  0.001088857650756836
generate_one_block  0.0010461807250976562
generate_one_block  0.001020193099975586
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012128353118896484
gen group dst list time:  3.647804260253906e-05
time for parepare:  0.0002429485321044922
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.0004115104675292969
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.00035953521728515625
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0004165172576904297
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00014281272888183594
----------------------check_connections_block total spend ----------------------------- 0.0028336048126220703
generate_one_block  0.001592397689819336
generate_one_block  0.0014960765838623047
generate_one_block  0.0015642642974853516
generate_one_block  0.0012409687042236328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001138448715209961
gen group dst list time:  7.128715515136719e-05
time for parepare:  0.0007696151733398438
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.0003333091735839844
mini_batch_src_global generation:  0.00020599365234375
r_  generation:  0.0023429393768310547
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  0.00034356117248535156
r_  generation:  0.0025191307067871094
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.000255584716796875
mini_batch_src_global generation:  0.00030159950256347656
r_  generation:  0.002753734588623047
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.0007922649383544922
----------------------check_connections_block total spend ----------------------------- 0.013769388198852539
generate_one_block  0.004096508026123047
generate_one_block  0.00414729118347168
generate_one_block  0.00431513786315918
generate_one_block  0.0017712116241455078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021245479583740234
gen group dst list time:  0.0002307891845703125
time for parepare:  0.0015223026275634766
local_output_nid generation:  0.00025963783264160156
local_in_edges_tensor generation:  0.0008823871612548828
mini_batch_src_global generation:  0.0010466575622558594
r_  generation:  0.008834600448608398
local_output_nid generation:  0.0003495216369628906
local_in_edges_tensor generation:  0.0007488727569580078
mini_batch_src_global generation:  0.0012307167053222656
r_  generation:  0.011342287063598633
local_output_nid generation:  0.00029206275939941406
local_in_edges_tensor generation:  0.0006163120269775391
mini_batch_src_global generation:  0.0008108615875244141
r_  generation:  0.010151147842407227
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.0003116130828857422
mini_batch_src_global generation:  0.0005636215209960938
r_  generation:  0.004317283630371094
----------------------check_connections_block total spend ----------------------------- 0.05184197425842285
generate_one_block  0.012296438217163086
generate_one_block  0.014891862869262695
generate_one_block  0.01464533805847168
generate_one_block  0.006982088088989258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0447998046875 GB
    Memory Allocated: 0.015297412872314453  GigaBytes
Max Memory Allocated: 0.015297412872314453  GigaBytes

connection checking time:  0.06844496726989746
block generation total time  0.06903958320617676
average batch blocks generation time:  0.01725989580154419
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1287841796875 GB
    Memory Allocated: 0.03394269943237305  GigaBytes
Max Memory Allocated: 0.03394269943237305  GigaBytes

torch.Size([9850, 500])
torch.Size([3408, 256])
torch.Size([803, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3416748046875 GB
    Memory Allocated: 1.0664825439453125  GigaBytes
Max Memory Allocated: 1.066627025604248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 0.054076194763183594  GigaBytes
Max Memory Allocated: 1.071554183959961  GigaBytes

torch.Size([12415, 500])
torch.Size([4389, 256])
torch.Size([828, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6112060546875 GB
    Memory Allocated: 1.343613624572754  GigaBytes
Max Memory Allocated: 1.3437385559082031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.05194711685180664  GigaBytes
Max Memory Allocated: 1.347404956817627  GigaBytes

torch.Size([11286, 500])
torch.Size([3501, 256])
torch.Size([923, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6541748046875 GB
    Memory Allocated: 1.2087697982788086  GigaBytes
Max Memory Allocated: 1.347404956817627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.042922019958496094  GigaBytes
Max Memory Allocated: 1.347404956817627  GigaBytes

torch.Size([6549, 500])
torch.Size([1278, 256])
torch.Size([320, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.5170083045959473  GigaBytes
Max Memory Allocated: 1.347404956817627  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009059667587280273 |0.08664840459823608 |0.30751699209213257 |0.00015598535537719727 |0.22799921035766602 |0.011047840118408203 |
----------------------------------------------------------pseudo_mini_loss sum 1.8419733047485352
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  55907
Number of first layer input nodes during this epoch:  40100
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.0736703872680664  GigaBytes
Max Memory Allocated: 1.347404956817627  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005338191986083984
random selection method range initialization spend 0.0001289844512939453
time for parepare:  5.698204040527344e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  6.651878356933594e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  4.673004150390625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  2.4318695068359375e-05
----------------------check_connections_block total spend ----------------------------- 0.00112152099609375
generate_one_block  0.0015130043029785156
generate_one_block  0.0011529922485351562
generate_one_block  0.001096487045288086
generate_one_block  0.0010635852813720703
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005655288696289062
gen group dst list time:  3.719329833984375e-05
time for parepare:  0.0002682209014892578
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0005578994750976562
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.00037169456481933594
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00019884109497070312
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002002716064453125
----------------------check_connections_block total spend ----------------------------- 0.0029778480529785156
generate_one_block  0.0019118785858154297
generate_one_block  0.0015380382537841797
generate_one_block  0.0014715194702148438
generate_one_block  0.0013384819030761719
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010585784912109375
gen group dst list time:  8.749961853027344e-05
time for parepare:  0.0007138252258300781
local_output_nid generation:  0.00012731552124023438
local_in_edges_tensor generation:  0.000385284423828125
mini_batch_src_global generation:  0.0003986358642578125
r_  generation:  0.0038251876831054688
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  0.0002968311309814453
r_  generation:  0.001965761184692383
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.00015020370483398438
r_  generation:  0.0011436939239501953
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  0.0001251697540283203
r_  generation:  0.0011341571807861328
----------------------check_connections_block total spend ----------------------------- 0.013469696044921875
generate_one_block  0.006321907043457031
generate_one_block  0.003404855728149414
generate_one_block  0.0023691654205322266
generate_one_block  0.002325773239135742
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020079612731933594
gen group dst list time:  0.00022864341735839844
time for parepare:  0.0014450550079345703
local_output_nid generation:  0.0004246234893798828
local_in_edges_tensor generation:  0.0010800361633300781
mini_batch_src_global generation:  0.001331329345703125
r_  generation:  0.012704849243164062
local_output_nid generation:  0.000270843505859375
local_in_edges_tensor generation:  0.0005774497985839844
mini_batch_src_global generation:  0.0010194778442382812
r_  generation:  0.007326602935791016
local_output_nid generation:  0.0002162456512451172
local_in_edges_tensor generation:  0.0004444122314453125
mini_batch_src_global generation:  0.0006244182586669922
r_  generation:  0.005531787872314453
local_output_nid generation:  0.0012445449829101562
local_in_edges_tensor generation:  0.0003857612609863281
mini_batch_src_global generation:  0.0005173683166503906
r_  generation:  0.005362272262573242
----------------------check_connections_block total spend ----------------------------- 0.048218488693237305
generate_one_block  0.017945528030395508
generate_one_block  0.011833667755126953
generate_one_block  0.00935053825378418
generate_one_block  0.008797883987426758
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.0736703872680664  GigaBytes
Max Memory Allocated: 1.347404956817627  GigaBytes

connection checking time:  0.0646660327911377
block generation total time  0.06860923767089844
average batch blocks generation time:  0.01715230941772461
block dataloader generation time/epoch 0.18280625343322754
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.08537149429321289  GigaBytes
Max Memory Allocated: 1.347404956817627  GigaBytes

torch.Size([12761, 500])
torch.Size([5011, 256])
torch.Size([1132, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.5709524154663086  GigaBytes
Max Memory Allocated: 1.5711278915405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.07950735092163086  GigaBytes
Max Memory Allocated: 1.5746984481811523  GigaBytes

torch.Size([9715, 500])
torch.Size([2917, 256])
torch.Size([697, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.9253149032592773  GigaBytes
Max Memory Allocated: 1.5746984481811523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.07584190368652344  GigaBytes
Max Memory Allocated: 1.5746984481811523  GigaBytes

torch.Size([7779, 500])
torch.Size([1893, 256])
torch.Size([451, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.723994255065918  GigaBytes
Max Memory Allocated: 1.5746984481811523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.0763392448425293  GigaBytes
Max Memory Allocated: 1.5746984481811523  GigaBytes

torch.Size([8049, 500])
torch.Size([1816, 256])
torch.Size([492, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.7009553909301758  GigaBytes
Max Memory Allocated: 1.5746984481811523  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01355278491973877 |0.0017005205154418945 |0.17977982759475708 |0.00013720989227294922 |0.23232370615005493 |0.008987188339233398 |
----------------------------------------------------------pseudo_mini_loss sum 3.3882930278778076
Total (block generation + training)time/epoch 1.9106721878051758
Training time/epoch 1.7276115417480469
Training time without block to device /epoch 1.7208094596862793
Training time without total dataloading part /epoch 1.6579501628875732
load block tensor time/epoch 0.05421113967895508
block to device time/epoch 0.006802082061767578
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  53069
Number of first layer input nodes during this epoch:  38304
