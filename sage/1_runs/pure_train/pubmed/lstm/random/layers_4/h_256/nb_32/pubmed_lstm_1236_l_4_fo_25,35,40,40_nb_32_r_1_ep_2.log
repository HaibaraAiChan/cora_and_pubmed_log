main start at this time 1648531275.1717963
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0447998046875 GB
    Memory Allocated: 0.015297412872314453  GigaBytes
Max Memory Allocated: 0.015297412872314453  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011839866638183594
random selection method range initialization spend 0.00019431114196777344
time for parepare:  5.412101745605469e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0013804435729980469
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.3589859008789062e-05
----------------------check_connections_block total spend ----------------------------- 0.0046291351318359375
generate_one_block  0.0014204978942871094
generate_one_block  0.0012581348419189453
generate_one_block  0.0012373924255371094
generate_one_block  0.0012161731719970703
generate_one_block  0.0012400150299072266
generate_one_block  0.0012230873107910156
generate_one_block  0.0012538433074951172
generate_one_block  0.00102996826171875
generate_one_block  0.0010194778442382812
generate_one_block  0.0010509490966796875
generate_one_block  0.000997304916381836
generate_one_block  0.0010557174682617188
generate_one_block  0.0009398460388183594
generate_one_block  0.0009331703186035156
generate_one_block  0.000985860824584961
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007619857788085938
gen group dst list time:  0.00010704994201660156
time for parepare:  0.0003142356872558594
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  8.392333984375e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00027871131896972656
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.0001266002655029297
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.14984130859375e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00012302398681640625
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  9.703636169433594e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0001933574676513672
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  9.775161743164062e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0003447532653808594
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.14984130859375e-05
----------------------check_connections_block total spend ----------------------------- 0.005422353744506836
generate_one_block  0.0013086795806884766
generate_one_block  0.0016245841979980469
generate_one_block  0.0013885498046875
generate_one_block  0.0012664794921875
generate_one_block  0.0013644695281982422
generate_one_block  0.0013616085052490234
generate_one_block  0.0012514591217041016
generate_one_block  0.0010023117065429688
generate_one_block  0.0010318756103515625
generate_one_block  0.0013728141784667969
generate_one_block  0.0009870529174804688
generate_one_block  0.0009894371032714844
generate_one_block  0.0009980201721191406
generate_one_block  0.0011081695556640625
generate_one_block  0.0009837150573730469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011649131774902344
gen group dst list time:  0.00016188621520996094
time for parepare:  0.0009312629699707031
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0002224445343017578
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.0019807815551757812
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0005953311920166016
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.0002484321594238281
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0007658004760742188
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.0008461475372314453
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  0.00012946128845214844
r_  generation:  0.0012438297271728516
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.0005574226379394531
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0005865097045898438
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.0002465248107910156
mini_batch_src_global generation:  0.0002486705780029297
r_  generation:  0.002337217330932617
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.00021576881408691406
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00029850006103515625
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001392364501953125
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0002193450927734375
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00016880035400390625
----------------------check_connections_block total spend ----------------------------- 0.01889967918395996
generate_one_block  0.001211404800415039
generate_one_block  0.002971172332763672
generate_one_block  0.0014503002166748047
generate_one_block  0.0011620521545410156
generate_one_block  0.0018053054809570312
generate_one_block  0.0017993450164794922
generate_one_block  0.0021517276763916016
generate_one_block  0.0014424324035644531
generate_one_block  0.001463174819946289
generate_one_block  0.003475189208984375
generate_one_block  0.00115203857421875
generate_one_block  0.0012621879577636719
generate_one_block  0.0013592243194580078
generate_one_block  0.0011870861053466797
generate_one_block  0.0011286735534667969
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020668506622314453
gen group dst list time:  0.0004088878631591797
time for parepare:  0.001935720443725586
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0004391670227050781
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.0009102821350097656
local_output_nid generation:  0.00019431114196777344
local_in_edges_tensor generation:  0.0004508495330810547
mini_batch_src_global generation:  0.0007879734039306641
r_  generation:  0.006532907485961914
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.00023746490478515625
mini_batch_src_global generation:  0.00032067298889160156
r_  generation:  0.002149820327758789
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00013589859008789062
r_  generation:  0.0010082721710205078
local_output_nid generation:  0.00011277198791503906
local_in_edges_tensor generation:  0.0002961158752441406
mini_batch_src_global generation:  0.0002968311309814453
r_  generation:  0.0036482810974121094
local_output_nid generation:  0.00013375282287597656
local_in_edges_tensor generation:  0.0003247261047363281
mini_batch_src_global generation:  0.0004591941833496094
r_  generation:  0.004199504852294922
local_output_nid generation:  0.0001583099365234375
local_in_edges_tensor generation:  0.0003437995910644531
mini_batch_src_global generation:  0.0004904270172119141
r_  generation:  0.0050089359283447266
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  0.00032901763916015625
r_  generation:  0.0026276111602783203
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.0002493858337402344
r_  generation:  0.002299070358276367
local_output_nid generation:  0.00021195411682128906
local_in_edges_tensor generation:  0.0004410743713378906
mini_batch_src_global generation:  0.0007028579711914062
r_  generation:  0.0073795318603515625
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  0.00027751922607421875
r_  generation:  0.0010936260223388672
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  0.00015783309936523438
r_  generation:  0.0016477108001708984
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.0005319118499755859
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  0.00015735626220703125
r_  generation:  0.0016574859619140625
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  0.00014281272888183594
r_  generation:  0.0010683536529541016
----------------------check_connections_block total spend ----------------------------- 0.0647435188293457
generate_one_block  0.0021004676818847656
generate_one_block  0.0088348388671875
generate_one_block  0.003644227981567383
generate_one_block  0.002080678939819336
generate_one_block  0.0053708553314208984
generate_one_block  0.006743431091308594
generate_one_block  0.007729530334472656
generate_one_block  0.004361152648925781
generate_one_block  0.004332304000854492
generate_one_block  0.011217355728149414
generate_one_block  0.002227306365966797
generate_one_block  0.003134489059448242
generate_one_block  0.0015804767608642578
generate_one_block  0.0031867027282714844
generate_one_block  0.002332925796508789
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0447998046875 GB
    Memory Allocated: 0.015297412872314453  GigaBytes
Max Memory Allocated: 0.015297412872314453  GigaBytes

connection checking time:  0.0890655517578125
block generation total time  0.11193728446960449
average batch blocks generation time:  0.007462485631306966
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1092529296875 GB
    Memory Allocated: 0.017943859100341797  GigaBytes
Max Memory Allocated: 0.017943859100341797  GigaBytes

torch.Size([1407, 500])
torch.Size([302, 256])
torch.Size([88, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.09691047668457031  GigaBytes
Max Memory Allocated: 0.09694719314575195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.04312324523925781  GigaBytes
Max Memory Allocated: 0.10829734802246094  GigaBytes

torch.Size([6613, 500])
torch.Size([2247, 256])
torch.Size([456, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7894001007080078  GigaBytes
Max Memory Allocated: 0.7894673347473145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.03725576400756836  GigaBytes
Max Memory Allocated: 0.793245792388916  GigaBytes

torch.Size([3545, 500])
torch.Size([790, 256])
torch.Size([210, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.25278234481811523  GigaBytes
Max Memory Allocated: 0.793245792388916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.03434467315673828  GigaBytes
Max Memory Allocated: 0.793245792388916  GigaBytes

torch.Size([1621, 500])
torch.Size([355, 256])
torch.Size([74, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.1329960823059082  GigaBytes
Max Memory Allocated: 0.793245792388916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.03815650939941406  GigaBytes
Max Memory Allocated: 0.793245792388916  GigaBytes

torch.Size([4002, 500])
torch.Size([1264, 256])
torch.Size([176, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.44238758087158203  GigaBytes
Max Memory Allocated: 0.793245792388916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.043239593505859375  GigaBytes
Max Memory Allocated: 0.793245792388916  GigaBytes

torch.Size([6718, 500])
torch.Size([1630, 256])
torch.Size([197, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.5362253189086914  GigaBytes
Max Memory Allocated: 0.793245792388916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.045914649963378906  GigaBytes
Max Memory Allocated: 0.793245792388916  GigaBytes

torch.Size([8139, 500])
torch.Size([1814, 256])
torch.Size([373, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.6313266754150391  GigaBytes
Max Memory Allocated: 0.793245792388916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.036448001861572266  GigaBytes
Max Memory Allocated: 0.793245792388916  GigaBytes

torch.Size([3099, 500])
torch.Size([760, 256])
torch.Size([120, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.3408503532409668  GigaBytes
Max Memory Allocated: 0.793245792388916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.038163185119628906  GigaBytes
Max Memory Allocated: 0.793245792388916  GigaBytes

torch.Size([4025, 500])
torch.Size([761, 256])
torch.Size([193, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.30411815643310547  GigaBytes
Max Memory Allocated: 0.793245792388916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.04800271987915039  GigaBytes
Max Memory Allocated: 0.793245792388916  GigaBytes

torch.Size([9201, 500])
torch.Size([2747, 256])
torch.Size([629, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.991663932800293  GigaBytes
Max Memory Allocated: 0.9917969703674316  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.03470134735107422  GigaBytes
Max Memory Allocated: 0.9955000877380371  GigaBytes

torch.Size([2191, 500])
torch.Size([330, 256])
torch.Size([77, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.14006662368774414  GigaBytes
Max Memory Allocated: 0.9955000877380371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.036501407623291016  GigaBytes
Max Memory Allocated: 0.9955000877380371  GigaBytes

torch.Size([3145, 500])
torch.Size([507, 256])
torch.Size([97, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.22476768493652344  GigaBytes
Max Memory Allocated: 0.9955000877380371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.03322887420654297  GigaBytes
Max Memory Allocated: 0.9955000877380371  GigaBytes

torch.Size([1089, 500])
torch.Size([184, 256])
torch.Size([74, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.08977842330932617  GigaBytes
Max Memory Allocated: 0.9955000877380371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.03638029098510742  GigaBytes
Max Memory Allocated: 0.9955000877380371  GigaBytes

torch.Size([2732, 500])
torch.Size([412, 256])
torch.Size([65, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.23928499221801758  GigaBytes
Max Memory Allocated: 0.9955000877380371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.035411834716796875  GigaBytes
Max Memory Allocated: 0.9955000877380371  GigaBytes

torch.Size([2571, 500])
torch.Size([332, 256])
torch.Size([93, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.15264415740966797  GigaBytes
Max Memory Allocated: 0.9955000877380371  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004990577697753906 |0.02392868995666504 |0.1573719024658203 |0.00012984275817871094 |0.16238238016764323 |0.013275384902954102 |
----------------------------------------------------------pseudo_mini_loss sum 2.208723306655884
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  77812
Number of first layer input nodes during this epoch:  60098
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.06603622436523438  GigaBytes
Max Memory Allocated: 0.9955000877380371  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005686283111572266
random selection method range initialization spend 0.00015211105346679688
time for parepare:  7.081031799316406e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.2874603271484375e-05
----------------------check_connections_block total spend ----------------------------- 0.002937793731689453
generate_one_block  0.0011909008026123047
generate_one_block  0.0010783672332763672
generate_one_block  0.0010569095611572266
generate_one_block  0.0010683536529541016
generate_one_block  0.0010428428649902344
generate_one_block  0.001051187515258789
generate_one_block  0.001216888427734375
generate_one_block  0.0010578632354736328
generate_one_block  0.0010409355163574219
generate_one_block  0.0010499954223632812
generate_one_block  0.0010333061218261719
generate_one_block  0.0010371208190917969
generate_one_block  0.0010378360748291016
generate_one_block  0.0010297298431396484
generate_one_block  0.0010023117065429688
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006506443023681641
gen group dst list time:  8.940696716308594e-05
time for parepare:  0.0003256797790527344
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0003139972686767578
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0002079010009765625
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.508827209472656e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0001392364501953125
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.127357482910156e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.128715515136719e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0002040863037109375
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.581710815429688e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  7.796287536621094e-05
----------------------check_connections_block total spend ----------------------------- 0.005202531814575195
generate_one_block  0.0015556812286376953
generate_one_block  0.0013000965118408203
generate_one_block  0.0011212825775146484
generate_one_block  0.0012907981872558594
generate_one_block  0.001100778579711914
generate_one_block  0.0011341571807861328
generate_one_block  0.0013179779052734375
generate_one_block  0.0010695457458496094
generate_one_block  0.0010554790496826172
generate_one_block  0.0010647773742675781
generate_one_block  0.000993490219116211
generate_one_block  0.0010845661163330078
generate_one_block  0.0010409355163574219
generate_one_block  0.00101470947265625
generate_one_block  0.0010519027709960938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012154579162597656
gen group dst list time:  0.0001399517059326172
time for parepare:  0.0009241104125976562
local_output_nid generation:  8.416175842285156e-05
local_in_edges_tensor generation:  0.00046706199645996094
mini_batch_src_global generation:  0.0003330707550048828
r_  generation:  0.0024552345275878906
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  0.00022912025451660156
r_  generation:  0.001561880111694336
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.00020742416381835938
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0006651878356933594
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0003323554992675781
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.00047707557678222656
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0011441707611083984
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.00034880638122558594
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00031447410583496094
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00035309791564941406
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.00030350685119628906
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0004544258117675781
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00026988983154296875
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.0002040863037109375
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.00044083595275878906
----------------------check_connections_block total spend ----------------------------- 0.01803874969482422
generate_one_block  0.0043048858642578125
generate_one_block  0.0030024051666259766
generate_one_block  0.0011966228485107422
generate_one_block  0.0017910003662109375
generate_one_block  0.00136566162109375
generate_one_block  0.0015375614166259766
generate_one_block  0.002371549606323242
generate_one_block  0.0013725757598876953
generate_one_block  0.0013432502746582031
generate_one_block  0.0013637542724609375
generate_one_block  0.0013620853424072266
generate_one_block  0.0014786720275878906
generate_one_block  0.0012772083282470703
generate_one_block  0.0011942386627197266
generate_one_block  0.0015423297882080078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019435882568359375
gen group dst list time:  0.00037670135498046875
time for parepare:  0.00164794921875
local_output_nid generation:  0.0004451274871826172
local_in_edges_tensor generation:  0.0012793540954589844
mini_batch_src_global generation:  0.0011286735534667969
r_  generation:  0.010007381439208984
local_output_nid generation:  0.00021386146545410156
local_in_edges_tensor generation:  0.0004703998565673828
mini_batch_src_global generation:  0.0008609294891357422
r_  generation:  0.006244659423828125
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.00023555755615234375
r_  generation:  0.0010504722595214844
local_output_nid generation:  0.00011658668518066406
local_in_edges_tensor generation:  0.00026535987854003906
mini_batch_src_global generation:  0.00020766258239746094
r_  generation:  0.0024776458740234375
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  0.0001800060272216797
r_  generation:  0.001506805419921875
local_output_nid generation:  8.821487426757812e-05
local_in_edges_tensor generation:  0.00024628639221191406
mini_batch_src_global generation:  0.00023031234741210938
r_  generation:  0.0024535655975341797
local_output_nid generation:  0.00018072128295898438
local_in_edges_tensor generation:  0.0003769397735595703
mini_batch_src_global generation:  0.0003809928894042969
r_  generation:  0.004227876663208008
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.0002484321594238281
r_  generation:  0.0017786026000976562
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.0002224445343017578
mini_batch_src_global generation:  0.0002281665802001953
r_  generation:  0.0021581649780273438
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0013737678527832031
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  0.00022339820861816406
r_  generation:  0.0020859241485595703
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.00023627281188964844
mini_batch_src_global generation:  0.00027251243591308594
r_  generation:  0.0025491714477539062
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  0.0002205371856689453
r_  generation:  0.0016846656799316406
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00016045570373535156
r_  generation:  0.0008258819580078125
local_output_nid generation:  8.177757263183594e-05
local_in_edges_tensor generation:  0.0002536773681640625
mini_batch_src_global generation:  0.0002155303955078125
r_  generation:  0.0023157596588134766
----------------------check_connections_block total spend ----------------------------- 0.06722140312194824
generate_one_block  0.014555931091308594
generate_one_block  0.009482145309448242
generate_one_block  0.0026702880859375
generate_one_block  0.0047724246978759766
generate_one_block  0.003231525421142578
generate_one_block  0.004762887954711914
generate_one_block  0.006864070892333984
generate_one_block  0.0032835006713867188
generate_one_block  0.004057645797729492
generate_one_block  0.0030069351196289062
generate_one_block  0.0038890838623046875
generate_one_block  0.005146503448486328
generate_one_block  0.003297567367553711
generate_one_block  0.001981496810913086
generate_one_block  0.004074811935424805
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.06603622436523438  GigaBytes
Max Memory Allocated: 0.9955000877380371  GigaBytes

connection checking time:  0.09046268463134766
block generation total time  0.11877679824829102
average batch blocks generation time:  0.007918453216552735
block dataloader generation time/epoch 0.3285245895385742
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.08207225799560547  GigaBytes
Max Memory Allocated: 0.9955000877380371  GigaBytes

torch.Size([11047, 500])
torch.Size([3379, 256])
torch.Size([650, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 1.2203102111816406  GigaBytes
Max Memory Allocated: 1.220442771911621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.07202672958374023  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

torch.Size([5723, 500])
torch.Size([1985, 256])
torch.Size([358, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.7518320083618164  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.06598949432373047  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

torch.Size([2172, 500])
torch.Size([317, 256])
torch.Size([94, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.16985702514648438  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.068084716796875  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

torch.Size([3668, 500])
torch.Size([1108, 256])
torch.Size([202, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.35380983352661133  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.06600570678710938  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

torch.Size([2282, 500])
torch.Size([590, 256])
torch.Size([76, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.2295389175415039  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.06829118728637695  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

torch.Size([3780, 500])
torch.Size([781, 256])
torch.Size([138, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.3479008674621582  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.07336759567260742  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

torch.Size([6473, 500])
torch.Size([1737, 256])
torch.Size([427, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.565007209777832  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.0669255256652832  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

torch.Size([3061, 500])
torch.Size([616, 256])
torch.Size([121, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.2535529136657715  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.06777667999267578  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

torch.Size([3510, 500])
torch.Size([580, 256])
torch.Size([89, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.3179192543029785  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.06621360778808594  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

torch.Size([2683, 500])
torch.Size([483, 256])
torch.Size([157, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.21904516220092773  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.06777477264404297  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

torch.Size([3054, 500])
torch.Size([574, 256])
torch.Size([83, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.30988454818725586  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.06981754302978516  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

torch.Size([4598, 500])
torch.Size([723, 256])
torch.Size([165, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.3662376403808594  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.06654787063598633  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

torch.Size([2860, 500])
torch.Size([447, 256])
torch.Size([101, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.2420024871826172  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.06476068496704102  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

torch.Size([1458, 500])
torch.Size([283, 256])
torch.Size([95, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.14513731002807617  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.06799125671386719  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

torch.Size([3625, 500])
torch.Size([681, 256])
torch.Size([165, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4920654296875 GB
    Memory Allocated: 0.30765628814697266  GigaBytes
Max Memory Allocated: 1.2241458892822266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005456240971883138 |0.001435995101928711 |0.12933273315429689 |0.0001232624053955078 |0.1647449811299642 |0.008780956268310547 |
----------------------------------------------------------pseudo_mini_loss sum 3.7303526401519775
Total (block generation + training)time/epoch 4.88431191444397
Training time/epoch 4.5554726123809814
Training time without block to device /epoch 4.533932685852051
Training time without total dataloading part /epoch 4.421795606613159
load block tensor time/epoch 0.08184361457824707
block to device time/epoch 0.021539926528930664
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  77556
Number of first layer input nodes during this epoch:  59994
