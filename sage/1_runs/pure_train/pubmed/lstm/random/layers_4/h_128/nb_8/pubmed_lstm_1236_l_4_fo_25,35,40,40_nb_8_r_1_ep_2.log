main start at this time 1648531173.3641555
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.009673595428466797  GigaBytes
Max Memory Allocated: 0.009673595428466797  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0009844303131103516
random selection method range initialization spend 0.00020003318786621094
time for parepare:  5.364418029785156e-05
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0014171600341796875
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  6.341934204101562e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.1484832763671875e-05
----------------------check_connections_block total spend ----------------------------- 0.0026273727416992188
generate_one_block  0.0015416145324707031
generate_one_block  0.0013377666473388672
generate_one_block  0.001262664794921875
generate_one_block  0.0012743473052978516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007262229919433594
gen group dst list time:  4.315376281738281e-05
time for parepare:  0.00029778480529785156
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0004222393035888672
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0005424022674560547
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00026726722717285156
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0003037452697753906
----------------------check_connections_block total spend ----------------------------- 0.003306865692138672
generate_one_block  0.0018160343170166016
generate_one_block  0.002012014389038086
generate_one_block  0.0015749931335449219
generate_one_block  0.0016551017761230469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012400150299072266
gen group dst list time:  9.226799011230469e-05
time for parepare:  0.0009396076202392578
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.00035190582275390625
mini_batch_src_global generation:  0.0002551078796386719
r_  generation:  0.002851247787475586
local_output_nid generation:  0.00010728836059570312
local_in_edges_tensor generation:  0.0003151893615722656
mini_batch_src_global generation:  0.0004589557647705078
r_  generation:  0.0040209293365478516
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.00023317337036132812
mini_batch_src_global generation:  0.00023555755615234375
r_  generation:  0.0017900466918945312
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.00016546249389648438
r_  generation:  0.0013680458068847656
----------------------check_connections_block total spend ----------------------------- 0.016231298446655273
generate_one_block  0.004126071929931641
generate_one_block  0.005229473114013672
generate_one_block  0.002707958221435547
generate_one_block  0.0022869110107421875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019042491912841797
gen group dst list time:  0.00029850006103515625
time for parepare:  0.00173187255859375
local_output_nid generation:  0.00034737586975097656
local_in_edges_tensor generation:  0.0008826255798339844
mini_batch_src_global generation:  0.0012240409851074219
r_  generation:  0.010092735290527344
local_output_nid generation:  0.00038695335388183594
local_in_edges_tensor generation:  0.0007660388946533203
mini_batch_src_global generation:  0.0016188621520996094
r_  generation:  0.013711214065551758
local_output_nid generation:  0.00021386146545410156
local_in_edges_tensor generation:  0.0004687309265136719
mini_batch_src_global generation:  0.0007677078247070312
r_  generation:  0.006850242614746094
local_output_nid generation:  0.00016951560974121094
local_in_edges_tensor generation:  0.00038170814514160156
mini_batch_src_global generation:  0.0005588531494140625
r_  generation:  0.005034685134887695
----------------------check_connections_block total spend ----------------------------- 0.05463361740112305
generate_one_block  0.011442899703979492
generate_one_block  0.016440153121948242
generate_one_block  0.011664152145385742
generate_one_block  0.008592367172241211
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.009673595428466797  GigaBytes
Max Memory Allocated: 0.009673595428466797  GigaBytes

connection checking time:  0.07417178153991699
block generation total time  0.06954813003540039
average batch blocks generation time:  0.017387032508850098
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.02753925323486328  GigaBytes
Max Memory Allocated: 0.02753925323486328  GigaBytes

torch.Size([9383, 500])
torch.Size([3040, 128])
torch.Size([734, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.9367361068725586  GigaBytes
Max Memory Allocated: 0.936790943145752  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.043775081634521484  GigaBytes
Max Memory Allocated: 0.9376688003540039  GigaBytes

torch.Size([12892, 500])
torch.Size([4960, 128])
torch.Size([1081, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6795654296875 GB
    Memory Allocated: 1.391153335571289  GigaBytes
Max Memory Allocated: 1.3912315368652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.037609100341796875  GigaBytes
Max Memory Allocated: 1.3920631408691406  GigaBytes

torch.Size([9682, 500])
torch.Size([2473, 128])
torch.Size([535, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.8098502159118652  GigaBytes
Max Memory Allocated: 1.3920631408691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.03341484069824219  GigaBytes
Max Memory Allocated: 1.3920631408691406  GigaBytes

torch.Size([7462, 500])
torch.Size([1855, 128])
torch.Size([487, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.6044573783874512  GigaBytes
Max Memory Allocated: 1.3920631408691406  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00912618637084961 |0.08687949180603027 |0.3030862808227539 |0.00015038251876831055 |0.24097692966461182 |0.010323524475097656 |
----------------------------------------------------------pseudo_mini_loss sum 2.0749452114105225
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  54939
Number of first layer input nodes during this epoch:  39419
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.053125858306884766  GigaBytes
Max Memory Allocated: 1.3920631408691406  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005247592926025391
random selection method range initialization spend 0.0001285076141357422
time for parepare:  5.7220458984375e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.00543212890625e-05
----------------------check_connections_block total spend ----------------------------- 0.001100778579711914
generate_one_block  0.0013661384582519531
generate_one_block  0.0011255741119384766
generate_one_block  0.0011548995971679688
generate_one_block  0.0010941028594970703
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005769729614257812
gen group dst list time:  3.719329833984375e-05
time for parepare:  0.00026297569274902344
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0004239082336425781
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00025844573974609375
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.00038313865661621094
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00027751922607421875
----------------------check_connections_block total spend ----------------------------- 0.0029973983764648438
generate_one_block  0.0017213821411132812
generate_one_block  0.0013890266418457031
generate_one_block  0.0018029212951660156
generate_one_block  0.0014722347259521484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011050701141357422
gen group dst list time:  8.249282836914062e-05
time for parepare:  0.0007719993591308594
local_output_nid generation:  0.00010275840759277344
local_in_edges_tensor generation:  0.0003533363342285156
mini_batch_src_global generation:  0.00030112266540527344
r_  generation:  0.002857685089111328
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.00022220611572265625
r_  generation:  0.0016674995422363281
local_output_nid generation:  9.059906005859375e-05
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  0.0002396106719970703
r_  generation:  0.0026521682739257812
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.00019478797912597656
r_  generation:  0.0016663074493408203
----------------------check_connections_block total spend ----------------------------- 0.014200925827026367
generate_one_block  0.00502467155456543
generate_one_block  0.003251314163208008
generate_one_block  0.004361629486083984
generate_one_block  0.0029611587524414062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001783609390258789
gen group dst list time:  0.0002455711364746094
time for parepare:  0.0014653205871582031
local_output_nid generation:  0.000335693359375
local_in_edges_tensor generation:  0.0008952617645263672
mini_batch_src_global generation:  0.001028299331665039
r_  generation:  0.009574651718139648
local_output_nid generation:  0.00026416778564453125
local_in_edges_tensor generation:  0.0005443096160888672
mini_batch_src_global generation:  0.0009968280792236328
r_  generation:  0.0073468685150146484
local_output_nid generation:  0.0003147125244140625
local_in_edges_tensor generation:  0.0006365776062011719
mini_batch_src_global generation:  0.0010077953338623047
r_  generation:  0.01037740707397461
local_output_nid generation:  0.0002701282501220703
local_in_edges_tensor generation:  0.0005106925964355469
mini_batch_src_global generation:  0.0007793903350830078
r_  generation:  0.007016181945800781
----------------------check_connections_block total spend ----------------------------- 0.052173614501953125
generate_one_block  0.014563798904418945
generate_one_block  0.011895895004272461
generate_one_block  0.015566110610961914
generate_one_block  0.011402130126953125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.053125858306884766  GigaBytes
Max Memory Allocated: 1.3920631408691406  GigaBytes

connection checking time:  0.06937193870544434
block generation total time  0.07541227340698242
average batch blocks generation time:  0.018853068351745605
block dataloader generation time/epoch 0.1925196647644043
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.058689117431640625  GigaBytes
Max Memory Allocated: 1.3920631408691406  GigaBytes

torch.Size([10462, 500])
torch.Size([3346, 128])
torch.Size([861, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 1.0967011451721191  GigaBytes
Max Memory Allocated: 1.3920631408691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.05533027648925781  GigaBytes
Max Memory Allocated: 1.3920631408691406  GigaBytes

torch.Size([8734, 500])
torch.Size([2891, 128])
torch.Size([513, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.824310302734375  GigaBytes
Max Memory Allocated: 1.3920631408691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.06112527847290039  GigaBytes
Max Memory Allocated: 1.3920631408691406  GigaBytes

torch.Size([11790, 500])
torch.Size([3499, 128])
torch.Size([916, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 1.1395792961120605  GigaBytes
Max Memory Allocated: 1.3920631408691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.05551433563232422  GigaBytes
Max Memory Allocated: 1.3920631408691406  GigaBytes

torch.Size([8835, 500])
torch.Size([2786, 128])
torch.Size([587, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6815185546875 GB
    Memory Allocated: 0.814976692199707  GigaBytes
Max Memory Allocated: 1.3920631408691406  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007667720317840576 |0.0013564825057983398 |0.17377948760986328 |0.00013840198516845703 |0.24407273530960083 |0.01423335075378418 |
----------------------------------------------------------pseudo_mini_loss sum 2.055025815963745
Total (block generation + training)time/epoch 1.9246227741241455
Training time/epoch 1.7318265438079834
Training time without block to device /epoch 1.72640061378479
Training time without total dataloading part /epoch 1.6861958503723145
load block tensor time/epoch 0.030670881271362305
block to device time/epoch 0.005425930023193359
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  55577
Number of first layer input nodes during this epoch:  39821
