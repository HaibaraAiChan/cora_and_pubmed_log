main start at this time 1648531202.9147651
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.009673595428466797  GigaBytes
Max Memory Allocated: 0.009673595428466797  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0021924972534179688
random selection method range initialization spend 0.0002338886260986328
time for parepare:  4.4345855712890625e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.0025033950805664062
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.7738037109375e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5497207641601562e-05
----------------------check_connections_block total spend ----------------------------- 0.005198001861572266
generate_one_block  0.0013201236724853516
generate_one_block  0.0009999275207519531
generate_one_block  0.0009765625
generate_one_block  0.0010223388671875
generate_one_block  0.0010235309600830078
generate_one_block  0.0009899139404296875
generate_one_block  0.0010280609130859375
generate_one_block  0.0010426044464111328
generate_one_block  0.0009889602661132812
generate_one_block  0.000980377197265625
generate_one_block  0.0009753704071044922
generate_one_block  0.0009510517120361328
generate_one_block  0.0009367465972900391
generate_one_block  0.0009326934814453125
generate_one_block  0.0009949207305908203
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014390945434570312
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.00025177001953125
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0002982616424560547
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  0.00010824203491210938
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  0.00010561943054199219
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  9.1552734375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00019598007202148438
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  5.91278076171875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.00011372566223144531
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.034706115722656e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  9.298324584960938e-05
----------------------check_connections_block total spend ----------------------------- 0.00460362434387207
generate_one_block  0.001374959945678711
generate_one_block  0.0010843276977539062
generate_one_block  0.0010290145874023438
generate_one_block  0.0011506080627441406
generate_one_block  0.0011730194091796875
generate_one_block  0.0011146068572998047
generate_one_block  0.0011284351348876953
generate_one_block  0.001285552978515625
generate_one_block  0.001028299331665039
generate_one_block  0.0009758472442626953
generate_one_block  0.0011219978332519531
generate_one_block  0.0011088848114013672
generate_one_block  0.0010249614715576172
generate_one_block  0.0010068416595458984
generate_one_block  0.0011363029479980469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010919570922851562
gen group dst list time:  0.00012040138244628906
time for parepare:  0.0007386207580566406
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0003018379211425781
mini_batch_src_global generation:  0.0001704692840576172
r_  generation:  0.0018908977508544922
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  9.34600830078125e-05
r_  generation:  0.0003459453582763672
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00019550323486328125
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0007059574127197266
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0007817745208740234
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.0005192756652832031
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004367828369140625
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  0.00013208389282226562
r_  generation:  0.0014650821685791016
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.00034427642822265625
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00020051002502441406
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00040459632873535156
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.0005943775177001953
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0003445148468017578
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00015997886657714844
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0004935264587402344
----------------------check_connections_block total spend ----------------------------- 0.015867233276367188
generate_one_block  0.003389596939086914
generate_one_block  0.0013208389282226562
generate_one_block  0.0012102127075195312
generate_one_block  0.0017695426940917969
generate_one_block  0.0019817352294921875
generate_one_block  0.00164794921875
generate_one_block  0.0014164447784423828
generate_one_block  0.0027244091033935547
generate_one_block  0.001371145248413086
generate_one_block  0.0011570453643798828
generate_one_block  0.0014188289642333984
generate_one_block  0.0016057491302490234
generate_one_block  0.0016045570373535156
generate_one_block  0.0011069774627685547
generate_one_block  0.0015201568603515625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020444393157958984
gen group dst list time:  0.0003173351287841797
time for parepare:  0.001577138900756836
local_output_nid generation:  0.00020956993103027344
local_in_edges_tensor generation:  0.0007703304290771484
mini_batch_src_global generation:  0.000843048095703125
r_  generation:  0.006753683090209961
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  0.0003383159637451172
r_  generation:  0.0019047260284423828
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  0.0001251697540283203
r_  generation:  0.000997781753540039
local_output_nid generation:  0.00010347366333007812
local_in_edges_tensor generation:  0.0002956390380859375
mini_batch_src_global generation:  0.000293731689453125
r_  generation:  0.0036249160766601562
local_output_nid generation:  0.0001423358917236328
local_in_edges_tensor generation:  0.0003116130828857422
mini_batch_src_global generation:  0.0004825592041015625
r_  generation:  0.004098415374755859
local_output_nid generation:  0.00012087821960449219
local_in_edges_tensor generation:  0.00028824806213378906
mini_batch_src_global generation:  0.0003364086151123047
r_  generation:  0.003281116485595703
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  0.00022649765014648438
r_  generation:  0.0017857551574707031
local_output_nid generation:  0.00017261505126953125
local_in_edges_tensor generation:  0.0003745555877685547
mini_batch_src_global generation:  0.0004665851593017578
r_  generation:  0.005584716796875
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  0.0003407001495361328
r_  generation:  0.0023658275604248047
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  0.00018858909606933594
r_  generation:  0.0014755725860595703
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.00022077560424804688
r_  generation:  0.002277851104736328
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  0.0003170967102050781
r_  generation:  0.0033218860626220703
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  0.00019240379333496094
r_  generation:  0.0012373924255371094
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  0.00011277198791503906
r_  generation:  0.0008730888366699219
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  0.00020194053649902344
r_  generation:  0.0022346973419189453
----------------------check_connections_block total spend ----------------------------- 0.06463384628295898
generate_one_block  0.01032114028930664
generate_one_block  0.0033118724822998047
generate_one_block  0.002148866653442383
generate_one_block  0.005971670150756836
generate_one_block  0.006398439407348633
generate_one_block  0.0054090023040771484
generate_one_block  0.003316640853881836
generate_one_block  0.009103775024414062
generate_one_block  0.0044705867767333984
generate_one_block  0.0029883384704589844
generate_one_block  0.00404667854309082
generate_one_block  0.005437135696411133
generate_one_block  0.002478361129760742
generate_one_block  0.002027750015258789
generate_one_block  0.004023313522338867
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.009673595428466797  GigaBytes
Max Memory Allocated: 0.009673595428466797  GigaBytes

connection checking time:  0.08510470390319824
block generation total time  0.11344242095947266
average batch blocks generation time:  0.007562828063964844
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.02415943145751953  GigaBytes
Max Memory Allocated: 0.02415943145751953  GigaBytes

torch.Size([7647, 500])
torch.Size([2426, 128])
torch.Size([520, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0467529296875 GB
    Memory Allocated: 0.793571949005127  GigaBytes
Max Memory Allocated: 0.7936177253723145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.02553415298461914  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([2808, 500])
torch.Size([535, 128])
torch.Size([117, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.20792150497436523  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.02400350570678711  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([1831, 500])
torch.Size([322, 128])
torch.Size([82, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.11756610870361328  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.032647132873535156  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([6593, 500])
torch.Size([1252, 128])
torch.Size([295, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.4329538345336914  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.029656410217285156  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([4978, 500])
torch.Size([1563, 128])
torch.Size([210, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.4871516227722168  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.02979135513305664  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([5067, 500])
torch.Size([1308, 128])
torch.Size([132, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.3879585266113281  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.026580333709716797  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([3367, 500])
torch.Size([664, 128])
torch.Size([204, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.21876144409179688  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.03236722946166992  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([6398, 500])
torch.Size([2031, 128])
torch.Size([409, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.6800365447998047  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.026845932006835938  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([3501, 500])
torch.Size([650, 128])
torch.Size([117, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.2894477844238281  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.02609395980834961  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([3113, 500])
torch.Size([400, 128])
torch.Size([76, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.18401050567626953  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.02844524383544922  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([4361, 500])
torch.Size([820, 128])
torch.Size([148, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.2749791145324707  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.030201435089111328  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([5284, 500])
torch.Size([1031, 128])
torch.Size([207, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.4057130813598633  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.02401590347290039  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([1969, 500])
torch.Size([482, 128])
torch.Size([138, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.15343618392944336  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.023430824279785156  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([1693, 500])
torch.Size([269, 128])
torch.Size([77, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.11603355407714844  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.027794361114501953  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([4010, 500])
torch.Size([813, 128])
torch.Size([204, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.27698659896850586  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005031903584798177 |0.024023056030273438 |0.16079923311869304 |0.00013899803161621094 |0.1640356699625651 |0.009804010391235352 |
----------------------------------------------------------pseudo_mini_loss sum 2.1721363067626953
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  80479
Number of first layer input nodes during this epoch:  62620
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.04723405838012695  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005550384521484375
random selection method range initialization spend 0.000148773193359375
time for parepare:  6.651878356933594e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.33514404296875e-05
----------------------check_connections_block total spend ----------------------------- 0.002902984619140625
generate_one_block  0.001749277114868164
generate_one_block  0.0011165142059326172
generate_one_block  0.0010440349578857422
generate_one_block  0.0010495185852050781
generate_one_block  0.0010294914245605469
generate_one_block  0.0010437965393066406
generate_one_block  0.001169443130493164
generate_one_block  0.0010406970977783203
generate_one_block  0.0010631084442138672
generate_one_block  0.0010743141174316406
generate_one_block  0.0010504722595214844
generate_one_block  0.0010428428649902344
generate_one_block  0.001043558120727539
generate_one_block  0.0009732246398925781
generate_one_block  0.0009667873382568359
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009622573852539062
gen group dst list time:  8.749961853027344e-05
time for parepare:  0.0003192424774169922
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0071446895599365234
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0001201629638671875
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0002396106719970703
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  7.724761962890625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  9.250640869140625e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.649162292480469e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.225440979003906e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  7.462501525878906e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00015592575073242188
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00013184547424316406
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.389617919921875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00016379356384277344
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  7.581710815429688e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  5.0067901611328125e-05
----------------------check_connections_block total spend ----------------------------- 0.012024402618408203
generate_one_block  0.0012557506561279297
generate_one_block  0.0013458728790283203
generate_one_block  0.0011324882507324219
generate_one_block  0.0012285709381103516
generate_one_block  0.0011179447174072266
generate_one_block  0.0010874271392822266
generate_one_block  0.0011382102966308594
generate_one_block  0.0010828971862792969
generate_one_block  0.001070261001586914
generate_one_block  0.0011837482452392578
generate_one_block  0.0011448860168457031
generate_one_block  0.0010344982147216797
generate_one_block  0.001196146011352539
generate_one_block  0.0010497570037841797
generate_one_block  0.001008749008178711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012333393096923828
gen group dst list time:  0.000133514404296875
time for parepare:  0.0008475780487060547
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0003609657287597656
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0005314350128173828
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  0.0002932548522949219
r_  generation:  0.0017457008361816406
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0003113746643066406
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.0005135536193847656
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0004413127899169922
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0003597736358642578
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0006392002105712891
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0003294944763183594
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0003647804260253906
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.00013589859008789062
r_  generation:  0.0012767314910888672
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.00012230873107910156
r_  generation:  0.0008425712585449219
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.00045609474182128906
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  9.679794311523438e-05
r_  generation:  0.0008728504180908203
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.00039696693420410156
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00014138221740722656
----------------------check_connections_block total spend ----------------------------- 0.017501115798950195
generate_one_block  0.0019352436065673828
generate_one_block  0.0033349990844726562
generate_one_block  0.0013539791107177734
generate_one_block  0.0016937255859375
generate_one_block  0.0014753341674804688
generate_one_block  0.0014662742614746094
generate_one_block  0.001865386962890625
generate_one_block  0.0013515949249267578
generate_one_block  0.0014030933380126953
generate_one_block  0.0025649070739746094
generate_one_block  0.0020399093627929688
generate_one_block  0.0015711784362792969
generate_one_block  0.0020508766174316406
generate_one_block  0.0014729499816894531
generate_one_block  0.001178741455078125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001991748809814453
gen group dst list time:  0.00034236907958984375
time for parepare:  0.0016674995422363281
local_output_nid generation:  0.0001316070556640625
local_in_edges_tensor generation:  0.0008070468902587891
mini_batch_src_global generation:  0.00034427642822265625
r_  generation:  0.0026388168334960938
local_output_nid generation:  0.00023317337036132812
local_in_edges_tensor generation:  0.0004937648773193359
mini_batch_src_global generation:  0.0008099079132080078
r_  generation:  0.006139516830444336
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  0.00027561187744140625
r_  generation:  0.0016405582427978516
local_output_nid generation:  0.00010204315185546875
local_in_edges_tensor generation:  0.000278472900390625
mini_batch_src_global generation:  0.00021719932556152344
r_  generation:  0.002259969711303711
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.0002536773681640625
mini_batch_src_global generation:  0.000232696533203125
r_  generation:  0.0020325183868408203
local_output_nid generation:  7.05718994140625e-05
local_in_edges_tensor generation:  0.0002334117889404297
mini_batch_src_global generation:  0.0002586841583251953
r_  generation:  0.002444744110107422
local_output_nid generation:  0.0001316070556640625
local_in_edges_tensor generation:  0.0003159046173095703
mini_batch_src_global generation:  0.00032138824462890625
r_  generation:  0.0032689571380615234
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.00019669532775878906
r_  generation:  0.001316070556640625
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  0.0001952648162841797
r_  generation:  0.0018687248229980469
local_output_nid generation:  0.00015115737915039062
local_in_edges_tensor generation:  0.0003368854522705078
mini_batch_src_global generation:  0.0004067420959472656
r_  generation:  0.004617452621459961
local_output_nid generation:  0.00013971328735351562
local_in_edges_tensor generation:  0.00032901763916015625
mini_batch_src_global generation:  0.0004858970642089844
r_  generation:  0.004144906997680664
local_output_nid generation:  9.894371032714844e-05
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  0.00039196014404296875
r_  generation:  0.0031137466430664062
local_output_nid generation:  0.0001552104949951172
local_in_edges_tensor generation:  0.00032830238342285156
mini_batch_src_global generation:  0.0003418922424316406
r_  generation:  0.003503084182739258
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  0.0002434253692626953
r_  generation:  0.00180816650390625
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.0008192062377929688
----------------------check_connections_block total spend ----------------------------- 0.06580758094787598
generate_one_block  0.00541377067565918
generate_one_block  0.009360313415527344
generate_one_block  0.003124237060546875
generate_one_block  0.003946542739868164
generate_one_block  0.003777742385864258
generate_one_block  0.004433870315551758
generate_one_block  0.005614757537841797
generate_one_block  0.0028357505798339844
generate_one_block  0.004041194915771484
generate_one_block  0.007409811019897461
generate_one_block  0.0070073604583740234
generate_one_block  0.005753040313720703
generate_one_block  0.005709171295166016
generate_one_block  0.0033702850341796875
generate_one_block  0.0020678043365478516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.04723405838012695  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

connection checking time:  0.09533309936523438
block generation total time  0.11770105361938477
average batch blocks generation time:  0.007846736907958984
block dataloader generation time/epoch 0.33391904830932617
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.04847288131713867  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([4727, 500])
torch.Size([957, 128])
torch.Size([230, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.318422794342041  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.05134105682373047  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([6195, 500])
torch.Size([1843, 128])
torch.Size([422, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.7286839485168457  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.04513692855834961  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([2955, 500])
torch.Size([515, 128])
torch.Size([120, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.19255828857421875  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.045780181884765625  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([3287, 500])
torch.Size([885, 128])
torch.Size([158, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.27425479888916016  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.04526710510253906  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([3014, 500])
torch.Size([646, 128])
torch.Size([147, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.2617378234863281  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.045952796936035156  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([3375, 500])
torch.Size([655, 128])
torch.Size([88, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.32038021087646484  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.048874855041503906  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([4931, 500])
torch.Size([1378, 128])
torch.Size([170, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.39454030990600586  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.04438924789428711  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([2556, 500])
torch.Size([548, 128])
torch.Size([131, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.17615270614624023  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.04671812057495117  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([3795, 500])
torch.Size([582, 128])
torch.Size([161, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.24893712997436523  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.04880475997924805  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([4859, 500])
torch.Size([1528, 128])
torch.Size([326, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.5873069763183594  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.05281972885131836  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([7033, 500])
torch.Size([1429, 128])
torch.Size([322, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.4977712631225586  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.04856538772583008  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([4768, 500])
torch.Size([997, 128])
torch.Size([127, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.38672351837158203  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.04976940155029297  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([5406, 500])
torch.Size([1431, 128])
torch.Size([324, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.4156947135925293  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.04519939422607422  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([2875, 500])
torch.Size([658, 128])
torch.Size([130, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.2277379035949707  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.04229164123535156  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

torch.Size([1438, 500])
torch.Size([227, 128])
torch.Size([60, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.1239466667175293  GigaBytes
Max Memory Allocated: 0.7945160865783691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006035725275675456 |0.0012947400410970053 |0.12955975532531738 |0.00012305577596028646 |0.16533503532409669 |0.008878231048583984 |
----------------------------------------------------------pseudo_mini_loss sum 2.252974510192871
Total (block generation + training)time/epoch 4.908271551132202
Training time/epoch 4.574073553085327
Training time without block to device /epoch 4.554652452468872
Training time without total dataloading part /epoch 4.434145927429199
load block tensor time/epoch 0.09053587913513184
block to device time/epoch 0.019421100616455078
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  78766
Number of first layer input nodes during this epoch:  61214
