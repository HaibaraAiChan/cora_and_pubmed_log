main start at this time 1648530969.188409
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007564067840576172  GigaBytes
Max Memory Allocated: 0.007564067840576172  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00237274169921875
random selection method range initialization spend 0.00019097328186035156
time for parepare:  4.267692565917969e-05
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.0010993480682373047
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.2636184692382812e-05
r_  generation:  1.33514404296875e-05
----------------------check_connections_block total spend ----------------------------- 0.002663135528564453
generate_one_block  0.0013401508331298828
generate_one_block  0.0010318756103515625
generate_one_block  0.0009989738464355469
generate_one_block  0.0009629726409912109
generate_one_block  0.0010085105895996094
generate_one_block  0.0010077953338623047
generate_one_block  0.0009715557098388672
generate_one_block  0.0009438991546630859
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011386871337890625
gen group dst list time:  4.673004150390625e-05
time for parepare:  0.0002181529998779297
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00014734268188476562
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00011086463928222656
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001964569091796875
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00019931793212890625
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00019979476928710938
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00013637542724609375
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0002830028533935547
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.982948303222656e-05
----------------------check_connections_block total spend ----------------------------- 0.0033600330352783203
generate_one_block  0.001215219497680664
generate_one_block  0.001094818115234375
generate_one_block  0.0012578964233398438
generate_one_block  0.0012700557708740234
generate_one_block  0.0012154579162597656
generate_one_block  0.0011496543884277344
generate_one_block  0.0013399124145507812
generate_one_block  0.0009772777557373047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011074542999267578
gen group dst list time:  8.916854858398438e-05
time for parepare:  0.0007486343383789062
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00027942657470703125
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.0008842945098876953
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.0008611679077148438
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.0011591911315917969
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.00017070770263671875
r_  generation:  0.0015268325805664062
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00014472007751464844
r_  generation:  0.0011899471282958984
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0007441043853759766
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  0.0001723766326904297
r_  generation:  0.0017147064208984375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0001475811004638672
----------------------check_connections_block total spend ----------------------------- 0.013969182968139648
generate_one_block  0.0021758079528808594
generate_one_block  0.0021708011627197266
generate_one_block  0.0024547576904296875
generate_one_block  0.002958536148071289
generate_one_block  0.002422332763671875
generate_one_block  0.001895904541015625
generate_one_block  0.003025054931640625
generate_one_block  0.0010902881622314453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020368099212646484
gen group dst list time:  0.00023674964904785156
time for parepare:  0.0014276504516601562
local_output_nid generation:  0.00013899803161621094
local_in_edges_tensor generation:  0.0006670951843261719
mini_batch_src_global generation:  0.0006251335144042969
r_  generation:  0.005063056945800781
local_output_nid generation:  0.00017690658569335938
local_in_edges_tensor generation:  0.00043463706970214844
mini_batch_src_global generation:  0.0007245540618896484
r_  generation:  0.0055103302001953125
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.000362396240234375
mini_batch_src_global generation:  0.0004673004150390625
r_  generation:  0.004922628402709961
local_output_nid generation:  0.00017499923706054688
local_in_edges_tensor generation:  0.0004055500030517578
mini_batch_src_global generation:  0.0005934238433837891
r_  generation:  0.006124973297119141
local_output_nid generation:  0.00016307830810546875
local_in_edges_tensor generation:  0.00037550926208496094
mini_batch_src_global generation:  0.0005939006805419922
r_  generation:  0.005628824234008789
local_output_nid generation:  0.00011467933654785156
local_in_edges_tensor generation:  0.00028443336486816406
mini_batch_src_global generation:  0.0004048347473144531
r_  generation:  0.0036461353302001953
local_output_nid generation:  0.00015211105346679688
local_in_edges_tensor generation:  0.0003571510314941406
mini_batch_src_global generation:  0.0005199909210205078
r_  generation:  0.00568842887878418
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  0.0002033710479736328
r_  generation:  0.0006914138793945312
----------------------check_connections_block total spend ----------------------------- 0.056406259536743164
generate_one_block  0.008843421936035156
generate_one_block  0.008570671081542969
generate_one_block  0.0075588226318359375
generate_one_block  0.009137153625488281
generate_one_block  0.009308099746704102
generate_one_block  0.0056002140045166016
generate_one_block  0.00840449333190918
generate_one_block  0.0017361640930175781
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007564067840576172  GigaBytes
Max Memory Allocated: 0.007564067840576172  GigaBytes

connection checking time:  0.07373547554016113
block generation total time  0.08687281608581543
average batch blocks generation time:  0.010859102010726929
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.021459579467773438  GigaBytes
Max Memory Allocated: 0.021459579467773438  GigaBytes

torch.Size([7368, 500])
torch.Size([1681, 16])
torch.Size([345, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.5794000625610352  GigaBytes
Max Memory Allocated: 0.6214194297790527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.028979778289794922  GigaBytes
Max Memory Allocated: 0.6214194297790527  GigaBytes

torch.Size([7334, 500])
torch.Size([2184, 16])
torch.Size([249, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.6294951438903809  GigaBytes
Max Memory Allocated: 0.672996997833252  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.02985239028930664  GigaBytes
Max Memory Allocated: 0.672996997833252  GigaBytes

torch.Size([7817, 500])
torch.Size([1961, 16])
torch.Size([499, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.54437255859375  GigaBytes
Max Memory Allocated: 0.672996997833252  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.02901601791381836  GigaBytes
Max Memory Allocated: 0.672996997833252  GigaBytes

torch.Size([7042, 500])
torch.Size([2199, 16])
torch.Size([470, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.6906976699829102  GigaBytes
Max Memory Allocated: 0.7357964515686035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.03177976608276367  GigaBytes
Max Memory Allocated: 0.7357964515686035  GigaBytes

torch.Size([8839, 500])
torch.Size([2040, 16])
torch.Size([505, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.6314258575439453  GigaBytes
Max Memory Allocated: 0.7357964515686035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.025920867919921875  GigaBytes
Max Memory Allocated: 0.7357964515686035  GigaBytes

torch.Size([5735, 500])
torch.Size([1426, 16])
torch.Size([278, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.3803286552429199  GigaBytes
Max Memory Allocated: 0.7357964515686035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.026790142059326172  GigaBytes
Max Memory Allocated: 0.7357964515686035  GigaBytes

torch.Size([6149, 500])
torch.Size([1897, 16])
torch.Size([479, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.6368999481201172  GigaBytes
Max Memory Allocated: 0.7357964515686035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.017666339874267578  GigaBytes
Max Memory Allocated: 0.7357964515686035  GigaBytes

torch.Size([1353, 500])
torch.Size([235, 16])
torch.Size([69, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.0766606330871582  GigaBytes
Max Memory Allocated: 0.7357964515686035  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0064092278480529785 |0.04315471649169922 |0.21275827288627625 |0.00013563036918640137 |0.19467291235923767 |0.009583711624145508 |
----------------------------------------------------------pseudo_mini_loss sum 1.6420446634292603
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  68511
Number of first layer input nodes during this epoch:  51637
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.033718109130859375  GigaBytes
Max Memory Allocated: 0.7357964515686035  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005230903625488281
random selection method range initialization spend 0.00012040138244628906
time for parepare:  5.984306335449219e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.52587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0017304420471191406
generate_one_block  0.001621246337890625
generate_one_block  0.0010764598846435547
generate_one_block  0.001329660415649414
generate_one_block  0.0010418891906738281
generate_one_block  0.0010309219360351562
generate_one_block  0.0009746551513671875
generate_one_block  0.0009799003601074219
generate_one_block  0.0010046958923339844
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005645751953125
gen group dst list time:  5.1021575927734375e-05
time for parepare:  0.0004978179931640625
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001270771026611328
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.00027489662170410156
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002105236053466797
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00019693374633789062
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00013256072998046875
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00011968612670898438
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00020694732666015625
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  6.437301635742188e-05
----------------------check_connections_block total spend ----------------------------- 0.003812074661254883
generate_one_block  0.0012171268463134766
generate_one_block  0.0013592243194580078
generate_one_block  0.0013189315795898438
generate_one_block  0.001251220703125
generate_one_block  0.001165628433227539
generate_one_block  0.0011932849884033203
generate_one_block  0.0012369155883789062
generate_one_block  0.0011372566223144531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011663436889648438
gen group dst list time:  0.00010013580322265625
time for parepare:  0.0010273456573486328
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00034499168395996094
mini_batch_src_global generation:  0.00012969970703125
r_  generation:  0.0006375312805175781
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.0003998279571533203
mini_batch_src_global generation:  0.00023674964904785156
r_  generation:  0.0019698143005371094
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  0.00015878677368164062
r_  generation:  0.0025975704193115234
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  0.0001671314239501953
r_  generation:  0.001461029052734375
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  0.00014209747314453125
r_  generation:  0.0010540485382080078
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.0006539821624755859
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.0011582374572753906
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  0.00014734268188476562
r_  generation:  0.0004391670227050781
----------------------check_connections_block total spend ----------------------------- 0.016964197158813477
generate_one_block  0.0019729137420654297
generate_one_block  0.003577709197998047
generate_one_block  0.0023581981658935547
generate_one_block  0.002898693084716797
generate_one_block  0.002531766891479492
generate_one_block  0.001806497573852539
generate_one_block  0.002539396286010742
generate_one_block  0.0015234947204589844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002059459686279297
gen group dst list time:  0.0003294944763183594
time for parepare:  0.0014798641204833984
local_output_nid generation:  0.0001468658447265625
local_in_edges_tensor generation:  0.0010023117065429688
mini_batch_src_global generation:  0.00041985511779785156
r_  generation:  0.0032052993774414062
local_output_nid generation:  0.00026869773864746094
local_in_edges_tensor generation:  0.0005533695220947266
mini_batch_src_global generation:  0.0009033679962158203
r_  generation:  0.006882905960083008
local_output_nid generation:  0.0002028942108154297
local_in_edges_tensor generation:  0.0004138946533203125
mini_batch_src_global generation:  0.00048732757568359375
r_  generation:  0.004639863967895508
local_output_nid generation:  0.00020837783813476562
local_in_edges_tensor generation:  0.0004458427429199219
mini_batch_src_global generation:  0.0005738735198974609
r_  generation:  0.006050825119018555
local_output_nid generation:  0.00022339820861816406
local_in_edges_tensor generation:  0.0004367828369140625
mini_batch_src_global generation:  0.0005924701690673828
r_  generation:  0.005856513977050781
local_output_nid generation:  0.00011968612670898438
local_in_edges_tensor generation:  0.00029850006103515625
mini_batch_src_global generation:  0.0004162788391113281
r_  generation:  0.003210306167602539
local_output_nid generation:  0.00022983551025390625
local_in_edges_tensor generation:  0.00042319297790527344
mini_batch_src_global generation:  0.0005667209625244141
r_  generation:  0.006078481674194336
local_output_nid generation:  0.00010633468627929688
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  0.0004057884216308594
r_  generation:  0.003065347671508789
----------------------check_connections_block total spend ----------------------------- 0.06051015853881836
generate_one_block  0.005954265594482422
generate_one_block  0.010414361953735352
generate_one_block  0.007135152816772461
generate_one_block  0.009678840637207031
generate_one_block  0.009097576141357422
generate_one_block  0.00530552864074707
generate_one_block  0.00945734977722168
generate_one_block  0.005074024200439453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.033718109130859375  GigaBytes
Max Memory Allocated: 0.7357964515686035  GigaBytes

connection checking time:  0.08128643035888672
block generation total time  0.09120535850524902
average batch blocks generation time:  0.011400669813156128
block dataloader generation time/epoch 0.28799891471862793Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.04163360595703125  GigaBytes
Max Memory Allocated: 0.7357964515686035  GigaBytes

torch.Size([5574, 500])
torch.Size([1133, 16])
torch.Size([309, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.36817216873168945  GigaBytes
Max Memory Allocated: 0.7357964515686035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.04579734802246094  GigaBytes
Max Memory Allocated: 0.7357964515686035  GigaBytes

torch.Size([7729, 500])
torch.Size([2339, 16])
torch.Size([560, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.7853856086730957  GigaBytes
Max Memory Allocated: 0.8342256546020508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.043286800384521484  GigaBytes
Max Memory Allocated: 0.8342256546020508  GigaBytes

torch.Size([6438, 500])
torch.Size([1882, 16])
torch.Size([394, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.4985675811767578  GigaBytes
Max Memory Allocated: 0.8342256546020508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.044786930084228516  GigaBytes
Max Memory Allocated: 0.8342256546020508  GigaBytes

torch.Size([7209, 500])
torch.Size([1962, 16])
torch.Size([460, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.6849026679992676  GigaBytes
Max Memory Allocated: 0.8342256546020508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.04623270034790039  GigaBytes
Max Memory Allocated: 0.8342256546020508  GigaBytes

torch.Size([7996, 500])
torch.Size([2314, 16])
torch.Size([326, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.6679868698120117  GigaBytes
Max Memory Allocated: 0.8342256546020508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.04120016098022461  GigaBytes
Max Memory Allocated: 0.8342256546020508  GigaBytes

torch.Size([4858, 500])
torch.Size([1102, 16])
torch.Size([254, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.3716573715209961  GigaBytes
Max Memory Allocated: 0.8342256546020508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.049208641052246094  GigaBytes
Max Memory Allocated: 0.8342256546020508  GigaBytes

torch.Size([9588, 500])
torch.Size([2175, 16])
torch.Size([496, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.6934065818786621  GigaBytes
Max Memory Allocated: 0.8342256546020508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.03937482833862305  GigaBytes
Max Memory Allocated: 0.8342256546020508  GigaBytes

torch.Size([4366, 500])
torch.Size([974, 16])
torch.Size([111, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.3576078414916992  GigaBytes
Max Memory Allocated: 0.8342256546020508  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010049760341644287 |0.0011843740940093994 |0.1502816379070282 |0.00012952089309692383 |0.19465026259422302 |0.008208274841308594 |
----------------------------------------------------------pseudo_mini_loss sum 1.811995267868042
Total (block generation + training)time/epoch 3.1629598140716553
Training time/epoch 2.874697208404541
Training time without block to device /epoch 2.865222215652466
Training time without total dataloading part /epoch 2.7686996459960938
load block tensor time/epoch 0.0803980827331543
block to device time/epoch 0.009474992752075195
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  70906
Number of first layer input nodes during this epoch:  53758
