main start at this time 1648530955.6771462
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007564067840576172  GigaBytes
Max Memory Allocated: 0.007564067840576172  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0032041072845458984
random selection method range initialization spend 0.00017833709716796875
time for parepare:  4.482269287109375e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.0010311603546142578
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.956390380859375e-05
----------------------check_connections_block total spend ----------------------------- 0.0019998550415039062
generate_one_block  0.0017578601837158203
generate_one_block  0.001012563705444336
generate_one_block  0.0010383129119873047
generate_one_block  0.0010390281677246094
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014102458953857422
gen group dst list time:  3.0517578125e-05
time for parepare:  0.0002262592315673828
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00020956993103027344
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0004181861877441406
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0003247261047363281
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0003077983856201172
----------------------check_connections_block total spend ----------------------------- 0.002688884735107422
generate_one_block  0.0012660026550292969
generate_one_block  0.0015304088592529297
generate_one_block  0.001367330551147461
generate_one_block  0.0013844966888427734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010557174682617188
gen group dst list time:  6.985664367675781e-05
time for parepare:  0.0007486343383789062
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00029015541076660156
mini_batch_src_global generation:  0.00013899803161621094
r_  generation:  0.0014972686767578125
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.0002512931823730469
mini_batch_src_global generation:  0.0003857612609863281
r_  generation:  0.0027022361755371094
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  0.00020122528076171875
r_  generation:  0.0017287731170654297
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.00019240379333496094
r_  generation:  0.001996278762817383
----------------------check_connections_block total spend ----------------------------- 0.012887239456176758
generate_one_block  0.002942800521850586
generate_one_block  0.004542827606201172
generate_one_block  0.0030624866485595703
generate_one_block  0.0034024715423583984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002080202102661133
gen group dst list time:  0.00020647048950195312
time for parepare:  0.0013706684112548828
local_output_nid generation:  0.0002465248107910156
local_in_edges_tensor generation:  0.000843048095703125
mini_batch_src_global generation:  0.0009179115295410156
r_  generation:  0.0075376033782958984
local_output_nid generation:  0.00029730796813964844
local_in_edges_tensor generation:  0.0006840229034423828
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.010111093521118164
local_output_nid generation:  0.00021886825561523438
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.0007176399230957031
r_  generation:  0.007196903228759766
local_output_nid generation:  0.0001952648162841797
local_in_edges_tensor generation:  0.0004191398620605469
mini_batch_src_global generation:  0.0006482601165771484
r_  generation:  0.006699800491333008
----------------------check_connections_block total spend ----------------------------- 0.047368764877319336
generate_one_block  0.011450767517089844
generate_one_block  0.014289617538452148
generate_one_block  0.010913610458374023
generate_one_block  0.01031637191772461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007564067840576172  GigaBytes
Max Memory Allocated: 0.007564067840576172  GigaBytes

connection checking time:  0.06294488906860352
block generation total time  0.06646919250488281
average batch blocks generation time:  0.016617298126220703
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.026244640350341797  GigaBytes
Max Memory Allocated: 0.026244640350341797  GigaBytes

torch.Size([9894, 500])
torch.Size([2898, 16])
torch.Size([538, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1112060546875 GB
    Memory Allocated: 0.8371677398681641  GigaBytes
Max Memory Allocated: 0.8942937850952148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1112060546875 GB
    Memory Allocated: 0.03624439239501953  GigaBytes
Max Memory Allocated: 0.8942937850952148  GigaBytes

torch.Size([11147, 500])
torch.Size([4075, 16])
torch.Size([981, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 1.1000900268554688  GigaBytes
Max Memory Allocated: 1.170961856842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.03490018844604492  GigaBytes
Max Memory Allocated: 1.170961856842041  GigaBytes

torch.Size([10285, 500])
torch.Size([2972, 16])
torch.Size([689, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.7892427444458008  GigaBytes
Max Memory Allocated: 1.170961856842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.030926227569580078  GigaBytes
Max Memory Allocated: 1.170961856842041  GigaBytes

torch.Size([8347, 500])
torch.Size([2422, 16])
torch.Size([646, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.7763714790344238  GigaBytes
Max Memory Allocated: 1.170961856842041  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007064342498779297 |0.08494478464126587 |0.303216814994812 |0.0001614093780517578 |0.2301391363143921 |0.009203433990478516 |
----------------------------------------------------------pseudo_mini_loss sum 2.044194221496582
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  55250
Number of first layer input nodes during this epoch:  39673
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.04728984832763672  GigaBytes
Max Memory Allocated: 1.170961856842041  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005154609680175781
random selection method range initialization spend 0.00012803077697753906
time for parepare:  5.7220458984375e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  5.340576171875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.695487976074219e-05
----------------------check_connections_block total spend ----------------------------- 0.0010797977447509766
generate_one_block  0.002622842788696289
generate_one_block  0.0012354850769042969
generate_one_block  0.0011138916015625
generate_one_block  0.0010967254638671875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005805492401123047
gen group dst list time:  3.6716461181640625e-05
time for parepare:  0.0002505779266357422
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00036978721618652344
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.00045013427734375
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.00023627281188964844
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0002853870391845703
----------------------check_connections_block total spend ----------------------------- 0.002989530563354492
generate_one_block  0.0016541481018066406
generate_one_block  0.0017271041870117188
generate_one_block  0.0015006065368652344
generate_one_block  0.0014715194702148438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010564327239990234
gen group dst list time:  8.392333984375e-05
time for parepare:  0.0007405281066894531
local_output_nid generation:  9.965896606445312e-05
local_in_edges_tensor generation:  0.0003266334533691406
mini_batch_src_global generation:  0.0002627372741699219
r_  generation:  0.002595663070678711
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.0002491474151611328
mini_batch_src_global generation:  0.0003025531768798828
r_  generation:  0.0026674270629882812
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  0.00019502639770507812
r_  generation:  0.0015964508056640625
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.0002288818359375
mini_batch_src_global generation:  0.00018477439880371094
r_  generation:  0.001750946044921875
----------------------check_connections_block total spend ----------------------------- 0.013827085494995117
generate_one_block  0.004556179046630859
generate_one_block  0.004496097564697266
generate_one_block  0.0031239986419677734
generate_one_block  0.0032854080200195312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021119117736816406
gen group dst list time:  0.00023794174194335938
time for parepare:  0.0013625621795654297
local_output_nid generation:  0.0003044605255126953
local_in_edges_tensor generation:  0.0008521080017089844
mini_batch_src_global generation:  0.001049041748046875
r_  generation:  0.008695125579833984
local_output_nid generation:  0.0003161430358886719
local_in_edges_tensor generation:  0.0006365776062011719
mini_batch_src_global generation:  0.0011985301971435547
r_  generation:  0.008974075317382812
local_output_nid generation:  0.00025582313537597656
local_in_edges_tensor generation:  0.0004918575286865234
mini_batch_src_global generation:  0.0007047653198242188
r_  generation:  0.00695347785949707
local_output_nid generation:  0.0002582073211669922
local_in_edges_tensor generation:  0.0005185604095458984
mini_batch_src_global generation:  0.0008187294006347656
r_  generation:  0.008109092712402344
----------------------check_connections_block total spend ----------------------------- 0.04989886283874512
generate_one_block  0.015017032623291016
generate_one_block  0.013702392578125
generate_one_block  0.011533498764038086
generate_one_block  0.012296676635742188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.04728984832763672  GigaBytes
Max Memory Allocated: 1.170961856842041  GigaBytes

connection checking time:  0.06671547889709473
block generation total time  0.07436466217041016
average batch blocks generation time:  0.01859116554260254
block dataloader generation time/epoch 0.18973231315612793
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.050986289978027344  GigaBytes
Max Memory Allocated: 1.170961856842041  GigaBytes

torch.Size([10074, 500])
torch.Size([3035, 16])
torch.Size([796, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.9592480659484863  GigaBytes
Max Memory Allocated: 1.170961856842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.051113128662109375  GigaBytes
Max Memory Allocated: 1.170961856842041  GigaBytes

torch.Size([10548, 500])
torch.Size([3590, 16])
torch.Size([891, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.9948716163635254  GigaBytes
Max Memory Allocated: 1.170961856842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.04792499542236328  GigaBytes
Max Memory Allocated: 1.170961856842041  GigaBytes

torch.Size([8883, 500])
torch.Size([2830, 16])
torch.Size([485, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.7777996063232422  GigaBytes
Max Memory Allocated: 1.170961856842041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.05209159851074219  GigaBytes
Max Memory Allocated: 1.170961856842041  GigaBytes

torch.Size([11099, 500])
torch.Size([3041, 16])
torch.Size([706, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.9058761596679688  GigaBytes
Max Memory Allocated: 1.170961856842041  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01302415132522583 |0.0012639760971069336 |0.182450532913208 |0.00013768672943115234 |0.23427468538284302 |0.007851362228393555 |
----------------------------------------------------------pseudo_mini_loss sum 1.6791902780532837
Total (block generation + training)time/epoch 1.9320812225341797
Training time/epoch 1.7420916557312012
Training time without block to device /epoch 1.7370357513427734
Training time without total dataloading part /epoch 1.6753029823303223
load block tensor time/epoch 0.05209660530090332
block to device time/epoch 0.005055904388427734
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  56335
Number of first layer input nodes during this epoch:  40604
