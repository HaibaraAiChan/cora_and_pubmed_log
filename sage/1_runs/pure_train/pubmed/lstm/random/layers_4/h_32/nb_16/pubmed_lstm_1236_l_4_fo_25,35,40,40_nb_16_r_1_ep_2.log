main start at this time 1648531041.4067817
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007703304290771484  GigaBytes
Max Memory Allocated: 0.007703304290771484  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0017497539520263672
random selection method range initialization spend 0.00020837783813476562
time for parepare:  4.506111145019531e-05
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0012023448944091797
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.5735626220703125e-05
----------------------check_connections_block total spend ----------------------------- 0.002919435501098633
generate_one_block  0.0013709068298339844
generate_one_block  0.0010821819305419922
generate_one_block  0.0010666847229003906
generate_one_block  0.0010673999786376953
generate_one_block  0.0010466575622558594
generate_one_block  0.0010592937469482422
generate_one_block  0.0010657310485839844
generate_one_block  0.001035928726196289
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009641647338867188
gen group dst list time:  5.1975250244140625e-05
time for parepare:  0.00024771690368652344
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00024819374084472656
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00025653839111328125
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00019860267639160156
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00022172927856445312
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0002377033233642578
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00013327598571777344
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00015211105346679688
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00015091896057128906
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.7697296142578125e-05
----------------------check_connections_block total spend ----------------------------- 0.003626585006713867
generate_one_block  0.0013985633850097656
generate_one_block  0.0013017654418945312
generate_one_block  0.0013461112976074219
generate_one_block  0.0013623237609863281
generate_one_block  0.0012118816375732422
generate_one_block  0.001239776611328125
generate_one_block  0.001277923583984375
generate_one_block  0.0010874271392822266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012035369873046875
gen group dst list time:  9.417533874511719e-05
time for parepare:  0.0007915496826171875
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.0002894401550292969
mini_batch_src_global generation:  0.00016260147094726562
r_  generation:  0.0017004013061523438
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.0001666545867919922
r_  generation:  0.0013098716735839844
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0012888908386230469
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.0001983642578125
r_  generation:  0.0018856525421142578
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  0.00012087821960449219
r_  generation:  0.000705718994140625
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  9.417533874511719e-05
r_  generation:  0.0008764266967773438
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.0009710788726806641
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0003457069396972656
----------------------check_connections_block total spend ----------------------------- 0.015130281448364258
generate_one_block  0.003098011016845703
generate_one_block  0.0025091171264648438
generate_one_block  0.002403736114501953
generate_one_block  0.003183126449584961
generate_one_block  0.0017092227935791016
generate_one_block  0.0019943714141845703
generate_one_block  0.002117156982421875
generate_one_block  0.0013179779052734375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002025127410888672
gen group dst list time:  0.00026297569274902344
time for parepare:  0.00156402587890625
local_output_nid generation:  0.00017189979553222656
local_in_edges_tensor generation:  0.0006890296936035156
mini_batch_src_global generation:  0.0007386207580566406
r_  generation:  0.005973100662231445
local_output_nid generation:  0.0002155303955078125
local_in_edges_tensor generation:  0.0004992485046386719
mini_batch_src_global generation:  0.0008308887481689453
r_  generation:  0.0066416263580322266
local_output_nid generation:  0.00017905235290527344
local_in_edges_tensor generation:  0.0004246234893798828
mini_batch_src_global generation:  0.0005819797515869141
r_  generation:  0.0051457881927490234
local_output_nid generation:  0.00019550323486328125
local_in_edges_tensor generation:  0.0004425048828125
mini_batch_src_global generation:  0.0006062984466552734
r_  generation:  0.006661176681518555
local_output_nid generation:  9.1552734375e-05
local_in_edges_tensor generation:  0.0002589225769042969
mini_batch_src_global generation:  0.00040221214294433594
r_  generation:  0.003381490707397461
local_output_nid generation:  0.00010943412780761719
local_in_edges_tensor generation:  0.00029277801513671875
mini_batch_src_global generation:  0.0003924369812011719
r_  generation:  0.004013776779174805
local_output_nid generation:  0.0001437664031982422
local_in_edges_tensor generation:  0.0003342628479003906
mini_batch_src_global generation:  0.0004439353942871094
r_  generation:  0.004590749740600586
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  0.0002770423889160156
r_  generation:  0.001825094223022461
----------------------check_connections_block total spend ----------------------------- 0.05825352668762207
generate_one_block  0.009014606475830078
generate_one_block  0.009225130081176758
generate_one_block  0.008082866668701172
generate_one_block  0.01034092903137207
generate_one_block  0.005788326263427734
generate_one_block  0.006270170211791992
generate_one_block  0.0070040225982666016
generate_one_block  0.0032248497009277344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007703304290771484  GigaBytes
Max Memory Allocated: 0.007703304290771484  GigaBytes

connection checking time:  0.0770103931427002
block generation total time  0.0875093936920166
average batch blocks generation time:  0.010938674211502075
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.019989013671875  GigaBytes
Max Memory Allocated: 0.019989013671875  GigaBytes

torch.Size([6250, 500])
torch.Size([1919, 32])
torch.Size([448, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8690185546875 GB
    Memory Allocated: 0.6267256736755371  GigaBytes
Max Memory Allocated: 0.6616759300231934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.030765533447265625  GigaBytes
Max Memory Allocated: 0.6616759300231934  GigaBytes

torch.Size([8139, 500])
torch.Size([2424, 32])
torch.Size([404, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.6810007095336914  GigaBytes
Max Memory Allocated: 0.7210607528686523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.03132200241088867  GigaBytes
Max Memory Allocated: 0.7210607528686523  GigaBytes

torch.Size([8451, 500])
torch.Size([1967, 32])
torch.Size([514, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.5837392807006836  GigaBytes
Max Memory Allocated: 0.7210607528686523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.029314517974853516  GigaBytes
Max Memory Allocated: 0.7210607528686523  GigaBytes

torch.Size([7231, 500])
torch.Size([2514, 32])
torch.Size([488, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7534294128417969  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.027592182159423828  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

torch.Size([5963, 500])
torch.Size([1082, 32])
torch.Size([307, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.3743462562561035  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.026438236236572266  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

torch.Size([5852, 500])
torch.Size([1403, 32])
torch.Size([327, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.45399999618530273  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.028609275817871094  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

torch.Size([7009, 500])
torch.Size([1819, 32])
torch.Size([353, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5124373435974121  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.021936416625976562  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

torch.Size([2976, 500])
torch.Size([623, 32])
torch.Size([81, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.20409631729125977  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008728891611099243 |0.04378664493560791 |0.21717628836631775 |0.00014013051986694336 |0.18833321332931519 |0.010092735290527344 |
----------------------------------------------------------pseudo_mini_loss sum 2.060150623321533
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  68901
Number of first layer input nodes during this epoch:  51871
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.03831052780151367  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005159378051757812
random selection method range initialization spend 0.00012826919555664062
time for parepare:  6.246566772460938e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.0265579223632812e-05
----------------------check_connections_block total spend ----------------------------- 0.0018367767333984375
generate_one_block  0.0016047954559326172
generate_one_block  0.0010750293731689453
generate_one_block  0.0013132095336914062
generate_one_block  0.0010077953338623047
generate_one_block  0.001068115234375
generate_one_block  0.0010514259338378906
generate_one_block  0.0010454654693603516
generate_one_block  0.0009942054748535156
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005433559417724609
gen group dst list time:  5.078315734863281e-05
time for parepare:  0.00030159950256347656
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00012230873107910156
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00028705596923828125
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0002167224884033203
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00020074844360351562
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00013709068298339844
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00012969970703125
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00017905235290527344
----------------------check_connections_block total spend ----------------------------- 0.0036165714263916016
generate_one_block  0.0012149810791015625
generate_one_block  0.00141143798828125
generate_one_block  0.0012693405151367188
generate_one_block  0.0011148452758789062
generate_one_block  0.0012583732604980469
generate_one_block  0.0011434555053710938
generate_one_block  0.0011973381042480469
generate_one_block  0.0012929439544677734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010364055633544922
gen group dst list time:  0.00010704994201660156
time for parepare:  0.0007703304290771484
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.0002827644348144531
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0005645751953125
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  0.0001804828643798828
r_  generation:  0.0015628337860107422
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.00019884109497070312
r_  generation:  0.0014872550964355469
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.000530242919921875
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.001332998275756836
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  0.00010919570922851562
r_  generation:  0.0007643699645996094
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0008044242858886719
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  0.00015854835510253906
r_  generation:  0.0013222694396972656
----------------------check_connections_block total spend ----------------------------- 0.014688253402709961
generate_one_block  0.0018682479858398438
generate_one_block  0.0031948089599609375
generate_one_block  0.0030155181884765625
generate_one_block  0.0017108917236328125
generate_one_block  0.0027756690979003906
generate_one_block  0.0033066272735595703
generate_one_block  0.0019960403442382812
generate_one_block  0.002660512924194336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018889904022216797
gen group dst list time:  0.0002994537353515625
time for parepare:  0.00150299072265625
local_output_nid generation:  0.00013303756713867188
local_in_edges_tensor generation:  0.0005710124969482422
mini_batch_src_global generation:  0.0003845691680908203
r_  generation:  0.002934694290161133
local_output_nid generation:  0.0003635883331298828
local_in_edges_tensor generation:  0.000568389892578125
mini_batch_src_global generation:  0.0008032321929931641
r_  generation:  0.00651097297668457
local_output_nid generation:  0.00018405914306640625
local_in_edges_tensor generation:  0.0004215240478515625
mini_batch_src_global generation:  0.0006642341613769531
r_  generation:  0.005609989166259766
local_output_nid generation:  0.0001347064971923828
local_in_edges_tensor generation:  0.00030732154846191406
mini_batch_src_global generation:  0.0004093647003173828
r_  generation:  0.003682374954223633
local_output_nid generation:  0.0002288818359375
local_in_edges_tensor generation:  0.0004367828369140625
mini_batch_src_global generation:  0.00055694580078125
r_  generation:  0.00639796257019043
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.00028634071350097656
mini_batch_src_global generation:  0.0004031658172607422
r_  generation:  0.0033631324768066406
local_output_nid generation:  0.00014328956604003906
local_in_edges_tensor generation:  0.0003070831298828125
mini_batch_src_global generation:  0.00039196014404296875
r_  generation:  0.004202127456665039
local_output_nid generation:  0.00014543533325195312
local_in_edges_tensor generation:  0.0003407001495361328
mini_batch_src_global generation:  0.000492095947265625
r_  generation:  0.00473785400390625
----------------------check_connections_block total spend ----------------------------- 0.05779099464416504
generate_one_block  0.006059885025024414
generate_one_block  0.010012388229370117
generate_one_block  0.008749246597290039
generate_one_block  0.0064814090728759766
generate_one_block  0.011234045028686523
generate_one_block  0.005448102951049805
generate_one_block  0.00685429573059082
generate_one_block  0.007661342620849609
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.03831052780151367  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

connection checking time:  0.0760958194732666
block generation total time  0.09293174743652344
average batch blocks generation time:  0.01161646842956543
block dataloader generation time/epoch 0.2485370635986328Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.042031288146972656  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

torch.Size([5492, 500])
torch.Size([959, 32])
torch.Size([273, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.3527488708496094  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.04814720153808594  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

torch.Size([8712, 500])
torch.Size([2896, 32])
torch.Size([560, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7073068618774414  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.04415702819824219  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

torch.Size([6576, 500])
torch.Size([1863, 32])
torch.Size([450, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6587300300598145  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.041716575622558594  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

torch.Size([5312, 500])
torch.Size([1280, 32])
torch.Size([157, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.43270254135131836  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.04995870590209961  GigaBytes
Max Memory Allocated: 0.7946438789367676  GigaBytes

torch.Size([9683, 500])
torch.Size([2333, 32])
torch.Size([510, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.7506704330444336  GigaBytes
Max Memory Allocated: 0.7947731018066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.04145193099975586  GigaBytes
Max Memory Allocated: 0.7947731018066406  GigaBytes

torch.Size([5176, 500])
torch.Size([1326, 32])
torch.Size([320, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.364471435546875  GigaBytes
Max Memory Allocated: 0.7947731018066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.04347848892211914  GigaBytes
Max Memory Allocated: 0.7947731018066406  GigaBytes

torch.Size([6247, 500])
torch.Size([1388, 32])
torch.Size([285, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.4872870445251465  GigaBytes
Max Memory Allocated: 0.7947731018066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.04192781448364258  GigaBytes
Max Memory Allocated: 0.7947731018066406  GigaBytes

torch.Size([5393, 500])
torch.Size([1439, 32])
torch.Size([344, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.5667271614074707  GigaBytes
Max Memory Allocated: 0.7947731018066406  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010716885328292847 |0.002088606357574463 |0.1564854085445404 |0.00013276934623718262 |0.18391776084899902 |0.008758783340454102 |
----------------------------------------------------------pseudo_mini_loss sum 1.7719917297363281
Total (block generation + training)time/epoch 3.1018106937408447
Training time/epoch 2.8527321815490723
Training time without block to device /epoch 2.8360233306884766
Training time without total dataloading part /epoch 2.733046293258667
load block tensor time/epoch 0.08573508262634277
block to device time/epoch 0.016708850860595703
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  69331
Number of first layer input nodes during this epoch:  52591
