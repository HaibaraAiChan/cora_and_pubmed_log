main start at this time 1648531027.7843256
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007703304290771484  GigaBytes
Max Memory Allocated: 0.007703304290771484  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0025043487548828125
random selection method range initialization spend 0.00023603439331054688
time for parepare:  4.2438507080078125e-05
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0025947093963623047
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.0040740966796875e-05
----------------------check_connections_block total spend ----------------------------- 0.003553152084350586
generate_one_block  0.001325845718383789
generate_one_block  0.0010411739349365234
generate_one_block  0.0010128021240234375
generate_one_block  0.0010046958923339844
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012493133544921875
gen group dst list time:  3.170967102050781e-05
time for parepare:  0.0002262592315673828
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0004115104675292969
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0003714561462402344
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00020647048950195312
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0002582073211669922
----------------------check_connections_block total spend ----------------------------- 0.0026197433471679688
generate_one_block  0.0015408992767333984
generate_one_block  0.001455068588256836
generate_one_block  0.0013079643249511719
generate_one_block  0.0013496875762939453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009753704071044922
gen group dst list time:  7.033348083496094e-05
time for parepare:  0.0007531642913818359
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.0003407001495361328
mini_batch_src_global generation:  0.00022983551025390625
r_  generation:  0.002628326416015625
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.0002474784851074219
mini_batch_src_global generation:  0.00034999847412109375
r_  generation:  0.0027086734771728516
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.0001811981201171875
r_  generation:  0.001325368881225586
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.0014400482177734375
----------------------check_connections_block total spend ----------------------------- 0.013120889663696289
generate_one_block  0.0044820308685302734
generate_one_block  0.004415035247802734
generate_one_block  0.002626180648803711
generate_one_block  0.0028040409088134766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020613670349121094
gen group dst list time:  0.0002257823944091797
time for parepare:  0.0014302730560302734
local_output_nid generation:  0.0002777576446533203
local_in_edges_tensor generation:  0.0009729862213134766
mini_batch_src_global generation:  0.0010783672332763672
r_  generation:  0.009391546249389648
local_output_nid generation:  0.00035691261291503906
local_in_edges_tensor generation:  0.0007696151733398438
mini_batch_src_global generation:  0.0012547969818115234
r_  generation:  0.011010408401489258
local_output_nid generation:  0.0002219676971435547
local_in_edges_tensor generation:  0.0004942417144775391
mini_batch_src_global generation:  0.0007798671722412109
r_  generation:  0.007214784622192383
local_output_nid generation:  0.0002853870391845703
local_in_edges_tensor generation:  0.0005269050598144531
mini_batch_src_global generation:  0.0006430149078369141
r_  generation:  0.006656169891357422
----------------------check_connections_block total spend ----------------------------- 0.05191445350646973
generate_one_block  0.014900445938110352
generate_one_block  0.01694941520690918
generate_one_block  0.011292457580566406
generate_one_block  0.009612560272216797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007703304290771484  GigaBytes
Max Memory Allocated: 0.007703304290771484  GigaBytes

connection checking time:  0.06765508651733398
block generation total time  0.07273578643798828
average batch blocks generation time:  0.01818394660949707
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.02568960189819336  GigaBytes
Max Memory Allocated: 0.02568960189819336  GigaBytes

torch.Size([9486, 500])
torch.Size([3565, 32])
torch.Size([822, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.9605140686035156  GigaBytes
Max Memory Allocated: 1.010505199432373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.03823232650756836  GigaBytes
Max Memory Allocated: 1.010505199432373  GigaBytes

torch.Size([12062, 500])
torch.Size([3859, 32])
torch.Size([933, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.1424431800842285  GigaBytes
Max Memory Allocated: 1.2049083709716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.0324711799621582  GigaBytes
Max Memory Allocated: 1.2049083709716797  GigaBytes

torch.Size([9047, 500])
torch.Size([2350, 32])
torch.Size([562, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7218356132507324  GigaBytes
Max Memory Allocated: 1.2049083709716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.03131437301635742  GigaBytes
Max Memory Allocated: 1.2049083709716797  GigaBytes

torch.Size([8433, 500])
torch.Size([2662, 32])
torch.Size([574, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.662330150604248  GigaBytes
Max Memory Allocated: 1.2049083709716797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009223759174346924 |0.08539712429046631 |0.30219727754592896 |0.00016325712203979492 |0.22713398933410645 |0.010608434677124023 |
----------------------------------------------------------pseudo_mini_loss sum 1.9771976470947266
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  54712
Number of first layer input nodes during this epoch:  39028
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.047081947326660156  GigaBytes
Max Memory Allocated: 1.2049083709716797  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000518798828125
random selection method range initialization spend 0.00012421607971191406
time for parepare:  5.626678466796875e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  4.100799560546875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.9577484130859375e-05
----------------------check_connections_block total spend ----------------------------- 0.0010986328125
generate_one_block  0.0014834403991699219
generate_one_block  0.0011649131774902344
generate_one_block  0.0010943412780761719
generate_one_block  0.0010840892791748047
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005934238433837891
gen group dst list time:  3.528594970703125e-05
time for parepare:  0.00026154518127441406
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.00027441978454589844
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.00037932395935058594
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.000308990478515625
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0003669261932373047
----------------------check_connections_block total spend ----------------------------- 0.002979755401611328
generate_one_block  0.0015115737915039062
generate_one_block  0.0016031265258789062
generate_one_block  0.0016295909881591797
generate_one_block  0.0015416145324707031
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010981559753417969
gen group dst list time:  8.749961853027344e-05
time for parepare:  0.0007474422454833984
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.0003056526184082031
mini_batch_src_global generation:  0.0001723766326904297
r_  generation:  0.001567840576171875
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.00024127960205078125
mini_batch_src_global generation:  0.00031065940856933594
r_  generation:  0.002637147903442383
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  0.00019812583923339844
r_  generation:  0.0016884803771972656
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.00023126602172851562
mini_batch_src_global generation:  0.00024700164794921875
r_  generation:  0.002500772476196289
----------------------check_connections_block total spend ----------------------------- 0.013612985610961914
generate_one_block  0.003410816192626953
generate_one_block  0.004601240158081055
generate_one_block  0.003133058547973633
generate_one_block  0.004196643829345703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020170211791992188
gen group dst list time:  0.00023365020751953125
time for parepare:  0.001374959945678711
local_output_nid generation:  0.00028228759765625
local_in_edges_tensor generation:  0.0007932186126708984
mini_batch_src_global generation:  0.0008337497711181641
r_  generation:  0.006658315658569336
local_output_nid generation:  0.00031065940856933594
local_in_edges_tensor generation:  0.0006506443023681641
mini_batch_src_global generation:  0.001088857650756836
r_  generation:  0.010845184326171875
local_output_nid generation:  0.0002551078796386719
local_in_edges_tensor generation:  0.0005295276641845703
mini_batch_src_global generation:  0.0007658004760742188
r_  generation:  0.007178306579589844
local_output_nid generation:  0.0002944469451904297
local_in_edges_tensor generation:  0.0005846023559570312
mini_batch_src_global generation:  0.0008671283721923828
r_  generation:  0.008425235748291016
----------------------check_connections_block total spend ----------------------------- 0.05011439323425293
generate_one_block  0.010982275009155273
generate_one_block  0.014690637588500977
generate_one_block  0.011859893798828125
generate_one_block  0.014293909072875977
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.047081947326660156  GigaBytes
Max Memory Allocated: 1.2049083709716797  GigaBytes

connection checking time:  0.06670713424682617
block generation total time  0.07345438003540039
average batch blocks generation time:  0.018363595008850098
block dataloader generation time/epoch 0.18813395500183105
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.04794597625732422  GigaBytes
Max Memory Allocated: 1.2049083709716797  GigaBytes

torch.Size([9034, 500])
torch.Size([2699, 32])
torch.Size([597, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.7402257919311523  GigaBytes
Max Memory Allocated: 1.2049083709716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.05124044418334961  GigaBytes
Max Memory Allocated: 1.2049083709716797  GigaBytes

torch.Size([10742, 500])
torch.Size([3725, 32])
torch.Size([808, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.062657356262207  GigaBytes
Max Memory Allocated: 1.2049083709716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.05066871643066406  GigaBytes
Max Memory Allocated: 1.2049083709716797  GigaBytes

torch.Size([10173, 500])
torch.Size([2774, 32])
torch.Size([689, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.8021888732910156  GigaBytes
Max Memory Allocated: 1.2049083709716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.05074024200439453  GigaBytes
Max Memory Allocated: 1.2049083709716797  GigaBytes

torch.Size([10326, 500])
torch.Size([3141, 32])
torch.Size([770, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.9852123260498047  GigaBytes
Max Memory Allocated: 1.2049083709716797  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01342707872390747 |0.0017654895782470703 |0.17670035362243652 |0.00014197826385498047 |0.23147928714752197 |0.007894277572631836 |
----------------------------------------------------------pseudo_mini_loss sum 1.5231668949127197
Total (block generation + training)time/epoch 1.8986272811889648
Training time/epoch 1.7102046012878418
Training time without block to device /epoch 1.7031426429748535
Training time without total dataloading part /epoch 1.6411807537078857
load block tensor time/epoch 0.05370831489562988
block to device time/epoch 0.007061958312988281
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  55835
Number of first layer input nodes during this epoch:  40275
