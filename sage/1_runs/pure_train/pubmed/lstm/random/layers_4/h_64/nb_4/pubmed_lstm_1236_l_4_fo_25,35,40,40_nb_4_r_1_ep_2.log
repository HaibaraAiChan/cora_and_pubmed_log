main start at this time 1648531089.0960987
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00814676284790039  GigaBytes
Max Memory Allocated: 0.00814676284790039  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001657247543334961
random selection method range initialization spend 0.00018596649169921875
time for parepare:  5.8650970458984375e-05
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0013725757598876953
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  7.2479248046875e-05
----------------------check_connections_block total spend ----------------------------- 0.002162456512451172
generate_one_block  0.0015287399291992188
generate_one_block  0.0014848709106445312
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011365413665771484
gen group dst list time:  3.4809112548828125e-05
time for parepare:  0.00030040740966796875
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00023317337036132812
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0007767677307128906
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0007898807525634766
----------------------check_connections_block total spend ----------------------------- 0.0029511451721191406
generate_one_block  0.002341032028198242
generate_one_block  0.0022547245025634766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011835098266601562
gen group dst list time:  8.249282836914062e-05
time for parepare:  0.0009212493896484375
local_output_nid generation:  0.00013399124145507812
local_in_edges_tensor generation:  0.00045299530029296875
mini_batch_src_global generation:  0.0004734992980957031
r_  generation:  0.004966020584106445
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.0003643035888671875
mini_batch_src_global generation:  0.0006301403045654297
r_  generation:  0.004725217819213867
----------------------check_connections_block total spend ----------------------------- 0.015637874603271484
generate_one_block  0.006318330764770508
generate_one_block  0.005548715591430664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022034645080566406
gen group dst list time:  0.0002570152282714844
time for parepare:  0.001668691635131836
local_output_nid generation:  0.0005915164947509766
local_in_edges_tensor generation:  0.0013265609741210938
mini_batch_src_global generation:  0.0016243457794189453
r_  generation:  0.016278743743896484
local_output_nid generation:  0.0003941059112548828
local_in_edges_tensor generation:  0.0008320808410644531
mini_batch_src_global generation:  0.001783609390258789
r_  generation:  0.012704133987426758
----------------------check_connections_block total spend ----------------------------- 0.044890642166137695
generate_one_block  0.018842458724975586
generate_one_block  0.018512487411499023
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00814676284790039  GigaBytes
Max Memory Allocated: 0.00814676284790039  GigaBytes

connection checking time:  0.06347966194152832
block generation total time  0.0538177490234375
average batch blocks generation time:  0.02690887451171875
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1268310546875 GB
    Memory Allocated: 0.034000396728515625  GigaBytes
Max Memory Allocated: 0.034000396728515625  GigaBytes

torch.Size([13513, 500])
torch.Size([5876, 64])
torch.Size([1415, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7459716796875 GB
    Memory Allocated: 1.4522385597229004  GigaBytes
Max Memory Allocated: 1.4955382347106934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7459716796875 GB
    Memory Allocated: 0.041242122650146484  GigaBytes
Max Memory Allocated: 1.4955382347106934  GigaBytes

torch.Size([13166, 500])
torch.Size([4740, 64])
torch.Size([1388, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 1.3336071968078613  GigaBytes
Max Memory Allocated: 1.4955382347106934  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012511134147644043 |0.17175722122192383 |0.4629402160644531 |0.00017690658569335938 |0.2642052173614502 |0.008891820907592773 |
----------------------------------------------------------pseudo_mini_loss sum 2.0217885971069336
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  40455
Number of first layer input nodes during this epoch:  26679
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.058658599853515625  GigaBytes
Max Memory Allocated: 1.4955382347106934  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.004621267318725586
random selection method range initialization spend 0.00012254714965820312
time for parepare:  5.1021575927734375e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.794929504394531e-05
----------------------check_connections_block total spend ----------------------------- 0.0007159709930419922
generate_one_block  0.0013244152069091797
generate_one_block  0.0011126995086669922
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005710124969482422
gen group dst list time:  2.8371810913085938e-05
time for parepare:  0.0002541542053222656
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  0.00012636184692382812
r_  generation:  0.0006291866302490234
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.0006232261657714844
----------------------check_connections_block total spend ----------------------------- 0.0025069713592529297
generate_one_block  0.0020635128021240234
generate_one_block  0.0019054412841796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001050710678100586
gen group dst list time:  7.081031799316406e-05
time for parepare:  0.0007116794586181641
local_output_nid generation:  0.00014090538024902344
local_in_edges_tensor generation:  0.0004177093505859375
mini_batch_src_global generation:  0.0004966259002685547
r_  generation:  0.004118919372558594
local_output_nid generation:  0.00012373924255371094
local_in_edges_tensor generation:  0.0002970695495605469
mini_batch_src_global generation:  0.0005078315734863281Using backend: pytorch

r_  generation:  0.0037834644317626953
----------------------check_connections_block total spend ----------------------------- 0.012893438339233398
generate_one_block  0.0069217681884765625
generate_one_block  0.005986213684082031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002087116241455078
gen group dst list time:  0.000217437744140625
time for parepare:  0.0012927055358886719
local_output_nid generation:  0.00040841102600097656
local_in_edges_tensor generation:  0.001125335693359375
mini_batch_src_global generation:  0.0013315677642822266
r_  generation:  0.0130157470703125
local_output_nid generation:  0.00041103363037109375
local_in_edges_tensor generation:  0.0008158683776855469
mini_batch_src_global generation:  0.0013687610626220703
r_  generation:  0.012908697128295898
----------------------check_connections_block total spend ----------------------------- 0.039092302322387695
generate_one_block  0.019275426864624023
generate_one_block  0.019367218017578125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.058658599853515625  GigaBytes
Max Memory Allocated: 1.4955382347106934  GigaBytes

connection checking time:  0.05449271202087402
block generation total time  0.05551958084106445
average batch blocks generation time:  0.027759790420532227
block dataloader generation time/epoch 0.14355778694152832
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.057843685150146484  GigaBytes
Max Memory Allocated: 1.4955382347106934  GigaBytes

torch.Size([13033, 500])
torch.Size([5276, 64])
torch.Size([1388, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8846435546875 GB
    Memory Allocated: 1.4060287475585938  GigaBytes
Max Memory Allocated: 1.4955382347106934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8846435546875 GB
    Memory Allocated: 0.05886507034301758  GigaBytes
Max Memory Allocated: 1.4955382347106934  GigaBytes

torch.Size([13589, 500])
torch.Size([5213, 64])
torch.Size([1402, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8846435546875 GB
    Memory Allocated: 1.3897829055786133  GigaBytes
Max Memory Allocated: 1.4955382347106934  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007439613342285156 |0.0012178421020507812 |0.20386111736297607 |0.00013744831085205078 |0.2657545804977417 |0.008726358413696289 |
----------------------------------------------------------pseudo_mini_loss sum 1.7899389266967773
Total (block generation + training)time/epoch 1.115023136138916
Training time/epoch 0.9712560176849365
Training time without block to device /epoch 0.968820333480835
Training time without total dataloading part /epoch 0.9482326507568359
load block tensor time/epoch 0.014879226684570312
block to device time/epoch 0.0024356842041015625
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  40256
Number of first layer input nodes during this epoch:  26622
