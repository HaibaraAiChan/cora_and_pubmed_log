main start at this time 1648531101.234351
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00814676284790039  GigaBytes
Max Memory Allocated: 0.00814676284790039  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.002103567123413086
random selection method range initialization spend 0.0002238750457763672
time for parepare:  4.8160552978515625e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0025937557220458984
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.86102294921875e-05
----------------------check_connections_block total spend ----------------------------- 0.0036656856536865234
generate_one_block  0.0014581680297851562
generate_one_block  0.0010986328125
generate_one_block  0.0011038780212402344
generate_one_block  0.001071929931640625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010340213775634766
gen group dst list time:  3.361701965332031e-05
time for parepare:  0.0002391338348388672
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00047326087951660156
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00022745132446289062
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0004525184631347656
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00021791458129882812
----------------------check_connections_block total spend ----------------------------- 0.002862691879272461
generate_one_block  0.0016756057739257812
generate_one_block  0.001344919204711914
generate_one_block  0.001623392105102539
generate_one_block  0.001367330551147461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001026153564453125
gen group dst list time:  8.678436279296875e-05
time for parepare:  0.0007696151733398438
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.00035071372985839844
mini_batch_src_global generation:  0.00022792816162109375
r_  generation:  0.002810239791870117
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  0.0002460479736328125
r_  generation:  0.0016388893127441406
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  0.0002923011779785156
r_  generation:  0.002908468246459961
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.00016999244689941406
r_  generation:  0.0012676715850830078
----------------------check_connections_block total spend ----------------------------- 0.013895034790039062
generate_one_block  0.004670143127441406
generate_one_block  0.0029430389404296875
generate_one_block  0.004523038864135742
generate_one_block  0.0023794174194335938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020990371704101562
gen group dst list time:  0.00023221969604492188
time for parepare:  0.001550912857055664
local_output_nid generation:  0.00028634071350097656
local_in_edges_tensor generation:  0.0009038448333740234
mini_batch_src_global generation:  0.001064300537109375
r_  generation:  0.010369539260864258
local_output_nid generation:  0.0002505779266357422
local_in_edges_tensor generation:  0.0005490779876708984
mini_batch_src_global generation:  0.0010638236999511719
r_  generation:  0.00783848762512207
local_output_nid generation:  0.000308990478515625
local_in_edges_tensor generation:  0.0006177425384521484
mini_batch_src_global generation:  0.0010638236999511719
r_  generation:  0.010657072067260742
local_output_nid generation:  0.00017905235290527344
local_in_edges_tensor generation:  0.0004017353057861328
mini_batch_src_global generation:  0.0007042884826660156
r_  generation:  0.006189107894897461
----------------------check_connections_block total spend ----------------------------- 0.0527493953704834
generate_one_block  0.014389991760253906
generate_one_block  0.012340545654296875
generate_one_block  0.015577316284179688
generate_one_block  0.00962209701538086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00814676284790039  GigaBytes
Max Memory Allocated: 0.00814676284790039  GigaBytes

connection checking time:  0.06950712203979492
block generation total time  0.07245683670043945
average batch blocks generation time:  0.018114209175109863
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1229248046875 GB
    Memory Allocated: 0.029970169067382812  GigaBytes
Max Memory Allocated: 0.029970169067382812  GigaBytes

torch.Size([11265, 500])
torch.Size([3805, 64])
torch.Size([970, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 1.080404281616211  GigaBytes
Max Memory Allocated: 1.1161627769470215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.034121036529541016  GigaBytes
Max Memory Allocated: 1.1161627769470215  GigaBytes

torch.Size([9308, 500])
torch.Size([3074, 64])
torch.Size([476, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8637790679931641  GigaBytes
Max Memory Allocated: 1.1161627769470215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.038208961486816406  GigaBytes
Max Memory Allocated: 1.1161627769470215  GigaBytes

torch.Size([11579, 500])
torch.Size([3633, 64])
torch.Size([893, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 1.1158852577209473  GigaBytes
Max Memory Allocated: 1.1514015197753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.03235006332397461  GigaBytes
Max Memory Allocated: 1.1514015197753906  GigaBytes

torch.Size([8519, 500])
torch.Size([1962, 64])
torch.Size([520, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.6579561233520508  GigaBytes
Max Memory Allocated: 1.1514015197753906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011045336723327637 |0.08476626873016357 |0.3048003315925598 |0.0001747608184814453 |0.22618824243545532 |0.009680032730102539 |
----------------------------------------------------------pseudo_mini_loss sum 1.8445297479629517
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  56361
Number of first layer input nodes during this epoch:  40671
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.04982900619506836  GigaBytes
Max Memory Allocated: 1.1514015197753906  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006108283996582031
random selection method range initialization spend 0.0001418590545654297
time for parepare:  6.818771362304688e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.316734313964844e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  4.3392181396484375e-05
----------------------check_connections_block total spend ----------------------------- 0.0012810230255126953
generate_one_block  0.0015091896057128906
generate_one_block  0.001340627670288086
generate_one_block  0.0013384819030761719
generate_one_block  0.0013086795806884766
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00066375732421875
gen group dst list time:  4.410743713378906e-05
time for parepare:  0.00030875205993652344
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00024199485778808594
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0005023479461669922
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.00031304359436035156
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00037097930908203125
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.00042939186096191406
----------------------check_connections_block total spend ----------------------------- 0.0035827159881591797
generate_one_block  0.002034902572631836
generate_one_block  0.0017075538635253906
generate_one_block  0.001963376998901367
generate_one_block  0.0018661022186279297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012507438659667969
gen group dst list time:  0.00010466575622558594
time for parepare:  0.0009653568267822266
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.0003833770751953125
mini_batch_src_global generation:  0.00038361549377441406
r_  generation:  0.00341033935546875
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.00025725364685058594
mini_batch_src_global generation:  0.0002803802490234375
r_  generation:  0.0021431446075439453
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.00025463104248046875
mini_batch_src_global generation:  0.00020885467529296875
r_  generation:  0.0019583702087402344
local_output_nid generation:  9.751319885253906e-05
local_in_edges_tensor generation:  0.0002770423889160156
mini_batch_src_global generation:  0.00029969215393066406
r_  generation:  0.002767324447631836
----------------------check_connections_block total spend ----------------------------- 0.016812801361083984
generate_one_block  0.0046291351318359375
generate_one_block  0.003209352493286133
generate_one_block  0.0029363632202148438
generate_one_block  0.004341840744018555
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020110607147216797
gen group dst list time:  0.000308990478515625
time for parepare:  0.0017473697662353516
local_output_nid generation:  0.00044798851013183594
local_in_edges_tensor generation:  0.0009894371032714844
mini_batch_src_global generation:  0.0013380050659179688
r_  generation:  0.010916709899902344
local_output_nid generation:  0.00026702880859375
local_in_edges_tensor generation:  0.0005359649658203125
mini_batch_src_global generation:  0.001056671142578125
r_  generation:  0.007668733596801758
local_output_nid generation:  0.0002446174621582031
local_in_edges_tensor generation:  0.000484466552734375
mini_batch_src_global generation:  0.0007014274597167969
r_  generation:  0.006817817687988281
local_output_nid generation:  0.0013649463653564453
local_in_edges_tensor generation:  0.0005733966827392578
mini_batch_src_global generation:  0.0012450218200683594
r_  generation:  0.012470722198486328
----------------------check_connections_block total spend ----------------------------- 0.059046030044555664
generate_one_block  0.014379024505615234
generate_one_block  0.011690378189086914
generate_one_block  0.010886192321777344
generate_one_block  0.014171600341796875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.04982900619506836  GigaBytes
Max Memory Allocated: 1.1514015197753906  GigaBytes

connection checking time:  0.07944154739379883
block generation total time  0.07381582260131836
average batch blocks generation time:  0.01845395565032959
block dataloader generation time/epoch 0.20485949516296387
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.05196237564086914  GigaBytes
Max Memory Allocated: 1.1514015197753906  GigaBytes

torch.Size([9731, 500])
torch.Size([3428, 64])
torch.Size([808, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 1.000396728515625  GigaBytes
Max Memory Allocated: 1.1514015197753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.053308963775634766  GigaBytes
Max Memory Allocated: 1.1514015197753906  GigaBytes

torch.Size([10108, 500])
torch.Size([2824, 64])
torch.Size([622, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.8794903755187988  GigaBytes
Max Memory Allocated: 1.1514015197753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.05328512191772461  GigaBytes
Max Memory Allocated: 1.1514015197753906  GigaBytes

torch.Size([10374, 500])
torch.Size([2580, 64])
torch.Size([655, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.7948541641235352  GigaBytes
Max Memory Allocated: 1.1514015197753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.05337667465209961  GigaBytes
Max Memory Allocated: 1.1514015197753906  GigaBytes

torch.Size([10122, 500])
torch.Size([3687, 64])
torch.Size([799, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 1.0587763786315918  GigaBytes
Max Memory Allocated: 1.1514015197753906  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009127378463745117 |0.0015312433242797852 |0.18155813217163086 |0.00013816356658935547 |0.24086332321166992 |0.009180068969726562 |
----------------------------------------------------------pseudo_mini_loss sum 1.927270531654358
Total (block generation + training)time/epoch 1.9565951824188232
Training time/epoch 1.7512829303741455
Training time without block to device /epoch 1.7451579570770264
Training time without total dataloading part /epoch 1.699418544769287
load block tensor time/epoch 0.03650951385498047
block to device time/epoch 0.006124973297119141
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  56095
Number of first layer input nodes during this epoch:  40335
