main start at this time 1648531114.9408038
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00814676284790039  GigaBytes
Max Memory Allocated: 0.00814676284790039  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.003101348876953125
random selection method range initialization spend 0.00019097328186035156
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.0011899471282958984
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5974044799804688e-05
----------------------check_connections_block total spend ----------------------------- 0.0028159618377685547
generate_one_block  0.0013148784637451172
generate_one_block  0.0010683536529541016
generate_one_block  0.0010194778442382812
generate_one_block  0.0010080337524414062
generate_one_block  0.0010268688201904297
generate_one_block  0.0010249614715576172
generate_one_block  0.0009911060333251953
generate_one_block  0.0009791851043701172
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0015883445739746094
gen group dst list time:  5.054473876953125e-05
time for parepare:  0.00023508071899414062
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00023698806762695312
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.000255584716796875
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.00022125244140625
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00013756752014160156
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.0002262592315673828
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00010728836059570312
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00017452239990234375
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00015497207641601562
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.8650970458984375e-05
----------------------check_connections_block total spend ----------------------------- 0.003459453582763672
generate_one_block  0.001367807388305664
generate_one_block  0.0012829303741455078
generate_one_block  0.0011730194091796875
generate_one_block  0.0012745857238769531
generate_one_block  0.0011105537414550781
generate_one_block  0.0012860298156738281
generate_one_block  0.0012192726135253906
generate_one_block  0.0010335445404052734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011525154113769531
gen group dst list time:  9.131431579589844e-05
time for parepare:  0.0007455348968505859
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.0002961158752441406
mini_batch_src_global generation:  0.00014853477478027344
r_  generation:  0.0016663074493408203
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.0002193450927734375
r_  generation:  0.0015227794647216797
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.0009768009185791016
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  0.00015616416931152344
r_  generation:  0.0015361309051513672
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  0.00010704994201660156
r_  generation:  0.0007016658782958984
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.0001049041748046875
r_  generation:  0.0010173320770263672
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  0.0001087188720703125
r_  generation:  0.0009510517120361328
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0002543926239013672
----------------------check_connections_block total spend ----------------------------- 0.014536857604980469
generate_one_block  0.003172159194946289
generate_one_block  0.0029120445251464844
generate_one_block  0.0021114349365234375
generate_one_block  0.002878904342651367
generate_one_block  0.0018088817596435547
generate_one_block  0.0021991729736328125
generate_one_block  0.0021677017211914062
generate_one_block  0.0012269020080566406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019588470458984375
gen group dst list time:  0.0002474784851074219
time for parepare:  0.0015285015106201172
local_output_nid generation:  0.00018477439880371094
local_in_edges_tensor generation:  0.0007436275482177734
mini_batch_src_global generation:  0.0007851123809814453
r_  generation:  0.006171226501464844
local_output_nid generation:  0.00021839141845703125
local_in_edges_tensor generation:  0.0005037784576416016
mini_batch_src_global generation:  0.0008080005645751953
r_  generation:  0.006463289260864258
local_output_nid generation:  0.00016069412231445312
local_in_edges_tensor generation:  0.0003840923309326172
mini_batch_src_global generation:  0.0005309581756591797
r_  generation:  0.005163431167602539
local_output_nid generation:  0.0001544952392578125
local_in_edges_tensor generation:  0.0003573894500732422
mini_batch_src_global generation:  0.0005097389221191406
r_  generation:  0.0052683353424072266
local_output_nid generation:  0.00010418891906738281
local_in_edges_tensor generation:  0.0002753734588623047
mini_batch_src_global generation:  0.00039577484130859375
r_  generation:  0.0035920143127441406
local_output_nid generation:  0.00013637542724609375
local_in_edges_tensor generation:  0.0003266334533691406
mini_batch_src_global generation:  0.0004284381866455078
r_  generation:  0.004609107971191406
local_output_nid generation:  0.00013446807861328125
local_in_edges_tensor generation:  0.0003256797790527344
mini_batch_src_global generation:  0.0005011558532714844
r_  generation:  0.0049304962158203125
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  0.00022459030151367188
r_  generation:  0.0011801719665527344
----------------------check_connections_block total spend ----------------------------- 0.05670881271362305
generate_one_block  0.009068727493286133
generate_one_block  0.009314775466918945
generate_one_block  0.007708311080932617
generate_one_block  0.007956266403198242
generate_one_block  0.005988359451293945
generate_one_block  0.007190227508544922
generate_one_block  0.007814884185791016
generate_one_block  0.002299070358276367
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00814676284790039  GigaBytes
Max Memory Allocated: 0.00814676284790039  GigaBytes

connection checking time:  0.07470512390136719
block generation total time  0.08556556701660156
average batch blocks generation time:  0.010695695877075195
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.022035598754882812  GigaBytes
Max Memory Allocated: 0.022035598754882812  GigaBytes

torch.Size([7009, 500])
torch.Size([2285, 64])
torch.Size([549, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9256591796875 GB
    Memory Allocated: 0.6863903999328613  GigaBytes
Max Memory Allocated: 0.7091736793518066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9256591796875 GB
    Memory Allocated: 0.03278541564941406  GigaBytes
Max Memory Allocated: 0.7091736793518066  GigaBytes

torch.Size([8743, 500])
torch.Size([2766, 64])
torch.Size([526, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.7025618553161621  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.02855539321899414  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

torch.Size([6493, 500])
torch.Size([1865, 64])
torch.Size([272, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.5923237800598145  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.028567790985107422  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

torch.Size([6247, 500])
torch.Size([1830, 64])
torch.Size([420, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.6225991249084473  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.025485515594482422  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

torch.Size([4872, 500])
torch.Size([1270, 64])
torch.Size([224, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.4155745506286621  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.03045654296875  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

torch.Size([7523, 500])
torch.Size([1683, 64])
torch.Size([418, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.5241861343383789  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.030875205993652344  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

torch.Size([7742, 500])
torch.Size([1583, 64])
torch.Size([398, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.570946216583252  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.01979970932006836  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

torch.Size([1865, 500])
torch.Size([393, 64])
torch.Size([107, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.12404584884643555  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0066031813621521 |0.04369977116584778 |0.21394699811935425 |0.000141829252243042 |0.19463545083999634 |0.010548114776611328 |
----------------------------------------------------------pseudo_mini_loss sum 1.7491732835769653
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  67440
Number of first layer input nodes during this epoch:  50494
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.0361323356628418  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005238056182861328
random selection method range initialization spend 0.00013113021850585938
time for parepare:  6.246566772460938e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.71661376953125e-05
----------------------check_connections_block total spend ----------------------------- 0.0017998218536376953
generate_one_block  0.0014264583587646484
generate_one_block  0.0011141300201416016
generate_one_block  0.0013349056243896484
generate_one_block  0.001085042953491211
generate_one_block  0.001024484634399414
generate_one_block  0.0010268688201904297
generate_one_block  0.0010612010955810547
generate_one_block  0.0010290145874023438
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005583763122558594
gen group dst list time:  5.1021575927734375e-05
time for parepare:  0.0002658367156982422
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00022292137145996094
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0002200603485107422
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00016832351684570312
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001647472381591797
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00018835067749023438
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001506805419921875
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00023126602172851562
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  9.1552734375e-05
----------------------check_connections_block total spend ----------------------------- 0.0037384033203125
generate_one_block  0.0013475418090820312
generate_one_block  0.0013556480407714844
generate_one_block  0.001199483871459961
generate_one_block  0.0012023448944091797
generate_one_block  0.0013053417205810547
generate_one_block  0.0012121200561523438
generate_one_block  0.0013680458068847656
generate_one_block  0.0011849403381347656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010492801666259766
gen group dst list time:  0.00010275840759277344
time for parepare:  0.0007648468017578125
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.00030159950256347656
mini_batch_src_global generation:  0.00022840499877929688
r_  generation:  0.001638650894165039
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.00018715858459472656
r_  generation:  0.0013544559478759766
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0008862018585205078
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0010085105895996094
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.0011012554168701172
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0006811618804931641
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.0001735687255859375
r_  generation:  0.0018773078918457031
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.000431060791015625
----------------------check_connections_block total spend ----------------------------- 0.01555633544921875
generate_one_block  0.0033288002014160156
generate_one_block  0.0026891231536865234
generate_one_block  0.0021097660064697266
generate_one_block  0.0022878646850585938
generate_one_block  0.002331972122192383
generate_one_block  0.001787424087524414
generate_one_block  0.00441288948059082
generate_one_block  0.0014739036560058594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001999378204345703
gen group dst list time:  0.00030541419982910156
time for parepare:  0.0015680789947509766
local_output_nid generation:  0.00023484230041503906
local_in_edges_tensor generation:  0.0007376670837402344
mini_batch_src_global generation:  0.0007145404815673828
r_  generation:  0.005989789962768555
local_output_nid generation:  0.00022292137145996094
local_in_edges_tensor generation:  0.000457763671875
mini_batch_src_global generation:  0.000705718994140625
r_  generation:  0.005687713623046875
local_output_nid generation:  0.00015234947204589844
local_in_edges_tensor generation:  0.0003559589385986328
mini_batch_src_global generation:  0.0004477500915527344
r_  generation:  0.004240274429321289
local_output_nid generation:  0.00019478797912597656
local_in_edges_tensor generation:  0.0003845691680908203
mini_batch_src_global generation:  0.0004980564117431641
r_  generation:  0.005337715148925781
local_output_nid generation:  0.00017905235290527344
local_in_edges_tensor generation:  0.000370025634765625
mini_batch_src_global generation:  0.0005464553833007812
r_  generation:  0.005491495132446289
local_output_nid generation:  0.000110626220703125
local_in_edges_tensor generation:  0.0002808570861816406
mini_batch_src_global generation:  0.0003752708435058594
r_  generation:  0.002995014190673828
local_output_nid generation:  0.0002751350402832031
local_in_edges_tensor generation:  0.0004649162292480469
mini_batch_src_global generation:  0.0006127357482910156
r_  generation:  0.007469654083251953
local_output_nid generation:  9.298324584960938e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  0.00037288665771484375
r_  generation:  0.0023717880249023438
----------------------check_connections_block total spend ----------------------------- 0.06040787696838379
generate_one_block  0.009278535842895508
generate_one_block  0.00850820541381836
generate_one_block  0.007071018218994141
generate_one_block  0.008567333221435547
generate_one_block  0.01496434211730957
generate_one_block  0.008677482604980469
generate_one_block  0.012828588485717773
generate_one_block  0.0043032169342041016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.0361323356628418  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

connection checking time:  0.07970261573791504
block generation total time  0.10479593276977539
average batch blocks generation time:  0.013099491596221924
block dataloader generation time/epoch 0.266934871673584Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.04447793960571289  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

torch.Size([6279, 500])
torch.Size([1913, 64])
torch.Size([406, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.680213451385498  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.04610872268676758  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

torch.Size([7169, 500])
torch.Size([2103, 64])
torch.Size([436, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.6155056953430176  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.046381473541259766  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

torch.Size([7282, 500])
torch.Size([1469, 64])
torch.Size([352, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.484494686126709  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.04583406448364258  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

torch.Size([7026, 500])
torch.Size([1855, 64])
torch.Size([326, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.6152224540710449  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.04916715621948242  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

torch.Size([8811, 500])
torch.Size([1866, 64])
torch.Size([431, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.6435966491699219  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.041848182678222656  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

torch.Size([4926, 500])
torch.Size([1022, 64])
torch.Size([293, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.3456425666809082  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.04850435256958008  GigaBytes
Max Memory Allocated: 0.7304291725158691  GigaBytes

torch.Size([8415, 500])
torch.Size([2791, 64])
torch.Size([525, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.8497366905212402  GigaBytes
Max Memory Allocated: 0.8832554817199707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.03949594497680664  GigaBytes
Max Memory Allocated: 0.8832554817199707  GigaBytes

torch.Size([3677, 500])
torch.Size([786, 64])
torch.Size([143, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.26777076721191406  GigaBytes
Max Memory Allocated: 0.8832554817199707  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01350325345993042 |0.0018411874771118164 |0.1524564027786255 |0.00013065338134765625 |0.19314450025558472 |0.008912801742553711 |
----------------------------------------------------------pseudo_mini_loss sum 1.8195687532424927
Total (block generation + training)time/epoch 3.1808788776397705
Training time/epoch 2.913585662841797
Training time without block to device /epoch 2.8988561630249023
Training time without total dataloading part /epoch 2.7747652530670166
load block tensor time/epoch 0.10802602767944336
block to device time/epoch 0.014729499816894531
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  70658
Number of first layer input nodes during this epoch:  53585
