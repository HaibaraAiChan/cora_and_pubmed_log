main start at this time 1648528260.777963
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013725757598876953
random selection method range initialization spend 0.00019693374633789062
time for parepare:  4.57763671875e-05
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.001531839370727539
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.62396240234375e-05
----------------------check_connections_block total spend ----------------------------- 0.0025892257690429688
generate_one_block  0.0013263225555419922
generate_one_block  0.0011608600616455078
generate_one_block  0.0010962486267089844
generate_one_block  0.0010898113250732422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009045600891113281
gen group dst list time:  3.9577484130859375e-05
time for parepare:  0.00025272369384765625
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.00045013427734375
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0002694129943847656
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00020575523376464844
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.0004553794860839844
----------------------check_connections_block total spend ----------------------------- 0.0029304027557373047
generate_one_block  0.001689910888671875
generate_one_block  0.0014238357543945312
generate_one_block  0.001314401626586914
generate_one_block  0.0016753673553466797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010120868682861328
gen group dst list time:  7.724761962890625e-05
time for parepare:  0.0007772445678710938
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.0003514289855957031
mini_batch_src_global generation:  0.00020432472229003906
r_  generation:  0.0025565624237060547
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.00021982192993164062
r_  generation:  0.0017998218536376953
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.00012421607971191406
r_  generation:  0.0010178089141845703
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.0004010200500488281
mini_batch_src_global generation:  0.0002295970916748047
r_  generation:  0.0027153491973876953
----------------------check_connections_block total spend ----------------------------- 0.013102531433105469
generate_one_block  0.005316019058227539
generate_one_block  0.003045797348022461
generate_one_block  0.002080678939819336
generate_one_block  0.0040476322174072266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

connection checking time:  0.016032934188842773
block generation total time  0.020593643188476562
average batch blocks generation time:  0.005148410797119141
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.015620708465576172  GigaBytes
Max Memory Allocated: 0.015620708465576172  GigaBytes

torch.Size([4234, 500])
torch.Size([1025, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.2529926300048828  GigaBytes
Max Memory Allocated: 0.2687797546386719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.021465778350830078  GigaBytes
Max Memory Allocated: 0.2687797546386719  GigaBytes

torch.Size([2793, 500])
torch.Size([571, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.18275022506713867  GigaBytes
Max Memory Allocated: 0.2687797546386719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.01921987533569336  GigaBytes
Max Memory Allocated: 0.2687797546386719  GigaBytes

torch.Size([1598, 500])
torch.Size([473, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.1066431999206543  GigaBytes
Max Memory Allocated: 0.2687797546386719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.02154827117919922  GigaBytes
Max Memory Allocated: 0.2687797546386719  GigaBytes

torch.Size([2820, 500])
torch.Size([855, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.28606128692626953  GigaBytes
Max Memory Allocated: 0.30544137954711914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0038367509841918945 |0.08881258964538574 |0.23977279663085938 |0.00015437602996826172 |0.20284301042556763 |0.007647991180419922 |
----------------------------------------------------------pseudo_mini_loss sum 2.1378517150878906
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14725
Number of first layer input nodes during this epoch:  11445
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.036977291107177734  GigaBytes
Max Memory Allocated: 0.30544137954711914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005924701690673828
random selection method range initialization spend 0.0001316070556640625
time for parepare:  6.389617919921875e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  6.151199340820312e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00013518333435058594
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  5.626678466796875e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.0279159545898438e-05
----------------------check_connections_block total spend ----------------------------- 0.001336812973022461
generate_one_block  0.0014069080352783203
generate_one_block  0.0013129711151123047
generate_one_block  0.0013401508331298828
generate_one_block  0.0012888908386230469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006508827209472656
gen group dst list time:  4.696846008300781e-05
time for parepare:  0.00031280517578125
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0002646446228027344
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0005426406860351562
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.00030684471130371094
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0006082057952880859
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00022149085998535156
----------------------check_connections_block total spend ----------------------------- 0.0036416053771972656
generate_one_block  0.0021271705627441406
generate_one_block  0.0016751289367675781
generate_one_block  0.0024993419647216797
generate_one_block  0.0015451908111572266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011806488037109375
gen group dst list time:  0.00010752677917480469
time for parepare:  0.0008997917175292969
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.000423431396484375
mini_batch_src_global generation:  0.0003418922424316406
r_  generation:  0.0033838748931884766
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.00024080276489257812
mini_batch_src_global generation:  0.00022482872009277344
r_  generation:  0.0013267993927001953
local_output_nid generation:  0.00012230873107910156
local_in_edges_tensor generation:  0.0003123283386230469
mini_batch_src_global generation:  0.00040531158447265625
r_  generation:  0.004027843475341797
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  0.0002117156982421875
r_  generation:  0.001116037368774414
----------------------check_connections_block total spend ----------------------------- 0.016528606414794922
generate_one_block  0.004820346832275391
generate_one_block  0.0022842884063720703
generate_one_block  0.005461931228637695
generate_one_block  0.0023283958435058594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.036977291107177734  GigaBytes
Max Memory Allocated: 0.30544137954711914  GigaBytes

connection checking time:  0.020170211791992188
block generation total time  0.02274179458618164
average batch blocks generation time:  0.00568544864654541
block dataloader generation time/epoch 0.0802459716796875
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.03860282897949219  GigaBytes
Max Memory Allocated: 0.30544137954711914  GigaBytes

torch.Size([3748, 500])
torch.Size([1059, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.30458593368530273  GigaBytes
Max Memory Allocated: 0.32294416427612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.034676551818847656  GigaBytes
Max Memory Allocated: 0.32294416427612305  GigaBytes

torch.Size([1650, 500])
torch.Size([536, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.12844133377075195  GigaBytes
Max Memory Allocated: 0.32294416427612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.04071950912475586  GigaBytes
Max Memory Allocated: 0.32294416427612305  GigaBytes

torch.Size([4874, 500])
torch.Size([1015, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.36910295486450195  GigaBytes
Max Memory Allocated: 0.39223384857177734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.03514289855957031  GigaBytes
Max Memory Allocated: 0.39223384857177734  GigaBytes

torch.Size([1916, 500])
torch.Size([388, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.13186168670654297  GigaBytes
Max Memory Allocated: 0.39223384857177734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005452871322631836 |0.0011255741119384766 |0.12658554315567017 |0.00013077259063720703 |0.2074076533317566 |0.009004831314086914 |
----------------------------------------------------------pseudo_mini_loss sum 1.6971757411956787
Total (block generation + training)time/epoch 1.4612362384796143
Training time/epoch 1.3807611465454102
Training time without block to device /epoch 1.3762588500976562
Training time without total dataloading part /epoch 1.3455007076263428
load block tensor time/epoch 0.021811485290527344
block to device time/epoch 0.004502296447753906
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15543
Number of first layer input nodes during this epoch:  12188
