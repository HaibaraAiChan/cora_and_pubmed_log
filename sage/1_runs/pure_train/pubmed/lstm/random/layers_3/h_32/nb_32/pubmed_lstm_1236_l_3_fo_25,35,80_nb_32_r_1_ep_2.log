main start at this time 1648528223.3464632
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019152164459228516
random selection method range initialization spend 0.00018453598022460938
time for parepare:  4.410743713378906e-05
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.0011479854583740234
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5497207641601562e-05
----------------------check_connections_block total spend ----------------------------- 0.003848552703857422
generate_one_block  0.0011913776397705078
generate_one_block  0.0009953975677490234
generate_one_block  0.0009911060333251953
generate_one_block  0.0010366439819335938
generate_one_block  0.0010023117065429688
generate_one_block  0.0009844303131103516
generate_one_block  0.0009899139404296875
generate_one_block  0.0010313987731933594
generate_one_block  0.0009851455688476562
generate_one_block  0.0009860992431640625
generate_one_block  0.0010180473327636719
generate_one_block  0.0010073184967041016
generate_one_block  0.0009856224060058594
generate_one_block  0.0009634494781494141
generate_one_block  0.0009551048278808594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011210441589355469
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.00023865699768066406
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0001468658447265625
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.054473876953125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0002276897430419922
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.937980651855469e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  9.5367431640625e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  0.00010371208190917969
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0001533031463623047
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0001404285430908203
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.988380432128906e-05
----------------------check_connections_block total spend ----------------------------- 0.00458979606628418
generate_one_block  0.0012426376342773438
generate_one_block  0.0010650157928466797
generate_one_block  0.0010800361633300781
generate_one_block  0.0012979507446289062
generate_one_block  0.0010631084442138672
generate_one_block  0.0010325908660888672
generate_one_block  0.0011134147644042969
generate_one_block  0.0011489391326904297
generate_one_block  0.0010037422180175781
generate_one_block  0.001062154769897461
generate_one_block  0.0009922981262207031
generate_one_block  0.0011563301086425781
generate_one_block  0.0010287761688232422
generate_one_block  0.0011310577392578125
generate_one_block  0.0011684894561767578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011081695556640625
gen group dst list time:  0.00011801719665527344
time for parepare:  0.0007333755493164062
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0002884864807128906
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0007646083831787109
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.00019979476928710938
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0003261566162109375
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  0.0001277923583984375
r_  generation:  0.0014119148254394531
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  9.417533874511719e-05
r_  generation:  0.0003349781036376953
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.000263214111328125
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0004432201385498047
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0005137920379638672
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00021910667419433594
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0005090236663818359
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00016164779663085938
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0010769367218017578
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0002551078796386719
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  9.894371032714844e-05
r_  generation:  0.0010390281677246094
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0004513263702392578
----------------------check_connections_block total spend ----------------------------- 0.014731884002685547
generate_one_block  0.0029244422912597656
generate_one_block  0.0012443065643310547
generate_one_block  0.0013554096221923828
generate_one_block  0.0027358531951904297
generate_one_block  0.0012958049774169922
generate_one_block  0.0013318061828613281
generate_one_block  0.0014772415161132812
generate_one_block  0.001550436019897461
generate_one_block  0.0011386871337890625
generate_one_block  0.001550436019897461
generate_one_block  0.0011417865753173828
generate_one_block  0.0022563934326171875
generate_one_block  0.0012259483337402344
generate_one_block  0.0024678707122802734
generate_one_block  0.0014727115631103516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

connection checking time:  0.019321680068969727
block generation total time  0.04175567626953125
average batch blocks generation time:  0.0027837117513020834
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.010604381561279297  GigaBytes
Max Memory Allocated: 0.010604381561279297  GigaBytes

torch.Size([1567, 500])
torch.Size([270, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.08429527282714844  GigaBytes
Max Memory Allocated: 0.08893537521362305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017039775848388672  GigaBytes
Max Memory Allocated: 0.09749698638916016  GigaBytes

torch.Size([405, 500])
torch.Size([93, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03293800354003906  GigaBytes
Max Memory Allocated: 0.09749698638916016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017496109008789062  GigaBytes
Max Memory Allocated: 0.09749698638916016  GigaBytes

torch.Size([648, 500])
torch.Size([144, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04601860046386719  GigaBytes
Max Memory Allocated: 0.09749698638916016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021453857421875  GigaBytes
Max Memory Allocated: 0.09749698638916016  GigaBytes

torch.Size([2756, 500])
torch.Size([536, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.15867233276367188  GigaBytes
Max Memory Allocated: 0.16752958297729492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.01740121841430664  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

torch.Size([597, 500])
torch.Size([107, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.04456329345703125  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.017229557037353516  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

torch.Size([506, 500])
torch.Size([88, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.040668487548828125  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.01779031753540039  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

torch.Size([804, 500])
torch.Size([151, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.06001853942871094  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.017891883850097656  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

torch.Size([858, 500])
torch.Size([208, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.06665897369384766  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.016969680786132812  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

torch.Size([368, 500])
torch.Size([77, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.031982421875  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.017919063568115234  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

torch.Size([872, 500])
torch.Size([208, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.06592464447021484  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.01677227020263672  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

torch.Size([262, 500])
torch.Size([84, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.0288238525390625  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.019232749938964844  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

torch.Size([1161, 500])
torch.Size([302, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.13420677185058594  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.01703786849975586  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

torch.Size([403, 500])
torch.Size([120, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.03764152526855469  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.019229888916015625  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

torch.Size([1351, 500])
torch.Size([297, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.12694025039672852  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.017551898956298828  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

torch.Size([676, 500])
torch.Size([174, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.05929994583129883  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002112420399983724 |0.023810958862304686 |0.1038882573445638 |0.0001194000244140625 |0.0995933214823405 |0.010061264038085938 |
----------------------------------------------------------pseudo_mini_loss sum 2.1665494441986084
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16450
Number of first layer input nodes during this epoch:  13234
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.03454780578613281  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000514984130859375
random selection method range initialization spend 0.00012135505676269531
time for parepare:  5.936622619628906e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.1920928955078125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.33514404296875e-05
----------------------check_connections_block total spend ----------------------------- 0.002782106399536133
generate_one_block  0.0011441707611083984
generate_one_block  0.0010895729064941406
generate_one_block  0.001077890396118164
generate_one_block  0.0010516643524169922
generate_one_block  0.0010454654693603516
generate_one_block  0.0010676383972167969
generate_one_block  0.0010497570037841797
generate_one_block  0.0011899471282958984
generate_one_block  0.0010662078857421875
generate_one_block  0.0010704994201660156
generate_one_block  0.0010657310485839844
generate_one_block  0.0010476112365722656
generate_one_block  0.0010504722595214844
generate_one_block  0.0010523796081542969
generate_one_block  0.001046895980834961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006184577941894531
gen group dst list time:  8.0108642578125e-05
time for parepare:  0.0002627372741699219
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  7.62939453125e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0002422332763671875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001323223114013672
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  5.745887756347656e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00012493133544921875
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.7206878662109375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  8.630752563476562e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00016641616821289062
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00017595291137695312
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.845329284667969e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  4.744529724121094e-05
----------------------check_connections_block total spend ----------------------------- 0.0048444271087646484
generate_one_block  0.0011816024780273438
generate_one_block  0.0014050006866455078
generate_one_block  0.0012273788452148438
generate_one_block  0.0010957717895507812
generate_one_block  0.0012049674987792969
generate_one_block  0.0012323856353759766
generate_one_block  0.0011014938354492188
generate_one_block  0.0011303424835205078
generate_one_block  0.0010929107666015625
generate_one_block  0.0012655258178710938
generate_one_block  0.0012078285217285156
generate_one_block  0.0011126995086669922
generate_one_block  0.0010983943939208984
generate_one_block  0.0010902881622314453
generate_one_block  0.0010292530059814453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011534690856933594
gen group dst list time:  0.00016117095947265625
time for parepare:  0.0008978843688964844
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0002827644348144531
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0003840923309326172
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  0.00023174285888671875
r_  generation:  0.0015659332275390625
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  0.0001087188720703125
r_  generation:  0.0005962848663330078
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0001392364501953125
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0002713203430175781
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0005314350128173828
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.0001735687255859375
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004305839538574219
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0005879402160644531
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  0.00014591217041015625
r_  generation:  0.001232147216796875
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  0.00011968612670898438
r_  generation:  0.0009496212005615234
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0005621910095214844
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0002503395080566406
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0005815029144287109
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0001499652862548828
----------------------check_connections_block total spend ----------------------------- 0.016387224197387695
generate_one_block  0.0019690990447998047
generate_one_block  0.0035715103149414062
generate_one_block  0.0018720626831054688
generate_one_block  0.0012068748474121094
generate_one_block  0.001415252685546875
generate_one_block  0.001789093017578125
generate_one_block  0.0013473033905029297
generate_one_block  0.0028374195098876953
generate_one_block  0.001848459243774414
generate_one_block  0.0025818347930908203
generate_one_block  0.0023190975189208984
generate_one_block  0.0017940998077392578
generate_one_block  0.0013985633850097656
generate_one_block  0.0017659664154052734
generate_one_block  0.0012927055358886719
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.03454780578613281  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

connection checking time:  0.021231651306152344
block generation total time  0.046485185623168945
average batch blocks generation time:  0.00309901237487793
block dataloader generation time/epoch 0.13443517684936523
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.03446149826049805  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

torch.Size([642, 500])
torch.Size([162, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.06896781921386719  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.037695884704589844  GigaBytes
Max Memory Allocated: 0.1692066192626953  GigaBytes

torch.Size([2360, 500])
torch.Size([524, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.1881556510925293  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.035094261169433594  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

torch.Size([979, 500])
torch.Size([248, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.08380889892578125  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.033638954162597656  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

torch.Size([204, 500])
torch.Size([53, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.04323911666870117  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03409719467163086  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

torch.Size([448, 500])
torch.Size([130, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.0558171272277832  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03481578826904297  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

torch.Size([830, 500])
torch.Size([232, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.0799407958984375  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.033774375915527344  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

torch.Size([276, 500])
torch.Size([85, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.04646492004394531  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.034483909606933594  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

torch.Size([653, 500])
torch.Size([153, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.0731801986694336  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03569650650024414  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

torch.Size([1302, 500])
torch.Size([167, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.08923912048339844  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.036211490631103516  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

torch.Size([1213, 500])
torch.Size([306, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.16033649444580078  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.037006378173828125  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

torch.Size([1553, 500])
torch.Size([345, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.12100410461425781  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03618955612182617  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

torch.Size([1295, 500])
torch.Size([148, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.08771371841430664  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.033976078033447266  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

torch.Size([384, 500])
torch.Size([95, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.051061153411865234  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.035192012786865234  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

torch.Size([1031, 500])
torch.Size([147, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.08762073516845703  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03366518020629883  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes

torch.Size([218, 500])
torch.Size([67, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.04379129409790039  GigaBytes
Max Memory Allocated: 0.19910335540771484  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0027446746826171875 |0.0008757750193277995 |0.07246489524841308 |0.0001151879628499349 |0.100676695505778 |0.006704568862915039 |
----------------------------------------------------------pseudo_mini_loss sum 1.6709409952163696
Total (block generation + training)time/epoch 2.82100772857666
Training time/epoch 2.686379909515381
Training time without block to device /epoch 2.673243284225464
Training time without total dataloading part /epoch 2.6055562496185303
load block tensor time/epoch 0.04117012023925781
block to device time/epoch 0.013136625289916992
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16607
Number of first layer input nodes during this epoch:  13388
