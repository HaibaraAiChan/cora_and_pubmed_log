main start at this time 1648528354.7431931
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019507408142089844
random selection method range initialization spend 0.00019621849060058594
time for parepare:  5.936622619628906e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0015926361083984375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.621246337890625e-05
----------------------check_connections_block total spend ----------------------------- 0.004848480224609375
generate_one_block  0.0014443397521972656
generate_one_block  0.001224517822265625
generate_one_block  0.0012323856353759766
generate_one_block  0.0012390613555908203
generate_one_block  0.0012164115905761719
generate_one_block  0.0012400150299072266
generate_one_block  0.0011789798736572266
generate_one_block  0.0010471343994140625
generate_one_block  0.0009453296661376953
generate_one_block  0.0009522438049316406
generate_one_block  0.0009467601776123047
generate_one_block  0.0009493827819824219
generate_one_block  0.0009388923645019531
generate_one_block  0.0009577274322509766
generate_one_block  0.0009438991546630859
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012180805206298828
gen group dst list time:  0.00010848045349121094
time for parepare:  0.0003414154052734375
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00022530555725097656
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00019168853759765625
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00028896331787109375
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  8.034706115722656e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  9.584426879882812e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00011014938354492188
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0001289844512939453
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00020456314086914062
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  8.654594421386719e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00018715858459472656
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00010919570922851562
----------------------check_connections_block total spend ----------------------------- 0.005641937255859375
generate_one_block  0.0015027523040771484
generate_one_block  0.0012905597686767578
generate_one_block  0.0013241767883300781
generate_one_block  0.0016126632690429688
generate_one_block  0.001298666000366211
generate_one_block  0.0012359619140625
generate_one_block  0.0011677742004394531
generate_one_block  0.0011589527130126953
generate_one_block  0.0010631084442138672
generate_one_block  0.001119852066040039
generate_one_block  0.0010800361633300781
generate_one_block  0.0011582374572753906
generate_one_block  0.0010209083557128906
generate_one_block  0.0011582374572753906
generate_one_block  0.0010843276977539062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001352548599243164
gen group dst list time:  0.0001671314239501953
time for parepare:  0.0010809898376464844
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.000263214111328125
mini_batch_src_global generation:  0.00010800361633300781
r_  generation:  0.0010590553283691406
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0002982616424560547
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0003573894500732422
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.00016927719116210938
r_  generation:  0.0017485618591308594
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.00038361549377441406
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0003044605255126953
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.0006699562072753906
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  8.177757263183594e-05
r_  generation:  0.0006334781646728516
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.00021219253540039062
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0006601810455322266
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00017452239990234375
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  0.0001354217529296875
r_  generation:  0.0014584064483642578
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.00030684471130371094
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.0014119148254394531
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0005066394805908203
----------------------check_connections_block total spend ----------------------------- 0.01807880401611328
generate_one_block  0.002728700637817383
generate_one_block  0.0013034343719482422
generate_one_block  0.0013446807861328125
generate_one_block  0.0030517578125
generate_one_block  0.0013194084167480469
generate_one_block  0.0013737678527832031
generate_one_block  0.0017218589782714844
generate_one_block  0.0016498565673828125
generate_one_block  0.0011484622955322266
generate_one_block  0.0017232894897460938
generate_one_block  0.0011091232299804688
generate_one_block  0.0025680065155029297
generate_one_block  0.0012664794921875
generate_one_block  0.0028765201568603516
generate_one_block  0.0014824867248535156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

connection checking time:  0.023720741271972656
block generation total time  0.044944047927856445
average batch blocks generation time:  0.0029962698618570963
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.01174163818359375  GigaBytes
Max Memory Allocated: 0.01174163818359375  GigaBytes

torch.Size([2173, 500])
torch.Size([308, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.11458015441894531  GigaBytes
Max Memory Allocated: 0.12100648880004883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.01684856414794922  GigaBytes
Max Memory Allocated: 0.12735748291015625  GigaBytes

torch.Size([503, 500])
torch.Size([124, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.039006710052490234  GigaBytes
Max Memory Allocated: 0.12735748291015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.017179489135742188  GigaBytes
Max Memory Allocated: 0.12735748291015625  GigaBytes

torch.Size([679, 500])
torch.Size([144, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.04713869094848633  GigaBytes
Max Memory Allocated: 0.12735748291015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.02178955078125  GigaBytes
Max Memory Allocated: 0.12735748291015625  GigaBytes

torch.Size([3134, 500])
torch.Size([561, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.18319225311279297  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.017110347747802734  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

torch.Size([642, 500])
torch.Size([107, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.046629905700683594  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.016981124877929688  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

torch.Size([573, 500])
torch.Size([88, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.04411458969116211  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.01790332794189453  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

torch.Size([1063, 500])
torch.Size([187, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.08132553100585938  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.017810821533203125  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

torch.Size([1014, 500])
torch.Size([209, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.0754857063293457  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.01664113998413086  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

torch.Size([392, 500])
torch.Size([77, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.032562255859375  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.017832279205322266  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

torch.Size([1025, 500])
torch.Size([243, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.07792091369628906  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.016403675079345703  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

torch.Size([265, 500])
torch.Size([84, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.02863454818725586  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.018422603607177734  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

torch.Size([1328, 500])
torch.Size([318, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.16799545288085938  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.016794681549072266  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

torch.Size([473, 500])
torch.Size([121, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.04107189178466797  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.018855571746826172  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

torch.Size([1562, 500])
torch.Size([324, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.16175556182861328  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.01724100112915039  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

torch.Size([710, 500])
torch.Size([174, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.061501502990722656  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0016939163208007813 |0.023622592290242512 |0.13735264142354328 |0.0001289685567220052 |0.14239029884338378 |0.008222103118896484 |
----------------------------------------------------------pseudo_mini_loss sum 2.1604726314544678
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  18962
Number of first layer input nodes during this epoch:  15536
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.03290128707885742  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005574226379394531
random selection method range initialization spend 0.00013017654418945312
time for parepare:  7.486343383789062e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.5033950805664062e-05
----------------------check_connections_block total spend ----------------------------- 0.002989053726196289
generate_one_block  0.0011954307556152344
generate_one_block  0.0010976791381835938
generate_one_block  0.0010685920715332031
generate_one_block  0.0010561943054199219
generate_one_block  0.0010457038879394531
generate_one_block  0.0010666847229003906
generate_one_block  0.0010488033294677734
generate_one_block  0.0012104511260986328
generate_one_block  0.0010597705841064453
generate_one_block  0.001049041748046875
generate_one_block  0.001054525375366211
generate_one_block  0.0010306835174560547
generate_one_block  0.0010290145874023438
generate_one_block  0.001039266586303711
generate_one_block  0.0009882450103759766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006463527679443359
gen group dst list time:  8.678436279296875e-05
time for parepare:  0.0003445148468017578
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  9.870529174804688e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0002849102020263672
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00014281272888183594
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.794929504394531e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00013947486877441406
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  8.988380432128906e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.465217590332031e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00018286705017089844
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001823902130126953
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  9.274482727050781e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.225440979003906e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.887580871582031e-05
----------------------check_connections_block total spend ----------------------------- 0.005254030227661133
generate_one_block  0.0012063980102539062
generate_one_block  0.0014579296112060547
generate_one_block  0.0012059211730957031
generate_one_block  0.0010781288146972656
generate_one_block  0.0012087821960449219
generate_one_block  0.0012302398681640625
generate_one_block  0.0010979175567626953
generate_one_block  0.0011248588562011719
generate_one_block  0.0010707378387451172
generate_one_block  0.0012602806091308594
generate_one_block  0.0011796951293945312
generate_one_block  0.0010526180267333984
generate_one_block  0.001069784164428711
generate_one_block  0.0010857582092285156
generate_one_block  0.0010242462158203125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012695789337158203
gen group dst list time:  0.00015091896057128906
time for parepare:  0.0011601448059082031
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.0003082752227783203
mini_batch_src_global generation:  0.00010228157043457031
r_  generation:  0.0006315708160400391
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  0.00030040740966796875
r_  generation:  0.002136707305908203
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.0001251697540283203
r_  generation:  0.0006568431854248047
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00018930435180664062
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0003399848937988281
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0006506443023681641
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.00020051002502441406
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.00048279762268066406
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0007259845733642578
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  0.00020313262939453125
r_  generation:  0.0016019344329833984
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  0.0001423358917236328
r_  generation:  0.0010330677032470703
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  0.00011873245239257812
r_  generation:  0.0008640289306640625
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0003101825714111328
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0006768703460693359
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0001628398895263672
----------------------check_connections_block total spend ----------------------------- 0.020044565200805664
generate_one_block  0.0020759105682373047
generate_one_block  0.0038018226623535156
generate_one_block  0.0017733573913574219
generate_one_block  0.0011260509490966797
generate_one_block  0.0013630390167236328
generate_one_block  0.001733541488647461
generate_one_block  0.0011830329895019531
generate_one_block  0.001554727554321289
generate_one_block  0.0018768310546875
generate_one_block  0.002847909927368164
generate_one_block  0.0022301673889160156
generate_one_block  0.0022115707397460938
generate_one_block  0.001302480697631836
generate_one_block  0.0018427371978759766
generate_one_block  0.0012028217315673828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.03290128707885742  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

connection checking time:  0.025298595428466797
block generation total time  0.04547929763793945
average batch blocks generation time:  0.00303195317586263
block dataloader generation time/epoch 0.1682577133178711
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.033336639404296875  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

torch.Size([953, 500])
torch.Size([198, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.09140348434448242  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.03686094284057617  GigaBytes
Max Memory Allocated: 0.19363117218017578  GigaBytes

torch.Size([2742, 500])
torch.Size([586, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.23933839797973633  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.03353404998779297  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

torch.Size([1059, 500])
torch.Size([250, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.08662700653076172  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.03196096420288086  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

torch.Size([221, 500])
torch.Size([53, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.04216146469116211  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.03251028060913086  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

torch.Size([513, 500])
torch.Size([154, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.06026935577392578  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.03332662582397461  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

torch.Size([947, 500])
torch.Size([258, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.08844280242919922  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.03210878372192383  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

torch.Size([300, 500])
torch.Size([86, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.04588794708251953  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.03292036056518555  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

torch.Size([731, 500])
torch.Size([153, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.0750579833984375  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.03437614440917969  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

torch.Size([1510, 500])
torch.Size([173, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.09762716293334961  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.034449100494384766  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

torch.Size([1400, 500])
torch.Size([320, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.19467973709106445  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.03471088409423828  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

torch.Size([1685, 500])
torch.Size([345, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.12446451187133789  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.0354609489440918  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

torch.Size([1948, 500])
torch.Size([184, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.11521768569946289  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.03248167037963867  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

torch.Size([499, 500])
torch.Size([121, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.05533647537231445  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.033814430236816406  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

torch.Size([1208, 500])
torch.Size([147, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.09715747833251953  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.03195524215698242  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

torch.Size([218, 500])Using backend: pytorch

torch.Size([67, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.042081356048583984  GigaBytes
Max Memory Allocated: 0.2530069351196289  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0029826641082763674 |0.0009500026702880859 |0.10596896807352701 |0.00012184778849283854 |0.13771063486735027 |0.006227731704711914 |
----------------------------------------------------------pseudo_mini_loss sum 1.5961915254592896
Total (block generation + training)time/epoch 3.92037034034729
Training time/epoch 3.7519209384918213
Training time without block to device /epoch 3.7376708984375
Training time without total dataloading part /epoch 3.6632494926452637
load block tensor time/epoch 0.04473996162414551
block to device time/epoch 0.014250040054321289
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  19386
Number of first layer input nodes during this epoch:  15934
