main start at this time 1648528198.5212064
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0016295909881591797
random selection method range initialization spend 0.00019049644470214844
time for parepare:  4.649162292480469e-05
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0015444755554199219
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.647804260253906e-05
----------------------check_connections_block total spend ----------------------------- 0.0025739669799804688
generate_one_block  0.0013267993927001953
generate_one_block  0.0011608600616455078
generate_one_block  0.0010724067687988281
generate_one_block  0.001081705093383789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009059906005859375
gen group dst list time:  3.528594970703125e-05
time for parepare:  0.0002377033233642578
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0004296302795410156
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0002562999725341797
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00018835067749023438
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.0004432201385498047
----------------------check_connections_block total spend ----------------------------- 0.0027914047241210938
generate_one_block  0.0016522407531738281
generate_one_block  0.0013823509216308594
generate_one_block  0.0012755393981933594
generate_one_block  0.001617431640625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010068416595458984
gen group dst list time:  7.2479248046875e-05
time for parepare:  0.0007803440093994141
local_output_nid generation:  7.152557373046875e-05
local_in_edges_tensor generation:  0.000331878662109375
mini_batch_src_global generation:  0.00018787384033203125
r_  generation:  0.0023200511932373047
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00023436546325683594
r_  generation:  0.0016934871673583984
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0009393692016601562
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.0003933906555175781
mini_batch_src_global generation:  0.00022101402282714844
r_  generation:  0.002580404281616211
----------------------check_connections_block total spend ----------------------------- 0.012463569641113281
generate_one_block  0.0049419403076171875
generate_one_block  0.002897024154663086
generate_one_block  0.0019481182098388672
generate_one_block  0.00395965576171875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

connection checking time:  0.015254974365234375
block generation total time  0.019674301147460938
average batch blocks generation time:  0.004918575286865234
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014885425567626953  GigaBytes
Max Memory Allocated: 0.014885425567626953  GigaBytes

torch.Size([3843, 500])
torch.Size([939, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.22806358337402344  GigaBytes
Max Memory Allocated: 0.24201011657714844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.020446300506591797  GigaBytes
Max Memory Allocated: 0.24201011657714844  GigaBytes

torch.Size([2726, 500])
torch.Size([544, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.17251968383789062  GigaBytes
Max Memory Allocated: 0.24201011657714844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.018149852752685547  GigaBytes
Max Memory Allocated: 0.24201011657714844  GigaBytes

torch.Size([1504, 500])
torch.Size([429, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.09624671936035156  GigaBytes
Max Memory Allocated: 0.24201011657714844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.020536422729492188  GigaBytes
Max Memory Allocated: 0.24201011657714844  GigaBytes

torch.Size([2758, 500])
torch.Size([822, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.27356958389282227  GigaBytes
Max Memory Allocated: 0.29160356521606445  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006562590599060059 |0.08677446842193604 |0.2238592505455017 |0.00016176700592041016 |0.12383323907852173 |0.007979869842529297 |
----------------------------------------------------------pseudo_mini_loss sum 2.135213613510132
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13921
Number of first layer input nodes during this epoch:  10831
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.03594970703125  GigaBytes
Max Memory Allocated: 0.29160356521606445  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005037784576416016
random selection method range initialization spend 0.00011181831359863281
time for parepare:  5.221366882324219e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00011181831359863281
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  2.8133392333984375e-05
----------------------check_connections_block total spend ----------------------------- 0.00116729736328125
generate_one_block  0.001230001449584961
generate_one_block  0.0011444091796875
generate_one_block  0.0011684894561767578
generate_one_block  0.0011301040649414062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005245208740234375
gen group dst list time:  3.457069396972656e-05
time for parepare:  0.0002353191375732422
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.00040411949157714844
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0002319812774658203
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0005002021789550781
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00017786026000976562
----------------------check_connections_block total spend ----------------------------- 0.0028579235076904297
generate_one_block  0.0017306804656982422
generate_one_block  0.0014061927795410156
generate_one_block  0.0020906925201416016
generate_one_block  0.0012927055358886719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009737014770507812
gen group dst list time:  7.677078247070312e-05
time for parepare:  0.0006923675537109375
local_output_nid generation:  0.00010991096496582031
local_in_edges_tensor generation:  0.00036215782165527344
mini_batch_src_global generation:  0.00028395652770996094
r_  generation:  0.002498149871826172
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.00015854835510253906
r_  generation:  0.0010037422180175781
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.00024509429931640625
mini_batch_src_global generation:  0.00031375885009765625
r_  generation:  0.0030002593994140625
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  0.0001804828643798828
r_  generation:  0.0010600090026855469
----------------------check_connections_block total spend ----------------------------- 0.012639284133911133
generate_one_block  0.004441976547241211
generate_one_block  0.0022668838500976562
generate_one_block  0.005064964294433594
generate_one_block  0.002308368682861328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.03594970703125  GigaBytes
Max Memory Allocated: 0.29160356521606445  GigaBytes

connection checking time:  0.015497207641601562
block generation total time  0.02060246467590332
average batch blocks generation time:  0.00515061616897583
block dataloader generation time/epoch 0.0671684741973877
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.037353515625  GigaBytes
Max Memory Allocated: 0.29160356521606445  GigaBytes

torch.Size([3566, 500])
torch.Size([973, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.2750077247619629  GigaBytes
Max Memory Allocated: 0.29160356521606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.03363370895385742  GigaBytes
Max Memory Allocated: 0.29160356521606445  GigaBytes

torch.Size([1592, 500])
torch.Size([498, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.12215995788574219  GigaBytes
Max Memory Allocated: 0.29160356521606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.039072513580322266  GigaBytes
Max Memory Allocated: 0.29160356521606445  GigaBytes

torch.Size([4478, 500])
torch.Size([960, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.34484195709228516  GigaBytes
Max Memory Allocated: 0.3663363456726074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.03406667709350586  GigaBytes
Max Memory Allocated: 0.3663363456726074  GigaBytes

torch.Size([1824, 500])
torch.Size([364, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.12797260284423828  GigaBytes
Max Memory Allocated: 0.3663363456726074  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003920018672943115 |0.0008195638656616211 |0.10698461532592773 |0.0001270771026611328 |0.12682276964187622 |0.011252403259277344 |
----------------------------------------------------------pseudo_mini_loss sum 1.7795262336730957
Total (block generation + training)time/epoch 1.0411763191223145
Training time/epoch 0.9737503528594971
Training time without block to device /epoch 0.9704720973968506
Training time without total dataloading part /epoch 0.9469902515411377
load block tensor time/epoch 0.01568007469177246
block to device time/epoch 0.0032782554626464844
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14612
Number of first layer input nodes during this epoch:  11460
