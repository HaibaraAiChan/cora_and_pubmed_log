main start at this time 1648528137.3753479
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002411365509033203
random selection method range initialization spend 0.00022792816162109375
time for parepare:  4.506111145019531e-05
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0023200511932373047
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.5762786865234375e-05
----------------------check_connections_block total spend ----------------------------- 0.003371715545654297
generate_one_block  0.0012636184692382812
generate_one_block  0.0011224746704101562
generate_one_block  0.0010433197021484375
generate_one_block  0.0010457038879394531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011556148529052734
gen group dst list time:  3.4332275390625e-05
time for parepare:  0.00023603439331054688
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00044035911560058594
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0002510547637939453
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00018358230590820312
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00042438507080078125
----------------------check_connections_block total spend ----------------------------- 0.0027496814727783203
generate_one_block  0.0016100406646728516
generate_one_block  0.0013439655303955078
generate_one_block  0.0012412071228027344
generate_one_block  0.0015642642974853516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009920597076416016
gen group dst list time:  7.271766662597656e-05
time for parepare:  0.0007441043853759766
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.00033736228942871094
mini_batch_src_global generation:  0.00018477439880371094
r_  generation:  0.0022683143615722656
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.00020384788513183594
r_  generation:  0.0016293525695800781
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.00011515617370605469
r_  generation:  0.0009284019470214844
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.0003838539123535156
mini_batch_src_global generation:  0.000217437744140625
r_  generation:  0.002500295639038086
----------------------check_connections_block total spend ----------------------------- 0.01197957992553711
generate_one_block  0.00415349006652832
generate_one_block  0.002889394760131836
generate_one_block  0.001968860626220703
generate_one_block  0.004744768142700195
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

connection checking time:  0.01472926139831543
block generation total time  0.0195159912109375
average batch blocks generation time:  0.004878997802734375
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014976024627685547  GigaBytes
Max Memory Allocated: 0.014976024627685547  GigaBytes

torch.Size([3891, 500])
torch.Size([946, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.23033523559570312  GigaBytes
Max Memory Allocated: 0.24430465698242188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.020725727081298828  GigaBytes
Max Memory Allocated: 0.24430465698242188  GigaBytes

torch.Size([2711, 500])
torch.Size([542, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.17229890823364258  GigaBytes
Max Memory Allocated: 0.24430465698242188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.018215179443359375  GigaBytes
Max Memory Allocated: 0.24430465698242188  GigaBytes

torch.Size([1539, 500])
torch.Size([437, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.09847259521484375  GigaBytes
Max Memory Allocated: 0.24430465698242188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.020756244659423828  GigaBytes
Max Memory Allocated: 0.24430465698242188  GigaBytes

torch.Size([2751, 500])
torch.Size([823, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.2760124206542969  GigaBytes
Max Memory Allocated: 0.2931995391845703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006810784339904785 |0.08706700801849365 |0.22771012783050537 |0.00016564130783081055 |0.12304419279098511 |0.008347511291503906 |
----------------------------------------------------------pseudo_mini_loss sum 2.1290173530578613
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13996
Number of first layer input nodes during this epoch:  10892
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.03616952896118164  GigaBytes
Max Memory Allocated: 0.2931995391845703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004782676696777344
random selection method range initialization spend 0.00010943412780761719
time for parepare:  5.5789947509765625e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.14984130859375e-05
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00011157989501953125
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.5987625122070312e-05
----------------------check_connections_block total spend ----------------------------- 0.0011334419250488281
generate_one_block  0.001146078109741211
generate_one_block  0.0010535717010498047
generate_one_block  0.0010857582092285156
generate_one_block  0.0010211467742919922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000507354736328125
gen group dst list time:  3.504753112792969e-05
time for parepare:  0.00022101402282714844
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0003848075866699219
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0002186298370361328
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0004811286926269531
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00017070770263671875
----------------------check_connections_block total spend ----------------------------- 0.002732992172241211
generate_one_block  0.0016031265258789062
generate_one_block  0.0012586116790771484
generate_one_block  0.0019860267639160156
generate_one_block  0.001168966293334961
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009527206420898438
gen group dst list time:  7.772445678710938e-05
time for parepare:  0.0006792545318603516
local_output_nid generation:  9.202957153320312e-05
local_in_edges_tensor generation:  0.0003542900085449219
mini_batch_src_global generation:  0.00023317337036132812
r_  generation:  0.0023851394653320312
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  0.00017213821411132812
r_  generation:  0.0009567737579345703
local_output_nid generation:  9.846687316894531e-05
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  0.00031113624572753906
r_  generation:  0.0029075145721435547
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  0.00015306472778320312
r_  generation:  0.0010442733764648438
----------------------check_connections_block total spend ----------------------------- 0.012116193771362305
generate_one_block  0.005166769027709961
generate_one_block  0.002213716506958008
generate_one_block  0.005011081695556641
generate_one_block  0.0022444725036621094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.03616952896118164  GigaBytes
Max Memory Allocated: 0.2931995391845703  GigaBytes

connection checking time:  0.014849185943603516
block generation total time  0.02065277099609375
average batch blocks generation time:  0.0051631927490234375
block dataloader generation time/epoch 0.06502389907836914
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.03741121292114258  GigaBytes
Max Memory Allocated: 0.2931995391845703  GigaBytes

torch.Size([3597, 500])
torch.Size([975, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5643310546875 GB
    Memory Allocated: 0.2756209373474121  GigaBytes
Max Memory Allocated: 0.2931995391845703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5643310546875 GB
    Memory Allocated: 0.03366565704345703  GigaBytes
Max Memory Allocated: 0.2931995391845703  GigaBytes

torch.Size([1592, 500])
torch.Size([497, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5643310546875 GB
    Memory Allocated: 0.12123918533325195  GigaBytes
Max Memory Allocated: 0.2931995391845703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5643310546875 GB
    Memory Allocated: 0.039034366607666016  GigaBytes
Max Memory Allocated: 0.2931995391845703  GigaBytes

torch.Size([4458, 500])
torch.Size([955, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.342954158782959  GigaBytes
Max Memory Allocated: 0.3644585609436035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.03419160842895508  GigaBytes
Max Memory Allocated: 0.3644585609436035  GigaBytes

torch.Size([1829, 500])
torch.Size([363, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.12781381607055664  GigaBytes
Max Memory Allocated: 0.3644585609436035  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0025640130043029785 |0.0007637739181518555 |0.11052632331848145 |0.0001277327537536621 |0.12480628490447998 |0.008576631546020508 |
----------------------------------------------------------pseudo_mini_loss sum 1.703456997871399
Total (block generation + training)time/epoch 1.0371239185333252
Training time/epoch 0.9718689918518066
Training time without block to device /epoch 0.9688138961791992
Training time without total dataloading part /epoch 0.9504179954528809
load block tensor time/epoch 0.010256052017211914
block to device time/epoch 0.003055095672607422
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14623
Number of first layer input nodes during this epoch:  11476
