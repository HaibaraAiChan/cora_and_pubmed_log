main start at this time 1648528963.4169245
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0015444755554199219
random selection method range initialization spend 0.00019073486328125
time for parepare:  4.649162292480469e-05
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.0014495849609375
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.5762786865234375e-05
----------------------check_connections_block total spend ----------------------------- 0.002461671829223633
generate_one_block  0.0011608600616455078
generate_one_block  0.0010628700256347656
generate_one_block  0.001008749008178711
generate_one_block  0.0009913444519042969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009377002716064453
gen group dst list time:  3.218650817871094e-05
time for parepare:  0.00022029876708984375
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002617835998535156
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00013113021850585938
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00045013427734375
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0003180503845214844
----------------------check_connections_block total spend ----------------------------- 0.0025331974029541016
generate_one_block  0.0014247894287109375
generate_one_block  0.001104116439819336
generate_one_block  0.0015802383422851562
generate_one_block  0.0014066696166992188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009605884552001953
gen group dst list time:  6.771087646484375e-05
time for parepare:  0.0007193088531494141
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00030732154846191406
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.0013082027435302734
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  0.00010752677917480469
r_  generation:  0.0007855892181396484
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.00026226043701171875
mini_batch_src_global generation:  0.00022864341735839844
r_  generation:  0.002691507339477539
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00048828125
mini_batch_src_global generation:  0.00027751922607421875
r_  generation:  0.002315998077392578
----------------------check_connections_block total spend ----------------------------- 0.011954545974731445
generate_one_block  0.0028057098388671875
generate_one_block  0.0018224716186523438
generate_one_block  0.004453897476196289
generate_one_block  0.003900766372680664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

connection checking time:  0.014487743377685547
block generation total time  0.018498659133911133
average batch blocks generation time:  0.004624664783477783
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.01694631576538086  GigaBytes
Max Memory Allocated: 0.01694631576538086  GigaBytes

torch.Size([2181, 500])
torch.Size([677, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.15607595443725586  GigaBytes
Max Memory Allocated: 0.15616989135742188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.028766155242919922  GigaBytes
Max Memory Allocated: 0.16050004959106445  GigaBytes

torch.Size([1377, 500])
torch.Size([295, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.10481500625610352  GigaBytes
Max Memory Allocated: 0.16050004959106445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.03384113311767578  GigaBytes
Max Memory Allocated: 0.16050004959106445  GigaBytes

torch.Size([4129, 500])
torch.Size([1042, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.3303203582763672  GigaBytes
Max Memory Allocated: 0.3304872512817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.03287839889526367  GigaBytes
Max Memory Allocated: 0.33407163619995117  GigaBytes

torch.Size([3508, 500])
torch.Size([728, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.2924165725708008  GigaBytes
Max Memory Allocated: 0.33407163619995117  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0033860206604003906 |0.08626377582550049 |0.22454488277435303 |0.00016134977340698242 |0.12695282697677612 |0.008213996887207031 |
----------------------------------------------------------pseudo_mini_loss sum 2.0181705951690674
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14293
Number of first layer input nodes during this epoch:  11195
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.05916643142700195  GigaBytes
Max Memory Allocated: 0.33407163619995117  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00047707557678222656
random selection method range initialization spend 0.00011515617370605469
time for parepare:  4.863739013671875e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00010514259338378906
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.935264587402344e-05
----------------------check_connections_block total spend ----------------------------- 0.0011019706726074219
generate_one_block  0.0011463165283203125
generate_one_block  0.001073598861694336
generate_one_block  0.001039743423461914
generate_one_block  0.0010881423950195312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005476474761962891
gen group dst list time:  3.504753112792969e-05
time for parepare:  0.0002353191375732422
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0001723766326904297
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00030303001403808594
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.00028061866760253906
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0005006790161132812
----------------------check_connections_block total spend ----------------------------- 0.0027620792388916016
generate_one_block  0.0012712478637695312
generate_one_block  0.0014181137084960938
generate_one_block  0.0013604164123535156
generate_one_block  0.001708984375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009291172027587891
gen group dst list time:  7.963180541992188e-05
time for parepare:  0.0006582736968994141
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.0002727508544921875
mini_batch_src_global generation:  0.00011992454528808594
r_  generation:  0.0010483264923095703
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  0.00019240379333496094
r_  generation:  0.0017118453979492188
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.00018167495727539062
r_  generation:  0.0013985633850097656
local_output_nid generation:  0.00010395050048828125
local_in_edges_tensor generation:  0.0002613067626953125
mini_batch_src_global generation:  0.0003325939178466797
r_  generation:  0.0031909942626953125
----------------------check_connections_block total spend ----------------------------- 0.012295722961425781
generate_one_block  0.002606630325317383
generate_one_block  0.003195524215698242
generate_one_block  0.002879619598388672
generate_one_block  0.005205631256103516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.05916643142700195  GigaBytes
Max Memory Allocated: 0.33407163619995117  GigaBytes

connection checking time:  0.015057802200317383
block generation total time  0.019646167755126953
average batch blocks generation time:  0.004911541938781738
block dataloader generation time/epoch 0.06437802314758301
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.05580854415893555  GigaBytes
Max Memory Allocated: 0.33407163619995117  GigaBytes

torch.Size([1885, 500])
torch.Size([391, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1639690399169922  GigaBytes
Max Memory Allocated: 0.33407163619995117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.056992530822753906  GigaBytes
Max Memory Allocated: 0.33407163619995117  GigaBytes

torch.Size([2509, 500])
torch.Size([657, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.23806047439575195  GigaBytes
Max Memory Allocated: 0.33407163619995117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.056632041931152344  GigaBytes
Max Memory Allocated: 0.33407163619995117  GigaBytes

torch.Size([2321, 500])
torch.Size([635, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.20139551162719727  GigaBytes
Max Memory Allocated: 0.33407163619995117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.06086444854736328  GigaBytes
Max Memory Allocated: 0.33407163619995117  GigaBytes

torch.Size([4564, 500])
torch.Size([1108, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.40888452529907227  GigaBytes
Max Memory Allocated: 0.4090547561645508  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004831790924072266 |0.0007886290550231934 |0.1062970757484436 |0.00012445449829101562 |0.13298845291137695 |0.00642848014831543 |
----------------------------------------------------------pseudo_mini_loss sum 3.686913013458252
Total (block generation + training)time/epoch 1.059128761291504
Training time/epoch 0.9944405555725098
Training time without block to device /epoch 0.991286039352417
Training time without total dataloading part /epoch 0.9640684127807617
load block tensor time/epoch 0.019327163696289062
block to device time/epoch 0.0031545162200927734
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14426
Number of first layer input nodes during this epoch:  11279
