main start at this time 1648529025.2672267
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0031180381774902344
random selection method range initialization spend 0.00022125244140625
time for parepare:  4.601478576660156e-05
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.002220630645751953
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.910064697265625e-05
----------------------check_connections_block total spend ----------------------------- 0.003246307373046875
generate_one_block  0.0011968612670898438
generate_one_block  0.0010526180267333984
generate_one_block  0.0010330677032470703
generate_one_block  0.0010676383972167969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0015990734100341797
gen group dst list time:  5.14984130859375e-05
time for parepare:  0.0002529621124267578
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00033736228942871094
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0001418590545654297
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0004975795745849609
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00035643577575683594
----------------------check_connections_block total spend ----------------------------- 0.002854585647583008
generate_one_block  0.001394033432006836
generate_one_block  0.0011644363403320312
generate_one_block  0.0016486644744873047
generate_one_block  0.0014264583587646484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010695457458496094
gen group dst list time:  7.486343383789062e-05
time for parepare:  0.0007741451263427734
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.0003199577331542969
mini_batch_src_global generation:  0.0001361370086669922
r_  generation:  0.0013289451599121094
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.00011610984802246094
r_  generation:  0.0007834434509277344
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.0002570152282714844
mini_batch_src_global generation:  0.0002791881561279297
r_  generation:  0.0029098987579345703
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.000476837158203125
mini_batch_src_global generation:  0.0003209114074707031
r_  generation:  0.0025599002838134766
----------------------check_connections_block total spend ----------------------------- 0.01280069351196289
generate_one_block  0.0027837753295898438
generate_one_block  0.0018832683563232422
generate_one_block  0.004725217819213867
generate_one_block  0.004264354705810547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

connection checking time:  0.0156552791595459
block generation total time  0.01929020881652832
average batch blocks generation time:  0.00482255220413208
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.017153263092041016  GigaBytes
Max Memory Allocated: 0.017153263092041016  GigaBytes

torch.Size([2290, 500])
torch.Size([738, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.1665058135986328  GigaBytes
Max Memory Allocated: 0.16659975051879883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.028270244598388672  GigaBytes
Max Memory Allocated: 0.17103910446166992  GigaBytes

torch.Size([1376, 500])
torch.Size([295, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.10386848449707031  GigaBytes
Max Memory Allocated: 0.17103910446166992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.03369426727294922  GigaBytes
Max Memory Allocated: 0.17103910446166992  GigaBytes

torch.Size([4251, 500])
torch.Size([1107, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.35717201232910156  GigaBytes
Max Memory Allocated: 0.35733890533447266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.03310537338256836  GigaBytes
Max Memory Allocated: 0.36092329025268555  GigaBytes

torch.Size([3942, 500])
torch.Size([799, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.31509828567504883  GigaBytes
Max Memory Allocated: 0.36092329025268555  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006388843059539795 |0.0854722261428833 |0.2396174669265747 |0.00015288591384887695 |0.16381996870040894 |0.008497476577758789 |
----------------------------------------------------------pseudo_mini_loss sum 2.0351176261901855
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15154
Number of first layer input nodes during this epoch:  11859
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.058878421783447266  GigaBytes
Max Memory Allocated: 0.36092329025268555  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004930496215820312
random selection method range initialization spend 0.00011467933654785156
time for parepare:  5.245208740234375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.0001087188720703125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.839897155761719e-05
----------------------check_connections_block total spend ----------------------------- 0.0011386871337890625
generate_one_block  0.001153707504272461
generate_one_block  0.0011067390441894531
generate_one_block  0.0010623931884765625
generate_one_block  0.0011057853698730469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005385875701904297
gen group dst list time:  3.838539123535156e-05
time for parepare:  0.00024890899658203125
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0001876354217529297
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003387928009033203
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.00027251243591308594
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0005323886871337891
----------------------check_connections_block total spend ----------------------------- 0.0029134750366210938
generate_one_block  0.0013470649719238281
generate_one_block  0.0014791488647460938
generate_one_block  0.0014650821685791016
generate_one_block  0.001783609390258789
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00096893310546875
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.0006875991821289062
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.0002951622009277344
mini_batch_src_global generation:  0.00016188621520996094
r_  generation:  0.0011692047119140625
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  0.00024199485778808594
r_  generation:  0.0018496513366699219
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  0.0001595020294189453
r_  generation:  0.0014531612396240234
local_output_nid generation:  0.00010824203491210938
local_in_edges_tensor generation:  0.00027108192443847656
mini_batch_src_global generation:  0.00033164024353027344
r_  generation:  0.0034477710723876953
----------------------check_connections_block total spend ----------------------------- 0.013186454772949219
generate_one_block  0.0034835338592529297
generate_one_block  0.0034437179565429688
generate_one_block  0.004489898681640625
generate_one_block  0.005565643310546875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.058878421783447266  GigaBytes
Max Memory Allocated: 0.36092329025268555  GigaBytes

connection checking time:  0.016099929809570312
block generation total time  0.02305769920349121
average batch blocks generation time:  0.005764424800872803
block dataloader generation time/epoch 0.07010173797607422
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.056026458740234375  GigaBytes
Max Memory Allocated: 0.36092329025268555  GigaBytes

torch.Size([2053, 500])
torch.Size([449, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.1788196563720703  GigaBytes
Max Memory Allocated: 0.36092329025268555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.05628776550292969  GigaBytes
Max Memory Allocated: 0.36092329025268555  GigaBytes

torch.Size([2613, 500])
torch.Size([712, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.25713539123535156  GigaBytes
Max Memory Allocated: 0.36092329025268555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.05603504180908203  GigaBytes
Max Memory Allocated: 0.36092329025268555  GigaBytes

torch.Size([2376, 500])
torch.Size([661, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.2048473358154297  GigaBytes
Max Memory Allocated: 0.36092329025268555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.060681819915771484  GigaBytes
Max Memory Allocated: 0.36092329025268555  GigaBytes

torch.Size([4947, 500])
torch.Size([1182, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6580810546875 GB
    Memory Allocated: 0.43399858474731445  GigaBytes
Max Memory Allocated: 0.4343142509460449  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004375100135803223 |0.0008672475814819336 |0.12277889251708984 |0.00012832880020141602 |0.16773444414138794 |0.010966777801513672 |
----------------------------------------------------------pseudo_mini_loss sum 3.684494733810425
Total (block generation + training)time/epoch 1.2731807231903076
Training time/epoch 1.2028684616088867
Training time without block to device /epoch 1.199399471282959
Training time without total dataloading part /epoch 1.1735334396362305
load block tensor time/epoch 0.01750040054321289
block to device time/epoch 0.0034689903259277344
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15349
Number of first layer input nodes during this epoch:  11989
