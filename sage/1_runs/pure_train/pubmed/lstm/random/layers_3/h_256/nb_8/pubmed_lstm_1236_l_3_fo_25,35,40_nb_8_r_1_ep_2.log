main start at this time 1648528902.7047486
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020296573638916016
random selection method range initialization spend 0.00017642974853515625
time for parepare:  4.649162292480469e-05
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0011737346649169922
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.814697265625e-05
----------------------check_connections_block total spend ----------------------------- 0.0022156238555908203
generate_one_block  0.0012221336364746094
generate_one_block  0.001125335693359375
generate_one_block  0.0010864734649658203
generate_one_block  0.001104593276977539
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011484622955322266
gen group dst list time:  3.790855407714844e-05
time for parepare:  0.0002319812774658203
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.00029754638671875
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0001418590545654297
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0004813671112060547
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0003509521484375
----------------------check_connections_block total spend ----------------------------- 0.0027267932891845703
generate_one_block  0.001430511474609375
generate_one_block  0.001226186752319336
generate_one_block  0.0017478466033935547
generate_one_block  0.0014646053314208984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000997304916381836
gen group dst list time:  7.224082946777344e-05
time for parepare:  0.0007464885711669922
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.000301361083984375
mini_batch_src_global generation:  0.0001266002655029297
r_  generation:  0.0014128684997558594
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  0.00011539459228515625
r_  generation:  0.0008075237274169922
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.00028252601623535156
mini_batch_src_global generation:  0.0002658367156982422
r_  generation:  0.002871990203857422
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.00046753883361816406
mini_batch_src_global generation:  0.0002810955047607422
r_  generation:  0.002409219741821289
----------------------check_connections_block total spend ----------------------------- 0.012572526931762695
generate_one_block  0.002916097640991211
generate_one_block  0.0018420219421386719
generate_one_block  0.004488468170166016
generate_one_block  0.0038881301879882812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

connection checking time:  0.015299320220947266
block generation total time  0.019003868103027344
average batch blocks generation time:  0.004750967025756836
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.016937732696533203  GigaBytes
Max Memory Allocated: 0.016937732696533203  GigaBytes

torch.Size([2176, 500])
torch.Size([684, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.15781927108764648  GigaBytes
Max Memory Allocated: 0.1579132080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.028779029846191406  GigaBytes
Max Memory Allocated: 0.16223669052124023  GigaBytes

torch.Size([1368, 500])
torch.Size([295, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.10482454299926758  GigaBytes
Max Memory Allocated: 0.16223669052124023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.03391122817993164  GigaBytes
Max Memory Allocated: 0.16223669052124023  GigaBytes

torch.Size([4166, 500])
torch.Size([1046, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5447998046875 GB
    Memory Allocated: 0.3336367607116699  GigaBytes
Max Memory Allocated: 0.333803653717041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.03288078308105469  GigaBytes
Max Memory Allocated: 0.3373880386352539  GigaBytes

torch.Size([3495, 500])
torch.Size([729, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.29030418395996094  GigaBytes
Max Memory Allocated: 0.3373880386352539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00372159481048584 |0.0862952470779419 |0.22336280345916748 |0.00013971328735351562 |0.12659072875976562 |0.007957220077514648 |
----------------------------------------------------------pseudo_mini_loss sum 2.033177614212036
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14315
Number of first layer input nodes during this epoch:  11205
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.05916786193847656  GigaBytes
Max Memory Allocated: 0.3373880386352539  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004935264587402344
random selection method range initialization spend 0.00011134147644042969
time for parepare:  4.887580871582031e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010967254638671875Using backend: pytorch

mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.078315734863281e-05
----------------------check_connections_block total spend ----------------------------- 0.0011386871337890625
generate_one_block  0.0011844635009765625
generate_one_block  0.0010952949523925781
generate_one_block  0.0010557174682617188
generate_one_block  0.001104593276977539
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005481243133544922
gen group dst list time:  3.719329833984375e-05
time for parepare:  0.00024056434631347656
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0001957416534423828
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0003211498260498047
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0002913475036621094
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.0005159378051757812
----------------------check_connections_block total spend ----------------------------- 0.0028820037841796875
generate_one_block  0.001341104507446289
generate_one_block  0.0015683174133300781
generate_one_block  0.0014350414276123047
generate_one_block  0.0018236637115478516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009756088256835938
gen group dst list time:  8.296966552734375e-05
time for parepare:  0.0007114410400390625
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.00029158592224121094
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0010721683502197266
local_output_nid generation:  6.866455078125e-05
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  0.00022459030151367188
r_  generation:  0.0017576217651367188
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.00017714500427246094
r_  generation:  0.0015196800231933594
local_output_nid generation:  0.00010991096496582031
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  0.00034117698669433594
r_  generation:  0.003375530242919922
----------------------check_connections_block total spend ----------------------------- 0.012911558151245117
generate_one_block  0.003479480743408203
generate_one_block  0.0033185482025146484
generate_one_block  0.0030066967010498047
generate_one_block  0.005240440368652344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.05916786193847656  GigaBytes
Max Memory Allocated: 0.3373880386352539  GigaBytes

connection checking time:  0.015793561935424805
block generation total time  0.021213293075561523
average batch blocks generation time:  0.005303323268890381
block dataloader generation time/epoch 0.06578254699707031
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.0557255744934082  GigaBytes
Max Memory Allocated: 0.3373880386352539  GigaBytes

torch.Size([1841, 500])
torch.Size([390, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.16051721572875977  GigaBytes
Max Memory Allocated: 0.3373880386352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.057009220123291016  GigaBytes
Max Memory Allocated: 0.3373880386352539  GigaBytes

torch.Size([2518, 500])
torch.Size([654, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.23850727081298828  GigaBytes
Max Memory Allocated: 0.3373880386352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.056696414947509766  GigaBytes
Max Memory Allocated: 0.3373880386352539  GigaBytes

torch.Size([2355, 500])
torch.Size([634, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.2034626007080078  GigaBytes
Max Memory Allocated: 0.3373880386352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.06094074249267578  GigaBytes
Max Memory Allocated: 0.3373880386352539  GigaBytes

torch.Size([4605, 500])
torch.Size([1106, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.4075169563293457  GigaBytes
Max Memory Allocated: 0.4076704978942871  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003658890724182129 |0.000791013240814209 |0.10543113946914673 |0.00012415647506713867 |0.13176441192626953 |0.006436586380004883 |
----------------------------------------------------------pseudo_mini_loss sum 3.72696590423584
Total (block generation + training)time/epoch 1.047539234161377
Training time/epoch 0.9814603328704834
Training time without block to device /epoch 0.9782962799072266
Training time without total dataloading part /epoch 0.9557154178619385
load block tensor time/epoch 0.014635562896728516
block to device time/epoch 0.003164052963256836
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14459
Number of first layer input nodes during this epoch:  11319
