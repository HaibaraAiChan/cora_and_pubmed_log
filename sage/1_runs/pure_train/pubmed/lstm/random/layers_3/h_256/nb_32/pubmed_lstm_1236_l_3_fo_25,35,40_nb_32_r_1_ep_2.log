main start at this time 1648528927.6055064
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020453929901123047
random selection method range initialization spend 0.00018262863159179688
time for parepare:  4.6253204345703125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  0.0010294914245605469
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.1682510375976562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  1.6927719116210938e-05
----------------------check_connections_block total spend ----------------------------- 0.003740072250366211
generate_one_block  0.0011527538299560547
generate_one_block  0.0009751319885253906
generate_one_block  0.0010030269622802734
generate_one_block  0.0010066032409667969
generate_one_block  0.0009827613830566406
generate_one_block  0.0009675025939941406
generate_one_block  0.0009653568267822266
generate_one_block  0.001073598861694336
generate_one_block  0.0009946823120117188
generate_one_block  0.0009682178497314453
generate_one_block  0.0010085105895996094
generate_one_block  0.001018524169921875
generate_one_block  0.0009996891021728516
generate_one_block  0.000978231430053711
generate_one_block  0.0009891986846923828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012621879577636719
gen group dst list time:  7.891654968261719e-05
time for parepare:  0.0002353191375732422
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  8.153915405273438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  8.296966552734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00015926361083984375
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0001366138458251953
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00020837783813476562
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  0.00010991096496582031
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.772445678710938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00015282630920410156
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  9.250640869140625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  7.43865966796875e-05
----------------------check_connections_block total spend ----------------------------- 0.004500150680541992
generate_one_block  0.0011248588562011719
generate_one_block  0.0011014938354492188
generate_one_block  0.0010128021240234375
generate_one_block  0.0011894702911376953
generate_one_block  0.0010380744934082031
generate_one_block  0.001003265380859375
generate_one_block  0.001041412353515625
generate_one_block  0.0011801719665527344
generate_one_block  0.0012285709381103516
generate_one_block  0.000993490219116211
generate_one_block  0.0010669231414794922
generate_one_block  0.0010313987731933594
generate_one_block  0.001134634017944336
generate_one_block  0.001049041748046875
generate_one_block  0.001062631607055664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011343955993652344
gen group dst list time:  0.00011897087097167969
time for parepare:  0.0007216930389404297
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00028324127197265625
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0003800392150878906
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00036334991455078125
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00015807151794433594
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0008478164672851562
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.00021147727966308594
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001571178436279297
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0007376670837402344
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  0.00012636184692382812
r_  generation:  0.0012118816375732422
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.00034356117248535156
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0005803108215332031
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0005097389221191406
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.0011436939239501953
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  0.00010967254638671875
r_  generation:  0.0008025169372558594
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0003578662872314453
----------------------check_connections_block total spend ----------------------------- 0.01455378532409668
generate_one_block  0.0015132427215576172
generate_one_block  0.0014286041259765625
generate_one_block  0.0011036396026611328
generate_one_block  0.001985311508178711
generate_one_block  0.0012073516845703125
generate_one_block  0.0011243820190429688
generate_one_block  0.0011088848114013672
generate_one_block  0.0017771720886230469
generate_one_block  0.0023860931396484375
generate_one_block  0.0013644695281982422
generate_one_block  0.0016145706176757812
generate_one_block  0.0015149116516113281
generate_one_block  0.0022771358489990234
generate_one_block  0.002305746078491211
generate_one_block  0.0013134479522705078
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

connection checking time:  0.019053936004638672
block generation total time  0.040283203125
average batch blocks generation time:  0.002685546875
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.01410055160522461  GigaBytes
Max Memory Allocated: 0.01410055160522461  GigaBytes

torch.Size([668, 500])
torch.Size([169, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2440185546875 GB
    Memory Allocated: 0.05120849609375  GigaBytes
Max Memory Allocated: 0.051236629486083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.026680469512939453  GigaBytes
Max Memory Allocated: 0.06682157516479492  GigaBytes

torch.Size([528, 500])
torch.Size([187, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.06165647506713867  GigaBytes
Max Memory Allocated: 0.06682157516479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.026119709014892578  GigaBytes
Max Memory Allocated: 0.07264995574951172  GigaBytes

torch.Size([230, 500])
torch.Size([76, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.040134429931640625  GigaBytes
Max Memory Allocated: 0.07264995574951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.02909564971923828  GigaBytes
Max Memory Allocated: 0.07264995574951172  GigaBytes

torch.Size([1606, 500])
torch.Size([354, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.11749935150146484  GigaBytes
Max Memory Allocated: 0.11754655838012695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.02636098861694336  GigaBytes
Max Memory Allocated: 0.1229090690612793  GigaBytes

torch.Size([359, 500])
torch.Size([67, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.044722557067871094  GigaBytes
Max Memory Allocated: 0.1229090690612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.025949954986572266  GigaBytes
Max Memory Allocated: 0.1229090690612793  GigaBytes

torch.Size([140, 500])
torch.Size([45, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03326892852783203  GigaBytes
Max Memory Allocated: 0.1229090690612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.026279926300048828  GigaBytes
Max Memory Allocated: 0.1229090690612793  GigaBytes

torch.Size([316, 500])
torch.Size([66, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.040813446044921875  GigaBytes
Max Memory Allocated: 0.1229090690612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.02807474136352539  GigaBytes
Max Memory Allocated: 0.1229090690612793  GigaBytes

torch.Size([1271, 500])
torch.Size([297, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.10208320617675781  GigaBytes
Max Memory Allocated: 0.1229090690612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.029447078704833984  GigaBytes
Max Memory Allocated: 0.1229090690612793  GigaBytes

torch.Size([1650, 500])
torch.Size([385, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.15720033645629883  GigaBytes
Max Memory Allocated: 0.15729045867919922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.02698040008544922  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

torch.Size([689, 500])
torch.Size([128, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.05961132049560547  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.027805328369140625  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

torch.Size([988, 500])
torch.Size([207, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.0894160270690918  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.027250289916992188  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

torch.Size([832, 500])
torch.Size([175, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.07675695419311523  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.028005599975585938  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

torch.Size([1226, 500])
torch.Size([294, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.15447139739990234  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.029434680938720703  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

torch.Size([1974, 500])
torch.Size([214, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.11377096176147461  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.02691030502319336  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

torch.Size([652, 500])
torch.Size([167, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.059144020080566406  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003279558817545573 |0.02317814826965332 |0.10124796231587728 |0.00011858940124511718 |0.07867538134256999 |0.01003718376159668 |
----------------------------------------------------------pseudo_mini_loss sum 2.1187939643859863
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16316
Number of first layer input nodes during this epoch:  13129
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.05260515213012695  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005190372467041016
random selection method range initialization spend 0.00012373924255371094
time for parepare:  5.91278076171875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.2411346435546875e-05
----------------------check_connections_block total spend ----------------------------- 0.0028467178344726562
generate_one_block  0.0011451244354248047
generate_one_block  0.0010290145874023438
generate_one_block  0.0010256767272949219
generate_one_block  0.0010313987731933594
generate_one_block  0.0010123252868652344
generate_one_block  0.00102996826171875
generate_one_block  0.0010385513305664062
generate_one_block  0.0011668205261230469
generate_one_block  0.001016378402709961
generate_one_block  0.0010225772857666016
generate_one_block  0.0010128021240234375
generate_one_block  0.0010442733764648438
generate_one_block  0.0010209083557128906
generate_one_block  0.0010271072387695312
generate_one_block  0.0010266304016113281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005397796630859375
gen group dst list time:  8.106231689453125e-05
time for parepare:  0.00026035308837890625
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  5.364418029785156e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.031990051269531e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.054473876953125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00010085105895996094
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00015854835510253906
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.867813110351562e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00016999244689941406
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  5.459785461425781e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.414817810058594e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0002689361572265625
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.000133514404296875
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  7.414817810058594e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00010776519775390625
----------------------check_connections_block total spend ----------------------------- 0.004804372787475586
generate_one_block  0.001115560531616211
generate_one_block  0.0011017322540283203
generate_one_block  0.0010707378387451172
generate_one_block  0.0011548995971679688
generate_one_block  0.0011494159698486328
generate_one_block  0.0012319087982177734
generate_one_block  0.0010981559753417969
generate_one_block  0.0012359619140625
generate_one_block  0.00101470947265625
generate_one_block  0.001016855239868164
generate_one_block  0.001058816909790039
generate_one_block  0.001399993896484375
generate_one_block  0.0011343955993652344
generate_one_block  0.0010416507720947266
generate_one_block  0.0010867118835449219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010731220245361328
gen group dst list time:  0.00013113021850585938
time for parepare:  0.0007612705230712891
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0002646446228027344
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0001723766326904297
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.000461578369140625
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00023651123046875
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0005023479461669922
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0002455711364746094
local_output_nid generation:  0.0011386871337890625
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.00012636184692382812
r_  generation:  0.0011000633239746094
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0002353191375732422
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.0009148120880126953
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.00022459030151367188
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001995563507080078
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0003845691680908203
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  0.0001895427703857422
r_  generation:  0.0018181800842285156
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  0.0001125335693359375
r_  generation:  0.0007164478302001953
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0005161762237548828
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0007369518280029297
----------------------check_connections_block total spend ----------------------------- 0.01714920997619629
generate_one_block  0.0013585090637207031
generate_one_block  0.0016815662384033203
generate_one_block  0.001260995864868164
generate_one_block  0.0015807151794433594
generate_one_block  0.0012502670288085938
generate_one_block  0.002317190170288086
generate_one_block  0.0012271404266357422
generate_one_block  0.0021200180053710938
generate_one_block  0.0012211799621582031
generate_one_block  0.0012288093566894531
generate_one_block  0.001463174819946289
generate_one_block  0.003262042999267578
generate_one_block  0.0018298625946044922
generate_one_block  0.0016202926635742188
generate_one_block  0.0019757747650146484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.05260515213012695  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

connection checking time:  0.021953582763671875
block generation total time  0.04230904579162598
average batch blocks generation time:  0.0028206030527750652
block dataloader generation time/epoch 0.13060355186462402
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.05183267593383789  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

torch.Size([249, 500])
torch.Size([81, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.0666189193725586  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.052846431732177734  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

torch.Size([788, 500])
torch.Size([120, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.09759235382080078  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.05218315124511719  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

torch.Size([436, 500])
torch.Size([89, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.07244110107421875  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.05295991897583008  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

torch.Size([849, 500])
torch.Size([196, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.1004486083984375  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.05206918716430664  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

torch.Size([375, 500])
torch.Size([110, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.07277059555053711  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.05478096008300781  GigaBytes
Max Memory Allocated: 0.16102981567382812  GigaBytes

torch.Size([1427, 500])
torch.Size([312, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.1684255599975586  GigaBytes
Max Memory Allocated: 0.16974210739135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.05205345153808594  GigaBytes
Max Memory Allocated: 0.1722874641418457  GigaBytes

torch.Size([366, 500])
torch.Size([87, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.07174539566040039  GigaBytes
Max Memory Allocated: 0.1722874641418457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.05477428436279297  GigaBytes
Max Memory Allocated: 0.1722874641418457  GigaBytes

torch.Size([1542, 500])
torch.Size([369, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.14361858367919922  GigaBytes
Max Memory Allocated: 0.1722874641418457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.05198383331298828  GigaBytes
Max Memory Allocated: 0.1722874641418457  GigaBytes

torch.Size([329, 500])
torch.Size([91, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.07000064849853516  GigaBytes
Max Memory Allocated: 0.1722874641418457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.05205821990966797  GigaBytes
Max Memory Allocated: 0.1722874641418457  GigaBytes

torch.Size([369, 500])
torch.Size([90, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.06939888000488281  GigaBytes
Max Memory Allocated: 0.1722874641418457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.05261993408203125  GigaBytes
Max Memory Allocated: 0.1722874641418457  GigaBytes

torch.Size([650, 500])
torch.Size([168, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.0887289047241211  GigaBytes
Max Memory Allocated: 0.1722874641418457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.056046485900878906  GigaBytes
Max Memory Allocated: 0.1722874641418457  GigaBytes

torch.Size([2391, 500])
torch.Size([530, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.2466602325439453  GigaBytes
Max Memory Allocated: 0.2471785545349121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05356168746948242  GigaBytes
Max Memory Allocated: 0.25049448013305664  GigaBytes

torch.Size([1169, 500])
torch.Size([286, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.11995935440063477  GigaBytes
Max Memory Allocated: 0.25049448013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.053357601165771484  GigaBytes
Max Memory Allocated: 0.25049448013305664  GigaBytes

torch.Size([1062, 500])
torch.Size([139, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10242843627929688  GigaBytes
Max Memory Allocated: 0.25049448013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05403566360473633  GigaBytes
Max Memory Allocated: 0.25049448013305664  GigaBytes

torch.Size([1406, 500])
torch.Size([211, 256])Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.12400484085083008  GigaBytes
Max Memory Allocated: 0.25049448013305664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003350226084391276 |0.0008913675944010416 |0.071535857518514 |0.00012062390645345052 |0.08214289347330729 |0.008569717407226562 |
----------------------------------------------------------pseudo_mini_loss sum 4.318460941314697
Total (block generation + training)time/epoch 2.5380711555480957
Training time/epoch 2.4071638584136963
Training time without block to device /epoch 2.3937933444976807
Training time without total dataloading part /epoch 2.3155603408813477
load block tensor time/epoch 0.05025339126586914
block to device time/epoch 0.013370513916015625
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16644
Number of first layer input nodes during this epoch:  13408
