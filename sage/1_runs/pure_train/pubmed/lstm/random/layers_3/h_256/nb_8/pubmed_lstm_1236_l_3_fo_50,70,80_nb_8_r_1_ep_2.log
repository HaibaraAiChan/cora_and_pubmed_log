main start at this time 1648529090.5536864
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0032470226287841797
random selection method range initialization spend 0.00018525123596191406
time for parepare:  4.291534423828125e-05
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.0013833045959472656
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  5.14984130859375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.600120544433594e-05
----------------------check_connections_block total spend ----------------------------- 0.002347707748413086
generate_one_block  0.0012404918670654297
generate_one_block  0.0010640621185302734
generate_one_block  0.0010144710540771484
generate_one_block  0.0010581016540527344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017194747924804688
gen group dst list time:  3.218650817871094e-05
time for parepare:  0.00022912025451660156
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00029158592224121094
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00013136863708496094
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0005018711090087891
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.00036406517028808594
----------------------check_connections_block total spend ----------------------------- 0.0027055740356445312
generate_one_block  0.001424551010131836
generate_one_block  0.0011391639709472656
generate_one_block  0.0017066001892089844
generate_one_block  0.0014607906341552734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011124610900878906
gen group dst list time:  7.128715515136719e-05
time for parepare:  0.0007755756378173828
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.0003101825714111328
mini_batch_src_global generation:  0.00013971328735351562
r_  generation:  0.0015006065368652344
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  0.00011873245239257812
r_  generation:  0.0008370876312255859
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.00027680397033691406
mini_batch_src_global generation:  0.0003421306610107422
r_  generation:  0.003259420394897461
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.0004837512969970703
mini_batch_src_global generation:  0.00038123130798339844
r_  generation:  0.002980947494506836
----------------------check_connections_block total spend ----------------------------- 0.014168024063110352
generate_one_block  0.002929210662841797
generate_one_block  0.0019078254699707031
generate_one_block  0.0051860809326171875
generate_one_block  0.004753589630126953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

connection checking time:  0.016873598098754883
block generation total time  0.0205078125
average batch blocks generation time:  0.005126953125
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.017467975616455078  GigaBytes
Max Memory Allocated: 0.017467975616455078  GigaBytes

torch.Size([2457, 500])
torch.Size([738, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.18430137634277344  GigaBytes
Max Memory Allocated: 0.18439531326293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.029495716094970703  GigaBytes
Max Memory Allocated: 0.18883466720581055  GigaBytes

torch.Size([1537, 500])
torch.Size([295, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.11266756057739258  GigaBytes
Max Memory Allocated: 0.18883466720581055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.035327911376953125  GigaBytes
Max Memory Allocated: 0.18883466720581055  GigaBytes

torch.Size([4626, 500])
torch.Size([1106, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.4013814926147461  GigaBytes
Max Memory Allocated: 0.4015483856201172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6229248046875 GB
    Memory Allocated: 0.03505516052246094  GigaBytes
Max Memory Allocated: 0.4051327705383301  GigaBytes

torch.Size([4385, 500])
torch.Size([802, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6229248046875 GB
    Memory Allocated: 0.36773109436035156  GigaBytes
Max Memory Allocated: 0.4051327705383301  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003552377223968506 |0.08690643310546875 |0.3047460913658142 |0.0001729130744934082 |0.24685019254684448 |0.0076961517333984375 |
----------------------------------------------------------pseudo_mini_loss sum 2.0308356285095215
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16302
Number of first layer input nodes during this epoch:  13005
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6229248046875 GB
    Memory Allocated: 0.061693668365478516  GigaBytes
Max Memory Allocated: 0.4051327705383301  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005125999450683594
random selection method range initialization spend 0.00011205673217773438
time for parepare:  5.054473876953125e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00010561943054199219
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  4.57763671875e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.6253204345703125e-05
----------------------check_connections_block total spend ----------------------------- 0.0010905265808105469
generate_one_block  0.0012035369873046875
generate_one_block  0.001165151596069336
generate_one_block  0.0011055469512939453
generate_one_block  0.0011162757873535156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005543231964111328
gen group dst list time:  3.719329833984375e-05
time for parepare:  0.0002536773681640625
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00017952919006347656
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0003299713134765625
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0002582073211669922
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0005028247833251953
----------------------check_connections_block total spend ----------------------------- 0.0028295516967773438
generate_one_block  0.0014271736145019531
generate_one_block  0.001558065414428711
generate_one_block  0.0015408992767333984
generate_one_block  0.001836538314819336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009922981262207031
gen group dst list time:  8.058547973632812e-05
time for parepare:  0.0007524490356445312
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00029540061950683594
mini_batch_src_global generation:  0.00018453598022460938
r_  generation:  0.0013165473937988281
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.0002663135528564453
r_  generation:  0.0021762847900390625
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  0.00017571449279785156
r_  generation:  0.0016331672668457031
local_output_nid generation:  0.00011324882507324219
local_in_edges_tensor generation:  0.00028014183044433594
mini_batch_src_global generation:  0.0003933906555175781
r_  generation:  0.003873109817504883
----------------------check_connections_block total spend ----------------------------- 0.014738321304321289
generate_one_block  0.0031585693359375
generate_one_block  0.004019021987915039
generate_one_block  0.0033407211303710938
generate_one_block  0.006391763687133789
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6229248046875 GB
    Memory Allocated: 0.061693668365478516  GigaBytes
Max Memory Allocated: 0.4051327705383301  GigaBytes

connection checking time:  0.017567873001098633
block generation total time  0.02327275276184082
average batch blocks generation time:  0.005818188190460205
block dataloader generation time/epoch 0.0824129581451416
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6229248046875 GB
    Memory Allocated: 0.05747795104980469  GigaBytes
Max Memory Allocated: 0.4051327705383301  GigaBytes

torch.Size([2308, 500])
torch.Size([449, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6229248046875 GB
    Memory Allocated: 0.2048487663269043  GigaBytes
Max Memory Allocated: 0.4051327705383301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6229248046875 GB
    Memory Allocated: 0.058582305908203125  GigaBytes
Max Memory Allocated: 0.4051327705383301  GigaBytes

torch.Size([2888, 500])
torch.Size([712, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6229248046875 GB
    Memory Allocated: 0.2907543182373047  GigaBytes
Max Memory Allocated: 0.4051327705383301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6229248046875 GB
    Memory Allocated: 0.05798196792602539  GigaBytes
Max Memory Allocated: 0.4051327705383301  GigaBytes

torch.Size([2575, 500])
torch.Size([661, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6229248046875 GB
    Memory Allocated: 0.2244729995727539  GigaBytes
Max Memory Allocated: 0.4051327705383301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6229248046875 GB
    Memory Allocated: 0.06426620483398438  GigaBytes
Max Memory Allocated: 0.4051327705383301  GigaBytes

torch.Size([5483, 500])
torch.Size([1184, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.49480295181274414  GigaBytes
Max Memory Allocated: 0.49512195587158203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006987333297729492 |0.0009829998016357422 |0.19693225622177124 |0.00015246868133544922 |0.2665664553642273 |0.006949901580810547 |
----------------------------------------------------------pseudo_mini_loss sum 3.9053661823272705
Total (block generation + training)time/epoch 1.9874553680419922
Training time/epoch 1.9045424461364746
Training time without block to device /epoch 1.9006104469299316
Training time without total dataloading part /epoch 1.8615546226501465
load block tensor time/epoch 0.02794933319091797
block to device time/epoch 0.003931999206542969
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16616
Number of first layer input nodes during this epoch:  13254
