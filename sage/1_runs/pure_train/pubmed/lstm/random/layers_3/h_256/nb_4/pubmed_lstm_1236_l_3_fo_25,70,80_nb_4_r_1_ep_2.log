main start at this time 1648529013.3673368
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009984970092773438
random selection method range initialization spend 0.0002956390380859375
time for parepare:  4.172325134277344e-05
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.0031054019927978516
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  7.772445678710938e-05
----------------------check_connections_block total spend ----------------------------- 0.0038084983825683594
generate_one_block  0.0012569427490234375
generate_one_block  0.0011148452758789062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005185604095458984
gen group dst list time:  2.288818359375e-05
time for parepare:  0.00023102760314941406
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0004203319549560547
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  0.00012063980102539062
r_  generation:  0.0008060932159423828
----------------------check_connections_block total spend ----------------------------- 0.002402782440185547
generate_one_block  0.0016829967498779297
generate_one_block  0.002046346664428711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001108407974243164
gen group dst list time:  6.866455078125e-05
time for parepare:  0.0006895065307617188
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.00035381317138671875
mini_batch_src_global generation:  0.0001652240753173828
r_  generation:  0.0020151138305664062
local_output_nid generation:  0.00012493133544921875
local_in_edges_tensor generation:  0.0003695487976074219
mini_batch_src_global generation:  0.0005044937133789062
r_  generation:  0.004738330841064453
----------------------check_connections_block total spend ----------------------------- 0.011029481887817383
generate_one_block  0.0036482810974121094
generate_one_block  0.0071659088134765625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

connection checking time:  0.01343226432800293
block generation total time  0.014543533325195312
average batch blocks generation time:  0.007271766662597656
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.019001483917236328  GigaBytes
Max Memory Allocated: 0.019001483917236328  GigaBytes

torch.Size([3272, 500])
torch.Size([1019, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.23755788803100586  GigaBytes
Max Memory Allocated: 0.23793649673461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.037897586822509766  GigaBytes
Max Memory Allocated: 0.24218034744262695  GigaBytes

torch.Size([6476, 500])
torch.Size([1802, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8026123046875 GB
    Memory Allocated: 0.5772061347961426  GigaBytes
Max Memory Allocated: 0.5774760246276855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016184687614440918 |0.1709761619567871 |0.3932328224182129 |0.00022280216217041016 |0.2778806686401367 |0.00800013542175293 |
----------------------------------------------------------pseudo_mini_loss sum 2.172321081161499
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12925
Number of first layer input nodes during this epoch:  9748
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.0637826919555664  GigaBytes
Max Memory Allocated: 0.5808725357055664  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0017085075378417969
random selection method range initialization spend 0.00011038780212402344
time for parepare:  4.696846008300781e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.508827209472656e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  6.937980651855469e-05
----------------------check_connections_block total spend ----------------------------- 0.0006818771362304688
generate_one_block  0.0012440681457519531
generate_one_block  0.0011463165283203125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001087188720703125
gen group dst list time:  2.7179718017578125e-05
time for parepare:  0.0002567768096923828
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00048542022705078125
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  0.00010442733764648438
r_  generation:  0.0007791519165039062
----------------------check_connections_block total spend ----------------------------- 0.0024421215057373047
generate_one_block  0.0018393993377685547
generate_one_block  0.0021975040435791016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009865760803222656
gen group dst list time:  7.104873657226562e-05
time for parepare:  0.0006928443908691406
local_output_nid generation:  0.00011229515075683594
local_in_edges_tensor generation:  0.00037360191345214844
mini_batch_src_global generation:  0.0002429485321044922
r_  generation:  0.0029087066650390625
local_output_nid generation:  0.00014209747314453125
local_in_edges_tensor generation:  0.0003402233123779297
mini_batch_src_global generation:  0.0009768009185791016
r_  generation:  0.0045049190521240234
----------------------check_connections_block total spend ----------------------------- 0.012491226196289062
generate_one_block  0.0058956146240234375
generate_one_block  0.00696253776550293
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.0637826919555664  GigaBytes
Max Memory Allocated: 0.5808725357055664  GigaBytes

connection checking time:  0.014933347702026367
block generation total time  0.016895055770874023
average batch blocks generation time:  0.008447527885437012
block dataloader generation time/epoch 0.13682126998901367
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.05946063995361328  GigaBytes
Max Memory Allocated: 0.5808725357055664  GigaBytes
Using backend: pytorch

torch.Size([3979, 500])
torch.Size([1144, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.38002490997314453  GigaBytes
Max Memory Allocated: 0.5808725357055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.06357860565185547  GigaBytes
Max Memory Allocated: 0.5808725357055664  GigaBytes

torch.Size([6118, 500])
torch.Size([1751, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.5542697906494141  GigaBytes
Max Memory Allocated: 0.5808725357055664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003943800926208496 |0.0007021427154541016 |0.1521739959716797 |0.00013959407806396484 |0.29228293895721436 |0.006813764572143555 |
----------------------------------------------------------pseudo_mini_loss sum 2.447812557220459
Total (block generation + training)time/epoch 1.0473394393920898
Training time/epoch 0.9102721214294434
Training time without block to device /epoch 0.9088678359985352
Training time without total dataloading part /epoch 0.8960068225860596
load block tensor time/epoch 0.007887601852416992
block to device time/epoch 0.0014042854309082031
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13347
Number of first layer input nodes during this epoch:  10097
