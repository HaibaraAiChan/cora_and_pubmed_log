main start at this time 1648529078.3591628
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0016117095947265625
random selection method range initialization spend 0.0002002716064453125
time for parepare:  4.696846008300781e-05
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.0011966228485107422
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  8.225440979003906e-05
----------------------check_connections_block total spend ----------------------------- 0.0019142627716064453
generate_one_block  0.001299142837524414
generate_one_block  0.0012001991271972656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009214878082275391
gen group dst list time:  2.5987625122070312e-05
time for parepare:  0.0002543926239013672
local_output_nid generation:  7.700920104980469e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0004382133483886719
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  0.0001308917999267578
r_  generation:  0.0009024143218994141
----------------------check_connections_block total spend ----------------------------- 0.0026373863220214844
generate_one_block  0.0017185211181640625
generate_one_block  0.002275228500366211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011668205261230469
gen group dst list time:  6.508827209472656e-05
time for parepare:  0.0008172988891601562
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.000362396240234375
mini_batch_src_global generation:  0.0001971721649169922
r_  generation:  0.0024306774139404297
local_output_nid generation:  0.0001308917999267578
local_in_edges_tensor generation:  0.00037670135498046875
mini_batch_src_global generation:  0.0006630420684814453
r_  generation:  0.005830526351928711
----------------------check_connections_block total spend ----------------------------- 0.013331174850463867
generate_one_block  0.004140615463256836
generate_one_block  0.008001327514648438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

connection checking time:  0.01596856117248535
block generation total time  0.016135692596435547
average batch blocks generation time:  0.008067846298217773
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.019439220428466797  GigaBytes
Max Memory Allocated: 0.019439220428466797  GigaBytes

torch.Size([3504, 500])
torch.Size([1019, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.2617497444152832  GigaBytes
Max Memory Allocated: 0.2621283531188965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.03914785385131836  GigaBytes
Max Memory Allocated: 0.2663722038269043  GigaBytes

torch.Size([7136, 500])
torch.Size([1804, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.6560873985290527  GigaBytes
Max Memory Allocated: 0.6563572883605957  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0036966800689697266 |0.17055320739746094 |0.47091007232666016 |0.0002117156982421875 |0.3289024829864502 |0.007676839828491211 |
----------------------------------------------------------pseudo_mini_loss sum 2.177177906036377
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13819
Number of first layer input nodes during this epoch:  10640
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.06503629684448242  GigaBytes
Max Memory Allocated: 0.6597537994384766  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005271434783935547
random selection method range initialization spend 0.00012063980102539062
time for parepare:  5.340576171875e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  7.43865966796875e-05
----------------------check_connections_block total spend ----------------------------- 0.0007576942443847656
generate_one_block  0.001203775405883789
generate_one_block  0.0011882781982421875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005741119384765625
gen group dst list time:  2.86102294921875e-05
time for parepare:  0.0002834796905517578
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0005102157592773438
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  0.00010824203491210938
r_  generation:  0.000820159912109375
----------------------check_connections_block total spend ----------------------------- 0.0025949478149414062
generate_one_block  0.001874685287475586
generate_one_block  0.002300739288330078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011076927185058594
gen group dst list time:  8.249282836914062e-05
time for parepare:  0.0007510185241699219
local_output_nid generation:  0.00011777877807617188
local_in_edges_tensor generation:  0.0003974437713623047
mini_batch_src_global generation:  0.0003323554992675781
r_  generation:  0.003487110137939453
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.0003609657287597656
mini_batch_src_global generation:  0.0006613731384277344
r_  generation:  0.005338907241821289
----------------------check_connections_block total spend ----------------------------- 0.014205217361450195
generate_one_block  0.006029367446899414
generate_one_block  0.009509563446044922
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.06503629684448242  GigaBytes
Max Memory Allocated: 0.6597537994384766  GigaBytes

connection checking time:  0.0168001651763916
block generation total time  0.01971435546875
average batch blocks generation time:  0.009857177734375
block dataloader generation time/epoch 0.06156635284423828
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.059549808502197266  GigaBytes
Max Memory Allocated: 0.6597537994384766  GigaBytes
Using backend: pytorch

torch.Size([4342, 500])
torch.Size([1145, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.42380762100219727  GigaBytes
Max Memory Allocated: 0.6597537994384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.06377506256103516  GigaBytes
Max Memory Allocated: 0.6597537994384766  GigaBytes

torch.Size([6581, 500])
torch.Size([1749, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.6162867546081543  GigaBytes
Max Memory Allocated: 0.6597537994384766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0040340423583984375 |0.0008803606033325195 |0.23372268676757812 |0.00013887882232666016 |0.36025071144104004 |0.006612539291381836 |
----------------------------------------------------------pseudo_mini_loss sum 2.3116865158081055
Total (block generation + training)time/epoch 1.2731258869171143
Training time/epoch 1.2113111019134521
Training time without block to device /epoch 1.209550380706787
Training time without total dataloading part /epoch 1.1948370933532715
load block tensor time/epoch 0.008068084716796875
block to device time/epoch 0.001760721206665039
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14172
Number of first layer input nodes during this epoch:  10923
