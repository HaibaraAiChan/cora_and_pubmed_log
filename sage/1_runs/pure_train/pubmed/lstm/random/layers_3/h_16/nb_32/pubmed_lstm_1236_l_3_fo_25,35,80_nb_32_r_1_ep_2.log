main start at this time 1648527969.1264162
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00057220458984375
random selection method range initialization spend 0.00017404556274414062
time for parepare:  4.267692565917969e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  0.000982522964477539
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.58306884765625e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.0967254638671875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.296966552734375e-05
mini_batch_src_global generation:  1.2636184692382812e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.630752563476562e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.726119995117188e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.1920928955078125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.511543273925781e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.440017700195312e-05
mini_batch_src_global generation:  1.2636184692382812e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.58306884765625e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.33514404296875e-05
----------------------check_connections_block total spend ----------------------------- 0.0035691261291503906
generate_one_block  0.0010547637939453125
generate_one_block  0.0010039806365966797
generate_one_block  0.0009465217590332031
generate_one_block  0.0009284019470214844
generate_one_block  0.0009672641754150391
generate_one_block  0.0009629726409912109
generate_one_block  0.0009291172027587891
generate_one_block  0.0009756088256835938
generate_one_block  0.0009756088256835938
generate_one_block  0.0009589195251464844
generate_one_block  0.0009362697601318359
generate_one_block  0.0009219646453857422
generate_one_block  0.0009953975677490234
generate_one_block  0.0009510517120361328
generate_one_block  0.0009739398956298828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005178451538085938
gen group dst list time:  7.486343383789062e-05
time for parepare:  0.00022125244140625
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00015473365783691406
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00015020370483398438
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.651878356933594e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  7.462501525878906e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.031990051269531e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0001652240753173828
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00017786026000976562
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  9.441375732421875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.054473876953125e-05
----------------------check_connections_block total spend ----------------------------- 0.0043337345123291016
generate_one_block  0.0010380744934082031
generate_one_block  0.0010063648223876953
generate_one_block  0.0011138916015625
generate_one_block  0.0011992454528808594
generate_one_block  0.0010585784912109375
generate_one_block  0.0009717941284179688
generate_one_block  0.0010540485382080078
generate_one_block  0.001055002212524414
generate_one_block  0.0010123252868652344
generate_one_block  0.0009970664978027344
generate_one_block  0.0011665821075439453
generate_one_block  0.0009729862213134766
generate_one_block  0.0011477470397949219
generate_one_block  0.0010640621185302734
generate_one_block  0.001013040542602539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010986328125
gen group dst list time:  0.00011706352233886719
time for parepare:  0.0006961822509765625
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0002567768096923828
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00013709068298339844
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0003490447998046875
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0007679462432861328
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  0.00011515617370605469
r_  generation:  0.0009791851043701172
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00030994415283203125
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0002644062042236328
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0003561973571777344
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00026106834411621094
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.00041365623474121094
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.0004291534423828125
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  0.00011801719665527344
r_  generation:  0.0012290477752685547
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.000225067138671875
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  9.107589721679688e-05
r_  generation:  0.0009748935699462891
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0007569789886474609
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00023412704467773438
----------------------check_connections_block total spend ----------------------------- 0.01409602165222168
generate_one_block  0.0012066364288330078
generate_one_block  0.001445770263671875
generate_one_block  0.0019001960754394531
generate_one_block  0.0021750926971435547
generate_one_block  0.0012416839599609375
generate_one_block  0.0013606548309326172
generate_one_block  0.0013773441314697266
generate_one_block  0.001272439956665039
generate_one_block  0.0014429092407226562
generate_one_block  0.001482248306274414
generate_one_block  0.0023741722106933594
generate_one_block  0.001199483871459961
generate_one_block  0.0022096633911132812
generate_one_block  0.0021581649780273438
generate_one_block  0.0011813640594482422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.01842975616455078
block generation total time  0.03989863395690918
average batch blocks generation time:  0.002659908930460612
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.008055686950683594  GigaBytes
Max Memory Allocated: 0.008055686950683594  GigaBytes

torch.Size([268, 500])
torch.Size([86, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2147216796875 GB
    Memory Allocated: 0.018944740295410156  GigaBytes
Max Memory Allocated: 0.019716739654541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.017230987548828125  GigaBytes
Max Memory Allocated: 0.034421443939208984  GigaBytes

torch.Size([652, 500])
torch.Size([116, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.050518035888671875  GigaBytes
Max Memory Allocated: 0.052680015563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.018712997436523438  GigaBytes
Max Memory Allocated: 0.06506013870239258  GigaBytes

torch.Size([1441, 500])
torch.Size([391, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.09371566772460938  GigaBytes
Max Memory Allocated: 0.09892654418945312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.019589900970458984  GigaBytes
Max Memory Allocated: 0.1064462661743164  GigaBytes

torch.Size([1384, 500])
torch.Size([315, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12433624267578125  GigaBytes
Max Memory Allocated: 0.1327652931213379  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.01679706573486328  GigaBytes
Max Memory Allocated: 0.13575077056884766  GigaBytes

torch.Size([420, 500])
torch.Size([142, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.04118633270263672  GigaBytes
Max Memory Allocated: 0.13575077056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.017099857330322266  GigaBytes
Max Memory Allocated: 0.13575077056884766  GigaBytes

torch.Size([583, 500])
torch.Size([95, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.042124271392822266  GigaBytes
Max Memory Allocated: 0.13575077056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.017549514770507812  GigaBytes
Max Memory Allocated: 0.13575077056884766  GigaBytes

torch.Size([823, 500])
torch.Size([111, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.0505213737487793  GigaBytes
Max Memory Allocated: 0.13575077056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.016836166381835938  GigaBytes
Max Memory Allocated: 0.13575077056884766  GigaBytes

torch.Size([441, 500])
torch.Size([131, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.04045534133911133  GigaBytes
Max Memory Allocated: 0.13575077056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.01744985580444336  GigaBytes
Max Memory Allocated: 0.13575077056884766  GigaBytes

torch.Size([768, 500])
torch.Size([142, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.05962371826171875  GigaBytes
Max Memory Allocated: 0.13575077056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.01750040054321289  GigaBytes
Max Memory Allocated: 0.13575077056884766  GigaBytes

torch.Size([795, 500])
torch.Size([148, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.06093263626098633  GigaBytes
Max Memory Allocated: 0.13575077056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.018523693084716797  GigaBytes
Max Memory Allocated: 0.13575077056884766  GigaBytes

torch.Size([1331, 500])
torch.Size([333, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.14555644989013672  GigaBytes
Max Memory Allocated: 0.15631484985351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.016763687133789062  GigaBytes
Max Memory Allocated: 0.15631484985351562  GigaBytes

torch.Size([403, 500])
torch.Size([96, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.03611135482788086  GigaBytes
Max Memory Allocated: 0.15631484985351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.019702434539794922  GigaBytes
Max Memory Allocated: 0.15631484985351562  GigaBytes

torch.Size([1968, 500])
torch.Size([405, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.11888599395751953  GigaBytes
Max Memory Allocated: 0.15631484985351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.019813060760498047  GigaBytes
Max Memory Allocated: 0.15631484985351562  GigaBytes

torch.Size([1524, 500])
torch.Size([233, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.09141254425048828  GigaBytes
Max Memory Allocated: 0.15631484985351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.016771793365478516  GigaBytes
Max Memory Allocated: 0.15631484985351562  GigaBytes

torch.Size([408, 500])
torch.Size([105, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.035314083099365234  GigaBytes
Max Memory Allocated: 0.15631484985351562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0031645139058430988 |0.023818190892537436 |0.10330797831217448 |0.00012218157450358074 |0.07895398139953613 |0.008036375045776367 |
----------------------------------------------------------pseudo_mini_loss sum 2.1799440383911133
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16414
Number of first layer input nodes during this epoch:  13209
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.03187894821166992  GigaBytes
Max Memory Allocated: 0.15631484985351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0030303001403808594
random selection method range initialization spend 0.0001227855682373047
time for parepare:  5.7697296142578125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.5299530029296875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.1920928955078125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.1920928955078125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4781951904296875e-05
----------------------check_connections_block total spend ----------------------------- 0.002655506134033203
generate_one_block  0.0012135505676269531
generate_one_block  0.0010797977447509766
generate_one_block  0.0010459423065185547
generate_one_block  0.0010440349578857422
generate_one_block  0.001079559326171875
generate_one_block  0.0010356903076171875
generate_one_block  0.0010297298431396484
generate_one_block  0.0010619163513183594
generate_one_block  0.0010609626770019531
generate_one_block  0.0011103153228759766
generate_one_block  0.0010423660278320312
generate_one_block  0.0010547637939453125
generate_one_block  0.0010330677032470703
generate_one_block  0.001035928726196289
generate_one_block  0.0010323524475097656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017092227935791016
gen group dst list time:  7.772445678710938e-05
time for parepare:  0.0002665519714355469
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00024080276489257812
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.012222290039062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  6.937980651855469e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.106231689453125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.556510925292969e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0001780986785888672
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001614093780517578
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  5.6743621826171875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00013184547424316406
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  7.963180541992188e-05
----------------------check_connections_block total spend ----------------------------- 0.004698038101196289
generate_one_block  0.0014743804931640625
generate_one_block  0.0011641979217529297
generate_one_block  0.0011527538299560547
generate_one_block  0.0011608600616455078
generate_one_block  0.001155853271484375
generate_one_block  0.0010883808135986328
generate_one_block  0.0012180805206298828
generate_one_block  0.0011124610900878906
generate_one_block  0.0011365413665771484
generate_one_block  0.0010771751403808594
generate_one_block  0.001341104507446289
generate_one_block  0.0011966228485107422
generate_one_block  0.0010437965393066406
generate_one_block  0.0012869834899902344
generate_one_block  0.0010771751403808594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011324882507324219
gen group dst list time:  0.00013756752014160156
time for parepare:  0.0008108615875244141
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00030303001403808594
mini_batch_src_global generation:  0.00021076202392578125
r_  generation:  0.0014450550079345703
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0002713203430175781
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0005233287811279297
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.00038170814514160156
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0005202293395996094
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00020384788513183594
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00035762786865234375
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00013208389282226562
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.000553131103515625
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0002384185791015625
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0011150836944580078
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  0.00011968612670898438
r_  generation:  0.0009653568267822266
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0002486705780029297
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0006561279296875
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  8.177757263183594e-05
r_  generation:  0.0005137920379638672
----------------------check_connections_block total spend ----------------------------- 0.015661239624023438
generate_one_block  0.0030765533447265625
generate_one_block  0.0013322830200195312
generate_one_block  0.0016891956329345703
generate_one_block  0.0015544891357421875
generate_one_block  0.0017671585083007812
generate_one_block  0.0012440681457519531
generate_one_block  0.0014693737030029297
generate_one_block  0.0011334419250488281
generate_one_block  0.0017027854919433594
generate_one_block  0.001283407211303711
generate_one_block  0.0024166107177734375
generate_one_block  0.0021796226501464844
generate_one_block  0.0012552738189697266
generate_one_block  0.0018384456634521484
generate_one_block  0.0016932487487792969
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.03187894821166992  GigaBytes
Max Memory Allocated: 0.15631484985351562  GigaBytes

connection checking time:  0.020359277725219727
block generation total time  0.04332232475280762
average batch blocks generation time:  0.0028881549835205076
block dataloader generation time/epoch 0.13776874542236328
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.03428983688354492  GigaBytes
Max Memory Allocated: 0.15631484985351562  GigaBytes

torch.Size([1688, 500])
torch.Size([432, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.18202877044677734  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.031827449798583984  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

torch.Size([385, 500])
torch.Size([99, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.05373048782348633  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.032698631286621094  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

torch.Size([849, 500])
torch.Size([152, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.0786447525024414  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.03241920471191406  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

torch.Size([701, 500])
torch.Size([133, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.06345748901367188  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.03336286544799805  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

torch.Size([1205, 500])
torch.Size([187, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.08291387557983398  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.03174638748168945  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

torch.Size([343, 500])
torch.Size([99, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.047007083892822266  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.0323333740234375  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

torch.Size([655, 500])
torch.Size([156, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.06456708908081055  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.031455039978027344  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

torch.Size([187, 500])
torch.Size([61, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.04070854187011719  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.03287649154663086  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

torch.Size([944, 500])
torch.Size([187, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.0835409164428711  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.031823158264160156  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

torch.Size([383, 500])
torch.Size([109, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.050684452056884766  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.03401947021484375  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

torch.Size([1548, 500])
torch.Size([357, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.14544916152954102  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.03425025939941406  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

torch.Size([1676, 500])
torch.Size([330, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.11980390548706055  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.031786441802978516  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

torch.Size([364, 500])
torch.Size([92, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.04956769943237305  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.03340005874633789  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

torch.Size([1223, 500])
torch.Size([301, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.0943918228149414  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.03310823440551758  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

torch.Size([1069, 500])Using backend: pytorch

torch.Size([167, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.08060073852539062  GigaBytes
Max Memory Allocated: 0.19439125061035156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0019025166829427084 |0.0008001486460367838 |0.07185424168904622 |0.00011310577392578124 |0.08034742673238118 |0.0062940120697021484 |
----------------------------------------------------------pseudo_mini_loss sum 1.4019412994384766
Total (block generation + training)time/epoch 2.496126890182495
Training time/epoch 2.3581125736236572
Training time without block to device /epoch 2.3461103439331055
Training time without total dataloading part /epoch 2.291015625
load block tensor time/epoch 0.028537750244140625
block to device time/epoch 0.012002229690551758
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16439
Number of first layer input nodes during this epoch:  13220
