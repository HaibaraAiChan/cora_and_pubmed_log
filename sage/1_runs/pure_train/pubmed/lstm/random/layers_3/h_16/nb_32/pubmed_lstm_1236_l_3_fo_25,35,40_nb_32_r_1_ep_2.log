main start at this time 1648527909.2107458
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010523796081542969
random selection method range initialization spend 0.00017380714416503906
time for parepare:  4.410743713378906e-05
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  0.0011699199676513672
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.52587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.004082202911376953
generate_one_block  0.0011832714080810547
generate_one_block  0.0010306835174560547
generate_one_block  0.0010292530059814453
generate_one_block  0.0010371208190917969
generate_one_block  0.0010211467742919922
generate_one_block  0.001024007797241211
generate_one_block  0.0010344982147216797
generate_one_block  0.0010867118835449219
generate_one_block  0.0010318756103515625
generate_one_block  0.0010294914245605469
generate_one_block  0.0010313987731933594
generate_one_block  0.0010209083557128906
generate_one_block  0.0010440349578857422
generate_one_block  0.0010318756103515625
generate_one_block  0.0010225772857666016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006034374237060547
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.000247955322265625
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  5.316734313964844e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00017595291137695312
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0001614093780517578
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  7.414817810058594e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  6.508827209472656e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  8.082389831542969e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.416175842285156e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001888275146484375
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.175041198730469e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00019431114196777344
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00010657310485839844
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.650520324707031e-05
----------------------check_connections_block total spend ----------------------------- 0.0047893524169921875
generate_one_block  0.0010876655578613281
generate_one_block  0.0011172294616699219
generate_one_block  0.0012598037719726562
generate_one_block  0.0012540817260742188
generate_one_block  0.0011129379272460938
generate_one_block  0.0010743141174316406
generate_one_block  0.0011496543884277344
generate_one_block  0.0011141300201416016
generate_one_block  0.0010342597961425781
generate_one_block  0.0010151863098144531
generate_one_block  0.0012793540954589844
generate_one_block  0.001012563705444336
generate_one_block  0.001169443130493164
generate_one_block  0.0011587142944335938
generate_one_block  0.00104522705078125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011496543884277344
gen group dst list time:  0.00012540817260742188
time for parepare:  0.0007722377777099609
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00023889541625976562
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00014495849609375
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.00037217140197753906
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0008704662322998047
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  0.00014257431030273438
r_  generation:  0.0010721683502197266
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.00032973289489746094
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00023651123046875
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00038170814514160156
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0002913475036621094
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.00046515464782714844
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0004856586456298828
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  0.00012636184692382812
r_  generation:  0.0012671947479248047
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.00025153160095214844
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  9.679794311523438e-05
r_  generation:  0.0011000633239746094
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00015783309936523438
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0007970333099365234
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0002486705780029297
----------------------check_connections_block total spend ----------------------------- 0.015360116958618164
generate_one_block  0.001306772232055664
generate_one_block  0.0015227794647216797
generate_one_block  0.0019176006317138672
generate_one_block  0.002243518829345703
generate_one_block  0.0012555122375488281
generate_one_block  0.0014026165008544922
generate_one_block  0.0014007091522216797
generate_one_block  0.0012674331665039062
generate_one_block  0.0014982223510742188
generate_one_block  0.0014913082122802734
generate_one_block  0.002454042434692383
generate_one_block  0.0011930465698242188
generate_one_block  0.002252817153930664
generate_one_block  0.002167224884033203
generate_one_block  0.0011868476867675781
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.02014946937561035
block generation total time  0.041445016860961914
average batch blocks generation time:  0.0027630011240641276
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.00805044174194336  GigaBytes
Max Memory Allocated: 0.00805044174194336  GigaBytes

torch.Size([265, 500])
torch.Size([86, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2147216796875 GB
    Memory Allocated: 0.018897533416748047  GigaBytes
Max Memory Allocated: 0.019664764404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.017229080200195312  GigaBytes
Max Memory Allocated: 0.03433036804199219  GigaBytes

torch.Size([651, 500])
torch.Size([116, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.05051612854003906  GigaBytes
Max Memory Allocated: 0.053078651428222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.01874399185180664  GigaBytes
Max Memory Allocated: 0.06481504440307617  GigaBytes

torch.Size([1457, 500])
torch.Size([394, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.09486865997314453  GigaBytes
Max Memory Allocated: 0.10025930404663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.01858663558959961  GigaBytes
Max Memory Allocated: 0.1066884994506836  GigaBytes

torch.Size([1369, 500])
torch.Size([309, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.1209101676940918  GigaBytes
Max Memory Allocated: 0.12919378280639648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.016780376434326172  GigaBytes
Max Memory Allocated: 0.13147497177124023  GigaBytes

torch.Size([411, 500])
torch.Size([142, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.04116964340209961  GigaBytes
Max Memory Allocated: 0.13147497177124023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.016918182373046875  GigaBytes
Max Memory Allocated: 0.13147497177124023  GigaBytes

torch.Size([486, 500])
torch.Size([95, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.03716278076171875  GigaBytes
Max Memory Allocated: 0.13147497177124023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.017559051513671875  GigaBytes
Max Memory Allocated: 0.13147497177124023  GigaBytes

torch.Size([828, 500])
torch.Size([111, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.05053091049194336  GigaBytes
Max Memory Allocated: 0.13147497177124023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.016841888427734375  GigaBytes
Max Memory Allocated: 0.13147497177124023  GigaBytes

torch.Size([444, 500])
torch.Size([131, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.040461063385009766  GigaBytes
Max Memory Allocated: 0.13147497177124023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.017442703247070312  GigaBytes
Max Memory Allocated: 0.13147497177124023  GigaBytes

torch.Size([764, 500])
torch.Size([142, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.0596165657043457  GigaBytes
Max Memory Allocated: 0.13147497177124023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.018321514129638672  GigaBytes
Max Memory Allocated: 0.13147497177124023  GigaBytes

torch.Size([821, 500])
torch.Size([151, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.06224203109741211  GigaBytes
Max Memory Allocated: 0.13147497177124023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.018543243408203125  GigaBytes
Max Memory Allocated: 0.13147497177124023  GigaBytes

torch.Size([1342, 500])
torch.Size([332, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.14284133911132812  GigaBytes
Max Memory Allocated: 0.1533670425415039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.016768932342529297  GigaBytes
Max Memory Allocated: 0.1533670425415039  GigaBytes

torch.Size([406, 500])
torch.Size([96, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.036116600036621094  GigaBytes
Max Memory Allocated: 0.1533670425415039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.019762039184570312  GigaBytes
Max Memory Allocated: 0.1533670425415039  GigaBytes

torch.Size([1969, 500])
torch.Size([405, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.11894559860229492  GigaBytes
Max Memory Allocated: 0.1533670425415039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.01887989044189453  GigaBytes
Max Memory Allocated: 0.1533670425415039  GigaBytes

torch.Size([1531, 500])
torch.Size([233, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.08970832824707031  GigaBytes
Max Memory Allocated: 0.1533670425415039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.016771793365478516  GigaBytes
Max Memory Allocated: 0.1533670425415039  GigaBytes

torch.Size([408, 500])
torch.Size([105, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.035314083099365234  GigaBytes
Max Memory Allocated: 0.1533670425415039  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003460041681925456 |0.024255037307739258 |0.1036404291788737 |0.00011935234069824219 |0.0779561201731364 |0.007786273956298828 |
----------------------------------------------------------pseudo_mini_loss sum 2.1814403533935547
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16356
Number of first layer input nodes during this epoch:  13152
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.03187894821166992  GigaBytes
Max Memory Allocated: 0.1533670425415039  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005040168762207031
random selection method range initialization spend 0.00011730194091796875
time for parepare:  5.793571472167969e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.52587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0028257369995117188
generate_one_block  0.0011878013610839844
generate_one_block  0.0010542869567871094
generate_one_block  0.001047372817993164
generate_one_block  0.0010335445404052734
generate_one_block  0.0010230541229248047
generate_one_block  0.0010488033294677734
generate_one_block  0.0010457038879394531
generate_one_block  0.0010364055633544922
generate_one_block  0.0010552406311035156
generate_one_block  0.0023374557495117188
generate_one_block  0.0010390281677246094
generate_one_block  0.0010755062103271484
generate_one_block  0.0010497570037841797
generate_one_block  0.0010342597961425781
generate_one_block  0.0010280609130859375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006868839263916016
gen group dst list time:  8.034706115722656e-05
time for parepare:  0.0002605915069580078
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0002429485321044922
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  6.961822509765625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  9.5367431640625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  8.821487426757812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.000186920166015625
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00016927719116210938
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00011730194091796875
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.891654968261719e-05
----------------------check_connections_block total spend ----------------------------- 0.004853725433349609
generate_one_block  0.0013773441314697266
generate_one_block  0.001104116439819336
generate_one_block  0.0011370182037353516
generate_one_block  0.0011134147644042969
generate_one_block  0.0011324882507324219
generate_one_block  0.0011136531829833984
generate_one_block  0.0011882781982421875
generate_one_block  0.0010716915130615234
generate_one_block  0.0010724067687988281
generate_one_block  0.0010304450988769531
generate_one_block  0.0011868476867675781
generate_one_block  0.0011835098266601562
generate_one_block  0.0010166168212890625
generate_one_block  0.0011250972747802734
generate_one_block  0.0010600090026855469
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011296272277832031
gen group dst list time:  0.0001366138458251953
time for parepare:  0.0008683204650878906
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.0003058910369873047
mini_batch_src_global generation:  0.0001952648162841797
r_  generation:  0.0015099048614501953
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.00028133392333984375
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0005295276641845703
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00038743019104003906
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005526542663574219
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00023245811462402344
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.0003750324249267578
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0001347064971923828
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0005552768707275391
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0002434253692626953
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  0.00010800361633300781
r_  generation:  0.0011610984802246094
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.0001308917999267578
r_  generation:  0.0009582042694091797
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0002422332763671875
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0006897449493408203
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0005247592926025391
----------------------check_connections_block total spend ----------------------------- 0.01601552963256836
generate_one_block  0.0032014846801757812
generate_one_block  0.0013141632080078125
generate_one_block  0.0016112327575683594
generate_one_block  0.0015311241149902344
generate_one_block  0.0017313957214355469
generate_one_block  0.001247406005859375
generate_one_block  0.0014426708221435547
generate_one_block  0.0011239051818847656
generate_one_block  0.001680612564086914
generate_one_block  0.0012547969818115234
generate_one_block  0.0024170875549316406
generate_one_block  0.002192974090576172
generate_one_block  0.0012600421905517578
generate_one_block  0.0018246173858642578
generate_one_block  0.0016493797302246094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.03187894821166992  GigaBytes
Max Memory Allocated: 0.1533670425415039  GigaBytes

connection checking time:  0.02086925506591797
block generation total time  0.042395830154418945
average batch blocks generation time:  0.002826388676961263
block dataloader generation time/epoch 0.1323235034942627
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.03430032730102539  GigaBytes
Max Memory Allocated: 0.1533670425415039  GigaBytes

torch.Size([1693, 500])
torch.Size([432, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.1832137107849121  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.03182029724121094  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

torch.Size([381, 500])
torch.Size([99, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.05372333526611328  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.032698631286621094  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

torch.Size([849, 500])
torch.Size([152, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.0786447525024414  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.032421112060546875  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

torch.Size([702, 500])
torch.Size([133, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.06345939636230469  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.03334760665893555  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

torch.Size([1197, 500])
torch.Size([188, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.08324623107910156  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.0318145751953125  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

torch.Size([379, 500])
torch.Size([99, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.0484466552734375  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.03231096267700195  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

torch.Size([643, 500])
torch.Size([156, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.06400060653686523  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.03145885467529297  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

torch.Size([189, 500])
torch.Size([61, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.04071235656738281  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.032880306243896484  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

torch.Size([946, 500])
torch.Size([188, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.08360958099365234  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.03181743621826172  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

torch.Size([380, 500])
torch.Size([109, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.050507545471191406  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.03409147262573242  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

torch.Size([1586, 500])
torch.Size([355, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.14687156677246094  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.03427934646606445  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

torch.Size([1691, 500])
torch.Size([331, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.12071704864501953  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.031786441802978516  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

torch.Size([364, 500])
torch.Size([92, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.04956769943237305  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.03341865539550781  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

torch.Size([1233, 500])
torch.Size([299, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.09624052047729492  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.0331120491027832  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

torch.Size([1071, 500])Using backend: pytorch

torch.Size([167, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.08060455322265625  GigaBytes
Max Memory Allocated: 0.19580698013305664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003515227635701497 |0.0008772532145182292 |0.07262552579243978 |0.00011502901713053385 |0.08118392626444498 |0.006448984146118164 |
----------------------------------------------------------pseudo_mini_loss sum 1.465802788734436
Total (block generation + training)time/epoch 2.5395233631134033
Training time/epoch 2.4069411754608154
Training time without block to device /epoch 2.393782377243042
Training time without total dataloading part /epoch 2.3153162002563477
load block tensor time/epoch 0.05272841453552246
block to device time/epoch 0.013158798217773438
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16522
Number of first layer input nodes during this epoch:  13304
