main start at this time 1648528006.147551
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018687248229980469
random selection method range initialization spend 0.00018215179443359375
time for parepare:  4.601478576660156e-05
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0012209415435791016
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  4.696846008300781e-05
----------------------check_connections_block total spend ----------------------------- 0.0022554397583007812
generate_one_block  0.0012280941009521484
generate_one_block  0.0011441707611083984
generate_one_block  0.0010762214660644531
generate_one_block  0.0010862350463867188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009775161743164062
gen group dst list time:  3.933906555175781e-05
time for parepare:  0.0002467632293701172
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0004146099090576172
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0001964569091796875
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00039958953857421875
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0003829002380371094
----------------------check_connections_block total spend ----------------------------- 0.0028944015502929688
generate_one_block  0.0016677379608154297
generate_one_block  0.0012743473052978516
generate_one_block  0.0015263557434082031
generate_one_block  0.0015342235565185547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010504722595214844
gen group dst list time:  7.891654968261719e-05
time for parepare:  0.0007872581481933594
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.0003516674041748047
mini_batch_src_global generation:  0.0002086162567138672
r_  generation:  0.002548694610595703
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  0.00017380714416503906
r_  generation:  0.00118255615234375
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.000202178955078125
r_  generation:  0.002272367477416992
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.0004410743713378906
mini_batch_src_global generation:  0.00023698806762695312
r_  generation:  0.0023217201232910156
----------------------check_connections_block total spend ----------------------------- 0.01346445083618164
generate_one_block  0.004431724548339844
generate_one_block  0.002311229705810547
generate_one_block  0.0036013126373291016
generate_one_block  0.0037958621978759766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.01635885238647461
block generation total time  0.020142793655395508
average batch blocks generation time:  0.005035698413848877
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.01423025131225586  GigaBytes
Max Memory Allocated: 0.01423025131225586  GigaBytes

torch.Size([3546, 500])
torch.Size([985, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.2540316581726074  GigaBytes
Max Memory Allocated: 0.2710428237915039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.018795013427734375  GigaBytes
Max Memory Allocated: 0.2710428237915039  GigaBytes

torch.Size([1966, 500])
torch.Size([447, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.12128257751464844  GigaBytes
Max Memory Allocated: 0.2710428237915039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.01991748809814453  GigaBytes
Max Memory Allocated: 0.2710428237915039  GigaBytes

torch.Size([2549, 500])
torch.Size([732, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.24129962921142578  GigaBytes
Max Memory Allocated: 0.2710428237915039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.022638320922851562  GigaBytes
Max Memory Allocated: 0.2710428237915039  GigaBytes

torch.Size([4012, 500])
torch.Size([847, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.23567628860473633  GigaBytes
Max Memory Allocated: 0.2710428237915039  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0027084946632385254 |0.08670061826705933 |0.2449207305908203 |0.00014293193817138672 |0.16214340925216675 |0.008733987808227539 |
----------------------------------------------------------pseudo_mini_loss sum 1.7531081438064575
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15440
Number of first layer input nodes during this epoch:  12073
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.038516998291015625  GigaBytes
Max Memory Allocated: 0.2710428237915039  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005071163177490234
random selection method range initialization spend 0.00012063980102539062
time for parepare:  5.4836273193359375e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00011134147644042969
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.601478576660156e-05
----------------------check_connections_block total spend ----------------------------- 0.0011892318725585938
generate_one_block  0.001199483871459961
generate_one_block  0.0010874271392822266
generate_one_block  0.0011010169982910156
generate_one_block  0.001102447509765625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005695819854736328
gen group dst list time:  3.4332275390625e-05
time for parepare:  0.0002799034118652344
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0004162788391113281
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0002651214599609375
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.0003590583801269531
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00039315223693847656
----------------------check_connections_block total spend ----------------------------- 0.0030868053436279297
generate_one_block  0.0016589164733886719
generate_one_block  0.0014226436614990234
generate_one_block  0.0018508434295654297
generate_one_block  0.0015838146209716797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010094642639160156
gen group dst list time:  8.893013000488281e-05
time for parepare:  0.000759124755859375
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.00034618377685546875
mini_batch_src_global generation:  0.000217437744140625
r_  generation:  0.002470731735229492
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  0.00022602081298828125
r_  generation:  0.0015532970428466797
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.0002410411834716797
r_  generation:  0.0022323131561279297
local_output_nid generation:  8.20159912109375e-05
local_in_edges_tensor generation:  0.00023508071899414062
mini_batch_src_global generation:  0.00021648406982421875
r_  generation:  0.002268075942993164
----------------------check_connections_block total spend ----------------------------- 0.013813972473144531
generate_one_block  0.00436854362487793
generate_one_block  0.0029964447021484375
generate_one_block  0.003643512725830078
generate_one_block  0.005301475524902344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.038516998291015625  GigaBytes
Max Memory Allocated: 0.2710428237915039  GigaBytes

connection checking time:  0.01690077781677246
block generation total time  0.022826194763183594
average batch blocks generation time:  0.0057065486907958984
block dataloader generation time/epoch 0.0728600025177002
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.036414146423339844  GigaBytes
Max Memory Allocated: 0.2710428237915039  GigaBytes

torch.Size([2923, 500])
torch.Size([758, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.27480363845825195  GigaBytes
Max Memory Allocated: 0.2926321029663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.03616762161254883  GigaBytes
Max Memory Allocated: 0.2926321029663086  GigaBytes

torch.Size([2806, 500])
torch.Size([622, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.1774601936340332  GigaBytes
Max Memory Allocated: 0.2926321029663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.03640556335449219  GigaBytes
Max Memory Allocated: 0.2926321029663086  GigaBytes

torch.Size([2838, 500])
torch.Size([737, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.2427978515625  GigaBytes
Max Memory Allocated: 0.2926321029663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.038433074951171875  GigaBytes
Max Memory Allocated: 0.2926321029663086  GigaBytes

torch.Size([3717, 500])
torch.Size([882, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.23794317245483398  GigaBytes
Max Memory Allocated: 0.2926321029663086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005135238170623779 |0.0009018182754516602 |0.12164777517318726 |0.00013011693954467773 |0.1565943956375122 |0.009700536727905273 |
----------------------------------------------------------pseudo_mini_loss sum 1.5607068538665771
Total (block generation + training)time/epoch 1.2298383712768555
Training time/epoch 1.156785011291504
Training time without block to device /epoch 1.1531777381896973
Training time without total dataloading part /epoch 1.1231896877288818
load block tensor time/epoch 0.020540952682495117
block to device time/epoch 0.0036072731018066406
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15639
Number of first layer input nodes during this epoch:  12284
