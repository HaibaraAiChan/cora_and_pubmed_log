main start at this time 1648528070.354915
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006694793701171875
random selection method range initialization spend 0.00022912025451660156
time for parepare:  5.5789947509765625e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0012285709381103516
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.482269287109375e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.412101745605469e-05
----------------------check_connections_block total spend ----------------------------- 0.0024390220642089844
generate_one_block  0.0014374256134033203
generate_one_block  0.0013427734375
generate_one_block  0.0012698173522949219
generate_one_block  0.0012841224670410156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006706714630126953
gen group dst list time:  4.363059997558594e-05
time for parepare:  0.00031065940856933594
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0005221366882324219
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0002353191375732422
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.00048089027404785156
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  0.004906177520751953
r_  generation:  0.0005295276641845703
----------------------check_connections_block total spend ----------------------------- 0.008493185043334961
generate_one_block  0.003175497055053711
generate_one_block  0.0015475749969482422
generate_one_block  0.0017113685607910156
generate_one_block  0.0015559196472167969
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002511739730834961
gen group dst list time:  0.00010085105895996094
time for parepare:  0.0010607242584228516
local_output_nid generation:  9.965896606445312e-05
local_in_edges_tensor generation:  0.0006756782531738281
mini_batch_src_global generation:  0.0003077983856201172
r_  generation:  0.0035326480865478516
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  0.00025343894958496094
r_  generation:  0.0016124248504638672
local_output_nid generation:  7.796287536621094e-05
local_in_edges_tensor generation:  0.0002732276916503906
mini_batch_src_global generation:  0.0003254413604736328
r_  generation:  0.0032150745391845703
local_output_nid generation:  8.96453857421875e-05
local_in_edges_tensor generation:  0.0005717277526855469
mini_batch_src_global generation:  0.0003387928009033203
r_  generation:  0.0024242401123046875
----------------------check_connections_block total spend ----------------------------- 0.01833057403564453
generate_one_block  0.004837751388549805
generate_one_block  0.0025658607482910156
generate_one_block  0.004040241241455078
generate_one_block  0.004110813140869141
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.026823759078979492
block generation total time  0.023545026779174805
average batch blocks generation time:  0.005886256694793701
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014768600463867188  GigaBytes
Max Memory Allocated: 0.014768600463867188  GigaBytes

torch.Size([3830, 500])
torch.Size([985, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.2939004898071289  GigaBytes
Max Memory Allocated: 0.3128647804260254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.01929330825805664  GigaBytes
Max Memory Allocated: 0.3128647804260254  GigaBytes

torch.Size([2203, 500])
torch.Size([447, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.14008331298828125  GigaBytes
Max Memory Allocated: 0.3128647804260254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.020492076873779297  GigaBytes
Max Memory Allocated: 0.3128647804260254  GigaBytes

torch.Size([2852, 500])
torch.Size([732, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.28290843963623047  GigaBytes
Max Memory Allocated: 0.3128647804260254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.02355337142944336  GigaBytes
Max Memory Allocated: 0.3128647804260254  GigaBytes

torch.Size([4499, 500])
torch.Size([850, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.2660698890686035  GigaBytes
Max Memory Allocated: 0.3128647804260254  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002561628818511963 |0.09459042549133301 |0.3102720379829407 |0.00015932321548461914 |0.2609797716140747 |0.0076830387115478516 |
----------------------------------------------------------pseudo_mini_loss sum 1.761711835861206
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16754
Number of first layer input nodes during this epoch:  13384
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.039642333984375  GigaBytes
Max Memory Allocated: 0.3128647804260254  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006055831909179688
random selection method range initialization spend 0.00014448165893554688
time for parepare:  6.914138793945312e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0002276897430419922
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013303756713867188Using backend: pytorch

mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.482269287109375e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.125999450683594e-05
----------------------check_connections_block total spend ----------------------------- 0.0013742446899414062
generate_one_block  0.001432180404663086
generate_one_block  0.0013010501861572266
generate_one_block  0.0013005733489990234
generate_one_block  0.0013225078582763672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006451606750488281
gen group dst list time:  4.267692565917969e-05
time for parepare:  0.00033926963806152344
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0002415180206298828
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0004930496215820312
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0003082752227783203
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.00043272972106933594
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0004630088806152344
----------------------check_connections_block total spend ----------------------------- 0.0036902427673339844
generate_one_block  0.002021312713623047
generate_one_block  0.0017170906066894531
generate_one_block  0.0022382736206054688
generate_one_block  0.0019333362579345703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012614727020263672
gen group dst list time:  0.00011229515075683594
time for parepare:  0.0009396076202392578
local_output_nid generation:  0.00010967254638671875
local_in_edges_tensor generation:  0.00039958953857421875
mini_batch_src_global generation:  0.00035071372985839844
r_  generation:  0.0034291744232177734
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.0002582073211669922
mini_batch_src_global generation:  0.00026488304138183594
r_  generation:  0.0021429061889648438
local_output_nid generation:  9.369850158691406e-05
local_in_edges_tensor generation:  0.00027823448181152344
mini_batch_src_global generation:  0.0002970695495605469
r_  generation:  0.0031137466430664062
local_output_nid generation:  0.00010967254638671875
local_in_edges_tensor generation:  0.00028705596923828125
mini_batch_src_global generation:  0.0003085136413574219
r_  generation:  0.0023534297943115234
----------------------check_connections_block total spend ----------------------------- 0.01805877685546875
generate_one_block  0.004854917526245117
generate_one_block  0.0032339096069335938
generate_one_block  0.005278348922729492
generate_one_block  0.004120826721191406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.039642333984375  GigaBytes
Max Memory Allocated: 0.3128647804260254  GigaBytes

connection checking time:  0.021749019622802734
block generation total time  0.02539801597595215
average batch blocks generation time:  0.006349503993988037
block dataloader generation time/epoch 0.09400129318237305
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.03711748123168945  GigaBytes
Max Memory Allocated: 0.3128647804260254  GigaBytes

torch.Size([3186, 500])
torch.Size([758, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.31444740295410156  GigaBytes
Max Memory Allocated: 0.33278751373291016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.036869049072265625  GigaBytes
Max Memory Allocated: 0.33278751373291016  GigaBytes

torch.Size([3071, 500])
torch.Size([621, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.19385433197021484  GigaBytes
Max Memory Allocated: 0.33278751373291016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.03710794448852539  GigaBytes
Max Memory Allocated: 0.33278751373291016  GigaBytes

torch.Size([3147, 500])
torch.Size([737, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.2792234420776367  GigaBytes
Max Memory Allocated: 0.33278751373291016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.03877115249633789  GigaBytes
Max Memory Allocated: 0.33278751373291016  GigaBytes

torch.Size([4081, 500])
torch.Size([882, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.2659492492675781  GigaBytes
Max Memory Allocated: 0.33278751373291016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004387319087982178 |0.0011069774627685547 |0.18733662366867065 |0.00014001131057739258 |0.2758437395095825 |0.00728607177734375 |
----------------------------------------------------------pseudo_mini_loss sum 1.5650248527526855
Total (block generation + training)time/epoch 1.9896907806396484
Training time/epoch 1.8952221870422363
Training time without block to device /epoch 1.890794277191162
Training time without total dataloading part /epoch 1.860567569732666
load block tensor time/epoch 0.01754927635192871
block to device time/epoch 0.004427909851074219
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16839
Number of first layer input nodes during this epoch:  13485
