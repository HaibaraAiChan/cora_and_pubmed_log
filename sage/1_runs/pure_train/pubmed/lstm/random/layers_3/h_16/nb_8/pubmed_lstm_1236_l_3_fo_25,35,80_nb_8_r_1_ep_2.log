main start at this time 1648527943.412304
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.004339694976806641
random selection method range initialization spend 0.0002422332763671875
time for parepare:  4.744529724121094e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.01271510124206543
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.004895448684692383
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00028324127197265625
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  9.202957153320312e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00010323524475097656
----------------------check_connections_block total spend ----------------------------- 0.019336462020874023
generate_one_block  0.002554178237915039
generate_one_block  0.0022733211517333984
generate_one_block  0.0019788742065429688
generate_one_block  0.0014896392822265625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0015010833740234375
gen group dst list time:  5.435943603515625e-05
time for parepare:  0.0003840923309326172
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00024628639221191406
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0005941390991210938
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.00026607513427734375
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0005536079406738281
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0005369186401367188
----------------------check_connections_block total spend ----------------------------- 0.004037380218505859
generate_one_block  0.002203226089477539
generate_one_block  0.0012218952178955078
generate_one_block  0.0014605522155761719
generate_one_block  0.0014538764953613281
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009789466857910156
gen group dst list time:  7.319450378417969e-05
time for parepare:  0.00075531005859375
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.0004076957702636719
mini_batch_src_global generation:  0.00023484230041503906
r_  generation:  0.0021953582763671875
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  0.00016021728515625
r_  generation:  0.0010042190551757812
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.0020606517791748047
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.0004277229309082031
mini_batch_src_global generation:  0.0002086162567138672
r_  generation:  0.0020599365234375
----------------------check_connections_block total spend ----------------------------- 0.012383460998535156
generate_one_block  0.00406646728515625
generate_one_block  0.002195119857788086
generate_one_block  0.003551006317138672
generate_one_block  0.003679990768432617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.016420841217041016
block generation total time  0.019832134246826172
average batch blocks generation time:  0.004958033561706543
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.013808250427246094  GigaBytes
Max Memory Allocated: 0.013808250427246094  GigaBytes

torch.Size([3324, 500])
torch.Size([880, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.23062658309936523  GigaBytes
Max Memory Allocated: 0.24582147598266602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.0192718505859375  GigaBytes
Max Memory Allocated: 0.24582147598266602  GigaBytes

torch.Size([1836, 500])
torch.Size([407, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.1091146469116211  GigaBytes
Max Memory Allocated: 0.24582147598266602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.020633697509765625  GigaBytes
Max Memory Allocated: 0.24582147598266602  GigaBytes

torch.Size([2547, 500])
torch.Size([690, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.2335805892944336  GigaBytes
Max Memory Allocated: 0.2498912811279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.02322101593017578  GigaBytes
Max Memory Allocated: 0.2498912811279297  GigaBytes

torch.Size([3753, 500])
torch.Size([813, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.22158288955688477  GigaBytes
Max Memory Allocated: 0.2498912811279297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010036706924438477 |0.08719193935394287 |0.247475266456604 |0.0001729130744934082 |0.12749028205871582 |0.01016378402709961 |
----------------------------------------------------------pseudo_mini_loss sum 1.7622748613357544
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14606
Number of first layer input nodes during this epoch:  11460
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03839588165283203  GigaBytes
Max Memory Allocated: 0.2498912811279297  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005571842193603516
random selection method range initialization spend 0.0001251697540283203
time for parepare:  5.53131103515625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012135505676269531Using backend: pytorch

mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.38690185546875e-05
----------------------check_connections_block total spend ----------------------------- 0.0012569427490234375
generate_one_block  0.0012247562408447266
generate_one_block  0.0011138916015625
generate_one_block  0.0011129379272460938
generate_one_block  0.0014019012451171875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005886554718017578
gen group dst list time:  3.2901763916015625e-05
time for parepare:  0.0002219676971435547
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0015561580657958984
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.0003867149353027344
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0002110004425048828
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0003077983856201172
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0003371238708496094
----------------------check_connections_block total spend ----------------------------- 0.004284381866455078
generate_one_block  0.0017986297607421875
generate_one_block  0.001371145248413086
generate_one_block  0.0014872550964355469
generate_one_block  0.0015292167663574219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010204315185546875
gen group dst list time:  7.224082946777344e-05
time for parepare:  0.0006797313690185547
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.00041103363037109375
mini_batch_src_global generation:  0.00026226043701171875
r_  generation:  0.002131938934326172
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  0.00017261505126953125
r_  generation:  0.0011434555053710938
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  0.00017118453979492188
r_  generation:  0.0018846988677978516
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  0.00019121170043945312
r_  generation:  0.0019271373748779297
----------------------check_connections_block total spend ----------------------------- 0.01197361946105957
generate_one_block  0.0041348934173583984
generate_one_block  0.0026793479919433594
generate_one_block  0.0035865306854248047
generate_one_block  0.003867626190185547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03839588165283203  GigaBytes
Max Memory Allocated: 0.2498912811279297  GigaBytes

connection checking time:  0.01625800132751465
block generation total time  0.02045464515686035
average batch blocks generation time:  0.005113661289215088
block dataloader generation time/epoch 0.06680774688720703
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03629446029663086  GigaBytes
Max Memory Allocated: 0.2498912811279297  GigaBytes

torch.Size([2850, 500])
torch.Size([713, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.25357532501220703  GigaBytes
Max Memory Allocated: 0.2698955535888672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.035369873046875  GigaBytes
Max Memory Allocated: 0.2698955535888672  GigaBytes

torch.Size([2370, 500])
torch.Size([538, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.147735595703125  GigaBytes
Max Memory Allocated: 0.2698955535888672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.036142826080322266  GigaBytes
Max Memory Allocated: 0.2698955535888672  GigaBytes

torch.Size([2772, 500])
torch.Size([704, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.2283182144165039  GigaBytes
Max Memory Allocated: 0.2698955535888672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03769683837890625  GigaBytes
Max Memory Allocated: 0.2698955535888672  GigaBytes

torch.Size([3606, 500])
torch.Size([833, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.22911787033081055  GigaBytes
Max Memory Allocated: 0.2698955535888672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008096158504486084 |0.000756382942199707 |0.12893307209014893 |0.00015294551849365234 |0.12619173526763916 |0.011903047561645508 |
----------------------------------------------------------pseudo_mini_loss sum 1.5084574222564697
Total (block generation + training)time/epoch 1.1431825160980225
Training time/epoch 1.0761277675628662
Training time without block to device /epoch 1.0731022357940674
Training time without total dataloading part /epoch 1.0330140590667725
load block tensor time/epoch 0.032384634017944336
block to device time/epoch 0.003025531768798828
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14742
Number of first layer input nodes during this epoch:  11598
