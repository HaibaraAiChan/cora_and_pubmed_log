main start at this time 1648527884.4678078
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009486675262451172
random selection method range initialization spend 0.0002644062042236328
time for parepare:  5.316734313964844e-05
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0017633438110351562
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.221366882324219e-05
----------------------check_connections_block total spend ----------------------------- 0.002971172332763672
generate_one_block  0.001523733139038086
generate_one_block  0.001367807388305664
generate_one_block  0.001291036605834961
generate_one_block  0.0013151168823242188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007739067077636719
gen group dst list time:  4.1484832763671875e-05
time for parepare:  0.000293731689453125
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0004520416259765625
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00022220611572265625
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0004680156707763672
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004513263702392578
----------------------check_connections_block total spend ----------------------------- 0.0033278465270996094
generate_one_block  0.0018954277038574219
generate_one_block  0.0015156269073486328
generate_one_block  0.0017914772033691406
generate_one_block  0.0017964839935302734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001138448715209961
gen group dst list time:  9.5367431640625e-05
time for parepare:  0.0009131431579589844
local_output_nid generation:  8.96453857421875e-05
local_in_edges_tensor generation:  0.000370025634765625
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.0027761459350585938
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  0.00018906593322753906
r_  generation:  0.0012280941009521484
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.0002570152282714844
mini_batch_src_global generation:  0.00024366378784179688
r_  generation:  0.002633333206176758
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.0005190372467041016
mini_batch_src_global generation:  0.00026917457580566406
r_  generation:  0.0026345252990722656
----------------------check_connections_block total spend ----------------------------- 0.01536417007446289
generate_one_block  0.003988981246948242
generate_one_block  0.0021445751190185547
generate_one_block  0.0035169124603271484
generate_one_block  0.003672361373901367
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.0186920166015625
block generation total time  0.02032184600830078
average batch blocks generation time:  0.005080461502075195
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.013888359069824219  GigaBytes
Max Memory Allocated: 0.013888359069824219  GigaBytes

torch.Size([3367, 500])
torch.Size([881, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.22995662689208984  GigaBytes
Max Memory Allocated: 0.2451019287109375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.01926279067993164  GigaBytes
Max Memory Allocated: 0.2451019287109375  GigaBytes

torch.Size([1831, 500])
torch.Size([407, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.10716676712036133  GigaBytes
Max Memory Allocated: 0.2451019287109375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.02059173583984375  GigaBytes
Max Memory Allocated: 0.2451019287109375  GigaBytes

torch.Size([2525, 500])
torch.Size([692, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.2322072982788086  GigaBytes
Max Memory Allocated: 0.24821186065673828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.023261070251464844  GigaBytes
Max Memory Allocated: 0.24821186065673828  GigaBytes

torch.Size([3702, 500])
torch.Size([813, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.2207660675048828  GigaBytes
Max Memory Allocated: 0.24821186065673828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008923232555389404 |0.08662164211273193 |0.22595000267028809 |0.00016927719116210938 |0.12844157218933105 |0.008244991302490234 |
----------------------------------------------------------pseudo_mini_loss sum 1.7743933200836182
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14574
Number of first layer input nodes during this epoch:  11425
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.03843498229980469  GigaBytes
Max Memory Allocated: 0.24821186065673828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005707740783691406
random selection method range initialization spend 0.0001285076141357422
time for parepare:  6.222724914550781e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  6.031990051269531e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013375282287597656Using backend: pytorch

mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.125999450683594e-05
----------------------check_connections_block total spend ----------------------------- 0.0013158321380615234
generate_one_block  0.0014064311981201172
generate_one_block  0.0012862682342529297
generate_one_block  0.0012941360473632812
generate_one_block  0.0016644001007080078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006287097930908203
gen group dst list time:  4.458427429199219e-05
time for parepare:  0.00028824806213378906
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0004699230194091797
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0002815723419189453
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.00040435791015625
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00044846534729003906
----------------------check_connections_block total spend ----------------------------- 0.0034303665161132812
generate_one_block  0.0019130706787109375
generate_one_block  0.001641988754272461
generate_one_block  0.0017817020416259766
generate_one_block  0.0018627643585205078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011038780212402344
gen group dst list time:  9.72747802734375e-05
time for parepare:  0.0008716583251953125
local_output_nid generation:  9.942054748535156e-05
local_in_edges_tensor generation:  0.00041222572326660156
mini_batch_src_global generation:  0.000316619873046875
r_  generation:  0.002800464630126953
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.00023698806762695312
mini_batch_src_global generation:  0.00022172927856445312
r_  generation:  0.0015692710876464844
local_output_nid generation:  8.463859558105469e-05
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.00022935867309570312
r_  generation:  0.0024890899658203125
local_output_nid generation:  0.00010180473327636719
local_in_edges_tensor generation:  0.000274658203125
mini_batch_src_global generation:  0.0002582073211669922
r_  generation:  0.0025949478149414062
----------------------check_connections_block total spend ----------------------------- 0.015614509582519531
generate_one_block  0.004065275192260742
generate_one_block  0.002663135528564453
generate_one_block  0.0035173892974853516
generate_one_block  0.003777027130126953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.03843498229980469  GigaBytes
Max Memory Allocated: 0.24821186065673828  GigaBytes

connection checking time:  0.019044876098632812
block generation total time  0.021222352981567383
average batch blocks generation time:  0.005305588245391846
block dataloader generation time/epoch 0.07353520393371582
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.03625917434692383  GigaBytes
Max Memory Allocated: 0.24821186065673828  GigaBytes

torch.Size([2831, 500])
torch.Size([714, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.2542538642883301  GigaBytes
Max Memory Allocated: 0.270749568939209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03534507751464844  GigaBytes
Max Memory Allocated: 0.270749568939209  GigaBytes

torch.Size([2356, 500])
torch.Size([540, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.14914512634277344  GigaBytes
Max Memory Allocated: 0.270749568939209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03608226776123047  GigaBytes
Max Memory Allocated: 0.270749568939209  GigaBytes

torch.Size([2740, 500])
torch.Size([702, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.22585010528564453  GigaBytes
Max Memory Allocated: 0.270749568939209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.037760257720947266  GigaBytes
Max Memory Allocated: 0.270749568939209  GigaBytes

torch.Size([3640, 500])
torch.Size([830, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.2303786277770996  GigaBytes
Max Memory Allocated: 0.270749568939209  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005129635334014893 |0.0009025335311889648 |0.10671615600585938 |0.00012934207916259766 |0.12626874446868896 |0.009948968887329102 |
----------------------------------------------------------pseudo_mini_loss sum 1.6035224199295044
Total (block generation + training)time/epoch 1.0487666130065918
Training time/epoch 0.9750075340270996
Training time without block to device /epoch 0.9713973999023438
Training time without total dataloading part /epoch 0.9424059391021729
load block tensor time/epoch 0.02051854133605957
block to device time/epoch 0.0036101341247558594
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14709
Number of first layer input nodes during this epoch:  11567
