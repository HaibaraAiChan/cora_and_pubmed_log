main start at this time 1648528098.7678165
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.003332853317260742
random selection method range initialization spend 0.0002601146697998047
time for parepare:  4.2438507080078125e-05
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.002366304397583008
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.430511474609375e-05
----------------------check_connections_block total spend ----------------------------- 0.005170345306396484
generate_one_block  0.0012061595916748047
generate_one_block  0.0009975433349609375
generate_one_block  0.0009799003601074219
generate_one_block  0.0009999275207519531
generate_one_block  0.0009663105010986328
generate_one_block  0.0009665489196777344
generate_one_block  0.001004934310913086
generate_one_block  0.0010426044464111328
generate_one_block  0.0009627342224121094
generate_one_block  0.0009629726409912109
generate_one_block  0.001016378402709961
generate_one_block  0.0009796619415283203
generate_one_block  0.0009868144989013672
generate_one_block  0.0009570121765136719
generate_one_block  0.0009343624114990234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001341104507446289
gen group dst list time:  8.082389831542969e-05
time for parepare:  0.0002646446228027344
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.866455078125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001709461212158203
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00017714500427246094
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.224082946777344e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.437301635742188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  7.653236389160156e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00019049644470214844
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  5.888938903808594e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00018334388732910156
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00010895729064941406
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.4836273193359375e-05
----------------------check_connections_block total spend ----------------------------- 0.004739522933959961
generate_one_block  0.0010776519775390625
generate_one_block  0.0010797977447509766
generate_one_block  0.0012252330780029297
generate_one_block  0.001237630844116211
generate_one_block  0.0010726451873779297
generate_one_block  0.0010268688201904297
generate_one_block  0.0010805130004882812
generate_one_block  0.0010819435119628906
generate_one_block  0.0010178089141845703
generate_one_block  0.0010120868682861328
generate_one_block  0.001165628433227539
generate_one_block  0.0009853839874267578
generate_one_block  0.0011594295501708984
generate_one_block  0.0010831356048583984
generate_one_block  0.001016378402709961
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001322031021118164
gen group dst list time:  0.0001227855682373047
time for parepare:  0.0007708072662353516
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00030040740966796875
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00020313262939453125
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00040435791015625
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.001028299331665039
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  0.00015687942504882812
r_  generation:  0.0013751983642578125
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  7.748603820800781e-05
r_  generation:  0.00032520294189453125
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0004839897155761719
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.00041747093200683594
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0002968311309814453
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.00048089027404785156
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0006158351898193359
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.0001571178436279297
r_  generation:  0.0014843940734863281
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  7.581710815429688e-05
r_  generation:  0.0002753734588623047
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.0010967254638671875
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0010411739349365234
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.00028514862060546875
----------------------check_connections_block total spend ----------------------------- 0.017310142517089844
generate_one_block  0.0012025833129882812
generate_one_block  0.00140380859375
generate_one_block  0.002153158187866211
generate_one_block  0.0025415420532226562
generate_one_block  0.0013256072998046875
generate_one_block  0.0016279220581054688
generate_one_block  0.0014483928680419922
generate_one_block  0.0012378692626953125
generate_one_block  0.0014786720275878906
generate_one_block  0.0016570091247558594
generate_one_block  0.002686023712158203
generate_one_block  0.0012276172637939453
generate_one_block  0.0022916793823242188
generate_one_block  0.0025179386138916016
generate_one_block  0.0011985301971435547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.022049665451049805
block generation total time  0.04232048988342285
average batch blocks generation time:  0.00282136599222819
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.008256912231445312  GigaBytes
Max Memory Allocated: 0.008256912231445312  GigaBytes

torch.Size([375, 500])
torch.Size([112, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2186279296875 GB
    Memory Allocated: 0.02439737319946289  GigaBytes
Max Memory Allocated: 0.025526046752929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2381591796875 GB
    Memory Allocated: 0.017369747161865234  GigaBytes
Max Memory Allocated: 0.039713382720947266  GigaBytes

torch.Size([726, 500])
torch.Size([116, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.05388450622558594  GigaBytes
Max Memory Allocated: 0.05631732940673828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.019142627716064453  GigaBytes
Max Memory Allocated: 0.06901264190673828  GigaBytes

torch.Size([1668, 500])
torch.Size([440, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.11591005325317383  GigaBytes
Max Memory Allocated: 0.12232494354248047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.01977252960205078  GigaBytes
Max Memory Allocated: 0.12809133529663086  GigaBytes

torch.Size([1560, 500])
torch.Size([342, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.1582341194152832  GigaBytes
Max Memory Allocated: 0.16730070114135742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.016898632049560547  GigaBytes
Max Memory Allocated: 0.17083120346069336  GigaBytes

torch.Size([474, 500])
torch.Size([142, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.04395294189453125  GigaBytes
Max Memory Allocated: 0.17083120346069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.017657756805419922  GigaBytes
Max Memory Allocated: 0.17083120346069336  GigaBytes

torch.Size([879, 500])
torch.Size([136, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.0655512809753418  GigaBytes
Max Memory Allocated: 0.17083120346069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.018106460571289062  GigaBytes
Max Memory Allocated: 0.17083120346069336  GigaBytes

torch.Size([967, 500])
torch.Size([112, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.05764913558959961  GigaBytes
Max Memory Allocated: 0.17083120346069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.016884803771972656  GigaBytes
Max Memory Allocated: 0.17083120346069336  GigaBytes

torch.Size([467, 500])
torch.Size([131, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.042441368103027344  GigaBytes
Max Memory Allocated: 0.17083120346069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.017548084259033203  GigaBytes
Max Memory Allocated: 0.17083120346069336  GigaBytes

torch.Size([820, 500])
torch.Size([142, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.0636134147644043  GigaBytes
Max Memory Allocated: 0.17083120346069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.018220901489257812  GigaBytes
Max Memory Allocated: 0.17083120346069336  GigaBytes

torch.Size([1051, 500])
torch.Size([175, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.07749271392822266  GigaBytes
Max Memory Allocated: 0.17083120346069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.01883411407470703  GigaBytes
Max Memory Allocated: 0.17083120346069336  GigaBytes

torch.Size([1493, 500])
torch.Size([346, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.17801380157470703  GigaBytes
Max Memory Allocated: 0.18822002410888672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.016891956329345703  GigaBytes
Max Memory Allocated: 0.19028043746948242  GigaBytes

torch.Size([472, 500])
torch.Size([96, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03933238983154297  GigaBytes
Max Memory Allocated: 0.19028043746948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.019978046417236328  GigaBytes
Max Memory Allocated: 0.19028043746948242  GigaBytes

torch.Size([2115, 500])
torch.Size([405, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.12566614151000977  GigaBytes
Max Memory Allocated: 0.19028043746948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.02007007598876953  GigaBytes
Max Memory Allocated: 0.19028043746948242  GigaBytes

torch.Size([2166, 500])
torch.Size([268, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.12040042877197266  GigaBytes
Max Memory Allocated: 0.19028043746948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.016815662384033203  GigaBytes
Max Memory Allocated: 0.19028043746948242  GigaBytes

torch.Size([431, 500])
torch.Size([106, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03671836853027344  GigaBytes
Max Memory Allocated: 0.19028043746948242  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002609411875406901 |0.02371559143066406 |0.13714771270751952 |0.00013175010681152344 |0.1310032367706299 |0.008522272109985352 |
----------------------------------------------------------pseudo_mini_loss sum 2.1489882469177246
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  19089
Number of first layer input nodes during this epoch:  15664
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.031923770904541016  GigaBytes
Max Memory Allocated: 0.19028043746948242  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005166530609130859
random selection method range initialization spend 0.00012350082397460938
time for parepare:  6.365776062011719e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4781951904296875e-05
----------------------check_connections_block total spend ----------------------------- 0.0027899742126464844
generate_one_block  0.0012030601501464844
generate_one_block  0.0010962486267089844
generate_one_block  0.0010902881622314453
generate_one_block  0.001043558120727539
generate_one_block  0.001043081283569336
generate_one_block  0.0010309219360351562
generate_one_block  0.0010325908660888672
generate_one_block  0.0010306835174560547
generate_one_block  0.001046895980834961
generate_one_block  0.001123666763305664
generate_one_block  0.00104522705078125
generate_one_block  0.0010836124420166016
generate_one_block  0.0010459423065185547
generate_one_block  0.0010406970977783203
generate_one_block  0.0010025501251220703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005743503570556641
gen group dst list time:  7.82012939453125e-05
time for parepare:  0.0002677440643310547
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002536773681640625
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  7.009506225585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  9.775161743164062e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.724761962890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.487701416015625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.628036499023438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0002155303955078125
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0001862049102783203
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00012350082397460938
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  7.915496826171875e-05
----------------------check_connections_block total spend ----------------------------- 0.004838705062866211
generate_one_block  0.0014216899871826172
generate_one_block  0.001119852066040039
generate_one_block  0.0011463165283203125
generate_one_block  0.0011208057403564453
generate_one_block  0.0011708736419677734
generate_one_block  0.0010924339294433594
generate_one_block  0.001199960708618164
generate_one_block  0.0010807514190673828
generate_one_block  0.0011701583862304688
generate_one_block  0.0010540485382080078
generate_one_block  0.0012328624725341797
generate_one_block  0.001230001449584961
generate_one_block  0.0010411739349365234
generate_one_block  0.001155853271484375
generate_one_block  0.0010905265808105469
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012710094451904297
gen group dst list time:  0.00013446807861328125
time for parepare:  0.0008356571197509766
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.0004985332489013672
mini_batch_src_global generation:  0.00026297569274902344
r_  generation:  0.0018680095672607422
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0002856254577636719
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0005156993865966797
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0004138946533203125
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0008623600006103516
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0002574920654296875
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0004677772521972656
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00014281272888183594
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  9.465217590332031e-05
r_  generation:  0.0006387233734130859
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0002751350402832031
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  0.00013494491577148438
r_  generation:  0.0014612674713134766
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  0.00015234947204589844
r_  generation:  0.0010447502136230469
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0002486705780029297
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0008404254913330078
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.0006134510040283203
----------------------check_connections_block total spend ----------------------------- 0.018411636352539062
generate_one_block  0.0036187171936035156
generate_one_block  0.0013339519500732422
generate_one_block  0.0016674995422363281
generate_one_block  0.0016062259674072266
generate_one_block  0.0022249221801757812
generate_one_block  0.0012814998626708984
generate_one_block  0.0015697479248046875
generate_one_block  0.0011982917785644531
generate_one_block  0.0018694400787353516
generate_one_block  0.0013246536254882812
generate_one_block  0.002855539321899414
generate_one_block  0.002330780029296875
generate_one_block  0.0012676715850830078
generate_one_block  0.0020198822021484375
generate_one_block  0.0017724037170410156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.031923770904541016  GigaBytes
Max Memory Allocated: 0.19028043746948242  GigaBytes

connection checking time:  0.023250341415405273
block generation total time  0.04526853561401367
average batch blocks generation time:  0.003017902374267578
block dataloader generation time/epoch 0.15580034255981445
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.03486013412475586  GigaBytes
Max Memory Allocated: 0.19028043746948242  GigaBytes

torch.Size([1986, 500])
torch.Size([474, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.23551177978515625  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.0318751335144043  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

torch.Size([410, 500])
torch.Size([99, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.05481529235839844  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.03279829025268555  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

torch.Size([902, 500])
torch.Size([152, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.08190155029296875  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.0326080322265625  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

torch.Size([802, 500])
torch.Size([133, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.06854391098022461  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.034583091735839844  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

torch.Size([1855, 500])
torch.Size([249, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.11827230453491211  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.031887054443359375  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

torch.Size([418, 500])
torch.Size([105, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.05069446563720703  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.03255510330200195  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

torch.Size([773, 500])
torch.Size([184, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.07393980026245117  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.03150177001953125  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

torch.Size([212, 500])
torch.Size([61, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.041469573974609375  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.03319215774536133  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

torch.Size([1112, 500])
torch.Size([188, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.09417247772216797  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.031946659088134766  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

torch.Size([449, 500])
torch.Size([110, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.0542755126953125  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.034465789794921875  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

torch.Size([1782, 500])
torch.Size([391, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.18579816818237305  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.03465557098388672  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

torch.Size([1892, 500])
torch.Size([356, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13088655471801758  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.03181266784667969  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

torch.Size([378, 500])
torch.Size([92, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.0503239631652832  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.0338282585144043  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

torch.Size([1451, 500])
torch.Size([325, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.11137533187866211  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.03340911865234375  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

torch.Size([1229, 500])Using backend: pytorch

torch.Size([168, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.09046030044555664  GigaBytes
Max Memory Allocated: 0.24846172332763672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004633204142252604 |0.0008706410725911458 |0.101981782913208 |0.00012184778849283854 |0.12110036214192708 |0.0065991878509521484 |
----------------------------------------------------------pseudo_mini_loss sum 1.3462713956832886
Total (block generation + training)time/epoch 3.620847225189209
Training time/epoch 3.464764356613159
Training time without block to device /epoch 3.451704740524292
Training time without total dataloading part /epoch 3.354659080505371
load block tensor time/epoch 0.06949806213378906
block to device time/epoch 0.013059616088867188
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  19095
Number of first layer input nodes during this epoch:  15651
