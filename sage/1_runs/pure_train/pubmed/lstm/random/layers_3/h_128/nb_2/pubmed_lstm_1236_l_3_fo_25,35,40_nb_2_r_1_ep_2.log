Using backend: pytorch
main start at this time 1648528625.5153732
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021347999572753906
random selection method range initialization spend 0.00017452239990234375
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0013339519500732422
----------------------check_connections_block total spend ----------------------------- 0.0017452239990234375
generate_one_block  0.0014367103576660156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012409687042236328
gen group dst list time:  1.9788742065429688e-05
time for parepare:  0.00023126602172851562
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0011708736419677734
----------------------check_connections_block total spend ----------------------------- 0.002122163772583008
generate_one_block  0.0028197765350341797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009777545928955078
gen group dst list time:  5.316734313964844e-05
time for parepare:  0.0007112026214599609
local_output_nid generation:  0.0001900196075439453
local_in_edges_tensor generation:  0.0005445480346679688
mini_batch_src_global generation:  0.00047206878662109375
r_  generation:  0.0062046051025390625
----------------------check_connections_block total spend ----------------------------- 0.010002851486206055
generate_one_block  0.00925445556640625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

connection checking time:  0.012125015258789062
block generation total time  0.01207423210144043
average batch blocks generation time:  0.01207423210144043
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.023399829864501953  GigaBytes
Max Memory Allocated: 0.023399829864501953  GigaBytes

torch.Size([7600, 500])
torch.Size([2537, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6647233963012695  GigaBytes
Max Memory Allocated: 0.6791882514953613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005480766296386719 |0.3414907455444336 |0.6327550411224365 |0.00022602081298828125 |0.17241120338439941 |0.010475873947143555 |
----------------------------------------------------------pseudo_mini_loss sum 1.8260483741760254
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10491
Number of first layer input nodes during this epoch:  7600
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.05170726776123047  GigaBytes
Max Memory Allocated: 0.6791882514953613  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006265640258789062
random selection method range initialization spend 0.00014662742614746094
time for parepare:  6.532669067382812e-05
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0001385211944580078
----------------------check_connections_block total spend ----------------------------- 0.0006136894226074219
generate_one_block  0.0015530586242675781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006330013275146484
gen group dst list time:  2.47955322265625e-05
time for parepare:  0.00034356117248535156
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.000274658203125
mini_batch_src_global generation:  0.000164031982421875
r_  generation:  0.0014171600341796875
----------------------check_connections_block total spend ----------------------------- 0.0026504993438720703
generate_one_block  0.0035109519958496094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001125335693359375
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.0009026527404785156
local_output_nid generation:  0.00024580955505371094
local_in_edges_tensor generation:  0.0006234645843505859
mini_batch_src_global generation:  0.0007352828979492188
r_  generation:  0.007654905319213867
----------------------check_connections_block total spend ----------------------------- 0.01255035400390625
generate_one_block  0.010766744613647461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.05170726776123047  GigaBytes
Max Memory Allocated: 0.6791882514953613  GigaBytes

connection checking time:  0.01520085334777832
block generation total time  0.01427769660949707
average batch blocks generation time:  0.01427769660949707
block dataloader generation time/epoch 0.04756760597229004
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.0514521598815918  GigaBytes
Max Memory Allocated: 0.6791882514953613  GigaBytes

torch.Size([7592, 500])
torch.Size([2535, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.6909346580505371  GigaBytes
Max Memory Allocated: 0.7053976058959961  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0030622482299804688 |0.0006895065307617188 |0.15420794486999512 |0.0001361370086669922 |0.18040776252746582 |0.00680232048034668 |
----------------------------------------------------------pseudo_mini_loss sum 1.8016260862350464
Total (block generation + training)time/epoch 0.39600563049316406
Training time/epoch 0.34828877449035645
Training time without block to device /epoch 0.3475992679595947
Training time without total dataloading part /epoch 0.3415541648864746
load block tensor time/epoch 0.0030622482299804688
block to device time/epoch 0.0006895065307617188
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10481
Number of first layer input nodes during this epoch:  7592
