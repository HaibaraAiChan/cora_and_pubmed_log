main start at this time 1648528635.9918344
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014424324035644531
random selection method range initialization spend 0.00018453598022460938
time for parepare:  4.57763671875e-05
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0012145042419433594
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  5.817413330078125e-05
----------------------check_connections_block total spend ----------------------------- 0.001905202865600586
generate_one_block  0.0013267993927001953
generate_one_block  0.0011446475982666016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000835418701171875
gen group dst list time:  2.6464462280273438e-05
time for parepare:  0.0002372264862060547
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0007414817810058594
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  9.512901306152344e-05
r_  generation:  0.0005328655242919922
----------------------check_connections_block total spend ----------------------------- 0.002487659454345703
generate_one_block  0.0020945072174072266
generate_one_block  0.0017552375793457031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009872913360595703
gen group dst list time:  6.198883056640625e-05
time for parepare:  0.0007596015930175781
local_output_nid generation:  0.00011658668518066406
local_in_edges_tensor generation:  0.00041961669921875
mini_batch_src_global generation:  0.0002961158752441406
r_  generation:  0.003999233245849609
local_output_nid generation:  9.608268737792969e-05
local_in_edges_tensor generation:  0.0002696514129638672
mini_batch_src_global generation:  0.0004258155822753906
r_  generation:  0.003317594528198242
----------------------check_connections_block total spend ----------------------------- 0.011618375778198242
generate_one_block  0.0063629150390625
generate_one_block  0.004923105239868164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

connection checking time:  0.014106035232543945
block generation total time  0.015135765075683594
average batch blocks generation time:  0.007567882537841797
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.019372940063476562  GigaBytes
Max Memory Allocated: 0.019372940063476562  GigaBytes

torch.Size([5476, 500])
torch.Size([1597, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.4111752510070801  GigaBytes
Max Memory Allocated: 0.4206538200378418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.02631855010986328  GigaBytes
Max Memory Allocated: 0.4206538200378418  GigaBytes

torch.Size([4355, 500])
torch.Size([1109, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.3516659736633301  GigaBytes
Max Memory Allocated: 0.4206538200378418  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011883139610290527 |0.16939842700958252 |0.3655722141265869 |0.00018644332885742188 |0.1542520523071289 |0.008086681365966797 |
----------------------------------------------------------pseudo_mini_loss sum 1.9372918605804443
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12893
Number of first layer input nodes during this epoch:  9831
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.044544219970703125  GigaBytes
Max Memory Allocated: 0.4206538200378418  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006687641143798828
random selection method range initialization spend 0.00013828277587890625
time for parepare:  6.461143493652344e-05
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0001087188720703125
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  8.678436279296875e-05
----------------------check_connections_block total spend ----------------------------- 0.0009441375732421875
generate_one_block  0.0014972686767578125
generate_one_block  0.0011146068572998047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005393028259277344
gen group dst list time:  2.6226043701171875e-05
time for parepare:  0.0002453327178955078
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.000225067138671875
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0007393360137939453
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.00047326087951660156
----------------------check_connections_block total spend ----------------------------- 0.0023729801177978516
generate_one_block  0.0021529197692871094
generate_one_block  0.001687765121459961
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009832382202148438
gen group dst list time:  6.532669067382812e-05
time for parepare:  0.0006704330444335938
local_output_nid generation:  0.00017142295837402344
local_in_edges_tensor generation:  0.0004475116729736328
mini_batch_src_global generation:  0.00039315223693847656
r_  generation:  0.0043485164642333984
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.0002624988555908203
mini_batch_src_global generation:  0.000362396240234375
r_  generation:  0.0027260780334472656
----------------------check_connections_block total spend ----------------------------- 0.011474847793579102
generate_one_block  0.007092714309692383
generate_one_block  0.0045664310455322266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.044544219970703125  GigaBytes
Max Memory Allocated: 0.4206538200378418  GigaBytes

connection checking time:  0.013847827911376953
block generation total time  0.01549983024597168
average batch blocks generation time:  0.00774991512298584
block dataloader generation time/epoch 0.051470041275024414
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.04694986343383789  GigaBytes
Max Memory Allocated: 0.4206538200378418  GigaBytes
Using backend: pytorch

torch.Size([5691, 500])
torch.Size([1595, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.48776912689208984  GigaBytes
Max Memory Allocated: 0.5005397796630859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.044409751892089844  GigaBytes
Max Memory Allocated: 0.5005397796630859  GigaBytes

torch.Size([4219, 500])
torch.Size([1101, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.30841970443725586  GigaBytes
Max Memory Allocated: 0.5005397796630859  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003765106201171875 |0.0007032155990600586 |0.11860406398773193 |0.00012958049774169922 |0.15536272525787354 |0.006631135940551758 |
----------------------------------------------------------pseudo_mini_loss sum 1.9416873455047607
Total (block generation + training)time/epoch 0.6197929382324219
Training time/epoch 0.5680074691772461
Training time without block to device /epoch 0.566601037979126
Training time without total dataloading part /epoch 0.5548238754272461
load block tensor time/epoch 0.00753021240234375
block to device time/epoch 0.0014064311981201172
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  12962
Number of first layer input nodes during this epoch:  9910
