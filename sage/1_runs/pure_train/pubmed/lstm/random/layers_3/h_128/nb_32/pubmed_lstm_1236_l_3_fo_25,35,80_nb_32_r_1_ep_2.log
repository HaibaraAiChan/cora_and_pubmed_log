main start at this time 1648528733.325825
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002547740936279297
random selection method range initialization spend 0.00018453598022460938
time for parepare:  4.553794860839844e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  0.0011150836944580078
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.487701416015625e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.606910705566406e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.535385131835938e-05
mini_batch_src_global generation:  1.2159347534179688e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.392333984375e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.58306884765625e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.58306884765625e-05
mini_batch_src_global generation:  1.239776611328125e-05
r_  generation:  1.1444091796875e-05
----------------------check_connections_block total spend ----------------------------- 0.0037431716918945312
generate_one_block  0.001077413558959961
generate_one_block  0.0010077953338623047
generate_one_block  0.0010035037994384766
generate_one_block  0.0009636878967285156
generate_one_block  0.0009629726409912109
generate_one_block  0.0009794235229492188
generate_one_block  0.0009505748748779297
generate_one_block  0.0009682178497314453
generate_one_block  0.000965118408203125
generate_one_block  0.0009560585021972656
generate_one_block  0.0009415149688720703
generate_one_block  0.0009641647338867188
generate_one_block  0.00098419189453125
generate_one_block  0.0009419918060302734
generate_one_block  0.0009319782257080078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001382589340209961
gen group dst list time:  7.748603820800781e-05
time for parepare:  0.00023651123046875
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  8.988380432128906e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001456737518310547
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00020933151245117188
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00012111663818359375
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00012636184692382812
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0001785755157470703
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.298324584960938e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  5.269050598144531e-05
----------------------check_connections_block total spend ----------------------------- 0.004427194595336914
generate_one_block  0.0011034011840820312
generate_one_block  0.0010442733764648438
generate_one_block  0.0011970996856689453
generate_one_block  0.0012154579162597656
generate_one_block  0.0009539127349853516
generate_one_block  0.0011355876922607422
generate_one_block  0.0011713504791259766
generate_one_block  0.0009963512420654297
generate_one_block  0.0009589195251464844
generate_one_block  0.0010371208190917969
generate_one_block  0.0011780261993408203
generate_one_block  0.0010409355163574219
generate_one_block  0.0010073184967041016
generate_one_block  0.0010025501251220703
generate_one_block  0.0010323524475097656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00106048583984375
gen group dst list time:  0.00014162063598632812
time for parepare:  0.00070953369140625
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00027942657470703125
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0004296302795410156
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0002181529998779297
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  0.00010323524475097656
r_  generation:  0.0010235309600830078
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.0001316070556640625
r_  generation:  0.0010530948638916016
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00013303756713867188
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0006411075592041016
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0007154941558837891
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.000385284423828125
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.000118255615234375
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.000209808349609375
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  0.00011372566223144531
r_  generation:  0.001226186752319336
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.0005557537078857422
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.00039887428283691406
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0003044605255126953
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.000274658203125
----------------------check_connections_block total spend ----------------------------- 0.014149904251098633
generate_one_block  0.0015668869018554688
generate_one_block  0.0012676715850830078
generate_one_block  0.002240896224975586
generate_one_block  0.0022232532501220703
generate_one_block  0.001070261001586914
generate_one_block  0.0018610954284667969
generate_one_block  0.0017993450164794922
generate_one_block  0.0013692378997802734
generate_one_block  0.0010294914245605469
generate_one_block  0.001201629638671875
generate_one_block  0.0025594234466552734
generate_one_block  0.001546621322631836
generate_one_block  0.00139617919921875
generate_one_block  0.0015933513641357422
generate_one_block  0.0012745857238769531
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

connection checking time:  0.018577098846435547
block generation total time  0.04007458686828613
average batch blocks generation time:  0.0026716391245524087
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.010483741760253906  GigaBytes
Max Memory Allocated: 0.010483741760253906  GigaBytes

torch.Size([758, 500])
torch.Size([158, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.05589914321899414  GigaBytes
Max Memory Allocated: 0.05733203887939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.018810272216796875  GigaBytes
Max Memory Allocated: 0.06927680969238281  GigaBytes

torch.Size([370, 500])
torch.Size([117, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.036394596099853516  GigaBytes
Max Memory Allocated: 0.06927680969238281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.020843982696533203  GigaBytes
Max Memory Allocated: 0.06927680969238281  GigaBytes

torch.Size([1448, 500])
torch.Size([327, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.131805419921875  GigaBytes
Max Memory Allocated: 0.13709163665771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.021460533142089844  GigaBytes
Max Memory Allocated: 0.1389150619506836  GigaBytes

torch.Size([1780, 500])
torch.Size([442, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.12713241577148438  GigaBytes
Max Memory Allocated: 0.1389150619506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.01853179931640625  GigaBytes
Max Memory Allocated: 0.1389150619506836  GigaBytes

torch.Size([222, 500])
torch.Size([52, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.02790069580078125  GigaBytes
Max Memory Allocated: 0.1389150619506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.02051830291748047  GigaBytes
Max Memory Allocated: 0.1389150619506836  GigaBytes

torch.Size([1280, 500])
torch.Size([315, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.08802461624145508  GigaBytes
Max Memory Allocated: 0.1389150619506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.020879745483398438  GigaBytes
Max Memory Allocated: 0.1389150619506836  GigaBytes

torch.Size([1474, 500])
torch.Size([258, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.08955097198486328  GigaBytes
Max Memory Allocated: 0.1389150619506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.01953744888305664  GigaBytes
Max Memory Allocated: 0.1389150619506836  GigaBytes

torch.Size([757, 500])
torch.Size([129, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.054488182067871094  GigaBytes
Max Memory Allocated: 0.1389150619506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.018441200256347656  GigaBytes
Max Memory Allocated: 0.1389150619506836  GigaBytes

torch.Size([174, 500])
torch.Size([57, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.026833057403564453  GigaBytes
Max Memory Allocated: 0.1389150619506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.018890380859375  GigaBytes
Max Memory Allocated: 0.1389150619506836  GigaBytes

torch.Size([413, 500])
torch.Size([98, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.039881229400634766  GigaBytes
Max Memory Allocated: 0.1389150619506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.021880626678466797  GigaBytes
Max Memory Allocated: 0.1389150619506836  GigaBytes

torch.Size([1628, 500])
torch.Size([354, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.1641545295715332  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.019905567169189453  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

torch.Size([954, 500])
torch.Size([184, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.06947565078735352  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.019716262817382812  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

torch.Size([854, 500])
torch.Size([114, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.056246280670166016  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.019535541534423828  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

torch.Size([575, 500])
torch.Size([144, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.04938697814941406  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.019094467163085938  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

torch.Size([522, 500])
torch.Size([119, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.04560041427612305  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0031023502349853517 |0.023616504669189454 |0.10309874216715495 |0.00011847813924153646 |0.07988371849060058 |0.00776362419128418 |
----------------------------------------------------------pseudo_mini_loss sum 1.9154857397079468
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16434
Number of first layer input nodes during this epoch:  13209
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.037215232849121094  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005095005035400391
random selection method range initialization spend 0.000118255615234375
time for parepare:  5.91278076171875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.239776611328125e-05
----------------------check_connections_block total spend ----------------------------- 0.002774953842163086
generate_one_block  0.0011343955993652344
generate_one_block  0.0010747909545898438
generate_one_block  0.0010728836059570312
generate_one_block  0.0010404586791992188
generate_one_block  0.0010442733764648438
generate_one_block  0.001085042953491211
generate_one_block  0.0010390281677246094
generate_one_block  0.0011594295501708984
generate_one_block  0.001079559326171875
generate_one_block  0.0010426044464111328
generate_one_block  0.0010228157043457031
generate_one_block  0.0010309219360351562
generate_one_block  0.0010592937469482422
generate_one_block  0.0010521411895751953
generate_one_block  0.0010287761688232422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005671977996826172
gen group dst list time:  7.963180541992188e-05
time for parepare:  0.00027298927307128906
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00016307830810546875
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  7.677078247070312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.0001957416534423828
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0001842975616455078
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  9.775161743164062e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.57763671875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00013303756713867188
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.724761962890625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  9.250640869140625e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.220008850097656e-05
----------------------check_connections_block total spend ----------------------------- 0.00471186637878418
generate_one_block  0.0012865066528320312
generate_one_block  0.0011212825775146484
generate_one_block  0.0013461112976074219
generate_one_block  0.0012774467468261719
generate_one_block  0.0012373924255371094
generate_one_block  0.001168966293334961
generate_one_block  0.0011107921600341797
generate_one_block  0.0010447502136230469
generate_one_block  0.001169443130493164
generate_one_block  0.0010223388671875
generate_one_block  0.0010790824890136719
generate_one_block  0.0010991096496582031
generate_one_block  0.0011222362518310547
generate_one_block  0.0010869503021240234
generate_one_block  0.001012563705444336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011103153228759766
gen group dst list time:  0.00012350082397460938
time for parepare:  0.0007405281066894531
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00031447410583496094
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  0.0008459091186523438
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0005083084106445312
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.0001742839813232422
r_  generation:  0.0013196468353271484
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.0012326240539550781
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0004982948303222656
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0003349781036376953
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0003757476806640625
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00021648406982421875
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0008516311645507812
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00014448165893554688
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00033545494079589844
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0003807544708251953
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.00040531158447265625
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0006022453308105469
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00019860267639160156
----------------------check_connections_block total spend ----------------------------- 0.015491962432861328
generate_one_block  0.0023145675659179688
generate_one_block  0.0019044876098632812
generate_one_block  0.002627849578857422
generate_one_block  0.0024993419647216797
generate_one_block  0.0016531944274902344
generate_one_block  0.0014078617095947266
generate_one_block  0.0014750957489013672
generate_one_block  0.0011832714080810547
generate_one_block  0.0020935535430908203
generate_one_block  0.0011684894561767578
generate_one_block  0.0014188289642333984
generate_one_block  0.0014767646789550781
generate_one_block  0.0014917850494384766
generate_one_block  0.0017871856689453125
generate_one_block  0.002411365509033203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.037215232849121094  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

connection checking time:  0.020203828811645508
block generation total time  0.044098615646362305
average batch blocks generation time:  0.002939907709757487
block dataloader generation time/epoch 0.13383269309997559
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.03946256637573242  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

torch.Size([1470, 500])
torch.Size([389, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.11957597732543945  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.03838634490966797  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

torch.Size([1154, 500])
torch.Size([158, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.08566474914550781  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.03947877883911133  GigaBytes
Max Memory Allocated: 0.17177677154541016  GigaBytes

torch.Size([1490, 500])
torch.Size([383, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.17509078979492188  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.039232730865478516  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

torch.Size([1597, 500])
torch.Size([351, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.16047430038452148  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.038184165954589844  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

torch.Size([1046, 500])
torch.Size([148, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.0842885971069336  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.037500858306884766  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

torch.Size([639, 500])
torch.Size([146, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.06636619567871094  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.037645816802978516  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

torch.Size([642, 500])
torch.Size([121, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.07390499114990234  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.03666973114013672  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

torch.Size([238, 500])
torch.Size([74, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.04865550994873047  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.039464473724365234  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

torch.Size([1614, 500])
torch.Size([300, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.12125015258789062  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.03667736053466797  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

torch.Size([242, 500])
torch.Size([74, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.04676675796508789  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.0376439094543457  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

torch.Size([531, 500])
torch.Size([169, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.06916141510009766  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.037405967712402344  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

torch.Size([629, 500])
torch.Size([133, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.07368040084838867  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.037645816802978516  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

torch.Size([687, 500])
torch.Size([166, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.0754694938659668  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.039456844329833984  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

torch.Size([1223, 500])
torch.Size([180, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.0973658561706543  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.036864280700683594  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

torch.Size([342, 500])Using backend: pytorch

torch.Size([67, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.05228996276855469  GigaBytes
Max Memory Allocated: 0.18203449249267578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0032014369964599608 |0.0008874257405598958 |0.0727977434794108 |0.00011801719665527344 |0.08255168596903482 |0.006304264068603516 |
----------------------------------------------------------pseudo_mini_loss sum 2.059330463409424
Total (block generation + training)time/epoch 2.5597503185272217
Training time/epoch 2.4257256984710693
Training time without block to device /epoch 2.412414312362671
Training time without total dataloading part /epoch 2.338315963745117
load block tensor time/epoch 0.048021554946899414
block to device time/epoch 0.013311386108398438
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16760
Number of first layer input nodes during this epoch:  13544
