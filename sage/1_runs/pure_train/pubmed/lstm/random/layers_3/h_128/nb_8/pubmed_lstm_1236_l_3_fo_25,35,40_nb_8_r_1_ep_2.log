main start at this time 1648528646.95178
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0026636123657226562
random selection method range initialization spend 0.0001804828643798828
time for parepare:  4.482269287109375e-05
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0014510154724121094
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.147125244140625e-05
----------------------check_connections_block total spend ----------------------------- 0.0024623870849609375
generate_one_block  0.0012631416320800781
generate_one_block  0.0011053085327148438
generate_one_block  0.0010306835174560547
generate_one_block  0.0010330677032470703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0013270378112792969
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.00022840499877929688
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.00043129920959472656
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0002808570861816406
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0003070831298828125
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00020313262939453125
----------------------check_connections_block total spend ----------------------------- 0.002659320831298828
generate_one_block  0.001634836196899414
generate_one_block  0.0013880729675292969
generate_one_block  0.0013957023620605469
generate_one_block  0.0012497901916503906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00098419189453125
gen group dst list time:  6.818771362304688e-05
time for parepare:  0.0007350444793701172
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.00034999847412109375
mini_batch_src_global generation:  0.0002028942108154297
r_  generation:  0.0024497509002685547
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  0.0002162456512451172
r_  generation:  0.0014929771423339844
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.0001964569091796875
r_  generation:  0.0021207332611083984
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.0003921985626220703
mini_batch_src_global generation:  0.000148773193359375
r_  generation:  0.001219034194946289
----------------------check_connections_block total spend ----------------------------- 0.012105226516723633
generate_one_block  0.004304647445678711
generate_one_block  0.002849102020263672
generate_one_block  0.0035986900329589844
generate_one_block  0.002465963363647461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

connection checking time:  0.014764547348022461
block generation total time  0.018886804580688477
average batch blocks generation time:  0.004721701145172119
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.015599250793457031  GigaBytes
Max Memory Allocated: 0.015599250793457031  GigaBytes

torch.Size([3472, 500])
torch.Size([965, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.2688560485839844  GigaBytes
Max Memory Allocated: 0.27546262741088867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4744873046875 GB
    Memory Allocated: 0.023769855499267578  GigaBytes
Max Memory Allocated: 0.27546262741088867  GigaBytes

torch.Size([2740, 500])
torch.Size([654, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4744873046875 GB
    Memory Allocated: 0.17087125778198242  GigaBytes
Max Memory Allocated: 0.27546262741088867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4744873046875 GB
    Memory Allocated: 0.023357391357421875  GigaBytes
Max Memory Allocated: 0.27546262741088867  GigaBytes

torch.Size([2781, 500])
torch.Size([648, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.24523210525512695  GigaBytes
Max Memory Allocated: 0.27546262741088867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.022595882415771484  GigaBytes
Max Memory Allocated: 0.27546262741088867  GigaBytes

torch.Size([2264, 500])
torch.Size([498, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.13865375518798828  GigaBytes
Max Memory Allocated: 0.27546262741088867  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006140470504760742 |0.08888024091720581 |0.22616517543792725 |0.0001475214958190918 |0.12979382276535034 |0.009538888931274414 |
----------------------------------------------------------pseudo_mini_loss sum 2.1142570972442627
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14378
Number of first layer input nodes during this epoch:  11257
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.041652679443359375  GigaBytes
Max Memory Allocated: 0.27546262741088867  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005030632019042969
random selection method range initialization spend 0.00012683868408203125
time for parepare:  5.3882598876953125e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010728836059570312Using backend: pytorch

mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.218650817871094e-05
----------------------check_connections_block total spend ----------------------------- 0.001119852066040039
generate_one_block  0.0012173652648925781
generate_one_block  0.001062631607055664
generate_one_block  0.0010602474212646484
generate_one_block  0.0010437965393066406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005304813385009766
gen group dst list time:  3.337860107421875e-05
time for parepare:  0.00024247169494628906
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0005261898040771484
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0002605915069580078
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0002474784851074219
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.00022459030151367188
----------------------check_connections_block total spend ----------------------------- 0.002832651138305664
generate_one_block  0.0018467903137207031
generate_one_block  0.0013628005981445312
generate_one_block  0.0016603469848632812
generate_one_block  0.0013201236724853516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009396076202392578
gen group dst list time:  7.677078247070312e-05
time for parepare:  0.0006706714630126953
local_output_nid generation:  0.00012803077697753906
local_in_edges_tensor generation:  0.00038886070251464844
mini_batch_src_global generation:  0.00039196014404296875
r_  generation:  0.0033044815063476562
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  0.0001804828643798828
r_  generation:  0.0012621879577636719
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.000133514404296875
r_  generation:  0.0013356208801269531
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.00014853477478027344
r_  generation:  0.0015108585357666016
----------------------check_connections_block total spend ----------------------------- 0.012267351150512695
generate_one_block  0.005686283111572266
generate_one_block  0.0025653839111328125
generate_one_block  0.002682209014892578
generate_one_block  0.0028760433197021484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.041652679443359375  GigaBytes
Max Memory Allocated: 0.27546262741088867  GigaBytes

connection checking time:  0.01510000228881836
block generation total time  0.019999980926513672
average batch blocks generation time:  0.004999995231628418
block dataloader generation time/epoch 0.0649423599243164
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.04547882080078125  GigaBytes
Max Memory Allocated: 0.27546262741088867  GigaBytes

torch.Size([4431, 500])
torch.Size([1218, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.3976020812988281  GigaBytes
Max Memory Allocated: 0.40963268280029297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.0416412353515625  GigaBytes
Max Memory Allocated: 0.40963268280029297  GigaBytes

torch.Size([2405, 500])
torch.Size([462, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.16055631637573242  GigaBytes
Max Memory Allocated: 0.40963268280029297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.041611671447753906  GigaBytes
Max Memory Allocated: 0.40963268280029297  GigaBytes

torch.Size([2376, 500])
torch.Size([593, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.17104530334472656  GigaBytes
Max Memory Allocated: 0.40963268280029297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.04183673858642578  GigaBytes
Max Memory Allocated: 0.40963268280029297  GigaBytes

torch.Size([2507, 500])
torch.Size([520, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.18372344970703125  GigaBytes
Max Memory Allocated: 0.40963268280029297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004234433174133301 |0.0007717609405517578 |0.10792332887649536 |0.0001227855682373047 |0.13080519437789917 |0.008733034133911133 |
----------------------------------------------------------pseudo_mini_loss sum 1.8452908992767334
Total (block generation + training)time/epoch 1.0570049285888672
Training time/epoch 0.9918396472930908
Training time without block to device /epoch 0.9887526035308838
Training time without total dataloading part /epoch 0.9641382694244385
load block tensor time/epoch 0.016937732696533203
block to device time/epoch 0.0030870437622070312
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14869
Number of first layer input nodes during this epoch:  11719
