main start at this time 1648528770.1058125
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002077341079711914
random selection method range initialization spend 0.0001671314239501953
time for parepare:  4.9591064453125e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0013442039489746094
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.24249267578125e-05
----------------------check_connections_block total spend ----------------------------- 0.002396821975708008
generate_one_block  0.0013153553009033203
generate_one_block  0.0011692047119140625
generate_one_block  0.0010769367218017578
generate_one_block  0.0010821819305419922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012230873107910156
gen group dst list time:  4.076957702636719e-05
time for parepare:  0.0002689361572265625
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0004949569702148438
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.00032401084899902344
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00035762786865234375
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.0002243518829345703
----------------------check_connections_block total spend ----------------------------- 0.0029706954956054688
generate_one_block  0.0017483234405517578
generate_one_block  0.001466512680053711
generate_one_block  0.0015268325805664062
generate_one_block  0.0013337135314941406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010805130004882812
gen group dst list time:  7.939338684082031e-05
time for parepare:  0.0008027553558349609
local_output_nid generation:  8.034706115722656e-05
local_in_edges_tensor generation:  0.0003528594970703125
mini_batch_src_global generation:  0.0002372264862060547
r_  generation:  0.002830982208251953
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.0017795562744140625
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  0.00022864341735839844
r_  generation:  0.002315521240234375
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.00043320655822753906
mini_batch_src_global generation:  0.00017380714416503906
r_  generation:  0.001317739486694336
----------------------check_connections_block total spend ----------------------------- 0.013501405715942383
generate_one_block  0.004883527755737305
generate_one_block  0.0030956268310546875
generate_one_block  0.003743410110473633
generate_one_block  0.002481222152709961
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

connection checking time:  0.01647210121154785
block generation total time  0.0202791690826416
average batch blocks generation time:  0.0050697922706604
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.015893936157226562  GigaBytes
Max Memory Allocated: 0.015893936157226562  GigaBytes

torch.Size([3626, 500])
torch.Size([1034, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.29746532440185547  GigaBytes
Max Memory Allocated: 0.30599403381347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.024562358856201172  GigaBytes
Max Memory Allocated: 0.30599403381347656  GigaBytes

torch.Size([2956, 500])
torch.Size([709, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.18575525283813477  GigaBytes
Max Memory Allocated: 0.30599403381347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.023610591888427734  GigaBytes
Max Memory Allocated: 0.30599403381347656  GigaBytes

torch.Size([2915, 500])
torch.Size([709, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.2560577392578125  GigaBytes
Max Memory Allocated: 0.30599403381347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.022492408752441406  GigaBytes
Max Memory Allocated: 0.30599403381347656  GigaBytes

torch.Size([2332, 500])
torch.Size([525, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.14434194564819336  GigaBytes
Max Memory Allocated: 0.30599403381347656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0023194551467895508 |0.08574646711349487 |0.24454665184020996 |0.00015097856521606445 |0.1583402156829834 |0.008009910583496094 |
----------------------------------------------------------pseudo_mini_loss sum 2.1075754165649414
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15162
Number of first layer input nodes during this epoch:  11829
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.04064750671386719  GigaBytes
Max Memory Allocated: 0.30599403381347656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005142688751220703
random selection method range initialization spend 0.00011801719665527344
time for parepare:  5.7697296142578125e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00011491775512695312
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.4332275390625e-05
----------------------check_connections_block total spend ----------------------------- 0.0011899471282958984
generate_one_block  0.0012056827545166016
generate_one_block  0.0011200904846191406
generate_one_block  0.0010862350463867188
generate_one_block  0.001081705093383789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005581378936767578
gen group dst list time:  3.528594970703125e-05
time for parepare:  0.0002884864807128906
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  0.00010037422180175781
r_  generation:  0.0005955696105957031
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0002779960632324219
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0003075599670410156
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00024199485778808594
----------------------check_connections_block total spend ----------------------------- 0.0031499862670898438
generate_one_block  0.0019664764404296875
generate_one_block  0.0013890266418457031
generate_one_block  0.001832723617553711
generate_one_block  0.0013766288757324219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010178089141845703
gen group dst list time:  8.893013000488281e-05
time for parepare:  0.0008141994476318359
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.00039124488830566406
mini_batch_src_global generation:  0.00040149688720703125
r_  generation:  0.0037872791290283203
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  0.00022673606872558594
r_  generation:  0.0013377666473388672
local_output_nid generation:  6.842613220214844e-05
local_in_edges_tensor generation:  0.00021839141845703125
mini_batch_src_global generation:  0.00015306472778320312
r_  generation:  0.0016155242919921875
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.00016236305236816406
r_  generation:  0.0015285015106201172
----------------------check_connections_block total spend ----------------------------- 0.013705015182495117
generate_one_block  0.006168842315673828
generate_one_block  0.002646923065185547
generate_one_block  0.0030045509338378906
generate_one_block  0.0028972625732421875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.04064750671386719  GigaBytes
Max Memory Allocated: 0.30599403381347656  GigaBytes

connection checking time:  0.01685500144958496
block generation total time  0.021282434463500977
average batch blocks generation time:  0.005320608615875244
block dataloader generation time/epoch 0.07197117805480957
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.0451502799987793  GigaBytes
Max Memory Allocated: 0.30599403381347656  GigaBytes

torch.Size([4735, 500])
torch.Size([1308, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.4231247901916504  GigaBytes
Max Memory Allocated: 0.43631458282470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.04074859619140625  GigaBytes
Max Memory Allocated: 0.43631458282470703  GigaBytes

torch.Size([2411, 500])
torch.Size([467, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.1606135368347168  GigaBytes
Max Memory Allocated: 0.43631458282470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.04109811782836914  GigaBytes
Max Memory Allocated: 0.43631458282470703  GigaBytes

torch.Size([2594, 500])
torch.Size([694, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.1928868293762207  GigaBytes
Max Memory Allocated: 0.43631458282470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.04094266891479492  GigaBytes
Max Memory Allocated: 0.43631458282470703  GigaBytes

torch.Size([2512, 500])
torch.Size([521, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.18325519561767578  GigaBytes
Max Memory Allocated: 0.43631458282470703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0035580992698669434 |0.0010644197463989258 |0.12414383888244629 |0.00016748905181884766 |0.16079485416412354 |0.009669303894042969 |
----------------------------------------------------------pseudo_mini_loss sum 1.7863680124282837
Total (block generation + training)time/epoch 1.2495989799499512
Training time/epoch 1.1774230003356934
Training time without block to device /epoch 1.1731653213500977
Training time without total dataloading part /epoch 1.1500940322875977
load block tensor time/epoch 0.014232397079467773
block to device time/epoch 0.004257678985595703
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15599
Number of first layer input nodes during this epoch:  12252
