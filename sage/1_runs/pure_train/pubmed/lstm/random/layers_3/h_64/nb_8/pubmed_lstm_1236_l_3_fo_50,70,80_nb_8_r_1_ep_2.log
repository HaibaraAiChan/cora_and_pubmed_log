main start at this time 1648528578.6422067
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002615690231323242
random selection method range initialization spend 0.00018405914306640625
time for parepare:  4.220008850097656e-05
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0014498233795166016
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.266334533691406e-05
----------------------check_connections_block total spend ----------------------------- 0.0024347305297851562
generate_one_block  0.0011646747589111328
generate_one_block  0.0011413097381591797
generate_one_block  0.0010280609130859375
generate_one_block  0.0009751319885253906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011954307556152344
gen group dst list time:  3.814697265625e-05
time for parepare:  0.00024628639221191406
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00040793418884277344
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0003426074981689453
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0003190040588378906
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00021076202392578125
----------------------check_connections_block total spend ----------------------------- 0.002702474594116211
generate_one_block  0.0016214847564697266
generate_one_block  0.001439809799194336
generate_one_block  0.0014507770538330078
generate_one_block  0.0012714862823486328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001081705093383789
gen group dst list time:  7.104873657226562e-05
time for parepare:  0.0007374286651611328
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.00034809112548828125
mini_batch_src_global generation:  0.0002911090850830078
r_  generation:  0.0031442642211914062
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.0002238750457763672
mini_batch_src_global generation:  0.0002925395965576172
r_  generation:  0.0019457340240478516
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.00023126602172851562
r_  generation:  0.00238800048828125
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.0003859996795654297
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.0013000965118408203
----------------------check_connections_block total spend ----------------------------- 0.01439356803894043
generate_one_block  0.005452632904052734
generate_one_block  0.0033292770385742188
generate_one_block  0.004025459289550781
generate_one_block  0.0025377273559570312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

connection checking time:  0.01709604263305664
block generation total time  0.02112865447998047
average batch blocks generation time:  0.005282163619995117
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.01635885238647461  GigaBytes
Max Memory Allocated: 0.01635885238647461  GigaBytes

torch.Size([4438, 500])
torch.Size([970, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.3686037063598633  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.021816253662109375  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

torch.Size([3103, 500])
torch.Size([815, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.21353816986083984  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.02246999740600586  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

torch.Size([3446, 500])
torch.Size([823, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.2707996368408203  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.020853042602539062  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

torch.Size([2296, 500])
torch.Size([420, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.14907550811767578  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003653883934020996 |0.09469133615493774 |0.3070383071899414 |0.0001755356788635254 |0.2649487257003784 |0.008536815643310547 |
----------------------------------------------------------pseudo_mini_loss sum 1.8518574237823486
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16668
Number of first layer input nodes during this epoch:  13283
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.03777933120727539  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005106925964355469
random selection method range initialization spend 0.00011992454528808594
time for parepare:  5.221366882324219e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  5.745887756347656e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011157989501953125Using backend: pytorch

mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.00543212890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0011637210845947266
generate_one_block  0.0012578964233398438
generate_one_block  0.0010895729064941406
generate_one_block  0.0010614395141601562
generate_one_block  0.0011224746704101562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005767345428466797
gen group dst list time:  3.743171691894531e-05
time for parepare:  0.0002696514129638672
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0003790855407714844
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0003638267517089844
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00023555755615234375
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0003993511199951172
----------------------check_connections_block total spend ----------------------------- 0.003000974655151367
generate_one_block  0.0016314983367919922
generate_one_block  0.0015454292297363281
generate_one_block  0.0016841888427734375
generate_one_block  0.0015807151794433594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010585784912109375
gen group dst list time:  8.535385131835938e-05
time for parepare:  0.0007483959197998047
local_output_nid generation:  9.989738464355469e-05
local_in_edges_tensor generation:  0.0003447532653808594
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.0021033287048339844
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  0.0003218650817871094
r_  generation:  0.002404928207397461
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00021457672119140625
mini_batch_src_global generation:  0.00023245811462402344
r_  generation:  0.00193023681640625
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  0.0002605915069580078
r_  generation:  0.002722024917602539
----------------------check_connections_block total spend ----------------------------- 0.014880180358886719
generate_one_block  0.0039217472076416016
generate_one_block  0.004044055938720703
generate_one_block  0.0036573410034179688
generate_one_block  0.00462031364440918
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.03777933120727539  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

connection checking time:  0.017881155014038086
block generation total time  0.02268528938293457
average batch blocks generation time:  0.005671322345733643
block dataloader generation time/epoch 0.08614706993103027
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.03933286666870117  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

torch.Size([3445, 500])
torch.Size([849, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.2413797378540039  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.038411617279052734  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

torch.Size([2945, 500])
torch.Size([798, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.27448177337646484  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.03937530517578125  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

torch.Size([3469, 500])
torch.Size([588, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.23632049560546875  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.03949260711669922  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

torch.Size([3518, 500])
torch.Size([813, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.3232259750366211  GigaBytes
Max Memory Allocated: 0.3884906768798828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0073729753494262695 |0.0010417699813842773 |0.1977800726890564 |0.00013834238052368164 |0.2820003032684326 |0.006326913833618164 |
----------------------------------------------------------pseudo_mini_loss sum 2.032564163208008
Total (block generation + training)time/epoch 2.0558316707611084
Training time/epoch 1.9691777229309082
Training time without block to device /epoch 1.965010643005371
Training time without total dataloading part /epoch 1.926001787185669
load block tensor time/epoch 0.029491901397705078
block to device time/epoch 0.004167079925537109
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16782
Number of first layer input nodes during this epoch:  13377
