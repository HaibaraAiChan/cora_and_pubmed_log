main start at this time 1648528608.4401343
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.003126859664916992
random selection method range initialization spend 0.00020575523376464844
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0015201568603515625
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5510787963867188e-05
----------------------check_connections_block total spend ----------------------------- 0.004269838333129883
generate_one_block  0.0011572837829589844
generate_one_block  0.0009837150573730469
generate_one_block  0.0009655952453613281
generate_one_block  0.0010178089141845703
generate_one_block  0.0009694099426269531
generate_one_block  0.0009763240814208984
generate_one_block  0.0009975433349609375
generate_one_block  0.0010304450988769531
generate_one_block  0.0009691715240478516
generate_one_block  0.0009570121765136719
generate_one_block  0.0010106563568115234
generate_one_block  0.0009872913360595703
generate_one_block  0.0009570121765136719
generate_one_block  0.0009620189666748047
generate_one_block  0.0010097026824951172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018389225006103516
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.00025200843811035156
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  8.320808410644531e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002276897430419922
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00010728836059570312
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0001747608184814453
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00010800361633300781
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.606910705566406e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.91278076171875e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00023293495178222656
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.318092346191406e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.343292236328125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  8.845329284667969e-05
----------------------check_connections_block total spend ----------------------------- 0.004658699035644531
generate_one_block  0.0011286735534667969
generate_one_block  0.0012557506561279297
generate_one_block  0.0011200904846191406
generate_one_block  0.0012331008911132812
generate_one_block  0.0011222362518310547
generate_one_block  0.0010650157928466797
generate_one_block  0.001119852066040039
generate_one_block  0.001051187515258789
generate_one_block  0.0009758472442626953
generate_one_block  0.000957489013671875
generate_one_block  0.00131988525390625
generate_one_block  0.0009784698486328125
generate_one_block  0.0009553432464599609
generate_one_block  0.0010623931884765625
generate_one_block  0.0010802745819091797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001220703125
gen group dst list time:  0.00012254714965820312
time for parepare:  0.0007929801940917969
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0002617835998535156
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0006029605865478516
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  0.0001723766326904297
r_  generation:  0.0016469955444335938
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.0006058216094970703
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  0.0001239776611328125
r_  generation:  0.0012636184692382812
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0005614757537841797
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.0004930496215820312
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0003173351287841797
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0003349781036376953
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00023674964904785156
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00016450881958007812
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.0001614093780517578
r_  generation:  0.0020525455474853516
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0002491474151611328
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0003058910369873047
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00040984153747558594
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.00048232078552246094
----------------------check_connections_block total spend ----------------------------- 0.017059326171875
generate_one_block  0.0018699169158935547
generate_one_block  0.0032126903533935547
generate_one_block  0.0016427040100097656
generate_one_block  0.0026159286499023438
generate_one_block  0.0015506744384765625
generate_one_block  0.0015881061553955078
generate_one_block  0.0013036727905273438
generate_one_block  0.0014188289642333984
generate_one_block  0.001247406005859375
generate_one_block  0.0010979175567626953
generate_one_block  0.003589153289794922
generate_one_block  0.0012562274932861328
generate_one_block  0.0012929439544677734
generate_one_block  0.0016946792602539062
generate_one_block  0.0015342235565185547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

connection checking time:  0.02171802520751953
block generation total time  0.04334068298339844
average batch blocks generation time:  0.0028893788655598956
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.010161876678466797  GigaBytes
Max Memory Allocated: 0.010161876678466797  GigaBytes

torch.Size([1156, 500])
torch.Size([155, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.06921958923339844  GigaBytes
Max Memory Allocated: 0.07254600524902344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.019757747650146484  GigaBytes
Max Memory Allocated: 0.08303499221801758  GigaBytes

torch.Size([1671, 500])
torch.Size([406, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.20180511474609375  GigaBytes
Max Memory Allocated: 0.2124342918395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.01815032958984375  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

torch.Size([882, 500])
torch.Size([262, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.07222414016723633  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.021098613739013672  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

torch.Size([2728, 500])
torch.Size([402, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.15054702758789062  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.018148422241210938  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

torch.Size([908, 500])
torch.Size([243, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.06783533096313477  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.01787567138671875  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

torch.Size([1010, 500])
torch.Size([154, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.06394052505493164  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.016839027404785156  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

torch.Size([456, 500])
torch.Size([122, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.044873714447021484  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.01704120635986328  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

torch.Size([564, 500])
torch.Size([141, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.04792165756225586  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.016849040985107422  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

torch.Size([463, 500])
torch.Size([98, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.037502288818359375  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.01651763916015625  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

torch.Size([286, 500])
torch.Size([94, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.02978038787841797  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.021190166473388672  GigaBytes
Max Memory Allocated: 0.21308183670043945  GigaBytes

torch.Size([2765, 500])
torch.Size([574, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.22813892364501953  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.016697406768798828  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

torch.Size([382, 500])
torch.Size([88, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.03619956970214844  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.01702404022216797  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

torch.Size([556, 500])
torch.Size([80, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.04710578918457031  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.017266273498535156  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

torch.Size([684, 500])
torch.Size([145, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.056182861328125  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.01814746856689453  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

torch.Size([1105, 500])
torch.Size([131, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.06514549255371094  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002816311518351237 |0.02364797592163086 |0.1351776599884033 |0.0001281420389811198 |0.12723511060078938 |0.008206844329833984 |
----------------------------------------------------------pseudo_mini_loss sum 1.88760507106781
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  19068
Number of first layer input nodes during this epoch:  15616
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.034142494201660156  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005297660827636719
random selection method range initialization spend 0.00012826919555664062
time for parepare:  6.079673767089844e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  2.09808349609375e-05
----------------------check_connections_block total spend ----------------------------- 0.0027854442596435547
generate_one_block  0.0011677742004394531
generate_one_block  0.0011029243469238281
generate_one_block  0.0010716915130615234
generate_one_block  0.001033782958984375
generate_one_block  0.0010154247283935547
generate_one_block  0.0009989738464355469
generate_one_block  0.000997304916381836
generate_one_block  0.0011627674102783203
generate_one_block  0.001001596450805664
generate_one_block  0.0009944438934326172
generate_one_block  0.0009984970092773438
generate_one_block  0.001050710678100586
generate_one_block  0.0010356903076171875
generate_one_block  0.000997304916381836
generate_one_block  0.0010190010070800781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006518363952636719
gen group dst list time:  7.796287536621094e-05
time for parepare:  0.0002818107604980469
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  8.845329284667969e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00013399124145507812
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001823902130126953
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00010204315185546875
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0002257823944091797
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  8.654594421386719e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.151199340820312e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  6.318092346191406e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00021696090698242188
----------------------check_connections_block total spend ----------------------------- 0.004829883575439453
generate_one_block  0.0011780261993408203
generate_one_block  0.0011646747589111328
generate_one_block  0.0012271404266357422
generate_one_block  0.0012297630310058594
generate_one_block  0.001195669174194336
generate_one_block  0.0010826587677001953
generate_one_block  0.0010313987731933594
generate_one_block  0.0013074874877929688
generate_one_block  0.001138925552368164
generate_one_block  0.0010673999786376953
generate_one_block  0.0010349750518798828
generate_one_block  0.0010783672332763672
generate_one_block  0.0010974407196044922
generate_one_block  0.0011005401611328125
generate_one_block  0.0012819766998291016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0013434886932373047
gen group dst list time:  0.00014090538024902344
time for parepare:  0.000919342041015625
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00029277801513671875
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0002307891845703125
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.00042724609375
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  0.00011467933654785156
r_  generation:  0.0008647441864013672
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  0.00011944770812988281
r_  generation:  0.0010058879852294922
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.00037789344787597656
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0002048015594482422
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00019431114196777344
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.00017762184143066406
r_  generation:  0.001992940902709961
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  0.00011539459228515625
r_  generation:  0.0005850791931152344
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0004928112030029297
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.00027680397033691406
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.00041985511779785156
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.001527547836303711
mini_batch_src_global generation:  0.0007317066192626953
r_  generation:  0.0016570091247558594
local_output_nid generation:  0.00020241737365722656
local_in_edges_tensor generation:  0.00047659873962402344
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0005693435668945312
local_output_nid generation:  0.00026154518127441406
local_in_edges_tensor generation:  0.0012683868408203125
mini_batch_src_global generation:  0.00023031234741210938
r_  generation:  0.0019230842590332031
----------------------check_connections_block total spend ----------------------------- 0.027203798294067383
generate_one_block  0.0031402111053466797
generate_one_block  0.0024499893188476562
generate_one_block  0.0026314258575439453
generate_one_block  0.0026307106018066406
generate_one_block  0.001552581787109375
generate_one_block  0.001377105712890625
generate_one_block  0.0013561248779296875
generate_one_block  0.004265308380126953
generate_one_block  0.0018200874328613281
generate_one_block  0.001829385757446289
generate_one_block  0.001544952392578125
generate_one_block  0.0016660690307617188
generate_one_block  0.001714944839477539
generate_one_block  0.001691579818725586
generate_one_block  0.0034949779510498047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.034142494201660156  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

connection checking time:  0.032033681869506836
block generation total time  0.05038189888000488
average batch blocks generation time:  0.003358793258666992
block dataloader generation time/epoch 0.16826629638671875
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.03258943557739258  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

torch.Size([338, 500])
torch.Size([117, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.05201292037963867  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.034119606018066406  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

torch.Size([868, 500])
torch.Size([135, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.07577133178710938  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.03498506546020508  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

torch.Size([1614, 500])
torch.Size([321, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.11562824249267578  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.03501605987548828  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

torch.Size([1629, 500])
torch.Size([416, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.13083219528198242  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.0331120491027832  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

torch.Size([616, 500])
torch.Size([176, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.0663003921508789  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.032495975494384766  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

torch.Size([288, 500])
torch.Size([88, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.05140113830566406  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.03265094757080078  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

torch.Size([371, 500])
torch.Size([64, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.04992389678955078  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.03812456130981445  GigaBytes
Max Memory Allocated: 0.24028968811035156  GigaBytes

torch.Size([3280, 500])
torch.Size([503, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.2517523765563965  GigaBytes
Max Memory Allocated: 0.2639641761779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.034122467041015625  GigaBytes
Max Memory Allocated: 0.2639641761779785  GigaBytes

torch.Size([863, 500])
torch.Size([179, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08648204803466797  GigaBytes
Max Memory Allocated: 0.2639641761779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03444480895996094  GigaBytes
Max Memory Allocated: 0.2639641761779785  GigaBytes

torch.Size([834, 500])
torch.Size([144, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08403825759887695  GigaBytes
Max Memory Allocated: 0.2639641761779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.032876014709472656  GigaBytes
Max Memory Allocated: 0.2639641761779785  GigaBytes

torch.Size([491, 500])
torch.Size([81, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.05879402160644531  GigaBytes
Max Memory Allocated: 0.2639641761779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.034119606018066406  GigaBytes
Max Memory Allocated: 0.2639641761779785  GigaBytes

torch.Size([1015, 500])
torch.Size([120, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.07541513442993164  GigaBytes
Max Memory Allocated: 0.2639641761779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03444385528564453  GigaBytes
Max Memory Allocated: 0.2639641761779785  GigaBytes

torch.Size([1061, 500])
torch.Size([152, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08223915100097656  GigaBytes
Max Memory Allocated: 0.2639641761779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03412055969238281  GigaBytes
Max Memory Allocated: 0.2639641761779785  GigaBytes

torch.Size([893, 500])
torch.Size([194, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.07793092727661133  GigaBytes
Max Memory Allocated: 0.2639641761779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03537797927856445  GigaBytes
Max Memory Allocated: 0.2639641761779785  GigaBytes

torch.Size([1810, 500])
torch.Size([401, 64])Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.21530771255493164  GigaBytes
Max Memory Allocated: 0.2639641761779785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0036465803782145183 |0.000894323984781901 |0.10553210576375326 |0.00012569427490234376 |0.12665890057881674 |0.007111787796020508 |
----------------------------------------------------------pseudo_mini_loss sum 1.97989022731781
Total (block generation + training)time/epoch 3.7556779384613037
Training time/epoch 3.5871806144714355
Training time without block to device /epoch 3.573765754699707
Training time without total dataloading part /epoch 3.4918622970581055
load block tensor time/epoch 0.05469870567321777
block to device time/epoch 0.013414859771728516
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  19419
Number of first layer input nodes during this epoch:  15971
