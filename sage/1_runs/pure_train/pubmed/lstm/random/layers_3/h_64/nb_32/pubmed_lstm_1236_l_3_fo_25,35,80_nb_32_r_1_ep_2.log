main start at this time 1648528478.6301897
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0026366710662841797
random selection method range initialization spend 0.0001819133758544922
time for parepare:  4.410743713378906e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0016891956329345703
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.821487426757812e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.821487426757812e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.821487426757812e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.702278137207031e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.630752563476562e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.3603439331054688e-05
----------------------check_connections_block total spend ----------------------------- 0.0043714046478271484
generate_one_block  0.001215219497680664
generate_one_block  0.0010094642639160156
generate_one_block  0.0009417533874511719
generate_one_block  0.0009534358978271484
generate_one_block  0.0009758472442626953
generate_one_block  0.0009779930114746094
generate_one_block  0.0009334087371826172
generate_one_block  0.0009732246398925781
generate_one_block  0.0009851455688476562
generate_one_block  0.0009529590606689453
generate_one_block  0.0009481906890869141
generate_one_block  0.0009400844573974609
generate_one_block  0.000978231430053711
generate_one_block  0.0009377002716064453
generate_one_block  0.0009539127349853516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001348257064819336
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.0002257823944091797
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  7.82012939453125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00016880035400390625
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  9.226799011230469e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0001513957977294922
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0001010894775390625
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  8.225440979003906e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  1.430511474609375e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00021719932556152344
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  9.012222290039062e-05
----------------------check_connections_block total spend ----------------------------- 0.0043904781341552734
generate_one_block  0.0010731220245361328
generate_one_block  0.0011680126190185547
generate_one_block  0.0011167526245117188
generate_one_block  0.0011677742004394531
generate_one_block  0.0010759830474853516
generate_one_block  0.001079559326171875
generate_one_block  0.0010728836059570312
generate_one_block  0.0009908676147460938
generate_one_block  0.0009906291961669922
generate_one_block  0.000985860824584961
generate_one_block  0.0012307167053222656
generate_one_block  0.0009887218475341797
generate_one_block  0.0009789466857910156
generate_one_block  0.0010175704956054688
generate_one_block  0.0010783672332763672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011522769927978516
gen group dst list time:  0.00011444091796875
time for parepare:  0.0007002353668212891
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0002703666687011719
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004825592041015625
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.0011644363403320312
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0005168914794921875
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0009648799896240234
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0004885196685791016
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004253387451171875
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0003104209899902344
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0002663135528564453
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0002117156982421875
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001430511474609375
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.00012969970703125
r_  generation:  0.0014126300811767578
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.000263214111328125
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00026726722717285156
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00035881996154785156
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0003991127014160156
----------------------check_connections_block total spend ----------------------------- 0.014092206954956055
generate_one_block  0.002521514892578125
generate_one_block  0.002542734146118164
generate_one_block  0.0015308856964111328
generate_one_block  0.0022623538970947266
generate_one_block  0.0015316009521484375
generate_one_block  0.0015544891357421875
generate_one_block  0.0012683868408203125
generate_one_block  0.0012502670288085938
generate_one_block  0.0011682510375976562
generate_one_block  0.0011050701141357422
generate_one_block  0.0028002262115478516
generate_one_block  0.0012025833129882812
generate_one_block  0.0012505054473876953
generate_one_block  0.001664876937866211
generate_one_block  0.0014615058898925781
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

connection checking time:  0.018482685089111328
block generation total time  0.041131019592285156
average batch blocks generation time:  0.0027420679728190106
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009874820709228516  GigaBytes
Max Memory Allocated: 0.009874820709228516  GigaBytes

torch.Size([1003, 500])
torch.Size([155, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.05968141555786133  GigaBytes
Max Memory Allocated: 0.06270933151245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01912069320678711  GigaBytes
Max Memory Allocated: 0.07277059555053711  GigaBytes

torch.Size([1372, 500])
torch.Size([344, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.1523904800415039  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.01840829849243164  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

torch.Size([766, 500])
torch.Size([234, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.06292295455932617  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.02045583724975586  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

torch.Size([2094, 500])
torch.Size([366, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.12092924118041992  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.01840829849243164  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

torch.Size([839, 500])
torch.Size([243, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.06401491165161133  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.018754005432128906  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

torch.Size([922, 500])
torch.Size([154, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.06101226806640625  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.017333507537841797  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

torch.Size([429, 500])
torch.Size([122, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.04378843307495117  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.017412662506103516  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

torch.Size([472, 500])
torch.Size([116, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.041402339935302734  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.017224788665771484  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

torch.Size([372, 500])
torch.Size([98, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.03427314758300781  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.01702260971069336  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

torch.Size([264, 500])
torch.Size([93, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.02915191650390625  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.02084827423095703  GigaBytes
Max Memory Allocated: 0.16272258758544922  GigaBytes

torch.Size([2297, 500])
torch.Size([513, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.17008304595947266  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.017224788665771484  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

torch.Size([372, 500])
torch.Size([88, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.03609037399291992  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.0174407958984375  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

torch.Size([487, 500])
torch.Size([80, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.042632102966308594  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.018405437469482422  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

torch.Size([635, 500])
torch.Size([139, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.05379056930541992  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.0187530517578125  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

torch.Size([939, 500])
torch.Size([131, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.058725833892822266  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0031191507975260415 |0.025535122553507487 |0.12129465738932292 |0.00014222462972005208 |0.07692062060038249 |0.012614250183105469 |
----------------------------------------------------------pseudo_mini_loss sum 1.9036095142364502
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16496
Number of first layer input nodes during this epoch:  13263
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.03474617004394531  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006136894226074219
random selection method range initialization spend 0.00014853477478027344
time for parepare:  6.270408630371094e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.288818359375e-05
----------------------check_connections_block total spend ----------------------------- 0.0033223628997802734
generate_one_block  0.001283884048461914
generate_one_block  0.0011959075927734375
generate_one_block  0.0011730194091796875
generate_one_block  0.0011568069458007812
generate_one_block  0.0011832714080810547
generate_one_block  0.0011594295501708984
generate_one_block  0.0011377334594726562
generate_one_block  0.001310110092163086
generate_one_block  0.0011553764343261719
generate_one_block  0.0011432170867919922
generate_one_block  0.0011532306671142578
generate_one_block  0.0011451244354248047
generate_one_block  0.0011303424835205078
generate_one_block  0.001096963882446289
generate_one_block  0.001100778579711914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007143020629882812
gen group dst list time:  8.463859558105469e-05
time for parepare:  0.0002627372741699219
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  9.703636169433594e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001392364501953125
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0001659393310546875
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  8.416175842285156e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00019788742065429688
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  5.2928924560546875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  8.702278137207031e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0002079010009765625
----------------------check_connections_block total spend ----------------------------- 0.005181312561035156
generate_one_block  0.001268625259399414
generate_one_block  0.0012507438659667969
generate_one_block  0.0013251304626464844
generate_one_block  0.0013589859008789062
generate_one_block  0.0013148784637451172
generate_one_block  0.0012125968933105469
generate_one_block  0.0011849403381347656
generate_one_block  0.0013942718505859375
generate_one_block  0.0022470951080322266
generate_one_block  0.0011975765228271484
generate_one_block  0.0011429786682128906
generate_one_block  0.0011849403381347656
generate_one_block  0.0012054443359375
generate_one_block  0.0012035369873046875
generate_one_block  0.0013785362243652344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012507438659667969
gen group dst list time:  0.00013756752014160156
time for parepare:  0.0008220672607421875
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00029587745666503906
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00022482872009277344
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.00040841102600097656
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  0.00010561943054199219
r_  generation:  0.0007791519165039062
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0008106231689453125
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0003604888916015625
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00021195411682128906
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00017786026000976562
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.001466512680053711
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  9.918212890625e-05
r_  generation:  0.00045108795166015625
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0003147125244140625
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0002472400665283203
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0003857612609863281
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.00046634674072265625
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0004494190216064453
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  0.0001380443572998047
r_  generation:  0.0013797283172607422
----------------------check_connections_block total spend ----------------------------- 0.01624917984008789
generate_one_block  0.001482248306274414
generate_one_block  0.0017986297607421875
generate_one_block  0.0020952224731445312
generate_one_block  0.0021474361419677734
generate_one_block  0.0015459060668945312
generate_one_block  0.0013585090637207031
generate_one_block  0.0013189315795898438
generate_one_block  0.003129243850708008
generate_one_block  0.001657247543334961
generate_one_block  0.0015294551849365234
generate_one_block  0.0014047622680664062
generate_one_block  0.001600503921508789
generate_one_block  0.0016963481903076172
generate_one_block  0.0016644001007080078
generate_one_block  0.0029480457305908203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.03474617004394531  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

connection checking time:  0.021430492401123047
block generation total time  0.04724717140197754
average batch blocks generation time:  0.0031498114267985025
block dataloader generation time/epoch 0.13975858688354492
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.03312206268310547  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

torch.Size([331, 500])
torch.Size([117, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.051795005798339844  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.03437948226928711  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

torch.Size([795, 500])
torch.Size([135, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.07157468795776367  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.03516578674316406  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

torch.Size([1420, 500])
torch.Size([297, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.10632181167602539  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.03514385223388672  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

torch.Size([1407, 500])
torch.Size([367, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.11105680465698242  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.0343775749206543  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

torch.Size([570, 500])
torch.Size([175, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.06473255157470703  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.033032894134521484  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

torch.Size([283, 500])
torch.Size([88, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.05153799057006836  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.033113956451416016  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

torch.Size([327, 500])
torch.Size([64, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.048456668853759766  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.03717184066772461  GigaBytes
Max Memory Allocated: 0.17954540252685547  GigaBytes

torch.Size([2458, 500])
torch.Size([440, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.18590211868286133  GigaBytes
Max Memory Allocated: 0.1954970359802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.034380435943603516  GigaBytes
Max Memory Allocated: 0.1954970359802246  GigaBytes

torch.Size([709, 500])
torch.Size([152, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.07403373718261719  GigaBytes
Max Memory Allocated: 0.1954970359802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03358316421508789  GigaBytes
Max Memory Allocated: 0.1954970359802246  GigaBytes

torch.Size([577, 500])
torch.Size([109, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.062236785888671875  GigaBytes
Max Memory Allocated: 0.1954970359802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03328514099121094  GigaBytes
Max Memory Allocated: 0.1954970359802246  GigaBytes

torch.Size([418, 500])
torch.Size([81, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.054819583892822266  GigaBytes
Max Memory Allocated: 0.1954970359802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03437948226928711  GigaBytes
Max Memory Allocated: 0.1954970359802246  GigaBytes

torch.Size([863, 500])
torch.Size([120, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.0692296028137207  GigaBytes
Max Memory Allocated: 0.1954970359802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.034728050231933594  GigaBytes
Max Memory Allocated: 0.1954970359802246  GigaBytes

torch.Size([933, 500])
torch.Size([152, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.07714509963989258  GigaBytes
Max Memory Allocated: 0.1954970359802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.034380435943603516  GigaBytes
Max Memory Allocated: 0.1954970359802246  GigaBytes

torch.Size([801, 500])
torch.Size([193, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.07380390167236328  GigaBytes
Max Memory Allocated: 0.1954970359802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03557538986206055  GigaBytes
Max Memory Allocated: 0.1954970359802246  GigaBytes

torch.Size([1628, 500])
torch.Size([380, 64])Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.1794905662536621  GigaBytes
Max Memory Allocated: 0.1954970359802246  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002888282140096029 |0.0008962154388427734 |0.09114751815795899 |0.00013519922892252605 |0.07870273590087891 |0.011121988296508789 |
----------------------------------------------------------pseudo_mini_loss sum 1.972414255142212
Total (block generation + training)time/epoch 2.7840399742126465
Training time/epoch 2.643989324569702
Training time without block to device /epoch 2.6305460929870605
Training time without total dataloading part /epoch 2.560903787612915
load block tensor time/epoch 0.04332423210144043
block to device time/epoch 0.013443231582641602
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16747
Number of first layer input nodes during this epoch:  13520
