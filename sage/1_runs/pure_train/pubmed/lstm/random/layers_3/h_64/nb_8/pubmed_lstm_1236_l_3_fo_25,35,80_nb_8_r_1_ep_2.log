main start at this time 1648528453.4270535
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001622915267944336
random selection method range initialization spend 0.0002071857452392578
time for parepare:  4.1961669921875e-05
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.0011103153228759766
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.218650817871094e-05
----------------------check_connections_block total spend ----------------------------- 0.0020639896392822266
generate_one_block  0.0012173652648925781
generate_one_block  0.0011031627655029297
generate_one_block  0.0009915828704833984
generate_one_block  0.0009884834289550781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008823871612548828
gen group dst list time:  3.24249267578125e-05
time for parepare:  0.0002357959747314453
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0003459453582763672
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0003368854522705078
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00030541419982910156
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00020647048950195312
----------------------check_connections_block total spend ----------------------------- 0.0025784969329833984
generate_one_block  0.0015468597412109375
generate_one_block  0.0013887882232666016
generate_one_block  0.0014064311981201172
generate_one_block  0.0012538433074951172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009949207305908203
gen group dst list time:  7.152557373046875e-05
time for parepare:  0.0007483959197998047
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.0003273487091064453
mini_batch_src_global generation:  0.0002307891845703125
r_  generation:  0.002343893051147461
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  0.0002498626708984375
r_  generation:  0.0017845630645751953
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  0.00020122528076171875
r_  generation:  0.0018961429595947266
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00039076805114746094
mini_batch_src_global generation:  0.00014019012451171875
r_  generation:  0.0010972023010253906
----------------------check_connections_block total spend ----------------------------- 0.012016057968139648
generate_one_block  0.005141019821166992
generate_one_block  0.0032072067260742188
generate_one_block  0.0034368038177490234
generate_one_block  0.0023767948150634766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

connection checking time:  0.014594554901123047
block generation total time  0.019757747650146484
average batch blocks generation time:  0.004939436912536621
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014674663543701172  GigaBytes
Max Memory Allocated: 0.014674663543701172  GigaBytes

torch.Size([3548, 500])
torch.Size([837, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.2718815803527832  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.021332740783691406  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

torch.Size([2846, 500])
torch.Size([789, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.1937103271484375  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.021629810333251953  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

torch.Size([3003, 500])
torch.Size([761, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.2131352424621582  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.019859790802001953  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

torch.Size([2065, 500])
torch.Size([414, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.13275861740112305  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002620518207550049 |0.08667749166488647 |0.23066943883895874 |0.0001506805419921875 |0.12533575296401978 |0.008351802825927734 |
----------------------------------------------------------pseudo_mini_loss sum 1.8567060232162476
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14620
Number of first layer input nodes during this epoch:  11462
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.03666114807128906  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004863739013671875
random selection method range initialization spend 0.00011229515075683594
time for parepare:  5.53131103515625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00010800361633300781
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.886222839355469e-05
----------------------check_connections_block total spend ----------------------------- 0.001123189926147461
generate_one_block  0.0011668205261230469
generate_one_block  0.001068115234375
generate_one_block  0.0010447502136230469
generate_one_block  0.0010266304016113281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005292892456054688
gen group dst list time:  3.62396240234375e-05
time for parepare:  0.00023317337036132812
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.00037169456481933594
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00033473968505859375
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0001900196075439453
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00036263465881347656
----------------------check_connections_block total spend ----------------------------- 0.0027582645416259766
generate_one_block  0.0014770030975341797
generate_one_block  0.0014858245849609375
generate_one_block  0.001581430435180664
generate_one_block  0.0015270709991455078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00095367431640625
gen group dst list time:  7.605552673339844e-05
time for parepare:  0.0006556510925292969
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.0003066062927246094
mini_batch_src_global generation:  0.0001685619354248047
r_  generation:  0.001837015151977539
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  0.0002467632293701172
r_  generation:  0.0018274784088134766
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0013301372528076172
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  0.00020241737365722656
r_  generation:  0.0023453235626220703
----------------------check_connections_block total spend ----------------------------- 0.011940956115722656
generate_one_block  0.003520488739013672
generate_one_block  0.003518819808959961
generate_one_block  0.0029060840606689453
generate_one_block  0.00405120849609375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.03666114807128906  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

connection checking time:  0.014699220657348633
block generation total time  0.020067930221557617
average batch blocks generation time:  0.005016982555389404
block dataloader generation time/epoch 0.06544137001037598
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.03860330581665039  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

torch.Size([3122, 500])
torch.Size([800, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.21371841430664062  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.037686824798583984  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

torch.Size([2628, 500])
torch.Size([738, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.22591543197631836  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.038591861724853516  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

torch.Size([2598, 500])
torch.Size([492, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.1745133399963379  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.0387415885925293  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

torch.Size([3187, 500])
torch.Size([787, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2730679512023926  GigaBytes
Max Memory Allocated: 0.28800344467163086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004269659519195557 |0.0008129477500915527 |0.11228811740875244 |0.0001246929168701172 |0.13035595417022705 |0.006668567657470703 |
----------------------------------------------------------pseudo_mini_loss sum 1.9645342826843262
Total (block generation + training)time/epoch 1.0715405941009521
Training time/epoch 1.0057647228240967
Training time without block to device /epoch 1.0025129318237305
Training time without total dataloading part /epoch 0.9777436256408691
load block tensor time/epoch 0.017078638076782227
block to device time/epoch 0.003251791000366211
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14709
Number of first layer input nodes during this epoch:  11535
