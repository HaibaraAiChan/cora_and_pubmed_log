main start at this time 1648528383.018182
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.003187417984008789
random selection method range initialization spend 0.00019669532775878906
time for parepare:  4.267692565917969e-05
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0011513233184814453
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  5.841255187988281e-05
----------------------check_connections_block total spend ----------------------------- 0.0017948150634765625
generate_one_block  0.0012269020080566406
generate_one_block  0.0010874271392822266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0013353824615478516
gen group dst list time:  2.47955322265625e-05
time for parepare:  0.00021958351135253906
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.0007183551788330078
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0005376338958740234
----------------------check_connections_block total spend ----------------------------- 0.0023910999298095703
generate_one_block  0.0019404888153076172
generate_one_block  0.0015714168548583984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001007080078125
gen group dst list time:  5.745887756347656e-05
time for parepare:  0.0006809234619140625
local_output_nid generation:  0.00010538101196289062
local_in_edges_tensor generation:  0.00042748451232910156
mini_batch_src_global generation:  0.0002923011779785156
r_  generation:  0.004051685333251953
local_output_nid generation:  8.153915405273438e-05
local_in_edges_tensor generation:  0.0002818107604980469
mini_batch_src_global generation:  0.0003895759582519531
r_  generation:  0.0027985572814941406
----------------------check_connections_block total spend ----------------------------- 0.011020660400390625
generate_one_block  0.006423234939575195
generate_one_block  0.004567861557006836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

connection checking time:  0.013411760330200195
block generation total time  0.014503002166748047
average batch blocks generation time:  0.0072515010833740234
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.01848459243774414  GigaBytes
Max Memory Allocated: 0.01848459243774414  GigaBytes

torch.Size([5568, 500])
torch.Size([1592, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6580810546875 GB
    Memory Allocated: 0.43515634536743164  GigaBytes
Max Memory Allocated: 0.45682621002197266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6580810546875 GB
    Memory Allocated: 0.024054527282714844  GigaBytes
Max Memory Allocated: 0.45682621002197266  GigaBytes

torch.Size([4289, 500])
torch.Size([1119, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6580810546875 GB
    Memory Allocated: 0.3122868537902832  GigaBytes
Max Memory Allocated: 0.45682621002197266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008620500564575195 |0.1676008701324463 |0.36199092864990234 |0.0001685619354248047 |0.18889117240905762 |0.008030176162719727 |
----------------------------------------------------------pseudo_mini_loss sum 1.7488882541656494
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12924
Number of first layer input nodes during this epoch:  9857
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6580810546875 GB
    Memory Allocated: 0.041043758392333984  GigaBytes
Max Memory Allocated: 0.45682621002197266  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006687641143798828
random selection method range initialization spend 0.00013327598571777344
time for parepare:  6.556510925292969e-05
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0002491474151611328
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  9.131431579589844e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.3882598876953125e-05
----------------------check_connections_block total spend ----------------------------- 0.0008261203765869141
generate_one_block  0.0012898445129394531
generate_one_block  0.001116037368774414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005397796630859375
gen group dst list time:  2.5987625122070312e-05
time for parepare:  0.00025343894958496094
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0006668567657470703
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0005695819854736328
----------------------check_connections_block total spend ----------------------------- 0.002426624298095703
generate_one_block  0.002055644989013672
generate_one_block  0.001852273941040039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009603500366210938
gen group dst list time:  6.556510925292969e-05
time for parepare:  0.0006191730499267578
local_output_nid generation:  0.00012755393981933594
local_in_edges_tensor generation:  0.0004115104675292969
mini_batch_src_global generation:  0.0002682209014892578
r_  generation:  0.0034186840057373047
local_output_nid generation:  0.00011086463928222656
local_in_edges_tensor generation:  0.00026917457580566406
mini_batch_src_global generation:  0.00047397613525390625
r_  generation:  0.0033185482025146484
----------------------check_connections_block total spend ----------------------------- 0.011039495468139648
generate_one_block  0.005882740020751953
generate_one_block  0.005678653717041016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6580810546875 GB
    Memory Allocated: 0.041043758392333984  GigaBytes
Max Memory Allocated: 0.45682621002197266  GigaBytes

connection checking time:  0.013466119766235352
block generation total time  0.01546931266784668
average batch blocks generation time:  0.00773465633392334
block dataloader generation time/epoch 0.05042624473571777
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6580810546875 GB
    Memory Allocated: 0.042675018310546875  GigaBytes
Max Memory Allocated: 0.45682621002197266  GigaBytes
Using backend: pytorch

torch.Size([5216, 500])
torch.Size([1502, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6580810546875 GB
    Memory Allocated: 0.39173460006713867  GigaBytes
Max Memory Allocated: 0.45682621002197266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6580810546875 GB
    Memory Allocated: 0.04178953170776367  GigaBytes
Max Memory Allocated: 0.45682621002197266  GigaBytes

torch.Size([4740, 500])
torch.Size([1246, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6580810546875 GB
    Memory Allocated: 0.398587703704834  GigaBytes
Max Memory Allocated: 0.45682621002197266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003575563430786133 |0.0006947517395019531 |0.12067091464996338 |0.0001289844512939453 |0.1948540210723877 |0.006373882293701172 |
----------------------------------------------------------pseudo_mini_loss sum 1.8142352104187012
Total (block generation + training)time/epoch 0.7010087966918945
Training time/epoch 0.6503939628601074
Training time without block to device /epoch 0.6490044593811035
Training time without total dataloading part /epoch 0.6376817226409912
load block tensor time/epoch 0.007151126861572266
block to device time/epoch 0.0013895034790039062
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13061
Number of first layer input nodes during this epoch:  9956
