main start at this time 1648528514.6413317
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0030510425567626953
random selection method range initialization spend 0.00018644332885742188
time for parepare:  4.57763671875e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0010764598846435547
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.409385681152344e-05
----------------------check_connections_block total spend ----------------------------- 0.002076387405395508
generate_one_block  0.001215219497680664
generate_one_block  0.001134634017944336
generate_one_block  0.0010600090026855469
generate_one_block  0.0010457038879394531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0014164447784423828
gen group dst list time:  3.4332275390625e-05
time for parepare:  0.000240325927734375
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0004215240478515625
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0003752708435058594
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0003457069396972656
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00022602081298828125
----------------------check_connections_block total spend ----------------------------- 0.0028543472290039062
generate_one_block  0.0016360282897949219
generate_one_block  0.001512765884399414
generate_one_block  0.0014774799346923828
generate_one_block  0.0012774467468261719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010874271392822266
gen group dst list time:  7.486343383789062e-05
time for parepare:  0.0007870197296142578
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.00035762786865234375
mini_batch_src_global generation:  0.00024366378784179688
r_  generation:  0.0029332637786865234
local_output_nid generation:  6.771087646484375e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  0.00026702880859375
r_  generation:  0.0019123554229736328
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.0002276897430419922
mini_batch_src_global generation:  0.0002124309539794922
r_  generation:  0.002164125442504883
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.0003948211669921875
mini_batch_src_global generation:  0.0001513957977294922
r_  generation:  0.0011951923370361328
----------------------check_connections_block total spend ----------------------------- 0.013552665710449219
generate_one_block  0.004962444305419922
generate_one_block  0.0031387805938720703
generate_one_block  0.003570556640625
generate_one_block  0.0024509429931640625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

connection checking time:  0.016407012939453125
block generation total time  0.020026445388793945
average batch blocks generation time:  0.005006611347198486
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.015625  GigaBytes
Max Memory Allocated: 0.015625  GigaBytes

torch.Size([4052, 500])
torch.Size([973, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.31531476974487305  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.022170066833496094  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

torch.Size([2862, 500])
torch.Size([815, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.19820404052734375  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.02359771728515625  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

torch.Size([3134, 500])
torch.Size([823, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5350341796875 GB
    Memory Allocated: 0.23300457000732422  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5369873046875 GB
    Memory Allocated: 0.02069091796875  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

torch.Size([2078, 500])
torch.Size([420, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5369873046875 GB
    Memory Allocated: 0.1339421272277832  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003616929054260254 |0.08633893728256226 |0.2558836340904236 |0.00019162893295288086 |0.15881961584091187 |0.008230209350585938 |
----------------------------------------------------------pseudo_mini_loss sum 1.8452723026275635
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15514
Number of first layer input nodes during this epoch:  12126
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5369873046875 GB
    Memory Allocated: 0.036806583404541016  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004968643188476562
random selection method range initialization spend 0.00011277198791503906
time for parepare:  5.698204040527344e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation: Using backend: pytorch
 2.0742416381835938e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.076957702636719e-05
----------------------check_connections_block total spend ----------------------------- 0.0011687278747558594
generate_one_block  0.001191854476928711
generate_one_block  0.0010516643524169922
generate_one_block  0.001032114028930664
generate_one_block  0.0010831356048583984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005524158477783203
gen group dst list time:  3.62396240234375e-05
time for parepare:  0.00028014183044433594
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.00038433074951171875
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0003619194030761719
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0002486705780029297
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.00040531158447265625
----------------------check_connections_block total spend ----------------------------- 0.003007173538208008
generate_one_block  0.001600027084350586
generate_one_block  0.0015349388122558594
generate_one_block  0.0013399124145507812
generate_one_block  0.001895904541015625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010058879852294922
gen group dst list time:  8.130073547363281e-05
time for parepare:  0.0007090568542480469
local_output_nid generation:  9.393692016601562e-05
local_in_edges_tensor generation:  0.0003304481506347656
mini_batch_src_global generation:  0.00016689300537109375
r_  generation:  0.0019576549530029297
local_output_nid generation:  7.414817810058594e-05
local_in_edges_tensor generation:  0.00023126602172851562
mini_batch_src_global generation:  0.0002963542938232422
r_  generation:  0.0020782947540283203
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.0001900196075439453
r_  generation:  0.0017268657684326172
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  0.00022649765014648438
r_  generation:  0.0024623870849609375
----------------------check_connections_block total spend ----------------------------- 0.01352834701538086
generate_one_block  0.0037093162536621094
generate_one_block  0.0036551952362060547
generate_one_block  0.0032227039337158203
generate_one_block  0.005465269088745117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5369873046875 GB
    Memory Allocated: 0.036806583404541016  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

connection checking time:  0.016535520553588867
block generation total time  0.022423267364501953
average batch blocks generation time:  0.005605816841125488
block dataloader generation time/epoch 0.07408452033996582
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5369873046875 GB
    Memory Allocated: 0.03889274597167969  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

torch.Size([3212, 500])
torch.Size([849, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5369873046875 GB
    Memory Allocated: 0.2208385467529297  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5369873046875 GB
    Memory Allocated: 0.03805208206176758  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

torch.Size([2756, 500])
torch.Size([798, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2440814971923828  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03888893127441406  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

torch.Size([3072, 500])
torch.Size([587, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.20594406127929688  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.038938045501708984  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

torch.Size([3226, 500])
torch.Size([813, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.28208112716674805  GigaBytes
Max Memory Allocated: 0.3344297409057617  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003743469715118408 |0.000937342643737793 |0.12584799528121948 |0.00012987852096557617 |0.1620030403137207 |0.0066225528717041016 |
----------------------------------------------------------pseudo_mini_loss sum 1.986933708190918
Total (block generation + training)time/epoch 1.2598247528076172
Training time/epoch 1.1854851245880127
Training time without block to device /epoch 1.1817357540130615
Training time without total dataloading part /epoch 1.1585462093353271
load block tensor time/epoch 0.014973878860473633
block to device time/epoch 0.003749370574951172
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15670
Number of first layer input nodes during this epoch:  12266
