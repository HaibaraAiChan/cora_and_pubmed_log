main start at this time 1648532528.7730188
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0023262500762939453
random selection method range initialization spend 0.00020456314086914062
time for parepare:  5.0067901611328125e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0019376277923583984
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5033950805664062e-05
----------------------check_connections_block total spend ----------------------------- 0.004869937896728516
generate_one_block  0.0012578964233398438
generate_one_block  0.0011241436004638672
generate_one_block  0.0010936260223388672
generate_one_block  0.0011012554168701172
generate_one_block  0.0011489391326904297
generate_one_block  0.0010962486267089844
generate_one_block  0.0009915828704833984
generate_one_block  0.0009307861328125
generate_one_block  0.0009472370147705078
generate_one_block  0.0009241104125976562
generate_one_block  0.0009303092956542969
generate_one_block  0.0009250640869140625
generate_one_block  0.0009648799896240234
generate_one_block  0.0009357929229736328
generate_one_block  0.0009417533874511719
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0016102790832519531
gen group dst list time:  0.00010132789611816406
time for parepare:  0.0003139972686767578
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  5.602836608886719e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  8.082389831542969e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00019288063049316406
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00026869773864746094
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00012755393981933594
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00010943412780761719
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.745887756347656e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.1975250244140625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  0.00010180473327636719
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00021910667419433594
----------------------check_connections_block total spend ----------------------------- 0.004954099655151367
generate_one_block  0.0011649131774902344
generate_one_block  0.0012292861938476562
generate_one_block  0.0011124610900878906
generate_one_block  0.0012543201446533203
generate_one_block  0.0013966560363769531
generate_one_block  0.0011496543884277344
generate_one_block  0.0012485980987548828
generate_one_block  0.0010814666748046875
generate_one_block  0.0011091232299804688
generate_one_block  0.0009832382202148438
generate_one_block  0.0009815692901611328
generate_one_block  0.0010247230529785156
generate_one_block  0.00095367431640625
generate_one_block  0.0010275840759277344
generate_one_block  0.0011925697326660156
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011560916900634766
gen group dst list time:  0.00014495849609375
time for parepare:  0.0008687973022460938
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0002644062042236328
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0002715587615966797
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0003635883331298828
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  8.225440979003906e-05
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0005886554718017578
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.0001518726348876953
r_  generation:  0.0014095306396484375
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  7.581710815429688e-05
r_  generation:  0.0003514289855957031
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  0.00018858909606933594
r_  generation:  0.0020542144775390625
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.0007815361022949219
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0005910396575927734
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.00046515464782714844
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0004119873046875
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0002899169921875
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00033926963806152344
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.0014126300811767578
----------------------check_connections_block total spend ----------------------------- 0.017235517501831055
generate_one_block  0.0012853145599365234
generate_one_block  0.0013036727905273438
generate_one_block  0.0010685920715332031
generate_one_block  0.0016067028045654297
generate_one_block  0.0025436878204345703
generate_one_block  0.0012669563293457031
generate_one_block  0.003220081329345703
generate_one_block  0.0016982555389404297
generate_one_block  0.0015408992767333984
generate_one_block  0.001428842544555664
generate_one_block  0.0017108917236328125
generate_one_block  0.0013089179992675781
generate_one_block  0.0010199546813964844
generate_one_block  0.0013265609741210938
generate_one_block  0.0027396678924560547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023424625396728516
gen group dst list time:  0.0003733634948730469
time for parepare:  0.0018017292022705078
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.0005431175231933594
mini_batch_src_global generation:  0.00028586387634277344
r_  generation:  0.0020906925201416016
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.00024318695068359375
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.001453399658203125
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  7.390975952148438e-05
r_  generation:  0.0003802776336669922
local_output_nid generation:  0.00012922286987304688
local_in_edges_tensor generation:  0.0003540515899658203
mini_batch_src_global generation:  0.00038909912109375
r_  generation:  0.004141330718994141
local_output_nid generation:  0.00019693374633789062
local_in_edges_tensor generation:  0.00047135353088378906
mini_batch_src_global generation:  0.0007379055023193359
r_  generation:  0.0059909820556640625
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.00026297569274902344
r_  generation:  0.0016417503356933594
local_output_nid generation:  0.00019431114196777344
local_in_edges_tensor generation:  0.00044655799865722656
mini_batch_src_global generation:  0.0006632804870605469
r_  generation:  0.007604360580444336
local_output_nid generation:  8.96453857421875e-05
local_in_edges_tensor generation:  0.00026345252990722656
mini_batch_src_global generation:  0.0005023479461669922
r_  generation:  0.0035772323608398438
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.0002262592315673828
mini_batch_src_global generation:  0.0002658367156982422
r_  generation:  0.0023772716522216797
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.00021839141845703125
mini_batch_src_global generation:  0.0002593994140625
r_  generation:  0.002495288848876953
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.00023627281188964844
mini_batch_src_global generation:  0.00030303001403808594
r_  generation:  0.0029675960540771484
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.0002598762512207031
r_  generation:  0.0022478103637695312
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  0.00011587142944335938
r_  generation:  0.0005879402160644531
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.00015282630920410156
r_  generation:  0.0017733573913574219
local_output_nid generation:  0.0001277923583984375
local_in_edges_tensor generation:  0.00032901763916015625
mini_batch_src_global generation:  0.0004520416259765625
r_  generation:  0.005358457565307617
----------------------check_connections_block total spend ----------------------------- 0.06848001480102539
generate_one_block  0.003932476043701172
generate_one_block  0.0026025772094726562
generate_one_block  0.0012888908386230469
generate_one_block  0.0057942867279052734
generate_one_block  0.009130477905273438
generate_one_block  0.003201007843017578
generate_one_block  0.011842966079711914
generate_one_block  0.005766868591308594
generate_one_block  0.004022359848022461
generate_one_block  0.004204750061035156
generate_one_block  0.0048635005950927734
generate_one_block  0.003920316696166992
generate_one_block  0.0016334056854248047
generate_one_block  0.003190279006958008
generate_one_block  0.008607149124145508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0024645328521728516
gen group dst list time:  0.0017232894897460938
time for parepare:  0.0020363330841064453
local_output_nid generation:  0.00033926963806152344
local_in_edges_tensor generation:  0.0012826919555664062
mini_batch_src_global generation:  0.0010225772857666016
r_  generation:  0.008171796798706055
local_output_nid generation:  0.0002391338348388672
local_in_edges_tensor generation:  0.0004334449768066406
mini_batch_src_global generation:  0.0005636215209960938
r_  generation:  0.004442691802978516
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.00025534629821777344
r_  generation:  0.0019316673278808594
local_output_nid generation:  0.00041294097900390625
local_in_edges_tensor generation:  0.0007605552673339844
mini_batch_src_global generation:  0.0011005401611328125
r_  generation:  0.013153076171875
local_output_nid generation:  0.0007045269012451172
local_in_edges_tensor generation:  0.0014963150024414062
mini_batch_src_global generation:  0.0020194053649902344
r_  generation:  0.01642584800720215
local_output_nid generation:  0.00023818016052246094
local_in_edges_tensor generation:  0.00046563148498535156
mini_batch_src_global generation:  0.00064849853515625
r_  generation:  0.005575895309448242
local_output_nid generation:  0.0007090568542480469
local_in_edges_tensor generation:  0.0011668205261230469
mini_batch_src_global generation:  0.0015935897827148438
r_  generation:  0.01850128173828125
local_output_nid generation:  0.0005276203155517578
local_in_edges_tensor generation:  0.0009539127349853516
mini_batch_src_global generation:  0.0013728141784667969
r_  generation:  0.013865947723388672
local_output_nid generation:  0.00030303001403808594
local_in_edges_tensor generation:  0.00054931640625
mini_batch_src_global generation:  0.0007803440093994141
r_  generation:  0.0077402591705322266
local_output_nid generation:  0.00026726722717285156
local_in_edges_tensor generation:  0.0004894733428955078
mini_batch_src_global generation:  0.0006911754608154297
r_  generation:  0.007079601287841797
local_output_nid generation:  0.00032806396484375
local_in_edges_tensor generation:  0.0005960464477539062
mini_batch_src_global generation:  0.0011107921600341797
r_  generation:  0.011781930923461914
local_output_nid generation:  0.0004253387451171875
local_in_edges_tensor generation:  0.0005412101745605469
mini_batch_src_global generation:  0.0007781982421875
r_  generation:  0.008002758026123047
local_output_nid generation:  0.000125885009765625
local_in_edges_tensor generation:  0.0002765655517578125
mini_batch_src_global generation:  0.0004177093505859375
r_  generation:  0.003316164016723633
local_output_nid generation:  0.00027251243591308594
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.0006325244903564453
r_  generation:  0.007487773895263672
local_output_nid generation:  0.000446319580078125
local_in_edges_tensor generation:  0.0007309913635253906
mini_batch_src_global generation:  0.0012555122375488281
r_  generation:  0.024210453033447266
----------------------check_connections_block total spend ----------------------------- 0.2205805778503418
generate_one_block  0.013592004776000977
generate_one_block  0.006735324859619141
generate_one_block  0.004599809646606445
generate_one_block  0.015537023544311523
generate_one_block  0.02069568634033203
generate_one_block  0.008337020874023438
generate_one_block  0.0225222110748291
generate_one_block  0.01618361473083496
generate_one_block  0.011360883712768555
generate_one_block  0.010027170181274414
generate_one_block  0.013753175735473633
generate_one_block  0.011890888214111328
generate_one_block  0.0053899288177490234
generate_one_block  0.010843753814697266
generate_one_block  0.015962839126586914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

connection checking time:  0.3112502098083496
block generation total time  0.30341148376464844
average batch blocks generation time:  0.020227432250976562
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.02467060089111328  GigaBytes
Max Memory Allocated: 0.02467060089111328  GigaBytes

torch.Size([7586, 500])
torch.Size([2756, 128])
torch.Size([470, 128])
torch.Size([79, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.8240146636962891  GigaBytes
Max Memory Allocated: 0.8240261077880859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.03319740295410156  GigaBytes
Max Memory Allocated: 0.8254885673522949  GigaBytes

torch.Size([6206, 500])
torch.Size([2123, 128])
torch.Size([476, 128])
torch.Size([138, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.5265779495239258  GigaBytes
Max Memory Allocated: 0.8254885673522949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.02828693389892578  GigaBytes
Max Memory Allocated: 0.8254885673522949  GigaBytes

torch.Size([3620, 500])
torch.Size([583, 128])
torch.Size([108, 128])
torch.Size([37, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.24129056930541992  GigaBytes
Max Memory Allocated: 0.8254885673522949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.04319477081298828  GigaBytes
Max Memory Allocated: 0.8254885673522949  GigaBytes

torch.Size([11433, 500])
torch.Size([5021, 128])
torch.Size([1078, 128])
torch.Size([142, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 1.3343138694763184  GigaBytes
Max Memory Allocated: 1.3343324661254883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.049579620361328125  GigaBytes
Max Memory Allocated: 1.3352723121643066  GigaBytes

torch.Size([14518, 500])
torch.Size([8749, 128])
torch.Size([2404, 128])
torch.Size([471, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0096435546875 GB
    Memory Allocated: 1.7112154960632324  GigaBytes
Max Memory Allocated: 1.711245059967041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0096435546875 GB
    Memory Allocated: 0.03527116775512695  GigaBytes
Max Memory Allocated: 1.7121663093566895  GigaBytes

torch.Size([7302, 500])
torch.Size([2871, 128])
torch.Size([464, 128])
torch.Size([115, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0096435546875 GB
    Memory Allocated: 0.6428432464599609  GigaBytes
Max Memory Allocated: 1.7121663093566895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0096435546875 GB
    Memory Allocated: 0.050214290618896484  GigaBytes
Max Memory Allocated: 1.7121663093566895  GigaBytes

torch.Size([15050, 500])
torch.Size([9204, 128])
torch.Size([2752, 128])
torch.Size([551, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3533935546875 GB
    Memory Allocated: 2.035672187805176  GigaBytes
Max Memory Allocated: 2.0357165336608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.04471158981323242  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([12247, 500])
torch.Size([6277, 128])
torch.Size([1068, 128])
torch.Size([300, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 1.363133430480957  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.04005861282348633  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([9823, 500])
torch.Size([3782, 128])
torch.Size([961, 128])
torch.Size([205, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.9185733795166016  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.033858299255371094  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([6497, 500])
torch.Size([3066, 128])
torch.Size([732, 128])
torch.Size([110, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.8741860389709473  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.04137468338012695  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([10201, 500])
torch.Size([3979, 128])
torch.Size([964, 128])
torch.Size([92, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 1.1782374382019043  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.03738737106323242  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([8093, 500])
torch.Size([3540, 128])
torch.Size([590, 128])
torch.Size([112, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.9314746856689453  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.030704498291015625  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([4897, 500])
torch.Size([1341, 128])
torch.Size([166, 128])
torch.Size([49, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.378115177154541  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.039319515228271484  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([9291, 500])
torch.Size([3416, 128])
torch.Size([647, 128])
torch.Size([149, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.8924088478088379  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.04347085952758789  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([11356, 500])
torch.Size([5643, 128])
torch.Size([1702, 128])
torch.Size([381, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 1.448197841644287  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010152832667032877 |0.02440532048543294 |0.27624452908833824 |0.00016681353251139322 |0.2624638557434082 |0.013012886047363281 |
----------------------------------------------------------pseudo_mini_loss sum 1.9511548280715942
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  218341
Number of first layer input nodes during this epoch:  138120
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.06480646133422852  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0008878707885742188
random selection method range initialization spend 0.00019979476928710938
time for parepare:  0.000118255615234375
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00024127960205078125
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.52587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0038406848907470703
generate_one_block  0.0015311241149902344
generate_one_block  0.0013442039489746094
generate_one_block  0.0012946128845214844
generate_one_block  0.0012886524200439453
generate_one_block  0.0012810230255126953
generate_one_block  0.0012807846069335938
generate_one_block  0.0029997825622558594
generate_one_block  0.0021331310272216797
generate_one_block  0.002105236053466797
generate_one_block  0.002124786376953125
generate_one_block  0.0016388893127441406
generate_one_block  0.0016105175018310547
generate_one_block  0.0016787052154541016
generate_one_block  0.0016324520111083984
generate_one_block  0.0016252994537353516
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011267662048339844
gen group dst list time:  0.00011134147644042969
time for parepare:  0.0004253387451171875
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003323554992675781
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.00017595291137695312
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  6.771087646484375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  8.940696716308594e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  5.054473876953125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  9.131431579589844e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00017642974853515625
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00010967254638671875
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  9.965896606445312e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00025463104248046875
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0001437664031982422
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  4.887580871582031e-05
----------------------check_connections_block total spend ----------------------------- 0.0059130191802978516
generate_one_block  0.0016753673553466797
generate_one_block  0.001397848129272461
generate_one_block  0.0011780261993408203
generate_one_block  0.0011861324310302734
generate_one_block  0.0011162757873535156
generate_one_block  0.0010671615600585938
generate_one_block  0.001168966293334961
generate_one_block  0.0010843276977539062
generate_one_block  0.001092672348022461
generate_one_block  0.0012197494506835938
generate_one_block  0.001112222671508789
generate_one_block  0.001077890396118164
generate_one_block  0.0012733936309814453
generate_one_block  0.0011394023895263672
generate_one_block  0.000986337661743164
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012176036834716797
gen group dst list time:  0.00015020370483398438
time for parepare:  0.0009980201721191406
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00041604042053222656
mini_batch_src_global generation:  0.0002779960632324219
r_  generation:  0.001931905746459961
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  0.00013875961303710938
r_  generation:  0.000751495361328125
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0004253387451171875
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.00018596649169921875
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.00035500526428222656
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.00022220611572265625
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0004284381866455078
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.0001850128173828125
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0004665851593017578
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  0.00015354156494140625
r_  generation:  0.0012362003326416016
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00015783309936523438
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0004584789276123047
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0004909038543701172
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00014281272888183594
r_  generation:  0.0013589859008789062
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  0.00011372566223144531
r_  generation:  0.0007610321044921875
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00018525123596191406
----------------------check_connections_block total spend ----------------------------- 0.01796865463256836
generate_one_block  0.0038340091705322266
generate_one_block  0.002122163772583008
generate_one_block  0.0015392303466796875
generate_one_block  0.001186370849609375
generate_one_block  0.0014312267303466797
generate_one_block  0.0012211799621582031
generate_one_block  0.0015103816986083984
generate_one_block  0.0011606216430664062
generate_one_block  0.0015454292297363281
generate_one_block  0.0025174617767333984
generate_one_block  0.0014884471893310547
generate_one_block  0.0015773773193359375
generate_one_block  0.0028755664825439453
generate_one_block  0.0018999576568603516
generate_one_block  0.0019562244415283203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00206756591796875
gen group dst list time:  0.0003809928894042969
time for parepare:  0.0015766620635986328
local_output_nid generation:  0.0002696514129638672
local_in_edges_tensor generation:  0.0009431838989257812
mini_batch_src_global generation:  0.0008060932159423828
r_  generation:  0.00664067268371582
local_output_nid generation:  0.00013971328735351562
local_in_edges_tensor generation:  0.0003540515899658203
mini_batch_src_global generation:  0.0005805492401123047
r_  generation:  0.004118204116821289
local_output_nid generation:  8.606910705566406e-05
local_in_edges_tensor generation:  0.0002727508544921875
mini_batch_src_global generation:  0.0003390312194824219
r_  generation:  0.0028810501098632812
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0009903907775878906
local_output_nid generation:  7.915496826171875e-05
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  0.0002624988555908203
r_  generation:  0.002620220184326172
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  0.0002155303955078125
r_  generation:  0.0016438961029052734
local_output_nid generation:  8.749961853027344e-05
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  0.00022864341735839844
r_  generation:  0.0022068023681640625
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.00016307830810546875
r_  generation:  0.0012488365173339844
local_output_nid generation:  9.274482727050781e-05
local_in_edges_tensor generation:  0.00026535987854003906
mini_batch_src_global generation:  0.0002415180206298828
r_  generation:  0.002383708953857422
local_output_nid generation:  0.00014400482177734375
local_in_edges_tensor generation:  0.0003654956817626953
mini_batch_src_global generation:  0.0004527568817138672
r_  generation:  0.004750967025756836
local_output_nid generation:  7.343292236328125e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  0.0002846717834472656
r_  generation:  0.0019655227661132812
local_output_nid generation:  8.702278137207031e-05
local_in_edges_tensor generation:  0.0002574920654296875
mini_batch_src_global generation:  0.0002677440643310547
r_  generation:  0.0025413036346435547
local_output_nid generation:  0.00025200843811035156
local_in_edges_tensor generation:  0.00046753883361816406
mini_batch_src_global generation:  0.0004851818084716797
r_  generation:  0.0057125091552734375
local_output_nid generation:  0.00011706352233886719
local_in_edges_tensor generation:  0.0003070831298828125
mini_batch_src_global generation:  0.00045680999755859375
r_  generation:  0.004088401794433594
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  0.000217437744140625
r_  generation:  0.0011212825775146484
----------------------check_connections_block total spend ----------------------------- 0.06998372077941895
generate_one_block  0.010902643203735352
generate_one_block  0.006968975067138672
generate_one_block  0.005065202713012695
generate_one_block  0.00240325927734375
generate_one_block  0.004953861236572266
generate_one_block  0.0033676624298095703
generate_one_block  0.004174232482910156
generate_one_block  0.002573251724243164
generate_one_block  0.0045032501220703125
generate_one_block  0.007583141326904297
generate_one_block  0.0039005279541015625
generate_one_block  0.00525665283203125
generate_one_block  0.008952856063842773
generate_one_block  0.007214069366455078
generate_one_block  0.002371549606323242
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002374887466430664
gen group dst list time:  0.0016014575958251953
time for parepare:  0.0019028186798095703
local_output_nid generation:  0.0006573200225830078
local_in_edges_tensor generation:  0.0017299652099609375
mini_batch_src_global generation:  0.0011894702911376953
r_  generation:  0.011661052703857422
local_output_nid generation:  0.0006220340728759766
local_in_edges_tensor generation:  0.001055002212524414
mini_batch_src_global generation:  0.0012774467468261719
r_  generation:  0.012673616409301758
local_output_nid generation:  0.00043272972106933594
local_in_edges_tensor generation:  0.0007483959197998047
mini_batch_src_global generation:  0.0008561611175537109
r_  generation:  0.00884389877319336
local_output_nid generation:  0.0002288818359375
local_in_edges_tensor generation:  0.00046324729919433594
mini_batch_src_global generation:  0.0005176067352294922
r_  generation:  0.004477024078369141
local_output_nid generation:  0.0004582405090332031
local_in_edges_tensor generation:  0.0007004737854003906
mini_batch_src_global generation:  0.0007228851318359375
r_  generation:  0.00879359245300293
local_output_nid generation:  0.0003497600555419922
local_in_edges_tensor generation:  0.0006144046783447266
mini_batch_src_global generation:  0.0007410049438476562
r_  generation:  0.0075452327728271484
local_output_nid generation:  0.0004489421844482422
local_in_edges_tensor generation:  0.0006403923034667969
mini_batch_src_global generation:  0.0007758140563964844
r_  generation:  0.00839996337890625
local_output_nid generation:  0.0002818107604980469
local_in_edges_tensor generation:  0.0004544258117675781
mini_batch_src_global generation:  0.00061798095703125
r_  generation:  0.005890607833862305
local_output_nid generation:  0.0004904270172119141
local_in_edges_tensor generation:  0.0006966590881347656
mini_batch_src_global generation:  0.0008714199066162109
r_  generation:  0.010090112686157227
local_output_nid generation:  0.0005040168762207031
local_in_edges_tensor generation:  0.0007686614990234375
mini_batch_src_global generation:  0.0008914470672607422
r_  generation:  0.01047658920288086
local_output_nid generation:  0.0004725456237792969
local_in_edges_tensor generation:  0.0006477832794189453
mini_batch_src_global generation:  0.0007483959197998047
r_  generation:  0.0071697235107421875
local_output_nid generation:  0.000560760498046875
local_in_edges_tensor generation:  0.0007433891296386719
mini_batch_src_global generation:  0.0007536411285400391
r_  generation:  0.008578062057495117
local_output_nid generation:  0.0007977485656738281
local_in_edges_tensor generation:  0.001035928726196289
mini_batch_src_global generation:  0.0011701583862304688
r_  generation:  0.014937162399291992
local_output_nid generation:  0.0007054805755615234
local_in_edges_tensor generation:  0.0012171268463134766
mini_batch_src_global generation:  0.0011394023895263672
r_  generation:  0.013185739517211914
local_output_nid generation:  0.00018978118896484375
local_in_edges_tensor generation:  0.00040912628173828125
mini_batch_src_global generation:  0.0007462501525878906
r_  generation:  0.004386186599731445
----------------------check_connections_block total spend ----------------------------- 0.20448541641235352
generate_one_block  0.01690053939819336
generate_one_block  0.019342422485351562
generate_one_block  0.013991594314575195
generate_one_block  0.0073130130767822266
generate_one_block  0.012674570083618164
generate_one_block  0.011433601379394531
generate_one_block  0.012546539306640625
generate_one_block  0.008756160736083984
generate_one_block  0.015729904174804688
generate_one_block  0.014905214309692383
generate_one_block  0.01108241081237793
generate_one_block  0.012571573257446289
generate_one_block  0.020447969436645508
generate_one_block  0.01772451400756836
generate_one_block  0.0073735713958740234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.06480646133422852  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

connection checking time:  0.29835081100463867
block generation total time  0.3286261558532715
average batch blocks generation time:  0.0219084103902181
block dataloader generation time/epoch 0.8406393527984619
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.06061220169067383  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([9688, 500])
torch.Size([5370, 128])
torch.Size([2080, 128])
torch.Size([421, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 1.433133602142334  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.06478643417358398  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([11974, 500])
torch.Size([5722, 128])
torch.Size([1306, 128])
torch.Size([246, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 1.4176115989685059  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.05995035171508789  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([9238, 500])
torch.Size([3957, 128])
torch.Size([708, 128])
torch.Size([147, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 1.0719542503356934  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.054242610931396484  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([6469, 500])
torch.Size([1916, 128])
torch.Size([310, 128])
torch.Size([74, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.5266156196594238  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.05994749069213867  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([9062, 500])
torch.Size([4175, 128])
torch.Size([674, 128])
torch.Size([110, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 1.0678606033325195  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.05808210372924805  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([8470, 500])
torch.Size([3127, 128])
torch.Size([396, 128])
torch.Size([69, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.914177417755127  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.061869144439697266  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([10334, 500])
torch.Size([3799, 128])
torch.Size([797, 128])
torch.Size([159, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.9963645935058594  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.054345130920410156  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([6499, 500])
torch.Size([2305, 128])
torch.Size([281, 128])
torch.Size([76, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.6915411949157715  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.06287002563476562  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([11005, 500])
torch.Size([4275, 128])
torch.Size([816, 128])
torch.Size([149, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 1.104248046875  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.05855083465576172  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([8630, 500])
torch.Size([4554, 128])
torch.Size([1494, 128])
torch.Size([296, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 1.2309513092041016  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.05838727951049805  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([8643, 500])
torch.Size([3786, 128])
torch.Size([649, 128])
torch.Size([206, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.8267278671264648  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.061879634857177734  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([10046, 500])
torch.Size([4888, 128])
torch.Size([796, 128])
torch.Size([209, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 1.0110926628112793  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.06972646713256836  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([14573, 500])
torch.Size([7502, 128])
torch.Size([2461, 128])
torch.Size([416, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 1.6403074264526367  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.06573820114135742  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([12487, 500])
torch.Size([7293, 128])
torch.Size([1255, 128])
torch.Size([287, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 1.3963818550109863  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.050022125244140625  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

torch.Size([4200, 500])
torch.Size([1558, 128])
torch.Size([275, 128])
torch.Size([53, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3553466796875 GB
    Memory Allocated: 0.5338339805603027  GigaBytes
Max Memory Allocated: 2.0366134643554688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009305906295776368 |0.001963233947753906 |0.2030051867167155 |0.0001396656036376953 |0.26246368090311684 |0.009600639343261719 |
----------------------------------------------------------pseudo_mini_loss sum 2.0925488471984863
Total (block generation + training)time/epoch 8.037557601928711
Training time/epoch 7.196618556976318
Training time without block to device /epoch 7.16717004776001
Training time without total dataloading part /epoch 6.9937286376953125
load block tensor time/epoch 0.1395885944366455
block to device time/epoch 0.029448509216308594
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  223118
Number of first layer input nodes during this epoch:  141318
