main start at this time 1648532477.4174366
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001659393310546875
random selection method range initialization spend 0.00022125244140625
time for parepare:  4.744529724121094e-05
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0024962425231933594
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  6.67572021484375e-05
----------------------check_connections_block total spend ----------------------------- 0.003204345703125
generate_one_block  0.0013546943664550781
generate_one_block  0.0011794567108154297
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0008807182312011719
gen group dst list time:  2.6702880859375e-05
time for parepare:  0.0002498626708984375
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0007045269012451172
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  9.584426879882812e-05
r_  generation:  0.0006177425384521484
----------------------check_connections_block total spend ----------------------------- 0.0025053024291992188
generate_one_block  0.0019969940185546875
generate_one_block  0.0018558502197265625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011301040649414062
gen group dst list time:  6.437301635742188e-05
time for parepare:  0.0007758140563964844
local_output_nid generation:  0.00011229515075683594
local_in_edges_tensor generation:  0.00042557716369628906
mini_batch_src_global generation:  0.0003898143768310547
r_  generation:  0.0042188167572021484
local_output_nid generation:  0.0001049041748046875
local_in_edges_tensor generation:  0.0003025531768798828
mini_batch_src_global generation:  0.0005292892456054688
r_  generation:  0.003949642181396484
----------------------check_connections_block total spend ----------------------------- 0.013146162033081055
generate_one_block  0.006345033645629883
generate_one_block  0.005736589431762695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017275810241699219
gen group dst list time:  0.00020623207092285156
time for parepare:  0.0014879703521728516
local_output_nid generation:  0.0004253387451171875
local_in_edges_tensor generation:  0.0011515617370605469
mini_batch_src_global generation:  0.0014507770538330078
r_  generation:  0.014805078506469727
local_output_nid generation:  0.0003859996795654297
local_in_edges_tensor generation:  0.0009593963623046875
mini_batch_src_global generation:  0.0016243457794189453
r_  generation:  0.013417720794677734
----------------------check_connections_block total spend ----------------------------- 0.04300665855407715
generate_one_block  0.018825769424438477
generate_one_block  0.018290042877197266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017371177673339844
gen group dst list time:  0.0005006790161132812
time for parepare:  0.0017504692077636719
local_output_nid generation:  0.0010967254638671875
local_in_edges_tensor generation:  0.0021514892578125
mini_batch_src_global generation:  0.002278566360473633
r_  generation:  0.023362159729003906
local_output_nid generation:  0.0010504722595214844
local_in_edges_tensor generation:  0.0021262168884277344
mini_batch_src_global generation:  0.002505064010620117
r_  generation:  0.022306203842163086
----------------------check_connections_block total spend ----------------------------- 0.06924819946289062
generate_one_block  0.027868270874023438
generate_one_block  0.028974533081054688
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

connection checking time:  0.12790632247924805
block generation total time  0.1098930835723877
average batch blocks generation time:  0.05494654178619385
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.04460906982421875  GigaBytes
Max Memory Allocated: 0.04460906982421875  GigaBytes

torch.Size([17873, 500])
torch.Size([14295, 128])
torch.Size([5707, 128])
torch.Size([1476, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0897216796875 GB
    Memory Allocated: 2.7259092330932617  GigaBytes
Max Memory Allocated: 2.726017951965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0955810546875 GB
    Memory Allocated: 0.05372428894042969  GigaBytes
Max Memory Allocated: 2.726799488067627  GigaBytes

torch.Size([17281, 500])
torch.Size([12861, 128])
torch.Size([4845, 128])
torch.Size([1271, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0955810546875 GB
    Memory Allocated: 2.5765700340270996  GigaBytes
Max Memory Allocated: 2.726799488067627  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018469572067260742 |0.17144393920898438 |0.5770984888076782 |0.0002015829086303711 |0.4156792163848877 |0.0183107852935791 |
----------------------------------------------------------pseudo_mini_loss sum 2.038482666015625
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  75963
Number of first layer input nodes during this epoch:  35154
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.0955810546875 GB
    Memory Allocated: 0.07638216018676758  GigaBytes
Max Memory Allocated: 2.726799488067627  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005507469177246094
random selection method range initialization spend 0.00013494491577148438
time for parepare:  5.7220458984375e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  7.224082946777344e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  6.699562072753906e-05
----------------------check_connections_block total spend ----------------------------- 0.0007605552673339844
generate_one_block  0.0012660026550292969
generate_one_block  0.0012183189392089844
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005609989166259766
gen group dst list time:  2.9802322387695312e-05
time for parepare:  0.00028204917907714844
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0005834102630615234
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation: Using backend: pytorch
 9.655952453613281e-05
r_  generation:  0.0007257461547851562
----------------------check_connections_block total spend ----------------------------- 0.002643108367919922
generate_one_block  0.002099752426147461
generate_one_block  0.002249002456665039
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010542869567871094
gen group dst list time:  7.462501525878906e-05
time for parepare:  0.0007898807525634766
local_output_nid generation:  0.00013709068298339844
local_in_edges_tensor generation:  0.0003895759582519531
mini_batch_src_global generation:  0.00038695335388183594
r_  generation:  0.0039539337158203125
local_output_nid generation:  0.00014781951904296875
local_in_edges_tensor generation:  0.0003285408020019531
mini_batch_src_global generation:  0.00047969818115234375
r_  generation:  0.0044841766357421875
----------------------check_connections_block total spend ----------------------------- 0.013361692428588867
generate_one_block  0.008048295974731445
generate_one_block  0.006698131561279297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017809867858886719
gen group dst list time:  0.0001995563507080078
time for parepare:  0.0013649463653564453
local_output_nid generation:  0.00039005279541015625
local_in_edges_tensor generation:  0.001010894775390625
mini_batch_src_global generation:  0.0012073516845703125
r_  generation:  0.013282060623168945
local_output_nid generation:  0.00046515464782714844
local_in_edges_tensor generation:  0.0009286403656005859
mini_batch_src_global generation:  0.0016164779663085938
r_  generation:  0.016199588775634766
----------------------check_connections_block total spend ----------------------------- 0.043591976165771484
generate_one_block  0.01897430419921875
generate_one_block  0.022955656051635742
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017006397247314453
gen group dst list time:  0.000522613525390625
time for parepare:  0.001520395278930664
local_output_nid generation:  0.0010709762573242188
local_in_edges_tensor generation:  0.00202178955078125
mini_batch_src_global generation:  0.002034902572631836
r_  generation:  0.022020578384399414
local_output_nid generation:  0.0012671947479248047
local_in_edges_tensor generation:  0.002309083938598633
mini_batch_src_global generation:  0.0027751922607421875
r_  generation:  0.025337934494018555
----------------------check_connections_block total spend ----------------------------- 0.07104229927062988
generate_one_block  0.029994487762451172
generate_one_block  0.03315424919128418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.0955810546875 GB
    Memory Allocated: 0.07638216018676758  GigaBytes
Max Memory Allocated: 2.726799488067627  GigaBytes

connection checking time:  0.13063907623291016
block generation total time  0.12417387962341309
average batch blocks generation time:  0.06208693981170654
block dataloader generation time/epoch 0.3028230667114258
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0955810546875 GB
    Memory Allocated: 0.07501029968261719  GigaBytes
Max Memory Allocated: 2.726799488067627  GigaBytes

torch.Size([17376, 500])
torch.Size([12645, 128])
torch.Size([4830, 128])
torch.Size([1209, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0955810546875 GB
    Memory Allocated: 2.60099458694458  GigaBytes
Max Memory Allocated: 2.726799488067627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0955810546875 GB
    Memory Allocated: 0.07604074478149414  GigaBytes
Max Memory Allocated: 2.726799488067627  GigaBytes

torch.Size([17886, 500])
torch.Size([14485, 128])
torch.Size([5795, 128])
torch.Size([1553, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2420654296875 GB
    Memory Allocated: 2.773660659790039  GigaBytes
Max Memory Allocated: 2.7737770080566406  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014451265335083008 |0.0023218393325805664 |0.3046330213546753 |0.00014960765838623047 |0.4461195468902588 |0.010810375213623047 |
----------------------------------------------------------pseudo_mini_loss sum 2.205753803253174
Total (block generation + training)time/epoch 1.8571817874908447
Training time/epoch 1.554030179977417
Training time without block to device /epoch 1.5493865013122559
Training time without total dataloading part /epoch 1.5126147270202637
load block tensor time/epoch 0.028902530670166016
block to device time/epoch 0.004643678665161133
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  76134
Number of first layer input nodes during this epoch:  35262
