main start at this time 1648532490.8070421
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0020411014556884766
random selection method range initialization spend 0.00018978118896484375
time for parepare:  6.031990051269531e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0016636848449707031
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  5.91278076171875e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.696846008300781e-05
----------------------check_connections_block total spend ----------------------------- 0.0028786659240722656
generate_one_block  0.0014405250549316406
generate_one_block  0.0013165473937988281
generate_one_block  0.0012645721435546875
generate_one_block  0.001272439956665039
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012977123260498047
gen group dst list time:  4.601478576660156e-05
time for parepare:  0.0003235340118408203
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00021839141845703125
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0005795955657958984
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0003325939178466797
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00040984153747558594
----------------------check_connections_block total spend ----------------------------- 0.0033566951751708984
generate_one_block  0.0015206336975097656
generate_one_block  0.0021228790283203125
generate_one_block  0.0016677379608154297
generate_one_block  0.001772165298461914
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013785362243652344
gen group dst list time:  9.751319885253906e-05
time for parepare:  0.001111745834350586
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.0002994537353515625
mini_batch_src_global generation:  0.00011849403381347656
r_  generation:  0.0011920928955078125
local_output_nid generation:  0.00011682510375976562
local_in_edges_tensor generation:  0.00034356117248535156
mini_batch_src_global generation:  0.0004076957702636719
r_  generation:  0.004195451736450195
local_output_nid generation:  7.414817810058594e-05
local_in_edges_tensor generation:  0.0002586841583251953
mini_batch_src_global generation:  0.0003349781036376953
r_  generation:  0.002363920211791992
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.00026226043701171875
mini_batch_src_global generation:  0.0003006458282470703
r_  generation:  0.0024230480194091797
----------------------check_connections_block total spend ----------------------------- 0.016885757446289062
generate_one_block  0.002542734146118164
generate_one_block  0.005317211151123047
generate_one_block  0.003306865692138672
generate_one_block  0.0037469863891601562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019600391387939453
gen group dst list time:  0.0003113746643066406
time for parepare:  0.0017418861389160156
local_output_nid generation:  0.00019860267639160156
local_in_edges_tensor generation:  0.0006377696990966797
mini_batch_src_global generation:  0.0007715225219726562
r_  generation:  0.006287097930908203
local_output_nid generation:  0.0005340576171875
local_in_edges_tensor generation:  0.000978708267211914
mini_batch_src_global generation:  0.001718759536743164
r_  generation:  0.014368772506713867
local_output_nid generation:  0.0002894401550292969
local_in_edges_tensor generation:  0.0007269382476806641
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.008664608001708984
local_output_nid generation:  0.000255584716796875
local_in_edges_tensor generation:  0.0012698173522949219
mini_batch_src_global generation:  0.0007917881011962891
r_  generation:  0.0075070858001708984
----------------------check_connections_block total spend ----------------------------- 0.057514190673828125
generate_one_block  0.00821685791015625
generate_one_block  0.017421483993530273
generate_one_block  0.01409912109375
generate_one_block  0.011572122573852539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017275810241699219
gen group dst list time:  0.0008249282836914062
time for parepare:  0.0019295215606689453
local_output_nid generation:  0.0006403923034667969
local_in_edges_tensor generation:  0.0012102127075195312
mini_batch_src_global generation:  0.0013589859008789062
r_  generation:  0.014376401901245117
local_output_nid generation:  0.0012574195861816406
local_in_edges_tensor generation:  0.002269744873046875
mini_batch_src_global generation:  0.0024056434631347656
r_  generation:  0.022814273834228516
local_output_nid generation:  0.0010421276092529297
local_in_edges_tensor generation:  0.0015861988067626953
mini_batch_src_global generation:  0.0017459392547607422
r_  generation:  0.019992351531982422
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.001280069351196289
mini_batch_src_global generation:  0.0013246536254882812
r_  generation:  0.019063949584960938
----------------------check_connections_block total spend ----------------------------- 0.11201810836791992
generate_one_block  0.01795339584350586
generate_one_block  0.03220176696777344
generate_one_block  0.02776312828063965
generate_one_block  0.02403569221496582
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

connection checking time:  0.189774751663208
block generation total time  0.1752607822418213
average batch blocks generation time:  0.04381519556045532
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1268310546875 GB
    Memory Allocated: 0.03422880172729492  GigaBytes
Max Memory Allocated: 0.03422880172729492  GigaBytes

torch.Size([12518, 500])
torch.Size([6217, 128])
torch.Size([1602, 128])
torch.Size([334, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 1.5305681228637695  GigaBytes
Max Memory Allocated: 1.5306100845336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8338623046875 GB
    Memory Allocated: 0.05414009094238281  GigaBytes
Max Memory Allocated: 1.5315675735473633  GigaBytes

torch.Size([17503, 500])
torch.Size([13554, 128])
torch.Size([4983, 128])
torch.Size([1171, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0037841796875 GB
    Memory Allocated: 2.6159119606018066  GigaBytes
Max Memory Allocated: 2.6159844398498535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 0.050409793853759766  GigaBytes
Max Memory Allocated: 2.6168265342712402  GigaBytes

torch.Size([15615, 500])
torch.Size([10151, 128])
torch.Size([3102, 128])
torch.Size([642, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 2.1739091873168945  GigaBytes
Max Memory Allocated: 2.6168265342712402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 0.047557830810546875  GigaBytes
Max Memory Allocated: 2.6168265342712402  GigaBytes

torch.Size([14128, 500])
torch.Size([8354, 128])
torch.Size([2617, 128])
torch.Size([662, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 1.89202880859375  GigaBytes
Max Memory Allocated: 2.6168265342712402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009820282459259033 |0.08467280864715576 |0.4046095609664917 |0.0001575946807861328 |0.3858192563056946 |0.011448383331298828 |
----------------------------------------------------------pseudo_mini_loss sum 2.0730690956115723
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  113508
Number of first layer input nodes during this epoch:  59764
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 0.0691518783569336  GigaBytes
Max Memory Allocated: 2.6168265342712402  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006725788116455078
random selection method range initialization spend 0.00017309188842773438
time for parepare:  6.985664367675781e-05
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.078315734863281e-05
----------------------check_connections_block total spend ----------------------------- 0.0012631416320800781
generate_one_block  0.0013661384582519531
generate_one_block  0.0011348724365234375
generate_one_block  0.0011510848999023438
generate_one_block  0.0012004375457763672
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005910396575927734
gen group dst list time:  4.100799560546875e-05
time for parepare:  0.00034308433532714844
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.00047278404235839844
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0001938343048095703
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0003581047058105469
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0004169940948486328
----------------------check_connections_block total spend ----------------------------- 0.0033066272735595703
generate_one_block  0.0020623207092285156
generate_one_block  0.0013687610626220703
generate_one_block  0.0016553401947021484
generate_one_block  0.0017473697662353516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010879039764404297
gen group dst list time:  9.202957153320312e-05
time for parepare:  0.0009238719940185547
local_output_nid generation:  0.00012135505676269531
local_in_edges_tensor generation:  0.0003974437713623047
mini_batch_src_global generation:  0.0004885196685791016
r_  generation:  0.003147602081298828
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  0.00019073486328125
r_  generation:  0.0010693073272705078
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.0002346038818359375
mini_batch_src_global generation:  0.0002028942108154297
r_  generation:  0.002281665802001953
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.00024700164794921875
mini_batch_src_global generation:  0.0002510547637939453
r_  generation:  0.002533435821533203
----------------------check_connections_block total spend ----------------------------- 0.015004158020019531
generate_one_block  0.005636930465698242
generate_one_block  0.002385377883911133
generate_one_block  0.004034996032714844
generate_one_block  0.004445314407348633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017237663269042969
gen group dst list time:  0.0002574920654296875
time for parepare:  0.0015308856964111328
local_output_nid generation:  0.0003783702850341797
local_in_edges_tensor generation:  0.0010509490966796875
mini_batch_src_global generation:  0.001140594482421875
r_  generation:  0.010687112808227539
local_output_nid generation:  0.00019311904907226562
local_in_edges_tensor generation:  0.0004191398620605469
mini_batch_src_global generation:  0.0008876323699951172
r_  generation:  0.006264209747314453
local_output_nid generation:  0.00029587745666503906
local_in_edges_tensor generation:  0.0005817413330078125
mini_batch_src_global generation:  0.0008056163787841797
r_  generation:  0.008273124694824219
local_output_nid generation:  0.0003376007080078125
local_in_edges_tensor generation:  0.0006251335144042969
mini_batch_src_global generation:  0.0010342597961425781
r_  generation:  0.010395050048828125
----------------------check_connections_block total spend ----------------------------- 0.05401778221130371
generate_one_block  0.017068147659301758
generate_one_block  0.010625600814819336
generate_one_block  0.014101743698120117
generate_one_block  0.014312982559204102
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017566680908203125
gen group dst list time:  0.0008187294006347656
time for parepare:  0.001722574234008789
local_output_nid generation:  0.0010595321655273438
local_in_edges_tensor generation:  0.0021393299102783203
mini_batch_src_global generation:  0.001992464065551758
r_  generation:  0.019227027893066406
local_output_nid generation:  0.0009496212005615234
local_in_edges_tensor generation:  0.0012822151184082031
mini_batch_src_global generation:  0.0076029300689697266
r_  generation:  0.01667475700378418
local_output_nid generation:  0.0013103485107421875
local_in_edges_tensor generation:  0.0020809173583984375
mini_batch_src_global generation:  0.001481771469116211
r_  generation:  0.01942276954650879
local_output_nid generation:  0.0012569427490234375
local_in_edges_tensor generation:  0.0017650127410888672
mini_batch_src_global generation:  0.0018651485443115234Using backend: pytorch

r_  generation:  0.020911455154418945
----------------------check_connections_block total spend ----------------------------- 0.12111949920654297
generate_one_block  0.027490615844726562
generate_one_block  0.025583267211914062
generate_one_block  0.026958227157592773
generate_one_block  0.042058706283569336
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 0.0691518783569336  GigaBytes
Max Memory Allocated: 2.6168265342712402  GigaBytes

connection checking time:  0.19344806671142578
block generation total time  0.20153570175170898
average batch blocks generation time:  0.050383925437927246
block dataloader generation time/epoch 0.47326207160949707
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 0.07072210311889648  GigaBytes
Max Memory Allocated: 2.6168265342712402  GigaBytes

torch.Size([15443, 500])
torch.Size([10068, 128])
torch.Size([3662, 128])
torch.Size([846, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 2.247746467590332  GigaBytes
Max Memory Allocated: 2.6168265342712402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 0.06835079193115234  GigaBytes
Max Memory Allocated: 2.6168265342712402  GigaBytes

torch.Size([14298, 500])
torch.Size([8172, 128])
torch.Size([1804, 128])
torch.Size([385, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 1.8071222305297852  GigaBytes
Max Memory Allocated: 2.6168265342712402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 0.07070636749267578  GigaBytes
Max Memory Allocated: 2.6168265342712402  GigaBytes

torch.Size([15470, 500])
torch.Size([9983, 128])
torch.Size([2974, 128])
torch.Size([726, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 2.167663097381592  GigaBytes
Max Memory Allocated: 2.6168265342712402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 0.07319211959838867  GigaBytes
Max Memory Allocated: 2.6168265342712402  GigaBytes

torch.Size([16780, 500])
torch.Size([11915, 128])
torch.Size([3890, 128])
torch.Size([901, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0369873046875 GB
    Memory Allocated: 2.3194026947021484  GigaBytes
Max Memory Allocated: 2.6168265342712402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013420343399047852 |0.002445042133331299 |0.2705148458480835 |0.00016134977340698242 |0.3652239441871643 |0.011745452880859375 |
----------------------------------------------------------pseudo_mini_loss sum 1.8135409355163574
Total (block generation + training)time/epoch 3.1078035831451416
Training time/epoch 2.633883476257324
Training time without block to device /epoch 2.624103307723999
Training time without total dataloading part /epoch 2.5553460121154785
load block tensor time/epoch 0.053681373596191406
block to device time/epoch 0.009780168533325195
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  117673
Number of first layer input nodes during this epoch:  61991
