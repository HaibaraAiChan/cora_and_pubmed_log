main start at this time 1648532218.4191093
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011794567108154297
random selection method range initialization spend 0.00018835067749023438
time for parepare:  4.649162292480469e-05
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0015645027160644531
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  7.081031799316406e-05
----------------------check_connections_block total spend ----------------------------- 0.0022716522216796875
generate_one_block  0.0013206005096435547
generate_one_block  0.001157522201538086
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0008187294006347656
gen group dst list time:  2.5033950805664062e-05
time for parepare:  0.0002415180206298828
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0005908012390136719
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0007147789001464844
----------------------check_connections_block total spend ----------------------------- 0.002542257308959961
generate_one_block  0.0019021034240722656
generate_one_block  0.001972675323486328
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010344982147216797
gen group dst list time:  6.437301635742188e-05
time for parepare:  0.0007369518280029297
local_output_nid generation:  9.584426879882812e-05
local_in_edges_tensor generation:  0.00037860870361328125
mini_batch_src_global generation:  0.00025391578674316406
r_  generation:  0.00337982177734375
local_output_nid generation:  0.00011539459228515625
local_in_edges_tensor generation:  0.0003218650817871094
mini_batch_src_global generation:  0.0005867481231689453
r_  generation:  0.004463911056518555
----------------------check_connections_block total spend ----------------------------- 0.012762069702148438
generate_one_block  0.005949974060058594
generate_one_block  0.006514072418212891
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0015993118286132812
gen group dst list time:  0.00018477439880371094
time for parepare:  0.0014801025390625
local_output_nid generation:  0.0003714561462402344
local_in_edges_tensor generation:  0.0009679794311523438
mini_batch_src_global generation:  0.001302957534790039
r_  generation:  0.013217449188232422
local_output_nid generation:  0.0004100799560546875
local_in_edges_tensor generation:  0.0010516643524169922
mini_batch_src_global generation:  0.0015938282012939453
r_  generation:  0.013796567916870117
----------------------check_connections_block total spend ----------------------------- 0.0409092903137207
generate_one_block  0.017029762268066406
generate_one_block  0.019382238388061523
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0016880035400390625
gen group dst list time:  0.0005161762237548828
time for parepare:  0.0015954971313476562
local_output_nid generation:  0.001058340072631836
local_in_edges_tensor generation:  0.0020322799682617188
mini_batch_src_global generation:  0.002119779586791992
r_  generation:  0.022907018661499023
local_output_nid generation:  0.0012822151184082031
local_in_edges_tensor generation:  0.0022644996643066406
mini_batch_src_global generation:  0.00244903564453125
r_  generation:  0.02277374267578125
----------------------check_connections_block total spend ----------------------------- 0.06927061080932617
generate_one_block  0.027734756469726562
generate_one_block  0.02951216697692871
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

connection checking time:  0.12548422813415527
block generation total time  0.10999774932861328
average batch blocks generation time:  0.05499887466430664
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1346435546875 GB
    Memory Allocated: 0.041727542877197266  GigaBytes
Max Memory Allocated: 0.041727542877197266  GigaBytes

torch.Size([17637, 500])
torch.Size([13870, 16])
torch.Size([5072, 16])
torch.Size([1286, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6502685546875 GB
    Memory Allocated: 2.215394973754883  GigaBytes
Max Memory Allocated: 2.342766284942627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6522216796875 GB
    Memory Allocated: 0.048908233642578125  GigaBytes
Max Memory Allocated: 2.342766284942627  GigaBytes

torch.Size([17297, 500])
torch.Size([13182, 16])
torch.Size([5067, 16])
torch.Size([1468, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 2.193607807159424  GigaBytes
Max Memory Allocated: 2.342766284942627  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02149951457977295 |0.1729109287261963 |0.5542522668838501 |0.00022602081298828125 |0.3619784116744995 |0.01658487319946289 |
----------------------------------------------------------pseudo_mini_loss sum 1.5503944158554077
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  75236
Number of first layer input nodes during this epoch:  34934
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 0.0656728744506836  GigaBytes
Max Memory Allocated: 2.342766284942627  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005447864532470703
random selection method range initialization spend 0.000133514404296875
time for parepare:  5.7697296142578125e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  6.794929504394531e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  6.961822509765625e-05
----------------------check_connections_block total spend ----------------------------- 0.0007603168487548828
generate_one_block  0.001232147216796875
generate_one_block  0.0013318061828613281
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000553131103515625
gen group dst list time:  2.765655517578125e-05
time for parepare:  0.00027370452880859375
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0005223751068115234
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation: Using backend: pytorch
 0.00010800361633300781
r_  generation:  0.0008325576782226562
----------------------check_connections_block total spend ----------------------------- 0.0026640892028808594
generate_one_block  0.0019757747650146484
generate_one_block  0.0023005008697509766
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001058816909790039
gen group dst list time:  6.818771362304688e-05
time for parepare:  0.0007691383361816406
local_output_nid generation:  0.000133514404296875
local_in_edges_tensor generation:  0.0003910064697265625
mini_batch_src_global generation:  0.0003116130828857422
r_  generation:  0.003291606903076172
local_output_nid generation:  0.00014352798461914062
local_in_edges_tensor generation:  0.0003428459167480469
mini_batch_src_global generation:  0.0005016326904296875
r_  generation:  0.0051343441009521484
----------------------check_connections_block total spend ----------------------------- 0.013148069381713867
generate_one_block  0.007218837738037109
generate_one_block  0.007319927215576172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017457008361816406
gen group dst list time:  0.00019812583923339844
time for parepare:  0.0013523101806640625
local_output_nid generation:  0.0003917217254638672
local_in_edges_tensor generation:  0.0010328292846679688
mini_batch_src_global generation:  0.0012166500091552734
r_  generation:  0.013790130615234375
local_output_nid generation:  0.0004394054412841797
local_in_edges_tensor generation:  0.0009224414825439453
mini_batch_src_global generation:  0.0016655921936035156
r_  generation:  0.014736175537109375
----------------------check_connections_block total spend ----------------------------- 0.043839216232299805
generate_one_block  0.01980876922607422
generate_one_block  0.021898269653320312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001760244369506836
gen group dst list time:  0.0005362033843994141
time for parepare:  0.0015327930450439453
local_output_nid generation:  0.001192331314086914
local_in_edges_tensor generation:  0.002084970474243164
mini_batch_src_global generation:  0.0020825862884521484
r_  generation:  0.02352142333984375
local_output_nid generation:  0.0011622905731201172
local_in_edges_tensor generation:  0.002321004867553711
mini_batch_src_global generation:  0.0025207996368408203
r_  generation:  0.02462172508239746
----------------------check_connections_block total spend ----------------------------- 0.07159590721130371
generate_one_block  0.031210899353027344
generate_one_block  0.031720638275146484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 0.0656728744506836  GigaBytes
Max Memory Allocated: 2.342766284942627  GigaBytes

connection checking time:  0.13124728202819824
block generation total time  0.12345361709594727
average batch blocks generation time:  0.06172680854797363
block dataloader generation time/epoch 0.30129337310791016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 0.06500673294067383  GigaBytes
Max Memory Allocated: 2.342766284942627  GigaBytes

torch.Size([17814, 500])
torch.Size([14077, 16])
torch.Size([4997, 16])
torch.Size([1182, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 2.2823362350463867  GigaBytes
Max Memory Allocated: 2.4122724533081055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8397216796875 GB
    Memory Allocated: 0.06475305557250977  GigaBytes
Max Memory Allocated: 2.4122724533081055  GigaBytes

torch.Size([17653, 500])
torch.Size([13843, 16])
torch.Size([5588, 16])
torch.Size([1570, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 2.2704520225524902  GigaBytes
Max Memory Allocated: 2.4122724533081055  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01613295078277588 |0.002155780792236328 |0.3047863245010376 |0.00014829635620117188 |0.39423489570617676 |0.006695985794067383 |
----------------------------------------------------------pseudo_mini_loss sum 1.2803888320922852
Total (block generation + training)time/epoch 1.7506952285766602
Training time/epoch 1.4490032196044922
Training time without block to device /epoch 1.4446916580200195
Training time without total dataloading part /epoch 1.4050350189208984
load block tensor time/epoch 0.03226590156555176
block to device time/epoch 0.004311561584472656
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  77081
Number of first layer input nodes during this epoch:  35467
