main start at this time 1648532267.330961
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0017201900482177734
random selection method range initialization spend 0.0001819133758544922
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.001542806625366211
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.004250764846801758
generate_one_block  0.001188039779663086
generate_one_block  0.0010704994201660156
generate_one_block  0.0010426044464111328
generate_one_block  0.0010023117065429688
generate_one_block  0.0010576248168945312
generate_one_block  0.001016378402709961
generate_one_block  0.0010051727294921875
generate_one_block  0.0010023117065429688
generate_one_block  0.0010094642639160156
generate_one_block  0.0010008811950683594
generate_one_block  0.0009989738464355469
generate_one_block  0.0010123252868652344
generate_one_block  0.0010223388671875
generate_one_block  0.0010266304016113281
generate_one_block  0.0009500980377197266
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011975765228271484
gen group dst list time:  7.963180541992188e-05
time for parepare:  0.0002734661102294922
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00010776519775390625
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.818771362304688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  9.298324584960938e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00013756752014160156
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00015974044799804688
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  8.225440979003906e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0001506805419921875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0001990795135498047
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010895729064941406
----------------------check_connections_block total spend ----------------------------- 0.0046117305755615234
generate_one_block  0.0010864734649658203
generate_one_block  0.0011494159698486328
generate_one_block  0.0011034011840820312
generate_one_block  0.0011737346649169922
generate_one_block  0.0011866092681884766
generate_one_block  0.001233816146850586
generate_one_block  0.0010519027709960938
generate_one_block  0.001077890396118164
generate_one_block  0.0011353492736816406
generate_one_block  0.0010325908660888672
generate_one_block  0.0010159015655517578
generate_one_block  0.0011830329895019531
generate_one_block  0.001190185546875
generate_one_block  0.0009984970092773438
generate_one_block  0.0010938644409179688
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011050701141357422
gen group dst list time:  0.00012493133544921875
time for parepare:  0.0007674694061279297
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00023794174194335938
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00021886825561523438
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0007357597351074219
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0003848075866699219
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.0004878044128417969
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.000782012939453125
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  0.00011324882507324219
r_  generation:  0.0009455680847167969
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.000308990478515625
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00028133392333984375
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0005397796630859375
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.000499725341796875
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0003325939178466797
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  0.00011682510375976562
r_  generation:  0.0012557506561279297
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  0.00017452239990234375
r_  generation:  0.0014138221740722656
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  8.225440979003906e-05
r_  generation:  0.00040721893310546875
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0007312297821044922
----------------------check_connections_block total spend ----------------------------- 0.016785860061645508
generate_one_block  0.0019540786743164062
generate_one_block  0.0019698143005371094
generate_one_block  0.0015101432800292969
generate_one_block  0.0015757083892822266
generate_one_block  0.0018262863159179688
generate_one_block  0.0020263195037841797
generate_one_block  0.0013000965118408203
generate_one_block  0.001257181167602539
generate_one_block  0.001590728759765625
generate_one_block  0.0015408992767333984
generate_one_block  0.0016126632690429688
generate_one_block  0.002360105514526367
generate_one_block  0.002573728561401367
generate_one_block  0.0014371871948242188
generate_one_block  0.0017592906951904297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002179861068725586
gen group dst list time:  0.00031447410583496094
time for parepare:  0.001728057861328125
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0004451274871826172
mini_batch_src_global generation:  0.0001392364501953125
r_  generation:  0.0010352134704589844
local_output_nid generation:  0.000125885009765625
local_in_edges_tensor generation:  0.00033926963806152344
mini_batch_src_global generation:  0.0004696846008300781
r_  generation:  0.003772735595703125
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.0002529621124267578
mini_batch_src_global generation:  0.0003275871276855469
r_  generation:  0.0025177001953125
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.00024080276489257812
mini_batch_src_global generation:  0.0003101825714111328
r_  generation:  0.0026717185974121094
local_output_nid generation:  0.00012302398681640625
local_in_edges_tensor generation:  0.0003230571746826172
mini_batch_src_global generation:  0.0003578662872314453
r_  generation:  0.0038154125213623047
local_output_nid generation:  0.00013589859008789062
local_in_edges_tensor generation:  0.00035071372985839844
mini_batch_src_global generation:  0.0005152225494384766
r_  generation:  0.004736185073852539
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  0.00031256675720214844
r_  generation:  0.0023987293243408203
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.0014567375183105469
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.0002510547637939453
mini_batch_src_global generation:  0.00030684471130371094
r_  generation:  0.0034551620483398438
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.0002465248107910156
mini_batch_src_global generation:  0.0003457069396972656
r_  generation:  0.0031473636627197266
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.00024700164794921875
r_  generation:  0.002028226852416992
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.0003170967102050781
mini_batch_src_global generation:  0.0004470348358154297
r_  generation:  0.004734992980957031
local_output_nid generation:  0.00012826919555664062
local_in_edges_tensor generation:  0.0003230571746826172
mini_batch_src_global generation:  0.0005247592926025391
r_  generation:  0.004542112350463867
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.0002372264862060547
mini_batch_src_global generation:  0.00035953521728515625
r_  generation:  0.003123044967651367
local_output_nid generation:  0.00011301040649414062
local_in_edges_tensor generation:  0.0002925395965576172
mini_batch_src_global generation:  0.0004398822784423828
r_  generation:  0.0042018890380859375
----------------------check_connections_block total spend ----------------------------- 0.07276725769042969
generate_one_block  0.0031855106353759766
generate_one_block  0.005657672882080078
generate_one_block  0.004096508026123047
generate_one_block  0.0044705867767333984
generate_one_block  0.0057947635650634766
generate_one_block  0.00825810432434082
generate_one_block  0.004083395004272461
generate_one_block  0.002808809280395508
generate_one_block  0.005621671676635742
generate_one_block  0.005097866058349609
generate_one_block  0.003637552261352539
generate_one_block  0.008038520812988281
generate_one_block  0.006971836090087891
generate_one_block  0.005013227462768555
generate_one_block  0.006577014923095703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002198934555053711
gen group dst list time:  0.0017447471618652344
time for parepare:  0.0017421245574951172
local_output_nid generation:  0.00020265579223632812
local_in_edges_tensor generation:  0.0008940696716308594
mini_batch_src_global generation:  0.0005743503570556641
r_  generation:  0.00504612922668457
local_output_nid generation:  0.0004494190216064453
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0011665821075439453
r_  generation:  0.011199951171875
local_output_nid generation:  0.00038814544677734375
local_in_edges_tensor generation:  0.0010836124420166016
mini_batch_src_global generation:  0.0010018348693847656
r_  generation:  0.010395050048828125
local_output_nid generation:  0.0004010200500488281
local_in_edges_tensor generation:  0.0007092952728271484
mini_batch_src_global generation:  0.0009446144104003906
r_  generation:  0.009146928787231445
local_output_nid generation:  0.0005433559417724609
local_in_edges_tensor generation:  0.0008172988891601562
mini_batch_src_global generation:  0.0009837150573730469
r_  generation:  0.011630058288574219
local_output_nid generation:  0.0007035732269287109
local_in_edges_tensor generation:  0.0010993480682373047
mini_batch_src_global generation:  0.0010313987731933594
r_  generation:  0.013894319534301758
local_output_nid generation:  0.00035262107849121094
local_in_edges_tensor generation:  0.0005435943603515625
mini_batch_src_global generation:  0.0008051395416259766
r_  generation:  0.007423877716064453
local_output_nid generation:  0.0002779960632324219
local_in_edges_tensor generation:  0.0004961490631103516
mini_batch_src_global generation:  0.0005562305450439453
r_  generation:  0.0052700042724609375
local_output_nid generation:  0.0005071163177490234
local_in_edges_tensor generation:  0.0007779598236083984
mini_batch_src_global generation:  0.0009984970092773438
r_  generation:  0.011901378631591797
local_output_nid generation:  0.00044727325439453125
local_in_edges_tensor generation:  0.0007486343383789062
mini_batch_src_global generation:  0.0009629726409912109
r_  generation:  0.011169910430908203
local_output_nid generation:  0.0003619194030761719
local_in_edges_tensor generation:  0.0006392002105712891
mini_batch_src_global generation:  0.0008680820465087891
r_  generation:  0.007876396179199219
local_output_nid generation:  0.000408172607421875
local_in_edges_tensor generation:  0.0007462501525878906
mini_batch_src_global generation:  0.000946044921875
r_  generation:  0.010464668273925781
local_output_nid generation:  0.0003685951232910156
local_in_edges_tensor generation:  0.0008711814880371094
mini_batch_src_global generation:  0.0009360313415527344
r_  generation:  0.009215831756591797
local_output_nid generation:  0.0003666877746582031
local_in_edges_tensor generation:  0.0007290840148925781
mini_batch_src_global generation:  0.00115966796875
r_  generation:  0.01101374626159668
local_output_nid generation:  0.0006463527679443359
local_in_edges_tensor generation:  0.0016062259674072266
mini_batch_src_global generation:  0.0011417865753173828
r_  generation:  0.014709234237670898
----------------------check_connections_block total spend ----------------------------- 0.22205758094787598
generate_one_block  0.007986307144165039
generate_one_block  0.014000415802001953
generate_one_block  0.016416072845458984
generate_one_block  0.013967752456665039
generate_one_block  0.014262199401855469
generate_one_block  0.01809382438659668
generate_one_block  0.01166224479675293
generate_one_block  0.007822513580322266
generate_one_block  0.015741825103759766
generate_one_block  0.015957117080688477
generate_one_block  0.012360572814941406
generate_one_block  0.01410222053527832
generate_one_block  0.013760566711425781
generate_one_block  0.015224695205688477
generate_one_block  0.0200960636138916
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

connection checking time:  0.3162224292755127
block generation total time  0.3337743282318115
average batch blocks generation time:  0.022251621882120768
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.02025747299194336  GigaBytes
Max Memory Allocated: 0.02025747299194336  GigaBytes

torch.Size([6726, 500])
torch.Size([1951, 16])
torch.Size([345, 16])
torch.Size([95, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.4860348701477051  GigaBytes
Max Memory Allocated: 0.5175199508666992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.03826093673706055  GigaBytes
Max Memory Allocated: 0.5175199508666992  GigaBytes

torch.Size([12201, 500])
torch.Size([4999, 16])
torch.Size([1476, 16])
torch.Size([206, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 1.1125898361206055  GigaBytes
Max Memory Allocated: 1.1810569763183594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3865966796875 GB
    Memory Allocated: 0.03599119186401367  GigaBytes
Max Memory Allocated: 1.1810569763183594  GigaBytes

torch.Size([11007, 500])
torch.Size([3975, 16])
torch.Size([736, 16])
torch.Size([96, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5487060546875 GB
    Memory Allocated: 1.068000316619873  GigaBytes
Max Memory Allocated: 1.1810569763183594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5487060546875 GB
    Memory Allocated: 0.033658504486083984  GigaBytes
Max Memory Allocated: 1.1810569763183594  GigaBytes

torch.Size([9762, 500])
torch.Size([4350, 16])
torch.Size([757, 16])
torch.Size([199, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5487060546875 GB
    Memory Allocated: 0.9938802719116211  GigaBytes
Max Memory Allocated: 1.1810569763183594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5487060546875 GB
    Memory Allocated: 0.03715705871582031  GigaBytes
Max Memory Allocated: 1.1810569763183594  GigaBytes

torch.Size([11615, 500])
torch.Size([5715, 16])
torch.Size([1416, 16])
torch.Size([289, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5487060546875 GB
    Memory Allocated: 1.0716853141784668  GigaBytes
Max Memory Allocated: 1.1810569763183594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5487060546875 GB
    Memory Allocated: 0.039623260498046875  GigaBytes
Max Memory Allocated: 1.1810569763183594  GigaBytes

torch.Size([12892, 500])
torch.Size([7659, 16])
torch.Size([1665, 16])
torch.Size([371, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 1.2802271842956543  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.029695987701416016  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

torch.Size([7437, 500])
torch.Size([3086, 16])
torch.Size([570, 16])
torch.Size([78, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.821009635925293  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.027899742126464844  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

torch.Size([6750, 500])
torch.Size([2815, 16])
torch.Size([449, 16])
torch.Size([127, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.5521025657653809  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.03592252731323242  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

torch.Size([10934, 500])
torch.Size([5515, 16])
torch.Size([938, 16])
torch.Size([208, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 1.2001628875732422  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.03506278991699219  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

torch.Size([10478, 500])
torch.Size([4805, 16])
torch.Size([913, 16])
torch.Size([152, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 1.141016960144043  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.03156566619873047  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

torch.Size([8666, 500])
torch.Size([3699, 16])
torch.Size([583, 16])
torch.Size([144, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.8585600852966309  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.031755924224853516  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

torch.Size([8682, 500])
torch.Size([4542, 16])
torch.Size([1522, 16])
torch.Size([297, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 1.0632667541503906  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.03118896484375  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

torch.Size([8212, 500])
torch.Size([4382, 16])
torch.Size([1449, 16])
torch.Size([329, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.9858546257019043  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.035626888275146484  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

torch.Size([10789, 500])
torch.Size([4261, 16])
torch.Size([964, 16])
torch.Size([89, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 1.1453628540039062  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.04061126708984375  GigaBytes
Max Memory Allocated: 1.3634185791015625  GigaBytes

torch.Size([13406, 500])
torch.Size([6823, 16])
torch.Size([1326, 16])
torch.Size([259, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.4505605697631836  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00932780901590983 |0.023888667424519856 |0.24083825747172039 |0.00014479955037434897 |0.26215647061665853 |0.011587142944335938 |
----------------------------------------------------------pseudo_mini_loss sum 1.8871828317642212
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  236539
Number of first layer input nodes during this epoch:  149557
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.05734968185424805  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005769729614257812
random selection method range initialization spend 0.00014162063598632812
time for parepare:  7.748603820800781e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.7881393432617188e-05
----------------------check_connections_block total spend ----------------------------- 0.003147602081298828
generate_one_block  0.0015528202056884766
generate_one_block  0.0011074542999267578
generate_one_block  0.0010647773742675781
generate_one_block  0.0010538101196289062
generate_one_block  0.0010437965393066406
generate_one_block  0.001049041748046875
generate_one_block  0.0011775493621826172
generate_one_block  0.0010547637939453125
generate_one_block  0.0010609626770019531
generate_one_block  0.0010571479797363281
generate_one_block  0.0010633468627929688
generate_one_block  0.0010180473327636719
generate_one_block  0.0009672641754150391
generate_one_block  0.0009911060333251953
generate_one_block  0.0009679794311523438
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000698089599609375
gen group dst list time:  9.083747863769531e-05
time for parepare:  0.0003516674041748047
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00020885467529296875
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00012493133544921875
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0001983642578125
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  8.749961853027344e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00022649765014648438
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00010085105895996094
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00021266937255859375
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  7.319450378417969e-05
----------------------check_connections_block total spend ----------------------------- 0.005270242691040039
generate_one_block  0.001383066177368164
generate_one_block  0.001157999038696289
generate_one_block  0.0011415481567382812
generate_one_block  0.0012302398681640625
generate_one_block  0.0010876655578613281
generate_one_block  0.001157522201538086
generate_one_block  0.0012290477752685547
generate_one_block  0.0010781288146972656
generate_one_block  0.0013229846954345703
generate_one_block  0.001058340072631836
generate_one_block  0.0012555122375488281
generate_one_block  0.001073598861694336
generate_one_block  0.0010178089141845703
generate_one_block  0.001188039779663086
generate_one_block  0.0010356903076171875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001336812973022461
gen group dst list time:  0.0001537799835205078
time for parepare:  0.0010256767272949219
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.0004405975341796875
mini_batch_src_global generation:  0.0001494884490966797
r_  generation:  0.000997304916381836
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.00032019615173339844
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0002913475036621094
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  8.845329284667969e-05
r_  generation:  0.0006203651428222656
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00016117095947265625
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0003037452697753906
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  0.00010752677917480469
r_  generation:  0.0010023117065429688
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.00016188621520996094
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.0015139579772949219
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.0004444122314453125
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.0018372535705566406
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  0.00010561943054199219
r_  generation:  0.0004649162292480469
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00024008750915527344
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.00010514259338378906
r_  generation:  0.0010917186737060547
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.00035071372985839844
----------------------check_connections_block total spend ----------------------------- 0.018851518630981445
generate_one_block  0.0024559497833251953
generate_one_block  0.0014541149139404297
generate_one_block  0.001293182373046875
generate_one_block  0.001817941665649414
generate_one_block  0.0011284351348876953
generate_one_block  0.0013232231140136719
generate_one_block  0.0022182464599609375
generate_one_block  0.0011217594146728516
generate_one_block  0.002893686294555664
generate_one_block  0.001461029052734375
generate_one_block  0.0033566951751708984
generate_one_block  0.0014886856079101562
generate_one_block  0.0012226104736328125
generate_one_block  0.002341032028198242
generate_one_block  0.0021126270294189453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002061605453491211
gen group dst list time:  0.00040411949157714844
time for parepare:  0.0018010139465332031
local_output_nid generation:  0.000225067138671875
local_in_edges_tensor generation:  0.0009524822235107422
mini_batch_src_global generation:  0.0006194114685058594
r_  generation:  0.00493168830871582
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.00023818016052246094
mini_batch_src_global generation:  0.0003218650817871094
r_  generation:  0.0018451213836669922
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  0.00017142295837402344
r_  generation:  0.0014040470123291016
local_output_nid generation:  0.0001380443572998047
local_in_edges_tensor generation:  0.0003407001495361328
mini_batch_src_global generation:  0.00034928321838378906
r_  generation:  0.004016876220703125
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  0.00016736984252929688
r_  generation:  0.0007071495056152344
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.00012636184692382812
r_  generation:  0.0012531280517578125
local_output_nid generation:  0.0001811981201171875
local_in_edges_tensor generation:  0.00037169456481933594
mini_batch_src_global generation:  0.0004532337188720703
r_  generation:  0.00559687614440918
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  0.0002090930938720703
r_  generation:  0.0007524490356445312
local_output_nid generation:  0.0001900196075439453
local_in_edges_tensor generation:  0.0003743171691894531
mini_batch_src_global generation:  0.00046443939208984375
r_  generation:  0.0057027339935302734
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.00023746490478515625
mini_batch_src_global generation:  0.0003674030303955078
r_  generation:  0.002301931381225586
local_output_nid generation:  0.0002613067626953125
local_in_edges_tensor generation:  0.00044608116149902344
mini_batch_src_global generation:  0.0006496906280517578
r_  generation:  0.00733184814453125
local_output_nid generation:  7.343292236328125e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  0.0003750324249267578
r_  generation:  0.002474546432495117
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.000171661376953125
r_  generation:  0.0011870861053466797
local_output_nid generation:  0.00018453598022460938
local_in_edges_tensor generation:  0.00036406517028808594
mini_batch_src_global generation:  0.00034880638122558594
r_  generation:  0.004192352294921875
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.0014777183532714844
----------------------check_connections_block total spend ----------------------------- 0.0710139274597168
generate_one_block  0.008767366409301758
generate_one_block  0.003678560256958008
generate_one_block  0.002849578857421875
generate_one_block  0.006340503692626953
generate_one_block  0.0019986629486083984
generate_one_block  0.0027551651000976562
generate_one_block  0.008793354034423828
generate_one_block  0.0019745826721191406
generate_one_block  0.009279727935791016
generate_one_block  0.0044786930084228516
generate_one_block  0.011065006256103516
generate_one_block  0.005122661590576172
generate_one_block  0.002666473388671875
generate_one_block  0.006776571273803711
generate_one_block  0.0029108524322509766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002295255661010742
gen group dst list time:  0.0016314983367919922
time for parepare:  0.0019385814666748047
local_output_nid generation:  0.0009529590606689453
local_in_edges_tensor generation:  0.0021066665649414062
mini_batch_src_global generation:  0.0012359619140625
r_  generation:  0.013438701629638672
local_output_nid generation:  0.0003895759582519531
local_in_edges_tensor generation:  0.0007011890411376953
mini_batch_src_global generation:  0.001035451889038086
r_  generation:  0.007397651672363281
local_output_nid generation:  0.0002593994140625
local_in_edges_tensor generation:  0.0004470348358154297
mini_batch_src_global generation:  0.0005049705505371094
r_  generation:  0.004239797592163086
local_output_nid generation:  0.0005357265472412109
local_in_edges_tensor generation:  0.0007641315460205078
mini_batch_src_global generation:  0.0008995532989501953
r_  generation:  0.011925220489501953
local_output_nid generation:  0.00022339820861816406
local_in_edges_tensor generation:  0.0003902912139892578
mini_batch_src_global generation:  0.0005886554718017578
r_  generation:  0.004552364349365234
local_output_nid generation:  0.0003204345703125
local_in_edges_tensor generation:  0.0004930496215820312
mini_batch_src_global generation:  0.0005507469177246094
r_  generation:  0.0056231021881103516
local_output_nid generation:  0.00075531005859375
local_in_edges_tensor generation:  0.0009424686431884766
mini_batch_src_global generation:  0.001234292984008789
r_  generation:  0.014893054962158203
local_output_nid generation:  0.0001933574676513672
local_in_edges_tensor generation:  0.0003635883331298828
mini_batch_src_global generation:  0.0005710124969482422
r_  generation:  0.0033431053161621094
local_output_nid generation:  0.0008406639099121094
local_in_edges_tensor generation:  0.0009405612945556641
mini_batch_src_global generation:  0.0009255409240722656
r_  generation:  0.014946699142456055
local_output_nid generation:  0.0005445480346679688
local_in_edges_tensor generation:  0.0006496906280517578
mini_batch_src_global generation:  0.0009794235229492188
r_  generation:  0.008269071578979492
local_output_nid generation:  0.0008487701416015625
local_in_edges_tensor generation:  0.0010793209075927734
mini_batch_src_global generation:  0.0014462471008300781
r_  generation:  0.017258405685424805
local_output_nid generation:  0.0005753040313720703
local_in_edges_tensor generation:  0.0007572174072265625
mini_batch_src_global generation:  0.0010972023010253906
r_  generation:  0.009172916412353516
local_output_nid generation:  0.0003218650817871094
local_in_edges_tensor generation:  0.0004570484161376953
mini_batch_src_global generation:  0.000797271728515625
r_  generation:  0.005720853805541992
local_output_nid generation:  0.0007646083831787109
local_in_edges_tensor generation:  0.0009093284606933594
mini_batch_src_global generation:  0.0010957717895507812
r_  generation:  0.013582944869995117
local_output_nid generation:  0.0003116130828857422
local_in_edges_tensor generation:  0.0004696846008300781
mini_batch_src_global generation:  0.0007638931274414062
r_  generation:  0.006265163421630859
----------------------check_connections_block total spend ----------------------------- 0.21064376831054688
generate_one_block  0.018357038497924805
generate_one_block  0.012629985809326172
generate_one_block  0.00720524787902832
generate_one_block  0.015276908874511719
generate_one_block  0.007229804992675781
generate_one_block  0.009373664855957031
generate_one_block  0.01929640769958496
generate_one_block  0.006777286529541016
generate_one_block  0.02066516876220703
generate_one_block  0.013355016708374023
generate_one_block  0.021686553955078125
generate_one_block  0.014097929000854492
generate_one_block  0.009469747543334961
generate_one_block  0.017976760864257812
generate_one_block  0.010256767272949219
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.05734968185424805  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

connection checking time:  0.30577945709228516
block generation total time  0.3282184600830078
average batch blocks generation time:  0.021881230672200522
block dataloader generation time/epoch 0.8219811916351318
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.05507850646972656  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

torch.Size([12586, 500])
torch.Size([7433, 16])
torch.Size([1554, 16])
torch.Size([356, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.2536673545837402  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.04706907272338867  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

torch.Size([8292, 500])
torch.Size([3160, 16])
torch.Size([455, 16])
torch.Size([124, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.8240251541137695  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.04179239273071289  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

torch.Size([5612, 500])
torch.Size([1994, 16])
torch.Size([417, 16])
torch.Size([108, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.4493904113769531  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.05202913284301758  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

torch.Size([10969, 500])
torch.Size([4723, 16])
torch.Size([1160, 16])
torch.Size([143, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.170541763305664  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.04241514205932617  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

torch.Size([5956, 500])
torch.Size([1625, 16])
torch.Size([203, 16])
torch.Size([57, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.4478940963745117  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.04700136184692383  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

torch.Size([8208, 500])
torch.Size([2384, 16])
torch.Size([525, 16])
torch.Size([127, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.6026806831359863  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.05415201187133789  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

torch.Size([12042, 500])
torch.Size([6692, 16])
torch.Size([1672, 16])
torch.Size([275, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.442415714263916  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.04011869430541992  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

torch.Size([4571, 500])
torch.Size([1354, 16])
torch.Size([220, 16])
torch.Size([55, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.3541097640991211  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.054163455963134766  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

torch.Size([11691, 500])
torch.Size([6647, 16])
torch.Size([1792, 16])
torch.Size([384, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.3826241493225098  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.04811859130859375  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

torch.Size([8928, 500])
torch.Size([4154, 16])
torch.Size([650, 16])
torch.Size([166, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.9137606620788574  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.05833101272583008  GigaBytes
Max Memory Allocated: 1.5445160865783691  GigaBytes

torch.Size([14214, 500])
torch.Size([7669, 16])
torch.Size([2423, 16])
torch.Size([383, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1072998046875 GB
    Memory Allocated: 1.680248737335205  GigaBytes
Max Memory Allocated: 1.7751736640930176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1072998046875 GB
    Memory Allocated: 0.04981231689453125  GigaBytes
Max Memory Allocated: 1.7751736640930176  GigaBytes

torch.Size([9828, 500])
torch.Size([4358, 16])
torch.Size([684, 16])
torch.Size([177, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1072998046875 GB
    Memory Allocated: 0.9740033149719238  GigaBytes
Max Memory Allocated: 1.7751736640930176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1072998046875 GB
    Memory Allocated: 0.04504823684692383  GigaBytes
Max Memory Allocated: 1.7751736640930176  GigaBytes

torch.Size([7063, 500])
torch.Size([2086, 16])
torch.Size([346, 16])
torch.Size([87, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1072998046875 GB
    Memory Allocated: 0.6088604927062988  GigaBytes
Max Memory Allocated: 1.7751736640930176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1072998046875 GB
    Memory Allocated: 0.05621194839477539  GigaBytes
Max Memory Allocated: 1.7751736640930176  GigaBytes
Using backend: pytorch

torch.Size([13189, 500])
torch.Size([6205, 16])
torch.Size([1716, 16])
torch.Size([349, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1072998046875 GB
    Memory Allocated: 1.3057103157043457  GigaBytes
Max Memory Allocated: 1.7751736640930176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1072998046875 GB
    Memory Allocated: 0.04385185241699219  GigaBytes
Max Memory Allocated: 1.7751736640930176  GigaBytes

torch.Size([6690, 500])
torch.Size([2249, 16])
torch.Size([452, 16])
torch.Size([111, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1072998046875 GB
    Memory Allocated: 0.6345701217651367  GigaBytes
Max Memory Allocated: 1.7751736640930176  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009183772404988607 |0.002269633611043294 |0.20397413571675618 |0.0001354535420735677 |0.2529844919840495 |0.009829044342041016 |
----------------------------------------------------------pseudo_mini_loss sum 1.7304102182388306
Total (block generation + training)time/epoch 7.894183874130249
Training time/epoch 7.071903228759766
Training time without block to device /epoch 7.037858724594116
Training time without total dataloading part /epoch 6.8662402629852295
load block tensor time/epoch 0.1377565860748291
block to device time/epoch 0.034044504165649414
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  220100
Number of first layer input nodes during this epoch:  139839
