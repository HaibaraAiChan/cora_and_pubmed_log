main start at this time 1648532231.5767345
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0016071796417236328
random selection method range initialization spend 0.0001914501190185547
time for parepare:  5.984306335449219e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0017383098602294922
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.173683166503906e-05
----------------------check_connections_block total spend ----------------------------- 0.0029478073120117188
generate_one_block  0.0014619827270507812
generate_one_block  0.001316070556640625
generate_one_block  0.0012612342834472656
generate_one_block  0.0013034343719482422
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010116100311279297
gen group dst list time:  4.2438507080078125e-05
time for parepare:  0.000308990478515625
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0003018379211425781
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0004208087921142578
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0002651214599609375
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0005564689636230469
----------------------check_connections_block total spend ----------------------------- 0.003328561782836914
generate_one_block  0.001672506332397461
generate_one_block  0.0018520355224609375
generate_one_block  0.0016009807586669922
generate_one_block  0.001971006393432617
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001233816146850586
gen group dst list time:  9.608268737792969e-05
time for parepare:  0.0009357929229736328
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.0003325939178466797
mini_batch_src_global generation:  0.0001823902130126953
r_  generation:  0.0017199516296386719
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.00028634071350097656
mini_batch_src_global generation:  0.00030422210693359375
r_  generation:  0.002614259719848633
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.0002524852752685547
mini_batch_src_global generation:  0.00022029876708984375
r_  generation:  0.0018410682678222656
local_output_nid generation:  9.465217590332031e-05
local_in_edges_tensor generation:  0.0002970695495605469
mini_batch_src_global generation:  0.00037407875061035156
r_  generation:  0.0035822391510009766
----------------------check_connections_block total spend ----------------------------- 0.01619100570678711
generate_one_block  0.003111600875854492
generate_one_block  0.0034477710723876953
generate_one_block  0.0027675628662109375
generate_one_block  0.005514860153198242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023043155670166016
gen group dst list time:  0.0003180503845214844
time for parepare:  0.0018661022186279297
local_output_nid generation:  0.0002815723419189453
local_in_edges_tensor generation:  0.0008089542388916016
mini_batch_src_global generation:  0.0010385513305664062
r_  generation:  0.00928497314453125
local_output_nid generation:  0.0004210472106933594
local_in_edges_tensor generation:  0.0008363723754882812
mini_batch_src_global generation:  0.0013303756713867188
r_  generation:  0.012097358703613281
local_output_nid generation:  0.00035500526428222656
local_in_edges_tensor generation:  0.0007915496826171875
mini_batch_src_global generation:  0.0008914470672607422
r_  generation:  0.007948637008666992
local_output_nid generation:  0.00043320655822753906
local_in_edges_tensor generation:  0.00164794921875
mini_batch_src_global generation:  0.001355886459350586
r_  generation:  0.012871980667114258
----------------------check_connections_block total spend ----------------------------- 0.06613612174987793
generate_one_block  0.01923227310180664
generate_one_block  0.017200231552124023
generate_one_block  0.015107393264770508
generate_one_block  0.01700758934020996
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0024750232696533203
gen group dst list time:  0.0011816024780273438
time for parepare:  0.0022668838500976562
local_output_nid generation:  0.0011928081512451172
local_in_edges_tensor generation:  0.002089262008666992
mini_batch_src_global generation:  0.002140522003173828
r_  generation:  0.019518375396728516
local_output_nid generation:  0.0011601448059082031
local_in_edges_tensor generation:  0.002186298370361328
mini_batch_src_global generation:  0.002567768096923828
r_  generation:  0.021335124969482422
local_output_nid generation:  0.0010409355163574219
local_in_edges_tensor generation:  0.0015492439270019531
mini_batch_src_global generation:  0.0016748905181884766
r_  generation:  0.019042253494262695
local_output_nid generation:  0.0010547637939453125
local_in_edges_tensor generation:  0.0017502307891845703
mini_batch_src_global generation:  0.0017962455749511719
r_  generation:  0.01963353157043457
----------------------check_connections_block total spend ----------------------------- 0.12096190452575684
generate_one_block  0.023929834365844727
generate_one_block  0.028429269790649414
generate_one_block  0.024495363235473633
generate_one_block  0.027126789093017578
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

connection checking time:  0.2066175937652588
block generation total time  0.19446706771850586
average batch blocks generation time:  0.048616766929626465
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1326904296875 GB
    Memory Allocated: 0.03824758529663086  GigaBytes
Max Memory Allocated: 0.03824758529663086  GigaBytes

torch.Size([16108, 500])
torch.Size([9247, 16])
torch.Size([2572, 16])
torch.Size([512, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 1.8265857696533203  GigaBytes
Max Memory Allocated: 1.941330909729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2010498046875 GB
    Memory Allocated: 0.048078060150146484  GigaBytes
Max Memory Allocated: 1.941330909729004  GigaBytes

torch.Size([16774, 500])
torch.Size([12175, 16])
torch.Size([3440, 16])
torch.Size([815, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4217529296875 GB
    Memory Allocated: 2.042921543121338  GigaBytes
Max Memory Allocated: 2.1698403358459473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4217529296875 GB
    Memory Allocated: 0.04490804672241211  GigaBytes
Max Memory Allocated: 2.1698403358459473  GigaBytes

torch.Size([15129, 500])
torch.Size([9908, 16])
torch.Size([2409, 16])
torch.Size([588, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 1.829183578491211  GigaBytes
Max Memory Allocated: 2.1698403358459473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4276123046875 GB
    Memory Allocated: 0.04669761657714844  GigaBytes
Max Memory Allocated: 2.1698403358459473  GigaBytes

torch.Size([16014, 500])
torch.Size([10260, 16])
torch.Size([3675, 16])
torch.Size([895, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4334716796875 GB
    Memory Allocated: 1.9351415634155273  GigaBytes
Max Memory Allocated: 2.1698403358459473  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013861477375030518 |0.08736109733581543 |0.3985915184020996 |0.00015997886657714844 |0.3303146958351135 |0.01159214973449707 |
----------------------------------------------------------pseudo_mini_loss sum 1.5791370868682861
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  120878
Number of first layer input nodes during this epoch:  64025
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4334716796875 GB
    Memory Allocated: 0.0637059211730957  GigaBytes
Max Memory Allocated: 2.1698403358459473  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006270408630371094
random selection method range initialization spend 0.00014472007751464844
time for parepare:  7.295608520507812e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00022292137145996094
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  6.127357482910156e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.863739013671875e-05
----------------------check_connections_block total spend ----------------------------- 0.0012936592102050781
generate_one_block  0.0014684200286865234
generate_one_block  0.0013141632080078125
generate_one_block  0.0013277530670166016
generate_one_block  0.0013158321380615234
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006661415100097656
gen group dst list time:  4.38690185546875e-05
time for parepare:  0.00034546852111816406
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0002315044403076172
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.00038242340087890625
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0002930164337158203
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0005586147308349609
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0004134178161621094
----------------------check_connections_block total spend ----------------------------- 0.0036611557006835938
generate_one_block  0.0020933151245117188
generate_one_block  0.0016980171203613281
generate_one_block  0.0021390914916992188
generate_one_block  0.0018661022186279297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012311935424804688
gen group dst list time:  0.00012302398681640625
time for parepare:  0.0010251998901367188
local_output_nid generation:  0.00010657310485839844
local_in_edges_tensor generation:  0.0003597736358642578
mini_batch_src_global generation:  0.0002498626708984375
r_  generation:  0.002183198928833008
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  0.0002582073211669922
r_  generation:  0.0019185543060302734
local_output_nid generation:  0.00012922286987304688
local_in_edges_tensor generation:  0.0003199577331542969
mini_batch_src_global generation:  0.0004107952117919922
r_  generation:  0.004006862640380859
local_output_nid generation:  8.726119995117188e-05
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.000270843505859375
r_  generation:  0.0018901824951171875
----------------------check_connections_block total spend ----------------------------- 0.016529560089111328
generate_one_block  0.0035805702209472656
generate_one_block  0.003142833709716797
generate_one_block  0.0055654048919677734
generate_one_block  0.0031778812408447266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002191781997680664
gen group dst list time:  0.0003421306610107422
time for parepare:  0.0015480518341064453
local_output_nid generation:  0.00030159950256347656
local_in_edges_tensor generation:  0.0007507801055908203
mini_batch_src_global generation:  0.0008795261383056641
r_  generation:  0.008949041366577148
local_output_nid generation:  0.00025773048400878906
local_in_edges_tensor generation:  0.0005235671997070312
mini_batch_src_global generation:  0.0010886192321777344
r_  generation:  0.007417440414428711
local_output_nid generation:  0.00034737586975097656
local_in_edges_tensor generation:  0.0006139278411865234
mini_batch_src_global generation:  0.0010571479797363281
r_  generation:  0.011594533920288086
local_output_nid generation:  0.0002639293670654297
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0008001327514648438
r_  generation:  0.006928920745849609
----------------------check_connections_block total spend ----------------------------- 0.05416059494018555
generate_one_block  0.013399600982666016
generate_one_block  0.011873722076416016
generate_one_block  0.01565694808959961
generate_one_block  0.011478900909423828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018346309661865234
gen group dst list time:  0.0008552074432373047
time for parepare:  0.0029489994049072266
local_output_nid generation:  0.0012023448944091797
local_in_edges_tensor generation:  0.001859426498413086
mini_batch_src_global generation:  0.0019066333770751953
r_  generation:  0.020207881927490234
local_output_nid generation:  0.000982046127319336
local_in_edges_tensor generation:  0.0013320446014404297
mini_batch_src_global generation:  0.0019297599792480469
r_  generation:  0.018088340759277344
local_output_nid generation:  0.0012497901916503906
local_in_edges_tensor generation:  0.0015597343444824219
mini_batch_src_global generation:  0.0018665790557861328
r_  generation:  0.020991802215576172
local_output_nid generation:  0.0010263919830322266
local_in_edges_tensor generation:  0.001264333724975586
mini_batch_src_global generation:  0.001657724380493164Using backend: pytorch

r_  generation:  0.021665334701538086
----------------------check_connections_block total spend ----------------------------- 0.1201326847076416
generate_one_block  0.031433820724487305
generate_one_block  0.030426740646362305
generate_one_block  0.029862642288208008
generate_one_block  0.03000783920288086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4334716796875 GB
    Memory Allocated: 0.0637059211730957  GigaBytes
Max Memory Allocated: 2.1698403358459473  GigaBytes

connection checking time:  0.19448399543762207
block generation total time  0.1974034309387207
average batch blocks generation time:  0.049350857734680176
block dataloader generation time/epoch 0.46216607093811035
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4334716796875 GB
    Memory Allocated: 0.063720703125  GigaBytes
Max Memory Allocated: 2.1698403358459473  GigaBytes

torch.Size([16298, 500])
torch.Size([11276, 16])
torch.Size([2967, 16])
torch.Size([688, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4334716796875 GB
    Memory Allocated: 1.9641141891479492  GigaBytes
Max Memory Allocated: 2.1698403358459473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4334716796875 GB
    Memory Allocated: 0.060286521911621094  GigaBytes
Max Memory Allocated: 2.1698403358459473  GigaBytes

torch.Size([14965, 500])
torch.Size([9139, 16])
torch.Size([2568, 16])
torch.Size([519, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4334716796875 GB
    Memory Allocated: 1.7710309028625488  GigaBytes
Max Memory Allocated: 2.1698403358459473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4334716796875 GB
    Memory Allocated: 0.06385993957519531  GigaBytes
Max Memory Allocated: 2.1698403358459473  GigaBytes

torch.Size([16298, 500])
torch.Size([11491, 16])
torch.Size([3906, 16])
torch.Size([948, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4549560546875 GB
    Memory Allocated: 2.05427885055542  GigaBytes
Max Memory Allocated: 2.1698403358459473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4549560546875 GB
    Memory Allocated: 0.061388492584228516  GigaBytes
Max Memory Allocated: 2.1698403358459473  GigaBytes

torch.Size([15564, 500])
torch.Size([9189, 16])
torch.Size([2540, 16])
torch.Size([653, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4549560546875 GB
    Memory Allocated: 1.809495449066162  GigaBytes
Max Memory Allocated: 2.1698403358459473  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010838866233825684 |0.0022833943367004395 |0.27199798822402954 |0.0001475214958190918 |0.3398035168647766 |0.010376691818237305 |
----------------------------------------------------------pseudo_mini_loss sum 1.5708019733428955
Total (block generation + training)time/epoch 2.9862985610961914
Training time/epoch 2.5238962173461914
Training time without block to device /epoch 2.5147626399993896
Training time without total dataloading part /epoch 2.4581727981567383
load block tensor time/epoch 0.043355464935302734
block to device time/epoch 0.009133577346801758
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  119366
Number of first layer input nodes during this epoch:  63125
