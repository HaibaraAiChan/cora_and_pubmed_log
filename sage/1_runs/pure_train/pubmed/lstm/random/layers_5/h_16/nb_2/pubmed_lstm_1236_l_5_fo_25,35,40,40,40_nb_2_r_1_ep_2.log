main start at this time 1648532206.5700598
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.002973318099975586
random selection method range initialization spend 0.00018358230590820312
time for parepare:  4.410743713378906e-05
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.001547098159790039
----------------------check_connections_block total spend ----------------------------- 0.001967191696166992
generate_one_block  0.0014290809631347656
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0014781951904296875
gen group dst list time:  2.0503997802734375e-05
time for parepare:  0.0002372264862060547
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.0011360645294189453
----------------------check_connections_block total spend ----------------------------- 0.0021190643310546875
generate_one_block  0.002748727798461914
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001010894775390625
gen group dst list time:  5.2928924560546875e-05
time for parepare:  0.0006811618804931641
local_output_nid generation:  0.00016832351684570312
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.0005726814270019531
r_  generation:  0.006668806076049805
----------------------check_connections_block total spend ----------------------------- 0.010673284530639648
generate_one_block  0.010303497314453125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019774436950683594
gen group dst list time:  0.0001380443572998047
time for parepare:  0.001280069351196289
local_output_nid generation:  0.0005638599395751953
local_in_edges_tensor generation:  0.00141143798828125
mini_batch_src_global generation:  0.0017485618591308594
r_  generation:  0.017363786697387695
----------------------check_connections_block total spend ----------------------------- 0.02742624282836914
generate_one_block  0.023419618606567383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020589828491210938
gen group dst list time:  0.00028896331787109375
time for parepare:  0.0015156269073486328
local_output_nid generation:  0.0010538101196289062
local_in_edges_tensor generation:  0.0025014877319335938
mini_batch_src_global generation:  0.0020782947540283203
r_  generation:  0.024315357208251953
----------------------check_connections_block total spend ----------------------------- 0.03789687156677246
generate_one_block  0.029557228088378906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

connection checking time:  0.07811546325683594
block generation total time  0.06602907180786133
average batch blocks generation time:  0.06602907180786133
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.04396390914916992  GigaBytes
Max Memory Allocated: 0.04396390914916992  GigaBytes

torch.Size([18578, 500])
torch.Size([16196, 16])
torch.Size([8105, 16])
torch.Size([2577, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8612060546875 GB
    Memory Allocated: 2.4271926879882812  GigaBytes
Max Memory Allocated: 2.5411577224731445  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013764142990112305 |0.34331822395324707 |0.8189973831176758 |0.0002887248992919922 |0.525437593460083 |0.014641523361206055 |
----------------------------------------------------------pseudo_mini_loss sum 1.7480467557907104
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  45810
Number of first layer input nodes during this epoch:  18578
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 0.06967639923095703  GigaBytes
Max Memory Allocated: 2.5411577224731445  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005156993865966797
random selection method range initialization spend 0.00013184547424316406
time for parepare:  5.125999450683594e-05
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00010824203491210938
----------------------check_connections_block total spend ----------------------------- 0.0005090236663818359
generate_one_block  0.0013968944549560547
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005638599395751953
gen group dst list time:  2.0265579223632812e-05
time for parepare:  0.0002562999725341797
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00023674964904785156
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.0011365413665771484
----------------------check_connections_block total spend ----------------------------- 0.002148151397705078
generate_one_block  0.003305196762084961
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010561943054199219
gen group dst list time:  5.9604644775390625e-05
time for parepare:  0.0007114410400390625
local_output_nid generation:  0.00018477439880371094
local_in_edges_tensor generation:  0.0005548000335693359
mini_batch_src_global generation:  0.0006427764892578125
r_  generation:  0.006803989410400391
----------------------check_connections_block total spend ----------------------------- 0.010877609252929688
generate_one_block  0.011718273162841797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020422935485839844
gen group dst list time:  0.0001499652862548828
time for parepare:  0.0013012886047363281
local_output_nid generation:  0.0005490779876708984
local_in_edges_tensor generation:  0.001415252685546875
mini_batch_src_global generation:  0.0016002655029296875
r_  generation:  0.01757502555847168
----------------------check_connections_block total spend ----------------------------- 0.027501821517944336
generate_one_block  0.026003360748291016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021004676818847656
gen group dst list time:  0.00032448768615722656
time for parepare:  0.0014290809631347656
local_output_nid generation:  0.0011534690856933594
local_in_edges_tensor generation:  0.002534627914428711
mini_batch_src_global generation:  0.0020227432250976562
r_  generation:  0.024356842041015625
----------------------check_connections_block total spend ----------------------------- 0.03774881362915039
generate_one_block  0.03545117378234863
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 0.06967639923095703  GigaBytes
Max Memory Allocated: 2.5411577224731445  GigaBytes

connection checking time:  0.07827639579772949
block generation total time  0.0764780044555664
average batch blocks generation time:  0.0764780044555664
block dataloader generation time/epoch 0.18601369857788086Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 0.06714296340942383  GigaBytes
Max Memory Allocated: 2.5411577224731445  GigaBytes

torch.Size([18638, 500])
torch.Size([16278, 16])
torch.Size([8145, 16])
torch.Size([2581, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 2.4561119079589844  GigaBytes
Max Memory Allocated: 2.5712242126464844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013586044311523438 |0.0015492439270019531 |0.3188629150390625 |0.0001480579376220703 |0.5359704494476318 |0.008509397506713867 |
----------------------------------------------------------pseudo_mini_loss sum 1.423174262046814
Total (block generation + training)time/epoch 1.0701344013214111
Training time/epoch 0.8837237358093262
Training time without block to device /epoch 0.8821744918823242
Training time without total dataloading part /epoch 0.8634908199310303
load block tensor time/epoch 0.013586044311523438
block to device time/epoch 0.0015492439270019531
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.1920928955078125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  45996
Number of first layer input nodes during this epoch:  18638
