main start at this time 1648532304.9591944
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007744789123535156  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0024242401123046875
random selection method range initialization spend 0.00022649765014648438
time for parepare:  4.673004150390625e-05
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0026137828826904297
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  7.486343383789062e-05
----------------------check_connections_block total spend ----------------------------- 0.0033516883850097656
generate_one_block  0.001377105712890625
generate_one_block  0.001130819320678711
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010826587677001953
gen group dst list time:  2.4557113647460938e-05
time for parepare:  0.00023365020751953125
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0005650520324707031
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0007245540618896484
----------------------check_connections_block total spend ----------------------------- 0.0024421215057373047
generate_one_block  0.0017795562744140625
generate_one_block  0.002006053924560547
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010752677917480469
gen group dst list time:  6.389617919921875e-05
time for parepare:  0.0007348060607910156
local_output_nid generation:  8.630752563476562e-05
local_in_edges_tensor generation:  0.0004088878631591797
mini_batch_src_global generation:  0.000263214111328125
r_  generation:  0.0033152103424072266
local_output_nid generation:  0.00012731552124023438
local_in_edges_tensor generation:  0.0003516674041748047
mini_batch_src_global generation:  0.0006024837493896484
r_  generation:  0.004825115203857422
----------------------check_connections_block total spend ----------------------------- 0.01293635368347168
generate_one_block  0.005323648452758789
generate_one_block  0.007032632827758789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021142959594726562
gen group dst list time:  0.00019073486328125
time for parepare:  0.0014231204986572266
local_output_nid generation:  0.000339508056640625
local_in_edges_tensor generation:  0.0010383129119873047
mini_batch_src_global generation:  0.001165151596069336
r_  generation:  0.01160430908203125
local_output_nid generation:  0.00046253204345703125
local_in_edges_tensor generation:  0.0009851455688476562
mini_batch_src_global generation:  0.0017120838165283203
r_  generation:  0.01569652557373047
----------------------check_connections_block total spend ----------------------------- 0.041326045989990234
generate_one_block  0.015633106231689453
generate_one_block  0.02216053009033203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018777847290039062
gen group dst list time:  0.0004951953887939453
time for parepare:  0.0015079975128173828
local_output_nid generation:  0.0010151863098144531
local_in_edges_tensor generation:  0.002048969268798828
mini_batch_src_global generation:  0.00176239013671875
r_  generation:  0.021179676055908203
local_output_nid generation:  0.0010657310485839844
local_in_edges_tensor generation:  0.0023899078369140625
mini_batch_src_global generation:  0.0027806758880615234
r_  generation:  0.02355051040649414
----------------------check_connections_block total spend ----------------------------- 0.06759357452392578
generate_one_block  0.02608346939086914
generate_one_block  0.030094385147094727
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007744789123535156  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

connection checking time:  0.124298095703125
block generation total time  0.11011338233947754
average batch blocks generation time:  0.05505669116973877
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1346435546875 GB
    Memory Allocated: 0.040331363677978516  GigaBytes
Max Memory Allocated: 0.040331363677978516  GigaBytes

torch.Size([17005, 500])
torch.Size([12430, 32])
torch.Size([4184, 32])
torch.Size([1117, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5682373046875 GB
    Memory Allocated: 2.163174629211426  GigaBytes
Max Memory Allocated: 2.2297916412353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5682373046875 GB
    Memory Allocated: 0.05036449432373047  GigaBytes
Max Memory Allocated: 2.2297916412353516  GigaBytes

torch.Size([18135, 500])
torch.Size([15009, 32])
torch.Size([6567, 32])
torch.Size([1676, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8572998046875 GB
    Memory Allocated: 2.4123902320861816  GigaBytes
Max Memory Allocated: 2.4606471061706543  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014216065406799316 |0.18116044998168945 |0.572645902633667 |0.00021600723266601562 |0.5151760578155518 |0.010164737701416016 |
----------------------------------------------------------pseudo_mini_loss sum 1.9156756401062012
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  76478
Number of first layer input nodes during this epoch:  35140
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8572998046875 GB
    Memory Allocated: 0.06856775283813477  GigaBytes
Max Memory Allocated: 2.4606471061706543  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005376338958740234
random selection method range initialization spend 0.00012087821960449219
time for parepare:  5.4836273193359375e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.389617919921875e-05
----------------------check_connections_block total spend ----------------------------- 0.0007109642028808594
generate_one_block  0.001199960708618164
generate_one_block  0.0011670589447021484
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005383491516113281
gen group dst list time:  3.0279159545898438e-05
time for parepare:  0.00026297569274902344
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  9.107589721679688e-05
r_  generation:  0.0006799697875976562
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation: Using backend: pytorch
 8.7738037109375e-05
r_  generation:  0.0006215572357177734
----------------------check_connections_block total spend ----------------------------- 0.0025882720947265625
generate_one_block  0.002155303955078125
generate_one_block  0.0019366741180419922
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010306835174560547
gen group dst list time:  7.510185241699219e-05
time for parepare:  0.0007162094116210938
local_output_nid generation:  0.0001437664031982422
local_in_edges_tensor generation:  0.0004265308380126953
mini_batch_src_global generation:  0.0003993511199951172
r_  generation:  0.004387855529785156
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.0002918243408203125
mini_batch_src_global generation:  0.0004303455352783203
r_  generation:  0.003828287124633789
----------------------check_connections_block total spend ----------------------------- 0.012883663177490234
generate_one_block  0.008369922637939453
generate_one_block  0.006207466125488281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020775794982910156
gen group dst list time:  0.00019073486328125
time for parepare:  0.0013256072998046875
local_output_nid generation:  0.00041222572326660156
local_in_edges_tensor generation:  0.0011358261108398438
mini_batch_src_global generation:  0.0011754035949707031
r_  generation:  0.013858556747436523
local_output_nid generation:  0.00042319297790527344
local_in_edges_tensor generation:  0.0008563995361328125
mini_batch_src_global generation:  0.0015377998352050781
r_  generation:  0.013963460922241211
----------------------check_connections_block total spend ----------------------------- 0.041608572006225586
generate_one_block  0.021032333374023438
generate_one_block  0.021116018295288086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001817464828491211
gen group dst list time:  0.0005047321319580078
time for parepare:  0.0014731884002685547
local_output_nid generation:  0.0010771751403808594
local_in_edges_tensor generation:  0.0022470951080322266
mini_batch_src_global generation:  0.0017728805541992188
r_  generation:  0.02240777015686035
local_output_nid generation:  0.0011343955993652344
local_in_edges_tensor generation:  0.002190113067626953
mini_batch_src_global generation:  0.002627134323120117
r_  generation:  0.023107051849365234
----------------------check_connections_block total spend ----------------------------- 0.06847643852233887
generate_one_block  0.03165745735168457
generate_one_block  0.031674861907958984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8572998046875 GB
    Memory Allocated: 0.06856775283813477  GigaBytes
Max Memory Allocated: 2.4606471061706543  GigaBytes

connection checking time:  0.12555694580078125
block generation total time  0.12415003776550293
average batch blocks generation time:  0.062075018882751465
block dataloader generation time/epoch 0.2935049533843994
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8572998046875 GB
    Memory Allocated: 0.06607389450073242  GigaBytes
Max Memory Allocated: 2.4606471061706543  GigaBytes

torch.Size([17428, 500])
torch.Size([13477, 32])
torch.Size([5187, 32])
torch.Size([1461, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8572998046875 GB
    Memory Allocated: 2.3018813133239746  GigaBytes
Max Memory Allocated: 2.4606471061706543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8572998046875 GB
    Memory Allocated: 0.0660543441772461  GigaBytes
Max Memory Allocated: 2.4606471061706543  GigaBytes

torch.Size([17813, 500])
torch.Size([14170, 32])
torch.Size([5467, 32])
torch.Size([1322, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8572998046875 GB
    Memory Allocated: 2.346121311187744  GigaBytes
Max Memory Allocated: 2.4606471061706543  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021072745323181152 |0.002192974090576172 |0.2980926036834717 |0.00014579296112060547 |0.5393295288085938 |0.009290695190429688 |
----------------------------------------------------------pseudo_mini_loss sum 1.4607784748077393
Total (block generation + training)time/epoch 2.0322206020355225
Training time/epoch 1.7382025718688965
Training time without block to device /epoch 1.7338166236877441
Training time without total dataloading part /epoch 1.6844265460968018
load block tensor time/epoch 0.042145490646362305
block to device time/epoch 0.004385948181152344
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  76680
Number of first layer input nodes during this epoch:  35241
