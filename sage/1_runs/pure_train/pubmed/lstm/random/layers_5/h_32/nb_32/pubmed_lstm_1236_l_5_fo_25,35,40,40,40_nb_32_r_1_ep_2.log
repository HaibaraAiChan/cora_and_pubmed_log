main start at this time 1648532353.4253738
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007744789123535156  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0018053054809570312
random selection method range initialization spend 0.00020360946655273438
time for parepare:  4.744529724121094e-05
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  0.0015807151794433594
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2411346435546875e-05
----------------------check_connections_block total spend ----------------------------- 0.004323720932006836
generate_one_block  0.0011909008026123047
generate_one_block  0.001010894775390625
generate_one_block  0.001027822494506836
generate_one_block  0.0009958744049072266
generate_one_block  0.0010411739349365234
generate_one_block  0.0010106563568115234
generate_one_block  0.0010082721710205078
generate_one_block  0.0010099411010742188
generate_one_block  0.0010035037994384766
generate_one_block  0.0010151863098144531
generate_one_block  0.000985860824584961
generate_one_block  0.0010013580322265625
generate_one_block  0.0009796619415283203
generate_one_block  0.0009417533874511719
generate_one_block  0.0009534358978271484
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012769699096679688
gen group dst list time:  8.034706115722656e-05
time for parepare:  0.0002655982971191406
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  5.626678466796875e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  8.821487426757812e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0002186298370361328
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  5.340576171875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.794929504394531e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00010251998901367188
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00014162063598632812
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  9.107589721679688e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00013756752014160156
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00020313262939453125
----------------------check_connections_block total spend ----------------------------- 0.004577159881591797
generate_one_block  0.001077890396118164
generate_one_block  0.0010504722595214844
generate_one_block  0.0010938644409179688
generate_one_block  0.0011377334594726562
generate_one_block  0.0011148452758789062
generate_one_block  0.0012879371643066406
generate_one_block  0.0010650157928466797
generate_one_block  0.00109100341796875
generate_one_block  0.0010845661163330078
generate_one_block  0.0011513233184814453
generate_one_block  0.001149892807006836
generate_one_block  0.0011169910430908203
generate_one_block  0.0011386871337890625
generate_one_block  0.0009799003601074219
generate_one_block  0.0012128353118896484
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012154579162597656
gen group dst list time:  0.00012302398681640625
time for parepare:  0.0007498264312744141
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0002644062042236328
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00015354156494140625
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0002040863037109375
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0002987384796142578
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0003180503845214844
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0005290508270263672
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.0016264915466308594
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.000232696533203125
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.0004012584686279297
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0002987384796142578
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.000789642333984375
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  9.584426879882812e-05
r_  generation:  0.00087738037109375
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  8.177757263183594e-05
r_  generation:  0.0006008148193359375
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0009365081787109375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.000209808349609375
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  0.00014400482177734375
r_  generation:  0.0016641616821289062
----------------------check_connections_block total spend ----------------------------- 0.016398191452026367
generate_one_block  0.0018825531005859375
generate_one_block  0.001207590103149414
generate_one_block  0.0014078617095947266
generate_one_block  0.00130462646484375
generate_one_block  0.0015687942504882812
generate_one_block  0.002947568893432617
generate_one_block  0.0011820793151855469
generate_one_block  0.0013899803161621094
generate_one_block  0.001249551773071289
generate_one_block  0.0019288063049316406
generate_one_block  0.0022737979888916016
generate_one_block  0.0016224384307861328
generate_one_block  0.0020432472229003906
generate_one_block  0.0011568069458007812
generate_one_block  0.0029637813568115234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020737648010253906
gen group dst list time:  0.0003101825714111328
time for parepare:  0.0016260147094726562
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00045299530029296875
mini_batch_src_global generation:  0.00016546249389648438
r_  generation:  0.001140594482421875
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  0.0001575946807861328
r_  generation:  0.0010590553283691406
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  0.00011849403381347656
r_  generation:  0.0011720657348632812
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  0.000209808349609375
r_  generation:  0.002015829086303711
local_output_nid generation:  9.226799011230469e-05
local_in_edges_tensor generation:  0.00029349327087402344
mini_batch_src_global generation:  0.00036835670471191406
r_  generation:  0.0030193328857421875
local_output_nid generation:  0.00015020370483398438
local_in_edges_tensor generation:  0.00039076805114746094
mini_batch_src_global generation:  0.0007092952728271484
r_  generation:  0.0059049129486083984
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  0.0002346038818359375
r_  generation:  0.001344919204711914
local_output_nid generation:  7.534027099609375e-05
local_in_edges_tensor generation:  0.00023889541625976562
mini_batch_src_global generation:  0.00021123886108398438
r_  generation:  0.002110719680786133
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  0.00015783309936523438
r_  generation:  0.0012111663818359375
local_output_nid generation:  0.0001304149627685547
local_in_edges_tensor generation:  0.0003261566162109375
mini_batch_src_global generation:  0.00036907196044921875
r_  generation:  0.004409313201904297
local_output_nid generation:  0.00011610984802246094
local_in_edges_tensor generation:  0.00032067298889160156
mini_batch_src_global generation:  0.0005509853363037109
r_  generation:  0.00452113151550293
local_output_nid generation:  8.702278137207031e-05
local_in_edges_tensor generation:  0.0002474784851074219
mini_batch_src_global generation:  0.0003695487976074219
r_  generation:  0.003239154815673828
local_output_nid generation:  0.00016498565673828125
local_in_edges_tensor generation:  0.00034999847412109375
mini_batch_src_global generation:  0.0004737377166748047
r_  generation:  0.005204916000366211
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.000244140625
r_  generation:  0.0013606548309326172
local_output_nid generation:  0.00016641616821289062
local_in_edges_tensor generation:  0.0003941059112548828
mini_batch_src_global generation:  0.0006139278411865234
r_  generation:  0.007010459899902344
----------------------check_connections_block total spend ----------------------------- 0.06893515586853027
generate_one_block  0.0030355453491210938
generate_one_block  0.002341032028198242
generate_one_block  0.0023245811462402344
generate_one_block  0.0034580230712890625
generate_one_block  0.0047779083251953125
generate_one_block  0.008815288543701172
generate_one_block  0.0025129318237304688
generate_one_block  0.003759622573852539
generate_one_block  0.002497434616088867
generate_one_block  0.007146596908569336
generate_one_block  0.00786733627319336
generate_one_block  0.005210399627685547
generate_one_block  0.007382392883300781
generate_one_block  0.002572774887084961
generate_one_block  0.010829448699951172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022275447845458984
gen group dst list time:  0.0015180110931396484
time for parepare:  0.0018620491027832031
local_output_nid generation:  0.0002617835998535156
local_in_edges_tensor generation:  0.0009152889251708984
mini_batch_src_global generation:  0.0006570816040039062
r_  generation:  0.0054628849029541016
local_output_nid generation:  0.0001900196075439453
local_in_edges_tensor generation:  0.00041031837463378906
mini_batch_src_global generation:  0.0005180835723876953
r_  generation:  0.004190921783447266
local_output_nid generation:  0.0002009868621826172
local_in_edges_tensor generation:  0.0004184246063232422
mini_batch_src_global generation:  0.00044465065002441406
r_  generation:  0.004794597625732422
local_output_nid generation:  0.00035762786865234375
local_in_edges_tensor generation:  0.0006284713745117188
mini_batch_src_global generation:  0.0008060932159423828
r_  generation:  0.00790095329284668
local_output_nid generation:  0.0004470348358154297
local_in_edges_tensor generation:  0.0007779598236083984
mini_batch_src_global generation:  0.0011858940124511719
r_  generation:  0.010730743408203125
local_output_nid generation:  0.0005388259887695312
local_in_edges_tensor generation:  0.0011124610900878906
mini_batch_src_global generation:  0.0011229515075683594
r_  generation:  0.012438297271728516
local_output_nid generation:  0.0002079010009765625
local_in_edges_tensor generation:  0.0004127025604248047
mini_batch_src_global generation:  0.0006971359252929688
r_  generation:  0.0054323673248291016
local_output_nid generation:  0.0003685951232910156
local_in_edges_tensor generation:  0.0006072521209716797
mini_batch_src_global generation:  0.0006513595581054688
r_  generation:  0.007460832595825195
local_output_nid generation:  0.00020694732666015625
local_in_edges_tensor generation:  0.00039958953857421875
mini_batch_src_global generation:  0.0005285739898681641
r_  generation:  0.0048601627349853516
local_output_nid generation:  0.0005810260772705078
local_in_edges_tensor generation:  0.0009226799011230469
mini_batch_src_global generation:  0.0011157989501953125
r_  generation:  0.013733625411987305
local_output_nid generation:  0.0006947517395019531
local_in_edges_tensor generation:  0.0013670921325683594
mini_batch_src_global generation:  0.0014619827270507812
r_  generation:  0.014635086059570312
local_output_nid generation:  0.0003781318664550781
local_in_edges_tensor generation:  0.0006115436553955078
mini_batch_src_global generation:  0.0010366439819335938
r_  generation:  0.00980997085571289
local_output_nid generation:  0.0005829334259033203
local_in_edges_tensor generation:  0.0009717941284179688
mini_batch_src_global generation:  0.0011475086212158203
r_  generation:  0.014612436294555664
local_output_nid generation:  0.00025534629821777344
local_in_edges_tensor generation:  0.000457763671875
mini_batch_src_global generation:  0.0007984638214111328
r_  generation:  0.006652355194091797
local_output_nid generation:  0.0006337165832519531
local_in_edges_tensor generation:  0.0009839534759521484
mini_batch_src_global generation:  0.001186370849609375
r_  generation:  0.015197277069091797
----------------------check_connections_block total spend ----------------------------- 0.20485949516296387
generate_one_block  0.008682489395141602
generate_one_block  0.005953788757324219
generate_one_block  0.007937908172607422
generate_one_block  0.011338949203491211
generate_one_block  0.014454126358032227
generate_one_block  0.016939401626586914
generate_one_block  0.0084381103515625
generate_one_block  0.0110015869140625
generate_one_block  0.007238864898681641
generate_one_block  0.018061399459838867
generate_one_block  0.019544363021850586
generate_one_block  0.01349949836730957
generate_one_block  0.020031452178955078
generate_one_block  0.010273456573486328
generate_one_block  0.019396305084228516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007744789123535156  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

connection checking time:  0.2947700023651123
block generation total time  0.31020545959472656
average batch blocks generation time:  0.020680363972981772
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.019012928009033203  GigaBytes
Max Memory Allocated: 0.019012928009033203  GigaBytes

torch.Size([5954, 500])
torch.Size([2012, 32])
torch.Size([287, 32])
torch.Size([58, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.5776581764221191  GigaBytes
Max Memory Allocated: 0.6120214462280273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.026384830474853516  GigaBytes
Max Memory Allocated: 0.6120214462280273  GigaBytes

torch.Size([5489, 500])
torch.Size([1848, 32])
torch.Size([318, 32])
torch.Size([93, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.42801523208618164  GigaBytes
Max Memory Allocated: 0.6120214462280273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.028688430786132812  GigaBytes
Max Memory Allocated: 0.6120214462280273  GigaBytes

torch.Size([6714, 500])
torch.Size([1943, 32])
torch.Size([507, 32])
torch.Size([134, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.5002131462097168  GigaBytes
Max Memory Allocated: 0.6120214462280273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.03326225280761719  GigaBytes
Max Memory Allocated: 0.6120214462280273  GigaBytes

torch.Size([9106, 500])
torch.Size([3643, 32])
torch.Size([538, 32])
torch.Size([123, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.8711690902709961  GigaBytes
Max Memory Allocated: 0.9207234382629395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.037285804748535156  GigaBytes
Max Memory Allocated: 0.9207234382629395  GigaBytes

torch.Size([11220, 500])
torch.Size([4929, 32])
torch.Size([915, 32])
torch.Size([188, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 1.107689380645752  GigaBytes
Max Memory Allocated: 1.1675810813903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.03627347946166992  GigaBytes
Max Memory Allocated: 1.1675810813903809  GigaBytes

torch.Size([10591, 500])
torch.Size([5902, 32])
torch.Size([1657, 32])
torch.Size([375, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 1.2960219383239746  GigaBytes
Max Memory Allocated: 1.3400254249572754  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.027934551239013672  GigaBytes
Max Memory Allocated: 1.3400254249572754  GigaBytes

torch.Size([6205, 500])
torch.Size([2035, 32])
torch.Size([362, 32])
torch.Size([87, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.608518123626709  GigaBytes
Max Memory Allocated: 1.3400254249572754  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.03468036651611328  GigaBytes
Max Memory Allocated: 1.3400254249572754  GigaBytes

torch.Size([9873, 500])
torch.Size([4003, 32])
torch.Size([797, 32])
torch.Size([146, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.815770149230957  GigaBytes
Max Memory Allocated: 1.3400254249572754  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.02960491180419922  GigaBytes
Max Memory Allocated: 1.3400254249572754  GigaBytes

torch.Size([7201, 500])
torch.Size([2176, 32])
torch.Size([543, 32])
torch.Size([126, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.5240106582641602  GigaBytes
Max Memory Allocated: 1.3400254249572754  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.04192924499511719  GigaBytes
Max Memory Allocated: 1.3400254249572754  GigaBytes

torch.Size([13650, 500])
torch.Size([6677, 32])
torch.Size([1661, 32])
torch.Size([249, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.389319896697998  GigaBytes
Max Memory Allocated: 1.4590044021606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 0.04154491424560547  GigaBytes
Max Memory Allocated: 1.4590044021606445  GigaBytes

torch.Size([13432, 500])
torch.Size([7795, 32])
torch.Size([1428, 32])
torch.Size([347, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8631591796875 GB
    Memory Allocated: 1.4520196914672852  GigaBytes
Max Memory Allocated: 1.5268745422363281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.03395795822143555  GigaBytes
Max Memory Allocated: 1.5268745422363281  GigaBytes

torch.Size([8988, 500])
torch.Size([4063, 32])
torch.Size([962, 32])
torch.Size([181, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 1.0191965103149414  GigaBytes
Max Memory Allocated: 1.5268745422363281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.04250001907348633  GigaBytes
Max Memory Allocated: 1.5268745422363281  GigaBytes

torch.Size([13932, 500])
torch.Size([6617, 32])
torch.Size([1766, 32])
torch.Size([298, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 1.5048127174377441  GigaBytes
Max Memory Allocated: 1.575864315032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.03381776809692383  GigaBytes
Max Memory Allocated: 1.575864315032959  GigaBytes

torch.Size([9154, 500])
torch.Size([2888, 32])
torch.Size([384, 32])
torch.Size([67, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.7206740379333496  GigaBytes
Max Memory Allocated: 1.575864315032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.040380001068115234  GigaBytes
Max Memory Allocated: 1.575864315032959  GigaBytes

torch.Size([12746, 500])
torch.Size([7632, 32])
torch.Size([2318, 32])
torch.Size([451, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 1.5442886352539062  GigaBytes
Max Memory Allocated: 1.5994477272033691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00926351547241211 |0.024327627817789712 |0.2353594462076823 |0.00014384587605794272 |0.2630608558654785 |0.011242389678955078 |
----------------------------------------------------------pseudo_mini_loss sum 2.1184024810791016
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  226141
Number of first layer input nodes during this epoch:  144255
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.057335853576660156  GigaBytes
Max Memory Allocated: 1.5994477272033691  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007326602935791016
random selection method range initialization spend 0.0001533031463623047
time for parepare:  7.534027099609375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.673004150390625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.1682510375976562e-05
----------------------check_connections_block total spend ----------------------------- 0.0031015872955322266
generate_one_block  0.0013895034790039062
generate_one_block  0.0011491775512695312
generate_one_block  0.0011019706726074219
generate_one_block  0.0010945796966552734
generate_one_block  0.0010578632354736328
generate_one_block  0.00107574462890625
generate_one_block  0.0011703968048095703
generate_one_block  0.0010304450988769531
generate_one_block  0.0010721683502197266
generate_one_block  0.0010693073272705078
generate_one_block  0.001068115234375
generate_one_block  0.0010383129119873047
generate_one_block  0.0010478496551513672
generate_one_block  0.0009980201721191406
generate_one_block  0.0009777545928955078
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007731914520263672
gen group dst list time:  0.00010800361633300781
time for parepare:  0.0003345012664794922
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  6.556510925292969e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00011515617370605469
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0002071857452392578
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00015282630920410156
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00012254714965820312
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  6.985664367675781e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00016570091247558594
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001239776611328125
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0001227855682373047
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00011754035949707031
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.151199340820312e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.528594970703125e-05
----------------------check_connections_block total spend ----------------------------- 0.005211353302001953
generate_one_block  0.0011830329895019531
generate_one_block  0.0012257099151611328
generate_one_block  0.0014178752899169922
generate_one_block  0.0013666152954101562
generate_one_block  0.001165628433227539
generate_one_block  0.0012555122375488281
generate_one_block  0.001119375228881836
generate_one_block  0.0011265277862548828
generate_one_block  0.0013053417205810547
generate_one_block  0.0011830329895019531
generate_one_block  0.0011796951293945312
generate_one_block  0.0011849403381347656
generate_one_block  0.001055002212524414
generate_one_block  0.0010385513305664062
generate_one_block  0.0010325908660888672
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012180805206298828
gen group dst list time:  0.00017118453979492188
time for parepare:  0.0009748935699462891
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00031876564025878906
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00024199485778808594
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  0.00010442733764648438
r_  generation:  0.0005998611450195312
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  0.0002646446228027344
r_  generation:  0.0015873908996582031
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  0.00015687942504882812
r_  generation:  0.0009775161743164062
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.00047278404235839844
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  9.417533874511719e-05
r_  generation:  0.0006809234619140625
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.0005419254302978516
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.00031828880310058594
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00015783309936523438
r_  generation:  0.001398324966430664
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.00011539459228515625
r_  generation:  0.0007634162902832031
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0005292892456054688
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0007152557373046875
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0002741813659667969
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0002651214599609375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00013899803161621094
----------------------check_connections_block total spend ----------------------------- 0.018436670303344727
generate_one_block  0.001699209213256836
generate_one_block  0.0019559860229492188
generate_one_block  0.003230571746826172
generate_one_block  0.002296924591064453
generate_one_block  0.0016717910766601562
generate_one_block  0.0019009113311767578
generate_one_block  0.0023479461669921875
generate_one_block  0.0014123916625976562
generate_one_block  0.002929210662841797
generate_one_block  0.001954317092895508
generate_one_block  0.0016481876373291016
generate_one_block  0.0020372867584228516
generate_one_block  0.001325368881225586
generate_one_block  0.001270294189453125
generate_one_block  0.0018391609191894531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021064281463623047
gen group dst list time:  0.0003936290740966797
time for parepare:  0.0016722679138183594
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0005278587341308594
mini_batch_src_global generation:  0.00015282630920410156
r_  generation:  0.0009801387786865234
local_output_nid generation:  0.00011563301086425781
local_in_edges_tensor generation:  0.00029921531677246094
mini_batch_src_global generation:  0.00040340423583984375
r_  generation:  0.002910614013671875
local_output_nid generation:  0.00018453598022460938
local_in_edges_tensor generation:  0.00043320655822753906
mini_batch_src_global generation:  0.0007619857788085938
r_  generation:  0.005582571029663086
local_output_nid generation:  0.00019240379333496094
local_in_edges_tensor generation:  0.00043129920959472656
mini_batch_src_global generation:  0.0005557537078857422
r_  generation:  0.0052073001861572266
local_output_nid generation:  0.0001468658447265625
local_in_edges_tensor generation:  0.0003402233123779297
mini_batch_src_global generation:  0.00046896934509277344
r_  generation:  0.0035178661346435547
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.0003066062927246094
mini_batch_src_global generation:  0.0003502368927001953
r_  generation:  0.0033690929412841797
local_output_nid generation:  0.0001049041748046875
local_in_edges_tensor generation:  0.00030684471130371094
mini_batch_src_global generation:  0.0003859996795654297
r_  generation:  0.0032105445861816406
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.00022459030151367188
r_  generation:  0.0015799999237060547
local_output_nid generation:  0.0002040863037109375
local_in_edges_tensor generation:  0.00040268898010253906
mini_batch_src_global generation:  0.0004944801330566406
r_  generation:  0.005696773529052734
local_output_nid generation:  0.0001323223114013672
local_in_edges_tensor generation:  0.00033664703369140625
mini_batch_src_global generation:  0.0005261898040771484
r_  generation:  0.003963470458984375
local_output_nid generation:  0.00010156631469726562
local_in_edges_tensor generation:  0.0002865791320800781
mini_batch_src_global generation:  0.0003108978271484375
r_  generation:  0.00240325927734375
local_output_nid generation:  0.00017833709716796875
local_in_edges_tensor generation:  0.00036978721618652344
mini_batch_src_global generation:  0.0003707408905029297
r_  generation:  0.003977060317993164
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.00021839141845703125
r_  generation:  0.0013153553009033203
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  0.00019478797912597656
r_  generation:  0.0017125606536865234
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  0.00013875961303710938
r_  generation:  0.0007708072662353516
----------------------check_connections_block total spend ----------------------------- 0.0723869800567627
generate_one_block  0.0032608509063720703
generate_one_block  0.005685091018676758
generate_one_block  0.008460760116577148
generate_one_block  0.008354663848876953
generate_one_block  0.0060346126556396484
generate_one_block  0.00759434700012207
generate_one_block  0.006059408187866211
generate_one_block  0.0032625198364257812
generate_one_block  0.008933782577514648
generate_one_block  0.007185935974121094
generate_one_block  0.004572153091430664
generate_one_block  0.007292747497558594
generate_one_block  0.0029294490814208984
generate_one_block  0.003638744354248047
generate_one_block  0.0021135807037353516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022628307342529297
gen group dst list time:  0.0017571449279785156
time for parepare:  0.0018954277038574219
local_output_nid generation:  0.0002846717834472656
local_in_edges_tensor generation:  0.0010533332824707031
mini_batch_src_global generation:  0.0004680156707763672
r_  generation:  0.0039196014404296875
local_output_nid generation:  0.0006301403045654297
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0011360645294189453
r_  generation:  0.009485244750976562
local_output_nid generation:  0.0005140304565429688
local_in_edges_tensor generation:  0.0008378028869628906
mini_batch_src_global generation:  0.001203298568725586
r_  generation:  0.01060175895690918
local_output_nid generation:  0.0008249282836914062
local_in_edges_tensor generation:  0.0011627674102783203
mini_batch_src_global generation:  0.0013544559478759766
r_  generation:  0.015006065368652344
local_output_nid generation:  0.0005533695220947266
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.0010993480682373047
r_  generation:  0.013605356216430664
local_output_nid generation:  0.0009741783142089844
local_in_edges_tensor generation:  0.0014874935150146484
mini_batch_src_global generation:  0.0018024444580078125
r_  generation:  0.011855363845825195
local_output_nid generation:  0.0005466938018798828
local_in_edges_tensor generation:  0.0008261203765869141
mini_batch_src_global generation:  0.0009524822235107422
r_  generation:  0.009392976760864258
local_output_nid generation:  0.00032591819763183594
local_in_edges_tensor generation:  0.0005898475646972656
mini_batch_src_global generation:  0.0006864070892333984
r_  generation:  0.006375312805175781
local_output_nid generation:  0.0006766319274902344
local_in_edges_tensor generation:  0.0008533000946044922
mini_batch_src_global generation:  0.0010366439819335938
r_  generation:  0.012711763381958008
local_output_nid generation:  0.0008635520935058594
local_in_edges_tensor generation:  0.0012853145599365234
mini_batch_src_global generation:  0.0011043548583984375
r_  generation:  0.01249837875366211
local_output_nid generation:  0.0005540847778320312
local_in_edges_tensor generation:  0.000701904296875
mini_batch_src_global generation:  0.0008175373077392578
r_  generation:  0.007884740829467773
local_output_nid generation:  0.0007004737854003906
local_in_edges_tensor generation:  0.0008854866027832031
mini_batch_src_global generation:  0.0010442733764648438
r_  generation:  0.012271404266357422
local_output_nid generation:  0.0003077983856201172
local_in_edges_tensor generation:  0.0007345676422119141
mini_batch_src_global generation:  0.0006952285766601562
r_  generation:  0.005563259124755859
local_output_nid generation:  0.0004115104675292969
local_in_edges_tensor generation:  0.0005974769592285156
mini_batch_src_global generation:  0.0006883144378662109
r_  generation:  0.007208347320556641
local_output_nid generation:  0.0002167224884033203
local_in_edges_tensor generation:  0.00043582916259765625
mini_batch_src_global generation:  0.0005254745483398438
r_  generation:  0.004575252532958984
----------------------check_connections_block total spend ----------------------------- 0.22028064727783203
generate_one_block  0.009940385818481445
generate_one_block  0.01431727409362793
generate_one_block  0.015339851379394531
generate_one_block  0.022347688674926758
generate_one_block  0.019845008850097656
generate_one_block  0.018913984298706055
generate_one_block  0.016692399978637695
generate_one_block  0.009818077087402344
generate_one_block  0.01907038688659668
generate_one_block  0.019841670989990234
generate_one_block  0.014885425567626953
generate_one_block  0.016156911849975586
generate_one_block  0.010978221893310547
generate_one_block  0.012211799621582031
generate_one_block  0.007340431213378906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.057335853576660156  GigaBytes
Max Memory Allocated: 1.5994477272033691  GigaBytes

connection checking time:  0.3163156509399414
block generation total time  0.36043715476989746
average batch blocks generation time:  0.0240291436513265
block dataloader generation time/epoch 0.8782467842102051
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.041472434997558594  GigaBytes
Max Memory Allocated: 1.5994477272033691  GigaBytes

torch.Size([4994, 500])
torch.Size([1841, 32])
torch.Size([295, 32])
torch.Size([113, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.40651941299438477  GigaBytes
Max Memory Allocated: 1.5994477272033691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.051896095275878906  GigaBytes
Max Memory Allocated: 1.5994477272033691  GigaBytes

torch.Size([10201, 500])
torch.Size([4804, 32])
torch.Size([852, 32])
torch.Size([223, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.9638972282409668  GigaBytes
Max Memory Allocated: 1.5994477272033691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.05008220672607422  GigaBytes
Max Memory Allocated: 1.5994477272033691  GigaBytes

torch.Size([8917, 500])
torch.Size([5018, 32])
torch.Size([1545, 32])
torch.Size([362, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 1.1207208633422852  GigaBytes
Max Memory Allocated: 1.5994477272033691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.057967185974121094  GigaBytes
Max Memory Allocated: 1.5994477272033691  GigaBytes

torch.Size([13634, 500])
torch.Size([7116, 32])
torch.Size([1654, 32])
torch.Size([323, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 1.5298104286193848  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.052443504333496094  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

torch.Size([10733, 500])
torch.Size([4882, 32])
torch.Size([1054, 32])
torch.Size([117, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 1.2182250022888184  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.054421424865722656  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

torch.Size([11806, 500])
torch.Size([5315, 32])
torch.Size([1117, 32])
torch.Size([241, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 1.170945167541504  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.04837322235107422  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

torch.Size([8580, 500])
torch.Size([4214, 32])
torch.Size([908, 32])
torch.Size([138, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 1.0047616958618164  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.04459667205810547  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

torch.Size([6619, 500])
torch.Size([2372, 32])
torch.Size([462, 32])
torch.Size([109, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.7087841033935547  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9569091796875 GB
    Memory Allocated: 0.05356550216674805  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

torch.Size([11275, 500])
torch.Size([5535, 32])
torch.Size([1890, 32])
torch.Size([332, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.3251385688781738  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 0.054798126220703125  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

torch.Size([11995, 500])
torch.Size([6973, 32])
torch.Size([1296, 32])
torch.Size([300, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.2019166946411133  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 0.050577640533447266  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

torch.Size([9804, 500])
torch.Size([4230, 32])
torch.Size([884, 32])
torch.Size([227, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 0.831489086151123  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 0.05622577667236328  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

torch.Size([12760, 500])
torch.Size([5793, 32])
torch.Size([1599, 32])
torch.Size([207, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.2117948532104492  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 0.04556560516357422  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

torch.Size([7078, 500])
torch.Size([2350, 32])
torch.Size([485, 32])
torch.Size([91, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 0.5872440338134766  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 0.0463714599609375  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

torch.Size([7559, 500])
torch.Size([3021, 32])
torch.Size([408, 32])
torch.Size([95, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 0.7990846633911133  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 0.04427051544189453  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

torch.Size([6435, 500])
torch.Size([1673, 32])
torch.Size([219, 32])
torch.Size([59, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 0.5085372924804688  GigaBytes
Max Memory Allocated: 1.6038260459899902  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007033713658650716 |0.002060715357462565 |0.20662844975789388 |0.0001358509063720703 |0.264654000600179 |0.010191917419433594 |
----------------------------------------------------------pseudo_mini_loss sum 1.5736117362976074
Total (block generation + training)time/epoch 8.1330726146698
Training time/epoch 7.254546403884888
Training time without block to device /epoch 7.223635673522949
Training time without total dataloading part /epoch 7.081466436386108
load block tensor time/epoch 0.10550570487976074
block to device time/epoch 0.030910730361938477
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  225489
Number of first layer input nodes during this epoch:  142390
