main start at this time 1648532318.8456643
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007744789123535156  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0022766590118408203
random selection method range initialization spend 0.00023126602172851562
time for parepare:  4.4345855712890625e-05
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0026350021362304688
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.291534423828125e-05
----------------------check_connections_block total spend ----------------------------- 0.0036554336547851562
generate_one_block  0.0012047290802001953
generate_one_block  0.0010712146759033203
generate_one_block  0.001054525375366211
generate_one_block  0.0010476112365722656
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001117706298828125
gen group dst list time:  3.337860107421875e-05
time for parepare:  0.0002315044403076172
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.0002231597900390625
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0003693103790283203
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0003387928009033203
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00041961669921875
----------------------check_connections_block total spend ----------------------------- 0.0028176307678222656
generate_one_block  0.0012805461883544922
generate_one_block  0.0015499591827392578
generate_one_block  0.0014660358428955078
generate_one_block  0.0016112327575683594
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010139942169189453
gen group dst list time:  7.653236389160156e-05
time for parepare:  0.0007185935974121094
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00026988983154296875
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0008416175842285156
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.0002377033233642578
mini_batch_src_global generation:  0.00023865699768066406
r_  generation:  0.002531290054321289
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  0.0002269744873046875
r_  generation:  0.0019888877868652344
local_output_nid generation:  7.152557373046875e-05
local_in_edges_tensor generation:  0.0002460479736328125
mini_batch_src_global generation:  0.00033783912658691406
r_  generation:  0.0031058788299560547
----------------------check_connections_block total spend ----------------------------- 0.013605356216430664
generate_one_block  0.0027818679809570312
generate_one_block  0.004220724105834961
generate_one_block  0.003422260284423828
generate_one_block  0.004925251007080078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002127408981323242
gen group dst list time:  0.00022220611572265625
time for parepare:  0.0014340877532958984
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.0006418228149414062
mini_batch_src_global generation:  0.0005447864532470703
r_  generation:  0.00449061393737793
local_output_nid generation:  0.00025534629821777344
local_in_edges_tensor generation:  0.0006618499755859375
mini_batch_src_global generation:  0.0010845661163330078
r_  generation:  0.009234189987182617
local_output_nid generation:  0.00027060508728027344
local_in_edges_tensor generation:  0.0005755424499511719
mini_batch_src_global generation:  0.0009543895721435547
r_  generation:  0.008569955825805664
local_output_nid generation:  0.0003070831298828125
local_in_edges_tensor generation:  0.0013227462768554688
mini_batch_src_global generation:  0.0011363029479980469
r_  generation:  0.011760711669921875
----------------------check_connections_block total spend ----------------------------- 0.05205249786376953
generate_one_block  0.007489919662475586
generate_one_block  0.013113737106323242
generate_one_block  0.012944459915161133
generate_one_block  0.016208171844482422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020852088928222656
gen group dst list time:  0.0007355213165283203
time for parepare:  0.0017142295837402344
local_output_nid generation:  0.00064849853515625
local_in_edges_tensor generation:  0.0016644001007080078
mini_batch_src_global generation:  0.0014450550079345703
r_  generation:  0.014750242233276367
local_output_nid generation:  0.0009403228759765625
local_in_edges_tensor generation:  0.0016179084777832031
mini_batch_src_global generation:  0.0020775794982910156
r_  generation:  0.01820087432861328
local_output_nid generation:  0.0010428428649902344
local_in_edges_tensor generation:  0.0016832351684570312
mini_batch_src_global generation:  0.001909494400024414
r_  generation:  0.019648313522338867
local_output_nid generation:  0.0009980201721191406
local_in_edges_tensor generation:  0.0015537738800048828
mini_batch_src_global generation:  0.0020406246185302734
r_  generation:  0.020743370056152344
----------------------check_connections_block total spend ----------------------------- 0.10982966423034668
generate_one_block  0.019044876098632812
generate_one_block  0.02476191520690918
generate_one_block  0.02570176124572754
generate_one_block  0.027753591537475586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007744789123535156  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

connection checking time:  0.17830514907836914
block generation total time  0.16827630996704102
average batch blocks generation time:  0.042069077491760254
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1268310546875 GB
    Memory Allocated: 0.03364229202270508  GigaBytes
Max Memory Allocated: 0.03364229202270508  GigaBytes

torch.Size([13488, 500])
torch.Size([7046, 32])
torch.Size([1489, 32])
torch.Size([372, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.5080628395080566  GigaBytes
Max Memory Allocated: 1.5877952575683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.044812679290771484  GigaBytes
Max Memory Allocated: 1.5877952575683594  GigaBytes

torch.Size([15332, 500])
torch.Size([9934, 32])
torch.Size([3119, 32])
torch.Size([753, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2635498046875 GB
    Memory Allocated: 1.8920292854309082  GigaBytes
Max Memory Allocated: 1.9553499221801758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2635498046875 GB
    Memory Allocated: 0.04701042175292969  GigaBytes
Max Memory Allocated: 1.9553499221801758  GigaBytes

torch.Size([16522, 500])
torch.Size([11388, 32])
torch.Size([3395, 32])
torch.Size([803, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3787841796875 GB
    Memory Allocated: 1.9708800315856934  GigaBytes
Max Memory Allocated: 2.052293300628662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3787841796875 GB
    Memory Allocated: 0.0474705696105957  GigaBytes
Max Memory Allocated: 2.052293300628662  GigaBytes

torch.Size([16694, 500])
torch.Size([11782, 32])
torch.Size([4367, 32])
torch.Size([954, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 2.120309352874756  GigaBytes
Max Memory Allocated: 2.1822056770324707  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015508174896240234 |0.08769357204437256 |0.39599376916885376 |0.00016826391220092773 |0.33310675621032715 |0.010888814926147461 |
----------------------------------------------------------pseudo_mini_loss sum 2.0745248794555664
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  117795
Number of first layer input nodes during this epoch:  62036
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.06436395645141602  GigaBytes
Max Memory Allocated: 2.1822056770324707  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00054168701171875
random selection method range initialization spend 0.00012540817260742188
time for parepare:  5.8650970458984375e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.771087646484375e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.482269287109375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.695487976074219e-05
----------------------check_connections_block total spend ----------------------------- 0.0011103153228759766
generate_one_block  0.0012135505676269531
generate_one_block  0.0010943412780761719
generate_one_block  0.0011022090911865234
generate_one_block  0.0010766983032226562
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005586147308349609
gen group dst list time:  3.4809112548828125e-05
time for parepare:  0.0002760887145996094
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00022673606872558594
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.00045013427734375
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.00027632713317871094
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0003924369812011719
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00020837783813476562
----------------------check_connections_block total spend ----------------------------- 0.0029878616333007812
generate_one_block  0.0019516944885253906
generate_one_block  0.0014467239379882812
generate_one_block  0.0016210079193115234
generate_one_block  0.0013470649719238281
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010044574737548828
gen group dst list time:  8.893013000488281e-05
time for parepare:  0.0007545948028564453
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.0003514289855957031
mini_batch_src_global generation:  0.0003306865692138672
r_  generation:  0.002925872802734375
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.0013604164123535156
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.0019338130950927734
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.00027298927307128906
mini_batch_src_global generation:  0.0002620220184326172
r_  generation:  0.002657175064086914
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.0001995563507080078
r_  generation:  0.0012392997741699219
----------------------check_connections_block total spend ----------------------------- 0.015304088592529297
generate_one_block  0.0050563812255859375
generate_one_block  0.0034978389739990234
generate_one_block  0.0046367645263671875
generate_one_block  0.002645730972290039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020780563354492188
gen group dst list time:  0.0002548694610595703
time for parepare:  0.0014641284942626953
local_output_nid generation:  0.0003190040588378906
local_in_edges_tensor generation:  0.0009167194366455078
mini_batch_src_global generation:  0.0009279251098632812
r_  generation:  0.010304689407348633
local_output_nid generation:  0.00028252601623535156
local_in_edges_tensor generation:  0.0005550384521484375
mini_batch_src_global generation:  0.0011882781982421875
r_  generation:  0.008833169937133789
local_output_nid generation:  0.00032520294189453125
local_in_edges_tensor generation:  0.0006046295166015625
mini_batch_src_global generation:  0.0011179447174072266
r_  generation:  0.011394500732421875
local_output_nid generation:  0.00024390220642089844
local_in_edges_tensor generation:  0.00045013427734375
mini_batch_src_global generation:  0.0007519721984863281
r_  generation:  0.00654149055480957
----------------------check_connections_block total spend ----------------------------- 0.05548381805419922
generate_one_block  0.015357255935668945
generate_one_block  0.01573634147644043
generate_one_block  0.016811847686767578
generate_one_block  0.010625600814819336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018537044525146484
gen group dst list time:  0.0008170604705810547
time for parepare:  0.0016050338745117188
local_output_nid generation:  0.001071929931640625
local_in_edges_tensor generation:  0.002002239227294922
mini_batch_src_global generation:  0.0019142627716064453
r_  generation:  0.019454240798950195
local_output_nid generation:  0.0008749961853027344
local_in_edges_tensor generation:  0.0016245841979980469
mini_batch_src_global generation:  0.0020661354064941406
r_  generation:  0.018608570098876953
local_output_nid generation:  0.0011165142059326172
local_in_edges_tensor generation:  0.0019371509552001953
mini_batch_src_global generation:  0.0017979145050048828
r_  generation:  0.02250814437866211
local_output_nid generation:  0.0009546279907226562
local_in_edges_tensor generation:  0.001336812973022461
mini_batch_src_global generation:  0.0016088485717773438Using backend: pytorch

r_  generation:  0.018049001693725586
----------------------check_connections_block total spend ----------------------------- 0.11661219596862793
generate_one_block  0.026815176010131836
generate_one_block  0.02819538116455078
generate_one_block  0.03260660171508789
generate_one_block  0.025792598724365234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.06436395645141602  GigaBytes
Max Memory Allocated: 2.1822056770324707  GigaBytes

connection checking time:  0.19038796424865723
block generation total time  0.19414401054382324
average batch blocks generation time:  0.04853600263595581
block dataloader generation time/epoch 0.45467424392700195
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.06113100051879883  GigaBytes
Max Memory Allocated: 2.1822056770324707  GigaBytes

torch.Size([15760, 500])
torch.Size([10900, 32])
torch.Size([3439, 32])
torch.Size([937, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 2.003779888153076  GigaBytes
Max Memory Allocated: 2.1822056770324707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.060413360595703125  GigaBytes
Max Memory Allocated: 2.1822056770324707  GigaBytes

torch.Size([15411, 500])
torch.Size([10094, 32])
torch.Size([3041, 32])
torch.Size([596, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 1.923983097076416  GigaBytes
Max Memory Allocated: 2.1822056770324707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5721435546875 GB
    Memory Allocated: 0.06289100646972656  GigaBytes
Max Memory Allocated: 2.1822056770324707  GigaBytes

torch.Size([16671, 500])
torch.Size([12413, 32])
torch.Size([3915, 32])
torch.Size([894, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 2.167712688446045  GigaBytes
Max Memory Allocated: 2.2392101287841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 0.06077384948730469  GigaBytes
Max Memory Allocated: 2.2392101287841797  GigaBytes

torch.Size([15660, 500])
torch.Size([9054, 32])
torch.Size([2489, 32])
torch.Size([438, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6990966796875 GB
    Memory Allocated: 1.8330354690551758  GigaBytes
Max Memory Allocated: 2.2392101287841797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015847206115722656 |0.002279043197631836 |0.2722872495651245 |0.00013691186904907227 |0.34456032514572144 |0.00983881950378418 |
----------------------------------------------------------pseudo_mini_loss sum 1.3107528686523438
Total (block generation + training)time/epoch 3.01767897605896
Training time/epoch 2.5626816749572754
Training time without block to device /epoch 2.553565502166748
Training time without total dataloading part /epoch 2.4777767658233643
load block tensor time/epoch 0.06338882446289062
block to device time/epoch 0.009116172790527344
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  122068
Number of first layer input nodes during this epoch:  63502
