main start at this time 1648532597.089736
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0467529296875 GB
    Memory Allocated: 0.01775074005126953  GigaBytes
Max Memory Allocated: 0.01775074005126953  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0019872188568115234
random selection method range initialization spend 0.00018858909606933594
time for parepare:  4.363059997558594e-05
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0015158653259277344
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.606910705566406e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.1682510375976562e-05
----------------------check_connections_block total spend ----------------------------- 0.0030889511108398438
generate_one_block  0.001253366470336914
generate_one_block  0.0010061264038085938
generate_one_block  0.0009646415710449219
generate_one_block  0.0009930133819580078
generate_one_block  0.0010366439819335938
generate_one_block  0.0010128021240234375
generate_one_block  0.0009379386901855469
generate_one_block  0.0009238719940185547
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012404918670654297
gen group dst list time:  4.6253204345703125e-05
time for parepare:  0.00021767616271972656
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00013017654418945312
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00011873245239257812
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00024008750915527344
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00017118453979492188
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0002987384796142578
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0002014636993408203
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0001277923583984375
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.364418029785156e-05
----------------------check_connections_block total spend ----------------------------- 0.003355264663696289
generate_one_block  0.0011928081512451172
generate_one_block  0.0011129379272460938
generate_one_block  0.0012879371643066406
generate_one_block  0.0011515617370605469
generate_one_block  0.001367807388305664
generate_one_block  0.0012118816375732422
generate_one_block  0.001129150390625
generate_one_block  0.0009794235229492188
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012695789337158203
gen group dst list time:  9.417533874511719e-05
time for parepare:  0.0007762908935546875
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00024819374084472656
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0006113052368164062
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0005919933319091797
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  0.0001747608184814453
r_  generation:  0.0017082691192626953
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  0.00013208389282226562
r_  generation:  0.0009312629699707031
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00019860267639160156
r_  generation:  0.0023279190063476562
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  0.00015044212341308594
r_  generation:  0.001251220703125
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.0007333755493164062
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0002505779266357422
----------------------check_connections_block total spend ----------------------------- 0.014153718948364258
generate_one_block  0.001750946044921875
generate_one_block  0.0016663074493408203
generate_one_block  0.0031926631927490234
generate_one_block  0.002274751663208008
generate_one_block  0.0038318634033203125
generate_one_block  0.002468585968017578
generate_one_block  0.0018229484558105469
generate_one_block  0.0012192726135253906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002019643783569336
gen group dst list time:  0.00024890899658203125
time for parepare:  0.0014901161193847656
local_output_nid generation:  8.726119995117188e-05
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.0003917217254638672
r_  generation:  0.0030450820922851562
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.00028443336486816406
mini_batch_src_global generation:  0.0004291534423828125
r_  generation:  0.003319263458251953
local_output_nid generation:  0.00019741058349609375
local_in_edges_tensor generation:  0.000461578369140625
mini_batch_src_global generation:  0.0006606578826904297
r_  generation:  0.00625157356262207
local_output_nid generation:  0.00016617774963378906
local_in_edges_tensor generation:  0.0003714561462402344
mini_batch_src_global generation:  0.000469207763671875
r_  generation:  0.004628181457519531
local_output_nid generation:  0.00023794174194335938
local_in_edges_tensor generation:  0.0005102157592773438
mini_batch_src_global generation:  0.0007996559143066406
r_  generation:  0.008378267288208008
local_output_nid generation:  0.00019359588623046875
local_in_edges_tensor generation:  0.00043272972106933594
mini_batch_src_global generation:  0.0007913112640380859
r_  generation:  0.007152557373046875
local_output_nid generation:  0.00010251998901367188
local_in_edges_tensor generation:  0.0002841949462890625
mini_batch_src_global generation:  0.0005424022674560547
r_  generation:  0.00454258918762207
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.0002892017364501953
r_  generation:  0.002094268798828125
----------------------check_connections_block total spend ----------------------------- 0.059671878814697266
generate_one_block  0.005515336990356445
generate_one_block  0.005913972854614258
generate_one_block  0.008973121643066406
generate_one_block  0.006959438323974609
generate_one_block  0.012067317962646484
generate_one_block  0.010545015335083008
generate_one_block  0.0073451995849609375
generate_one_block  0.0037384033203125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002284526824951172
gen group dst list time:  0.0011248588562011719
time for parepare:  0.0017080307006835938
local_output_nid generation:  0.0004591941833496094
local_in_edges_tensor generation:  0.0014047622680664062
mini_batch_src_global generation:  0.0010192394256591797
r_  generation:  0.010593891143798828
local_output_nid generation:  0.0004494190216064453
local_in_edges_tensor generation:  0.0009179115295410156
mini_batch_src_global generation:  0.0011260509490966797
r_  generation:  0.010999679565429688
local_output_nid generation:  0.0004885196685791016
local_in_edges_tensor generation:  0.0009124279022216797
mini_batch_src_global generation:  0.0008904933929443359
r_  generation:  0.012106180191040039
local_output_nid generation:  0.0005526542663574219
local_in_edges_tensor generation:  0.0009241104125976562
mini_batch_src_global generation:  0.0012090206146240234
r_  generation:  0.013120651245117188
local_output_nid generation:  0.0007631778717041016
local_in_edges_tensor generation:  0.0012536048889160156
mini_batch_src_global generation:  0.0016336441040039062
r_  generation:  0.017909765243530273
local_output_nid generation:  0.0008134841918945312
local_in_edges_tensor generation:  0.001373291015625
mini_batch_src_global generation:  0.0016124248504638672
r_  generation:  0.01783895492553711
local_output_nid generation:  0.0006289482116699219
local_in_edges_tensor generation:  0.0009794235229492188
mini_batch_src_global generation:  0.0012633800506591797
r_  generation:  0.014423131942749023
local_output_nid generation:  0.0003802776336669922
local_in_edges_tensor generation:  0.0006117820739746094
mini_batch_src_global generation:  0.0008869171142578125
r_  generation:  0.008333683013916016
----------------------check_connections_block total spend ----------------------------- 0.15410470962524414
generate_one_block  0.015289068222045898
generate_one_block  0.015647172927856445
generate_one_block  0.01702880859375
generate_one_block  0.01831674575805664
generate_one_block  0.02444744110107422
generate_one_block  0.02391791343688965
generate_one_block  0.018584251403808594
generate_one_block  0.011995792388916016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0467529296875 GB
    Memory Allocated: 0.01775074005126953  GigaBytes
Max Memory Allocated: 0.01775074005126953  GigaBytes

connection checking time:  0.23128557205200195
block generation total time  0.2339458465576172
average batch blocks generation time:  0.02924323081970215
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1326904296875 GB
    Memory Allocated: 0.03960084915161133  GigaBytes
Max Memory Allocated: 0.03960084915161133  GigaBytes

torch.Size([11292, 500])
torch.Size([5396, 256])
torch.Size([1071, 256])
torch.Size([293, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5604248046875 GB
    Memory Allocated: 1.295802116394043  GigaBytes
Max Memory Allocated: 1.29585599899292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5662841796875 GB
    Memory Allocated: 0.05777263641357422  GigaBytes
Max Memory Allocated: 1.3012218475341797  GigaBytes

torch.Size([11358, 500])
torch.Size([5542, 256])
torch.Size([1062, 256])
torch.Size([291, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6385498046875 GB
    Memory Allocated: 1.3821258544921875  GigaBytes
Max Memory Allocated: 1.382166862487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6424560546875 GB
    Memory Allocated: 0.05825042724609375  GigaBytes
Max Memory Allocated: 1.3859915733337402  GigaBytes

torch.Size([11304, 500])
torch.Size([5914, 256])
torch.Size([2208, 256])
torch.Size([488, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.7431578636169434  GigaBytes
Max Memory Allocated: 1.7432518005371094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0662841796875 GB
    Memory Allocated: 0.06314945220947266  GigaBytes
Max Memory Allocated: 1.746978759765625  GigaBytes

torch.Size([14188, 500])
torch.Size([6663, 256])
torch.Size([2017, 256])
torch.Size([319, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1971435546875 GB
    Memory Allocated: 1.7213177680969238  GigaBytes
Max Memory Allocated: 1.746978759765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1971435546875 GB
    Memory Allocated: 0.0664510726928711  GigaBytes
Max Memory Allocated: 1.746978759765625  GigaBytes

torch.Size([15817, 500])
torch.Size([9636, 256])
torch.Size([3094, 256])
torch.Size([645, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7869873046875 GB
    Memory Allocated: 2.488661766052246  GigaBytes
Max Memory Allocated: 2.4887542724609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 0.06605911254882812  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

torch.Size([15641, 500])
torch.Size([10007, 256])
torch.Size([2493, 256])
torch.Size([432, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 2.3679604530334473  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 0.06122112274169922  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

torch.Size([13143, 500])
torch.Size([7436, 256])
torch.Size([1280, 256])
torch.Size([327, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 1.796435832977295  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 0.05321502685546875  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

torch.Size([8853, 500])
torch.Size([3900, 256])
torch.Size([526, 256])
torch.Size([106, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 1.0610909461975098  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015464603900909424 |0.04450961947441101 |0.30176612734794617 |0.00016060471534729004 |0.33731189370155334 |0.012128829956054688 |
----------------------------------------------------------pseudo_mini_loss sum 1.8511881828308105
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  173098
Number of first layer input nodes during this epoch:  101596
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 0.08908271789550781  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005574226379394531
random selection method range initialization spend 0.00014853477478027344
time for parepare:  6.604194641113281e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.430511474609375e-05
----------------------check_connections_block total spend ----------------------------- 0.0018117427825927734
generate_one_block  0.0011696815490722656
generate_one_block  0.001325845718383789
generate_one_block  0.0010995864868164062
generate_one_block  0.0010600090026855469
generate_one_block  0.0010371208190917969
generate_one_block  0.001058340072631836
generate_one_block  0.0010514259338378906
generate_one_block  0.0010030269622802734
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005612373352050781
gen group dst list time:  5.817413330078125e-05
time for parepare:  0.0003151893615722656
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0001285076141357422
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0002574920654296875
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00017118453979492188
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0001556873321533203
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00012969970703125
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0002949237823486328
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00022721290588378906
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  8.7738037109375e-05
----------------------check_connections_block total spend ----------------------------- 0.003821134567260742
generate_one_block  0.0012238025665283203
generate_one_block  0.0013606548309326172
generate_one_block  0.0012073516845703125
generate_one_block  0.0012180805206298828
generate_one_block  0.0011713504791259766
generate_one_block  0.001501321792602539
generate_one_block  0.0013132095336914062
generate_one_block  0.0010883808135986328
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001165628433227539
gen group dst list time:  0.000110626220703125
time for parepare:  0.0009031295776367188
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00033926963806152344
mini_batch_src_global generation:  0.00011205673217773438
r_  generation:  0.0006525516510009766
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.00021600723266601562
mini_batch_src_global generation:  0.0002903938293457031
r_  generation:  0.001890420913696289
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  0.0001685619354248047
r_  generation:  0.0011129379272460938
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0008068084716796875
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0006847381591796875
local_output_nid generation:  8.320808410644531e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  0.0002155303955078125
r_  generation:  0.0021562576293945312
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.00020265579223632812
mini_batch_src_global generation:  0.00017571449279785156
r_  generation:  0.001338958740234375
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  8.463859558105469e-05
r_  generation:  0.00046372413635253906
----------------------check_connections_block total spend ----------------------------- 0.016041994094848633
generate_one_block  0.0023403167724609375
generate_one_block  0.0034704208374023438
generate_one_block  0.0025615692138671875
generate_one_block  0.002001523971557617
generate_one_block  0.0018219947814941406
generate_one_block  0.003888845443725586
generate_one_block  0.0027370452880859375
generate_one_block  0.0015625953674316406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020051002502441406
gen group dst list time:  0.00033664703369140625
time for parepare:  0.0015575885772705078
local_output_nid generation:  0.0001633167266845703
local_in_edges_tensor generation:  0.0008046627044677734
mini_batch_src_global generation:  0.0004596710205078125
r_  generation:  0.004072666168212891
local_output_nid generation:  0.00025391578674316406
local_in_edges_tensor generation:  0.00047326087951660156
mini_batch_src_global generation:  0.0009381771087646484
r_  generation:  0.006682634353637695
local_output_nid generation:  0.0002567768096923828
local_in_edges_tensor generation:  0.0004734992980957031
mini_batch_src_global generation:  0.0006935596466064453
r_  generation:  0.0062754154205322266
local_output_nid generation:  0.00013780593872070312
local_in_edges_tensor generation:  0.0003132820129394531
mini_batch_src_global generation:  0.00042510032653808594
r_  generation:  0.003804922103881836
local_output_nid generation:  0.00010347366333007812
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  0.0003266334533691406
r_  generation:  0.0031092166900634766
local_output_nid generation:  0.00032138824462890625
local_in_edges_tensor generation:  0.0005605220794677734
mini_batch_src_global generation:  0.0008156299591064453
r_  generation:  0.009970426559448242
local_output_nid generation:  0.0002548694610595703
local_in_edges_tensor generation:  0.0004820823669433594
mini_batch_src_global generation:  0.0009350776672363281
r_  generation:  0.007299661636352539
local_output_nid generation:  9.369850158691406e-05
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  0.00040602684020996094
r_  generation:  0.003179788589477539
----------------------check_connections_block total spend ----------------------------- 0.06744766235351562
generate_one_block  0.007602691650390625
generate_one_block  0.010443449020385742
generate_one_block  0.010117292404174805
generate_one_block  0.006383657455444336
generate_one_block  0.005387783050537109
generate_one_block  0.014357805252075195
generate_one_block  0.011037349700927734
generate_one_block  0.005564451217651367
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018312931060791016
gen group dst list time:  0.0011625289916992188
time for parepare:  0.0018155574798583984
local_output_nid generation:  0.0007774829864501953
local_in_edges_tensor generation:  0.0015685558319091797
mini_batch_src_global generation:  0.001329183578491211
r_  generation:  0.012773513793945312
local_output_nid generation:  0.0007212162017822266
local_in_edges_tensor generation:  0.001577615737915039
mini_batch_src_global generation:  0.0016970634460449219
r_  generation:  0.013841867446899414
local_output_nid generation:  0.0009024143218994141
local_in_edges_tensor generation:  0.0012035369873046875
mini_batch_src_global generation:  0.0014908313751220703
r_  generation:  0.016455411911010742
local_output_nid generation:  0.0008177757263183594
local_in_edges_tensor generation:  0.0010776519775390625
mini_batch_src_global generation:  0.0011839866638183594
r_  generation:  0.013096332550048828
local_output_nid generation:  0.0006330013275146484
local_in_edges_tensor generation:  0.0007824897766113281
mini_batch_src_global generation:  0.0009291172027587891
r_  generation:  0.009562253952026367
local_output_nid generation:  0.0012085437774658203
local_in_edges_tensor generation:  0.0015056133270263672
mini_batch_src_global generation:  0.0017328262329101562
r_  generation:  0.020297527313232422
local_output_nid generation:  0.0009801387786865234
local_in_edges_tensor generation:  0.0018050670623779297
mini_batch_src_global generation:  0.0018286705017089844
r_  generation:  0.018296480178833008
local_output_nid generation:  0.0007305145263671875
local_in_edges_tensor generation:  0.0008223056793212891
mini_batch_src_global generation:  0.0012218952178955078
r_  generation:  0.011761903762817383
----------------------check_connections_block total spend ----------------------------- 0.17442655563354492
generate_one_block  0.019304275512695312
generate_one_block  0.019945144653320312
generate_one_block  0.0235288143157959
generate_one_block  0.017792701721191406
generate_one_block  0.014186382293701172
generate_one_block  0.02588963508605957
generate_one_block  0.02659463882446289
generate_one_block  0.01629328727722168
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 0.08908271789550781  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

connection checking time:  0.2617373466491699
block generation total time  0.26489782333374023
average batch blocks generation time:  0.03311222791671753
block dataloader generation time/epoch 0.6704812049865723
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 0.09479093551635742  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

torch.Size([12152, 500])
torch.Size([6078, 256])
torch.Size([1189, 256])
torch.Size([280, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 1.6075491905212402  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 0.0949406623840332  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

torch.Size([12159, 500])
torch.Size([6535, 256])
torch.Size([2055, 256])
torch.Size([429, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 1.9409561157226562  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 0.10010719299316406  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

torch.Size([14914, 500])
torch.Size([7881, 256])
torch.Size([2332, 256])
torch.Size([315, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 2.154479503631592  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 0.09581279754638672  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

torch.Size([12702, 500])
torch.Size([6456, 256])
torch.Size([1290, 256])
torch.Size([320, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 1.6057567596435547  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 0.09224700927734375  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

torch.Size([10840, 500])
torch.Size([5286, 256])
torch.Size([1012, 256])
torch.Size([296, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 1.2636170387268066  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 0.10216140747070312  GigaBytes
Max Memory Allocated: 2.492485523223877  GigaBytes

torch.Size([15916, 500])
torch.Size([11256, 256])
torch.Size([3115, 256])
torch.Size([634, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 2.681422710418701  GigaBytes
Max Memory Allocated: 2.681504726409912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9764404296875 GB
    Memory Allocated: 0.10152673721313477  GigaBytes
Max Memory Allocated: 2.6852502822875977  GigaBytes

torch.Size([15651, 500])
torch.Size([9084, 256])
torch.Size([2519, 256])
torch.Size([475, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9764404296875 GB
    Memory Allocated: 2.3137006759643555  GigaBytes
Max Memory Allocated: 2.6852502822875977  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9764404296875 GB
    Memory Allocated: 0.09213066101074219  GigaBytes
Max Memory Allocated: 2.6852502822875977  GigaBytes

torch.Size([10755, 500])
torch.Size([5130, 256])
torch.Size([809, 256])
torch.Size([173, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9764404296875 GB
    Memory Allocated: 1.4217405319213867  GigaBytes
Max Memory Allocated: 2.6852502822875977  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011517614126205444 |0.002461940050125122 |0.2406255006790161 |0.00014197826385498047 |0.3401740491390228 |0.010390520095825195 |
----------------------------------------------------------pseudo_mini_loss sum 3.3405566215515137
Total (block generation + training)time/epoch 5.462719678878784
Training time/epoch 4.791807174682617
Training time without block to device /epoch 4.772111654281616
Training time without total dataloading part /epoch 4.657922744750977
load block tensor time/epoch 0.09214091300964355
block to device time/epoch 0.019695520401000977
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  180395
Number of first layer input nodes during this epoch:  105089
