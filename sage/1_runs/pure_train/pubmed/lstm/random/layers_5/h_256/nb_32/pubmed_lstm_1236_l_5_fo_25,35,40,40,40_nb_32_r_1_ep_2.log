main start at this time 1648532617.763317
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0467529296875 GB
    Memory Allocated: 0.01775074005126953  GigaBytes
Max Memory Allocated: 0.01775074005126953  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0018987655639648438
random selection method range initialization spend 0.0001842975616455078
time for parepare:  4.57763671875e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0012192726135253906
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3113021850585938e-05
----------------------check_connections_block total spend ----------------------------- 0.00391077995300293
generate_one_block  0.0011882781982421875
generate_one_block  0.001010894775390625
generate_one_block  0.0010111331939697266
generate_one_block  0.0009937286376953125
generate_one_block  0.0010349750518798828
generate_one_block  0.0010280609130859375
generate_one_block  0.0010058879852294922
generate_one_block  0.0010013580322265625
generate_one_block  0.0010101795196533203
generate_one_block  0.0010356903076171875
generate_one_block  0.0010099411010742188
generate_one_block  0.0009608268737792969
generate_one_block  0.0009918212890625
generate_one_block  0.0009489059448242188
generate_one_block  0.0009546279907226562
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013086795806884766
gen group dst list time:  7.843971252441406e-05
time for parepare:  0.0002772808074951172
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.508827209472656e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  9.417533874511719e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  8.845329284667969e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0002048015594482422
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  9.751319885253906e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.343292236328125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00013136863708496094
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.000186920166015625
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00012159347534179688
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  9.202957153320312e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.9114227294921875e-05
----------------------check_connections_block total spend ----------------------------- 0.004529476165771484
generate_one_block  0.0010657310485839844
generate_one_block  0.0011284351348876953
generate_one_block  0.0010356903076171875
generate_one_block  0.0011692047119140625
generate_one_block  0.001058340072631836
generate_one_block  0.001270294189453125
generate_one_block  0.001148223876953125
generate_one_block  0.0010826587677001953
generate_one_block  0.0011713504791259766
generate_one_block  0.0012052059173583984
generate_one_block  0.0010194778442382812
generate_one_block  0.0011658668518066406
generate_one_block  0.001081705093383789
generate_one_block  0.0010097026824951172
generate_one_block  0.0010066032409667969
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012102127075195312
gen group dst list time:  0.00012302398681640625
time for parepare:  0.0007374286651611328
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00024127960205078125
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00021600723266601562
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.00046253204345703125
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00019216537475585938
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0004677772521972656
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0003428459167480469
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  0.00020551681518554688
r_  generation:  0.0015060901641845703
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  0.00011301040649414062
r_  generation:  0.0007498264312744141
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.00037479400634765625
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0007951259613037109
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  0.00017642974853515625
r_  generation:  0.0016062259674072266
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  8.511543273925781e-05
r_  generation:  0.0003535747528076172
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0009548664093017578
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0005192756652832031
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.000316619873046875
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00026154518127441406
----------------------check_connections_block total spend ----------------------------- 0.016525983810424805
generate_one_block  0.0013310909271240234
generate_one_block  0.001552581787109375
generate_one_block  0.0013570785522460938
generate_one_block  0.0015528202056884766
generate_one_block  0.001463174819946289
generate_one_block  0.0028977394104003906
generate_one_block  0.001928091049194336
generate_one_block  0.0014116764068603516
generate_one_block  0.0018341541290283203
generate_one_block  0.002830982208251953
generate_one_block  0.0016529560089111328
generate_one_block  0.0020999908447265625
generate_one_block  0.001497507095336914
generate_one_block  0.0012967586517333984
generate_one_block  0.0012514591217041016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021429061889648438
gen group dst list time:  0.0003113746643066406
time for parepare:  0.0016963481903076172
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.0004661083221435547
mini_batch_src_global generation:  0.00016808509826660156
r_  generation:  0.0013246536254882812
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  0.00030159950256347656
r_  generation:  0.002054929733276367
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  0.00015687942504882812
r_  generation:  0.0013549327850341797
local_output_nid generation:  7.343292236328125e-05
local_in_edges_tensor generation:  0.0002617835998535156
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.0026924610137939453
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.00028204917907714844
mini_batch_src_global generation:  0.00032591819763183594
r_  generation:  0.0027570724487304688
local_output_nid generation:  0.0001690387725830078
local_in_edges_tensor generation:  0.0004191398620605469
mini_batch_src_global generation:  0.0005867481231689453
r_  generation:  0.005831718444824219
local_output_nid generation:  0.0001544952392578125
local_in_edges_tensor generation:  0.00035953521728515625
mini_batch_src_global generation:  0.00045180320739746094
r_  generation:  0.00429987907409668
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  0.0002627372741699219
r_  generation:  0.0017588138580322266
local_output_nid generation:  0.00011491775512695312
local_in_edges_tensor generation:  0.0003046989440917969
mini_batch_src_global generation:  0.0003180503845214844
r_  generation:  0.003677845001220703
local_output_nid generation:  0.00014591217041015625
local_in_edges_tensor generation:  0.00040793418884277344
mini_batch_src_global generation:  0.0006244182586669922
r_  generation:  0.005732059478759766
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  0.0003120899200439453
r_  generation:  0.0018737316131591797
local_output_nid generation:  0.0001437664031982422
local_in_edges_tensor generation:  0.00036215782165527344
mini_batch_src_global generation:  0.0005507469177246094
r_  generation:  0.006009817123413086
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.00022530555725097656
mini_batch_src_global generation:  0.00036716461181640625
r_  generation:  0.0024585723876953125
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.00025534629821777344
r_  generation:  0.002240419387817383
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  0.00023317337036132812
r_  generation:  0.0020051002502441406
----------------------check_connections_block total spend ----------------------------- 0.0708005428314209
generate_one_block  0.0030052661895751953
generate_one_block  0.003679037094116211
generate_one_block  0.002582073211669922
generate_one_block  0.00459742546081543
generate_one_block  0.004392385482788086
generate_one_block  0.00834512710571289
generate_one_block  0.0064928531646728516
generate_one_block  0.002977132797241211
generate_one_block  0.005593538284301758
generate_one_block  0.008383989334106445
generate_one_block  0.0033042430877685547
generate_one_block  0.009280920028686523
generate_one_block  0.004240989685058594
generate_one_block  0.0038635730743408203
generate_one_block  0.0036602020263671875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0023293495178222656
gen group dst list time:  0.0015697479248046875
time for parepare:  0.0017762184143066406
local_output_nid generation:  0.0002677440643310547
local_in_edges_tensor generation:  0.0010504722595214844
mini_batch_src_global generation:  0.000736236572265625
r_  generation:  0.006003141403198242
local_output_nid generation:  0.0003204345703125
local_in_edges_tensor generation:  0.0006482601165771484
mini_batch_src_global generation:  0.0007932186126708984
r_  generation:  0.006474018096923828
local_output_nid generation:  0.0002288818359375
local_in_edges_tensor generation:  0.0004622936248779297
mini_batch_src_global generation:  0.0005331039428710938
r_  generation:  0.0052373409271240234
local_output_nid generation:  0.000415802001953125
local_in_edges_tensor generation:  0.0007123947143554688
mini_batch_src_global generation:  0.0008120536804199219
r_  generation:  0.008940696716308594
local_output_nid generation:  0.0003147125244140625
local_in_edges_tensor generation:  0.0006244182586669922
mini_batch_src_global generation:  0.0008597373962402344
r_  generation:  0.007534027099609375
local_output_nid generation:  0.0004096031188964844
local_in_edges_tensor generation:  0.0007300376892089844
mini_batch_src_global generation:  0.0010077953338623047
r_  generation:  0.010671377182006836
local_output_nid generation:  0.0005624294281005859
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0010175704956054688
r_  generation:  0.013135433197021484
local_output_nid generation:  0.0002841949462890625
local_in_edges_tensor generation:  0.0004837512969970703
mini_batch_src_global generation:  0.000728607177734375
r_  generation:  0.005922794342041016
local_output_nid generation:  0.00045943260192871094
local_in_edges_tensor generation:  0.0008466243743896484
mini_batch_src_global generation:  0.0009741783142089844
r_  generation:  0.012360811233520508
local_output_nid generation:  0.0005276203155517578
local_in_edges_tensor generation:  0.001168966293334961
mini_batch_src_global generation:  0.0012133121490478516
r_  generation:  0.013251304626464844
local_output_nid generation:  0.00029015541076660156
local_in_edges_tensor generation:  0.0005373954772949219
mini_batch_src_global generation:  0.0008158683776855469
r_  generation:  0.00754237174987793
local_output_nid generation:  0.0008177757263183594
local_in_edges_tensor generation:  0.0011708736419677734
mini_batch_src_global generation:  0.0013265609741210938
r_  generation:  0.01739954948425293
local_output_nid generation:  0.0004343986511230469
local_in_edges_tensor generation:  0.0006740093231201172
mini_batch_src_global generation:  0.0009286403656005859
r_  generation:  0.008537054061889648
local_output_nid generation:  0.0002765655517578125
local_in_edges_tensor generation:  0.0005044937133789062
mini_batch_src_global generation:  0.0007371902465820312
r_  generation:  0.0073010921478271484
local_output_nid generation:  0.0003650188446044922
local_in_edges_tensor generation:  0.0006029605865478516
mini_batch_src_global generation:  0.0007729530334472656
r_  generation:  0.008205890655517578
----------------------check_connections_block total spend ----------------------------- 0.2054276466369629
generate_one_block  0.009480714797973633
generate_one_block  0.008717775344848633
generate_one_block  0.008699178695678711
generate_one_block  0.013092041015625
generate_one_block  0.011156082153320312
generate_one_block  0.01428675651550293
generate_one_block  0.018036603927612305
generate_one_block  0.008949756622314453
generate_one_block  0.016108274459838867
generate_one_block  0.018219947814941406
generate_one_block  0.011649370193481445
generate_one_block  0.02217388153076172
generate_one_block  0.01222538948059082
generate_one_block  0.010684967041015625
generate_one_block  0.011496305465698242
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0467529296875 GB
    Memory Allocated: 0.01775074005126953  GigaBytes
Max Memory Allocated: 0.01775074005126953  GigaBytes

connection checking time:  0.2972836494445801
block generation total time  0.3119523525238037
average batch blocks generation time:  0.020796823501586913
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1248779296875 GB
    Memory Allocated: 0.0316157341003418  GigaBytes
Max Memory Allocated: 0.0316157341003418  GigaBytes

torch.Size([7173, 500])
torch.Size([2627, 256])
torch.Size([391, 256])
torch.Size([89, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9412841796875 GB
    Memory Allocated: 0.7102475166320801  GigaBytes
Max Memory Allocated: 0.7102775573730469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9490966796875 GB
    Memory Allocated: 0.050079345703125  GigaBytes
Max Memory Allocated: 0.7163219451904297  GigaBytes

torch.Size([7711, 500])
torch.Size([3348, 256])
torch.Size([694, 256])
torch.Size([204, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.8014187812805176  GigaBytes
Max Memory Allocated: 0.8014473915100098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.049338340759277344  GigaBytes
Max Memory Allocated: 0.805272102355957  GigaBytes

torch.Size([7323, 500])
torch.Size([2508, 256])
torch.Size([425, 256])
torch.Size([76, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.6559023857116699  GigaBytes
Max Memory Allocated: 0.805272102355957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.053755760192871094  GigaBytes
Max Memory Allocated: 0.805272102355957  GigaBytes

torch.Size([9631, 500])
torch.Size([4558, 256])
torch.Size([738, 256])
torch.Size([217, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 1.169632911682129  GigaBytes
Max Memory Allocated: 1.169724941253662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4412841796875 GB
    Memory Allocated: 0.04987668991088867  GigaBytes
Max Memory Allocated: 1.1735129356384277  GigaBytes

torch.Size([7565, 500])
torch.Size([3333, 256])
torch.Size([640, 256])
torch.Size([110, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4412841796875 GB
    Memory Allocated: 1.0247550010681152  GigaBytes
Max Memory Allocated: 1.1735129356384277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4412841796875 GB
    Memory Allocated: 0.053466796875  GigaBytes
Max Memory Allocated: 1.1735129356384277  GigaBytes

torch.Size([9397, 500])
torch.Size([4998, 256])
torch.Size([1925, 256])
torch.Size([382, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8182373046875 GB
    Memory Allocated: 1.5215034484863281  GigaBytes
Max Memory Allocated: 1.52158784866333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8221435546875 GB
    Memory Allocated: 0.06180524826049805  GigaBytes
Max Memory Allocated: 1.5253386497497559  GigaBytes

torch.Size([13881, 500])
torch.Size([6165, 256])
torch.Size([1779, 256])
torch.Size([204, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.6126065254211426  GigaBytes
Max Memory Allocated: 1.6126556396484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.04976081848144531  GigaBytes
Max Memory Allocated: 1.6164655685424805  GigaBytes

torch.Size([7553, 500])
torch.Size([2737, 256])
torch.Size([582, 256])
torch.Size([122, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.7361893653869629  GigaBytes
Max Memory Allocated: 1.6164655685424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.05925559997558594  GigaBytes
Max Memory Allocated: 1.6164655685424805  GigaBytes

torch.Size([12531, 500])
torch.Size([5577, 256])
torch.Size([1411, 256])
torch.Size([293, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.4960613250732422  GigaBytes
Max Memory Allocated: 1.6164655685424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.057663917541503906  GigaBytes
Max Memory Allocated: 1.6164655685424805  GigaBytes

torch.Size([11614, 500])
torch.Size([5978, 256])
torch.Size([1800, 256])
torch.Size([348, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1014404296875 GB
    Memory Allocated: 1.7806429862976074  GigaBytes
Max Memory Allocated: 1.7808270454406738  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1053466796875 GB
    Memory Allocated: 0.05333137512207031  GigaBytes
Max Memory Allocated: 1.7845039367675781  GigaBytes

torch.Size([9424, 500])
torch.Size([3072, 256])
torch.Size([623, 256])
torch.Size([113, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1053466796875 GB
    Memory Allocated: 0.9565739631652832  GigaBytes
Max Memory Allocated: 1.7845039367675781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1053466796875 GB
    Memory Allocated: 0.06356287002563477  GigaBytes
Max Memory Allocated: 1.7845039367675781  GigaBytes

torch.Size([14737, 500])
torch.Size([9072, 256])
torch.Size([1950, 256])
torch.Size([320, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 2.145353317260742  GigaBytes
Max Memory Allocated: 2.145397186279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.05531883239746094  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([10135, 500])
torch.Size([4789, 256])
torch.Size([758, 256])
torch.Size([225, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 1.0678153038024902  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.049434661865234375  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([6874, 500])
torch.Size([3156, 256])
torch.Size([516, 256])
torch.Size([105, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.9612083435058594  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.05203056335449219  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([8726, 500])
torch.Size([3862, 256])
torch.Size([526, 256])
torch.Size([106, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 1.052687168121338  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009542338053385417 |0.024922657012939452 |0.23923598925272624 |0.000136868158976237 |0.27676690419514977 |0.01245427131652832 |
----------------------------------------------------------pseudo_mini_loss sum 1.763190746307373
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  228083
Number of first layer input nodes during this epoch:  144275
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.08843755722045898  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005328655242919922
random selection method range initialization spend 0.00013685226440429688
time for parepare:  7.152557373046875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.4066696166992188e-05
----------------------check_connections_block total spend ----------------------------- 0.002996683120727539
generate_one_block  0.0015687942504882812
generate_one_block  0.0011491775512695312
generate_one_block  0.0010666847229003906
generate_one_block  0.0010364055633544922
generate_one_block  0.0010461807250976562
generate_one_block  0.001064300537109375
generate_one_block  0.0011527538299560547
generate_one_block  0.00102996826171875
generate_one_block  0.0010542869567871094
generate_one_block  0.0010437965393066406
generate_one_block  0.001026153564453125
generate_one_block  0.0010385513305664062
generate_one_block  0.001089334487915039
generate_one_block  0.0010013580322265625
generate_one_block  0.0009784698486328125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000743865966796875
gen group dst list time:  9.059906005859375e-05
time for parepare:  0.00036787986755371094
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00011348724365234375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00018668174743652344
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  8.535385131835938e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  9.012222290039062e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.103515625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00010895729064941406
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  8.58306884765625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.437301635742188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00011968612670898438
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.00018668174743652344
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00015974044799804688
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  6.67572021484375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  8.845329284667969e-05
----------------------check_connections_block total spend ----------------------------- 0.0051174163818359375
generate_one_block  0.0012581348419189453
generate_one_block  0.0012187957763671875
generate_one_block  0.0013794898986816406
generate_one_block  0.0011823177337646484
generate_one_block  0.0011706352233886719
generate_one_block  0.001177072525024414
generate_one_block  0.0011105537414550781
generate_one_block  0.001196146011352539
generate_one_block  0.0011899471282958984
generate_one_block  0.0010919570922851562
generate_one_block  0.0011794567108154297
generate_one_block  0.0013246536254882812
generate_one_block  0.0012693405151367188
generate_one_block  0.001107931137084961
generate_one_block  0.0012011528015136719
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.006990194320678711
gen group dst list time:  0.0001881122589111328
time for parepare:  0.001050710678100586
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00043463706970214844
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00015282630920410156
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0005507469177246094
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0002276897430419922
mini_batch_src_global generation:  0.0002682209014892578
r_  generation:  0.0016126632690429688
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  0.0001068115234375
r_  generation:  0.00034999847412109375
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0006597042083740234
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0005521774291992188
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0002999305725097656
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0005519390106201172
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0004749298095703125
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.00029015541076660156
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0008075237274169922
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.000152587890625
r_  generation:  0.0013878345489501953
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  0.0001690387725830078
r_  generation:  0.0011126995086669922
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0003364086151123047
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0004787445068359375
----------------------check_connections_block total spend ----------------------------- 0.018725872039794922
generate_one_block  0.0016753673553466797
generate_one_block  0.001917123794555664
generate_one_block  0.0030913352966308594
generate_one_block  0.0014188289642333984
generate_one_block  0.0020322799682617188
generate_one_block  0.0016748905181884766
generate_one_block  0.0013840198516845703
generate_one_block  0.00165557861328125
generate_one_block  0.0016145706176757812
generate_one_block  0.0012695789337158203
generate_one_block  0.0020399093627929688
generate_one_block  0.002863645553588867
generate_one_block  0.0024566650390625
generate_one_block  0.0013616085052490234
generate_one_block  0.002336740493774414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002118825912475586
gen group dst list time:  0.0004050731658935547
time for parepare:  0.0016293525695800781
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0007166862487792969
mini_batch_src_global generation:  0.00011849403381347656
r_  generation:  0.0007472038269042969
local_output_nid generation:  0.000141143798828125
local_in_edges_tensor generation:  0.0003516674041748047
mini_batch_src_global generation:  0.0004355907440185547
r_  generation:  0.003479480743408203
local_output_nid generation:  0.00018095970153808594
local_in_edges_tensor generation:  0.0004048347473144531
mini_batch_src_global generation:  0.0006842613220214844
r_  generation:  0.0050754547119140625
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.00024199485778808594
mini_batch_src_global generation:  0.0002562999725341797
r_  generation:  0.0016944408416748047
local_output_nid generation:  0.00019550323486328125
local_in_edges_tensor generation:  0.00040435791015625
mini_batch_src_global generation:  0.0003705024719238281
r_  generation:  0.0040209293365478516
local_output_nid generation:  9.417533874511719e-05
local_in_edges_tensor generation:  0.00026869773864746094
mini_batch_src_global generation:  0.0003631114959716797
r_  generation:  0.0026540756225585938
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  0.0002086162567138672
r_  generation:  0.0017099380493164062
local_output_nid generation:  9.441375732421875e-05
local_in_edges_tensor generation:  0.0002624988555908203
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.00232696533203125
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  0.000263214111328125
r_  generation:  0.0025637149810791016
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  0.00015091896057128906
r_  generation:  0.000843048095703125
local_output_nid generation:  0.0001494884490966797
local_in_edges_tensor generation:  0.0003445148468017578
mini_batch_src_global generation:  0.00037407875061035156
r_  generation:  0.004559755325317383
local_output_nid generation:  0.00022220611572265625
local_in_edges_tensor generation:  0.0004277229309082031
mini_batch_src_global generation:  0.0007047653198242188
r_  generation:  0.005781650543212891
local_output_nid generation:  0.00021076202392578125
local_in_edges_tensor generation:  0.00040411949157714844
mini_batch_src_global generation:  0.0005583763122558594
r_  generation:  0.005764961242675781
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  0.00028061866760253906
r_  generation:  0.001667022705078125
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.0002617835998535156
mini_batch_src_global generation:  0.0002906322479248047
r_  generation:  0.0029528141021728516
----------------------check_connections_block total spend ----------------------------- 0.07193875312805176
generate_one_block  0.0027277469635009766
generate_one_block  0.006458282470703125
generate_one_block  0.007740497589111328
generate_one_block  0.003204822540283203
generate_one_block  0.006710529327392578
generate_one_block  0.004593849182128906
generate_one_block  0.0035212039947509766
generate_one_block  0.004343509674072266
generate_one_block  0.004767894744873047
generate_one_block  0.002038240432739258
generate_one_block  0.007858753204345703
generate_one_block  0.009275197982788086
generate_one_block  0.009180784225463867
generate_one_block  0.003299236297607422
generate_one_block  0.005377292633056641
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0023691654205322266
gen group dst list time:  0.001505136489868164
time for parepare:  0.0018434524536132812
local_output_nid generation:  0.0002009868621826172
local_in_edges_tensor generation:  0.0012154579162597656
mini_batch_src_global generation:  0.0004572868347167969
r_  generation:  0.003626108169555664
local_output_nid generation:  0.0006241798400878906
local_in_edges_tensor generation:  0.0009682178497314453
mini_batch_src_global generation:  0.0011637210845947266
r_  generation:  0.011056184768676758
local_output_nid generation:  0.0004572868347167969
local_in_edges_tensor generation:  0.0008416175842285156
mini_batch_src_global generation:  0.0010597705841064453
r_  generation:  0.008909225463867188
local_output_nid generation:  0.0003325939178466797
local_in_edges_tensor generation:  0.0005819797515869141
mini_batch_src_global generation:  0.0005843639373779297
r_  generation:  0.005505561828613281
local_output_nid generation:  0.0006313323974609375
local_in_edges_tensor generation:  0.0009565353393554688
mini_batch_src_global generation:  0.0009999275207519531
r_  generation:  0.012053489685058594
local_output_nid generation:  0.00037097930908203125
local_in_edges_tensor generation:  0.0006282329559326172
mini_batch_src_global generation:  0.0009310245513916016
r_  generation:  0.007840394973754883
local_output_nid generation:  0.00043129920959472656
local_in_edges_tensor generation:  0.0006330013275146484
mini_batch_src_global generation:  0.0007774829864501953
r_  generation:  0.007825374603271484
local_output_nid generation:  0.0004558563232421875
local_in_edges_tensor generation:  0.0006191730499267578
mini_batch_src_global generation:  0.0006666183471679688
r_  generation:  0.007149934768676758
local_output_nid generation:  0.0005197525024414062
local_in_edges_tensor generation:  0.0007026195526123047
mini_batch_src_global generation:  0.0007367134094238281
r_  generation:  0.008522748947143555
local_output_nid generation:  0.00014138221740722656
local_in_edges_tensor generation:  0.0002827644348144531
mini_batch_src_global generation:  0.00039267539978027344
r_  generation:  0.002687215805053711
local_output_nid generation:  0.0009357929229736328
local_in_edges_tensor generation:  0.001119852066040039
mini_batch_src_global generation:  0.0011141300201416016
r_  generation:  0.015114068984985352
local_output_nid generation:  0.0006680488586425781
local_in_edges_tensor generation:  0.0013360977172851562
mini_batch_src_global generation:  0.00139617919921875
r_  generation:  0.012821197509765625
local_output_nid generation:  0.0007939338684082031
local_in_edges_tensor generation:  0.0011856555938720703
mini_batch_src_global generation:  0.0014252662658691406
r_  generation:  0.0163271427154541
local_output_nid generation:  0.0003635883331298828
local_in_edges_tensor generation:  0.0005590915679931641
mini_batch_src_global generation:  0.0007627010345458984
r_  generation:  0.005915641784667969
local_output_nid generation:  0.0005993843078613281
local_in_edges_tensor generation:  0.0008318424224853516
mini_batch_src_global generation:  0.0009634494781494141
r_  generation:  0.01145172119140625
----------------------check_connections_block total spend ----------------------------- 0.20611214637756348
generate_one_block  0.007531642913818359
generate_one_block  0.015527725219726562
generate_one_block  0.013277053833007812
generate_one_block  0.008907794952392578
generate_one_block  0.016371965408325195
generate_one_block  0.012005329132080078
generate_one_block  0.012003660202026367
generate_one_block  0.010313987731933594
generate_one_block  0.013596296310424805
generate_one_block  0.0044403076171875
generate_one_block  0.019957542419433594
generate_one_block  0.017803668975830078
generate_one_block  0.022953033447265625
generate_one_block  0.009245157241821289
generate_one_block  0.015452384948730469
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.08843755722045898  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

connection checking time:  0.3018941879272461
block generation total time  0.3273351192474365
average batch blocks generation time:  0.021822341283162437
block dataloader generation time/epoch 0.8256447315216064
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.08149099349975586  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([5293, 500])
torch.Size([1401, 256])
torch.Size([229, 256])
torch.Size([77, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.48503923416137695  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.09223079681396484  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([10914, 500])
torch.Size([5200, 256])
torch.Size([971, 256])
torch.Size([203, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 1.4021191596984863  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.08629655838012695  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([7707, 500])
torch.Size([4273, 256])
torch.Size([1465, 256])
torch.Size([329, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 1.387434482574463  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.08544635772705078  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([7375, 500])
torch.Size([2614, 256])
torch.Size([603, 256])
torch.Size([95, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.7420921325683594  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.09668827056884766  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([13287, 500])
torch.Size([5677, 256])
torch.Size([1537, 256])
torch.Size([175, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 1.52783203125  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.08548307418823242  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([7284, 500])
torch.Size([3222, 256])
torch.Size([875, 256])
torch.Size([139, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 1.0659337043762207  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.08997726440429688  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([9767, 500])
torch.Size([3545, 256])
torch.Size([490, 256])
torch.Size([110, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 1.0255165100097656  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.08772134780883789  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([8562, 500])
torch.Size([3795, 256])
torch.Size([835, 256])
torch.Size([210, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.9452996253967285  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.09134626388549805  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([10080, 500])
torch.Size([4613, 256])
torch.Size([744, 256])
torch.Size([191, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 1.109182357788086  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.07848882675170898  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([3694, 500])
torch.Size([1145, 256])
torch.Size([334, 256])
torch.Size([114, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.3729414939880371  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.09742212295532227  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([13633, 500])
torch.Size([8032, 256])
torch.Size([1398, 256])
torch.Size([302, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 1.85023832321167  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.09410333633422852  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([11844, 500])
torch.Size([5692, 256])
torch.Size([1867, 256])
torch.Size([331, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5447998046875 GB
    Memory Allocated: 1.7745122909545898  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5487060546875 GB
    Memory Allocated: 0.09983348846435547  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([14884, 500])
torch.Size([7639, 256])
torch.Size([2114, 256])
torch.Size([334, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5487060546875 GB
    Memory Allocated: 2.0846152305603027  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5487060546875 GB
    Memory Allocated: 0.08628082275390625  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes
Using backend: pytorch

torch.Size([7820, 500])
torch.Size([3033, 256])
torch.Size([511, 256])
torch.Size([146, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5487060546875 GB
    Memory Allocated: 0.7689199447631836  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5487060546875 GB
    Memory Allocated: 0.09229421615600586  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

torch.Size([10948, 500])
torch.Size([5194, 256])
torch.Size([810, 256])
torch.Size([173, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5487060546875 GB
    Memory Allocated: 1.4209837913513184  GigaBytes
Max Memory Allocated: 2.1492161750793457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009776608149210612 |0.00230714480082194 |0.2097391128540039 |0.00014398892720540363 |0.3481696605682373 |0.010903358459472656 |
----------------------------------------------------------pseudo_mini_loss sum 2.908313751220703
Total (block generation + training)time/epoch 9.425758600234985
Training time/epoch 8.599839687347412
Training time without block to device /epoch 8.565232515335083
Training time without total dataloading part /epoch 8.381694793701172
load block tensor time/epoch 0.14664912223815918
block to device time/epoch 0.0346071720123291
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  226236
Number of first layer input nodes during this epoch:  143092
