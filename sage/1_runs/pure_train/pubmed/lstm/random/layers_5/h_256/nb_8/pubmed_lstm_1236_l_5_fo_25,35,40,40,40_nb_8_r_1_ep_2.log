main start at this time 1648532580.7975287
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0467529296875 GB
    Memory Allocated: 0.01775074005126953  GigaBytes
Max Memory Allocated: 0.01775074005126953  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011448860168457031
random selection method range initialization spend 0.00020694732666015625
time for parepare:  4.863739013671875e-05
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0015289783477783203
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.9802322387695312e-05
----------------------check_connections_block total spend ----------------------------- 0.002594470977783203
generate_one_block  0.0013036727905273438
generate_one_block  0.0011174678802490234
generate_one_block  0.001108407974243164
generate_one_block  0.0010731220245361328
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007908344268798828
gen group dst list time:  3.5762786865234375e-05
time for parepare:  0.0002460479736328125
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00021648406982421875
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00040149688720703125
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0004520416259765625
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0002570152282714844
----------------------check_connections_block total spend ----------------------------- 0.002847909927368164
generate_one_block  0.0013623237609863281
generate_one_block  0.0016405582427978516
generate_one_block  0.0016591548919677734
generate_one_block  0.001405477523803711
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011115074157714844
gen group dst list time:  7.581710815429688e-05
time for parepare:  0.0008130073547363281
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.0002942085266113281
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0010251998901367188
local_output_nid generation:  6.771087646484375e-05
local_in_edges_tensor generation:  0.0002505779266357422
mini_batch_src_global generation:  0.0003452301025390625
r_  generation:  0.002908468246459961
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.000263214111328125
mini_batch_src_global generation:  0.00039887428283691406
r_  generation:  0.003118276596069336
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  0.0001971721649169922
r_  generation:  0.0015976428985595703
----------------------check_connections_block total spend ----------------------------- 0.014167308807373047
generate_one_block  0.0024051666259765625
generate_one_block  0.004714250564575195
generate_one_block  0.004791259765625
generate_one_block  0.002765655517578125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019452571868896484
gen group dst list time:  0.0002338886260986328
time for parepare:  0.001546621322631836
local_output_nid generation:  0.00013971328735351562
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.0005497932434082031
r_  generation:  0.0045337677001953125
local_output_nid generation:  0.00034165382385253906
local_in_edges_tensor generation:  0.0007646083831787109
mini_batch_src_global generation:  0.0012285709381103516
r_  generation:  0.011781454086303711
local_output_nid generation:  0.0003352165222167969
local_in_edges_tensor generation:  0.0006792545318603516
mini_batch_src_global generation:  0.0010638236999511719
r_  generation:  0.011206388473510742
local_output_nid generation:  0.00020575523376464844
local_in_edges_tensor generation:  0.0011682510375976562
mini_batch_src_global generation:  0.0009119510650634766
r_  generation:  0.007831335067749023
----------------------check_connections_block total spend ----------------------------- 0.05356264114379883
generate_one_block  0.006922245025634766
generate_one_block  0.014865398406982422
generate_one_block  0.015646934509277344
generate_one_block  0.012560606002807617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0016810894012451172
gen group dst list time:  0.0007295608520507812
time for parepare:  0.0018007755279541016
local_output_nid generation:  0.0006067752838134766
local_in_edges_tensor generation:  0.0012819766998291016
mini_batch_src_global generation:  0.0012154579162597656
r_  generation:  0.013040304183959961
local_output_nid generation:  0.0009925365447998047
local_in_edges_tensor generation:  0.0015523433685302734
mini_batch_src_global generation:  0.002098560333251953
r_  generation:  0.020581960678100586
local_output_nid generation:  0.0010035037994384766
local_in_edges_tensor generation:  0.0013933181762695312
mini_batch_src_global generation:  0.0018699169158935547
r_  generation:  0.02090930938720703
local_output_nid generation:  0.0011060237884521484
local_in_edges_tensor generation:  0.001432657241821289
mini_batch_src_global generation:  0.0016541481018066406
r_  generation:  0.02004265785217285
----------------------check_connections_block total spend ----------------------------- 0.10933518409729004
generate_one_block  0.01633453369140625
generate_one_block  0.027675628662109375
generate_one_block  0.02695608139038086
generate_one_block  0.0268399715423584
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0467529296875 GB
    Memory Allocated: 0.01775074005126953  GigaBytes
Max Memory Allocated: 0.01775074005126953  GigaBytes

connection checking time:  0.17991304397583008
block generation total time  0.16854524612426758
average batch blocks generation time:  0.042136311531066895
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.04169607162475586  GigaBytes
Max Memory Allocated: 0.04169607162475586  GigaBytes

torch.Size([12617, 500])
torch.Size([6650, 256])
torch.Size([1613, 256])
torch.Size([470, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8201904296875 GB
    Memory Allocated: 1.5475497245788574  GigaBytes
Max Memory Allocated: 1.5476322174072266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8260498046875 GB
    Memory Allocated: 0.06769895553588867  GigaBytes
Max Memory Allocated: 1.5524697303771973  GigaBytes

torch.Size([16824, 500])
torch.Size([11169, 256])
torch.Size([4258, 256])
torch.Size([829, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.8091063499450684  GigaBytes
Max Memory Allocated: 2.8092455863952637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.06735038757324219  GigaBytes
Max Memory Allocated: 2.8128843307495117  GigaBytes

torch.Size([16644, 500])
torch.Size([10849, 256])
torch.Size([4042, 256])
torch.Size([873, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 2.7754220962524414  GigaBytes
Max Memory Allocated: 2.8128843307495117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1209716796875 GB
    Memory Allocated: 0.0657033920288086  GigaBytes
Max Memory Allocated: 2.8128843307495117  GigaBytes

torch.Size([15830, 500])
torch.Size([11188, 256])
torch.Size([2485, 256])
torch.Size([645, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 2.463047981262207  GigaBytes
Max Memory Allocated: 2.8128843307495117  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012539207935333252 |0.08559650182723999 |0.4125747084617615 |0.00017780065536499023 |0.37967830896377563 |0.01241612434387207 |
----------------------------------------------------------pseudo_mini_loss sum 1.841133952140808
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  117341
Number of first layer input nodes during this epoch:  61915
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.10318231582641602  GigaBytes
Max Memory Allocated: 2.8128843307495117  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000553131103515625
random selection method range initialization spend 0.00013375282287597656
time for parepare:  6.103515625e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.172325134277344e-05
----------------------check_connections_block total spend ----------------------------- 0.001142263412475586
generate_one_block  0.0012450218200683594
generate_one_block  0.0011260509490966797
generate_one_block  0.0011210441589355469
generate_one_block  0.0011298656463623047
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005731582641601562
gen group dst list time:  3.7670135498046875e-05
time for parepare:  0.00029206275939941406
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0003612041473388672
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00024580955505371094
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0004668235778808594
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.00035190582275390625
----------------------check_connections_block total spend ----------------------------- 0.0031478404998779297
generate_one_block  0.001809835433959961
generate_one_block  0.0014548301696777344
generate_one_block  0.0017936229705810547
generate_one_block  0.0015723705291748047
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010516643524169922
gen group dst list time:  9.608268737792969e-05
time for parepare:  0.0007612705230712891
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.00032210350036621094
mini_batch_src_global generation:  0.00026917457580566406
r_  generation:  0.002553224563598633
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.0002186298370361328
r_  generation:  0.0015566349029541016
local_output_nid generation:  0.00010967254638671875
local_in_edges_tensor generation:  0.0002646446228027344
mini_batch_src_global generation:  0.00026416778564453125
r_  generation:  0.0029478073120117188
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.00023794174194335938
r_  generation:  0.002050638198852539
----------------------check_connections_block total spend ----------------------------- 0.014568805694580078
generate_one_block  0.004657745361328125
generate_one_block  0.0030345916748046875
generate_one_block  0.004795074462890625
generate_one_block  0.0036995410919189453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018677711486816406
gen group dst list time:  0.00026154518127441406
time for parepare:  0.001447439193725586
local_output_nid generation:  0.0003058910369873047
local_in_edges_tensor generation:  0.0007691383361816406
mini_batch_src_global generation:  0.0009086132049560547
r_  generation:  0.008893728256225586
local_output_nid generation:  0.00027751922607421875
local_in_edges_tensor generation:  0.0005609989166259766
mini_batch_src_global generation:  0.001073598861694336
r_  generation:  0.007375240325927734
local_output_nid generation:  0.00031304359436035156
local_in_edges_tensor generation:  0.0006024837493896484
mini_batch_src_global generation:  0.001100778579711914
r_  generation:  0.011596918106079102
local_output_nid generation:  0.00030684471130371094
local_in_edges_tensor generation:  0.0005996227264404297
mini_batch_src_global generation:  0.001032114028930664
r_  generation:  0.00912618637084961
----------------------check_connections_block total spend ----------------------------- 0.05591726303100586
generate_one_block  0.013282060623168945
generate_one_block  0.011867523193359375
generate_one_block  0.016134977340698242
generate_one_block  0.01482844352722168
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018985271453857422
gen group dst list time:  0.0008571147918701172
time for parepare:  0.001657724380493164
local_output_nid generation:  0.0009601116180419922
local_in_edges_tensor generation:  0.0016736984252929688
mini_batch_src_global generation:  0.0016741752624511719
r_  generation:  0.01783132553100586
local_output_nid generation:  0.0009000301361083984
local_in_edges_tensor generation:  0.001443624496459961
mini_batch_src_global generation:  0.0020079612731933594
r_  generation:  0.019017934799194336
local_output_nid generation:  0.001218557357788086
local_in_edges_tensor generation:  0.0016736984252929688
mini_batch_src_global generation:  0.0019185543060302734
r_  generation:  0.021841764450073242
local_output_nid generation:  0.0011320114135742188
local_in_edges_tensor generation:  0.0017020702362060547
mini_batch_src_global generation:  0.001912832260131836Using backend: pytorch

r_  generation:  0.02123713493347168
----------------------check_connections_block total spend ----------------------------- 0.11779189109802246
generate_one_block  0.024608850479125977
generate_one_block  0.028591156005859375
generate_one_block  0.03073573112487793
generate_one_block  0.028806447982788086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.10318231582641602  GigaBytes
Max Memory Allocated: 2.8128843307495117  GigaBytes

connection checking time:  0.19142580032348633
block generation total time  0.19167280197143555
average batch blocks generation time:  0.04791820049285889
block dataloader generation time/epoch 0.4510788917541504
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.10057878494262695  GigaBytes
Max Memory Allocated: 2.8128843307495117  GigaBytes

torch.Size([15024, 500])
torch.Size([9078, 256])
torch.Size([2838, 256])
torch.Size([690, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 2.389573097229004  GigaBytes
Max Memory Allocated: 2.8128843307495117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.10239982604980469  GigaBytes
Max Memory Allocated: 2.8128843307495117  GigaBytes

torch.Size([16014, 500])
torch.Size([9499, 256])
torch.Size([2796, 256])
torch.Size([471, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 2.4062724113464355  GigaBytes
Max Memory Allocated: 2.8128843307495117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1483154296875 GB
    Memory Allocated: 0.10365867614746094  GigaBytes
Max Memory Allocated: 2.8128843307495117  GigaBytes

torch.Size([16594, 500])
torch.Size([12416, 256])
torch.Size([3702, 256])
torch.Size([1003, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2752685546875 GB
    Memory Allocated: 2.887202739715576  GigaBytes
Max Memory Allocated: 2.888111114501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2791748046875 GB
    Memory Allocated: 0.10387611389160156  GigaBytes
Max Memory Allocated: 2.8910045623779297  GigaBytes

torch.Size([16758, 500])
torch.Size([10917, 256])
torch.Size([3394, 256])
torch.Size([704, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2791748046875 GB
    Memory Allocated: 2.6549763679504395  GigaBytes
Max Memory Allocated: 2.8910045623779297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011123180389404297 |0.001690983772277832 |0.27188193798065186 |0.00013822317123413086 |0.3997294306755066 |0.009250879287719727 |
----------------------------------------------------------pseudo_mini_loss sum 2.2806670665740967
Total (block generation + training)time/epoch 3.2101118564605713
Training time/epoch 2.758574962615967
Training time without block to device /epoch 2.7518110275268555
Training time without total dataloading part /epoch 2.69624924659729
load block tensor time/epoch 0.04449272155761719
block to device time/epoch 0.006763935089111328
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  122255
Number of first layer input nodes during this epoch:  64390
