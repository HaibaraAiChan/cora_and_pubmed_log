main start at this time 1648532390.9937544
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008303642272949219  GigaBytes
Max Memory Allocated: 0.008303642272949219  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005161762237548828
random selection method range initialization spend 0.0001823902130126953
time for parepare:  4.172325134277344e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0009436607360839844
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.7220458984375e-05
----------------------check_connections_block total spend ----------------------------- 0.0015621185302734375
generate_one_block  0.0011219978332519531
generate_one_block  0.0010738372802734375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005040168762207031
gen group dst list time:  2.4557113647460938e-05
time for parepare:  0.0002238750457763672
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.0006885528564453125
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.00045490264892578125
----------------------check_connections_block total spend ----------------------------- 0.0022292137145996094
generate_one_block  0.001968860626220703
generate_one_block  0.0015096664428710938
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010879039764404297
gen group dst list time:  6.103515625e-05
time for parepare:  0.0006971359252929688
local_output_nid generation:  0.0001125335693359375
local_in_edges_tensor generation:  0.0004284381866455078
mini_batch_src_global generation:  0.0003407001495361328
r_  generation:  0.004562854766845703
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.00026297569274902344
mini_batch_src_global generation:  0.00039839744567871094
r_  generation:  0.002718687057495117
----------------------check_connections_block total spend ----------------------------- 0.011649608612060547
generate_one_block  0.0074503421783447266
generate_one_block  0.004645586013793945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001998424530029297
gen group dst list time:  0.00019669532775878906
time for parepare:  0.004298210144042969
local_output_nid generation:  0.0005171298980712891
local_in_edges_tensor generation:  0.0046389102935791016
mini_batch_src_global generation:  0.0019729137420654297
r_  generation:  0.014236927032470703
local_output_nid generation:  0.0003440380096435547
local_in_edges_tensor generation:  0.000782012939453125
mini_batch_src_global generation:  0.0013625621795654297
r_  generation:  0.011671066284179688
----------------------check_connections_block total spend ----------------------------- 0.04753875732421875
generate_one_block  0.01990342140197754
generate_one_block  0.0163877010345459
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0059967041015625
gen group dst list time:  0.00047087669372558594
time for parepare:  0.0016429424285888672
local_output_nid generation:  0.0010945796966552734
local_in_edges_tensor generation:  0.0020542144775390625
mini_batch_src_global generation:  0.002154111862182617
r_  generation:  0.022108078002929688
local_output_nid generation:  0.0009393692016601562
local_in_edges_tensor generation:  0.0022437572479248047
mini_batch_src_global generation:  0.0022928714752197266
r_  generation:  0.021286487579345703
----------------------check_connections_block total spend ----------------------------- 0.06600403785705566
generate_one_block  0.027675390243530273
generate_one_block  0.02781057357788086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008303642272949219  GigaBytes
Max Memory Allocated: 0.008303642272949219  GigaBytes

connection checking time:  0.12742161750793457
block generation total time  0.10735154151916504
average batch blocks generation time:  0.05367577075958252
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1346435546875 GB
    Memory Allocated: 0.04256296157836914  GigaBytes
Max Memory Allocated: 0.04256296157836914  GigaBytes

torch.Size([17742, 500])
torch.Size([14262, 64])
torch.Size([5677, 64])
torch.Size([1657, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 2.4767627716064453  GigaBytes
Max Memory Allocated: 2.4768295288085938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.05043649673461914  GigaBytes
Max Memory Allocated: 2.4769601821899414  GigaBytes

torch.Size([17676, 500])
torch.Size([12810, 64])
torch.Size([4712, 64])
torch.Size([1080, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 2.3356738090515137  GigaBytes
Max Memory Allocated: 2.4769601821899414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015130162239074707 |0.17358291149139404 |0.5559265613555908 |0.00020635128021240234 |0.4878309965133667 |0.011972904205322266 |
----------------------------------------------------------pseudo_mini_loss sum 1.7561054229736328
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  75971
Number of first layer input nodes during this epoch:  35418
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.06901168823242188  GigaBytes
Max Memory Allocated: 2.4769601821899414  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00054168701171875
random selection method range initialization spend 0.0001227855682373047
time for parepare:  5.078315734863281e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  5.7697296142578125e-05
----------------------check_connections_block total spend ----------------------------- 0.0006978511810302734
generate_one_block  0.0011322498321533203
generate_one_block  0.0010676383972167969
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005640983581542969
gen group dst list time:  2.9087066650390625e-05
time for parepare:  0.0002605915069580078
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.0006463527679443359
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation: Using backend: pytorch
 9.202957153320312e-05
r_  generation:  0.0005552768707275391
----------------------check_connections_block total spend ----------------------------- 0.002458333969116211
generate_one_block  0.0020453929901123047
generate_one_block  0.0017926692962646484
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009844303131103516
gen group dst list time:  7.486343383789062e-05
time for parepare:  0.0007269382476806641
local_output_nid generation:  0.0001697540283203125
local_in_edges_tensor generation:  0.0004124641418457031
mini_batch_src_global generation:  0.00039505958557128906
r_  generation:  0.004334211349487305
local_output_nid generation:  0.00011277198791503906
local_in_edges_tensor generation:  0.00027060508728027344
mini_batch_src_global generation:  0.0004508495330810547
r_  generation:  0.0035741329193115234
----------------------check_connections_block total spend ----------------------------- 0.01252293586730957
generate_one_block  0.008371353149414062
generate_one_block  0.005867481231689453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020902156829833984
gen group dst list time:  0.00018930435180664062
time for parepare:  0.001239776611328125
local_output_nid generation:  0.00041222572326660156
local_in_edges_tensor generation:  0.0011630058288574219
mini_batch_src_global generation:  0.001252889633178711
r_  generation:  0.015520572662353516
local_output_nid generation:  0.00043320655822753906
local_in_edges_tensor generation:  0.0007817745208740234
mini_batch_src_global generation:  0.0013723373413085938
r_  generation:  0.012395620346069336
----------------------check_connections_block total spend ----------------------------- 0.04128098487854004
generate_one_block  0.02179121971130371
generate_one_block  0.018117427825927734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018239021301269531
gen group dst list time:  0.0005326271057128906
time for parepare:  0.0014660358428955078
local_output_nid generation:  0.0010941028594970703
local_in_edges_tensor generation:  0.002052783966064453
mini_batch_src_global generation:  0.0021409988403320312
r_  generation:  0.023717880249023438
local_output_nid generation:  0.001178741455078125
local_in_edges_tensor generation:  0.0021491050720214844
mini_batch_src_global generation:  0.002415895462036133
r_  generation:  0.021095991134643555
----------------------check_connections_block total spend ----------------------------- 0.06716227531433105
generate_one_block  0.03138089179992676
generate_one_block  0.029573917388916016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.06901168823242188  GigaBytes
Max Memory Allocated: 2.4769601821899414  GigaBytes

connection checking time:  0.12342453002929688
block generation total time  0.11894035339355469
average batch blocks generation time:  0.059470176696777344
block dataloader generation time/epoch 0.28943324089050293
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.06799745559692383  GigaBytes
Max Memory Allocated: 2.4769601821899414  GigaBytes

torch.Size([17777, 500])
torch.Size([14474, 64])
torch.Size([5913, 64])
torch.Size([1585, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0252685546875 GB
    Memory Allocated: 2.508981704711914  GigaBytes
Max Memory Allocated: 2.509047031402588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0252685546875 GB
    Memory Allocated: 0.06763458251953125  GigaBytes
Max Memory Allocated: 2.5091781616210938  GigaBytes

torch.Size([17634, 500])
torch.Size([13257, 64])
torch.Size([4865, 64])
torch.Size([1219, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0252685546875 GB
    Memory Allocated: 2.4073057174682617  GigaBytes
Max Memory Allocated: 2.5091781616210938  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014706254005432129 |0.001962423324584961 |0.3004418611526489 |0.0001519918441772461 |0.5219920873641968 |0.010713338851928711 |
----------------------------------------------------------pseudo_mini_loss sum 1.5113847255706787
Total (block generation + training)time/epoch 1.9860689640045166
Training time/epoch 1.6962673664093018
Training time without block to device /epoch 1.6923425197601318
Training time without total dataloading part /epoch 1.6558852195739746
load block tensor time/epoch 0.029412508010864258
block to device time/epoch 0.003924846649169922
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  77080
Number of first layer input nodes during this epoch:  35411
