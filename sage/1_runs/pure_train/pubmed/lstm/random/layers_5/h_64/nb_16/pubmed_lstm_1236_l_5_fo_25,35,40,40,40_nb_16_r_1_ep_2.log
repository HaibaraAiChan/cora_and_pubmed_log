main start at this time 1648532420.6943877
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008303642272949219  GigaBytes
Max Memory Allocated: 0.008303642272949219  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.002162933349609375
random selection method range initialization spend 0.0002040863037109375
time for parepare:  4.553794860839844e-05
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0015225410461425781
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.5735626220703125e-05
----------------------check_connections_block total spend ----------------------------- 0.003112316131591797
generate_one_block  0.0012125968933105469
generate_one_block  0.0009872913360595703
generate_one_block  0.0009582042694091797
generate_one_block  0.0010144710540771484
generate_one_block  0.0009887218475341797
generate_one_block  0.0009989738464355469
generate_one_block  0.0009484291076660156
generate_one_block  0.0009467601776123047
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011229515075683594
gen group dst list time:  4.696846008300781e-05
time for parepare:  0.0002205371856689453
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.000179290771484375
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00032329559326171875
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00014257431030273438
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00016927719116210938
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00012826919555664062
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00017070770263671875
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  9.72747802734375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.390975952148438e-05
----------------------check_connections_block total spend ----------------------------- 0.0033240318298339844
generate_one_block  0.0012226104736328125
generate_one_block  0.0014042854309082031
generate_one_block  0.001130819320678711
generate_one_block  0.0011639595031738281
generate_one_block  0.0011756420135498047
generate_one_block  0.0011944770812988281
generate_one_block  0.001064300537109375
generate_one_block  0.0010249614715576172
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011565685272216797
gen group dst list time:  9.465217590332031e-05
time for parepare:  0.000705718994140625
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.0002760887145996094
mini_batch_src_global generation:  0.00010442733764648438
r_  generation:  0.0010755062103271484
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  0.0003540515899658203
r_  generation:  0.0023784637451171875
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  0.00012612342834472656
r_  generation:  0.0008170604705810547
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  0.00010800361633300781
r_  generation:  0.0010399818420410156
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0006451606750488281
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  0.00010561943054199219
r_  generation:  0.0010597705841064453
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.0004837512969970703
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.00036215782165527344
----------------------check_connections_block total spend ----------------------------- 0.013524293899536133
generate_one_block  0.003111600875854492
generate_one_block  0.00410008430480957
generate_one_block  0.0019211769104003906
generate_one_block  0.002463817596435547
generate_one_block  0.0017633438110351562
generate_one_block  0.0023293495178222656
generate_one_block  0.0015149116516113281
generate_one_block  0.0014109611511230469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021953582763671875
gen group dst list time:  0.0002548694610595703
time for parepare:  0.0015790462493896484
local_output_nid generation:  0.00018310546875
local_in_edges_tensor generation:  0.0007684230804443359
mini_batch_src_global generation:  0.0007386207580566406
r_  generation:  0.005826473236083984
local_output_nid generation:  0.000232696533203125
local_in_edges_tensor generation:  0.0006046295166015625
mini_batch_src_global generation:  0.0010251998901367188
r_  generation:  0.00773167610168457
local_output_nid generation:  0.00012135505676269531
local_in_edges_tensor generation:  0.00034046173095703125
mini_batch_src_global generation:  0.0005364418029785156
r_  generation:  0.004939556121826172
local_output_nid generation:  0.00018358230590820312
local_in_edges_tensor generation:  0.0004162788391113281
mini_batch_src_global generation:  0.0005190372467041016
r_  generation:  0.005552530288696289
local_output_nid generation:  0.00010561943054199219
local_in_edges_tensor generation:  0.000286102294921875
mini_batch_src_global generation:  0.0004169940948486328
r_  generation:  0.0038738250732421875
local_output_nid generation:  0.00015592575073242188
local_in_edges_tensor generation:  0.00037479400634765625
mini_batch_src_global generation:  0.0005090236663818359
r_  generation:  0.005594015121459961
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  0.0003447532653808594
r_  generation:  0.0022819042205810547
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.0002627372741699219
r_  generation:  0.0018570423126220703
----------------------check_connections_block total spend ----------------------------- 0.0575098991394043
generate_one_block  0.0097503662109375
generate_one_block  0.01235198974609375
generate_one_block  0.007861614227294922
generate_one_block  0.008331537246704102
generate_one_block  0.006006717681884766
generate_one_block  0.009101629257202148
generate_one_block  0.003961324691772461
generate_one_block  0.0033617019653320312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002331256866455078
gen group dst list time:  0.0012192726135253906
time for parepare:  0.0017163753509521484
local_output_nid generation:  0.0008046627044677734
local_in_edges_tensor generation:  0.0019023418426513672
mini_batch_src_global generation:  0.0015940666198730469
r_  generation:  0.01626753807067871
local_output_nid generation:  0.0006928443908691406
local_in_edges_tensor generation:  0.0016400814056396484
mini_batch_src_global generation:  0.0018439292907714844
r_  generation:  0.015162229537963867
local_output_nid generation:  0.0006330013275146484
local_in_edges_tensor generation:  0.0010368824005126953
mini_batch_src_global generation:  0.0012760162353515625
r_  generation:  0.01434469223022461
local_output_nid generation:  0.0006680488586425781
local_in_edges_tensor generation:  0.0010557174682617188
mini_batch_src_global generation:  0.0013167858123779297
r_  generation:  0.01478886604309082
local_output_nid generation:  0.00048470497131347656
local_in_edges_tensor generation:  0.0007765293121337891
mini_batch_src_global generation:  0.0010993480682373047
r_  generation:  0.011757373809814453
local_output_nid generation:  0.0005698204040527344
local_in_edges_tensor generation:  0.0009751319885253906
mini_batch_src_global generation:  0.0010983943939208984
r_  generation:  0.014948368072509766
local_output_nid generation:  0.00034689903259277344
local_in_edges_tensor generation:  0.0005862712860107422
mini_batch_src_global generation:  0.0008492469787597656
r_  generation:  0.007562875747680664
local_output_nid generation:  0.0003235340118408203
local_in_edges_tensor generation:  0.0005450248718261719
mini_batch_src_global generation:  0.0007512569427490234
r_  generation:  0.0076503753662109375
----------------------check_connections_block total spend ----------------------------- 0.15177369117736816
generate_one_block  0.02361273765563965
generate_one_block  0.02102804183959961
generate_one_block  0.019287824630737305
generate_one_block  0.019861459732055664
generate_one_block  0.01585841178894043
generate_one_block  0.019942522048950195
generate_one_block  0.010550498962402344
generate_one_block  0.010769128799438477
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008303642272949219  GigaBytes
Max Memory Allocated: 0.008303642272949219  GigaBytes

connection checking time:  0.22613191604614258
block generation total time  0.22963380813598633
average batch blocks generation time:  0.02870422601699829
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1307373046875 GB
    Memory Allocated: 0.036858558654785156  GigaBytes
Max Memory Allocated: 0.036858558654785156  GigaBytes

torch.Size([14997, 500])
torch.Size([9495, 64])
torch.Size([2167, 64])
torch.Size([433, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.8034029006958008  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.0426793098449707  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

torch.Size([13625, 500])
torch.Size([8079, 64])
torch.Size([2840, 64])
torch.Size([663, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 1.7617015838623047  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 0.04206657409667969  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

torch.Size([13379, 500])
torch.Size([7780, 64])
torch.Size([1401, 64])
torch.Size([353, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 1.6161890029907227  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 0.04515981674194336  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

torch.Size([15032, 500])
torch.Size([8236, 64])
torch.Size([2291, 64])
torch.Size([417, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 1.6203360557556152  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 0.038707733154296875  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

torch.Size([11637, 500])
torch.Size([5649, 64])
torch.Size([1236, 64])
torch.Size([280, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 1.2952971458435059  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 0.04347848892211914  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

torch.Size([14122, 500])
torch.Size([7386, 64])
torch.Size([2049, 64])
torch.Size([376, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 1.65199613571167  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 0.03452110290527344  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

torch.Size([9477, 500])
torch.Size([3953, 64])
torch.Size([859, 64])
torch.Size([212, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 0.8350515365600586  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 0.033962249755859375  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

torch.Size([9177, 500])
torch.Size([3256, 64])
torch.Size([598, 64])
torch.Size([137, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 0.8572244644165039  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015194445848464966 |0.04500278830528259 |0.2992786169052124 |0.0001645982265472412 |0.30014973878860474 |0.012882709503173828 |
----------------------------------------------------------pseudo_mini_loss sum 2.103864908218384
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  171949
Number of first layer input nodes during this epoch:  101446
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 0.051821231842041016  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005397796630859375
random selection method range initialization spend 0.0001494884490966797
time for parepare:  6.628036499023438e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  7.009506225585938e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.3828277587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0017516613006591797
generate_one_block  0.0011789798736572266
generate_one_block  0.001310586929321289
generate_one_block  0.0010607242584228516
generate_one_block  0.0010175704956054688
generate_one_block  0.0010068416595458984
generate_one_block  0.0010170936584472656
generate_one_block  0.0010101795196533203
generate_one_block  0.0009846687316894531
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005526542663574219
gen group dst list time:  7.271766662597656e-05
time for parepare:  0.000331878662109375
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.00038313865661621094
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.00012993812561035156
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0001850128173828125
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00011086463928222656
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00024008750915527344
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00016164779663085938
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00013184547424316406
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  5.1975250244140625e-05
----------------------check_connections_block total spend ----------------------------- 0.003712892532348633
generate_one_block  0.0016248226165771484
generate_one_block  0.0011477470397949219
generate_one_block  0.0012905597686767578
generate_one_block  0.0011649131774902344
generate_one_block  0.0013403892517089844
generate_one_block  0.0012471675872802734
generate_one_block  0.0011775493621826172
generate_one_block  0.0010619163513183594
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011930465698242188
gen group dst list time:  0.00010776519775390625
time for parepare:  0.0008997917175292969
local_output_nid generation:  8.058547973632812e-05
local_in_edges_tensor generation:  0.0003306865692138672
mini_batch_src_global generation:  0.00032067298889160156
r_  generation:  0.002335071563720703
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  0.00013875961303710938
r_  generation:  0.0007066726684570312
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  0.0001354217529296875
r_  generation:  0.0012764930725097656
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  0.00010895729064941406
r_  generation:  0.0006759166717529297
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.0001773834228515625
r_  generation:  0.001741170883178711
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.0008985996246337891
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0007665157318115234
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0002593994140625
----------------------check_connections_block total spend ----------------------------- 0.015244245529174805
generate_one_block  0.004824161529541016
generate_one_block  0.0020394325256347656
generate_one_block  0.0027208328247070312
generate_one_block  0.001811981201171875
generate_one_block  0.0034093856811523438
generate_one_block  0.002113819122314453
generate_one_block  0.002117156982421875
generate_one_block  0.0012946128845214844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002134561538696289
gen group dst list time:  0.00033020973205566406
time for parepare:  0.0015194416046142578
local_output_nid generation:  0.0003676414489746094
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.0011649131774902344
r_  generation:  0.009085416793823242
local_output_nid generation:  0.00014638900756835938
local_in_edges_tensor generation:  0.00035834312438964844
mini_batch_src_global generation:  0.0006532669067382812
r_  generation:  0.00435328483581543
local_output_nid generation:  0.00023102760314941406
local_in_edges_tensor generation:  0.0004572868347167969
mini_batch_src_global generation:  0.0006389617919921875
r_  generation:  0.0068302154541015625
local_output_nid generation:  0.00011944770812988281
local_in_edges_tensor generation:  0.0003299713134765625
mini_batch_src_global generation:  0.0004658699035644531
r_  generation:  0.003894329071044922
local_output_nid generation:  0.00022554397583007812
local_in_edges_tensor generation:  0.0004382133483886719
mini_batch_src_global generation:  0.0006382465362548828
r_  generation:  0.007010698318481445
local_output_nid generation:  0.00016999244689941406
local_in_edges_tensor generation:  0.00036597251892089844
mini_batch_src_global generation:  0.0005280971527099609
r_  generation:  0.004598379135131836
local_output_nid generation:  0.0001900196075439453
local_in_edges_tensor generation:  0.00037407875061035156
mini_batch_src_global generation:  0.00044727325439453125
r_  generation:  0.004454374313354492
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  0.0002512931823730469
r_  generation:  0.001569509506225586
----------------------check_connections_block total spend ----------------------------- 0.0638878345489502
generate_one_block  0.014117240905761719
generate_one_block  0.008016109466552734
generate_one_block  0.011246442794799805
generate_one_block  0.006583690643310547
generate_one_block  0.01112055778503418
generate_one_block  0.0072023868560791016
generate_one_block  0.007132291793823242
generate_one_block  0.003142833709716797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002339601516723633
gen group dst list time:  0.0011763572692871094
time for parepare:  0.0017452239990234375
local_output_nid generation:  0.0008547306060791016
local_in_edges_tensor generation:  0.001880645751953125
mini_batch_src_global generation:  0.0018296241760253906
r_  generation:  0.017163753509521484
local_output_nid generation:  0.0006897449493408203
local_in_edges_tensor generation:  0.0012052059173583984
mini_batch_src_global generation:  0.0015306472778320312
r_  generation:  0.012461662292480469
local_output_nid generation:  0.0009822845458984375
local_in_edges_tensor generation:  0.0015521049499511719
mini_batch_src_global generation:  0.0014324188232421875
r_  generation:  0.018326282501220703
local_output_nid generation:  0.0011005401611328125
local_in_edges_tensor generation:  0.0011723041534423828
mini_batch_src_global generation:  0.0013418197631835938
r_  generation:  0.013189554214477539
local_output_nid generation:  0.0014460086822509766
local_in_edges_tensor generation:  0.0016055107116699219
mini_batch_src_global generation:  0.0013356208801269531
r_  generation:  0.01681804656982422
local_output_nid generation:  0.0013873577117919922
local_in_edges_tensor generation:  0.001405954360961914
mini_batch_src_global generation:  0.0019288063049316406
r_  generation:  0.014003992080688477
local_output_nid generation:  0.0011281967163085938
local_in_edges_tensor generation:  0.0013120174407958984
mini_batch_src_global generation:  0.0010759830474853516
r_  generation:  0.013395071029663086
local_output_nid generation:  0.0004680156707763672
local_in_edges_tensor generation:  0.0006260871887207031
mini_batch_src_global generation:  0.0008845329284667969
r_  generation:  0.006897687911987305
----------------------check_connections_block total spend ----------------------------- 0.17118144035339355
generate_one_block  0.02623152732849121
generate_one_block  0.01823878288269043
generate_one_block  0.024653911590576172
generate_one_block  0.017676830291748047
generate_one_block  0.020410776138305664
generate_one_block  0.018063783645629883
generate_one_block  0.019354820251464844
generate_one_block  0.010277032852172852
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 0.051821231842041016  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

connection checking time:  0.2540264129638672
block generation total time  0.25385546684265137
average batch blocks generation time:  0.03173193335533142
block dataloader generation time/epoch 0.6541285514831543
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3319091796875 GB
    Memory Allocated: 0.06415224075317383  GigaBytes
Max Memory Allocated: 1.8352785110473633  GigaBytes

torch.Size([15527, 500])
torch.Size([9224, 64])
torch.Size([3482, 64])
torch.Size([695, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 1.9648103713989258  GigaBytes
Max Memory Allocated: 1.9648489952087402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 0.05808258056640625  GigaBytes
Max Memory Allocated: 1.9650282859802246  GigaBytes

torch.Size([12624, 500])
torch.Size([6282, 64])
torch.Size([1296, 64])
torch.Size([286, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 1.4151015281677246  GigaBytes
Max Memory Allocated: 1.9650282859802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 0.06407499313354492  GigaBytes
Max Memory Allocated: 1.9650282859802246  GigaBytes

torch.Size([15350, 500])
torch.Size([10082, 64])
torch.Size([2193, 64])
torch.Size([465, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 1.948072910308838  GigaBytes
Max Memory Allocated: 1.9736289978027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 0.05798006057739258  GigaBytes
Max Memory Allocated: 1.9736289978027344  GigaBytes

torch.Size([12107, 500])
torch.Size([6251, 64])
torch.Size([1090, 64])
torch.Size([253, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 1.3693981170654297  GigaBytes
Max Memory Allocated: 1.9736289978027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 0.0605921745300293  GigaBytes
Max Memory Allocated: 1.9736289978027344  GigaBytes

torch.Size([13872, 500])
torch.Size([8647, 64])
torch.Size([2112, 64])
torch.Size([534, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 1.7639288902282715  GigaBytes
Max Memory Allocated: 1.9736289978027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 0.058682918548583984  GigaBytes
Max Memory Allocated: 1.9736289978027344  GigaBytes

torch.Size([12933, 500])
torch.Size([6261, 64])
torch.Size([1530, 64])
torch.Size([285, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 1.4862914085388184  GigaBytes
Max Memory Allocated: 1.9736289978027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 0.060379981994628906  GigaBytes
Max Memory Allocated: 1.9736289978027344  GigaBytes

torch.Size([13856, 500])
torch.Size([6656, 64])
torch.Size([1756, 64])
torch.Size([277, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 1.433405876159668  GigaBytes
Max Memory Allocated: 1.9736289978027344  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 0.04970693588256836  GigaBytes
Max Memory Allocated: 1.9736289978027344  GigaBytes

torch.Size([8257, 500])
torch.Size([2860, 64])
torch.Size([432, 64])
torch.Size([104, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 0.7633247375488281  GigaBytes
Max Memory Allocated: 1.9736289978027344  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013477027416229248 |0.0019800961017608643 |0.23377209901809692 |0.00013625621795654297 |0.29411599040031433 |0.011321306228637695 |
----------------------------------------------------------pseudo_mini_loss sum 1.6786960363388062
Total (block generation + training)time/epoch 5.032346248626709
Training time/epoch 4.377802848815918
Training time without block to device /epoch 4.361962080001831
Training time without total dataloading part /epoch 4.23551607131958
load block tensor time/epoch 0.10781621932983398
block to device time/epoch 0.015840768814086914
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  177936
Number of first layer input nodes during this epoch:  104526
