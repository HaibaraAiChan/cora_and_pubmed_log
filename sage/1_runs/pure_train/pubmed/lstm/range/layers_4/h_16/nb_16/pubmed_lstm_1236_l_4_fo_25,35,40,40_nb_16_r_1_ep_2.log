main start at this time 1648531331.0486062
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007564067840576172  GigaBytes
Max Memory Allocated: 0.007564067840576172  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.002176046371459961
range selection method range initialization spend 8.96453857421875e-05
time for parepare:  4.076957702636719e-05
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  0.001108407974243164
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.606910705566406e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.5272369384765625e-05
----------------------check_connections_block total spend ----------------------------- 0.0026884078979492188
generate_one_block  0.0012774467468261719
generate_one_block  0.0010075569152832031
generate_one_block  0.0010137557983398438
generate_one_block  0.0009925365447998047
generate_one_block  0.0009644031524658203
generate_one_block  0.0010068416595458984
generate_one_block  0.000986337661743164
generate_one_block  0.0009570121765136719
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012023448944091797
gen group dst list time:  5.054473876953125e-05
time for parepare:  0.00023698806762695312
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00010156631469726562
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00017952919006347656
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00020384788513183594
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  9.298324584960938e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0001590251922607422
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00014209747314453125
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00021767616271972656
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001761913299560547
----------------------check_connections_block total spend ----------------------------- 0.0032994747161865234
generate_one_block  0.0011665821075439453
generate_one_block  0.0011973381042480469
generate_one_block  0.0012209415435791016
generate_one_block  0.001100778579711914
generate_one_block  0.0011816024780273438
generate_one_block  0.0011327266693115234
generate_one_block  0.001331329345703125
generate_one_block  0.0012226104736328125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011138916015625
gen group dst list time:  8.988380432128906e-05
time for parepare:  0.0007414817810058594
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.0004203319549560547
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  0.00012350082397460938
r_  generation:  0.0011379718780517578
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  0.00017976760864257812
r_  generation:  0.0014352798461914062
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.00044465065002441406
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0008075237274169922
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.0008544921875
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  0.0001575946807861328
r_  generation:  0.0015840530395507812
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  0.0001533031463623047
r_  generation:  0.0013473033905029297
----------------------check_connections_block total spend ----------------------------- 0.013578653335571289
generate_one_block  0.001501321792602539
generate_one_block  0.0024917125701904297
generate_one_block  0.002834796905517578
generate_one_block  0.001477956771850586
generate_one_block  0.0019850730895996094
generate_one_block  0.0020537376403808594
generate_one_block  0.002997159957885742
generate_one_block  0.002617359161376953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020499229431152344
gen group dst list time:  0.0002608299255371094
time for parepare:  0.0014872550964355469
local_output_nid generation:  7.915496826171875e-05
local_in_edges_tensor generation:  0.0004897117614746094
mini_batch_src_global generation:  0.00024580955505371094
r_  generation:  0.0018506050109863281
local_output_nid generation:  0.0001590251922607422
local_in_edges_tensor generation:  0.0004451274871826172
mini_batch_src_global generation:  0.000789642333984375
r_  generation:  0.006059169769287109
local_output_nid generation:  0.00022077560424804688
local_in_edges_tensor generation:  0.0004894733428955078
mini_batch_src_global generation:  0.0007965564727783203
r_  generation:  0.006678104400634766
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  0.00036454200744628906
r_  generation:  0.002231597900390625
local_output_nid generation:  0.00012969970703125
local_in_edges_tensor generation:  0.0003108978271484375
mini_batch_src_global generation:  0.0003292560577392578
r_  generation:  0.003922939300537109
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.0003256797790527344
mini_batch_src_global generation:  0.0004343986511230469
r_  generation:  0.004452705383300781
local_output_nid generation:  0.00015044212341308594
local_in_edges_tensor generation:  0.0003681182861328125
mini_batch_src_global generation:  0.0006105899810791016
r_  generation:  0.005766630172729492
local_output_nid generation:  0.000152587890625
local_in_edges_tensor generation:  0.0003609657287597656
mini_batch_src_global generation:  0.00055694580078125
r_  generation:  0.005194187164306641
----------------------check_connections_block total spend ----------------------------- 0.05531811714172363
generate_one_block  0.003782510757446289
generate_one_block  0.009674549102783203
generate_one_block  0.01041555404663086
generate_one_block  0.003738880157470703
generate_one_block  0.006673336029052734
generate_one_block  0.006779670715332031
generate_one_block  0.008840799331665039
generate_one_block  0.00776219367980957
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007564067840576172  GigaBytes
Max Memory Allocated: 0.007564067840576172  GigaBytes

connection checking time:  0.07219624519348145
block generation total time  0.08518052101135254
average batch blocks generation time:  0.010647565126419067
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.01451873779296875  GigaBytes
Max Memory Allocated: 0.01451873779296875  GigaBytes

torch.Size([3700, 500])
torch.Size([699, 16])
torch.Size([195, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.2064957618713379  GigaBytes
Max Memory Allocated: 0.21903610229492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.03259849548339844  GigaBytes
Max Memory Allocated: 0.21903610229492188  GigaBytes

torch.Size([9270, 500])
torch.Size([2227, 16])
torch.Size([436, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.7002620697021484  GigaBytes
Max Memory Allocated: 0.7469501495361328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.03180074691772461  GigaBytes
Max Memory Allocated: 0.7469501495361328  GigaBytes

torch.Size([8834, 500])
torch.Size([2827, 16])
torch.Size([498, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.7329964637756348  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.022176742553710938  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

torch.Size([3749, 500])
torch.Size([724, 16])
torch.Size([199, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.2319812774658203  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.027845382690429688  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

torch.Size([6758, 500])
torch.Size([1577, 16])
torch.Size([353, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.44353532791137695  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.027041912078857422  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

torch.Size([6319, 500])
torch.Size([1596, 16])
torch.Size([308, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.4982304573059082  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.027734756469726562  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

torch.Size([6653, 500])
torch.Size([1847, 16])
torch.Size([479, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.6657485961914062  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.025810718536376953  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

torch.Size([5637, 500])
torch.Size([1878, 16])
torch.Size([378, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.5824694633483887  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009899497032165527 |0.0438041090965271 |0.21400126814842224 |0.00014644861221313477 |0.1854947805404663 |0.010719537734985352 |
----------------------------------------------------------pseudo_mini_loss sum 1.719488501548767
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  67496
Number of first layer input nodes during this epoch:  50920
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.04117536544799805  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005342960357666016
range selection method range initialization spend 5.1975250244140625e-05
time for parepare:  6.151199340820312e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.288818359375e-05
----------------------check_connections_block total spend ----------------------------- 0.0017445087432861328
generate_one_block  0.001667022705078125
generate_one_block  0.0011172294616699219
generate_one_block  0.0013206005096435547
generate_one_block  0.001077413558959961
generate_one_block  0.00102996826171875
generate_one_block  0.0010552406311035156
generate_one_block  0.001046895980834961
generate_one_block  0.0010461807250976562
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005526542663574219
gen group dst list time:  5.078315734863281e-05
time for parepare:  0.00027489662170410156
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00011038780212402344
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00029158592224121094
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0002014636993408203
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00021195411682128906
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0001785755157470703
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0001976490020751953
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00010991096496582031
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  7.653236389160156e-05
----------------------check_connections_block total spend ----------------------------- 0.0036101341247558594
generate_one_block  0.001180410385131836
generate_one_block  0.0015101432800292969
generate_one_block  0.0013141632080078125
generate_one_block  0.0012350082397460938
generate_one_block  0.001262664794921875
generate_one_block  0.0012545585632324219
generate_one_block  0.001177072525024414
generate_one_block  0.0011496543884277344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010883808135986328
gen group dst list time:  0.00010633468627929688
time for parepare:  0.0007412433624267578
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0002684593200683594
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0005474090576171875
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00024080276489257812
mini_batch_src_global generation:  0.0002658367156982422
r_  generation:  0.002033710479736328
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00016069412231445312
r_  generation:  0.0011081695556640625
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  0.00011873245239257812
r_  generation:  0.0009224414825439453
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.001096487045288086
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  0.0001556873321533203
r_  generation:  0.001318216323852539
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  0.00011467933654785156
r_  generation:  0.0007586479187011719
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.00030159950256347656
----------------------check_connections_block total spend ----------------------------- 0.014138936996459961
generate_one_block  0.0019407272338867188
generate_one_block  0.0038275718688964844
generate_one_block  0.0024123191833496094
generate_one_block  0.002137899398803711
generate_one_block  0.002648591995239258
generate_one_block  0.002831697463989258
generate_one_block  0.0019140243530273438
generate_one_block  0.001318216323852539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001985311508178711
gen group dst list time:  0.0003306865692138672
time for parepare:  0.0015015602111816406
local_output_nid generation:  0.00019431114196777344
local_in_edges_tensor generation:  0.0005674362182617188
mini_batch_src_global generation:  0.0004241466522216797
r_  generation:  0.003335237503051758
local_output_nid generation:  0.00019788742065429688
local_in_edges_tensor generation:  0.0003952980041503906
mini_batch_src_global generation:  0.0007300376892089844
r_  generation:  0.0056040287017822266
local_output_nid generation:  0.00016117095947265625
local_in_edges_tensor generation:  0.00034546852111816406
mini_batch_src_global generation:  0.0004417896270751953
r_  generation:  0.009772539138793945
local_output_nid generation:  0.00020813941955566406
local_in_edges_tensor generation:  0.0009176731109619141
mini_batch_src_global generation:  0.0005705356597900391
r_  generation:  0.0039594173431396484
local_output_nid generation:  0.00030684471130371094
local_in_edges_tensor generation:  0.0006744861602783203
mini_batch_src_global generation:  0.0005910396575927734
r_  generation:  0.0054531097412109375
local_output_nid generation:  0.00030803680419921875
local_in_edges_tensor generation:  0.0009224414825439453
mini_batch_src_global generation:  0.0008654594421386719
r_  generation:  0.006565093994140625
local_output_nid generation:  0.00016880035400390625
local_in_edges_tensor generation:  0.0005953311920166016
mini_batch_src_global generation:  0.000514984130859375
r_  generation:  0.00437474250793457
local_output_nid generation:  7.700920104980469e-05
local_in_edges_tensor generation:  0.0004620552062988281
mini_batch_src_global generation:  0.0003139972686767578
r_  generation:  0.0016870498657226562
----------------------check_connections_block total spend ----------------------------- 0.06638646125793457
generate_one_block  0.013253211975097656
generate_one_block  0.008908271789550781
generate_one_block  0.008537769317626953
generate_one_block  0.006951093673706055
generate_one_block  0.008278846740722656
generate_one_block  0.010678291320800781
generate_one_block  0.007025480270385742
generate_one_block  0.0032012462615966797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.04117536544799805  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

connection checking time:  0.08413553237915039
block generation total time  0.09594893455505371
average batch blocks generation time:  0.011993616819381714
block dataloader generation time/epoch 0.25978541374206543
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.0410923957824707  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes
Using backend: pytorch

torch.Size([5768, 500])
torch.Size([1136, 16])
torch.Size([241, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.3824043273925781  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.04061698913574219  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

torch.Size([5452, 500])
torch.Size([2000, 16])
torch.Size([560, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.6315979957580566  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.04478168487548828  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

torch.Size([7721, 500])
torch.Size([1741, 16])
torch.Size([481, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.530705451965332  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.04206991195678711  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

torch.Size([6281, 500])
torch.Size([1478, 16])
torch.Size([398, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.42817211151123047  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.04453325271606445  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

torch.Size([7581, 500])
torch.Size([2187, 16])
torch.Size([377, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.5710411071777344  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.04538536071777344  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

torch.Size([8014, 500])
torch.Size([2450, 16])
torch.Size([433, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.7213525772094727  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.04221057891845703  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

torch.Size([6351, 500])
torch.Size([1284, 16])
torch.Size([251, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.48405981063842773  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.03543853759765625  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

torch.Size([2763, 500])
torch.Size([515, 16])
torch.Size([103, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.17870235443115234  GigaBytes
Max Memory Allocated: 0.7823872566223145  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010775059461593628 |0.0016814172267913818 |0.15455922484397888 |0.0001372992992401123 |0.18451431393623352 |0.008922100067138672 |
----------------------------------------------------------pseudo_mini_loss sum 1.4450502395629883
Total (block generation + training)time/epoch 3.099560499191284
Training time/epoch 2.839481830596924
Training time without block to device /epoch 2.8260304927825928
Training time without total dataloading part /epoch 2.722608804702759
load block tensor time/epoch 0.08620047569274902
block to device time/epoch 0.013451337814331055
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  65922
Number of first layer input nodes during this epoch:  49931
