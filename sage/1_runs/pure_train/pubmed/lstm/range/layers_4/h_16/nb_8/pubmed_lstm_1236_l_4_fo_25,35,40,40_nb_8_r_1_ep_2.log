main start at this time 1648531317.5682416
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007564067840576172  GigaBytes
Max Memory Allocated: 0.007564067840576172  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.003446817398071289
range selection method range initialization spend 9.465217590332031e-05
time for parepare:  4.220008850097656e-05
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.0011327266693115234
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.172325134277344e-05
----------------------check_connections_block total spend ----------------------------- 0.0021486282348632812
generate_one_block  0.0013561248779296875
generate_one_block  0.00109100341796875
generate_one_block  0.0010597705841064453
generate_one_block  0.001039266586303711
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0016689300537109375
gen group dst list time:  3.361701965332031e-05
time for parepare:  0.0002536773681640625
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00024366378784179688
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.00027751922607421875
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00026702880859375
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0004470348358154297
----------------------check_connections_block total spend ----------------------------- 0.002695798873901367
generate_one_block  0.0014126300811767578
generate_one_block  0.0013706684112548828
generate_one_block  0.0013322830200195312
generate_one_block  0.0017037391662597656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010306835174560547
gen group dst list time:  7.128715515136719e-05
time for parepare:  0.0007250308990478516
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.00031065940856933594
mini_batch_src_global generation:  0.0001380443572998047
r_  generation:  0.0014967918395996094
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  0.000225067138671875
r_  generation:  0.0017843246459960938
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.00015664100646972656
r_  generation:  0.0012660026550292969
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.00024366378784179688
mini_batch_src_global generation:  0.00028967857360839844
r_  generation:  0.003034353256225586
----------------------check_connections_block total spend ----------------------------- 0.012445211410522461
generate_one_block  0.0030908584594726562
generate_one_block  0.003134012222290039
generate_one_block  0.002584218978881836
generate_one_block  0.004704952239990234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020301342010498047
gen group dst list time:  0.00021076202392578125
time for parepare:  0.0014102458953857422
local_output_nid generation:  0.0001773834228515625
local_in_edges_tensor generation:  0.0007121562957763672
mini_batch_src_global generation:  0.0008041858673095703
r_  generation:  0.00690460205078125
local_output_nid generation:  0.00024962425231933594
local_in_edges_tensor generation:  0.0005567073822021484
mini_batch_src_global generation:  0.001016855239868164
r_  generation:  0.008013010025024414
local_output_nid generation:  0.00016689300537109375
local_in_edges_tensor generation:  0.00041604042053222656
mini_batch_src_global generation:  0.0005438327789306641
r_  generation:  0.005178928375244141
local_output_nid generation:  0.0002505779266357422
local_in_edges_tensor generation:  0.0005419254302978516
mini_batch_src_global generation:  0.0008020401000976562
r_  generation:  0.008797168731689453
----------------------check_connections_block total spend ----------------------------- 0.04408764839172363
generate_one_block  0.00994873046875
generate_one_block  0.011612653732299805
generate_one_block  0.00793600082397461
generate_one_block  0.012488365173339844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007564067840576172  GigaBytes
Max Memory Allocated: 0.007564067840576172  GigaBytes

connection checking time:  0.05922865867614746
block generation total time  0.06131911277770996
average batch blocks generation time:  0.01532977819442749
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.025909423828125  GigaBytes
Max Memory Allocated: 0.025909423828125  GigaBytes

torch.Size([9729, 500])
torch.Size([2546, 16])
torch.Size([601, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9959716796875 GB
    Memory Allocated: 0.7333588600158691  GigaBytes
Max Memory Allocated: 0.7806706428527832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9959716796875 GB
    Memory Allocated: 0.034766197204589844  GigaBytes
Max Memory Allocated: 0.7806706428527832  GigaBytes

torch.Size([9920, 500])
torch.Size([3265, 16])
torch.Size([646, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1248779296875 GB
    Memory Allocated: 0.8567023277282715  GigaBytes
Max Memory Allocated: 0.9135079383850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1248779296875 GB
    Memory Allocated: 0.031342506408691406  GigaBytes
Max Memory Allocated: 0.9135079383850098  GigaBytes

torch.Size([8129, 500])
torch.Size([2124, 16])
torch.Size([554, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1248779296875 GB
    Memory Allocated: 0.5545487403869629  GigaBytes
Max Memory Allocated: 0.9135079383850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1248779296875 GB
    Memory Allocated: 0.0341339111328125  GigaBytes
Max Memory Allocated: 0.9135079383850098  GigaBytes

torch.Size([9540, 500])
torch.Size([3463, 16])
torch.Size([948, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.9829835891723633  GigaBytes
Max Memory Allocated: 1.0428638458251953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007110893726348877 |0.08562248945236206 |0.2996482849121094 |0.00014829635620117188 |0.22910797595977783 |0.010521650314331055 |
----------------------------------------------------------pseudo_mini_loss sum 1.9114373922348022
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  51820
Number of first layer input nodes during this epoch:  37318
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.049716949462890625  GigaBytes
Max Memory Allocated: 1.0428638458251953  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005540847778320312
range selection method range initialization spend 5.5789947509765625e-05
time for parepare:  5.459785461425781e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  5.054473876953125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.981590270996094e-05
----------------------check_connections_block total spend ----------------------------- 0.0010979175567626953
generate_one_block  0.0014655590057373047
generate_one_block  0.0011992454528808594
generate_one_block  0.0010952949523925781
generate_one_block  0.0010886192321777344
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005757808685302734
gen group dst list time:  3.528594970703125e-05
time for parepare:  0.00026345252990722656
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0003027915954589844
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.00047469139099121094
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0003383159637451172
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.00022721290588378906
----------------------check_connections_block total spend ----------------------------- 0.0029442310333251953
generate_one_block  0.0015091896057128906
generate_one_block  0.0018353462219238281
generate_one_block  0.001678466796875
generate_one_block  0.0014047622680664062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010600090026855469
gen group dst list time:  8.296966552734375e-05
time for parepare:  0.0007498264312744141
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.0002925395965576172
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.0018932819366455078
local_output_nid generation:  9.942054748535156e-05
local_in_edges_tensor generation:  0.00025343894958496094
mini_batch_src_global generation:  0.00034332275390625
r_  generation:  0.0030930042266845703
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.00026726722717285156
r_  generation:  0.0023064613342285156
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  0.0001728534698486328
r_  generation:  0.0014271736145019531
----------------------check_connections_block total spend ----------------------------- 0.013901948928833008
generate_one_block  0.0038194656372070312
generate_one_block  0.0062236785888671875
generate_one_block  0.003984212875366211
generate_one_block  0.0028345584869384766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002019643783569336
gen group dst list time:  0.00025582313537597656
time for parepare:  0.0013718605041503906
local_output_nid generation:  0.00023627281188964844
local_in_edges_tensor generation:  0.0007083415985107422
mini_batch_src_global generation:  0.0008656978607177734
r_  generation:  0.007151603698730469
local_output_nid generation:  0.00031828880310058594
local_in_edges_tensor generation:  0.0006833076477050781
mini_batch_src_global generation:  0.0011949539184570312
r_  generation:  0.010693073272705078
local_output_nid generation:  0.00034928321838378906
local_in_edges_tensor generation:  0.0006601810455322266
mini_batch_src_global generation:  0.0009856224060058594
r_  generation:  0.009027242660522461
local_output_nid generation:  0.00024962425231933594
local_in_edges_tensor generation:  0.00046896934509277344
mini_batch_src_global generation:  0.0007030963897705078
r_  generation:  0.007050991058349609
----------------------check_connections_block total spend ----------------------------- 0.05114150047302246
generate_one_block  0.011882543563842773
generate_one_block  0.015987396240234375
generate_one_block  0.014193534851074219
generate_one_block  0.012334108352661133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.049716949462890625  GigaBytes
Max Memory Allocated: 1.0428638458251953  GigaBytes

connection checking time:  0.06798768043518066
block generation total time  0.07768726348876953
average batch blocks generation time:  0.019421815872192383
block dataloader generation time/epoch 0.19229960441589355
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.046660423278808594  GigaBytes
Max Memory Allocated: 1.0428638458251953  GigaBytes

torch.Size([8195, 500])
torch.Size([2623, 16])
torch.Size([594, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.8019766807556152  GigaBytes
Max Memory Allocated: 1.0428638458251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.05455827713012695  GigaBytes
Max Memory Allocated: 1.0428638458251953  GigaBytes

torch.Size([12370, 500])
torch.Size([3799, 16])
torch.Size([1038, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 1.1608829498291016  GigaBytes
Max Memory Allocated: 1.2326278686523438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.051850318908691406  GigaBytes
Max Memory Allocated: 1.2326278686523438  GigaBytes

torch.Size([10954, 500])
torch.Size([3767, 16])
torch.Size([734, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.9762601852416992  GigaBytes
Max Memory Allocated: 1.2326278686523438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.048644065856933594  GigaBytes
Max Memory Allocated: 1.2326278686523438  GigaBytes

torch.Size([9268, 500])
torch.Size([2508, 16])
torch.Size([464, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.7952041625976562  GigaBytes
Max Memory Allocated: 1.2326278686523438  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009250104427337646 |0.0012340545654296875 |0.17534607648849487 |0.00013458728790283203 |0.23722738027572632 |0.013130426406860352 |
----------------------------------------------------------pseudo_mini_loss sum 1.8588290214538574
Total (block generation + training)time/epoch 1.9083476066589355
Training time/epoch 1.715757131576538
Training time without block to device /epoch 1.7108209133148193
Training time without total dataloading part /epoch 1.6639626026153564
load block tensor time/epoch 0.037000417709350586
block to device time/epoch 0.00493621826171875
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  56669
Number of first layer input nodes during this epoch:  40787
