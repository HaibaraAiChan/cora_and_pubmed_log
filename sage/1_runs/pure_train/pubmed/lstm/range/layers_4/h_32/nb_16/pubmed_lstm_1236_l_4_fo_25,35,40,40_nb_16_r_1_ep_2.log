main start at this time 1648531402.9027264
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007703304290771484  GigaBytes
Max Memory Allocated: 0.007703304290771484  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0017039775848388672
range selection method range initialization spend 9.870529174804688e-05
time for parepare:  4.6253204345703125e-05
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.0015177726745605469
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1219253540039062e-05
----------------------check_connections_block total spend ----------------------------- 0.00316619873046875
generate_one_block  0.001285552978515625
generate_one_block  0.0010716915130615234
generate_one_block  0.0010514259338378906
generate_one_block  0.001046895980834961
generate_one_block  0.001028299331665039
generate_one_block  0.0010275840759277344
generate_one_block  0.0010297298431396484
generate_one_block  0.0010554790496826172
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010149478912353516
gen group dst list time:  5.1021575927734375e-05
time for parepare:  0.0002357959747314453
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00017786026000976562
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0001633167266845703
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0002543926239013672
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0002593994140625
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0001709461212158203
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00010251998901367188
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00016307830810546875
----------------------check_connections_block total spend ----------------------------- 0.0034799575805664062
generate_one_block  0.0012812614440917969
generate_one_block  0.0012009143829345703
generate_one_block  0.0013971328735351562
generate_one_block  0.0013680458068847656
generate_one_block  0.0010638236999511719
generate_one_block  0.001280069351196289
generate_one_block  0.001154184341430664
generate_one_block  0.0011980533599853516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012216567993164062
gen group dst list time:  9.393692016601562e-05
time for parepare:  0.0007519721984863281
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0002639293670654297
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.0010585784912109375
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.000942230224609375
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  0.00016617774963378906
r_  generation:  0.0015358924865722656
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  0.00022220611572265625
r_  generation:  0.0019435882568359375
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.00044536590576171875
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.0010941028594970703
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  8.225440979003906e-05
r_  generation:  0.0005686283111572266
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  0.00013494491577148438
r_  generation:  0.0012085437774658203
----------------------check_connections_block total spend ----------------------------- 0.01469564437866211
generate_one_block  0.0024564266204833984
generate_one_block  0.002068758010864258
generate_one_block  0.0027523040771484375
generate_one_block  0.0031821727752685547
generate_one_block  0.0014066696166992188
generate_one_block  0.002227783203125
generate_one_block  0.0015230178833007812
generate_one_block  0.002321481704711914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018017292022705078
gen group dst list time:  0.0002715587615966797
time for parepare:  0.0015347003936767578
local_output_nid generation:  0.0001270771026611328
local_in_edges_tensor generation:  0.0006024837493896484
mini_batch_src_global generation:  0.000579833984375
r_  generation:  0.004865884780883789
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.0003902912139892578
mini_batch_src_global generation:  0.0005974769592285156
r_  generation:  0.004731416702270508
local_output_nid generation:  0.00019979476928710938
local_in_edges_tensor generation:  0.00048613548278808594
mini_batch_src_global generation:  0.0007033348083496094
r_  generation:  0.006804227828979492
local_output_nid generation:  0.00017070770263671875
local_in_edges_tensor generation:  0.0004291534423828125
mini_batch_src_global generation:  0.0007002353668212891
r_  generation:  0.005926609039306641
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  0.00039124488830566406
r_  generation:  0.0030221939086914062
local_output_nid generation:  0.00016427040100097656
local_in_edges_tensor generation:  0.0003714561462402344
mini_batch_src_global generation:  0.0004944801330566406
r_  generation:  0.005270719528198242
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.00023412704467773438
mini_batch_src_global generation:  0.00035381317138671875
r_  generation:  0.0028142929077148438
local_output_nid generation:  0.00012636184692382812
local_in_edges_tensor generation:  0.0003094673156738281
mini_batch_src_global generation:  0.0004181861877441406
r_  generation:  0.0044040679931640625
----------------------check_connections_block total spend ----------------------------- 0.05789351463317871
generate_one_block  0.007676124572753906
generate_one_block  0.006549835205078125
generate_one_block  0.009830474853515625
generate_one_block  0.009311199188232422
generate_one_block  0.0052642822265625
generate_one_block  0.00824284553527832
generate_one_block  0.004637002944946289
generate_one_block  0.006685972213745117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007703304290771484  GigaBytes
Max Memory Allocated: 0.007703304290771484  GigaBytes

connection checking time:  0.07606911659240723
block generation total time  0.08607983589172363
average batch blocks generation time:  0.010759979486465454
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.021524429321289062  GigaBytes
Max Memory Allocated: 0.021524429321289062  GigaBytes

torch.Size([7081, 500])
torch.Size([1755, 32])
torch.Size([393, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.49376583099365234  GigaBytes
Max Memory Allocated: 0.5216546058654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.028315067291259766  GigaBytes
Max Memory Allocated: 0.5216546058654785  GigaBytes

torch.Size([6372, 500])
torch.Size([1969, 32])
torch.Size([315, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.4711756706237793  GigaBytes
Max Memory Allocated: 0.5216546058654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.033846378326416016  GigaBytes
Max Memory Allocated: 0.5216546058654785  GigaBytes

torch.Size([9296, 500])
torch.Size([2506, 32])
torch.Size([594, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.7362613677978516  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.02755880355834961  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes

torch.Size([5920, 500])
torch.Size([2226, 32])
torch.Size([480, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.684514045715332  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.02613210678100586  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes

torch.Size([5223, 500])
torch.Size([866, 32])
torch.Size([152, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.34618616104125977  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.03300809860229492  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes

torch.Size([8871, 500])
torch.Size([1864, 32])
torch.Size([434, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.6071715354919434  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.024878501892089844  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes

torch.Size([4552, 500])
torch.Size([888, 32])
torch.Size([230, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.32178497314453125  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.025280475616455078  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes

torch.Size([4730, 500])
torch.Size([1498, 32])
torch.Size([312, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.5191926956176758  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0051908791065216064 |0.04368990659713745 |0.21465075016021729 |0.0001448988914489746 |0.1954471468925476 |0.010872602462768555 |
----------------------------------------------------------pseudo_mini_loss sum 2.2218074798583984
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  68884
Number of first layer input nodes during this epoch:  52045
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.04089212417602539  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010082721710205078
range selection method range initialization spend 8.416175842285156e-05
time for parepare:  8.273124694824219e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0003886222839355469
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00029587745666503906
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  5.91278076171875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0002582073211669922
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0003285408020019531
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00034236907958984375
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0003838539123535156
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00034499168395996094
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0002498626708984375
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.004507541656494141
generate_one_block  0.0022602081298828125
generate_one_block  0.0015032291412353516
generate_one_block  0.0018036365509033203
generate_one_block  0.0015442371368408203
generate_one_block  0.0014948844909667969
generate_one_block  0.0014925003051757812
generate_one_block  0.0012269020080566406
generate_one_block  0.0011548995971679688
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007891654968261719
gen group dst list time:  5.507469177246094e-05
time for parepare:  0.0004394054412841797
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00023603439331054688
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0001361370086669922
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.00032329559326171875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0001780986785888672
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0002639293670654297
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00015997886657714844
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.00014662742614746094
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.00018858909606933594
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  4.9591064453125e-05
----------------------check_connections_block total spend ----------------------------- 0.004465341567993164
generate_one_block  0.002239704132080078
generate_one_block  0.0018761157989501953
generate_one_block  0.001379251480102539
generate_one_block  0.0014376640319824219
generate_one_block  0.0012824535369873047
generate_one_block  0.001310110092163086
generate_one_block  0.0012950897216796875
generate_one_block  0.0011508464813232422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012438297271728516
gen group dst list time:  0.0001163482666015625
time for parepare:  0.0007693767547607422
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.0002772808074951172
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.0008115768432617188
local_output_nid generation:  7.367134094238281e-05
local_in_edges_tensor generation:  0.0005154609680175781
mini_batch_src_global generation:  0.0018765926361083984
r_  generation:  0.002249002456665039
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00028586387634277344
mini_batch_src_global generation:  0.00018072128295898438
r_  generation:  0.0011484622955322266
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.0005152225494384766
mini_batch_src_global generation:  0.00021648406982421875
r_  generation:  0.0019342899322509766
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.00016760826110839844
r_  generation:  0.0011212825775146484
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.000873565673828125
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00013113021850585938
r_  generation:  0.0009822845458984375
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00017952919006347656
----------------------check_connections_block total spend ----------------------------- 0.018535614013671875
generate_one_block  0.0025818347930908203
generate_one_block  0.003949403762817383
generate_one_block  0.0025243759155273438
generate_one_block  0.0033767223358154297
generate_one_block  0.0024008750915527344
generate_one_block  0.002019643783569336
generate_one_block  0.0022275447845458984
generate_one_block  0.0012218952178955078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018491744995117188
gen group dst list time:  0.0003383159637451172
time for parepare:  0.0016276836395263672
local_output_nid generation:  0.0001647472381591797
local_in_edges_tensor generation:  0.0008616447448730469
mini_batch_src_global generation:  0.0005779266357421875
r_  generation:  0.0047490596771240234
local_output_nid generation:  0.0003426074981689453
local_in_edges_tensor generation:  0.0005402565002441406
mini_batch_src_global generation:  0.0011179447174072266
r_  generation:  0.008683443069458008
local_output_nid generation:  0.00024008750915527344
local_in_edges_tensor generation:  0.000438690185546875
mini_batch_src_global generation:  0.0005877017974853516
r_  generation:  0.005339860916137695
local_output_nid generation:  0.0002562999725341797
local_in_edges_tensor generation:  0.0004646778106689453
mini_batch_src_global generation:  0.0005490779876708984
r_  generation:  0.006034135818481445
local_output_nid generation:  0.00023937225341796875
local_in_edges_tensor generation:  0.0004057884216308594
mini_batch_src_global generation:  0.0005440711975097656
r_  generation:  0.00558018684387207
local_output_nid generation:  0.00015282630920410156
local_in_edges_tensor generation:  0.00042939186096191406
mini_batch_src_global generation:  0.00041747093200683594
r_  generation:  0.003821849822998047
local_output_nid generation:  0.00020766258239746094
local_in_edges_tensor generation:  0.00036597251892089844
mini_batch_src_global generation:  0.00042176246643066406
r_  generation:  0.0045354366302490234
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.0002455711364746094
r_  generation:  0.001375436782836914
----------------------check_connections_block total spend ----------------------------- 0.06220436096191406
generate_one_block  0.008223295211791992
generate_one_block  0.012361288070678711
generate_one_block  0.00795888900756836
generate_one_block  0.009528398513793945
generate_one_block  0.009155988693237305
generate_one_block  0.006090641021728516
generate_one_block  0.006978750228881836
generate_one_block  0.002652883529663086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.04089212417602539  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes

connection checking time:  0.0852053165435791
block generation total time  0.09522366523742676
average batch blocks generation time:  0.011902958154678345
block dataloader generation time/epoch 0.2974581718444824
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.04452991485595703  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes
Using backend: pytorch

torch.Size([6809, 500])
torch.Size([1524, 32])
torch.Size([300, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.5116181373596191  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.051514625549316406  GigaBytes
Max Memory Allocated: 0.778043270111084  GigaBytes

torch.Size([10199, 500])
torch.Size([2892, 32])
torch.Size([657, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.9210891723632812  GigaBytes
Max Memory Allocated: 0.9711618423461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1834716796875 GB
    Memory Allocated: 0.04537248611450195  GigaBytes
Max Memory Allocated: 0.9711618423461914  GigaBytes

torch.Size([7252, 500])
torch.Size([1991, 32])
torch.Size([384, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1834716796875 GB
    Memory Allocated: 0.5515532493591309  GigaBytes
Max Memory Allocated: 0.9711618423461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1834716796875 GB
    Memory Allocated: 0.04435110092163086  GigaBytes
Max Memory Allocated: 0.9711618423461914  GigaBytes

torch.Size([6671, 500])
torch.Size([1998, 32])
torch.Size([468, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1834716796875 GB
    Memory Allocated: 0.692467212677002  GigaBytes
Max Memory Allocated: 0.9711618423461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1834716796875 GB
    Memory Allocated: 0.0450282096862793  GigaBytes
Max Memory Allocated: 0.9711618423461914  GigaBytes

torch.Size([7055, 500])
torch.Size([1995, 32])
torch.Size([328, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1834716796875 GB
    Memory Allocated: 0.6329169273376465  GigaBytes
Max Memory Allocated: 0.9711618423461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1834716796875 GB
    Memory Allocated: 0.04267597198486328  GigaBytes
Max Memory Allocated: 0.9711618423461914  GigaBytes

torch.Size([5825, 500])
torch.Size([1375, 32])
torch.Size([299, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1834716796875 GB
    Memory Allocated: 0.4240427017211914  GigaBytes
Max Memory Allocated: 0.9711618423461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1834716796875 GB
    Memory Allocated: 0.04503011703491211  GigaBytes
Max Memory Allocated: 0.9711618423461914  GigaBytes

torch.Size([7077, 500])
torch.Size([1760, 32])
torch.Size([402, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1834716796875 GB
    Memory Allocated: 0.49469518661499023  GigaBytes
Max Memory Allocated: 0.9711618423461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1834716796875 GB
    Memory Allocated: 0.03631162643432617  GigaBytes
Max Memory Allocated: 0.9711618423461914  GigaBytes

torch.Size([2452, 500])
torch.Size([328, 32])
torch.Size([64, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1834716796875 GB
    Memory Allocated: 0.1621551513671875  GigaBytes
Max Memory Allocated: 0.9711618423461914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009107798337936401 |0.001271277666091919 |0.14807936549186707 |0.00013077259063720703 |0.1877860128879547 |0.008555173873901367 |
----------------------------------------------------------pseudo_mini_loss sum 1.7250359058380127
Total (block generation + training)time/epoch 3.093174934387207
Training time/epoch 2.795471668243408
Training time without block to device /epoch 2.785301446914673
Training time without total dataloading part /epoch 2.6965243816375732
load block tensor time/epoch 0.07286238670349121
block to device time/epoch 0.010170221328735352
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  70461
Number of first layer input nodes during this epoch:  53340
