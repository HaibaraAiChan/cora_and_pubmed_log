main start at this time 1648531389.270651
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007703304290771484  GigaBytes
Max Memory Allocated: 0.007703304290771484  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0023539066314697266
range selection method range initialization spend 7.05718994140625e-05
time for parepare:  4.458427429199219e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0011060237884521484
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.0279159545898438e-05
----------------------check_connections_block total spend ----------------------------- 0.0021123886108398438
generate_one_block  0.0012743473052978516
generate_one_block  0.0010805130004882812
generate_one_block  0.0010366439819335938
generate_one_block  0.0010476112365722656
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001401662826538086
gen group dst list time:  3.361701965332031e-05
time for parepare:  0.00023627281188964844
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00028014183044433594
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0005164146423339844
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00024628639221191406
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0002570152282714844
----------------------check_connections_block total spend ----------------------------- 0.002752542495727539
generate_one_block  0.001415252685546875
generate_one_block  0.0016894340515136719
generate_one_block  0.001316070556640625
generate_one_block  0.0013899803161621094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010085105895996094
gen group dst list time:  7.2479248046875e-05
time for parepare:  0.0007536411285400391
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.00029730796813964844
mini_batch_src_global generation:  0.000133514404296875
r_  generation:  0.0014925003051757812
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.0002617835998535156
mini_batch_src_global generation:  0.0004305839538574219
r_  generation:  0.0035758018493652344
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.00019788742065429688
r_  generation:  0.0014719963073730469
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.00018596649169921875
r_  generation:  0.0017671585083007812
----------------------check_connections_block total spend ----------------------------- 0.013369321823120117
generate_one_block  0.0031189918518066406
generate_one_block  0.0054590702056884766
generate_one_block  0.002724885940551758
generate_one_block  0.003131866455078125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00208282470703125
gen group dst list time:  0.0002448558807373047
time for parepare:  0.0015468597412109375
local_output_nid generation:  0.00018787384033203125
local_in_edges_tensor generation:  0.0007543563842773438
mini_batch_src_global generation:  0.0007240772247314453
r_  generation:  0.006345510482788086
local_output_nid generation:  0.00035071372985839844
local_in_edges_tensor generation:  0.0007755756378173828
mini_batch_src_global generation:  0.0013248920440673828
r_  generation:  0.012560367584228516
local_output_nid generation:  0.00020503997802734375
local_in_edges_tensor generation:  0.0004820823669433594
mini_batch_src_global generation:  0.0008318424224853516
r_  generation:  0.0071563720703125
local_output_nid generation:  0.00019741058349609375
local_in_edges_tensor generation:  0.0004658699035644531
mini_batch_src_global generation:  0.0006880760192871094
r_  generation:  0.006439685821533203
----------------------check_connections_block total spend ----------------------------- 0.04906439781188965
generate_one_block  0.009359359741210938
generate_one_block  0.0163118839263916
generate_one_block  0.012294292449951172
generate_one_block  0.009966850280761719
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007703304290771484  GigaBytes
Max Memory Allocated: 0.007703304290771484  GigaBytes

connection checking time:  0.0651862621307373
block generation total time  0.06817793846130371
average batch blocks generation time:  0.017044484615325928
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.024428844451904297  GigaBytes
Max Memory Allocated: 0.024428844451904297  GigaBytes

torch.Size([8871, 500])
torch.Size([2617, 32])
torch.Size([609, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.6544280052185059  GigaBytes
Max Memory Allocated: 0.6911611557006836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.03893852233886719  GigaBytes
Max Memory Allocated: 0.6911611557006836  GigaBytes

torch.Size([12409, 500])
torch.Size([4920, 32])
torch.Size([1078, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 1.2890472412109375  GigaBytes
Max Memory Allocated: 1.3567109107971191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 0.035471439361572266  GigaBytes
Max Memory Allocated: 1.3567109107971191  GigaBytes

torch.Size([10648, 500])
torch.Size([2453, 32])
torch.Size([604, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 0.7891654968261719  GigaBytes
Max Memory Allocated: 1.3567109107971191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 0.029926300048828125  GigaBytes
Max Memory Allocated: 1.3567109107971191  GigaBytes

torch.Size([7672, 500])
torch.Size([2277, 32])
torch.Size([588, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 0.7319445610046387  GigaBytes
Max Memory Allocated: 1.3567109107971191  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009851694107055664 |0.08579635620117188 |0.30404049158096313 |0.00016355514526367188 |0.23268938064575195 |0.009549140930175781 |
----------------------------------------------------------pseudo_mini_loss sum 1.9030134677886963
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  55102
Number of first layer input nodes during this epoch:  39600
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 0.04653596878051758  GigaBytes
Max Memory Allocated: 1.3567109107971191  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005407333374023438
range selection method range initialization spend 5.364418029785156e-05
time for parepare:  5.555152893066406e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  8.249282836914062e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.719329833984375e-05
----------------------check_connections_block total spend ----------------------------- 0.001119375228881836
generate_one_block  0.001444101333618164
generate_one_block  0.0011563301086425781
generate_one_block  0.0011060237884521484
generate_one_block  0.0010917186737060547
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005588531494140625
gen group dst list time:  3.647804260253906e-05
time for parepare:  0.00027370452880859375
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0004105567932128906
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  7.796287536621094e-05
r_  generation:  0.00040411949157714844
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.00026297569274902344
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00027179718017578125
----------------------check_connections_block total spend ----------------------------- 0.0030133724212646484
generate_one_block  0.0017337799072265625
generate_one_block  0.0016677379608154297
generate_one_block  0.0015707015991210938
generate_one_block  0.0025997161865234375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010514259338378906
gen group dst list time:  8.821487426757812e-05
time for parepare:  0.0007717609405517578
local_output_nid generation:  0.0001049041748046875
local_in_edges_tensor generation:  0.0003578662872314453
mini_batch_src_global generation:  0.00029087066650390625
r_  generation:  0.0026552677154541016
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.0002593994140625
mini_batch_src_global generation:  0.00037598609924316406
r_  generation:  0.002733945846557617
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.00020051002502441406
r_  generation:  0.001687765121459961
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.0001614093780517578
r_  generation:  0.0015659332275390625
----------------------check_connections_block total spend ----------------------------- 0.013968229293823242
generate_one_block  0.004917621612548828
generate_one_block  0.004642963409423828
generate_one_block  0.003049612045288086
generate_one_block  0.0027701854705810547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019960403442382812
gen group dst list time:  0.00024127960205078125
time for parepare:  0.001435995101928711
local_output_nid generation:  0.0003101825714111328
local_in_edges_tensor generation:  0.0008673667907714844
mini_batch_src_global generation:  0.0010609626770019531
r_  generation:  0.010313987731933594
local_output_nid generation:  0.0003006458282470703
local_in_edges_tensor generation:  0.0006337165832519531
mini_batch_src_global generation:  0.0010933876037597656
r_  generation:  0.009704351425170898
local_output_nid generation:  0.0002562999725341797
local_in_edges_tensor generation:  0.000522613525390625
mini_batch_src_global generation:  0.0007495880126953125
r_  generation:  0.0071756839752197266
local_output_nid generation:  0.00023698806762695312
local_in_edges_tensor generation:  0.00046944618225097656
mini_batch_src_global generation:  0.0006330013275146484
r_  generation:  0.006117343902587891
----------------------check_connections_block total spend ----------------------------- 0.04999732971191406
generate_one_block  0.0156557559967041
generate_one_block  0.016131877899169922
generate_one_block  0.011936187744140625
generate_one_block  0.010210037231445312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 0.04653596878051758  GigaBytes
Max Memory Allocated: 1.3567109107971191  GigaBytes

connection checking time:  0.06697893142700195
block generation total time  0.07688617706298828
average batch blocks generation time:  0.01922154426574707
block dataloader generation time/epoch 0.19202971458435059
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 0.05359172821044922  GigaBytes
Max Memory Allocated: 1.3567109107971191  GigaBytes

torch.Size([11568, 500])
torch.Size([3751, 32])
torch.Size([887, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 1.0938591957092285  GigaBytes
Max Memory Allocated: 1.3567109107971191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 0.051502227783203125  GigaBytes
Max Memory Allocated: 1.3567109107971191  GigaBytes

torch.Size([10337, 500])
torch.Size([3476, 32])
torch.Size([787, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 1.0304217338562012  GigaBytes
Max Memory Allocated: 1.3567109107971191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 0.049521446228027344  GigaBytes
Max Memory Allocated: 1.3567109107971191  GigaBytes

torch.Size([9262, 500])
torch.Size([2755, 32])
torch.Size([570, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 0.8097577095031738  GigaBytes
Max Memory Allocated: 1.3567109107971191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 0.048369407653808594  GigaBytes
Max Memory Allocated: 1.3567109107971191  GigaBytes

torch.Size([8836, 500])
torch.Size([2445, 32])
torch.Size([572, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 0.6951217651367188  GigaBytes
Max Memory Allocated: 1.3567109107971191  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01233828067779541 |0.001333475112915039 |0.1830834150314331 |0.00014144182205200195 |0.2433432936668396 |0.014065027236938477 |
----------------------------------------------------------pseudo_mini_loss sum 1.8259040117263794
Total (block generation + training)time/epoch 1.9773144721984863
Training time/epoch 1.7850677967071533
Training time without block to device /epoch 1.7797338962554932
Training time without total dataloading part /epoch 1.7203376293182373
load block tensor time/epoch 0.04935312271118164
block to device time/epoch 0.005333900451660156
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  55601
Number of first layer input nodes during this epoch:  40003
