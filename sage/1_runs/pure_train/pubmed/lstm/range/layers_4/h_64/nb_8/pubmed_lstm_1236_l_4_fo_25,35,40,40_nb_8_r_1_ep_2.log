main start at this time 1648531461.126649
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00814676284790039  GigaBytes
Max Memory Allocated: 0.00814676284790039  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0009462833404541016
range selection method range initialization spend 7.939338684082031e-05
time for parepare:  5.435943603515625e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.001436471939086914
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  5.316734313964844e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.1961669921875e-05
----------------------check_connections_block total spend ----------------------------- 0.0026214122772216797
generate_one_block  0.0015718936920166016
generate_one_block  0.0013165473937988281
generate_one_block  0.0012781620025634766
generate_one_block  0.0012784004211425781
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007071495056152344
gen group dst list time:  4.1484832763671875e-05
time for parepare:  0.0002956390380859375
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0002455711364746094
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.00043201446533203125
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0005335807800292969
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.00038933753967285156
----------------------check_connections_block total spend ----------------------------- 0.0033440589904785156
generate_one_block  0.0015461444854736328
generate_one_block  0.0017986297607421875
generate_one_block  0.0019404888153076172
generate_one_block  0.0017852783203125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001173257827758789
gen group dst list time:  9.250640869140625e-05
time for parepare:  0.0009109973907470703
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0002875328063964844
mini_batch_src_global generation:  0.00013756752014160156
r_  generation:  0.0013897418975830078
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  0.0002925395965576172
r_  generation:  0.0029866695404052734
local_output_nid generation:  9.894371032714844e-05
local_in_edges_tensor generation:  0.00029850006103515625
mini_batch_src_global generation:  0.00041365623474121094
r_  generation:  0.003615856170654297
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  0.0002579689025878906
r_  generation:  0.0020856857299804688
----------------------check_connections_block total spend ----------------------------- 0.01623368263244629
generate_one_block  0.002614259719848633
generate_one_block  0.00410771369934082
generate_one_block  0.004595041275024414
generate_one_block  0.0031201839447021484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001882314682006836
gen group dst list time:  0.0003097057342529297
time for parepare:  0.0017468929290771484
local_output_nid generation:  0.00020647048950195312
local_in_edges_tensor generation:  0.0006542205810546875
mini_batch_src_global generation:  0.0008766651153564453
r_  generation:  0.005994319915771484
local_output_nid generation:  0.00030517578125
local_in_edges_tensor generation:  0.0006356239318847656
mini_batch_src_global generation:  0.0011761188507080078
r_  generation:  0.010318517684936523
local_output_nid generation:  0.0003006458282470703
local_in_edges_tensor generation:  0.0006096363067626953
mini_batch_src_global generation:  0.0009188652038574219
r_  generation:  0.010614871978759766
local_output_nid generation:  0.00025844573974609375
local_in_edges_tensor generation:  0.0005178451538085938
mini_batch_src_global generation:  0.0008311271667480469
r_  generation:  0.007559537887573242
----------------------check_connections_block total spend ----------------------------- 0.05223870277404785
generate_one_block  0.009027719497680664
generate_one_block  0.01344442367553711
generate_one_block  0.01619744300842285
generate_one_block  0.012059688568115234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00814676284790039  GigaBytes
Max Memory Allocated: 0.00814676284790039  GigaBytes

connection checking time:  0.07181644439697266
block generation total time  0.07223701477050781
average batch blocks generation time:  0.018059253692626953
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.02206277847290039  GigaBytes
Max Memory Allocated: 0.02206277847290039  GigaBytes

torch.Size([7371, 500])
torch.Size([1969, 64])
torch.Size([337, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.6270947456359863  GigaBytes
Max Memory Allocated: 0.6561980247497559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.03615236282348633  GigaBytes
Max Memory Allocated: 0.6561980247497559  GigaBytes

torch.Size([10450, 500])
torch.Size([3942, 64])
torch.Size([767, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3514404296875 GB
    Memory Allocated: 1.0836434364318848  GigaBytes
Max Memory Allocated: 1.1241536140441895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3514404296875 GB
    Memory Allocated: 0.037647247314453125  GigaBytes
Max Memory Allocated: 1.1241536140441895  GigaBytes

torch.Size([11279, 500])
torch.Size([3613, 64])
torch.Size([983, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.0940613746643066  GigaBytes
Max Memory Allocated: 1.1269102096557617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 0.03647327423095703  GigaBytes
Max Memory Allocated: 1.1269102096557617  GigaBytes

torch.Size([10699, 500])
torch.Size([2964, 64])
torch.Size([750, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 0.8465819358825684  GigaBytes
Max Memory Allocated: 1.1269102096557617  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006964683532714844 |0.0858619213104248 |0.3005371689796448 |0.00016731023788452148 |0.20315587520599365 |0.008837223052978516 |
----------------------------------------------------------pseudo_mini_loss sum 1.750690221786499
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  55480
Number of first layer input nodes during this epoch:  39799
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 0.05399656295776367  GigaBytes
Max Memory Allocated: 1.1269102096557617  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006091594696044922
range selection method range initialization spend 6.508827209472656e-05
time for parepare:  6.437301635742188e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  5.8650970458984375e-05
----------------------check_connections_block total spend ----------------------------- 0.001214742660522461
generate_one_block  0.0014662742614746094
generate_one_block  0.0013113021850585938
generate_one_block  0.001262664794921875
generate_one_block  0.0013432502746582031
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006432533264160156
gen group dst list time:  4.792213439941406e-05
time for parepare:  0.0003275871276855469
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0005702972412109375
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0002970695495605469
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00018906593322753906
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0005469322204589844
----------------------check_connections_block total spend ----------------------------- 0.0034852027893066406
generate_one_block  0.0021326541900634766
generate_one_block  0.0016663074493408203
generate_one_block  0.0016646385192871094
generate_one_block  0.0020465850830078125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011870861053466797
gen group dst list time:  0.00011229515075683594
time for parepare:  0.0009086132049560547
local_output_nid generation:  0.00012826919555664062
local_in_edges_tensor generation:  0.0003783702850341797
mini_batch_src_global generation:  0.00040793418884277344
r_  generation:  0.0038356781005859375
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.0002319812774658203
mini_batch_src_global generation:  0.0002872943878173828
r_  generation:  0.0018267631530761719
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  0.00016570091247558594
r_  generation:  0.0012850761413574219
local_output_nid generation:  0.00012993812561035156
local_in_edges_tensor generation:  0.0003027915954589844
mini_batch_src_global generation:  0.0003199577331542969
r_  generation:  0.0031599998474121094
----------------------check_connections_block total spend ----------------------------- 0.01651167869567871
generate_one_block  0.005149364471435547
generate_one_block  0.0029675960540771484
generate_one_block  0.0022859573364257812
generate_one_block  0.004628181457519531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001836538314819336
gen group dst list time:  0.0003407001495361328
time for parepare:  0.0016744136810302734
local_output_nid generation:  0.00040912628173828125
local_in_edges_tensor generation:  0.0009047985076904297
mini_batch_src_global generation:  0.0012617111206054688
r_  generation:  0.012965202331542969
local_output_nid generation:  0.00031566619873046875
local_in_edges_tensor generation:  0.0005512237548828125
mini_batch_src_global generation:  0.00093841552734375
r_  generation:  0.006706953048706055
local_output_nid generation:  0.0002014636993408203
local_in_edges_tensor generation:  0.00040411949157714844
mini_batch_src_global generation:  0.0005962848663330078
r_  generation:  0.005499839782714844
local_output_nid generation:  0.0003414154052734375
local_in_edges_tensor generation:  0.0005903244018554688
mini_batch_src_global generation:  0.001081705093383789
r_  generation:  0.010948419570922852
----------------------check_connections_block total spend ----------------------------- 0.05469465255737305
generate_one_block  0.015751361846923828
generate_one_block  0.0112152099609375
generate_one_block  0.009451150894165039
generate_one_block  0.014957189559936523
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 0.05399656295776367  GigaBytes
Max Memory Allocated: 1.1269102096557617  GigaBytes

connection checking time:  0.0746915340423584
block generation total time  0.07391619682312012
average batch blocks generation time:  0.01847904920578003
block dataloader generation time/epoch 0.19256043434143066
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 0.05441713333129883  GigaBytes
Max Memory Allocated: 1.1269102096557617  GigaBytes

torch.Size([11050, 500])
torch.Size([3863, 64])
torch.Size([939, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 1.1295337677001953  GigaBytes
Max Memory Allocated: 1.1624188423156738  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 0.051273345947265625  GigaBytes
Max Memory Allocated: 1.1624188423156738  GigaBytes

torch.Size([9012, 500])
torch.Size([2618, 64])
torch.Size([521, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 0.7486047744750977  GigaBytes
Max Memory Allocated: 1.1624188423156738  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 0.048165321350097656  GigaBytes
Max Memory Allocated: 1.1624188423156738  GigaBytes

torch.Size([7787, 500])
torch.Size([1899, 64])
torch.Size([372, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 0.6517963409423828  GigaBytes
Max Memory Allocated: 1.1624188423156738  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 0.05675077438354492  GigaBytes
Max Memory Allocated: 1.1624188423156738  GigaBytes

torch.Size([12306, 500])
torch.Size([3865, 64])
torch.Size([1016, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 1.1395654678344727  GigaBytes
Max Memory Allocated: 1.1775670051574707  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007371485233306885 |0.0014564990997314453 |0.16898280382156372 |0.00013244152069091797 |0.20397871732711792 |0.008919000625610352 |
----------------------------------------------------------pseudo_mini_loss sum 1.4925459623336792
Total (block generation + training)time/epoch 1.7388074398040771
Training time/epoch 1.546008586883545
Training time without block to device /epoch 1.5401825904846191
Training time without total dataloading part /epoch 1.5012948513031006
load block tensor time/epoch 0.02948594093322754
block to device time/epoch 0.005825996398925781
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  55604
Number of first layer input nodes during this epoch:  40155
