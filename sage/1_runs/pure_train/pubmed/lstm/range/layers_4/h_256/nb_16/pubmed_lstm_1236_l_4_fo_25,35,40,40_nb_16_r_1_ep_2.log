main start at this time 1648531619.331964
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0447998046875 GB
    Memory Allocated: 0.015297412872314453  GigaBytes
Max Memory Allocated: 0.015297412872314453  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0021185874938964844
range selection method range initialization spend 9.965896606445312e-05
time for parepare:  4.506111145019531e-05
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0011296272277832031
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.09808349609375e-05
----------------------check_connections_block total spend ----------------------------- 0.002790689468383789
generate_one_block  0.0013179779052734375
generate_one_block  0.0010406970977783203
generate_one_block  0.0010275840759277344
generate_one_block  0.0010263919830322266
generate_one_block  0.0010216236114501953
generate_one_block  0.0010364055633544922
generate_one_block  0.0010333061218261719
generate_one_block  0.0010046958923339844
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011310577392578125
gen group dst list time:  4.887580871582031e-05
time for parepare:  0.00022912025451660156
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00010561943054199219
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0002779960632324219
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00012350082397460938
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00022411346435546875
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00019025802612304688
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00013136863708496094
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00020837783813476562
----------------------check_connections_block total spend ----------------------------- 0.003475189208984375
generate_one_block  0.00115966796875
generate_one_block  0.0014057159423828125
generate_one_block  0.0011060237884521484
generate_one_block  0.0011603832244873047
generate_one_block  0.0012836456298828125
generate_one_block  0.0012536048889160156
generate_one_block  0.0012359619140625
generate_one_block  0.0012853145599365234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012595653533935547
gen group dst list time:  9.131431579589844e-05
time for parepare:  0.0007939338684082031
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0002551078796386719
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0004391670227050781
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  0.000194549560546875
r_  generation:  0.0020189285278320312
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  0.0001227855682373047
r_  generation:  0.0004897117614746094
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.0008480548858642578
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0011548995971679688
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.0001418590545654297
r_  generation:  0.0011484622955322266
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  0.00012040138244628906
r_  generation:  0.0010025501251220703
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  0.0001614093780517578
r_  generation:  0.001600027084350586
----------------------check_connections_block total spend ----------------------------- 0.014510631561279297
generate_one_block  0.001590728759765625
generate_one_block  0.003705263137817383
generate_one_block  0.0015494823455810547
generate_one_block  0.0019483566284179688
generate_one_block  0.002350330352783203
generate_one_block  0.0023593902587890625
generate_one_block  0.0021295547485351562
generate_one_block  0.0027675628662109375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021309852600097656
gen group dst list time:  0.000255584716796875
time for parepare:  0.0015518665313720703
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.0005202293395996094
mini_batch_src_global generation:  0.0003066062927246094
r_  generation:  0.0025892257690429688
local_output_nid generation:  0.00022602081298828125
local_in_edges_tensor generation:  0.0005614757537841797
mini_batch_src_global generation:  0.0010509490966796875
r_  generation:  0.008616447448730469
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.00023937225341796875
mini_batch_src_global generation:  0.0003685951232910156
r_  generation:  0.002575397491455078
local_output_nid generation:  0.00014328956604003906
local_in_edges_tensor generation:  0.0003452301025390625
mini_batch_src_global generation:  0.00046324729919433594
r_  generation:  0.00468897819519043
local_output_nid generation:  0.00016307830810546875
local_in_edges_tensor generation:  0.0003590583801269531
mini_batch_src_global generation:  0.0004825592041015625
r_  generation:  0.0048694610595703125
local_output_nid generation:  0.00016236305236816406
local_in_edges_tensor generation:  0.00035953521728515625
mini_batch_src_global generation:  0.0005023479461669922
r_  generation:  0.005165576934814453
local_output_nid generation:  0.00015354156494140625
local_in_edges_tensor generation:  0.00034928321838378906
mini_batch_src_global generation:  0.0005352497100830078
r_  generation:  0.005146503448486328
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.0003533363342285156
mini_batch_src_global generation:  0.0005712509155273438
r_  generation:  0.0055637359619140625
----------------------check_connections_block total spend ----------------------------- 0.059530019760131836
generate_one_block  0.0045926570892333984
generate_one_block  0.011904239654541016
generate_one_block  0.004274845123291016
generate_one_block  0.007081270217895508
generate_one_block  0.007771492004394531
generate_one_block  0.008078813552856445
generate_one_block  0.007518291473388672
generate_one_block  0.008275270462036133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0447998046875 GB
    Memory Allocated: 0.015297412872314453  GigaBytes
Max Memory Allocated: 0.015297412872314453  GigaBytes

connection checking time:  0.07751584053039551
block generation total time  0.08778786659240723
average batch blocks generation time:  0.010973483324050903
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1092529296875 GB
    Memory Allocated: 0.024222850799560547  GigaBytes
Max Memory Allocated: 0.024222850799560547  GigaBytes

torch.Size([4750, 500])
torch.Size([948, 256])
torch.Size([190, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.29541826248168945  GigaBytes
Max Memory Allocated: 0.2954673767089844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5311279296875 GB
    Memory Allocated: 0.048456668853759766  GigaBytes
Max Memory Allocated: 0.3010063171386719  GigaBytes

torch.Size([9438, 500])
torch.Size([3230, 256])
torch.Size([640, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3240966796875 GB
    Memory Allocated: 1.0539984703063965  GigaBytes
Max Memory Allocated: 1.0540814399719238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.0382080078125  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

torch.Size([4047, 500])
torch.Size([790, 256])
torch.Size([190, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.32252025604248047  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.042821407318115234  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

torch.Size([6265, 500])
torch.Size([1629, 256])
torch.Size([290, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.5853667259216309  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.04436063766479492  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

torch.Size([7305, 500])
torch.Size([2037, 256])
torch.Size([432, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.6219568252563477  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.04834318161010742  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

torch.Size([9126, 500])
torch.Size([1859, 256])
torch.Size([496, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.6698689460754395  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.04283857345581055  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

torch.Size([6159, 500])
torch.Size([1802, 256])
torch.Size([272, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.6431336402893066  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.04285001754760742  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

torch.Size([6471, 500])
torch.Size([1727, 256])
torch.Size([404, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.7475442886352539  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0049915313720703125 |0.04370036721229553 |0.2136920988559723 |0.0001449882984161377 |0.2050188183784485 |0.01066136360168457 |
----------------------------------------------------------pseudo_mini_loss sum 1.9233019351959229
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  70854
Number of first layer input nodes during this epoch:  53561
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.0737309455871582  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005426406860351562
range selection method range initialization spend 5.602836608886719e-05
time for parepare:  6.365776062011719e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.4066696166992188e-05
----------------------check_connections_block total spend ----------------------------- 0.0018498897552490234
generate_one_block  0.0011861324310302734
generate_one_block  0.0011265277862548828
generate_one_block  0.0013630390167236328
generate_one_block  0.0011069774627685547
generate_one_block  0.0011019706726074219
generate_one_block  0.0010716915130615234
generate_one_block  0.010857105255126953
generate_one_block  0.0018444061279296875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0017781257629394531
gen group dst list time:  0.0002713203430175781
time for parepare:  0.0028574466705322266
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0010137557983398438
mini_batch_src_global generation:  0.0001125335693359375
r_  generation:  0.0005805492401123047
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0006132125854492188
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.0006120204925537109
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0007081031799316406
mini_batch_src_global generation:  0.00032448768615722656
r_  generation:  0.00030803680419921875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0005972385406494141
mini_batch_src_global generation:  0.00017976760864257812
r_  generation:  0.00019979476928710938
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.00027179718017578125
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0006153583526611328
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.000263214111328125
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0005688667297363281
mini_batch_src_global generation:  0.00014734268188476562
r_  generation:  0.0002529621124267578
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.000316619873046875
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  8.654594421386719e-05
----------------------check_connections_block total spend ----------------------------- 0.014707803726196289
generate_one_block  0.005059480667114258
generate_one_block  0.004261970520019531
generate_one_block  0.003949880599975586
generate_one_block  0.0013527870178222656
generate_one_block  0.0013751983642578125
generate_one_block  0.001352071762084961
generate_one_block  0.0013606548309326172
generate_one_block  0.0012416839599609375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0014729499816894531
gen group dst list time:  0.00011110305786132812
time for parepare:  0.0011959075927734375
local_output_nid generation:  0.0003781318664550781
local_in_edges_tensor generation:  0.0008070468902587891
mini_batch_src_global generation:  0.0001430511474609375
r_  generation:  0.0011105537414550781
local_output_nid generation:  7.653236389160156e-05
local_in_edges_tensor generation:  0.0006182193756103516
mini_batch_src_global generation:  0.00034689903259277344
r_  generation:  0.001781463623046875
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.0012373924255371094
mini_batch_src_global generation:  0.00026226043701171875
r_  generation:  0.0020329952239990234
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.000255584716796875
mini_batch_src_global generation:  0.00022077560424804688
r_  generation:  0.00087738037109375
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.0003039836883544922
mini_batch_src_global generation:  0.0002391338348388672
r_  generation:  0.0008859634399414062
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.0006616115570068359
mini_batch_src_global generation:  0.00047469139099121094
r_  generation:  0.0011165142059326172
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.0006239414215087891
mini_batch_src_global generation:  0.00031638145446777344
r_  generation:  0.0016369819641113281
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00021839141845703125
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.00025653839111328125
----------------------check_connections_block total spend ----------------------------- 0.024561643600463867
generate_one_block  0.0034809112548828125
generate_one_block  0.003378152847290039
generate_one_block  0.003560781478881836
generate_one_block  0.0020360946655273438
generate_one_block  0.002053499221801758
generate_one_block  0.0024056434631347656
generate_one_block  0.0031785964965820312
generate_one_block  0.0013074874877929688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.004353761672973633
gen group dst list time:  0.00029921531677246094
time for parepare:  0.0013890266418457031
local_output_nid generation:  0.0006382465362548828
local_in_edges_tensor generation:  0.0006916522979736328
mini_batch_src_global generation:  0.0006024837493896484
r_  generation:  0.006842613220214844
local_output_nid generation:  0.0005719661712646484
local_in_edges_tensor generation:  0.0010595321655273438
mini_batch_src_global generation:  0.0012214183807373047
r_  generation:  0.0071294307708740234
local_output_nid generation:  0.0002765655517578125
local_in_edges_tensor generation:  0.0008153915405273438
mini_batch_src_global generation:  0.000644683837890625
r_  generation:  0.006754636764526367
local_output_nid generation:  0.0001773834228515625
local_in_edges_tensor generation:  0.00035309791564941406
mini_batch_src_global generation:  0.0004513263702392578
r_  generation:  0.004215240478515625
local_output_nid generation:  0.00016450881958007812
local_in_edges_tensor generation:  0.00039958953857421875
mini_batch_src_global generation:  0.0003330707550048828
r_  generation:  0.003302335739135742
local_output_nid generation:  0.0001876354217529297
local_in_edges_tensor generation:  0.00035452842712402344
mini_batch_src_global generation:  0.00044035911560058594
r_  generation:  0.004906415939331055
local_output_nid generation:  0.0001850128173828125
local_in_edges_tensor generation:  0.0003781318664550781
mini_batch_src_global generation:  0.0005519390106201172
r_  generation:  0.005226612091064453
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.0002357959747314453
mini_batch_src_global generation:  0.00023365020751953125
r_  generation:  0.0011684894561767578
----------------------check_connections_block total spend ----------------------------- 0.06176400184631348
generate_one_block  0.009257078170776367
generate_one_block  0.009334802627563477
generate_one_block  0.010332107543945312
generate_one_block  0.007304668426513672
generate_one_block  0.005554676055908203
generate_one_block  0.008376359939575195
generate_one_block  0.011111259460449219
generate_one_block  0.002748727798461914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.0737309455871582  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

connection checking time:  0.10103344917297363
block generation total time  0.10537457466125488
average batch blocks generation time:  0.01317182183265686
block dataloader generation time/epoch 0.2999587059020996Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.07563018798828125  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

torch.Size([7670, 500])
torch.Size([1569, 256])
torch.Size([433, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.5981974601745605  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.07667064666748047  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

torch.Size([8203, 500])
torch.Size([2659, 256])
torch.Size([484, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.764432430267334  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.07573127746582031  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

torch.Size([7675, 500])
torch.Size([2327, 256])
torch.Size([495, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.8895101547241211  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.07178926467895508  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

torch.Size([5615, 500])
torch.Size([1412, 256])
torch.Size([241, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.547053337097168  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.07180356979370117  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

torch.Size([5639, 500])
torch.Size([1372, 256])
torch.Size([354, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.43508148193359375  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.07524776458740234  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

torch.Size([7457, 500])
torch.Size([1647, 256])
torch.Size([372, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.6450719833374023  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.07136869430541992  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

torch.Size([5359, 500])
torch.Size([1797, 256])
torch.Size([408, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.7184662818908691  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.06589746475219727  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

torch.Size([2505, 500])
torch.Size([349, 256])
torch.Size([89, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 0.18336248397827148  GigaBytes
Max Memory Allocated: 1.0578250885009766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012041419744491577 |0.0015921592712402344 |0.14896246790885925 |0.00013130903244018555 |0.20162230730056763 |0.008697032928466797 |
----------------------------------------------------------pseudo_mini_loss sum 4.963618278503418
Total (block generation + training)time/epoch 3.2411108016967773
Training time/epoch 2.940805435180664
Training time without block to device /epoch 2.928068161010742
Training time without total dataloading part /epoch 2.8144257068634033
load block tensor time/epoch 0.09633135795593262
block to device time/epoch 0.012737274169921875
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  66488
Number of first layer input nodes during this epoch:  50123
