main start at this time 1648531533.1200223
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.009673595428466797  GigaBytes
Max Memory Allocated: 0.009673595428466797  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001810312271118164
range selection method range initialization spend 9.632110595703125e-05
time for parepare:  4.57763671875e-05
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0015196800231933594
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  5.626678466796875e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.267692565917969e-05
----------------------check_connections_block total spend ----------------------------- 0.0025720596313476562
generate_one_block  0.0013935565948486328
generate_one_block  0.0011296272277832031
generate_one_block  0.0010721683502197266
generate_one_block  0.0010814666748046875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009644031524658203
gen group dst list time:  3.409385681152344e-05
time for parepare:  0.00024366378784179688
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0002105236053466797
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0005273818969726562
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.00020241737365722656
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003914833068847656
----------------------check_connections_block total spend ----------------------------- 0.002800464630126953
generate_one_block  0.0013439655303955078
generate_one_block  0.0017611980438232422
generate_one_block  0.001295328140258789
generate_one_block  0.0016198158264160156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001077413558959961
gen group dst list time:  7.43865966796875e-05
time for parepare:  0.0007927417755126953
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0002791881561279297
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.001413583755493164
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.00026869773864746094
mini_batch_src_global generation:  0.00029850006103515625
r_  generation:  0.0032148361206054688
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  0.00017499923706054688
r_  generation:  0.0011625289916992188
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.000240325927734375
mini_batch_src_global generation:  0.00023674964904785156
r_  generation:  0.002757549285888672
----------------------check_connections_block total spend ----------------------------- 0.013667821884155273
generate_one_block  0.003023862838745117
generate_one_block  0.004744052886962891
generate_one_block  0.0022237300872802734
generate_one_block  0.004330158233642578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021903514862060547
gen group dst list time:  0.00023365020751953125
time for parepare:  0.0014312267303466797
local_output_nid generation:  0.0001888275146484375
local_in_edges_tensor generation:  0.0007333755493164062
mini_batch_src_global generation:  0.0008549690246582031
r_  generation:  0.007122993469238281
local_output_nid generation:  0.00030803680419921875
local_in_edges_tensor generation:  0.0006620883941650391
mini_batch_src_global generation:  0.0012803077697753906
r_  generation:  0.011655092239379883
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.00036644935607910156
mini_batch_src_global generation:  0.0006668567657470703
r_  generation:  0.005494832992553711
local_output_nid generation:  0.00035762786865234375
local_in_edges_tensor generation:  0.000667572021484375
mini_batch_src_global generation:  0.0009093284606933594
r_  generation:  0.010904073715209961
----------------------check_connections_block total spend ----------------------------- 0.05264616012573242
generate_one_block  0.010781049728393555
generate_one_block  0.015174388885498047
generate_one_block  0.008961677551269531
generate_one_block  0.015059947967529297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.009673595428466797  GigaBytes
Max Memory Allocated: 0.009673595428466797  GigaBytes

connection checking time:  0.06911444664001465
block generation total time  0.07031917572021484
average batch blocks generation time:  0.01757979393005371
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.025519371032714844  GigaBytes
Max Memory Allocated: 0.025519371032714844  GigaBytes

torch.Size([8166, 500])
torch.Size([2528, 128])
torch.Size([470, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.768524169921875  GigaBytes
Max Memory Allocated: 0.7825784683227539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.043633460998535156  GigaBytes
Max Memory Allocated: 0.7825784683227539  GigaBytes

torch.Size([12833, 500])
torch.Size([4074, 128])
torch.Size([1070, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5623779296875 GB
    Memory Allocated: 1.2838473320007324  GigaBytes
Max Memory Allocated: 1.2839293479919434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5623779296875 GB
    Memory Allocated: 0.03281402587890625  GigaBytes
Max Memory Allocated: 1.2847552299499512  GigaBytes

torch.Size([7139, 500])
torch.Size([1714, 128])
torch.Size([448, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5623779296875 GB
    Memory Allocated: 0.6071467399597168  GigaBytes
Max Memory Allocated: 1.2847552299499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5623779296875 GB
    Memory Allocated: 0.041173458099365234  GigaBytes
Max Memory Allocated: 1.2847552299499512  GigaBytes

torch.Size([11208, 500])
torch.Size([4157, 128])
torch.Size([860, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5623779296875 GB
    Memory Allocated: 1.1593775749206543  GigaBytes
Max Memory Allocated: 1.2847552299499512  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007909953594207764 |0.0855303406715393 |0.30445146560668945 |0.00017511844635009766 |0.24031496047973633 |0.009224653244018555 |
----------------------------------------------------------pseudo_mini_loss sum 1.8003640174865723
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  55022
Number of first layer input nodes during this epoch:  39346
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5623779296875 GB
    Memory Allocated: 0.061878204345703125  GigaBytes
Max Memory Allocated: 1.2847552299499512  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005316734313964844
range selection method range initialization spend 5.4836273193359375e-05
time for parepare:  6.866455078125e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.933906555175781e-05
----------------------check_connections_block total spend ----------------------------- 0.0011162757873535156
generate_one_block  0.001407623291015625
generate_one_block  0.0011744499206542969
generate_one_block  0.0011692047119140625
generate_one_block  0.00112152099609375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005772113800048828
gen group dst list time:  4.00543212890625e-05
time for parepare:  0.0002663135528564453
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00020742416381835938
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00037288665771484375
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0005137920379638672
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0002903938293457031
----------------------check_connections_block total spend ----------------------------- 0.0030562877655029297
generate_one_block  0.0014193058013916016
generate_one_block  0.0016465187072753906
generate_one_block  0.001983165740966797
generate_one_block  0.0014820098876953125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010950565338134766
gen group dst list time:  8.916854858398438e-05
time for parepare:  0.0007865428924560547
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.0002789497375488281
mini_batch_src_global generation:  0.0001347064971923828
r_  generation:  0.0011534690856933594
local_output_nid generation:  8.630752563476562e-05
local_in_edges_tensor generation:  0.000240325927734375
mini_batch_src_global generation:  0.0002815723419189453
r_  generation:  0.002656698226928711
local_output_nid generation:  0.00010204315185546875
local_in_edges_tensor generation:  0.00026416778564453125
mini_batch_src_global generation:  0.00035643577575683594
r_  generation:  0.0032706260681152344
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  0.00022530555725097656
r_  generation:  0.001851797103881836
----------------------check_connections_block total spend ----------------------------- 0.014251708984375
generate_one_block  0.002646923065185547
generate_one_block  0.0044155120849609375
generate_one_block  0.004996776580810547
generate_one_block  0.003237485885620117
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018706321716308594
gen group dst list time:  0.0002474784851074219
time for parepare:  0.0014121532440185547
local_output_nid generation:  0.00017309188842773438
local_in_edges_tensor generation:  0.0005717277526855469
mini_batch_src_global generation:  0.0006530284881591797
r_  generation:  0.005672931671142578
local_output_nid generation:  0.00029850006103515625
local_in_edges_tensor generation:  0.0006175041198730469
mini_batch_src_global generation:  0.0011417865753173828
r_  generation:  0.010438680648803711
local_output_nid generation:  0.0003647804260253906
local_in_edges_tensor generation:  0.0007171630859375
mini_batch_src_global generation:  0.0010161399841308594
r_  generation:  0.012738943099975586
local_output_nid generation:  0.0003032684326171875
local_in_edges_tensor generation:  0.0005767345428466797
mini_batch_src_global generation:  0.0008478164672851562
r_  generation:  0.008028268814086914
----------------------check_connections_block total spend ----------------------------- 0.054068565368652344
generate_one_block  0.009629964828491211
generate_one_block  0.014632940292358398
generate_one_block  0.016611576080322266
generate_one_block  0.012569904327392578
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5623779296875 GB
    Memory Allocated: 0.061878204345703125  GigaBytes
Max Memory Allocated: 1.2847552299499512  GigaBytes

connection checking time:  0.07137656211853027
block generation total time  0.0752720832824707
average batch blocks generation time:  0.018818020820617676
block dataloader generation time/epoch 0.19315505027770996
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5623779296875 GB
    Memory Allocated: 0.05282163619995117  GigaBytes
Max Memory Allocated: 1.2847552299499512  GigaBytes

torch.Size([7013, 500])
torch.Size([1792, 128])
torch.Size([416, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5623779296875 GB
    Memory Allocated: 0.6288342475891113  GigaBytes
Max Memory Allocated: 1.2847552299499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5623779296875 GB
    Memory Allocated: 0.06149578094482422  GigaBytes
Max Memory Allocated: 1.2847552299499512  GigaBytes

torch.Size([11584, 500])
torch.Size([3577, 128])
torch.Size([836, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5623779296875 GB
    Memory Allocated: 1.1425809860229492  GigaBytes
Max Memory Allocated: 1.2847552299499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5623779296875 GB
    Memory Allocated: 0.061490535736083984  GigaBytes
Max Memory Allocated: 1.2847552299499512  GigaBytes

torch.Size([11562, 500])
torch.Size([4085, 128])
torch.Size([990, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5936279296875 GB
    Memory Allocated: 1.2303833961486816  GigaBytes
Max Memory Allocated: 1.2847552299499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5955810546875 GB
    Memory Allocated: 0.05936717987060547  GigaBytes
Max Memory Allocated: 1.2847552299499512  GigaBytes

torch.Size([10033, 500])
torch.Size([3111, 128])
torch.Size([650, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5955810546875 GB
    Memory Allocated: 0.8879785537719727  GigaBytes
Max Memory Allocated: 1.2847552299499512  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011850178241729736 |0.001542508602142334 |0.17875248193740845 |0.00015223026275634766 |0.24826806783676147 |0.007769107818603516 |
----------------------------------------------------------pseudo_mini_loss sum 1.8967382907867432
Total (block generation + training)time/epoch 1.9742250442504883
Training time/epoch 1.7804286479949951
Training time without block to device /epoch 1.7742586135864258
Training time without total dataloading part /epoch 1.7164602279663086
load block tensor time/epoch 0.047400712966918945
block to device time/epoch 0.006170034408569336
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  56006
Number of first layer input nodes during this epoch:  40192
