main start at this time 1648531546.810544
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.009673595428466797  GigaBytes
Max Memory Allocated: 0.009673595428466797  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0026307106018066406
range selection method range initialization spend 0.00010228157043457031
time for parepare:  4.1961669921875e-05
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  0.0014569759368896484
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9311904907226562e-05
----------------------check_connections_block total spend ----------------------------- 0.0030748844146728516
generate_one_block  0.0012733936309814453
generate_one_block  0.000988006591796875
generate_one_block  0.0010004043579101562
generate_one_block  0.0010423660278320312
generate_one_block  0.0009658336639404297
generate_one_block  0.0009760856628417969
generate_one_block  0.0010275840759277344
generate_one_block  0.0009937286376953125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001173257827758789
gen group dst list time:  4.887580871582031e-05
time for parepare:  0.00022649765014648438
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  9.751319885253906e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00014638900756835938
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00026345252990722656
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00027871131896972656
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00011444091796875
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00010275840759277344
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00015664100646972656
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00015306472778320312
----------------------check_connections_block total spend ----------------------------- 0.0033197402954101562
generate_one_block  0.0010976791381835938
generate_one_block  0.0011796951293945312
generate_one_block  0.001313924789428711
generate_one_block  0.0013172626495361328
generate_one_block  0.00116729736328125
generate_one_block  0.0010859966278076172
generate_one_block  0.0011947154998779297
generate_one_block  0.001215219497680664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011360645294189453
gen group dst list time:  8.654594421386719e-05
time for parepare:  0.000713348388671875
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00024080276489257812
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0006015300750732422
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0007522106170654297
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0017478466033935547
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.00022125244140625
mini_batch_src_global generation:  0.0001723766326904297
r_  generation:  0.001399993896484375
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  9.584426879882812e-05
r_  generation:  0.0006501674652099609
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0007855892181396484
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0008287429809570312
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.0011780261993408203
----------------------check_connections_block total spend ----------------------------- 0.01338052749633789
generate_one_block  0.0019328594207763672
generate_one_block  0.001924753189086914
generate_one_block  0.003247976303100586
generate_one_block  0.0026390552520751953
generate_one_block  0.0017497539520263672
generate_one_block  0.0020797252655029297
generate_one_block  0.0019690990447998047
generate_one_block  0.0024602413177490234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020608901977539062
gen group dst list time:  0.000240325927734375
time for parepare:  0.0013804435729980469
local_output_nid generation:  8.797645568847656e-05
local_in_edges_tensor generation:  0.0005407333374023438
mini_batch_src_global generation:  0.00042700767517089844
r_  generation:  0.003398418426513672
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.00035858154296875
mini_batch_src_global generation:  0.0005717277526855469
r_  generation:  0.0043277740478515625
local_output_nid generation:  0.0001895427703857422
local_in_edges_tensor generation:  0.0004487037658691406
mini_batch_src_global generation:  0.0007047653198242188
r_  generation:  0.006689310073852539
local_output_nid generation:  0.00017380714416503906
local_in_edges_tensor generation:  0.0004062652587890625
mini_batch_src_global generation:  0.0005877017974853516
r_  generation:  0.005846977233886719
local_output_nid generation:  0.00010800361633300781
local_in_edges_tensor generation:  0.0002715587615966797
mini_batch_src_global generation:  0.00042510032653808594
r_  generation:  0.003662586212158203
local_output_nid generation:  0.00016832351684570312
local_in_edges_tensor generation:  0.00034499168395996094
mini_batch_src_global generation:  0.0004260540008544922
r_  generation:  0.004577159881591797
local_output_nid generation:  0.0001373291015625
local_in_edges_tensor generation:  0.0003285408020019531
mini_batch_src_global generation:  0.00037932395935058594
r_  generation:  0.0036246776580810547
local_output_nid generation:  0.0001430511474609375
local_in_edges_tensor generation:  0.00032782554626464844
mini_batch_src_global generation:  0.0004634857177734375
r_  generation:  0.0050313472747802734
----------------------check_connections_block total spend ----------------------------- 0.056199073791503906
generate_one_block  0.0065767765045166016
generate_one_block  0.0068759918212890625
generate_one_block  0.010025978088378906
generate_one_block  0.009062767028808594
generate_one_block  0.006285190582275391
generate_one_block  0.007012367248535156
generate_one_block  0.0055501461029052734
generate_one_block  0.00806117057800293
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.009673595428466797  GigaBytes
Max Memory Allocated: 0.009673595428466797  GigaBytes

connection checking time:  0.07289934158325195
block generation total time  0.08702564239501953
average batch blocks generation time:  0.010878205299377441
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.019350528717041016  GigaBytes
Max Memory Allocated: 0.019350528717041016  GigaBytes

torch.Size([5133, 500])
torch.Size([1149, 128])
torch.Size([218, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.41152048110961914  GigaBytes
Max Memory Allocated: 0.4237065315246582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.03066873550415039  GigaBytes
Max Memory Allocated: 0.4237065315246582  GigaBytes

torch.Size([5983, 500])
torch.Size([1646, 128])
torch.Size([269, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7342529296875 GB
    Memory Allocated: 0.5138473510742188  GigaBytes
Max Memory Allocated: 0.5281577110290527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.034325599670410156  GigaBytes
Max Memory Allocated: 0.5281577110290527  GigaBytes

torch.Size([7891, 500])
torch.Size([2366, 128])
torch.Size([515, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0643310546875 GB
    Memory Allocated: 0.815732479095459  GigaBytes
Max Memory Allocated: 0.815772533416748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.03677845001220703  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

torch.Size([9232, 500])
torch.Size([2254, 128])
torch.Size([649, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.6953697204589844  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.028930187225341797  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

torch.Size([5061, 500])
torch.Size([1152, 128])
torch.Size([262, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.43960046768188477  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.03161478042602539  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

torch.Size([6489, 500])
torch.Size([1830, 128])
torch.Size([236, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.5275368690490723  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.029884815216064453  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

torch.Size([5576, 500])
torch.Size([1565, 128])
torch.Size([363, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.40983152389526367  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.029747962951660156  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

torch.Size([5473, 500])
torch.Size([1618, 128])
torch.Size([359, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.5859403610229492  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004903316497802734 |0.04421430826187134 |0.21980366110801697 |0.00014075636863708496 |0.19902092218399048 |0.012043476104736328 |
----------------------------------------------------------pseudo_mini_loss sum 2.131871461868286
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  67644
Number of first layer input nodes during this epoch:  50838
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.049312591552734375  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005354881286621094
range selection method range initialization spend 5.602836608886719e-05
time for parepare:  6.175041198730469e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.1696090698242188e-05
----------------------check_connections_block total spend ----------------------------- 0.0018391609191894531
generate_one_block  0.0017151832580566406
generate_one_block  0.001108407974243164
generate_one_block  0.001417398452758789
generate_one_block  0.0011172294616699219
generate_one_block  0.0010886192321777344
generate_one_block  0.0011096000671386719
generate_one_block  0.0010752677917480469
generate_one_block  0.0010647773742675781
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005824565887451172
gen group dst list time:  7.772445678710938e-05
time for parepare:  0.0002892017364501953
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0001347064971923828
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00010228157043457031
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0002779960632324219
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0001976490020751953
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00012993812561035156
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.00033164024353027344
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001575946807861328
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  7.987022399902344e-05
----------------------check_connections_block total spend ----------------------------- 0.003688335418701172
generate_one_block  0.0013108253479003906
generate_one_block  0.0012154579162597656
generate_one_block  0.0015287399291992188
generate_one_block  0.0013346672058105469
generate_one_block  0.0012040138244628906
generate_one_block  0.001550436019897461
generate_one_block  0.0012722015380859375
generate_one_block  0.0011758804321289062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011701583862304688
gen group dst list time:  0.00010085105895996094
time for parepare:  0.0007410049438476562
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0002617835998535156
mini_batch_src_global generation:  0.00010561943054199219
r_  generation:  0.0007178783416748047
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.0005853176116943359
local_output_nid generation:  7.367134094238281e-05
local_in_edges_tensor generation:  0.000240325927734375
mini_batch_src_global generation:  0.00023818016052246094
r_  generation:  0.0020530223846435547
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  0.00016045570373535156
r_  generation:  0.0011301040649414062
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  0.00010371208190917969
r_  generation:  0.0006890296936035156
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.00023055076599121094
mini_batch_src_global generation:  0.00021386146545410156
r_  generation:  0.0024008750915527344
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.000926971435546875
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0003407001495361328
----------------------check_connections_block total spend ----------------------------- 0.01513981819152832
generate_one_block  0.010886430740356445
generate_one_block  0.002784252166748047
generate_one_block  0.0053424835205078125
generate_one_block  0.002875804901123047
generate_one_block  0.0022242069244384766
generate_one_block  0.00474238395690918
generate_one_block  0.002377033233642578
generate_one_block  0.0016391277313232422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.005748271942138672
gen group dst list time:  0.0008602142333984375
time for parepare:  0.0022470951080322266
local_output_nid generation:  0.0006957054138183594
local_in_edges_tensor generation:  0.002326488494873047
mini_batch_src_global generation:  0.0007174015045166016
r_  generation:  0.0038900375366210938
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.0003905296325683594
mini_batch_src_global generation:  0.0004627704620361328
r_  generation:  0.0033502578735351562
local_output_nid generation:  0.0005528926849365234
local_in_edges_tensor generation:  0.0006005764007568359
mini_batch_src_global generation:  0.0009613037109375
r_  generation:  0.00824880599975586
local_output_nid generation:  0.00022411346435546875
local_in_edges_tensor generation:  0.0004374980926513672
mini_batch_src_global generation:  0.0005822181701660156
r_  generation:  0.0050106048583984375
local_output_nid generation:  0.0001652240753173828
local_in_edges_tensor generation:  0.0003647804260253906
mini_batch_src_global generation:  0.0004134178161621094
r_  generation:  0.003954887390136719
local_output_nid generation:  0.0003981590270996094
local_in_edges_tensor generation:  0.0006186962127685547
mini_batch_src_global generation:  0.0008559226989746094
r_  generation:  0.008659124374389648
local_output_nid generation:  0.000179290771484375
local_in_edges_tensor generation:  0.0005202293395996094
mini_batch_src_global generation:  0.0005331039428710938
r_  generation:  0.004447460174560547
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.0003604888916015625
mini_batch_src_global generation:  0.0002551078796386719
r_  generation:  0.0015902519226074219
----------------------check_connections_block total spend ----------------------------- 0.06549310684204102
generate_one_block  0.009342193603515625
generate_one_block  0.006003379821777344
generate_one_block  0.014155149459838867
generate_one_block  0.007837772369384766
generate_one_block  0.0063893795013427734
generate_one_block  0.013667821884155273
generate_one_block  0.007231235504150391
generate_one_block  0.003259897232055664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.049312591552734375  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

connection checking time:  0.08432126045227051
block generation total time  0.11135077476501465
average batch blocks generation time:  0.013918846845626831
block dataloader generation time/epoch 0.2799046039581299Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.04745006561279297  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

torch.Size([4621, 500])
torch.Size([1207, 128])
torch.Size([219, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.4618649482727051  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.04785490036010742  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

torch.Size([4849, 500])
torch.Size([1002, 128])
torch.Size([239, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.3973102569580078  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.059079647064208984  GigaBytes
Max Memory Allocated: 0.8166742324829102  GigaBytes

torch.Size([10775, 500])
torch.Size([2843, 128])
torch.Size([664, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 1.00862455368042  GigaBytes
Max Memory Allocated: 1.0161709785461426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.05162954330444336  GigaBytes
Max Memory Allocated: 1.0161709785461426  GigaBytes

torch.Size([6852, 500])
torch.Size([1989, 128])
torch.Size([382, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.5341219902038574  GigaBytes
Max Memory Allocated: 1.0161709785461426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.049134254455566406  GigaBytes
Max Memory Allocated: 1.0161709785461426  GigaBytes

torch.Size([5525, 500])
torch.Size([1379, 128])
torch.Size([211, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.4698653221130371  GigaBytes
Max Memory Allocated: 1.0161709785461426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.056786537170410156  GigaBytes
Max Memory Allocated: 1.0161709785461426  GigaBytes

torch.Size([9535, 500])
torch.Size([3217, 128])
torch.Size([697, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 1.035120964050293  GigaBytes
Max Memory Allocated: 1.0351676940917969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.05164146423339844  GigaBytes
Max Memory Allocated: 1.0360560417175293  GigaBytes

torch.Size([6860, 500])
torch.Size([1436, 128])
torch.Size([343, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.5315728187561035  GigaBytes
Max Memory Allocated: 1.0360560417175293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.04376029968261719  GigaBytes
Max Memory Allocated: 1.0360560417175293  GigaBytes

torch.Size([2680, 500])
torch.Size([632, 128])
torch.Size([148, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.19799137115478516  GigaBytes
Max Memory Allocated: 1.0360560417175293  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009866923093795776 |0.0013611018657684326 |0.15618333220481873 |0.0001347064971923828 |0.19346466660499573 |0.008324384689331055 |
----------------------------------------------------------pseudo_mini_loss sum 2.168691635131836
Total (block generation + training)time/epoch 3.194160223007202
Training time/epoch 2.9139163494110107
Training time without block to device /epoch 2.9030275344848633
Training time without total dataloading part /epoch 2.8065860271453857
load block tensor time/epoch 0.07893538475036621
block to device time/epoch 0.010888814926147461
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  68662
Number of first layer input nodes during this epoch:  51697
