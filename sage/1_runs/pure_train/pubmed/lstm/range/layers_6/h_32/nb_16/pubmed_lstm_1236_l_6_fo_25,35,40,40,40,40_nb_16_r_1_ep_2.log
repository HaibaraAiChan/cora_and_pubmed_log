main start at this time 1648534358.7252166
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0019156932830810547
range selection method range initialization spend 8.0108642578125e-05
time for parepare:  4.410743713378906e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.002391815185546875
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.00398707389831543
generate_one_block  0.0011632442474365234
generate_one_block  0.0010008811950683594
generate_one_block  0.0009818077087402344
generate_one_block  0.0010335445404052734
generate_one_block  0.0009882450103759766
generate_one_block  0.0009903907775878906
generate_one_block  0.0009922981262207031
generate_one_block  0.0009679794311523438
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0010967254638671875
gen group dst list time:  4.863739013671875e-05
time for parepare:  0.0002505779266357422
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0002315044403076172
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  9.608268737792969e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00011467933654785156
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.000141143798828125
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0002982616424560547
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00012826919555664062
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00023555755615234375
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00010061264038085938
----------------------check_connections_block total spend ----------------------------- 0.0033664703369140625
generate_one_block  0.0013086795806884766
generate_one_block  0.0010919570922851562
generate_one_block  0.0011661052703857422
generate_one_block  0.001148223876953125
generate_one_block  0.0013818740844726562
generate_one_block  0.0011348724365234375
generate_one_block  0.0013167858123779297
generate_one_block  0.001132965087890625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011897087097167969
gen group dst list time:  9.1552734375e-05
time for parepare:  0.0007452964782714844
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0002810955047607422
mini_batch_src_global generation:  0.0001404285430908203
r_  generation:  0.0015058517456054688
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0004718303680419922
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0007061958312988281
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.00061798095703125
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.0002105236053466797
r_  generation:  0.002290964126586914
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00015783309936523438
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0007481575012207031
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  0.00013971328735351562
r_  generation:  0.0015213489532470703
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  0.0001163482666015625
r_  generation:  0.0008683204650878906
----------------------check_connections_block total spend ----------------------------- 0.014469146728515625
generate_one_block  0.003639698028564453
generate_one_block  0.001542806625366211
generate_one_block  0.0017745494842529297
generate_one_block  0.0016407966613769531
generate_one_block  0.0037555694580078125
generate_one_block  0.0018200874328613281
generate_one_block  0.0027866363525390625
generate_one_block  0.002048969268798828
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021169185638427734
gen group dst list time:  0.0002624988555908203
time for parepare:  0.0015206336975097656
local_output_nid generation:  0.000141143798828125
local_in_edges_tensor generation:  0.0006573200225830078
mini_batch_src_global generation:  0.000759124755859375
r_  generation:  0.006139516830444336
local_output_nid generation:  7.343292236328125e-05
local_in_edges_tensor generation:  0.0002562999725341797
mini_batch_src_global generation:  0.00041961669921875
r_  generation:  0.002869844436645508
local_output_nid generation:  0.00011682510375976562
local_in_edges_tensor generation:  0.00032520294189453125
mini_batch_src_global generation:  0.00046634674072265625
r_  generation:  0.004867076873779297
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.00025773048400878906
mini_batch_src_global generation:  0.0003466606140136719
r_  generation:  0.0030939579010009766
local_output_nid generation:  0.0002257823944091797
local_in_edges_tensor generation:  0.0005147457122802734
mini_batch_src_global generation:  0.0010023117065429688
r_  generation:  0.010169267654418945
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.0002999305725097656
mini_batch_src_global generation:  0.0005481243133544922
r_  generation:  0.0043048858642578125
local_output_nid generation:  0.00021219253540039062
local_in_edges_tensor generation:  0.0004627704620361328
mini_batch_src_global generation:  0.0006301403045654297
r_  generation:  0.00715184211730957
local_output_nid generation:  0.00015878677368164062
local_in_edges_tensor generation:  0.0003521442413330078
mini_batch_src_global generation:  0.0005600452423095703
r_  generation:  0.005335330963134766
----------------------check_connections_block total spend ----------------------------- 0.06569886207580566
generate_one_block  0.010650634765625
generate_one_block  0.0047948360443115234
generate_one_block  0.007315158843994141
generate_one_block  0.0050313472747802734
generate_one_block  0.013768196105957031
generate_one_block  0.00642848014831543
generate_one_block  0.011275053024291992
generate_one_block  0.008166790008544922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018222332000732422
gen group dst list time:  0.0013675689697265625
time for parepare:  0.0017285346984863281
local_output_nid generation:  0.0004909038543701172
local_in_edges_tensor generation:  0.0012700557708740234
mini_batch_src_global generation:  0.0013358592987060547
r_  generation:  0.013288259506225586
local_output_nid generation:  0.0004761219024658203
local_in_edges_tensor generation:  0.001074075698852539
mini_batch_src_global generation:  0.0014567375183105469
r_  generation:  0.011729240417480469
local_output_nid generation:  0.0006022453308105469
local_in_edges_tensor generation:  0.0021250247955322266
mini_batch_src_global generation:  0.001285552978515625
r_  generation:  0.014510154724121094
local_output_nid generation:  0.00047278404235839844
local_in_edges_tensor generation:  0.0007851123809814453
mini_batch_src_global generation:  0.0011963844299316406
r_  generation:  0.011357545852661133
local_output_nid generation:  0.0009546279907226562
local_in_edges_tensor generation:  0.0018715858459472656
mini_batch_src_global generation:  0.001867055892944336
r_  generation:  0.020449399948120117
local_output_nid generation:  0.0005702972412109375
local_in_edges_tensor generation:  0.0008938312530517578
mini_batch_src_global generation:  0.0013885498046875
r_  generation:  0.013830423355102539
local_output_nid generation:  0.00079345703125
local_in_edges_tensor generation:  0.0013577938079833984
mini_batch_src_global generation:  0.0014276504516601562
r_  generation:  0.01804184913635254
local_output_nid generation:  0.0006721019744873047
local_in_edges_tensor generation:  0.0010008811950683594
mini_batch_src_global generation:  0.0014410018920898438
r_  generation:  0.016228437423706055
----------------------check_connections_block total spend ----------------------------- 0.17632532119750977
generate_one_block  0.017473936080932617
generate_one_block  0.01652216911315918
generate_one_block  0.0191953182220459
generate_one_block  0.015498161315917969
generate_one_block  0.0269167423248291
generate_one_block  0.018749475479125977
generate_one_block  0.024060726165771484
generate_one_block  0.02384161949157715
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001875162124633789
gen group dst list time:  0.0027077198028564453
time for parepare:  0.001626729965209961
local_output_nid generation:  0.0009944438934326172
local_in_edges_tensor generation:  0.002119779586791992
mini_batch_src_global generation:  0.0017924308776855469
r_  generation:  0.020191669464111328
local_output_nid generation:  0.001058340072631836
local_in_edges_tensor generation:  0.00203704833984375
mini_batch_src_global generation:  0.0022966861724853516
r_  generation:  0.02085280418395996
local_output_nid generation:  0.0011372566223144531
local_in_edges_tensor generation:  0.0021409988403320312
mini_batch_src_global generation:  0.0017099380493164062
r_  generation:  0.02193927764892578
local_output_nid generation:  0.0011434555053710938
local_in_edges_tensor generation:  0.0019061565399169922
mini_batch_src_global generation:  0.0018281936645507812
r_  generation:  0.020639419555664062
local_output_nid generation:  0.0013611316680908203
local_in_edges_tensor generation:  0.002449512481689453
mini_batch_src_global generation:  0.002051830291748047
r_  generation:  0.024548768997192383
local_output_nid generation:  0.0012760162353515625
local_in_edges_tensor generation:  0.0021479129791259766
mini_batch_src_global generation:  0.0018143653869628906
r_  generation:  0.02273416519165039
local_output_nid generation:  0.0013170242309570312
local_in_edges_tensor generation:  0.0022106170654296875
mini_batch_src_global generation:  0.0018835067749023438
r_  generation:  0.02461075782775879
local_output_nid generation:  0.001432180404663086
local_in_edges_tensor generation:  0.0022003650665283203
mini_batch_src_global generation:  0.001814126968383789
r_  generation:  0.023617267608642578
----------------------check_connections_block total spend ----------------------------- 0.2604069709777832
generate_one_block  0.02551102638244629
generate_one_block  0.0282590389251709
generate_one_block  0.028034687042236328
generate_one_block  0.02693629264831543
generate_one_block  0.03073287010192871
generate_one_block  0.028812170028686523
generate_one_block  0.030174970626831055
generate_one_block  0.029751062393188477
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

connection checking time:  0.5202667713165283
block generation total time  0.4865913391113281
average batch blocks generation time:  0.060823917388916016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1346435546875 GB
    Memory Allocated: 0.04028511047363281  GigaBytes
Max Memory Allocated: 0.04028511047363281  GigaBytes

torch.Size([16883, 500])
torch.Size([11647, 32])
torch.Size([6202, 32])
torch.Size([1979, 32])
torch.Size([434, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5272216796875 GB
    Memory Allocated: 2.147916316986084  GigaBytes
Max Memory Allocated: 2.168612480163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5272216796875 GB
    Memory Allocated: 0.049315452575683594  GigaBytes
Max Memory Allocated: 2.168612480163574  GigaBytes

torch.Size([17636, 500])
torch.Size([11924, 32])
torch.Size([5386, 32])
torch.Size([861, 32])
torch.Size([227, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6580810546875 GB
    Memory Allocated: 2.1832633018493652  GigaBytes
Max Memory Allocated: 2.2529425621032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6580810546875 GB
    Memory Allocated: 0.049814701080322266  GigaBytes
Max Memory Allocated: 2.2529425621032715  GigaBytes

torch.Size([17639, 500])
torch.Size([12851, 32])
torch.Size([6694, 32])
torch.Size([1445, 32])
torch.Size([256, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7889404296875 GB
    Memory Allocated: 2.266205310821533  GigaBytes
Max Memory Allocated: 2.306544303894043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7889404296875 GB
    Memory Allocated: 0.048996925354003906  GigaBytes
Max Memory Allocated: 2.306544303894043  GigaBytes

torch.Size([17469, 500])
torch.Size([11606, 32])
torch.Size([5110, 32])
torch.Size([1049, 32])
torch.Size([273, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7889404296875 GB
    Memory Allocated: 2.1477060317993164  GigaBytes
Max Memory Allocated: 2.306544303894043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7889404296875 GB
    Memory Allocated: 0.052260398864746094  GigaBytes
Max Memory Allocated: 2.306544303894043  GigaBytes

torch.Size([18936, 500])
torch.Size([16176, 32])
torch.Size([11611, 32])
torch.Size([3015, 32])
torch.Size([675, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 2.580425262451172  GigaBytes
Max Memory Allocated: 2.580447196960449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 0.050507545471191406  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

torch.Size([18213, 500])
torch.Size([13533, 32])
torch.Size([6226, 32])
torch.Size([1370, 32])
torch.Size([282, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 2.3261351585388184  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 0.05158805847167969  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

torch.Size([18657, 500])
torch.Size([15726, 32])
torch.Size([9058, 32])
torch.Size([2609, 32])
torch.Size([517, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 2.5118660926818848  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 0.050524234771728516  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

torch.Size([18159, 500])
torch.Size([14809, 32])
torch.Size([7455, 32])
torch.Size([1848, 32])
torch.Size([251, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 2.404264450073242  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01936393976211548 |0.04512175917625427 |0.38851186633110046 |0.0001551806926727295 |0.43971726298332214 |0.013489246368408203 |
----------------------------------------------------------pseudo_mini_loss sum 1.8493499755859375
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  327054
Number of first layer input nodes during this epoch:  143592
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 0.06888389587402344  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007805824279785156
range selection method range initialization spend 7.343292236328125e-05
time for parepare:  7.176399230957031e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.002051115036010742
generate_one_block  0.0013680458068847656
generate_one_block  0.0013184547424316406
generate_one_block  0.001268625259399414
generate_one_block  0.001314401626586914
generate_one_block  0.0012557506561279297
generate_one_block  0.0012633800506591797
generate_one_block  0.0012831687927246094
generate_one_block  0.0012345314025878906
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000705718994140625
gen group dst list time:  7.176399230957031e-05
time for parepare:  0.00041556358337402344
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.0001380443572998047
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0002751350402832031
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001513957977294922
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0002944469451904297
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00015974044799804688
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0002658367156982422
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00028514862060546875
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00012731552124023438
----------------------check_connections_block total spend ----------------------------- 0.004530429840087891
generate_one_block  0.0014657974243164062
generate_one_block  0.0016837120056152344
generate_one_block  0.0014481544494628906
generate_one_block  0.0017504692077636719
generate_one_block  0.0014684200286865234
generate_one_block  0.0016150474548339844
generate_one_block  0.001329660415649414
generate_one_block  0.0011532306671142578
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012967586517333984
gen group dst list time:  0.000152587890625
time for parepare:  0.0011436939239501953
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.0004169940948486328
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0006349086761474609
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.0002474784851074219
mini_batch_src_global generation:  0.0002598762512207031
r_  generation:  0.001729726791381836
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.0001766681671142578
r_  generation:  0.0012369155883789062
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.0002357959747314453
mini_batch_src_global generation:  0.00024771690368652344
r_  generation:  0.001993417739868164
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  0.00017499923706054688
r_  generation:  0.000993967056274414
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.0002474784851074219
mini_batch_src_global generation:  0.00023055076599121094
r_  generation:  0.001993894577026367
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  0.0001976490020751953
r_  generation:  0.0014646053314208984
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  0.0001010894775390625
r_  generation:  0.0005896091461181641
----------------------check_connections_block total spend ----------------------------- 0.018973827362060547
generate_one_block  0.002384662628173828
generate_one_block  0.0032122135162353516
generate_one_block  0.0024747848510742188
generate_one_block  0.0031387805938720703
generate_one_block  0.002054452896118164
generate_one_block  0.0033648014068603516
generate_one_block  0.002949237823486328
generate_one_block  0.0016491413116455078
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0030422210693359375
gen group dst list time:  0.0006844997406005859
time for parepare:  0.003281116485595703
local_output_nid generation:  0.0002243518829345703
local_in_edges_tensor generation:  0.0011451244354248047
mini_batch_src_global generation:  0.0007679462432861328
r_  generation:  0.00518345832824707
local_output_nid generation:  0.0003910064697265625
local_in_edges_tensor generation:  0.0006871223449707031
mini_batch_src_global generation:  0.001360177993774414
r_  generation:  0.008576154708862305
local_output_nid generation:  0.00023937225341796875
local_in_edges_tensor generation:  0.0004477500915527344
mini_batch_src_global generation:  0.0006430149078369141
r_  generation:  0.005503177642822266
local_output_nid generation:  0.00018477439880371094
local_in_edges_tensor generation:  0.0003707408905029297
mini_batch_src_global generation:  0.0006043910980224609
r_  generation:  0.00540471076965332
local_output_nid generation:  0.00014710426330566406
local_in_edges_tensor generation:  0.000331878662109375
mini_batch_src_global generation:  0.0005052089691162109
r_  generation:  0.004606008529663086
local_output_nid generation:  0.0002346038818359375
local_in_edges_tensor generation:  0.0010073184967041016
mini_batch_src_global generation:  0.000644683837890625
r_  generation:  0.0065577030181884766
local_output_nid generation:  0.0002512931823730469
local_in_edges_tensor generation:  0.00045943260192871094
mini_batch_src_global generation:  0.0006875991821289062
r_  generation:  0.00677800178527832
local_output_nid generation:  9.632110595703125e-05
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  0.0004227161407470703
r_  generation:  0.0029647350311279297
----------------------check_connections_block total spend ----------------------------- 0.07369279861450195
generate_one_block  0.006779670715332031
generate_one_block  0.012299060821533203
generate_one_block  0.008829355239868164
generate_one_block  0.008480072021484375
generate_one_block  0.007623195648193359
generate_one_block  0.010195016860961914
generate_one_block  0.010653018951416016
generate_one_block  0.005318641662597656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0024034976959228516
gen group dst list time:  0.0012924671173095703
time for parepare:  0.0018057823181152344
local_output_nid generation:  0.0006735324859619141
local_in_edges_tensor generation:  0.0018396377563476562
mini_batch_src_global generation:  0.0012094974517822266
r_  generation:  0.012858867645263672
local_output_nid generation:  0.001016855239868164
local_in_edges_tensor generation:  0.0019359588623046875
mini_batch_src_global generation:  0.0023283958435058594
r_  generation:  0.019468307495117188
local_output_nid generation:  0.0008912086486816406
local_in_edges_tensor generation:  0.001283407211303711
mini_batch_src_global generation:  0.0016770362854003906
r_  generation:  0.017269611358642578
local_output_nid generation:  0.0006458759307861328
local_in_edges_tensor generation:  0.0007991790771484375
mini_batch_src_global generation:  0.0011148452758789062
r_  generation:  0.012384891510009766
local_output_nid generation:  0.000858306884765625
local_in_edges_tensor generation:  0.0010650157928466797
mini_batch_src_global generation:  0.001293182373046875
r_  generation:  0.015700817108154297
local_output_nid generation:  0.0008306503295898438
local_in_edges_tensor generation:  0.0009987354278564453
mini_batch_src_global generation:  0.0014178752899169922
r_  generation:  0.015651941299438477
local_output_nid generation:  0.0010828971862792969
local_in_edges_tensor generation:  0.0013318061828613281
mini_batch_src_global generation:  0.0014019012451171875
r_  generation:  0.018453359603881836
local_output_nid generation:  0.0007004737854003906
local_in_edges_tensor generation:  0.0008029937744140625
mini_batch_src_global generation:  0.0011363029479980469
r_  generation:  0.011198043823242188
----------------------check_connections_block total spend ----------------------------- 0.18220162391662598
generate_one_block  0.01803731918334961
generate_one_block  0.027302265167236328
generate_one_block  0.024213075637817383
generate_one_block  0.017326831817626953
generate_one_block  0.023234844207763672
generate_one_block  0.021772384643554688
generate_one_block  0.025181055068969727
generate_one_block  0.015447854995727539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018672943115234375
gen group dst list time:  0.002756357192993164
time for parepare:  0.0018355846405029297
local_output_nid generation:  0.0014095306396484375
local_in_edges_tensor generation:  0.002371072769165039
mini_batch_src_global generation:  0.0019462108612060547
r_  generation:  0.022090673446655273
local_output_nid generation:  0.0014336109161376953
local_in_edges_tensor generation:  0.002599954605102539
mini_batch_src_global generation:  0.0029070377349853516
r_  generation:  0.02474355697631836
local_output_nid generation:  0.001642465591430664
local_in_edges_tensor generation:  0.0022840499877929688
mini_batch_src_global generation:  0.0019211769104003906
r_  generation:  0.02471137046813965
local_output_nid generation:  0.0012078285217285156
local_in_edges_tensor generation:  0.0014090538024902344
mini_batch_src_global generation:  0.0016176700592041016
r_  generation:  0.019381284713745117
local_output_nid generation:  0.001527547836303711
local_in_edges_tensor generation:  0.001733541488647461
mini_batch_src_global generation:  0.0019047260284423828
r_  generation:  0.023058414459228516
local_output_nid generation:  0.001455068588256836
local_in_edges_tensor generation:  0.002103567123413086
mini_batch_src_global generation:  0.0018231868743896484
r_  generation:  0.022656679153442383
local_output_nid generation:  0.0015511512756347656
local_in_edges_tensor generation:  0.002321958541870117
mini_batch_src_global generation:  0.0021622180938720703
r_  generation:  0.024645328521728516
local_output_nid generation:  0.0011601448059082031
local_in_edges_tensor generation:  0.0015113353729248047
mini_batch_src_global generation:  0.0017290115356445312Using backend: pytorch

r_  generation:  0.021167516708374023
----------------------check_connections_block total spend ----------------------------- 0.26731204986572266
generate_one_block  0.03005671501159668
generate_one_block  0.03301644325256348
generate_one_block  0.03181934356689453
generate_one_block  0.026716232299804688
generate_one_block  0.030412912368774414
generate_one_block  0.030069589614868164
generate_one_block  0.03256416320800781
generate_one_block  0.02836132049560547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 0.06888389587402344  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

connection checking time:  0.546710729598999
block generation total time  0.518852949142456
average batch blocks generation time:  0.064856618642807
block dataloader generation time/epoch 1.2426352500915527
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 0.06627893447875977  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

torch.Size([17895, 500])
torch.Size([12585, 32])
torch.Size([5218, 32])
torch.Size([991, 32])
torch.Size([221, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 2.2442126274108887  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 0.06808280944824219  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

torch.Size([18668, 500])
torch.Size([15638, 32])
torch.Size([10148, 32])
torch.Size([2589, 32])
torch.Size([502, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 2.5218000411987305  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 0.06759786605834961  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

torch.Size([18473, 500])
torch.Size([15314, 32])
torch.Size([7643, 32])
torch.Size([2017, 32])
torch.Size([242, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 2.4716362953186035  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 0.06250619888305664  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

torch.Size([15845, 500])
torch.Size([10475, 32])
torch.Size([5233, 32])
torch.Size([1749, 32])
torch.Size([394, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 2.0128512382507324  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 0.06672048568725586  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

torch.Size([18047, 500])
torch.Size([13601, 32])
torch.Size([6756, 32])
torch.Size([1350, 32])
torch.Size([272, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0076904296875 GB
    Memory Allocated: 2.356886386871338  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0076904296875 GB
    Memory Allocated: 0.06637382507324219  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

torch.Size([17552, 500])
torch.Size([13200, 32])
torch.Size([6933, 32])
torch.Size([2129, 32])
torch.Size([480, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0174560546875 GB
    Memory Allocated: 2.325948715209961  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0174560546875 GB
    Memory Allocated: 0.06804800033569336  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

torch.Size([18680, 500])
torch.Size([15316, 32])
torch.Size([8904, 32])
torch.Size([2351, 32])
torch.Size([513, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0174560546875 GB
    Memory Allocated: 2.4974570274353027  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0174560546875 GB
    Memory Allocated: 0.06607627868652344  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

torch.Size([17781, 500])
torch.Size([11268, 32])
torch.Size([5465, 32])
torch.Size([837, 32])
torch.Size([251, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0174560546875 GB
    Memory Allocated: 2.1254172325134277  GigaBytes
Max Memory Allocated: 2.5804762840270996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.020633399486541748 |0.004090785980224609 |0.33081573247909546 |0.0001423954963684082 |0.45066043734550476 |0.011814117431640625 |
----------------------------------------------------------pseudo_mini_loss sum 1.4356944561004639
Total (block generation + training)time/epoch 7.730541229248047
Training time/epoch 6.487428426742554
Training time without block to device /epoch 6.454702138900757
Training time without total dataloading part /epoch 6.26476263999939
load block tensor time/epoch 0.16506719589233398
block to device time/epoch 0.032726287841796875
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  323882
Number of first layer input nodes during this epoch:  142941
