main start at this time 1648534340.2421353
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0018372535705566406
range selection method range initialization spend 9.799003601074219e-05
time for parepare:  4.7206878662109375e-05
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0015785694122314453
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.38690185546875e-05
----------------------check_connections_block total spend ----------------------------- 0.002642393112182617
generate_one_block  0.001264810562133789
generate_one_block  0.0010836124420166016
generate_one_block  0.0011067390441894531
generate_one_block  0.001102447509765625
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011897087097167969
gen group dst list time:  3.457069396972656e-05
time for parepare:  0.00024008750915527344
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.000240325927734375
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0002868175506591797
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00022745132446289062
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.00047779083251953125
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0003731250762939453
----------------------check_connections_block total spend ----------------------------- 0.0029244422912597656
generate_one_block  0.0014562606811523438
generate_one_block  0.0013470649719238281
generate_one_block  0.0016739368438720703
generate_one_block  0.0015556812286376953
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010714530944824219
gen group dst list time:  7.534027099609375e-05
time for parepare:  0.0007801055908203125
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0003020763397216797
mini_batch_src_global generation:  0.0001671314239501953
r_  generation:  0.0018930435180664062
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  0.00020360946655273438
r_  generation:  0.0013155937194824219
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.00025582313537597656
mini_batch_src_global generation:  0.0003237724304199219
r_  generation:  0.0030975341796875
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  0.00030112266540527344
r_  generation:  0.002560138702392578
----------------------check_connections_block total spend ----------------------------- 0.014337539672851562
generate_one_block  0.00402379035949707
generate_one_block  0.002471446990966797
generate_one_block  0.004773378372192383
generate_one_block  0.004064798355102539
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002133607864379883
gen group dst list time:  0.0002377033233642578
time for parepare:  0.00164031982421875
local_output_nid generation:  0.000186920166015625
local_in_edges_tensor generation:  0.0007481575012207031
mini_batch_src_global generation:  0.0009887218475341797
r_  generation:  0.007953166961669922
local_output_nid generation:  0.00019550323486328125
local_in_edges_tensor generation:  0.0004649162292480469
mini_batch_src_global generation:  0.0010142326354980469
r_  generation:  0.007380962371826172
local_output_nid generation:  0.0003018379211425781
local_in_edges_tensor generation:  0.0006594657897949219
mini_batch_src_global generation:  0.0011448860168457031
r_  generation:  0.012320756912231445
local_output_nid generation:  0.00035452842712402344
local_in_edges_tensor generation:  0.0006930828094482422
mini_batch_src_global generation:  0.0010726451873779297
r_  generation:  0.011899948120117188
----------------------check_connections_block total spend ----------------------------- 0.05886530876159668
generate_one_block  0.011520862579345703
generate_one_block  0.010501384735107422
generate_one_block  0.016107797622680664
generate_one_block  0.017203330993652344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018241405487060547
gen group dst list time:  0.0008647441864013672
time for parepare:  0.0018265247344970703
local_output_nid generation:  0.0007002353668212891
local_in_edges_tensor generation:  0.0015788078308105469
mini_batch_src_global generation:  0.0017006397247314453
r_  generation:  0.017377614974975586
local_output_nid generation:  0.0008521080017089844
local_in_edges_tensor generation:  0.001577615737915039
mini_batch_src_global generation:  0.002285480499267578
r_  generation:  0.019835710525512695
local_output_nid generation:  0.0012018680572509766
local_in_edges_tensor generation:  0.0019812583923339844
mini_batch_src_global generation:  0.001978158950805664
r_  generation:  0.023078441619873047
local_output_nid generation:  0.0011692047119140625
local_in_edges_tensor generation:  0.0016703605651855469
mini_batch_src_global generation:  0.0020897388458251953
r_  generation:  0.022803783416748047
----------------------check_connections_block total spend ----------------------------- 0.12234020233154297
generate_one_block  0.021476030349731445
generate_one_block  0.02730870246887207
generate_one_block  0.029122114181518555
generate_one_block  0.028768539428710938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017752647399902344
gen group dst list time:  0.0013990402221679688
time for parepare:  0.0017309188842773438
local_output_nid generation:  0.0013048648834228516
local_in_edges_tensor generation:  0.0022881031036376953
mini_batch_src_global generation:  0.002032041549682617
r_  generation:  0.023966312408447266
local_output_nid generation:  0.0014064311981201172
local_in_edges_tensor generation:  0.00226593017578125
mini_batch_src_global generation:  0.002572774887084961
r_  generation:  0.025076866149902344
local_output_nid generation:  0.001600027084350586
local_in_edges_tensor generation:  0.0027790069580078125
mini_batch_src_global generation:  0.002129077911376953
r_  generation:  0.02640247344970703
local_output_nid generation:  0.0017075538635253906
local_in_edges_tensor generation:  0.0026073455810546875
mini_batch_src_global generation:  0.0021257400512695312
r_  generation:  0.026786088943481445
----------------------check_connections_block total spend ----------------------------- 0.15044903755187988
generate_one_block  0.028456687927246094
generate_one_block  0.03180193901062012
generate_one_block  0.0320589542388916
generate_one_block  0.03222966194152832
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

connection checking time:  0.34891653060913086
block generation total time  0.30792236328125
average batch blocks generation time:  0.0769805908203125
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.042891502380371094  GigaBytes
Max Memory Allocated: 0.042891502380371094  GigaBytes

torch.Size([18185, 500])
torch.Size([14271, 32])
torch.Size([8449, 32])
torch.Size([2494, 32])
torch.Size([609, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8123779296875 GB
    Memory Allocated: 2.4066739082336426  GigaBytes
Max Memory Allocated: 2.4129533767700195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8143310546875 GB
    Memory Allocated: 0.05231666564941406  GigaBytes
Max Memory Allocated: 2.4129533767700195  GigaBytes

torch.Size([18757, 500])
torch.Size([15459, 32])
torch.Size([9839, 32])
torch.Size([2269, 32])
torch.Size([508, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0155029296875 GB
    Memory Allocated: 2.512845993041992  GigaBytes
Max Memory Allocated: 2.524165630340576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0155029296875 GB
    Memory Allocated: 0.053461551666259766  GigaBytes
Max Memory Allocated: 2.524165630340576  GigaBytes

torch.Size([19232, 500])
torch.Size([17362, 32])
torch.Size([12996, 32])
torch.Size([4022, 32])
torch.Size([949, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 2.6768436431884766  GigaBytes
Max Memory Allocated: 2.6768765449523926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 0.05328941345214844  GigaBytes
Max Memory Allocated: 2.676887035369873  GigaBytes

torch.Size([19160, 500])
torch.Size([17479, 32])
torch.Size([12352, 32])
torch.Size([4189, 32])
torch.Size([826, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 2.671424388885498  GigaBytes
Max Memory Allocated: 2.676887035369873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017650365829467773 |0.08761805295944214 |0.5050390362739563 |0.00017726421356201172 |0.4869857430458069 |0.014610528945922852 |
----------------------------------------------------------pseudo_mini_loss sum 1.7081458568572998
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  199764
Number of first layer input nodes during this epoch:  75334
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 0.07204389572143555  GigaBytes
Max Memory Allocated: 2.676887035369873  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005695819854736328
range selection method range initialization spend 6.747245788574219e-05
time for parepare:  6.198883056640625e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.1484832763671875e-05
----------------------check_connections_block total spend ----------------------------- 0.0011408329010009766
generate_one_block  0.0012845993041992188
generate_one_block  0.0011570453643798828
generate_one_block  0.0011072158813476562
generate_one_block  0.001295328140258789
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005846023559570312
gen group dst list time:  4.0531158447265625e-05
time for parepare:  0.0003223419189453125
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0002498626708984375
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.00045752525329589844
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00024199485778808594
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0004582405090332031
----------------------check_connections_block total spend ----------------------------- 0.003195047378540039
generate_one_block  0.0014548301696777344
generate_one_block  0.0017435550689697266
generate_one_block  0.0014913082122802734
generate_one_block  0.0018241405487060547
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010454654693603516
gen group dst list time:  9.107589721679688e-05
time for parepare:  0.0008871555328369141
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.000347137451171875
mini_batch_src_global generation:  0.0001900196075439453
r_  generation:  0.0014271736145019531
local_output_nid generation:  9.393692016601562e-05
local_in_edges_tensor generation:  0.00025081634521484375
mini_batch_src_global generation:  0.0004220008850097656
r_  generation:  0.003133535385131836
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  0.00019979476928710938
r_  generation:  0.0014684200286865234
local_output_nid generation:  0.00011348724365234375
local_in_edges_tensor generation:  0.00026988983154296875
mini_batch_src_global generation:  0.00028014183044433594
r_  generation:  0.003088712692260742
----------------------check_connections_block total spend ----------------------------- 0.014979362487792969
generate_one_block  0.0032434463500976562
generate_one_block  0.005320072174072266
generate_one_block  0.0027513504028320312
generate_one_block  0.004834651947021484
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020618438720703125
gen group dst list time:  0.00025844573974609375
time for parepare:  0.001466989517211914
local_output_nid generation:  0.00026488304138183594
local_in_edges_tensor generation:  0.0009717941284179688
mini_batch_src_global generation:  0.0008859634399414062
r_  generation:  0.007906913757324219
local_output_nid generation:  0.0003731250762939453
local_in_edges_tensor generation:  0.0007045269012451172
mini_batch_src_global generation:  0.001336812973022461
r_  generation:  0.01288914680480957
local_output_nid generation:  0.00023365020751953125
local_in_edges_tensor generation:  0.000545501708984375
mini_batch_src_global generation:  0.0008711814880371094
r_  generation:  0.00696253776550293
local_output_nid generation: Using backend: pytorch
 0.0003597736358642578
local_in_edges_tensor generation:  0.0006055831909179688
mini_batch_src_global generation:  0.0010259151458740234
r_  generation:  0.011711359024047852
----------------------check_connections_block total spend ----------------------------- 0.05882453918457031
generate_one_block  0.01306295394897461
generate_one_block  0.017426729202270508
generate_one_block  0.012024164199829102
generate_one_block  0.017291545867919922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001744985580444336
gen group dst list time:  0.0007886886596679688
time for parepare:  0.0016560554504394531
local_output_nid generation:  0.0009562969207763672
local_in_edges_tensor generation:  0.0019223690032958984
mini_batch_src_global generation:  0.001771688461303711
r_  generation:  0.019855260848999023
local_output_nid generation:  0.0011603832244873047
local_in_edges_tensor generation:  0.002004861831665039
mini_batch_src_global generation:  0.002690553665161133
r_  generation:  0.022916555404663086
local_output_nid generation:  0.0010268688201904297
local_in_edges_tensor generation:  0.001216888427734375
mini_batch_src_global generation:  0.0018379688262939453
r_  generation:  0.01862788200378418
local_output_nid generation:  0.0013306140899658203
local_in_edges_tensor generation:  0.0016143321990966797
mini_batch_src_global generation:  0.0018944740295410156
r_  generation:  0.02196645736694336
----------------------check_connections_block total spend ----------------------------- 0.12380123138427734
generate_one_block  0.026796579360961914
generate_one_block  0.03152608871459961
generate_one_block  0.026062726974487305
generate_one_block  0.029484033584594727
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020647048950195312
gen group dst list time:  0.00151824951171875
time for parepare:  0.0017704963684082031
local_output_nid generation:  0.001531839370727539
local_in_edges_tensor generation:  0.002768278121948242
mini_batch_src_global generation:  0.002038240432739258
r_  generation:  0.02584695816040039
local_output_nid generation:  0.001712799072265625
local_in_edges_tensor generation:  0.0028908252716064453
mini_batch_src_global generation:  0.002870798110961914
r_  generation:  0.026403427124023438
local_output_nid generation:  0.0016770362854003906
local_in_edges_tensor generation:  0.0020911693572998047
mini_batch_src_global generation:  0.0020415782928466797
r_  generation:  0.024759769439697266
local_output_nid generation:  0.0017223358154296875
local_in_edges_tensor generation:  0.0022411346435546875
mini_batch_src_global generation:  0.0024662017822265625
r_  generation:  0.025813817977905273
----------------------check_connections_block total spend ----------------------------- 0.15244603157043457
generate_one_block  0.03316688537597656
generate_one_block  0.03520512580871582
generate_one_block  0.03276324272155762
generate_one_block  0.03383922576904297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 0.07204389572143555  GigaBytes
Max Memory Allocated: 2.676887035369873  GigaBytes

connection checking time:  0.35324621200561523
block generation total time  0.3313126564025879
average batch blocks generation time:  0.08282816410064697
block dataloader generation time/epoch 0.7799952030181885
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 0.06864118576049805  GigaBytes
Max Memory Allocated: 2.676887035369873  GigaBytes

torch.Size([18637, 500])
torch.Size([15952, 32])
torch.Size([9502, 32])
torch.Size([2628, 32])
torch.Size([521, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 2.536128044128418  GigaBytes
Max Memory Allocated: 2.676887035369873  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 0.06944942474365234  GigaBytes
Max Memory Allocated: 2.676887035369873  GigaBytes

torch.Size([19174, 500])
torch.Size([17283, 32])
torch.Size([12540, 32])
torch.Size([4193, 32])
torch.Size([852, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 2.686563014984131  GigaBytes
Max Memory Allocated: 2.686598777770996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 0.06859540939331055  GigaBytes
Max Memory Allocated: 2.6866064071655273  GigaBytes

torch.Size([18441, 500])
torch.Size([14736, 32])
torch.Size([8714, 32])
torch.Size([2163, 32])
torch.Size([463, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 2.4682250022888184  GigaBytes
Max Memory Allocated: 2.6866064071655273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 0.0691385269165039  GigaBytes
Max Memory Allocated: 2.6866064071655273  GigaBytes

torch.Size([19040, 500])
torch.Size([16528, 32])
torch.Size([11755, 32])
torch.Size([3901, 32])
torch.Size([1043, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 2.629688262939453  GigaBytes
Max Memory Allocated: 2.6866064071655273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015483319759368896 |0.002894103527069092 |0.3583395481109619 |0.00014036893844604492 |0.49017471075057983 |0.01072835922241211 |
----------------------------------------------------------pseudo_mini_loss sum 1.3833613395690918
Total (block generation + training)time/epoch 4.273409605026245
Training time/epoch 3.493014097213745
Training time without block to device /epoch 3.4814376831054688
Training time without total dataloading part /epoch 3.4053468704223633
load block tensor time/epoch 0.061933279037475586
block to device time/epoch 0.011576414108276367
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  198422
Number of first layer input nodes during this epoch:  75292
