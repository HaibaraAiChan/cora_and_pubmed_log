main start at this time 1648534325.6040409
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0028536319732666016
range selection method range initialization spend 8.893013000488281e-05
time for parepare:  4.57763671875e-05
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0011796951293945312
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  7.891654968261719e-05
----------------------check_connections_block total spend ----------------------------- 0.0018613338470458984
generate_one_block  0.001247406005859375
generate_one_block  0.0011897087097167969
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0015494823455810547
gen group dst list time:  2.4080276489257812e-05
time for parepare:  0.0002300739288330078
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0004584789276123047
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.0007925033569335938
----------------------check_connections_block total spend ----------------------------- 0.002415895462036133
generate_one_block  0.0017323493957519531
generate_one_block  0.002091646194458008
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010902881622314453
gen group dst list time:  6.151199340820312e-05
time for parepare:  0.000690460205078125
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.00035190582275390625
mini_batch_src_global generation:  0.0002760887145996094
r_  generation:  0.0029714107513427734
local_output_nid generation:  0.00011801719665527344
local_in_edges_tensor generation:  0.00036525726318359375
mini_batch_src_global generation:  0.0006270408630371094
r_  generation:  0.004897117614746094
----------------------check_connections_block total spend ----------------------------- 0.012562274932861328
generate_one_block  0.005753755569458008
generate_one_block  0.00724029541015625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002094268798828125
gen group dst list time:  0.00018596649169921875
time for parepare:  0.0014317035675048828
local_output_nid generation:  0.0002849102020263672
local_in_edges_tensor generation:  0.0009584426879882812
mini_batch_src_global generation:  0.0012691020965576172
r_  generation:  0.01182413101196289
local_output_nid generation:  0.000469207763671875
local_in_edges_tensor generation:  0.001119852066040039
mini_batch_src_global generation:  0.00180816650390625
r_  generation:  0.015552997589111328
----------------------check_connections_block total spend ----------------------------- 0.041879892349243164
generate_one_block  0.016916751861572266
generate_one_block  0.021642446517944336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018453598022460938
gen group dst list time:  0.0004761219024658203
time for parepare:  0.0015909671783447266
local_output_nid generation:  0.0008485317230224609
local_in_edges_tensor generation:  0.0018241405487060547
mini_batch_src_global generation:  0.002035379409790039
r_  generation:  0.021352291107177734
local_output_nid generation:  0.0011153221130371094
local_in_edges_tensor generation:  0.0025844573974609375
mini_batch_src_global generation:  0.0027816295623779297
r_  generation:  0.024416208267211914
----------------------check_connections_block total spend ----------------------------- 0.06904339790344238
generate_one_block  0.02725505828857422
generate_one_block  0.030707120895385742
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018625259399414062
gen group dst list time:  0.0007112026214599609
time for parepare:  0.001627206802368164
local_output_nid generation:  0.0012485980987548828
local_in_edges_tensor generation:  0.002534151077270508
mini_batch_src_global generation:  0.0020897388458251953
r_  generation:  0.024945497512817383
local_output_nid generation:  0.0013790130615234375
local_in_edges_tensor generation:  0.0025331974029541016
mini_batch_src_global generation:  0.0026366710662841797
r_  generation:  0.02621912956237793
----------------------check_connections_block total spend ----------------------------- 0.07652783393859863
generate_one_block  0.030580997467041016
generate_one_block  0.03328680992126465
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

connection checking time:  0.20242929458618164
block generation total time  0.17720723152160645
average batch blocks generation time:  0.08860361576080322
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.04484987258911133  GigaBytes
Max Memory Allocated: 0.04484987258911133  GigaBytes

torch.Size([19083, 500])
torch.Size([16889, 32])
torch.Size([12428, 32])
torch.Size([4176, 32])
torch.Size([1108, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0487060546875 GB
    Memory Allocated: 2.638767719268799  GigaBytes
Max Memory Allocated: 2.638801097869873  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0506591796875 GB
    Memory Allocated: 0.05395650863647461  GigaBytes
Max Memory Allocated: 2.6388111114501953  GigaBytes

torch.Size([19385, 500])
torch.Size([18451, 32])
torch.Size([15274, 32])
torch.Size([6569, 32])
torch.Size([1703, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.7840676307678223  GigaBytes
Max Memory Allocated: 2.784116268157959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024726152420043945 |0.1758660078048706 |0.6669050455093384 |0.00017726421356201172 |0.5108379125595093 |0.011191606521606445 |
----------------------------------------------------------pseudo_mini_loss sum 2.022822141647339
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  115423
Number of first layer input nodes during this epoch:  38468
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.07325172424316406  GigaBytes
Max Memory Allocated: 2.784116268157959  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005249977111816406
range selection method range initialization spend 5.1975250244140625e-05
time for parepare:  5.435943603515625e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  9.131431579589844e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00011658668518066406Using backend: pytorch

mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  6.413459777832031e-05
----------------------check_connections_block total spend ----------------------------- 0.000804901123046875
generate_one_block  0.0012395381927490234
generate_one_block  0.0011522769927978516
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005364418029785156
gen group dst list time:  2.765655517578125e-05
time for parepare:  0.00026988983154296875
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00021457672119140625
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0006084442138671875
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.0006687641143798828
----------------------check_connections_block total spend ----------------------------- 0.002505064010620117
generate_one_block  0.002001047134399414
generate_one_block  0.002057790756225586
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001018524169921875
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.0007252693176269531
local_output_nid generation:  0.0001285076141357422
local_in_edges_tensor generation:  0.00040411949157714844
mini_batch_src_global generation:  0.0004050731658935547
r_  generation:  0.004098176956176758
local_output_nid generation:  0.00014138221740722656
local_in_edges_tensor generation:  0.0003266334533691406
mini_batch_src_global generation:  0.0004410743713378906
r_  generation:  0.004086017608642578
----------------------check_connections_block total spend ----------------------------- 0.012809038162231445
generate_one_block  0.0075991153717041016
generate_one_block  0.0067598819732666016
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020973682403564453
gen group dst list time:  0.00020074844360351562
time for parepare:  0.0013086795806884766
local_output_nid generation:  0.00040149688720703125
local_in_edges_tensor generation:  0.0010819435119628906
mini_batch_src_global generation:  0.0013163089752197266
r_  generation:  0.01450800895690918
local_output_nid generation:  0.0003979206085205078
local_in_edges_tensor generation:  0.0007817745208740234
mini_batch_src_global generation:  0.0017986297607421875
r_  generation:  0.014880895614624023
----------------------check_connections_block total spend ----------------------------- 0.043556928634643555
generate_one_block  0.022143840789794922
generate_one_block  0.020526409149169922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001851797103881836
gen group dst list time:  0.0004999637603759766
time for parepare:  0.001416921615600586
local_output_nid generation:  0.0010216236114501953
local_in_edges_tensor generation:  0.0020782947540283203
mini_batch_src_global generation:  0.0020096302032470703
r_  generation:  0.023459196090698242
local_output_nid generation:  0.0011091232299804688
local_in_edges_tensor generation:  0.002414226531982422
mini_batch_src_global generation:  0.0026345252990722656
r_  generation:  0.02433156967163086
----------------------check_connections_block total spend ----------------------------- 0.07139945030212402
generate_one_block  0.032240867614746094
generate_one_block  0.03205394744873047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022003650665283203
gen group dst list time:  0.0008733272552490234
time for parepare:  0.0016529560089111328
local_output_nid generation:  0.0013608932495117188
local_in_edges_tensor generation:  0.0026552677154541016
mini_batch_src_global generation:  0.0019466876983642578
r_  generation:  0.027343273162841797
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0024476051330566406
mini_batch_src_global generation:  0.0026252269744873047
r_  generation:  0.02606344223022461
----------------------check_connections_block total spend ----------------------------- 0.07917308807373047
generate_one_block  0.0346522331237793
generate_one_block  0.03603649139404297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.07325172424316406  GigaBytes
Max Memory Allocated: 2.784116268157959  GigaBytes

connection checking time:  0.2094435691833496
block generation total time  0.19607162475585938
average batch blocks generation time:  0.09803581237792969
block dataloader generation time/epoch 0.4664146900177002
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.06987810134887695  GigaBytes
Max Memory Allocated: 2.784116268157959  GigaBytes

torch.Size([19337, 500])
torch.Size([18022, 32])
torch.Size([14083, 32])
torch.Size([5626, 32])
torch.Size([1304, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.761155128479004  GigaBytes
Max Memory Allocated: 2.784116268157959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.06964349746704102  GigaBytes
Max Memory Allocated: 2.784116268157959  GigaBytes

torch.Size([19231, 500])
torch.Size([17416, 32])
torch.Size([13625, 32])
torch.Size([5115, 32])
torch.Size([1468, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.7273240089416504  GigaBytes
Max Memory Allocated: 2.784116268157959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023974180221557617 |0.0036312341690063477 |0.38973307609558105 |0.00019824504852294922 |0.5300796031951904 |0.011561155319213867 |
----------------------------------------------------------pseudo_mini_loss sum 1.6953465938568115
Total (block generation + training)time/epoch 2.3946168422698975
Training time/epoch 1.9276249408721924
Training time without block to device /epoch 1.9203624725341797
Training time without total dataloading part /epoch 1.8515830039978027
load block tensor time/epoch 0.047948360443115234
block to device time/epoch 0.007262468338012695
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  115582
Number of first layer input nodes during this epoch:  38568
