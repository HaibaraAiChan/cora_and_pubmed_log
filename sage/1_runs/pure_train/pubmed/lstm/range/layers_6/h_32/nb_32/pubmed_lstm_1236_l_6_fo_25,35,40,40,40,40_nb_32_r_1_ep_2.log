main start at this time 1648534383.4182754
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0021724700927734375
range selection method range initialization spend 8.392333984375e-05
time for parepare:  4.6253204345703125e-05
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0011565685272216797
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.003847360610961914
generate_one_block  0.0012545585632324219
generate_one_block  0.0009891986846923828
generate_one_block  0.0010349750518798828
generate_one_block  0.0009801387786865234
generate_one_block  0.000978231430053711
generate_one_block  0.000985860824584961
generate_one_block  0.0009775161743164062
generate_one_block  0.0009930133819580078
generate_one_block  0.0009794235229492188
generate_one_block  0.0009996891021728516
generate_one_block  0.0009710788726806641
generate_one_block  0.0009348392486572266
generate_one_block  0.0009315013885498047
generate_one_block  0.0009655952453613281
generate_one_block  0.0009365081787109375
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0014064311981201172
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.00027370452880859375
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0001850128173828125
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  6.031990051269531e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  8.487701416015625e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0001239776611328125
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00020241737365722656
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  6.079673767089844e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00018930435180664062
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00010037422180175781
----------------------check_connections_block total spend ----------------------------- 0.004457235336303711
generate_one_block  0.0012750625610351562
generate_one_block  0.0010721683502197266
generate_one_block  0.0010101795196533203
generate_one_block  0.0010976791381835938
generate_one_block  0.0010707378387451172
generate_one_block  0.0010592937469482422
generate_one_block  0.0011107921600341797
generate_one_block  0.0010666847229003906
generate_one_block  0.0011548995971679688
generate_one_block  0.0013089179992675781
generate_one_block  0.0010724067687988281
generate_one_block  0.0010080337524414062
generate_one_block  0.001050710678100586
generate_one_block  0.001220703125
generate_one_block  0.0010790824890136719
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011820793151855469
gen group dst list time:  0.00012087821960449219
time for parepare:  0.0007147789001464844
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00032711029052734375
mini_batch_src_global generation:  0.00014591217041015625
r_  generation:  0.0013048648834228516
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0002865791320800781
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001976490020751953
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00030112266540527344
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0003972053527832031
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00034308433532714844
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00046563148498535156
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0001850128173828125
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0008192062377929688
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  0.00017189979553222656
r_  generation:  0.0015094280242919922
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0003731250762939453
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0004010200500488281
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0005180835723876953
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  0.00010371208190917969
r_  generation:  0.0010194778442382812
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.0008246898651123047
----------------------check_connections_block total spend ----------------------------- 0.016127347946166992
generate_one_block  0.0028655529022216797
generate_one_block  0.0013332366943359375
generate_one_block  0.0012028217315673828
generate_one_block  0.0012385845184326172
generate_one_block  0.0014481544494628906
generate_one_block  0.001355886459350586
generate_one_block  0.001463174819946289
generate_one_block  0.001134634017944336
generate_one_block  0.002222776412963867
generate_one_block  0.0027399063110351562
generate_one_block  0.001354217529296875
generate_one_block  0.0014424324035644531
generate_one_block  0.0015451908111572266
generate_one_block  0.002221822738647461
generate_one_block  0.0022284984588623047
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002148866653442383
gen group dst list time:  0.0003123283386230469
time for parepare:  0.001641988754272461
local_output_nid generation:  0.00011777877807617188
local_in_edges_tensor generation:  0.0006303787231445312
mini_batch_src_global generation:  0.0006861686706542969
r_  generation:  0.005543708801269531
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.00033473968505859375
r_  generation:  0.0019719600677490234
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  0.0001666545867919922
r_  generation:  0.0014834403991699219
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  0.00015878677368164062
r_  generation:  0.0015594959259033203
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.00025081634521484375
mini_batch_src_global generation:  0.0002827644348144531
r_  generation:  0.003170490264892578
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.0017664432525634766
local_output_nid generation:  6.628036499023438e-05
local_in_edges_tensor generation:  0.00021648406982421875
mini_batch_src_global generation:  0.0002512931823730469
r_  generation:  0.0025634765625
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0006299018859863281
local_output_nid generation:  0.00012826919555664062
local_in_edges_tensor generation:  0.0003306865692138672
mini_batch_src_global generation:  0.0004277229309082031
r_  generation:  0.004781484603881836
local_output_nid generation:  0.00014328956604003906
local_in_edges_tensor generation:  0.0003554821014404297
mini_batch_src_global generation:  0.0007779598236083984
r_  generation:  0.0057201385498046875
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  0.0002846717834472656
r_  generation:  0.0018160343170166016
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.0002288818359375
mini_batch_src_global generation:  0.00023508071899414062
r_  generation:  0.0024824142456054688
local_output_nid generation:  8.320808410644531e-05
local_in_edges_tensor generation:  0.00024056434631347656
mini_batch_src_global generation:  0.0003352165222167969
r_  generation:  0.0034177303314208984
local_output_nid generation:  0.00013589859008789062
local_in_edges_tensor generation:  0.0003154277801513672
mini_batch_src_global generation:  0.0003705024719238281
r_  generation:  0.003921985626220703
local_output_nid generation:  0.00015020370483398438
local_in_edges_tensor generation:  0.0003459453582763672
mini_batch_src_global generation:  0.0005059242248535156
r_  generation:  0.005070686340332031
----------------------check_connections_block total spend ----------------------------- 0.07019305229187012
generate_one_block  0.008357763290405273
generate_one_block  0.0035157203674316406
generate_one_block  0.003035306930541992
generate_one_block  0.0029320716857910156
generate_one_block  0.0050487518310546875
generate_one_block  0.003322124481201172
generate_one_block  0.004583597183227539
generate_one_block  0.0014889240264892578
generate_one_block  0.008558988571166992
generate_one_block  0.008411169052124023
generate_one_block  0.0032415390014648438
generate_one_block  0.004253864288330078
generate_one_block  0.005480527877807617
generate_one_block  0.006400585174560547
generate_one_block  0.00790858268737793
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0024280548095703125
gen group dst list time:  0.0015320777893066406
time for parepare:  0.0017948150634765625
local_output_nid generation:  0.0005042552947998047
local_in_edges_tensor generation:  0.0013651847839355469
mini_batch_src_global generation:  0.001293182373046875
r_  generation:  0.01229095458984375
local_output_nid generation:  0.00021839141845703125
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.0009446144104003906
r_  generation:  0.0069162845611572266
local_output_nid generation:  0.0002951622009277344
local_in_edges_tensor generation:  0.0005834102630615234
mini_batch_src_global generation:  0.0006363391876220703
r_  generation:  0.006941318511962891
local_output_nid generation:  0.0002970695495605469
local_in_edges_tensor generation:  0.0005407333374023438
mini_batch_src_global generation:  0.0006227493286132812
r_  generation:  0.006803274154663086
local_output_nid generation:  0.0003292560577392578
local_in_edges_tensor generation:  0.0007455348968505859
mini_batch_src_global generation:  0.0010502338409423828
r_  generation:  0.010127782821655273
local_output_nid generation:  0.0003070831298828125
local_in_edges_tensor generation:  0.0005404949188232422
mini_batch_src_global generation:  0.0006759166717529297
r_  generation:  0.006458282470703125
local_output_nid generation:  0.0004162788391113281
local_in_edges_tensor generation:  0.0008141994476318359
mini_batch_src_global generation:  0.00077056884765625
r_  generation:  0.010279178619384766
local_output_nid generation:  9.608268737792969e-05
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  0.00037598609924316406
r_  generation:  0.001988649368286133
local_output_nid generation:  0.0008068084716796875
local_in_edges_tensor generation:  0.0012099742889404297
mini_batch_src_global generation:  0.0010914802551269531
r_  generation:  0.016519784927368164
local_output_nid generation:  0.0005631446838378906
local_in_edges_tensor generation:  0.0010111331939697266
mini_batch_src_global generation:  0.001659393310546875
r_  generation:  0.013809919357299805
local_output_nid generation:  0.00032258033752441406
local_in_edges_tensor generation:  0.0005142688751220703
mini_batch_src_global generation:  0.0008492469787597656
r_  generation:  0.0076563358306884766
local_output_nid generation:  0.0005018711090087891
local_in_edges_tensor generation:  0.002023458480834961
mini_batch_src_global generation:  0.0009481906890869141
r_  generation:  0.010255575180053711
local_output_nid generation:  0.0003581047058105469
local_in_edges_tensor generation:  0.0006494522094726562
mini_batch_src_global generation:  0.0008032321929931641
r_  generation:  0.009691476821899414
local_output_nid generation:  0.0004935264587402344
local_in_edges_tensor generation:  0.000911712646484375
mini_batch_src_global generation:  0.0008323192596435547
r_  generation:  0.01137089729309082
local_output_nid generation:  0.0006384849548339844
local_in_edges_tensor generation:  0.0011942386627197266
mini_batch_src_global generation:  0.0014717578887939453
r_  generation:  0.016282081604003906
----------------------check_connections_block total spend ----------------------------- 0.219193696975708
generate_one_block  0.01657867431640625
generate_one_block  0.01050877571105957
generate_one_block  0.010824918746948242
generate_one_block  0.009842157363891602
generate_one_block  0.01407623291015625
generate_one_block  0.008903026580810547
generate_one_block  0.014725446701049805
generate_one_block  0.0042917728424072266
generate_one_block  0.020696401596069336
generate_one_block  0.01906418800354004
generate_one_block  0.011464834213256836
generate_one_block  0.013093948364257812
generate_one_block  0.01394963264465332
generate_one_block  0.015612602233886719
generate_one_block  0.021665096282958984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020647048950195312
gen group dst list time:  0.0039958953857421875
time for parepare:  0.0017762184143066406
local_output_nid generation:  0.0009920597076416016
local_in_edges_tensor generation:  0.002064943313598633
mini_batch_src_global generation:  0.0018150806427001953
r_  generation:  0.019376516342163086
local_output_nid generation:  0.0006694793701171875
local_in_edges_tensor generation:  0.0010962486267089844
mini_batch_src_global generation:  0.0016748905181884766
r_  generation:  0.013904094696044922
local_output_nid generation:  0.0008423328399658203
local_in_edges_tensor generation:  0.0015056133270263672
mini_batch_src_global generation:  0.0014176368713378906
r_  generation:  0.01767253875732422
local_output_nid generation:  0.0009467601776123047
local_in_edges_tensor generation:  0.001421213150024414
mini_batch_src_global generation:  0.0018486976623535156
r_  generation:  0.01804971694946289
local_output_nid generation:  0.0009531974792480469
local_in_edges_tensor generation:  0.0012907981872558594
mini_batch_src_global generation:  0.0014848709106445312
r_  generation:  0.018173694610595703
local_output_nid generation:  0.0007824897766113281
local_in_edges_tensor generation:  0.0009984970092773438
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.013676881790161133
local_output_nid generation:  0.001096963882446289
local_in_edges_tensor generation:  0.0014188289642333984
mini_batch_src_global generation:  0.0016069412231445312
r_  generation:  0.020159006118774414
local_output_nid generation:  0.0003578662872314453
local_in_edges_tensor generation:  0.0005347728729248047
mini_batch_src_global generation:  0.0008978843688964844
r_  generation:  0.007042646408081055
local_output_nid generation:  0.0012831687927246094
local_in_edges_tensor generation:  0.00174713134765625
mini_batch_src_global generation:  0.0017173290252685547
r_  generation:  0.02363753318786621
local_output_nid generation:  0.0010762214660644531
local_in_edges_tensor generation:  0.0017578601837158203
mini_batch_src_global generation:  0.0020956993103027344
r_  generation:  0.020975828170776367
local_output_nid generation:  0.0008008480072021484
local_in_edges_tensor generation:  0.0013132095336914062
mini_batch_src_global generation:  0.0015506744384765625
r_  generation:  0.017348766326904297
local_output_nid generation:  0.0010843276977539062
local_in_edges_tensor generation:  0.0016715526580810547
mini_batch_src_global generation:  0.0016558170318603516
r_  generation:  0.020211219787597656
local_output_nid generation:  0.0007488727569580078
local_in_edges_tensor generation:  0.001027822494506836
mini_batch_src_global generation:  0.0013833045959472656
r_  generation:  0.016020774841308594
local_output_nid generation:  0.0011484622955322266
local_in_edges_tensor generation:  0.0016527175903320312
mini_batch_src_global generation:  0.0017390251159667969
r_  generation:  0.020288944244384766
local_output_nid generation:  0.0013425350189208984
local_in_edges_tensor generation:  0.001911163330078125
mini_batch_src_global generation:  0.0020494461059570312
r_  generation:  0.023093461990356445
----------------------check_connections_block total spend ----------------------------- 0.39232730865478516
generate_one_block  0.024685144424438477
generate_one_block  0.01818370819091797
generate_one_block  0.02375626564025879
generate_one_block  0.02454853057861328
generate_one_block  0.023001909255981445
generate_one_block  0.017524003982543945
generate_one_block  0.02628779411315918
generate_one_block  0.010869264602661133
generate_one_block  0.02902960777282715
generate_one_block  0.02698969841003418
generate_one_block  0.02549123764038086
generate_one_block  0.02614426612854004
generate_one_block  0.020937442779541016
generate_one_block  0.02577376365661621
generate_one_block  0.0296628475189209
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007786273956298828  GigaBytes
Max Memory Allocated: 0.007786273956298828  GigaBytes

connection checking time:  0.702298641204834
block generation total time  0.6771769523620605
average batch blocks generation time:  0.0451451301574707
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1326904296875 GB
    Memory Allocated: 0.04002094268798828  GigaBytes
Max Memory Allocated: 0.04002094268798828  GigaBytes

torch.Size([16478, 500])
torch.Size([10692, 32])
torch.Size([5631, 32])
torch.Size([1636, 32])
torch.Size([350, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4530029296875 GB
    Memory Allocated: 2.06367826461792  GigaBytes
Max Memory Allocated: 2.087380886077881  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4530029296875 GB
    Memory Allocated: 0.03778696060180664  GigaBytes
Max Memory Allocated: 2.087380886077881  GigaBytes

torch.Size([11612, 500])
torch.Size([7052, 32])
torch.Size([2305, 32])
torch.Size([525, 32])
torch.Size([82, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4530029296875 GB
    Memory Allocated: 1.433095932006836  GigaBytes
Max Memory Allocated: 2.087380886077881  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4530029296875 GB
    Memory Allocated: 0.045816898345947266  GigaBytes
Max Memory Allocated: 2.087380886077881  GigaBytes

torch.Size([15877, 500])
torch.Size([8607, 32])
torch.Size([2906, 32])
torch.Size([391, 32])
torch.Size([79, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4530029296875 GB
    Memory Allocated: 1.8358564376831055  GigaBytes
Max Memory Allocated: 2.087380886077881  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4530029296875 GB
    Memory Allocated: 0.04706382751464844  GigaBytes
Max Memory Allocated: 2.087380886077881  GigaBytes

torch.Size([16549, 500])
torch.Size([8759, 32])
torch.Size([3243, 32])
torch.Size([493, 32])
torch.Size([148, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5643310546875 GB
    Memory Allocated: 1.8477668762207031  GigaBytes
Max Memory Allocated: 2.087380886077881  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5643310546875 GB
    Memory Allocated: 0.04442262649536133  GigaBytes
Max Memory Allocated: 2.087380886077881  GigaBytes

torch.Size([15062, 500])
torch.Size([9459, 32])
torch.Size([3793, 32])
torch.Size([904, 32])
torch.Size([112, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5643310546875 GB
    Memory Allocated: 1.8632454872131348  GigaBytes
Max Memory Allocated: 2.087380886077881  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5643310546875 GB
    Memory Allocated: 0.042340755462646484  GigaBytes
Max Memory Allocated: 2.087380886077881  GigaBytes

torch.Size([14089, 500])
torch.Size([7247, 32])
torch.Size([3327, 32])
torch.Size([546, 32])
torch.Size([144, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5643310546875 GB
    Memory Allocated: 1.3667798042297363  GigaBytes
Max Memory Allocated: 2.087380886077881  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5643310546875 GB
    Memory Allocated: 0.0482635498046875  GigaBytes
Max Memory Allocated: 2.087380886077881  GigaBytes

torch.Size([17105, 500])
torch.Size([10737, 32])
torch.Size([4460, 32])
torch.Size([756, 32])
torch.Size([189, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6893310546875 GB
    Memory Allocated: 2.0655369758605957  GigaBytes
Max Memory Allocated: 2.1343488693237305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6893310546875 GB
    Memory Allocated: 0.03399467468261719  GigaBytes
Max Memory Allocated: 2.1343488693237305  GigaBytes

torch.Size([9762, 500])
torch.Size([3254, 32])
torch.Size([788, 32])
torch.Size([300, 32])
torch.Size([85, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6893310546875 GB
    Memory Allocated: 0.7711114883422852  GigaBytes
Max Memory Allocated: 2.1343488693237305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6893310546875 GB
    Memory Allocated: 0.05125570297241211  GigaBytes
Max Memory Allocated: 2.1343488693237305  GigaBytes

torch.Size([18564, 500])
torch.Size([14210, 32])
torch.Size([8796, 32])
torch.Size([1499, 32])
torch.Size([336, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8280029296875 GB
    Memory Allocated: 2.3885421752929688  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8280029296875 GB
    Memory Allocated: 0.0481114387512207  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([16901, 500])
torch.Size([12154, 32])
torch.Size([5991, 32])
torch.Size([1744, 32])
torch.Size([345, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8494873046875 GB
    Memory Allocated: 2.19160795211792  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8494873046875 GB
    Memory Allocated: 0.0445866584777832  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([15216, 500])
torch.Size([8525, 32])
torch.Size([2901, 32])
torch.Size([563, 32])
torch.Size([147, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8494873046875 GB
    Memory Allocated: 1.757486343383789  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8494873046875 GB
    Memory Allocated: 0.048328399658203125  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([17151, 500])
torch.Size([11161, 32])
torch.Size([4693, 32])
torch.Size([887, 32])
torch.Size([135, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8494873046875 GB
    Memory Allocated: 2.05828857421875  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8494873046875 GB
    Memory Allocated: 0.04183340072631836  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([13699, 500])
torch.Size([7935, 32])
torch.Size([3914, 32])
torch.Size([898, 32])
torch.Size([125, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8494873046875 GB
    Memory Allocated: 1.6659040451049805  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8494873046875 GB
    Memory Allocated: 0.04889869689941406  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([17427, 500])
torch.Size([12149, 32])
torch.Size([5704, 32])
torch.Size([1736, 32])
torch.Size([393, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8494873046875 GB
    Memory Allocated: 2.030545711517334  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8494873046875 GB
    Memory Allocated: 0.05023956298828125  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([18018, 500])
torch.Size([14306, 32])
torch.Size([7394, 32])
torch.Size([1775, 32])
torch.Size([245, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 2.367900848388672  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013545465469360352 |0.025114091237386067 |0.3334733327229818 |0.000141143798828125 |0.5049776077270508 |0.014780521392822266 |
----------------------------------------------------------pseudo_mini_loss sum 2.149832248687744
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  463528
Number of first layer input nodes during this epoch:  233510
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.0676565170288086  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.000904083251953125
range selection method range initialization spend 7.605552673339844e-05
time for parepare:  7.82012939453125e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.5299530029296875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.5974044799804688e-05
----------------------check_connections_block total spend ----------------------------- 0.0030727386474609375
generate_one_block  0.0012385845184326172
generate_one_block  0.0010981559753417969
generate_one_block  0.0011012554168701172
generate_one_block  0.0011124610900878906
generate_one_block  0.0010933876037597656
generate_one_block  0.0011000633239746094
generate_one_block  0.001116037368774414
generate_one_block  0.001079559326171875
generate_one_block  0.0010924339294433594
generate_one_block  0.0010716915130615234
generate_one_block  0.0010466575622558594
generate_one_block  0.0010654926300048828
generate_one_block  0.0011060237884521484
generate_one_block  0.0010166168212890625
generate_one_block  0.0009903907775878906
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007970333099365234
gen group dst list time:  9.083747863769531e-05
time for parepare:  0.0003714561462402344
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  6.127357482910156e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0001900196075439453
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  8.96453857421875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  6.127357482910156e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00021457672119140625
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00010013580322265625
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0001690387725830078
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  8.130073547363281e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00019550323486328125
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00011301040649414062
----------------------check_connections_block total spend ----------------------------- 0.005417585372924805
generate_one_block  0.0012145042419433594
generate_one_block  0.0012049674987792969
generate_one_block  0.0011975765228271484
generate_one_block  0.0013511180877685547
generate_one_block  0.0011928081512451172
generate_one_block  0.001135110855102539
generate_one_block  0.0014111995697021484
generate_one_block  0.0011343955993652344
generate_one_block  0.0018913745880126953
generate_one_block  0.0010418891906738281
generate_one_block  0.0010797977447509766
generate_one_block  0.0012264251708984375
generate_one_block  0.001074075698852539
generate_one_block  0.0012309551239013672
generate_one_block  0.0011217594146728516
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013175010681152344
gen group dst list time:  0.00015974044799804688
time for parepare:  0.0010793209075927734
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00037550926208496094
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.00022864341735839844
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0003390312194824219
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  0.00010228157043457031
r_  generation:  0.0005815029144287109
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  0.000186920166015625
r_  generation:  0.001110076904296875
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.0006830692291259766
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.00044155120849609375
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  0.00018334388732910156
r_  generation:  0.00152587890625
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.00019311904907226562
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0006678104400634766
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.00019812583923339844
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00042510032653808594
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.0001354217529296875
r_  generation:  0.0014071464538574219
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  9.894371032714844e-05
r_  generation:  0.0004754066467285156
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.0011870861053466797
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  9.369850158691406e-05
r_  generation:  0.00063323974609375
----------------------check_connections_block total spend ----------------------------- 0.019184350967407227
generate_one_block  0.0015063285827636719
generate_one_block  0.0014584064483642578
generate_one_block  0.0018105506896972656
generate_one_block  0.002393960952758789
generate_one_block  0.0019006729125976562
generate_one_block  0.0016169548034667969
generate_one_block  0.0028553009033203125
generate_one_block  0.0011904239654541016
generate_one_block  0.0018584728240966797
generate_one_block  0.0011816024780273438
generate_one_block  0.0014801025390625
generate_one_block  0.002699136734008789
generate_one_block  0.0015430450439453125
generate_one_block  0.0025632381439208984
generate_one_block  0.0016965866088867188
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021979808807373047
gen group dst list time:  0.000415802001953125
time for parepare:  0.0018596649169921875
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.0007121562957763672
mini_batch_src_global generation:  0.00022101402282714844
r_  generation:  0.0015835762023925781
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.0002636909484863281
mini_batch_src_global generation:  0.0002980232238769531
r_  generation:  0.0021262168884277344
local_output_nid generation:  0.00014400482177734375
local_in_edges_tensor generation:  0.0003528594970703125
mini_batch_src_global generation:  0.0005540847778320312
r_  generation:  0.004519939422607422
local_output_nid generation:  0.00020194053649902344
local_in_edges_tensor generation:  0.0004093647003173828
mini_batch_src_global generation:  0.0006465911865234375
r_  generation:  0.005793333053588867
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.00032973289489746094
mini_batch_src_global generation:  0.00043392181396484375
r_  generation:  0.0037190914154052734
local_output_nid generation:  9.72747802734375e-05
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  0.0003426074981689453
r_  generation:  0.0028448104858398438
local_output_nid generation:  0.00015926361083984375
local_in_edges_tensor generation:  0.0003457069396972656
mini_batch_src_global generation:  0.0004916191101074219
r_  generation:  0.004926443099975586
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  0.00020456314086914062
r_  generation:  0.0007545948028564453
local_output_nid generation:  0.00013065338134765625
local_in_edges_tensor generation:  0.0003113746643066406
mini_batch_src_global generation:  0.0003509521484375
r_  generation:  0.004125356674194336
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  0.00018358230590820312
r_  generation:  0.0006673336029052734
local_output_nid generation:  8.034706115722656e-05
local_in_edges_tensor generation:  0.0002455711364746094
mini_batch_src_global generation:  0.00021839141845703125
r_  generation:  0.002428770065307617
local_output_nid generation:  0.0001761913299560547
local_in_edges_tensor generation:  0.0003714561462402344
mini_batch_src_global generation:  0.0004911422729492188
r_  generation:  0.005155086517333984
local_output_nid generation:  8.463859558105469e-05
local_in_edges_tensor generation:  0.0002551078796386719
mini_batch_src_global generation:  0.0003306865692138672
r_  generation:  0.002275228500366211
local_output_nid generation:  0.0002193450927734375
local_in_edges_tensor generation:  0.0004215240478515625
mini_batch_src_global generation:  0.0005102157592773438
r_  generation:  0.00575709342956543
local_output_nid generation:  0.00010991096496582031
local_in_edges_tensor generation:  0.0002951622009277344
mini_batch_src_global generation:  0.0004038810729980469
r_  generation:  0.003271818161010742
----------------------check_connections_block total spend ----------------------------- 0.07761430740356445
generate_one_block  0.0037364959716796875
generate_one_block  0.0038557052612304688
generate_one_block  0.007017850875854492
generate_one_block  0.009238481521606445
generate_one_block  0.006280422210693359
generate_one_block  0.005091190338134766
generate_one_block  0.0077266693115234375
generate_one_block  0.0019910335540771484
generate_one_block  0.006935596466064453
generate_one_block  0.0018219947814941406
generate_one_block  0.00456547737121582
generate_one_block  0.008167028427124023
generate_one_block  0.004253864288330078
generate_one_block  0.009461402893066406
generate_one_block  0.0055696964263916016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0024039745330810547
gen group dst list time:  0.0017910003662109375
time for parepare:  0.001909494400024414
local_output_nid generation:  0.0004165172576904297
local_in_edges_tensor generation:  0.001436471939086914
mini_batch_src_global generation:  0.0007314682006835938
r_  generation:  0.00631403923034668
local_output_nid generation:  0.00040531158447265625
local_in_edges_tensor generation:  0.0006976127624511719
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.00901651382446289
local_output_nid generation:  0.0006415843963623047
local_in_edges_tensor generation:  0.0009324550628662109
mini_batch_src_global generation:  0.001463174819946289
r_  generation:  0.013823986053466797
local_output_nid generation:  0.0009341239929199219
local_in_edges_tensor generation:  0.0010993480682373047
mini_batch_src_global generation:  0.001260995864868164
r_  generation:  0.015089750289916992
local_output_nid generation:  0.0006744861602783203
local_in_edges_tensor generation:  0.0008618831634521484
mini_batch_src_global generation:  0.001337289810180664
r_  generation:  0.013540506362915039
local_output_nid generation:  0.0005488395690917969
local_in_edges_tensor generation:  0.0007333755493164062
mini_batch_src_global generation:  0.0011036396026611328
r_  generation:  0.011896133422851562
local_output_nid generation:  0.0005619525909423828
local_in_edges_tensor generation:  0.0007579326629638672
mini_batch_src_global generation:  0.0009167194366455078
r_  generation:  0.011258840560913086
local_output_nid generation:  0.0001842975616455078
local_in_edges_tensor generation:  0.0003752708435058594
mini_batch_src_global generation:  0.0006189346313476562
r_  generation:  0.004477024078369141
local_output_nid generation:  0.0007734298706054688
local_in_edges_tensor generation:  0.0009205341339111328
mini_batch_src_global generation:  0.0011010169982910156
r_  generation:  0.014851570129394531
local_output_nid generation:  0.00016999244689941406
local_in_edges_tensor generation:  0.0003368854522705078
mini_batch_src_global generation:  0.0005869865417480469
r_  generation:  0.0030126571655273438
local_output_nid generation:  0.0005307197570800781
local_in_edges_tensor generation:  0.0006973743438720703
mini_batch_src_global generation:  0.0009212493896484375
r_  generation:  0.011244773864746094
local_output_nid generation:  0.0006282329559326172
local_in_edges_tensor generation:  0.0007932186126708984
mini_batch_src_global generation:  0.0009620189666748047
r_  generation:  0.012061595916748047
local_output_nid generation:  0.0004558563232421875
local_in_edges_tensor generation:  0.0006265640258789062
mini_batch_src_global generation:  0.0010149478912353516
r_  generation:  0.008867979049682617
local_output_nid generation:  0.0009627342224121094
local_in_edges_tensor generation:  0.0010936260223388672
mini_batch_src_global generation:  0.0014581680297851562
r_  generation:  0.017947673797607422
local_output_nid generation:  0.0007567405700683594
local_in_edges_tensor generation:  0.0008602142333984375
mini_batch_src_global generation:  0.0011088848114013672
r_  generation:  0.011934995651245117
----------------------check_connections_block total spend ----------------------------- 0.24361133575439453
generate_one_block  0.011986255645751953
generate_one_block  0.013458013534545898
generate_one_block  0.018842458724975586
generate_one_block  0.020473480224609375
generate_one_block  0.019245386123657227
generate_one_block  0.017121076583862305
generate_one_block  0.015720605850219727
generate_one_block  0.007843255996704102
generate_one_block  0.019842147827148438
generate_one_block  0.0055768489837646484
generate_one_block  0.015961408615112305
generate_one_block  0.016891956329345703
generate_one_block  0.014435768127441406
generate_one_block  0.023775577545166016
generate_one_block  0.0163724422454834
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019788742065429688
gen group dst list time:  0.004522800445556641
time for parepare:  0.001992940902709961
local_output_nid generation:  0.0009601116180419922
local_in_edges_tensor generation:  0.0016987323760986328
mini_batch_src_global generation:  0.0012171268463134766
r_  generation:  0.014456748962402344
local_output_nid generation:  0.0011298656463623047
local_in_edges_tensor generation:  0.0018246173858642578
mini_batch_src_global generation:  0.002211332321166992
r_  generation:  0.019520998001098633
local_output_nid generation:  0.0012791156768798828
local_in_edges_tensor generation:  0.0020911693572998047
mini_batch_src_global generation:  0.0019066333770751953
r_  generation:  0.02175116539001465
local_output_nid generation:  0.0015592575073242188
local_in_edges_tensor generation:  0.0020411014556884766
mini_batch_src_global generation:  0.002206087112426758
r_  generation:  0.0229642391204834
local_output_nid generation:  0.0016646385192871094
local_in_edges_tensor generation:  0.001950979232788086
mini_batch_src_global generation:  0.0020112991333007812
r_  generation:  0.023662805557250977
local_output_nid generation:  0.0012938976287841797
local_in_edges_tensor generation:  0.001512765884399414
mini_batch_src_global generation:  0.0017981529235839844
r_  generation:  0.020845890045166016
local_output_nid generation:  0.0010771751403808594
local_in_edges_tensor generation:  0.001363992691040039
mini_batch_src_global generation:  0.0015943050384521484
r_  generation:  0.018129825592041016
local_output_nid generation:  0.0007610321044921875
local_in_edges_tensor generation:  0.001001119613647461
mini_batch_src_global generation:  0.0012001991271972656
r_  generation:  0.014148950576782227
local_output_nid generation:  0.0014643669128417969
local_in_edges_tensor generation:  0.0017101764678955078
mini_batch_src_global generation:  0.0018243789672851562
r_  generation:  0.022105693817138672
local_output_nid generation:  0.0006451606750488281
local_in_edges_tensor generation:  0.0008287429809570312
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.009849309921264648
local_output_nid generation:  0.001220703125
local_in_edges_tensor generation:  0.0015108585357666016
mini_batch_src_global generation:  0.0015306472778320312
r_  generation:  0.020926475524902344
local_output_nid generation:  0.0011279582977294922
local_in_edges_tensor generation:  0.0017037391662597656
mini_batch_src_global generation:  0.0016047954559326172
r_  generation:  0.019433975219726562
local_output_nid generation:  0.001123666763305664
local_in_edges_tensor generation:  0.0013959407806396484
mini_batch_src_global generation:  0.0016536712646484375
r_  generation:  0.01946401596069336
local_output_nid generation:  0.001626729965209961
local_in_edges_tensor generation:  0.0021562576293945312
mini_batch_src_global generation:  0.00215911865234375
r_  generation:  0.024699687957763672
local_output_nid generation:  0.00128936767578125
local_in_edges_tensor generation:  0.0016057491302490234
mini_batch_src_global generation:  0.001821279525756836
r_  generation:  0.021823406219482422
----------------------check_connections_block total spend ----------------------------- 0.4288203716278076
generate_one_block  0.020305395126342773
generate_one_block  0.027824878692626953
generate_one_block  0.029193878173828125
generate_one_block  0.030907154083251953
generate_one_block  0.03099536895751953
generate_one_block  0.027054548263549805
generate_one_block  0.024414777755737305
generate_one_block  0.019407987594604492
generate_one_block  0.02942204475402832
generate_one_block  0.015498161315917969
generate_one_block  0.025928258895874023
generate_one_block  0.029615402221679688
generate_one_block  0.027093172073364258
generate_one_block  0.0330960750579834
generate_one_block  0.02962970733642578
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.0676565170288086  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

connection checking time:  0.7746479511260986
block generation total time  0.769909143447876
average batch blocks generation time:  0.0513272762298584
block dataloader generation time/epoch 1.824573278427124
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.05805778503417969  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([14184, 500])
torch.Size([7152, 32])
torch.Size([2772, 32])
torch.Size([404, 32])
torch.Size([101, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 1.3961811065673828  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.062001705169677734  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([16179, 500])
torch.Size([9989, 32])
torch.Size([3118, 32])
torch.Size([615, 32])
torch.Size([120, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 1.9569787979125977  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.0639495849609375  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([17108, 500])
torch.Size([11656, 32])
torch.Size([5515, 32])
torch.Size([1172, 32])
torch.Size([177, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 2.163233757019043  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.0660238265991211  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([18189, 500])
torch.Size([13292, 32])
torch.Size([7902, 32])
torch.Size([1740, 32])
torch.Size([375, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 2.282844066619873  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.0655832290649414  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([17979, 500])
torch.Size([13791, 32])
torch.Size([5364, 32])
torch.Size([1421, 32])
torch.Size([152, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 2.3041486740112305  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.06322622299194336  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([16335, 500])
torch.Size([10662, 32])
torch.Size([4368, 32])
torch.Size([761, 32])
torch.Size([91, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 2.0429539680480957  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.059813499450683594  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([14932, 500])
torch.Size([9029, 32])
torch.Size([4597, 32])
torch.Size([1493, 32])
torch.Size([334, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 1.8459177017211914  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.05503129959106445  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([12163, 500])
torch.Size([6176, 32])
torch.Size([1379, 32])
torch.Size([280, 32])
torch.Size([61, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 1.397336483001709  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.06445074081420898  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([17353, 500])
torch.Size([12218, 32])
torch.Size([5932, 32])
torch.Size([1115, 32])
torch.Size([195, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 2.2304186820983887  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.05347394943237305  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([11821, 500])
torch.Size([5006, 32])
torch.Size([1197, 32])
torch.Size([241, 32])
torch.Size([77, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 1.0243911743164062  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.06320524215698242  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([16388, 500])
torch.Size([10615, 32])
torch.Size([4161, 32])
torch.Size([686, 32])
torch.Size([135, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 2.038893222808838  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.0607457160949707  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([15410, 500])
torch.Size([9770, 32])
torch.Size([5066, 32])
torch.Size([1573, 32])
torch.Size([338, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 1.933976173400879  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.061756134033203125  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([16033, 500])
torch.Size([9632, 32])
torch.Size([3342, 32])
torch.Size([676, 32])
torch.Size([137, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 1.9435725212097168  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8592529296875 GB
    Memory Allocated: 0.06673526763916016  GigaBytes
Max Memory Allocated: 2.426229953765869  GigaBytes

torch.Size([18492, 500])
torch.Size([14927, 32])
torch.Size([8094, 32])
torch.Size([1931, 32])
torch.Size([383, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0233154296875 GB
    Memory Allocated: 2.452238082885742  GigaBytes
Max Memory Allocated: 2.4850306510925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0213623046875 GB
    Memory Allocated: 0.06498098373413086  GigaBytes
Max Memory Allocated: 2.4850306510925293  GigaBytes

torch.Size([17716, 500])
torch.Size([11235, 32])
torch.Size([5629, 32])
torch.Size([888, 32])
torch.Size([255, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0213623046875 GB
    Memory Allocated: 2.1250038146972656  GigaBytes
Max Memory Allocated: 2.4850306510925293  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014287757873535156 |0.003132168451944987 |0.30142807960510254 |0.00013799667358398436 |0.500486167271932 |0.014036417007446289 |
----------------------------------------------------------pseudo_mini_loss sum 1.5702307224273682
Total (block generation + training)time/epoch 14.173933744430542
Training time/epoch 12.34901237487793
Training time without block to device /epoch 12.302029848098755
Training time without total dataloading part /epoch 12.044820070266724
load block tensor time/epoch 0.21431636810302734
block to device time/epoch 0.046982526779174805
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  482152
Number of first layer input nodes during this epoch:  240282
