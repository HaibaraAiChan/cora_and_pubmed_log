main start at this time 1648534466.162171
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008460521697998047  GigaBytes
Max Memory Allocated: 0.008460521697998047  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0017197132110595703
range selection method range initialization spend 9.751319885253906e-05
time for parepare:  5.1021575927734375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.001264810562133789
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.384185791015625e-05
----------------------check_connections_block total spend ----------------------------- 0.0030677318572998047
generate_one_block  0.001331329345703125
generate_one_block  0.0012650489807128906
generate_one_block  0.0011801719665527344
generate_one_block  0.0012238025665283203
generate_one_block  0.0011811256408691406
generate_one_block  0.0011692047119140625
generate_one_block  0.0011527538299560547
generate_one_block  0.0011425018310546875
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001115560531616211
gen group dst list time:  6.222724914550781e-05
time for parepare:  0.0003197193145751953
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001952648162841797
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0002512931823730469
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0002009868621826172
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0002815723419189453
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002541542053222656
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00015497207641601562
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00010275840759277344
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00010943412780761719
----------------------check_connections_block total spend ----------------------------- 0.003912210464477539
generate_one_block  0.0013990402221679688
generate_one_block  0.0015451908111572266
generate_one_block  0.0014884471893310547
generate_one_block  0.0015780925750732422
generate_one_block  0.0015120506286621094
generate_one_block  0.0013451576232910156
generate_one_block  0.0010895729064941406
generate_one_block  0.001032114028930664
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012271404266357422
gen group dst list time:  0.00011467933654785156
time for parepare:  0.0009443759918212891
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0003108978271484375
mini_batch_src_global generation:  0.00010228157043457031
r_  generation:  0.0010066032409667969
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  0.0001690387725830078
r_  generation:  0.0014541149139404297
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  0.00017595291137695312
r_  generation:  0.0014023780822753906
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  0.00025153160095214844
r_  generation:  0.0022170543670654297
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  0.00026416778564453125
r_  generation:  0.0023343563079833984
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0007960796356201172
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.0005099773406982422
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.000469207763671875
----------------------check_connections_block total spend ----------------------------- 0.017188549041748047
generate_one_block  0.0019714832305908203
generate_one_block  0.002407550811767578
generate_one_block  0.002431631088256836
generate_one_block  0.003114461898803711
generate_one_block  0.0034182071685791016
generate_one_block  0.0017313957214355469
generate_one_block  0.0014903545379638672
generate_one_block  0.001516580581665039
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002384185791015625
gen group dst list time:  0.00032258033752441406
time for parepare:  0.0026674270629882812
local_output_nid generation:  0.00024819374084472656
local_in_edges_tensor generation:  0.0009622573852539062
mini_batch_src_global generation:  0.00106048583984375
r_  generation:  0.00880122184753418
local_output_nid generation:  0.00021886825561523438
local_in_edges_tensor generation:  0.0005640983581542969
mini_batch_src_global generation:  0.0009715557098388672
r_  generation:  0.007052183151245117
local_output_nid generation:  0.00018215179443359375
local_in_edges_tensor generation:  0.00044465065002441406
mini_batch_src_global generation:  0.0008435249328613281
r_  generation:  0.007561445236206055
local_output_nid generation:  0.00016880035400390625
local_in_edges_tensor generation:  0.0004067420959472656
mini_batch_src_global generation:  0.0007522106170654297
r_  generation:  0.0070874691009521484
local_output_nid generation:  0.00023818016052246094
local_in_edges_tensor generation:  0.0004966259002685547
mini_batch_src_global generation:  0.0008747577667236328
r_  generation:  0.008632898330688477
local_output_nid generation:  0.00011587142944335938
local_in_edges_tensor generation:  0.0002789497375488281
mini_batch_src_global generation:  0.0004935264587402344
r_  generation:  0.0036606788635253906
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.0002551078796386719
mini_batch_src_global generation:  0.0003457069396972656
r_  generation:  0.0033113956451416016
local_output_nid generation:  0.00010251998901367188
local_in_edges_tensor generation:  0.0002460479736328125
mini_batch_src_global generation:  0.00027441978454589844
r_  generation:  0.0025179386138916016
----------------------check_connections_block total spend ----------------------------- 0.07447957992553711
generate_one_block  0.006760358810424805
generate_one_block  0.007911920547485352
generate_one_block  0.011049509048461914
generate_one_block  0.01073455810546875
generate_one_block  0.012114763259887695
generate_one_block  0.0054852962493896484
generate_one_block  0.005249500274658203
generate_one_block  0.004127025604248047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002242565155029297
gen group dst list time:  0.0012862682342529297
time for parepare:  0.0018460750579833984
local_output_nid generation:  0.0005385875701904297
local_in_edges_tensor generation:  0.0014388561248779297
mini_batch_src_global generation:  0.0015158653259277344
r_  generation:  0.013757467269897461
local_output_nid generation:  0.0006897449493408203
local_in_edges_tensor generation:  0.001390695571899414
mini_batch_src_global generation:  0.0016913414001464844
r_  generation:  0.015561342239379883
local_output_nid generation:  0.0009181499481201172
local_in_edges_tensor generation:  0.0029671192169189453
mini_batch_src_global generation:  0.0017926692962646484
r_  generation:  0.019398212432861328
local_output_nid generation:  0.0008003711700439453
local_in_edges_tensor generation:  0.0011663436889648438
mini_batch_src_global generation:  0.0014488697052001953
r_  generation:  0.017293453216552734
local_output_nid generation:  0.0007832050323486328
local_in_edges_tensor generation:  0.0014126300811767578
mini_batch_src_global generation:  0.0017032623291015625
r_  generation:  0.018223285675048828
local_output_nid generation:  0.0005252361297607422
local_in_edges_tensor generation:  0.0008363723754882812
mini_batch_src_global generation:  0.00127410888671875
r_  generation:  0.014232635498046875
local_output_nid generation:  0.0005476474761962891
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.001039743423461914
r_  generation:  0.01277613639831543
local_output_nid generation:  0.0003743171691894531
local_in_edges_tensor generation:  0.0006313323974609375
mini_batch_src_global generation:  0.0008606910705566406
r_  generation:  0.008436203002929688
----------------------check_connections_block total spend ----------------------------- 0.17589855194091797
generate_one_block  0.01808953285217285
generate_one_block  0.021065473556518555
generate_one_block  0.024838685989379883
generate_one_block  0.022423744201660156
generate_one_block  0.02443528175354004
generate_one_block  0.018147706985473633
generate_one_block  0.01663064956665039
generate_one_block  0.014181375503540039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020151138305664062
gen group dst list time:  0.0027685165405273438
time for parepare:  0.0017175674438476562
local_output_nid generation:  0.0011317729949951172
local_in_edges_tensor generation:  0.0025386810302734375
mini_batch_src_global generation:  0.002228260040283203
r_  generation:  0.021983861923217773
local_output_nid generation:  0.0012221336364746094
local_in_edges_tensor generation:  0.002584695816040039
mini_batch_src_global generation:  0.0025386810302734375
r_  generation:  0.023388147354125977
local_output_nid generation:  0.001425027847290039
local_in_edges_tensor generation:  0.0026073455810546875
mini_batch_src_global generation:  0.002009153366088867
r_  generation:  0.024599075317382812
local_output_nid generation:  0.0013554096221923828
local_in_edges_tensor generation:  0.001936197280883789
mini_batch_src_global generation:  0.0019168853759765625
r_  generation:  0.023055076599121094
local_output_nid generation:  0.001344919204711914
local_in_edges_tensor generation:  0.002228260040283203
mini_batch_src_global generation:  0.0021228790283203125
r_  generation:  0.02462935447692871
local_output_nid generation:  0.0015330314636230469
local_in_edges_tensor generation:  0.002065420150756836
mini_batch_src_global generation:  0.0020906925201416016
r_  generation:  0.02375483512878418
local_output_nid generation:  0.0017330646514892578
local_in_edges_tensor generation:  0.002056598663330078
mini_batch_src_global generation:  0.0023162364959716797
r_  generation:  0.02222299575805664
local_output_nid generation:  0.0015976428985595703
local_in_edges_tensor generation:  0.0020089149475097656
mini_batch_src_global generation:  0.001918792724609375
r_  generation:  0.019263029098510742
----------------------check_connections_block total spend ----------------------------- 0.2694063186645508
generate_one_block  0.028424501419067383
generate_one_block  0.03018784523010254
generate_one_block  0.029737234115600586
generate_one_block  0.028704404830932617
generate_one_block  0.029019594192504883
generate_one_block  0.028356075286865234
generate_one_block  0.026610374450683594
generate_one_block  0.02343010902404785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008460521697998047  GigaBytes
Max Memory Allocated: 0.008460521697998047  GigaBytes

connection checking time:  0.5408852100372314
block generation total time  0.47678685188293457
average batch blocks generation time:  0.05959835648536682
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.042672157287597656  GigaBytes
Max Memory Allocated: 0.042672157287597656  GigaBytes

torch.Size([17802, 500])
torch.Size([12917, 64])
torch.Size([5758, 64])
torch.Size([1424, 64])
torch.Size([286, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8026123046875 GB
    Memory Allocated: 2.3875327110290527  GigaBytes
Max Memory Allocated: 2.387561321258545  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8045654296875 GB
    Memory Allocated: 0.05272388458251953  GigaBytes
Max Memory Allocated: 2.3877601623535156  GigaBytes

torch.Size([18641, 500])
torch.Size([14458, 64])
torch.Size([8202, 64])
torch.Size([2082, 64])
torch.Size([506, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0115966796875 GB
    Memory Allocated: 2.537998676300049  GigaBytes
Max Memory Allocated: 2.538027763366699  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0115966796875 GB
    Memory Allocated: 0.053044795989990234  GigaBytes
Max Memory Allocated: 2.538222312927246  GigaBytes

torch.Size([18712, 500])
torch.Size([15290, 64])
torch.Size([10156, 64])
torch.Size([2314, 64])
torch.Size([417, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.680626392364502  GigaBytes
Max Memory Allocated: 2.6806468963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.05195903778076172  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

torch.Size([18153, 500])
torch.Size([13966, 64])
torch.Size([8230, 64])
torch.Size([2148, 64])
torch.Size([528, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2244873046875 GB
    Memory Allocated: 2.5759215354919434  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2244873046875 GB
    Memory Allocated: 0.052272796630859375  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

torch.Size([18280, 500])
torch.Size([15174, 64])
torch.Size([9031, 64])
torch.Size([2963, 64])
torch.Size([512, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.6628246307373047  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.05137777328491211  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

torch.Size([17971, 500])
torch.Size([13098, 64])
torch.Size([5736, 64])
torch.Size([1195, 64])
torch.Size([274, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.411095142364502  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.05103254318237305  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

torch.Size([17391, 500])
torch.Size([11741, 64])
torch.Size([5937, 64])
torch.Size([868, 64])
torch.Size([215, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.2631888389587402  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.048326969146728516  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

torch.Size([16475, 500])
torch.Size([10842, 64])
torch.Size([4025, 64])
torch.Size([1032, 64])
torch.Size([179, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 1.905655860900879  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018555104732513428 |0.04543158411979675 |0.3911929130554199 |0.00015050172805786133 |0.4336185157299042 |0.015240907669067383 |
----------------------------------------------------------pseudo_mini_loss sum 1.7646390199661255
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  325286
Number of first layer input nodes during this epoch:  143425
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.06728267669677734  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007252693176269531
range selection method range initialization spend 6.937980651855469e-05
time for parepare:  6.604194641113281e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.0017867088317871094
generate_one_block  0.001237630844116211
generate_one_block  0.0010755062103271484
generate_one_block  0.0010809898376464844
generate_one_block  0.0010755062103271484
generate_one_block  0.0010461807250976562
generate_one_block  0.0010826587677001953
generate_one_block  0.0011265277862548828
generate_one_block  0.0010564327239990234
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006527900695800781
gen group dst list time:  5.7697296142578125e-05
time for parepare:  0.0003447532653808594
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.00023245811462402344
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00013017654418945312
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002498626708984375
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00014710426330566406
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00010800361633300781
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0002465248107910156
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0002853870391845703
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  7.796287536621094e-05
----------------------check_connections_block total spend ----------------------------- 0.0038809776306152344
generate_one_block  0.0014710426330566406
generate_one_block  0.0012202262878417969
generate_one_block  0.0014333724975585938
generate_one_block  0.0013632774353027344
generate_one_block  0.0011987686157226562
generate_one_block  0.0014138221740722656
generate_one_block  0.0014469623565673828
generate_one_block  0.0010788440704345703
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012018680572509766
gen group dst list time:  0.00011920928955078125
time for parepare:  0.0009779930114746094
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00047278404235839844
mini_batch_src_global generation:  0.00018024444580078125
r_  generation:  0.0012462139129638672
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  0.00011754035949707031
r_  generation:  0.0006170272827148438
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.00022029876708984375
r_  generation:  0.0019142627716064453
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.0010027885437011719
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0005373954772949219
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.0001583099365234375
r_  generation:  0.0015354156494140625
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.0002231597900390625
mini_batch_src_global generation:  0.0002219676971435547
r_  generation:  0.0018727779388427734
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  0.00011801719665527344
r_  generation:  0.0004591941833496094
----------------------check_connections_block total spend ----------------------------- 0.016315937042236328
generate_one_block  0.0029206275939941406
generate_one_block  0.001790761947631836
generate_one_block  0.003592252731323242
generate_one_block  0.0023462772369384766
generate_one_block  0.0016901493072509766
generate_one_block  0.0030710697174072266
generate_one_block  0.003417491912841797
generate_one_block  0.0015993118286132812
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018780231475830078
gen group dst list time:  0.0003254413604736328
time for parepare:  0.0015423297882080078
local_output_nid generation:  0.0002319812774658203
local_in_edges_tensor generation:  0.0009634494781494141
mini_batch_src_global generation:  0.0008423328399658203
r_  generation:  0.006604194641113281
local_output_nid generation:  0.00010323524475097656
local_in_edges_tensor generation:  0.00029659271240234375
mini_batch_src_global generation:  0.0005011558532714844
r_  generation:  0.0036954879760742188
local_output_nid generation:  0.00027751922607421875
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0007145404815673828
r_  generation:  0.007816314697265625
local_output_nid generation:  0.0002205371856689453
local_in_edges_tensor generation:  0.00048160552978515625
mini_batch_src_global generation:  0.0005767345428466797
r_  generation:  0.005378007888793945
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.000263214111328125
mini_batch_src_global generation:  0.00037550926208496094
r_  generation:  0.002994060516357422
local_output_nid generation:  0.00028967857360839844
local_in_edges_tensor generation:  0.0010058879852294922
mini_batch_src_global generation:  0.0006039142608642578
r_  generation:  0.0070841312408447266
local_output_nid generation:  0.000217437744140625
local_in_edges_tensor generation:  0.0006566047668457031
mini_batch_src_global generation:  0.0007038116455078125
r_  generation:  0.006651639938354492
local_output_nid generation:  0.00011157989501953125
local_in_edges_tensor generation:  0.0002803802490234375
mini_batch_src_global generation:  0.0004489421844482422
r_  generation:  0.003246307373046875
----------------------check_connections_block total spend ----------------------------- 0.06687450408935547
generate_one_block  0.010774850845336914
generate_one_block  0.005972623825073242
generate_one_block  0.011779546737670898
generate_one_block  0.008541584014892578
generate_one_block  0.005282402038574219
generate_one_block  0.010924577713012695
generate_one_block  0.01048135757446289
generate_one_block  0.005460023880004883
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002226114273071289
gen group dst list time:  0.0012814998626708984
time for parepare:  0.0017783641815185547
local_output_nid generation:  0.001013040542602539
local_in_edges_tensor generation:  0.002342700958251953
mini_batch_src_global generation:  0.001764059066772461
r_  generation:  0.018365144729614258
local_output_nid generation:  0.0005438327789306641
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.0014262199401855469
r_  generation:  0.011412858963012695
local_output_nid generation:  0.0008509159088134766
local_in_edges_tensor generation:  0.0013747215270996094
mini_batch_src_global generation:  0.001374959945678711
r_  generation:  0.016958236694335938
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0011839866638183594
mini_batch_src_global generation:  0.0015625953674316406
r_  generation:  0.01685619354248047
local_output_nid generation:  0.0005974769592285156
local_in_edges_tensor generation:  0.0008082389831542969
mini_batch_src_global generation:  0.001222848892211914
r_  generation:  0.012052297592163086
local_output_nid generation:  0.0010662078857421875
local_in_edges_tensor generation:  0.0014781951904296875
mini_batch_src_global generation:  0.0013651847839355469
r_  generation:  0.019066572189331055
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.0012018680572509766
mini_batch_src_global generation:  0.001455545425415039
r_  generation:  0.015924692153930664
local_output_nid generation:  0.0005517005920410156
local_in_edges_tensor generation:  0.0006940364837646484
mini_batch_src_global generation:  0.0010776519775390625
r_  generation:  0.01115274429321289
----------------------check_connections_block total spend ----------------------------- 0.17953038215637207
generate_one_block  0.024378538131713867
generate_one_block  0.016573429107666016
generate_one_block  0.023234128952026367
generate_one_block  0.024201631546020508
generate_one_block  0.01806640625
generate_one_block  0.025569915771484375
generate_one_block  0.02144622802734375
generate_one_block  0.016149282455444336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017917156219482422
gen group dst list time:  0.0026476383209228516
time for parepare:  0.001856088638305664
local_output_nid generation:  0.0014934539794921875
local_in_edges_tensor generation:  0.002790689468383789
mini_batch_src_global generation:  0.002305746078491211
r_  generation:  0.024196624755859375
local_output_nid generation:  0.0011644363403320312
local_in_edges_tensor generation:  0.0018606185913085938
mini_batch_src_global generation:  0.002283811569213867
r_  generation:  0.020136594772338867
local_output_nid generation:  0.001528024673461914
local_in_edges_tensor generation:  0.0019345283508300781
mini_batch_src_global generation:  0.001956939697265625
r_  generation:  0.023533105850219727
local_output_nid generation:  0.0017697811126708984
local_in_edges_tensor generation:  0.002466440200805664
mini_batch_src_global generation:  0.0021979808807373047
r_  generation:  0.024425745010375977
local_output_nid generation:  0.0014460086822509766
local_in_edges_tensor generation:  0.0015211105346679688
mini_batch_src_global generation:  0.0017774105072021484
r_  generation:  0.021266937255859375
local_output_nid generation:  0.0019397735595703125
local_in_edges_tensor generation:  0.002171754837036133
mini_batch_src_global generation:  0.0021712779998779297
r_  generation:  0.025319814682006836
local_output_nid generation:  0.0015308856964111328
local_in_edges_tensor generation:  0.0018610954284667969
mini_batch_src_global generation: Using backend: pytorch
 0.0018496513366699219
r_  generation:  0.022944927215576172
local_output_nid generation:  0.0012505054473876953
local_in_edges_tensor generation:  0.0014357566833496094
mini_batch_src_global generation:  0.0017385482788085938
r_  generation:  0.019613981246948242
----------------------check_connections_block total spend ----------------------------- 0.26677632331848145
generate_one_block  0.03186297416687012
generate_one_block  0.027756214141845703
generate_one_block  0.030872106552124023
generate_one_block  0.03240799903869629
generate_one_block  0.028775453567504883
generate_one_block  0.031967878341674805
generate_one_block  0.0306246280670166
generate_one_block  0.02664494514465332
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.06728267669677734  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

connection checking time:  0.5333781242370605
block generation total time  0.5108029842376709
average batch blocks generation time:  0.06385037302970886
block dataloader generation time/epoch 1.2103664875030518
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.07090425491333008  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

torch.Size([18790, 500])
torch.Size([14986, 64])
torch.Size([9634, 64])
torch.Size([2003, 64])
torch.Size([516, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.645512104034424  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.06664276123046875  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

torch.Size([16667, 500])
torch.Size([10420, 64])
torch.Size([4686, 64])
torch.Size([928, 64])
torch.Size([235, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.16310977935791  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.06949520111083984  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

torch.Size([18008, 500])
torch.Size([14124, 64])
torch.Size([7981, 64])
torch.Size([2545, 64])
torch.Size([469, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.5958433151245117  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.07030820846557617  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

torch.Size([18488, 500])
torch.Size([15401, 64])
torch.Size([7540, 64])
torch.Size([2015, 64])
torch.Size([282, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.6264142990112305  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.06764745712280273  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

torch.Size([17206, 500])
torch.Size([11281, 64])
torch.Size([5006, 64])
torch.Size([831, 64])
torch.Size([222, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.222898006439209  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.07110071182250977  GigaBytes
Max Memory Allocated: 2.6808552742004395  GigaBytes

torch.Size([18849, 500])
torch.Size([16006, 64])
torch.Size([9324, 64])
torch.Size([2616, 64])
torch.Size([529, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3963623046875 GB
    Memory Allocated: 2.7362618446350098  GigaBytes
Max Memory Allocated: 2.7362918853759766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3963623046875 GB
    Memory Allocated: 0.0694117546081543  GigaBytes
Max Memory Allocated: 2.7364859580993652  GigaBytes

torch.Size([18004, 500])
torch.Size([13065, 64])
torch.Size([7616, 64])
torch.Size([2077, 64])
torch.Size([523, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3963623046875 GB
    Memory Allocated: 2.505418300628662  GigaBytes
Max Memory Allocated: 2.7364859580993652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3963623046875 GB
    Memory Allocated: 0.06515884399414062  GigaBytes
Max Memory Allocated: 2.7364859580993652  GigaBytes

torch.Size([15882, 500])
torch.Size([10406, 64])
torch.Size([4070, 64])
torch.Size([968, 64])
torch.Size([130, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3963623046875 GB
    Memory Allocated: 2.106740951538086  GigaBytes
Max Memory Allocated: 2.7364859580993652  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01704847812652588 |0.003071904182434082 |0.3240773379802704 |0.00013566017150878906 |0.4403938055038452 |0.011673688888549805 |
----------------------------------------------------------pseudo_mini_loss sum 1.734297275543213
Total (block generation + training)time/epoch 7.52625298500061
Training time/epoch 6.315666198730469
Training time without block to device /epoch 6.291090965270996
Training time without total dataloading part /epoch 6.128528118133545
load block tensor time/epoch 0.13638782501220703
block to device time/epoch 0.024575233459472656
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  320686
Number of first layer input nodes during this epoch:  141894
