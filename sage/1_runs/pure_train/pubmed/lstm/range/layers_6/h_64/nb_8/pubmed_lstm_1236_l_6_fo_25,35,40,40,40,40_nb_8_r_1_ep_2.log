main start at this time 1648534447.8907187
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008460521697998047  GigaBytes
Max Memory Allocated: 0.008460521697998047  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0016069412231445312
range selection method range initialization spend 0.00010609626770019531
time for parepare:  5.412101745605469e-05
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0018422603607177734
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.504753112792969e-05
----------------------check_connections_block total spend ----------------------------- 0.003035306930541992
generate_one_block  0.001516580581665039
generate_one_block  0.0012664794921875
generate_one_block  0.001287698745727539
generate_one_block  0.0012645721435546875
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0010352134704589844
gen group dst list time:  4.1484832763671875e-05
time for parepare:  0.00028204917907714844
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.000286102294921875
mini_batch_src_global generation:  8.7738037109375e-05
r_  generation:  0.0004558563232421875
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0004899501800537109
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0003399848937988281
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00029659271240234375
----------------------check_connections_block total spend ----------------------------- 0.003404855728149414
generate_one_block  0.0018620491027832031
generate_one_block  0.0018839836120605469
generate_one_block  0.0016868114471435547
generate_one_block  0.0015778541564941406
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011849403381347656
gen group dst list time:  8.96453857421875e-05
time for parepare:  0.0009400844573974609
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.0003628730773925781
mini_batch_src_global generation:  0.0002052783966064453
r_  generation:  0.002384662628173828
local_output_nid generation:  8.702278137207031e-05
local_in_edges_tensor generation:  0.00030994415283203125
mini_batch_src_global generation:  0.0003998279571533203
r_  generation:  0.0035381317138671875
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.0002589225769042969
mini_batch_src_global generation:  0.0003249645233154297
r_  generation:  0.003026723861694336
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  0.00019550323486328125
r_  generation:  0.0013773441314697266
----------------------check_connections_block total spend ----------------------------- 0.01650381088256836
generate_one_block  0.003473043441772461
generate_one_block  0.004725933074951172
generate_one_block  0.004153728485107422
generate_one_block  0.0024423599243164062
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0023818016052246094
gen group dst list time:  0.0002989768981933594
time for parepare:  0.0018434524536132812
local_output_nid generation:  0.0003044605255126953
local_in_edges_tensor generation:  0.0009186267852783203
mini_batch_src_global generation:  0.001184225082397461
r_  generation:  0.01635599136352539
local_output_nid generation:  0.0003867149353027344
local_in_edges_tensor generation:  0.0014677047729492188
mini_batch_src_global generation:  0.002035856246948242
r_  generation:  0.011850595474243164
local_output_nid generation:  0.0002980232238769531
local_in_edges_tensor generation:  0.0006225109100341797
mini_batch_src_global generation:  0.0009074211120605469
r_  generation:  0.010055303573608398
local_output_nid generation:  0.00019598007202148438
local_in_edges_tensor generation:  0.00042629241943359375
mini_batch_src_global generation:  0.0006632804870605469
r_  generation:  0.0057506561279296875
----------------------check_connections_block total spend ----------------------------- 0.06624841690063477
generate_one_block  0.011690616607666016
generate_one_block  0.015613317489624023
generate_one_block  0.014512777328491211
generate_one_block  0.009321451187133789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016720294952392578
gen group dst list time:  0.0008358955383300781
time for parepare:  0.0018625259399414062
local_output_nid generation:  0.0008280277252197266
local_in_edges_tensor generation:  0.0019555091857910156
mini_batch_src_global generation:  0.0021049976348876953
r_  generation:  0.020029306411743164
local_output_nid generation:  0.001001119613647461
local_in_edges_tensor generation:  0.0019931793212890625
mini_batch_src_global generation:  0.0026755332946777344
r_  generation:  0.02218937873840332
local_output_nid generation:  0.0010137557983398438
local_in_edges_tensor generation:  0.0013103485107421875
mini_batch_src_global generation:  0.0017039775848388672
r_  generation:  0.019939422607421875
local_output_nid generation:  0.0009026527404785156
local_in_edges_tensor generation:  0.0012526512145996094
mini_batch_src_global generation:  0.0015177726745605469
r_  generation:  0.017665863037109375
----------------------check_connections_block total spend ----------------------------- 0.11794495582580566
generate_one_block  0.02475142478942871
generate_one_block  0.030131101608276367
generate_one_block  0.02599811553955078
generate_one_block  0.022711992263793945
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017707347869873047
gen group dst list time:  0.0014231204986572266
time for parepare:  0.0017142295837402344
local_output_nid generation:  0.001331329345703125
local_in_edges_tensor generation:  0.002506256103515625
mini_batch_src_global generation:  0.002176046371459961
r_  generation:  0.025609493255615234
local_output_nid generation:  0.0014405250549316406
local_in_edges_tensor generation:  0.0027430057525634766
mini_batch_src_global generation:  0.002832651138305664
r_  generation:  0.0256197452545166
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.002161741256713867
mini_batch_src_global generation:  0.0022287368774414062
r_  generation:  0.02536177635192871
local_output_nid generation:  0.0014629364013671875
local_in_edges_tensor generation:  0.0019338130950927734
mini_batch_src_global generation:  0.0019922256469726562
r_  generation:  0.0244905948638916
----------------------check_connections_block total spend ----------------------------- 0.14855337142944336
generate_one_block  0.029994487762451172
generate_one_block  0.032193899154663086
generate_one_block  0.031046152114868164
generate_one_block  0.029961824417114258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008460521697998047  GigaBytes
Max Memory Allocated: 0.008460521697998047  GigaBytes

connection checking time:  0.35265541076660156
block generation total time  0.29973292350769043
average batch blocks generation time:  0.07493323087692261
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1405029296875 GB
    Memory Allocated: 0.04521369934082031  GigaBytes
Max Memory Allocated: 0.04521369934082031  GigaBytes

torch.Size([19015, 500])
torch.Size([16606, 64])
torch.Size([10497, 64])
torch.Size([3145, 64])
torch.Size([761, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1600341796875 GB
    Memory Allocated: 2.7793312072753906  GigaBytes
Max Memory Allocated: 2.779376983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1619873046875 GB
    Memory Allocated: 0.054468631744384766  GigaBytes
Max Memory Allocated: 2.779542922973633  GigaBytes

torch.Size([19064, 500])
torch.Size([16632, 64])
torch.Size([12551, 64])
torch.Size([3645, 64])
torch.Size([908, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2791748046875 GB
    Memory Allocated: 2.875399112701416  GigaBytes
Max Memory Allocated: 2.875433921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2811279296875 GB
    Memory Allocated: 0.05350923538208008  GigaBytes
Max Memory Allocated: 2.875619411468506  GigaBytes

torch.Size([18614, 500])
torch.Size([16090, 64])
torch.Size([9786, 64])
torch.Size([3516, 64])
torch.Size([659, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2811279296875 GB
    Memory Allocated: 2.7649917602539062  GigaBytes
Max Memory Allocated: 2.875619411468506  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2811279296875 GB
    Memory Allocated: 0.05344581604003906  GigaBytes
Max Memory Allocated: 2.875619411468506  GigaBytes

torch.Size([18696, 500])
torch.Size([15258, 64])
torch.Size([8854, 64])
torch.Size([2159, 64])
torch.Size([536, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2811279296875 GB
    Memory Allocated: 2.6235976219177246  GigaBytes
Max Memory Allocated: 2.875619411468506  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.020675241947174072 |0.08792442083358765 |0.4993528127670288 |0.0001709461212158203 |0.45904409885406494 |0.014318704605102539 |
----------------------------------------------------------pseudo_mini_loss sum 1.7700085639953613
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  197348
Number of first layer input nodes during this epoch:  75389
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.2811279296875 GB
    Memory Allocated: 0.07286310195922852  GigaBytes
Max Memory Allocated: 2.875619411468506  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00057220458984375
range selection method range initialization spend 6.747245788574219e-05
time for parepare:  6.318092346191406e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  6.651878356933594e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  4.649162292480469e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.030632019042969e-05
----------------------check_connections_block total spend ----------------------------- 0.001169443130493164
generate_one_block  0.0012176036834716797
generate_one_block  0.0011408329010009766
generate_one_block  0.0011069774627685547
generate_one_block  0.0013523101806640625
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005962848663330078
gen group dst list time:  4.00543212890625e-05
time for parepare:  0.0003147125244140625
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00034165382385253906
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.0003771781921386719
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00024008750915527344
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0004546642303466797
----------------------check_connections_block total spend ----------------------------- 0.0031697750091552734
generate_one_block  0.0016045570373535156
generate_one_block  0.0016252994537353516
generate_one_block  0.0014154911041259766
generate_one_block  0.0017750263214111328
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010521411895751953
gen group dst list time:  9.465217590332031e-05
time for parepare:  0.0008709430694580078
local_output_nid generation:  8.893013000488281e-05
local_in_edges_tensor generation:  0.0004172325134277344
mini_batch_src_global generation:  0.0002295970916748047
r_  generation:  0.0017902851104736328
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.00024127960205078125
mini_batch_src_global generation:  0.0004029273986816406
r_  generation:  0.002871274948120117
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  0.00018835067749023438
r_  generation:  0.0013723373413085938
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.000263214111328125
mini_batch_src_global generation:  0.0002689361572265625
r_  generation:  0.003023386001586914
----------------------check_connections_block total spend ----------------------------- 0.014956951141357422
generate_one_block  0.004060983657836914
generate_one_block  0.00484013557434082
generate_one_block  0.002717256546020508
generate_one_block  0.004835605621337891
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021195411682128906
gen group dst list time:  0.0002779960632324219
time for parepare:  0.001466989517211914
local_output_nid generation:  0.00027298927307128906
local_in_edges_tensor generation:  0.0010290145874023438
mini_batch_src_global generation:  0.0011365413665771484
r_  generation:  0.009504079818725586
local_output_nid generation:  0.0003876686096191406
local_in_edges_tensor generation:  0.00087738037109375
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.012127399444580078
local_output_nid generation:  0.00023174285888671875
local_in_edges_tensor generation:  0.0005283355712890625
mini_batch_src_global generation:  0.0007994174957275391
r_  generation:  0.006461143493652344
local_output_nid generation: Using backend: pytorch
 0.0003814697265625
local_in_edges_tensor generation:  0.0006878376007080078
mini_batch_src_global generation:  0.00096893310546875
r_  generation:  0.011446237564086914
----------------------check_connections_block total spend ----------------------------- 0.05950117111206055
generate_one_block  0.015427112579345703
generate_one_block  0.01605081558227539
generate_one_block  0.01125025749206543
generate_one_block  0.016414642333984375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019025802612304688
gen group dst list time:  0.0008275508880615234
time for parepare:  0.0015490055084228516
local_output_nid generation:  0.0010480880737304688
local_in_edges_tensor generation:  0.002315521240234375
mini_batch_src_global generation:  0.0019268989562988281
r_  generation:  0.02153921127319336
local_output_nid generation:  0.0010802745819091797
local_in_edges_tensor generation:  0.0021865367889404297
mini_batch_src_global generation:  0.0025331974029541016
r_  generation:  0.021846771240234375
local_output_nid generation:  0.0010461807250976562
local_in_edges_tensor generation:  0.0013523101806640625
mini_batch_src_global generation:  0.0017025470733642578
r_  generation:  0.01883530616760254
local_output_nid generation:  0.0012869834899902344
local_in_edges_tensor generation:  0.001748800277709961
mini_batch_src_global generation:  0.0021104812622070312
r_  generation:  0.021628379821777344
----------------------check_connections_block total spend ----------------------------- 0.1249842643737793
generate_one_block  0.028217792510986328
generate_one_block  0.030581235885620117
generate_one_block  0.02625131607055664
generate_one_block  0.029210567474365234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002106904983520508
gen group dst list time:  0.001537322998046875
time for parepare:  0.0018160343170166016
local_output_nid generation:  0.0015518665313720703
local_in_edges_tensor generation:  0.002857208251953125
mini_batch_src_global generation:  0.002180337905883789
r_  generation:  0.02565455436706543
local_output_nid generation:  0.001703023910522461
local_in_edges_tensor generation:  0.0028498172760009766
mini_batch_src_global generation:  0.002819061279296875
r_  generation:  0.026023149490356445
local_output_nid generation:  0.0018210411071777344
local_in_edges_tensor generation:  0.0022933483123779297
mini_batch_src_global generation:  0.0022246837615966797
r_  generation:  0.024863719940185547
local_output_nid generation:  0.0019080638885498047
local_in_edges_tensor generation:  0.0023975372314453125
mini_batch_src_global generation:  0.002365589141845703
r_  generation:  0.02611851692199707
----------------------check_connections_block total spend ----------------------------- 0.15365004539489746
generate_one_block  0.03282809257507324
generate_one_block  0.03421139717102051
generate_one_block  0.03258252143859863
generate_one_block  0.03302359580993652
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.2811279296875 GB
    Memory Allocated: 0.07286310195922852  GigaBytes
Max Memory Allocated: 2.875619411468506  GigaBytes

connection checking time:  0.35626220703125
block generation total time  0.32892370223999023
average batch blocks generation time:  0.08223092555999756
block dataloader generation time/epoch 0.7817282676696777
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2811279296875 GB
    Memory Allocated: 0.07189655303955078  GigaBytes
Max Memory Allocated: 2.875619411468506  GigaBytes

torch.Size([19129, 500])
torch.Size([16369, 64])
torch.Size([11727, 64])
torch.Size([2723, 64])
torch.Size([720, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2811279296875 GB
    Memory Allocated: 2.815269947052002  GigaBytes
Max Memory Allocated: 2.875619411468506  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2811279296875 GB
    Memory Allocated: 0.07187080383300781  GigaBytes
Max Memory Allocated: 2.875619411468506  GigaBytes

torch.Size([19050, 500])
torch.Size([17031, 64])
torch.Size([11476, 64])
torch.Size([4190, 64])
torch.Size([749, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4412841796875 GB
    Memory Allocated: 2.898836612701416  GigaBytes
Max Memory Allocated: 2.898874282836914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4412841796875 GB
    Memory Allocated: 0.07109355926513672  GigaBytes
Max Memory Allocated: 2.8990540504455566  GigaBytes

torch.Size([18772, 500])
torch.Size([15177, 64])
torch.Size([9033, 64])
torch.Size([2102, 64])
torch.Size([475, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4412841796875 GB
    Memory Allocated: 2.6770191192626953  GigaBytes
Max Memory Allocated: 2.8990540504455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4412841796875 GB
    Memory Allocated: 0.07180118560791016  GigaBytes
Max Memory Allocated: 2.8990540504455566  GigaBytes

torch.Size([19025, 500])
torch.Size([16720, 64])
torch.Size([11255, 64])
torch.Size([3815, 64])
torch.Size([924, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4412841796875 GB
    Memory Allocated: 2.8706798553466797  GigaBytes
Max Memory Allocated: 2.8990540504455566  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.020910978317260742 |0.0028645992279052734 |0.3632403612136841 |0.00014448165893554688 |0.46817755699157715 |0.011914491653442383 |
----------------------------------------------------------pseudo_mini_loss sum 1.5960752964019775
Total (block generation + training)time/epoch 4.228113412857056
Training time/epoch 3.445988178253174
Training time without block to device /epoch 3.4345297813415527
Training time without total dataloading part /epoch 3.3381640911102295
load block tensor time/epoch 0.08364391326904297
block to device time/epoch 0.011458396911621094
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  200818
Number of first layer input nodes during this epoch:  75976
