main start at this time 1648534433.3672624
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008460521697998047  GigaBytes
Max Memory Allocated: 0.008460521697998047  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0021483898162841797
range selection method range initialization spend 0.00010514259338378906
time for parepare:  4.2438507080078125e-05
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0020971298217773438
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  5.364418029785156e-05
----------------------check_connections_block total spend ----------------------------- 0.002737283706665039
generate_one_block  0.0012972354888916016
generate_one_block  0.001043558120727539
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012133121490478516
gen group dst list time:  2.4318695068359375e-05
time for parepare:  0.00023603439331054688
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0007162094116210938
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.00046944618225097656
----------------------check_connections_block total spend ----------------------------- 0.002286195755004883
generate_one_block  0.001972198486328125
generate_one_block  0.001619100570678711
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010538101196289062
gen group dst list time:  5.7697296142578125e-05
time for parepare:  0.0007219314575195312
local_output_nid generation:  0.00010704994201660156
local_in_edges_tensor generation:  0.0004150867462158203
mini_batch_src_global generation:  0.00041413307189941406
r_  generation:  0.004337310791015625
local_output_nid generation:  9.107589721679688e-05
local_in_edges_tensor generation:  0.0002827644348144531
mini_batch_src_global generation:  0.0004527568817138672
r_  generation:  0.003262042999267578
----------------------check_connections_block total spend ----------------------------- 0.012125968933105469
generate_one_block  0.007233858108520508
generate_one_block  0.0053212642669677734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019712448120117188
gen group dst list time:  0.00018143653869628906
time for parepare:  0.0014019012451171875
local_output_nid generation:  0.0003590583801269531
local_in_edges_tensor generation:  0.0010631084442138672
mini_batch_src_global generation:  0.0014395713806152344
r_  generation:  0.013585567474365234
local_output_nid generation:  0.0003898143768310547
local_in_edges_tensor generation:  0.0009334087371826172
mini_batch_src_global generation:  0.0013339519500732422
r_  generation:  0.011809110641479492
----------------------check_connections_block total spend ----------------------------- 0.038604021072387695
generate_one_block  0.02019047737121582
generate_one_block  0.01656174659729004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018315315246582031
gen group dst list time:  0.00045418739318847656
time for parepare:  0.001493215560913086
local_output_nid generation:  0.0009539127349853516
local_in_edges_tensor generation:  0.0019860267639160156
mini_batch_src_global generation:  0.002071380615234375
r_  generation:  0.022704362869262695
local_output_nid generation:  0.0010175704956054688
local_in_edges_tensor generation:  0.0021860599517822266
mini_batch_src_global generation:  0.0024001598358154297
r_  generation:  0.02109527587890625
----------------------check_connections_block total spend ----------------------------- 0.06589913368225098
generate_one_block  0.029300451278686523
generate_one_block  0.027208566665649414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021610260009765625
gen group dst list time:  0.0007410049438476562
time for parepare:  0.0015106201171875
local_output_nid generation:  0.001196146011352539
local_in_edges_tensor generation:  0.0025959014892578125
mini_batch_src_global generation:  0.0020749568939208984
r_  generation:  0.025094985961914062
local_output_nid generation:  0.0014295578002929688
local_in_edges_tensor generation:  0.002562999725341797
mini_batch_src_global generation:  0.0026903152465820312
r_  generation:  0.025145530700683594
----------------------check_connections_block total spend ----------------------------- 0.07523441314697266
generate_one_block  0.031106233596801758
generate_one_block  0.03164172172546387
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008460521697998047  GigaBytes
Max Memory Allocated: 0.008460521697998047  GigaBytes

connection checking time:  0.19414973258972168
block generation total time  0.17215561866760254
average batch blocks generation time:  0.08607780933380127
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1405029296875 GB
    Memory Allocated: 0.04619789123535156  GigaBytes
Max Memory Allocated: 0.04619789123535156  GigaBytes

torch.Size([19356, 500])
torch.Size([17893, 64])
torch.Size([14707, 64])
torch.Size([5732, 64])
torch.Size([1609, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3787841796875 GB
    Memory Allocated: 3.0315189361572266  GigaBytes
Max Memory Allocated: 3.031592845916748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.05460023880004883  GigaBytes
Max Memory Allocated: 3.0317115783691406  GigaBytes

torch.Size([19107, 500])
torch.Size([17413, 64])
torch.Size([12535, 64])
torch.Size([4935, 64])
torch.Size([1172, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 2.9428839683532715  GigaBytes
Max Memory Allocated: 3.0317115783691406  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028502345085144043 |0.17280709743499756 |0.6701828241348267 |0.0002307891845703125 |0.49463438987731934 |0.013504505157470703 |
----------------------------------------------------------pseudo_mini_loss sum 1.8898701667785645
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  114814
Number of first layer input nodes during this epoch:  38463
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.07483768463134766  GigaBytes
Max Memory Allocated: 3.0317115783691406  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005350112915039062
range selection method range initialization spend 5.316734313964844e-05
time for parepare:  5.4836273193359375e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00011324882507324219
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  7.295608520507812e-05
----------------------check_connections_block total spend ----------------------------- 0.0007891654968261719
generate_one_block  0.0012063980102539062
generate_one_block  0.0011591911315917969
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005433559417724609
gen group dst list time:  2.7418136596679688e-05
time for parepare:  0.0002682209014892578
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  7.677078247070312e-05
r_  generation:  0.0006232261657714844
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0006480216979980469
----------------------check_connections_block total spend ----------------------------- 0.002454996109008789
generate_one_block  0.002035856246948242
generate_one_block  0.001972675323486328
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010428428649902344
gen group dst list time:  7.104873657226562e-05
time for parepare:  0.0007042884826660156
local_output_nid generation:  0.0001392364501953125
local_in_edges_tensor generation:  0.0004017353057861328
mini_batch_src_global generation:  0.0003955364227294922
r_  generation:  0.004166603088378906
local_output_nid generation:  0.00013136863708496094
local_in_edges_tensor generation:  0.00030040740966796875
mini_batch_src_global generation:  0.0004763603210449219
r_  generation:  0.005331754684448242
----------------------check_connections_block total spend ----------------------------- 0.014085531234741211
generate_one_block  0.007737874984741211
generate_one_block  0.006516695022583008
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020189285278320312
gen group dst list time:  0.00020432472229003906
time for parepare:  0.0013229846954345703
local_output_nid generation:  0.00041294097900390625
local_in_edges_tensor generation:  0.0012500286102294922
mini_batch_src_global generation:  0.0013210773468017578
r_  generation:  0.014838695526123047
local_output_nid generation:  0.0004303455352783203
local_in_edges_tensor generation:  0.0008594989776611328
mini_batch_src_global generation:  0.0015320777893066406
r_  generation:  0.013433218002319336
----------------------check_connections_block total spend ----------------------------- 0.04240012168884277
generate_one_block  0.02290034294128418
generate_one_block  0.02001333236694336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002960681915283203
gen group dst list time:  0.0005085468292236328
time for parepare:  0.001486063003540039
local_output_nid generation:  0.00104522705078125
local_in_edges_tensor generation:  0.0020813941955566406
mini_batch_src_global generation:  0.002161264419555664
r_  generation:  0.023639440536499023
local_output_nid generation:  0.0011715888977050781
local_in_edges_tensor generation:  0.0022847652435302734
mini_batch_src_global generation:  0.0025687217712402344
r_  generation:  0.02304816246032715
----------------------check_connections_block total spend ----------------------------- 0.07021403312683105
generate_one_block  0.03241705894470215
generate_one_block  0.03239583969116211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002124786376953125
gen group dst list time:  0.0008561611175537109
time for parepare:  0.0016498565673828125
local_output_nid generation:  0.0014111995697021484
local_in_edges_tensor generation:  0.002643108367919922
mini_batch_src_global generation:  0.00188446044921875
r_  generation:  0.02587437629699707
local_output_nid generation:  0.0016582012176513672
local_in_edges_tensor generation:  0.002565145492553711
mini_batch_src_global generation:  0.0027120113372802734
r_  generation:  0.02697157859802246
----------------------check_connections_block total spend ----------------------------- 0.07908344268798828
generate_one_block  0.036368370056152344
generate_one_block  0.03558182716369629
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.07483768463134766  GigaBytes
Max Memory Allocated: 3.0317115783691406  GigaBytes

connection checking time:  0.2082381248474121
block generation total time  0.19793987274169922
average batch blocks generation time:  0.09896993637084961
block dataloader generation time/epoch 0.47051405906677246
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.07259511947631836  GigaBytes
Max Memory Allocated: 3.0317115783691406  GigaBytes

torch.Size([19337, 500])
torch.Size([17943, 64])
torch.Size([14548, 64])
torch.Size([5787, 64])
torch.Size([1404, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6112060546875 GB
    Memory Allocated: 3.0461344718933105  GigaBytes
Max Memory Allocated: 3.046196460723877  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6112060546875 GB
    Memory Allocated: 0.0724492073059082  GigaBytes
Max Memory Allocated: 3.0463337898254395  GigaBytes

torch.Size([19286, 500])
torch.Size([17792, 64])
torch.Size([13502, 64])
torch.Size([5166, 64])
torch.Size([1377, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6112060546875 GB
    Memory Allocated: 3.0174684524536133  GigaBytes
Max Memory Allocated: 3.0463337898254395  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027576684951782227 |0.003648042678833008 |0.4020594358444214 |0.00016629695892333984 |0.522779107093811 |0.012176752090454102 |
----------------------------------------------------------pseudo_mini_loss sum 1.458619236946106
Total (block generation + training)time/epoch 2.4051132202148438
Training time/epoch 1.933844804763794
Training time without block to device /epoch 1.926548719406128
Training time without total dataloading part /epoch 1.8621864318847656
load block tensor time/epoch 0.05515336990356445
block to device time/epoch 0.007296085357666016
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  116497
Number of first layer input nodes during this epoch:  38623
