main start at this time 1648534575.3497953
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0019745826721191406
range selection method range initialization spend 7.43865966796875e-05
time for parepare:  4.482269287109375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.0011823177337646484
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.726119995117188e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.630752563476562e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  2.0265579223632812e-05
----------------------check_connections_block total spend ----------------------------- 0.002742290496826172
generate_one_block  0.0011169910430908203
generate_one_block  0.0010631084442138672
generate_one_block  0.0010228157043457031
generate_one_block  0.0010037422180175781
generate_one_block  0.0010051727294921875
generate_one_block  0.0010197162628173828
generate_one_block  0.0009634494781494141
generate_one_block  0.0009567737579345703
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011458396911621094
gen group dst list time:  4.9114227294921875e-05
time for parepare:  0.0002617835998535156
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  9.417533874511719e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0001590251922607422
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0001914501190185547
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  9.72747802734375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.00024962425231933594
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00025916099548339844
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00014090538024902344
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.000125885009765625
----------------------check_connections_block total spend ----------------------------- 0.0033762454986572266
generate_one_block  0.0011432170867919922
generate_one_block  0.0011620521545410156
generate_one_block  0.0012853145599365234
generate_one_block  0.0011403560638427734
generate_one_block  0.0013141632080078125
generate_one_block  0.0013124942779541016
generate_one_block  0.001173257827758789
generate_one_block  0.0011374950408935547
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001169443130493164
gen group dst list time:  9.34600830078125e-05
time for parepare:  0.0007436275482177734
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0002455711364746094
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0003619194030761719
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0008149147033691406
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.0012688636779785156
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.0006337165832519531
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.00016951560974121094
r_  generation:  0.0019125938415527344
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00025391578674316406
r_  generation:  0.0018308162689208984
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  0.000125885009765625
r_  generation:  0.0009002685546875
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0007503032684326172
----------------------check_connections_block total spend ----------------------------- 0.014137029647827148
generate_one_block  0.0014295578002929688
generate_one_block  0.002026796340942383
generate_one_block  0.0025207996368408203
generate_one_block  0.0017499923706054688
generate_one_block  0.003246307373046875
generate_one_block  0.0033698081970214844
generate_one_block  0.002045869827270508
generate_one_block  0.0018310546875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002064228057861328
gen group dst list time:  0.0002849102020263672
time for parepare:  0.0015408992767333984
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.0004715919494628906
mini_batch_src_global generation:  0.0002548694610595703
r_  generation:  0.0020363330841064453
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.0003056526184082031
mini_batch_src_global generation:  0.0005230903625488281
r_  generation:  0.004269838333129883
local_output_nid generation:  0.0001811981201171875
local_in_edges_tensor generation:  0.0004754066467285156
mini_batch_src_global generation:  0.0008227825164794922
r_  generation:  0.00695490837097168
local_output_nid generation:  0.00010609626770019531
local_in_edges_tensor generation:  0.0002968311309814453
mini_batch_src_global generation:  0.00047779083251953125
r_  generation:  0.0044498443603515625
local_output_nid generation:  0.0001780986785888672
local_in_edges_tensor generation:  0.0004177093505859375
mini_batch_src_global generation:  0.0006816387176513672
r_  generation:  0.006831645965576172
local_output_nid generation:  0.00019598007202148438
local_in_edges_tensor generation:  0.0004591941833496094
mini_batch_src_global generation:  0.0008161067962646484
r_  generation:  0.007303476333618164
local_output_nid generation:  0.000156402587890625
local_in_edges_tensor generation:  0.0003540515899658203
mini_batch_src_global generation:  0.0005240440368652344
r_  generation:  0.004864931106567383
local_output_nid generation:  0.00011992454528808594
local_in_edges_tensor generation:  0.0002956390380859375
mini_batch_src_global generation:  0.00043582916259765625
r_  generation:  0.004061222076416016
----------------------check_connections_block total spend ----------------------------- 0.0614011287689209
generate_one_block  0.0041332244873046875
generate_one_block  0.006588935852050781
generate_one_block  0.010549545288085938
generate_one_block  0.006806850433349609
generate_one_block  0.010096073150634766
generate_one_block  0.011328458786010742
generate_one_block  0.007298469543457031
generate_one_block  0.006446123123168945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002320528030395508
gen group dst list time:  0.0013167858123779297
time for parepare:  0.0018131732940673828
local_output_nid generation:  0.0003712177276611328
local_in_edges_tensor generation:  0.0011925697326660156
mini_batch_src_global generation:  0.0009756088256835938
r_  generation:  0.008424758911132812
local_output_nid generation:  0.0005593299865722656
local_in_edges_tensor generation:  0.0011615753173828125
mini_batch_src_global generation:  0.0014619827270507812
r_  generation:  0.013290166854858398
local_output_nid generation:  0.0007855892181396484
local_in_edges_tensor generation:  0.0025811195373535156
mini_batch_src_global generation:  0.0017533302307128906
r_  generation:  0.018143892288208008
local_output_nid generation:  0.0005247592926025391
local_in_edges_tensor generation:  0.0010027885437011719
mini_batch_src_global generation:  0.0013079643249511719
r_  generation:  0.01364445686340332
local_output_nid generation:  0.0005803108215332031
local_in_edges_tensor generation:  0.001003265380859375
mini_batch_src_global generation:  0.001341104507446289
r_  generation:  0.01459646224975586
local_output_nid generation:  0.0006458759307861328
local_in_edges_tensor generation:  0.0011138916015625
mini_batch_src_global generation:  0.0014224052429199219
r_  generation:  0.015790462493896484
local_output_nid generation:  0.0005955696105957031
local_in_edges_tensor generation:  0.0010190010070800781
mini_batch_src_global generation:  0.0013806819915771484
r_  generation:  0.015283823013305664
local_output_nid generation:  0.000583648681640625
local_in_edges_tensor generation:  0.0010068416595458984
mini_batch_src_global generation:  0.0011484622955322266
r_  generation:  0.012445688247680664
----------------------check_connections_block total spend ----------------------------- 0.16558623313903809
generate_one_block  0.012339353561401367
generate_one_block  0.017796993255615234
generate_one_block  0.025016069412231445
generate_one_block  0.018320798873901367
generate_one_block  0.01941657066345215
generate_one_block  0.02120232582092285
generate_one_block  0.02153182029724121
generate_one_block  0.01741647720336914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021522045135498047
gen group dst list time:  0.002885580062866211
time for parepare:  0.0016655921936035156
local_output_nid generation:  0.0009694099426269531
local_in_edges_tensor generation:  0.0020825862884521484
mini_batch_src_global generation:  0.0017547607421875
r_  generation:  0.01878046989440918
local_output_nid generation:  0.0011556148529052734
local_in_edges_tensor generation:  0.002433300018310547
mini_batch_src_global generation:  0.002512693405151367
r_  generation:  0.022471189498901367
local_output_nid generation:  0.0015444755554199219
local_in_edges_tensor generation:  0.002172708511352539
mini_batch_src_global generation:  0.0022764205932617188
r_  generation:  0.025043725967407227
local_output_nid generation:  0.0012884140014648438
local_in_edges_tensor generation:  0.0019142627716064453
mini_batch_src_global generation:  0.0018146038055419922
r_  generation:  0.02195596694946289
local_output_nid generation:  0.001161336898803711
local_in_edges_tensor generation:  0.001683950424194336
mini_batch_src_global generation:  0.0018744468688964844
r_  generation:  0.021222829818725586
local_output_nid generation:  0.0012073516845703125
local_in_edges_tensor generation:  0.0020308494567871094
mini_batch_src_global generation:  0.0017619132995605469
r_  generation:  0.022115230560302734
local_output_nid generation:  0.0013799667358398438
local_in_edges_tensor generation:  0.002238035202026367
mini_batch_src_global generation:  0.002038717269897461
r_  generation:  0.02357625961303711
local_output_nid generation:  0.0011126995086669922
local_in_edges_tensor generation:  0.001779317855834961
mini_batch_src_global generation:  0.0017580986022949219
r_  generation:  0.02074265480041504
----------------------check_connections_block total spend ----------------------------- 0.256899356842041
generate_one_block  0.025050640106201172
generate_one_block  0.028898239135742188
generate_one_block  0.03118443489074707
generate_one_block  0.0279083251953125
generate_one_block  0.027199983596801758
generate_one_block  0.02869415283203125
generate_one_block  0.029592037200927734
generate_one_block  0.026543617248535156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

connection checking time:  0.5013999938964844
block generation total time  0.46924805641174316
average batch blocks generation time:  0.058656007051467896
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.043702125549316406  GigaBytes
Max Memory Allocated: 0.043702125549316406  GigaBytes

torch.Size([17201, 500])
torch.Size([10189, 128])
torch.Size([4272, 128])
torch.Size([693, 128])
torch.Size([203, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5526123046875 GB
    Memory Allocated: 2.2166943550109863  GigaBytes
Max Memory Allocated: 2.2167162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5526123046875 GB
    Memory Allocated: 0.05677175521850586  GigaBytes
Max Memory Allocated: 2.217973232269287  GigaBytes

torch.Size([18227, 500])
torch.Size([13486, 128])
torch.Size([6758, 128])
torch.Size([1419, 128])
torch.Size([382, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0350341796875 GB
    Memory Allocated: 2.691098690032959  GigaBytes
Max Memory Allocated: 2.691129684448242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0369873046875 GB
    Memory Allocated: 0.058310508728027344  GigaBytes
Max Memory Allocated: 2.692047595977783  GigaBytes

torch.Size([18916, 500])
torch.Size([16117, 128])
torch.Size([9550, 128])
torch.Size([2421, 128])
torch.Size([450, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3905029296875 GB
    Memory Allocated: 3.0953774452209473  GigaBytes
Max Memory Allocated: 3.09542179107666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3924560546875 GB
    Memory Allocated: 0.056218624114990234  GigaBytes
Max Memory Allocated: 3.096317768096924  GigaBytes

torch.Size([17929, 500])
torch.Size([12646, 128])
torch.Size([6452, 128])
torch.Size([1207, 128])
torch.Size([250, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3924560546875 GB
    Memory Allocated: 2.6553635597229004  GigaBytes
Max Memory Allocated: 3.096317768096924  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3924560546875 GB
    Memory Allocated: 0.05616331100463867  GigaBytes
Max Memory Allocated: 3.096317768096924  GigaBytes

torch.Size([17335, 500])
torch.Size([12549, 128])
torch.Size([7102, 128])
torch.Size([2237, 128])
torch.Size([474, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4471435546875 GB
    Memory Allocated: 2.7689456939697266  GigaBytes
Max Memory Allocated: 3.096317768096924  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4471435546875 GB
    Memory Allocated: 0.05619668960571289  GigaBytes
Max Memory Allocated: 3.096317768096924  GigaBytes

torch.Size([17818, 500])
torch.Size([13430, 128])
torch.Size([8170, 128])
torch.Size([2542, 128])
torch.Size([565, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4725341796875 GB
    Memory Allocated: 2.876168727874756  GigaBytes
Max Memory Allocated: 3.096317768096924  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4744873046875 GB
    Memory Allocated: 0.05681276321411133  GigaBytes
Max Memory Allocated: 3.096317768096924  GigaBytes

torch.Size([18199, 500])
torch.Size([14701, 128])
torch.Size([6879, 128])
torch.Size([1849, 128])
torch.Size([266, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4744873046875 GB
    Memory Allocated: 2.8395323753356934  GigaBytes
Max Memory Allocated: 3.096317768096924  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4744873046875 GB
    Memory Allocated: 0.05599546432495117  GigaBytes
Max Memory Allocated: 3.096317768096924  GigaBytes

torch.Size([17860, 500])
torch.Size([12119, 128])
torch.Size([6947, 128])
torch.Size([1363, 128])
torch.Size([322, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4744873046875 GB
    Memory Allocated: 2.4864602088928223  GigaBytes
Max Memory Allocated: 3.096317768096924  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02489963173866272 |0.044765204191207886 |0.3976517915725708 |0.00015491247177124023 |0.46970227360725403 |0.01599860191345215 |
----------------------------------------------------------pseudo_mini_loss sum 1.6514091491699219
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  321852
Number of first layer input nodes during this epoch:  143485
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.4744873046875 GB
    Memory Allocated: 0.07941532135009766  GigaBytes
Max Memory Allocated: 3.096317768096924  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007236003875732422
range selection method range initialization spend 6.937980651855469e-05
time for parepare:  7.176399230957031e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  6.079673767089844e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.5497207641601562e-05
----------------------check_connections_block total spend ----------------------------- 0.0018031597137451172
generate_one_block  0.001611948013305664
generate_one_block  0.0010945796966552734
generate_one_block  0.001081228256225586
generate_one_block  0.0010807514190673828
generate_one_block  0.0010387897491455078
generate_one_block  0.0010559558868408203
generate_one_block  0.0010647773742675781
generate_one_block  0.0010328292846679688
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006816387176513672
gen group dst list time:  5.8650970458984375e-05
time for parepare:  0.0003485679626464844
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.000232696533203125
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00025534629821777344
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0001609325408935547
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00024199485778808594
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00010347366333007812
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0002186298370361328
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0001957416534423828
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  9.322166442871094e-05
----------------------check_connections_block total spend ----------------------------- 0.003921985626220703
generate_one_block  0.0014371871948242188
generate_one_block  0.0013883113861083984
generate_one_block  0.0012552738189697266
generate_one_block  0.0015311241149902344
generate_one_block  0.00115966796875
generate_one_block  0.0013642311096191406
generate_one_block  0.0013141632080078125
generate_one_block  0.0011162757873535156
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001201629638671875
gen group dst list time:  0.0001201629638671875
time for parepare:  0.0010194778442382812
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.0003514289855957031
mini_batch_src_global generation:  0.00023651123046875
r_  generation:  0.0016677379608154297
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  0.0002815723419189453
r_  generation:  0.0016934871673583984
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  0.00014662742614746094
r_  generation:  0.0009281635284423828
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  0.00018405914306640625
r_  generation:  0.0017099380493164062
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0005877017974853516
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.00013589859008789062
r_  generation:  0.0012631416320800781
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.001077413558959961
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0004215240478515625
----------------------check_connections_block total spend ----------------------------- 0.016591310501098633
generate_one_block  0.003683805465698242
generate_one_block  0.0031273365020751953
generate_one_block  0.0023071765899658203
generate_one_block  0.003412485122680664
generate_one_block  0.0017261505126953125
generate_one_block  0.0027565956115722656
generate_one_block  0.002321958541870117
generate_one_block  0.001478433609008789
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002252340316772461
gen group dst list time:  0.00037360191345214844
time for parepare:  0.001592874526977539
local_output_nid generation:  0.00036406517028808594
local_in_edges_tensor generation:  0.0009806156158447266
mini_batch_src_global generation:  0.0011582374572753906
r_  generation:  0.008850574493408203
local_output_nid generation:  0.00018310546875
local_in_edges_tensor generation:  0.0004076957702636719
mini_batch_src_global generation:  0.000698089599609375
r_  generation:  0.006021261215209961
local_output_nid generation:  0.00020003318786621094
local_in_edges_tensor generation:  0.00040459632873535156
mini_batch_src_global generation:  0.0005459785461425781
r_  generation:  0.005187273025512695
local_output_nid generation:  0.00026488304138183594
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0007562637329101562
r_  generation:  0.007184743881225586
local_output_nid generation:  0.00010561943054199219
local_in_edges_tensor generation:  0.00029468536376953125
mini_batch_src_global generation:  0.0004620552062988281
r_  generation:  0.0035636425018310547
local_output_nid generation:  0.00021839141845703125
local_in_edges_tensor generation:  0.0009286403656005859
mini_batch_src_global generation:  0.0005698204040527344
r_  generation:  0.006132602691650391
local_output_nid generation:  0.00017213821411132812
local_in_edges_tensor generation:  0.0003600120544433594
mini_batch_src_global generation:  0.0005488395690917969
r_  generation:  0.00513148307800293
local_output_nid generation:  7.653236389160156e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  0.0003540515899658203
r_  generation:  0.0025911331176757812
----------------------check_connections_block total spend ----------------------------- 0.06823897361755371
generate_one_block  0.013039112091064453
generate_one_block  0.008982658386230469
generate_one_block  0.00818324089050293
generate_one_block  0.011035442352294922
generate_one_block  0.006111621856689453
generate_one_block  0.00986480712890625
generate_one_block  0.008386611938476562
generate_one_block  0.004690885543823242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002378225326538086
gen group dst list time:  0.0013966560363769531
time for parepare:  0.0017609596252441406
local_output_nid generation:  0.001010894775390625
local_in_edges_tensor generation:  0.0020558834075927734
mini_batch_src_global generation:  0.001941680908203125
r_  generation:  0.020603418350219727
local_output_nid generation:  0.0006535053253173828
local_in_edges_tensor generation:  0.0010631084442138672
mini_batch_src_global generation:  0.0017554759979248047
r_  generation:  0.013763904571533203
local_output_nid generation:  0.0007870197296142578
local_in_edges_tensor generation:  0.0011546611785888672
mini_batch_src_global generation:  0.0013332366943359375
r_  generation:  0.01555633544921875
local_output_nid generation:  0.000965118408203125
local_in_edges_tensor generation:  0.0012214183807373047
mini_batch_src_global generation:  0.0016901493072509766
r_  generation:  0.017484664916992188
local_output_nid generation:  0.0006422996520996094
local_in_edges_tensor generation:  0.0008618831634521484
mini_batch_src_global generation:  0.0010983943939208984
r_  generation:  0.012553691864013672
local_output_nid generation:  0.001066446304321289
local_in_edges_tensor generation:  0.0012159347534179688
mini_batch_src_global generation:  0.0014712810516357422
r_  generation:  0.0178830623626709
local_output_nid generation:  0.0009679794311523438
local_in_edges_tensor generation:  0.0014643669128417969
mini_batch_src_global generation:  0.0013442039489746094
r_  generation:  0.015775680541992188
local_output_nid generation:  0.0005810260772705078
local_in_edges_tensor generation:  0.0007157325744628906
mini_batch_src_global generation:  0.0009508132934570312
r_  generation:  0.010534048080444336
----------------------check_connections_block total spend ----------------------------- 0.18201565742492676
generate_one_block  0.028181791305541992
generate_one_block  0.019518613815307617
generate_one_block  0.021348953247070312
generate_one_block  0.023853540420532227
generate_one_block  0.019021272659301758
generate_one_block  0.02463364601135254
generate_one_block  0.02051520347595215
generate_one_block  0.014737606048583984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018434524536132812
gen group dst list time:  0.0028738975524902344
time for parepare:  0.0017211437225341797
local_output_nid generation:  0.0016238689422607422
local_in_edges_tensor generation:  0.0026230812072753906
mini_batch_src_global generation:  0.002360105514526367
r_  generation:  0.025604724884033203
local_output_nid generation:  0.0011811256408691406
local_in_edges_tensor generation:  0.0021791458129882812
mini_batch_src_global generation:  0.0024132728576660156
r_  generation:  0.02080082893371582
local_output_nid generation:  0.0014295578002929688
local_in_edges_tensor generation:  0.0028390884399414062
mini_batch_src_global generation:  0.001863241195678711
r_  generation:  0.023381948471069336
local_output_nid generation:  0.0015416145324707031
local_in_edges_tensor generation:  0.002482175827026367
mini_batch_src_global generation:  0.0018396377563476562
r_  generation:  0.023710966110229492
local_output_nid generation:  0.0012447834014892578
local_in_edges_tensor generation:  0.0015833377838134766
mini_batch_src_global generation:  0.001737833023071289
r_  generation:  0.02073383331298828
local_output_nid generation:  0.001607656478881836
local_in_edges_tensor generation:  0.0019779205322265625
mini_batch_src_global generation:  0.0020780563354492188
r_  generation:  0.02382636070251465
local_output_nid generation:  0.0013461112976074219
local_in_edges_tensor generation:  0.0021562576293945312
mini_batch_src_global generation:  0.0018718242645263672
r_  generation:  0.02338409423828125
local_output_nid generation:  0.001049041748046875
local_in_edges_tensor generation:  0.0015704631805419922
mini_batch_src_global generation:  0.0017323493957519531Using backend: pytorch

r_  generation:  0.020025968551635742
----------------------check_connections_block total spend ----------------------------- 0.2662539482116699
generate_one_block  0.03376889228820801
generate_one_block  0.029236793518066406
generate_one_block  0.030438661575317383
generate_one_block  0.030879735946655273
generate_one_block  0.028107166290283203
generate_one_block  0.03124833106994629
generate_one_block  0.030570030212402344
generate_one_block  0.02683424949645996
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.4744873046875 GB
    Memory Allocated: 0.07941532135009766  GigaBytes
Max Memory Allocated: 3.096317768096924  GigaBytes

connection checking time:  0.5370218753814697
block generation total time  0.5145690441131592
average batch blocks generation time:  0.0643211305141449
block dataloader generation time/epoch 1.24049711227417
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4744873046875 GB
    Memory Allocated: 0.08030366897583008  GigaBytes
Max Memory Allocated: 3.096317768096924  GigaBytes

torch.Size([18919, 500])
torch.Size([16795, 128])
torch.Size([9884, 128])
torch.Size([3074, 128])
torch.Size([466, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6209716796875 GB
    Memory Allocated: 3.2163705825805664  GigaBytes
Max Memory Allocated: 3.2164149284362793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 0.07644128799438477  GigaBytes
Max Memory Allocated: 3.217311382293701  GigaBytes

torch.Size([17001, 500])
torch.Size([11950, 128])
torch.Size([5841, 128])
torch.Size([1690, 128])
torch.Size([410, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 2.6386895179748535  GigaBytes
Max Memory Allocated: 3.217311382293701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 0.0782003402709961  GigaBytes
Max Memory Allocated: 3.217311382293701  GigaBytes

torch.Size([17929, 500])
torch.Size([13740, 128])
torch.Size([6548, 128])
torch.Size([1825, 128])
torch.Size([255, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 2.783843517303467  GigaBytes
Max Memory Allocated: 3.217311382293701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 0.0786747932434082  GigaBytes
Max Memory Allocated: 3.217311382293701  GigaBytes

torch.Size([18107, 500])
torch.Size([14317, 128])
torch.Size([8448, 128])
torch.Size([2429, 128])
torch.Size([478, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 2.9722375869750977  GigaBytes
Max Memory Allocated: 3.217311382293701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 0.07642507553100586  GigaBytes
Max Memory Allocated: 3.217311382293701  GigaBytes

torch.Size([17064, 500])
torch.Size([11057, 128])
torch.Size([5317, 128])
torch.Size([943, 128])
torch.Size([211, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 2.4820117950439453  GigaBytes
Max Memory Allocated: 3.217311382293701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 0.07928991317749023  GigaBytes
Max Memory Allocated: 3.217311382293701  GigaBytes

torch.Size([18453, 500])
torch.Size([14577, 128])
torch.Size([8711, 128])
torch.Size([1864, 128])
torch.Size([476, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 2.9663443565368652  GigaBytes
Max Memory Allocated: 3.217311382293701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 0.07950735092163086  GigaBytes
Max Memory Allocated: 3.217311382293701  GigaBytes

torch.Size([18640, 500])
torch.Size([13927, 128])
torch.Size([8558, 128])
torch.Size([1670, 128])
torch.Size([428, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 2.7920126914978027  GigaBytes
Max Memory Allocated: 3.217311382293701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 0.07627344131469727  GigaBytes
Max Memory Allocated: 3.217311382293701  GigaBytes

torch.Size([17042, 500])
torch.Size([10137, 128])
torch.Size([4794, 128])
torch.Size([695, 128])
torch.Size([180, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6229248046875 GB
    Memory Allocated: 2.295584201812744  GigaBytes
Max Memory Allocated: 3.217311382293701  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01683780550956726 |0.0035129785537719727 |0.3299487233161926 |0.00014153122901916504 |0.4755867123603821 |0.012417316436767578 |
----------------------------------------------------------pseudo_mini_loss sum 2.182244062423706
Total (block generation + training)time/epoch 7.885728597640991
Training time/epoch 6.644968748092651
Training time without block to device /epoch 6.616864919662476
Training time without total dataloading part /epoch 6.4578330516815186
load block tensor time/epoch 0.13470244407653809
block to device time/epoch 0.02810382843017578
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  325206
Number of first layer input nodes during this epoch:  143155
