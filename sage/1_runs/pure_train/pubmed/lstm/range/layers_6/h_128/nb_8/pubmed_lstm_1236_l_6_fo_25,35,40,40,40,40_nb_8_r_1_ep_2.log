main start at this time 1648534556.3244715
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0015897750854492188
range selection method range initialization spend 8.106231689453125e-05
time for parepare:  4.9114227294921875e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0016934871673583984
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.3392181396484375e-05
----------------------check_connections_block total spend ----------------------------- 0.0027923583984375
generate_one_block  0.0012674331665039062
generate_one_block  0.0010952949523925781
generate_one_block  0.001104116439819336
generate_one_block  0.0010821819305419922
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009176731109619141
gen group dst list time:  3.4809112548828125e-05
time for parepare:  0.0002510547637939453
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0002586841583251953
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0002865791320800781
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0004181861877441406
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00040078163146972656
----------------------check_connections_block total spend ----------------------------- 0.0029501914978027344
generate_one_block  0.001390695571899414
generate_one_block  0.0014123916625976562
generate_one_block  0.0015554428100585938
generate_one_block  0.0015816688537597656
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011305809020996094
gen group dst list time:  7.414817810058594e-05
time for parepare:  0.000797271728515625
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00028967857360839844
mini_batch_src_global generation:  0.00010824203491210938
r_  generation:  0.0012211799621582031
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00020956993103027344
mini_batch_src_global generation:  0.0001933574676513672
r_  generation:  0.0017931461334228516
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  0.0002942085266113281
r_  generation:  0.0027751922607421875
local_output_nid generation:  7.915496826171875e-05
local_in_edges_tensor generation:  0.0002589225769042969
mini_batch_src_global generation:  0.0003170967102050781
r_  generation:  0.0031044483184814453
----------------------check_connections_block total spend ----------------------------- 0.014272928237915039
generate_one_block  0.0026023387908935547
generate_one_block  0.003054380416870117
generate_one_block  0.004271984100341797
generate_one_block  0.0046656131744384766
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019202232360839844
gen group dst list time:  0.00023698806762695312
time for parepare:  0.0014581680297851562
local_output_nid generation:  0.00014638900756835938
local_in_edges_tensor generation:  0.0006427764892578125
mini_batch_src_global generation:  0.000705718994140625
r_  generation:  0.005728483200073242
local_output_nid generation:  0.00023674964904785156
local_in_edges_tensor generation:  0.0005538463592529297
mini_batch_src_global generation:  0.0011830329895019531
r_  generation:  0.008985280990600586
local_output_nid generation:  0.0002472400665283203
local_in_edges_tensor generation:  0.0005631446838378906
mini_batch_src_global generation:  0.0010209083557128906
r_  generation:  0.01020503044128418
local_output_nid generation:  0.00037789344787597656
local_in_edges_tensor generation:  0.0008771419525146484
mini_batch_src_global generation:  0.001323699951171875
r_  generation:  0.013087272644042969
----------------------check_connections_block total spend ----------------------------- 0.056799888610839844
generate_one_block  0.00863790512084961
generate_one_block  0.012192249298095703
generate_one_block  0.013717174530029297
generate_one_block  0.018201351165771484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001710653305053711
gen group dst list time:  0.0007898807525634766
time for parepare:  0.0018405914306640625
local_output_nid generation:  0.0007236003875732422
local_in_edges_tensor generation:  0.0015256404876708984
mini_batch_src_global generation:  0.0016083717346191406
r_  generation:  0.016739368438720703
local_output_nid generation:  0.0009124279022216797
local_in_edges_tensor generation:  0.001943826675415039
mini_batch_src_global generation:  0.0024411678314208984
r_  generation:  0.020904541015625
local_output_nid generation:  0.0009667873382568359
local_in_edges_tensor generation:  0.0013511180877685547
mini_batch_src_global generation:  0.0018379688262939453
r_  generation:  0.020257949829101562
local_output_nid generation:  0.0011563301086425781
local_in_edges_tensor generation:  0.0018415451049804688
mini_batch_src_global generation:  0.002153635025024414
r_  generation:  0.02256178855895996
----------------------check_connections_block total spend ----------------------------- 0.11929559707641602
generate_one_block  0.02071976661682129
generate_one_block  0.02907085418701172
generate_one_block  0.02597784996032715
generate_one_block  0.02890467643737793
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018193721771240234
gen group dst list time:  0.0014376640319824219
time for parepare:  0.0017788410186767578
local_output_nid generation:  0.0013158321380615234
local_in_edges_tensor generation:  0.0024895668029785156
mini_batch_src_global generation:  0.002081155776977539
r_  generation:  0.023959636688232422
local_output_nid generation:  0.001455545425415039
local_in_edges_tensor generation:  0.0025353431701660156
mini_batch_src_global generation:  0.00270843505859375
r_  generation:  0.02587747573852539
local_output_nid generation:  0.0015287399291992188
local_in_edges_tensor generation:  0.0023195743560791016
mini_batch_src_global generation:  0.0019922256469726562
r_  generation:  0.024836063385009766
local_output_nid generation:  0.0016071796417236328
local_in_edges_tensor generation:  0.002553224563598633
mini_batch_src_global generation:  0.0019991397857666016
r_  generation:  0.0267484188079834
----------------------check_connections_block total spend ----------------------------- 0.14958667755126953
generate_one_block  0.029868364334106445
generate_one_block  0.033310651779174805
generate_one_block  0.031775474548339844
generate_one_block  0.032189369201660156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

connection checking time:  0.34290528297424316
block generation total time  0.3051002025604248
average batch blocks generation time:  0.0762750506401062
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1405029296875 GB
    Memory Allocated: 0.047188758850097656  GigaBytes
Max Memory Allocated: 0.047188758850097656  GigaBytes

torch.Size([18631, 500])
torch.Size([14647, 128])
torch.Size([8607, 128])
torch.Size([1936, 128])
torch.Size([574, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1834716796875 GB
    Memory Allocated: 2.873192310333252  GigaBytes
Max Memory Allocated: 2.873239040374756  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 0.058653831481933594  GigaBytes
Max Memory Allocated: 2.8741326332092285  GigaBytes

torch.Size([19049, 500])
torch.Size([16740, 128])
torch.Size([10914, 128])
torch.Size([3029, 128])
torch.Size([626, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5721435546875 GB
    Memory Allocated: 3.233112335205078  GigaBytes
Max Memory Allocated: 3.233168125152588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5740966796875 GB
    Memory Allocated: 0.05834817886352539  GigaBytes
Max Memory Allocated: 3.234041690826416  GigaBytes

torch.Size([18786, 500])
torch.Size([15521, 128])
torch.Size([10183, 128])
torch.Size([3235, 128])
torch.Size([771, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6717529296875 GB
    Memory Allocated: 3.199648857116699  GigaBytes
Max Memory Allocated: 3.234041690826416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6717529296875 GB
    Memory Allocated: 0.059020042419433594  GigaBytes
Max Memory Allocated: 3.234041690826416  GigaBytes

torch.Size([19151, 500])
torch.Size([17101, 128])
torch.Size([12647, 128])
torch.Size([4495, 128])
torch.Size([924, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8436279296875 GB
    Memory Allocated: 3.4285783767700195  GigaBytes
Max Memory Allocated: 3.4286437034606934  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023908019065856934 |0.08810508251190186 |0.5384811162948608 |0.0001868605613708496 |0.5163650512695312 |0.015754222869873047 |
----------------------------------------------------------pseudo_mini_loss sum 1.5921303033828735
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  197924
Number of first layer input nodes during this epoch:  75617
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.8455810546875 GB
    Memory Allocated: 0.08411931991577148  GigaBytes
Max Memory Allocated: 3.429500102996826  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0009698867797851562
range selection method range initialization spend 9.012222290039062e-05
time for parepare:  7.700920104980469e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0002288818359375
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0002224445343017578
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  6.079673767089844e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  3.62396240234375e-05
----------------------check_connections_block total spend ----------------------------- 0.0015377998352050781
generate_one_block  0.0019800662994384766
generate_one_block  0.0013937950134277344
generate_one_block  0.0013611316680908203
generate_one_block  0.0015120506286621094
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007853507995605469
gen group dst list time:  4.9591064453125e-05
time for parepare:  0.0003895759582519531
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0002465248107910156
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0005517005920410156
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0002918243408203125
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.00048732757568359375
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0003628730773925781
----------------------check_connections_block total spend ----------------------------- 0.003831624984741211
generate_one_block  0.0021810531616210938
generate_one_block  0.0016908645629882812
generate_one_block  0.002092123031616211
generate_one_block  0.0018663406372070312
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001275777816772461
gen group dst list time:  0.00010943412780761719
time for parepare:  0.001110076904296875
local_output_nid generation:  0.00014710426330566406
local_in_edges_tensor generation:  0.0004100799560546875
mini_batch_src_global generation:  0.0005090236663818359
r_  generation:  0.0036745071411132812
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.0002257823944091797
mini_batch_src_global generation:  0.0002474784851074219
r_  generation:  0.0015492439270019531
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.00029730796813964844
mini_batch_src_global generation:  0.0003285408020019531
r_  generation:  0.003389120101928711
local_output_nid generation:  9.1552734375e-05
local_in_edges_tensor generation:  0.00026988983154296875
mini_batch_src_global generation:  0.0002624988555908203
r_  generation:  0.0015981197357177734
----------------------check_connections_block total spend ----------------------------- 0.017288923263549805
generate_one_block  0.006023406982421875
generate_one_block  0.0027358531951904297
generate_one_block  0.004749774932861328
generate_one_block  0.0032892227172851562
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0022187232971191406
gen group dst list time:  0.0003390312194824219
time for parepare:  0.0017404556274414062
local_output_nid generation:  0.00040984153747558594
local_in_edges_tensor generation:  0.0010056495666503906
mini_batch_src_global generation:  0.0012068748474121094
r_  generation:  0.011943340301513672
local_output_nid generation:  0.000255584716796875
local_in_edges_tensor generation:  0.0005056858062744141
mini_batch_src_global generation:  0.0008356571197509766
r_  generation:  0.00716400146484375
local_output_nid generation:  0.0003330707550048828
local_in_edges_tensor generation:  0.0005948543548583984
mini_batch_src_global generation:  0.0009436607360839844
r_  generation:  0.011041879653930664
local_output_nid generation: Using backend: pytorch
 0.000278472900390625
local_in_edges_tensor generation:  0.0005147457122802734
mini_batch_src_global generation:  0.0009210109710693359
r_  generation:  0.008063554763793945
----------------------check_connections_block total spend ----------------------------- 0.0574650764465332
generate_one_block  0.016918420791625977
generate_one_block  0.011912107467651367
generate_one_block  0.015966415405273438
generate_one_block  0.014371633529663086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016651153564453125
gen group dst list time:  0.0007953643798828125
time for parepare:  0.0016775131225585938
local_output_nid generation:  0.0010118484497070312
local_in_edges_tensor generation:  0.001878499984741211
mini_batch_src_global generation:  0.00199127197265625
r_  generation:  0.021912336349487305
local_output_nid generation:  0.0008931159973144531
local_in_edges_tensor generation:  0.0018427371978759766
mini_batch_src_global generation:  0.0022928714752197266
r_  generation:  0.018821001052856445
local_output_nid generation:  0.0011632442474365234
local_in_edges_tensor generation:  0.001916646957397461
mini_batch_src_global generation:  0.0016813278198242188
r_  generation:  0.02103877067565918
local_output_nid generation:  0.0012204647064208984
local_in_edges_tensor generation:  0.0015039443969726562
mini_batch_src_global generation:  0.001851797103881836
r_  generation:  0.021001815795898438
----------------------check_connections_block total spend ----------------------------- 0.12265992164611816
generate_one_block  0.030510902404785156
generate_one_block  0.02732992172241211
generate_one_block  0.029053926467895508
generate_one_block  0.028448104858398438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017588138580322266
gen group dst list time:  0.0015516281127929688
time for parepare:  0.0017850399017333984
local_output_nid generation:  0.0015981197357177734
local_in_edges_tensor generation:  0.0025544166564941406
mini_batch_src_global generation:  0.002204418182373047
r_  generation:  0.02616739273071289
local_output_nid generation:  0.0015645027160644531
local_in_edges_tensor generation:  0.002307415008544922
mini_batch_src_global generation:  0.002625703811645508
r_  generation:  0.024802207946777344
local_output_nid generation:  0.0016813278198242188
local_in_edges_tensor generation:  0.002643585205078125
mini_batch_src_global generation:  0.002022981643676758
r_  generation:  0.02533578872680664
local_output_nid generation:  0.0016369819641113281
local_in_edges_tensor generation:  0.0022356510162353516
mini_batch_src_global generation:  0.0019855499267578125
r_  generation:  0.025526762008666992
----------------------check_connections_block total spend ----------------------------- 0.15055108070373535
generate_one_block  0.03398871421813965
generate_one_block  0.0340421199798584
generate_one_block  0.03334474563598633
generate_one_block  0.03381538391113281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.8455810546875 GB
    Memory Allocated: 0.08411931991577148  GigaBytes
Max Memory Allocated: 3.429500102996826  GigaBytes

connection checking time:  0.35179662704467773
block generation total time  0.33433103561401367
average batch blocks generation time:  0.08358275890350342
block dataloader generation time/epoch 0.7968144416809082
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8455810546875 GB
    Memory Allocated: 0.08108329772949219  GigaBytes
Max Memory Allocated: 3.429500102996826  GigaBytes

torch.Size([19033, 500])
torch.Size([17128, 128])
torch.Size([11153, 128])
torch.Size([4063, 128])
torch.Size([834, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8455810546875 GB
    Memory Allocated: 3.386411190032959  GigaBytes
Max Memory Allocated: 3.429500102996826  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8455810546875 GB
    Memory Allocated: 0.0805215835571289  GigaBytes
Max Memory Allocated: 3.429500102996826  GigaBytes

torch.Size([18548, 500])
torch.Size([15190, 128])
torch.Size([8708, 128])
torch.Size([2462, 128])
torch.Size([419, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8455810546875 GB
    Memory Allocated: 3.0197596549987793  GigaBytes
Max Memory Allocated: 3.429500102996826  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8455810546875 GB
    Memory Allocated: 0.08124780654907227  GigaBytes
Max Memory Allocated: 3.429500102996826  GigaBytes

torch.Size([18777, 500])
torch.Size([16144, 128])
torch.Size([10955, 128])
torch.Size([3535, 128])
torch.Size([868, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8455810546875 GB
    Memory Allocated: 3.288935661315918  GigaBytes
Max Memory Allocated: 3.429500102996826  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8455810546875 GB
    Memory Allocated: 0.08094930648803711  GigaBytes
Max Memory Allocated: 3.429500102996826  GigaBytes

torch.Size([19049, 500])
torch.Size([15871, 128])
torch.Size([11263, 128])
torch.Size([2520, 128])
torch.Size([705, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8455810546875 GB
    Memory Allocated: 3.179074287414551  GigaBytes
Max Memory Allocated: 3.429500102996826  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01618093252182007 |0.0034137964248657227 |0.3690856099128723 |0.0001723766326904297 |0.5175116658210754 |0.012137174606323242 |
----------------------------------------------------------pseudo_mini_loss sum 1.7193825244903564
Total (block generation + training)time/epoch 4.453613042831421
Training time/epoch 3.656308889389038
Training time without block to device /epoch 3.642653703689575
Training time without total dataloading part /epoch 3.559215784072876
load block tensor time/epoch 0.06472373008728027
block to device time/epoch 0.01365518569946289
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  197581
Number of first layer input nodes during this epoch:  75407
