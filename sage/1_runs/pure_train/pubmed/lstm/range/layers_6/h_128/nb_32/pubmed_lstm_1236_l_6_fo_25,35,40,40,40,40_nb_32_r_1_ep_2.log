main start at this time 1648534600.865438
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0012996196746826172
range selection method range initialization spend 9.107589721679688e-05
time for parepare:  4.744529724121094e-05
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.0012052059173583984
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2172927856445312e-05
----------------------check_connections_block total spend ----------------------------- 0.003984928131103516
generate_one_block  0.0011897087097167969
generate_one_block  0.0010445117950439453
generate_one_block  0.0010900497436523438
generate_one_block  0.0010199546813964844
generate_one_block  0.0010325908660888672
generate_one_block  0.001043558120727539
generate_one_block  0.001024484634399414
generate_one_block  0.0010325908660888672
generate_one_block  0.001026153564453125
generate_one_block  0.0010385513305664062
generate_one_block  0.001085519790649414
generate_one_block  0.00098419189453125
generate_one_block  0.0009713172912597656
generate_one_block  0.0009467601776123047
generate_one_block  0.0009486675262451172
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009636878967285156
gen group dst list time:  8.392333984375e-05
time for parepare:  0.0002918243408203125
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.651878356933594e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001480579376220703
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00017189979553222656
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.845329284667969e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0001926422119140625
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  8.296966552734375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00021529197692871094
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  9.608268737792969e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00013184547424316406
----------------------check_connections_block total spend ----------------------------- 0.004734992980957031
generate_one_block  0.0011036396026611328
generate_one_block  0.0011525154113769531
generate_one_block  0.0012311935424804688
generate_one_block  0.0010724067687988281
generate_one_block  0.0010905265808105469
generate_one_block  0.0012581348419189453
generate_one_block  0.0011017322540283203
generate_one_block  0.0010919570922851562
generate_one_block  0.0011453628540039062
generate_one_block  0.0013141632080078125
generate_one_block  0.00102996826171875
generate_one_block  0.001201629638671875
generate_one_block  0.0009870529174804688
generate_one_block  0.0010385513305664062
generate_one_block  0.0011115074157714844
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012273788452148438
gen group dst list time:  0.00012731552124023438
time for parepare:  0.0007724761962890625
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00018787384033203125
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00024127960205078125
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  7.677078247070312e-05
r_  generation:  0.0007288455963134766
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00020956993103027344
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.00030350685119628906
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  0.00010848045349121094
r_  generation:  0.0010495185852050781
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0003883838653564453
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00032019615173339844
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0006220340728759766
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  0.00017976760864257812
r_  generation:  0.0015401840209960938
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.0004987716674804688
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  0.0001506805419921875
r_  generation:  0.0016107559204101562
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  7.677078247070312e-05
r_  generation:  0.0002467632293701172
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  7.748603820800781e-05
r_  generation:  0.0007259845733642578
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0008411407470703125
----------------------check_connections_block total spend ----------------------------- 0.01716780662536621
generate_one_block  0.0014145374298095703
generate_one_block  0.0012860298156738281
generate_one_block  0.0017697811126708984
generate_one_block  0.001161813735961914
generate_one_block  0.0012943744659423828
generate_one_block  0.002185821533203125
generate_one_block  0.0013926029205322266
generate_one_block  0.001298666000366211
generate_one_block  0.001998424530029297
generate_one_block  0.002651691436767578
generate_one_block  0.0014803409576416016
generate_one_block  0.002830982208251953
generate_one_block  0.0011792182922363281
generate_one_block  0.0018186569213867188
generate_one_block  0.0018351078033447266
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0017468929290771484
gen group dst list time:  0.0003173351287841797
time for parepare:  0.0017271041870117188
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0003533363342285156
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.0009138584136962891
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  0.00020456314086914062
r_  generation:  0.001512289047241211
local_output_nid generation:  0.00010228157043457031
local_in_edges_tensor generation:  0.0003039836883544922
mini_batch_src_global generation:  0.0004532337188720703
r_  generation:  0.003989219665527344
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  0.00017976760864257812
r_  generation:  0.0010251998901367188
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  0.00023651123046875
r_  generation:  0.0026695728302001953
local_output_nid generation:  0.0001666545867919922
local_in_edges_tensor generation:  0.00039458274841308594
mini_batch_src_global generation:  0.0006070137023925781
r_  generation:  0.005712270736694336
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.0002334117889404297
mini_batch_src_global generation:  0.00033855438232421875
r_  generation:  0.002757549285888672
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.0002796649932861328
r_  generation:  0.002234220504760742
local_output_nid generation:  0.00011134147644042969
local_in_edges_tensor generation:  0.00027632713317871094
mini_batch_src_global generation:  0.00037932395935058594
r_  generation:  0.004045724868774414
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.00032258033752441406
mini_batch_src_global generation:  0.0005447864532470703
r_  generation:  0.0050237178802490234
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.0002262592315673828
mini_batch_src_global generation:  0.00036907196044921875
r_  generation:  0.0029404163360595703
local_output_nid generation:  0.0001709461212158203
local_in_edges_tensor generation:  0.0003650188446044922
mini_batch_src_global generation:  0.0005128383636474609
r_  generation:  0.005716085433959961
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.0012214183807373047
local_output_nid generation:  0.0001347064971923828
local_in_edges_tensor generation:  0.0002963542938232422
mini_batch_src_global generation:  0.0003135204315185547
r_  generation:  0.003773212432861328
local_output_nid generation:  0.00011873245239257812
local_in_edges_tensor generation:  0.0002925395965576172
mini_batch_src_global generation:  0.0004177093505859375
r_  generation:  0.004064083099365234
----------------------check_connections_block total spend ----------------------------- 0.0727074146270752
generate_one_block  0.00316619873046875
generate_one_block  0.0028617382049560547
generate_one_block  0.006127357482910156
generate_one_block  0.0019903182983398438
generate_one_block  0.004259824752807617
generate_one_block  0.008055686950683594
generate_one_block  0.0045850276947021484
generate_one_block  0.0040781497955322266
generate_one_block  0.006534576416015625
generate_one_block  0.00787043571472168
generate_one_block  0.0049855709075927734
generate_one_block  0.00897669792175293
generate_one_block  0.0024995803833007812
generate_one_block  0.0058307647705078125
generate_one_block  0.006470203399658203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021491050720214844
gen group dst list time:  0.0016427040100097656
time for parepare:  0.0018858909606933594
local_output_nid generation:  0.0001938343048095703
local_in_edges_tensor generation:  0.0007853507995605469
mini_batch_src_global generation:  0.0005054473876953125
r_  generation:  0.004458427429199219
local_output_nid generation:  0.0003142356872558594
local_in_edges_tensor generation:  0.0005733966827392578
mini_batch_src_global generation:  0.0008134841918945312
r_  generation:  0.0067517757415771484
local_output_nid generation:  0.0005481243133544922
local_in_edges_tensor generation:  0.001260995864868164
mini_batch_src_global generation:  0.0011954307556152344
r_  generation:  0.013441085815429688
local_output_nid generation:  0.00015282630920410156
local_in_edges_tensor generation:  0.0003323554992675781
mini_batch_src_global generation:  0.0005550384521484375
r_  generation:  0.0034766197204589844
local_output_nid generation:  0.0003998279571533203
local_in_edges_tensor generation:  0.0006992816925048828
mini_batch_src_global generation:  0.0007596015930175781
r_  generation:  0.008646488189697266
local_output_nid generation:  0.0006954669952392578
local_in_edges_tensor generation:  0.0012514591217041016
mini_batch_src_global generation:  0.001920461654663086
r_  generation:  0.01768207550048828
local_output_nid generation:  0.00042247772216796875
local_in_edges_tensor generation:  0.0006787776947021484
mini_batch_src_global generation:  0.0010280609130859375
r_  generation:  0.010336160659790039
local_output_nid generation:  0.0004494190216064453
local_in_edges_tensor generation:  0.0007040500640869141
mini_batch_src_global generation:  0.0009675025939941406
r_  generation:  0.010531425476074219
local_output_nid generation:  0.0005407333374023438
local_in_edges_tensor generation:  0.0009496212005615234
mini_batch_src_global generation:  0.0010371208190917969
r_  generation:  0.013833284378051758
local_output_nid generation:  0.0004749298095703125
local_in_edges_tensor generation:  0.0008001327514648438
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.011686563491821289
local_output_nid generation:  0.0005400180816650391
local_in_edges_tensor generation:  0.0008060932159423828
mini_batch_src_global generation:  0.0009143352508544922
r_  generation:  0.012466669082641602
local_output_nid generation:  0.0004987716674804688
local_in_edges_tensor generation:  0.0024688243865966797
mini_batch_src_global generation:  0.0011851787567138672
r_  generation:  0.012629985809326172
local_output_nid generation:  0.0002505779266357422
local_in_edges_tensor generation:  0.0004987716674804688
mini_batch_src_global generation:  0.0007979869842529297
r_  generation:  0.006376504898071289
local_output_nid generation:  0.0004947185516357422
local_in_edges_tensor generation:  0.0008177757263183594
mini_batch_src_global generation:  0.0011186599731445312
r_  generation:  0.014248371124267578
local_output_nid generation:  0.0006535053253173828
local_in_edges_tensor generation:  0.0013728141784667969
mini_batch_src_global generation:  0.0011742115020751953
r_  generation:  0.013308525085449219
----------------------check_connections_block total spend ----------------------------- 0.23631811141967773
generate_one_block  0.007282733917236328
generate_one_block  0.008968114852905273
generate_one_block  0.01619100570678711
generate_one_block  0.005754709243774414
generate_one_block  0.013491630554199219
generate_one_block  0.02313542366027832
generate_one_block  0.014044046401977539
generate_one_block  0.014428853988647461
generate_one_block  0.018607139587402344
generate_one_block  0.01560831069946289
generate_one_block  0.01718282699584961
generate_one_block  0.016585588455200195
generate_one_block  0.01076054573059082
generate_one_block  0.018176555633544922
generate_one_block  0.016860246658325195
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017518997192382812
gen group dst list time:  0.00431370735168457
time for parepare:  0.0017387866973876953
local_output_nid generation:  0.0005905628204345703
local_in_edges_tensor generation:  0.0013256072998046875
mini_batch_src_global generation:  0.001209259033203125
r_  generation:  0.013955354690551758
local_output_nid generation:  0.0008783340454101562
local_in_edges_tensor generation:  0.0016825199127197266
mini_batch_src_global generation:  0.0020761489868164062
r_  generation:  0.017374277114868164
local_output_nid generation:  0.0012793540954589844
local_in_edges_tensor generation:  0.0019800662994384766
mini_batch_src_global generation:  0.0019588470458984375
r_  generation:  0.0224761962890625
local_output_nid generation:  0.0006222724914550781
local_in_edges_tensor generation:  0.0007469654083251953
mini_batch_src_global generation:  0.0009665489196777344
r_  generation:  0.008713722229003906
local_output_nid generation:  0.0010151863098144531
local_in_edges_tensor generation:  0.0012183189392089844
mini_batch_src_global generation:  0.001322031021118164
r_  generation:  0.018475770950317383
local_output_nid generation:  0.0016360282897949219
local_in_edges_tensor generation:  0.0025141239166259766
mini_batch_src_global generation:  0.002327442169189453
r_  generation:  0.024695873260498047
local_output_nid generation:  0.001005411148071289
local_in_edges_tensor generation:  0.001383066177368164
mini_batch_src_global generation:  0.00159454345703125
r_  generation:  0.0189056396484375
local_output_nid generation:  0.0011546611785888672
local_in_edges_tensor generation:  0.001772165298461914
mini_batch_src_global generation:  0.0017971992492675781
r_  generation:  0.019694805145263672
local_output_nid generation:  0.0012025833129882812
local_in_edges_tensor generation:  0.001622915267944336
mini_batch_src_global generation:  0.0017075538635253906
r_  generation:  0.0209963321685791
local_output_nid generation:  0.0010619163513183594
local_in_edges_tensor generation:  0.0012485980987548828
mini_batch_src_global generation:  0.001649618148803711
r_  generation:  0.018601655960083008
local_output_nid generation:  0.0011794567108154297
local_in_edges_tensor generation:  0.0016336441040039062
mini_batch_src_global generation:  0.0018360614776611328
r_  generation:  0.021018505096435547
local_output_nid generation:  0.001117706298828125
local_in_edges_tensor generation:  0.001508474349975586
mini_batch_src_global generation:  0.0015697479248046875
r_  generation:  0.01937127113342285
local_output_nid generation:  0.0009145736694335938
local_in_edges_tensor generation:  0.001302480697631836
mini_batch_src_global generation:  0.0014712810516357422
r_  generation:  0.01749563217163086
local_output_nid generation:  0.0013432502746582031
local_in_edges_tensor generation:  0.0020961761474609375
mini_batch_src_global generation:  0.001791238784790039
r_  generation:  0.02308201789855957
local_output_nid generation:  0.0012881755828857422
local_in_edges_tensor generation:  0.002155780792236328
mini_batch_src_global generation:  0.001756906509399414
r_  generation:  0.0217130184173584
----------------------check_connections_block total spend ----------------------------- 0.41908812522888184
generate_one_block  0.018317699432373047
generate_one_block  0.023546457290649414
generate_one_block  0.02860569953918457
generate_one_block  0.012948989868164062
generate_one_block  0.022494077682495117
generate_one_block  0.0313875675201416
generate_one_block  0.02412557601928711
generate_one_block  0.025167465209960938
generate_one_block  0.02668595314025879
generate_one_block  0.024166345596313477
generate_one_block  0.029546499252319336
generate_one_block  0.025200366973876953
generate_one_block  0.023131132125854492
generate_one_block  0.028501510620117188
generate_one_block  0.027759790420532227
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

connection checking time:  0.750016450881958
block generation total time  0.7094833850860596
average batch blocks generation time:  0.047298892339070635
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1326904296875 GB
    Memory Allocated: 0.03871726989746094  GigaBytes
Max Memory Allocated: 0.03871726989746094  GigaBytes

torch.Size([14171, 500])
torch.Size([5646, 128])
torch.Size([1799, 128])
torch.Size([286, 128])
torch.Size([99, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.4930047988891602  GigaBytes
Max Memory Allocated: 1.4930181503295898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7772216796875 GB
    Memory Allocated: 0.05256509780883789  GigaBytes
Max Memory Allocated: 1.4944171905517578  GigaBytes

torch.Size([16180, 500])
torch.Size([8275, 128])
torch.Size([3057, 128])
torch.Size([437, 128])
torch.Size([105, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2420654296875 GB
    Memory Allocated: 1.9127564430236816  GigaBytes
Max Memory Allocated: 1.9127678871154785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.05610036849975586  GigaBytes
Max Memory Allocated: 1.9137096405029297  GigaBytes

torch.Size([17899, 500])
torch.Size([12682, 128])
torch.Size([6131, 128])
torch.Size([1200, 128])
torch.Size([298, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 2.593372344970703  GigaBytes
Max Memory Allocated: 2.5933990478515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.04264497756958008  GigaBytes
Max Memory Allocated: 2.5943260192871094  GigaBytes

torch.Size([10703, 500])
torch.Size([4750, 128])
torch.Size([1436, 128])
torch.Size([303, 128])
torch.Size([87, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 1.0184335708618164  GigaBytes
Max Memory Allocated: 2.5943260192871094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.05214643478393555  GigaBytes
Max Memory Allocated: 2.5943260192871094  GigaBytes

torch.Size([15882, 500])
torch.Size([8544, 128])
torch.Size([3872, 128])
torch.Size([575, 128])
torch.Size([103, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 2.1118102073669434  GigaBytes
Max Memory Allocated: 2.5943260192871094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9393310546875 GB
    Memory Allocated: 0.057684898376464844  GigaBytes
Max Memory Allocated: 2.5943260192871094  GigaBytes

torch.Size([18638, 500])
torch.Size([15408, 128])
torch.Size([8006, 128])
torch.Size([1985, 128])
torch.Size([349, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.956258773803711  GigaBytes
Max Memory Allocated: 2.956298828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.05188417434692383  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([15689, 500])
torch.Size([8980, 128])
torch.Size([3878, 128])
torch.Size([643, 128])
torch.Size([126, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.1456775665283203  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.054137229919433594  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([16929, 500])
torch.Size([10268, 128])
torch.Size([4443, 128])
torch.Size([609, 128])
torch.Size([124, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.2559237480163574  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.05402660369873047  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([16788, 500])
torch.Size([11127, 128])
torch.Size([5324, 128])
torch.Size([1240, 128])
torch.Size([153, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.4630212783813477  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.0520176887512207  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([15367, 500])
torch.Size([9338, 128])
torch.Size([4864, 128])
torch.Size([1484, 128])
torch.Size([340, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.2807979583740234  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.05482339859008789  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([17247, 500])
torch.Size([11018, 128])
torch.Size([5257, 128])
torch.Size([799, 128])
torch.Size([175, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.435457229614258  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.052073001861572266  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([15611, 500])
torch.Size([10329, 128])
torch.Size([5445, 128])
torch.Size([1987, 128])
torch.Size([393, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.378314971923828  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.05173349380493164  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([15215, 500])
torch.Size([8104, 128])
torch.Size([2387, 128])
torch.Size([360, 128])
torch.Size([85, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9137458801269531  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.05556535720825195  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([17589, 500])
torch.Size([13631, 128])
torch.Size([5435, 128])
torch.Size([1525, 128])
torch.Size([182, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.6649551391601562  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.05601072311401367  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([17866, 500])
torch.Size([12151, 128])
torch.Size([7003, 128])
torch.Size([1378, 128])
torch.Size([322, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.4915404319763184  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013348690668741862 |0.025214179356892904 |0.33004144032796223 |0.00014505386352539062 |0.5377096811930339 |0.013102293014526367 |
----------------------------------------------------------pseudo_mini_loss sum 2.067715644836426
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  478471
Number of first layer input nodes during this epoch:  241774
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.08022403717041016  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007638931274414062
range selection method range initialization spend 7.009506225585938e-05
time for parepare:  7.700920104980469e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  5.459785461425781e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.5020370483398438e-05
----------------------check_connections_block total spend ----------------------------- 0.0030291080474853516
generate_one_block  0.001619577407836914
generate_one_block  0.0011394023895263672
generate_one_block  0.0010983943939208984
generate_one_block  0.0010678768157958984
generate_one_block  0.0011038780212402344
generate_one_block  0.001069784164428711
generate_one_block  0.0010576248168945312
generate_one_block  0.0010917186737060547
generate_one_block  0.0010700225830078125
generate_one_block  0.0010581016540527344
generate_one_block  0.0010180473327636719
generate_one_block  0.001041412353515625
generate_one_block  0.0009949207305908203
generate_one_block  0.0009839534759521484
generate_one_block  0.0009779930114746094
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007665157318115234
gen group dst list time:  8.845329284667969e-05
time for parepare:  0.0003833770751953125
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00010514259338378906
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00014901161193847656
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00018668174743652344
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  6.699562072753906e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00013780593872070312
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.745887756347656e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00020956993103027344
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  6.031990051269531e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  5.6743621826171875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001614093780517578
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001609325408935547
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  9.942054748535156e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  8.559226989746094e-05
----------------------check_connections_block total spend ----------------------------- 0.005381345748901367
generate_one_block  0.001287221908569336
generate_one_block  0.0012874603271484375
generate_one_block  0.0013430118560791016
generate_one_block  0.001146078109741211
generate_one_block  0.0012557506561279297
generate_one_block  0.0010907649993896484
generate_one_block  0.0011219978332519531
generate_one_block  0.0014109611511230469
generate_one_block  0.0017571449279785156
generate_one_block  0.0010602474212646484
generate_one_block  0.0012142658233642578
generate_one_block  0.0010538101196289062
generate_one_block  0.0011856555938720703
generate_one_block  0.0010213851928710938
generate_one_block  0.001089334487915039
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013120174407958984
gen group dst list time:  0.00015664100646972656
time for parepare:  0.0010666847229003906
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0002872943878173828
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.0009024143218994141
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  0.000148773193359375
r_  generation:  0.0008783340454101562
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.0014317035675048828
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  9.608268737792969e-05
r_  generation:  0.00034046173095703125
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.0007398128509521484
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.00024008750915527344
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0002238750457763672
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  0.00017023086547851562
r_  generation:  0.0015974044799804688
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  9.72747802734375e-05
r_  generation:  0.00024366378784179688
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0003972053527832031
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.00010800361633300781
r_  generation:  0.0009446144104003906
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0004425048828125
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0009403228759765625
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.00022721290588378906
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00044655799865722656
----------------------check_connections_block total spend ----------------------------- 0.018831968307495117
generate_one_block  0.002669095993041992
generate_one_block  0.00212860107421875
generate_one_block  0.002706766128540039
generate_one_block  0.0013718605041503906
generate_one_block  0.0019659996032714844
generate_one_block  0.0013577938079833984
generate_one_block  0.0012383460998535156
generate_one_block  0.003154754638671875
generate_one_block  0.0012345314025878906
generate_one_block  0.0014781951904296875
generate_one_block  0.002165555953979492
generate_one_block  0.001486063003540039
generate_one_block  0.002117156982421875
generate_one_block  0.0012288093566894531
generate_one_block  0.0014796257019042969
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018084049224853516
gen group dst list time:  0.0004165172576904297
time for parepare:  0.0018169879913330078
local_output_nid generation:  0.00023293495178222656
local_in_edges_tensor generation:  0.0008554458618164062
mini_batch_src_global generation:  0.0007588863372802734
r_  generation:  0.00595402717590332
local_output_nid generation:  0.00016045570373535156
local_in_edges_tensor generation:  0.00035572052001953125
mini_batch_src_global generation:  0.000591278076171875
r_  generation:  0.004341840744018555
local_output_nid generation:  0.00014448165893554688
local_in_edges_tensor generation:  0.00038504600524902344
mini_batch_src_global generation:  0.0005118846893310547
r_  generation:  0.00478672981262207
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  0.0002319812774658203
r_  generation:  0.0013167858123779297
local_output_nid generation:  0.00017142295837402344
local_in_edges_tensor generation:  0.0003352165222167969
mini_batch_src_global generation:  0.0003533363342285156
r_  generation:  0.004021406173706055
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.00025153160095214844
r_  generation:  0.0017249584197998047
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.0001666545867919922
r_  generation:  0.0011830329895019531
local_output_nid generation:  0.00025081634521484375
local_in_edges_tensor generation:  0.00045228004455566406
mini_batch_src_global generation:  0.0005440711975097656
r_  generation:  0.006456851959228516
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  0.0002968311309814453
r_  generation:  0.0015540122985839844
local_output_nid generation:  8.678436279296875e-05
local_in_edges_tensor generation:  0.0002605915069580078
mini_batch_src_global generation:  0.0002903938293457031
r_  generation:  0.0026717185974121094
local_output_nid generation:  0.00015687942504882812
local_in_edges_tensor generation:  0.000347137451171875
mini_batch_src_global generation:  0.0004191398620605469
r_  generation:  0.004290103912353516
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.0002675056457519531
mini_batch_src_global generation:  0.0003814697265625
r_  generation:  0.003107309341430664
local_output_nid generation:  0.0001709461212158203
local_in_edges_tensor generation:  0.0003349781036376953
mini_batch_src_global generation:  0.0004410743713378906
r_  generation:  0.0045354366302490234
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  0.00024247169494628906
r_  generation:  0.0011854171752929688
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.00026106834411621094
mini_batch_src_global generation:  0.0014014244079589844
r_  generation:  0.0025424957275390625
----------------------check_connections_block total spend ----------------------------- 0.07867765426635742
generate_one_block  0.01011514663696289
generate_one_block  0.006783246994018555
generate_one_block  0.007318973541259766
generate_one_block  0.0031948089599609375
generate_one_block  0.006608486175537109
generate_one_block  0.0034008026123046875
generate_one_block  0.0027151107788085938
generate_one_block  0.010099411010742188
generate_one_block  0.003086566925048828
generate_one_block  0.004853010177612305
generate_one_block  0.007292509078979492
generate_one_block  0.005544424057006836
generate_one_block  0.007825374603271484
generate_one_block  0.0024628639221191406
generate_one_block  0.0047452449798583984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023567676544189453
gen group dst list time:  0.0018129348754882812
time for parepare:  0.001802206039428711
local_output_nid generation:  0.0008189678192138672
local_in_edges_tensor generation:  0.0019252300262451172
mini_batch_src_global generation:  0.0017056465148925781
r_  generation:  0.016562938690185547
local_output_nid generation:  0.0006859302520751953
local_in_edges_tensor generation:  0.0009796619415283203
mini_batch_src_global generation:  0.0015912055969238281
r_  generation:  0.013695716857910156
local_output_nid generation:  0.0005447864532470703
local_in_edges_tensor generation:  0.0007469654083251953
mini_batch_src_global generation:  0.0009126663208007812
r_  generation:  0.009075164794921875
local_output_nid generation:  0.00030732154846191406
local_in_edges_tensor generation:  0.00044727325439453125
mini_batch_src_global generation:  0.0005402565002441406
r_  generation:  0.0050106048583984375
local_output_nid generation:  0.0007236003875732422
local_in_edges_tensor generation:  0.0008687973022460938
mini_batch_src_global generation:  0.001035928726196289
r_  generation:  0.013913631439208984
local_output_nid generation:  0.00044226646423339844
local_in_edges_tensor generation:  0.0005819797515869141
mini_batch_src_global generation:  0.0010066032409667969
r_  generation:  0.007969379425048828
local_output_nid generation:  0.0003902912139892578
local_in_edges_tensor generation:  0.0004918575286865234
mini_batch_src_global generation:  0.0006089210510253906
r_  generation:  0.007171630859375
local_output_nid generation:  0.0009448528289794922
local_in_edges_tensor generation:  0.0010311603546142578
mini_batch_src_global generation:  0.0011870861053466797
r_  generation:  0.01615452766418457
local_output_nid generation:  0.00046753883361816406
local_in_edges_tensor generation:  0.0005850791931152344
mini_batch_src_global generation:  0.000965118408203125
r_  generation:  0.007511138916015625
local_output_nid generation:  0.0005235671997070312
local_in_edges_tensor generation:  0.0006415843963623047
mini_batch_src_global generation:  0.0008590221405029297
r_  generation:  0.008826255798339844
local_output_nid generation:  0.0009169578552246094
local_in_edges_tensor generation:  0.0009739398956298828
mini_batch_src_global generation:  0.0012249946594238281
r_  generation:  0.01528310775756836
local_output_nid generation:  0.0007255077362060547
local_in_edges_tensor generation:  0.0008318424224853516
mini_batch_src_global generation:  0.0010800361633300781
r_  generation:  0.012134313583374023
local_output_nid generation:  0.0010752677917480469
local_in_edges_tensor generation:  0.0011606216430664062
mini_batch_src_global generation:  0.0011844635009765625
r_  generation:  0.014944791793823242
local_output_nid generation:  0.0002498626708984375
local_in_edges_tensor generation:  0.0003838539123535156
mini_batch_src_global generation:  0.0005695819854736328
r_  generation:  0.003988981246948242
local_output_nid generation:  0.0007066726684570312
local_in_edges_tensor generation:  0.0007789134979248047
mini_batch_src_global generation:  0.00086212158203125
r_  generation:  0.010915040969848633
----------------------check_connections_block total spend ----------------------------- 0.24182391166687012
generate_one_block  0.02467036247253418
generate_one_block  0.020444869995117188
generate_one_block  0.014542579650878906
generate_one_block  0.00838923454284668
generate_one_block  0.01939558982849121
generate_one_block  0.012629985809326172
generate_one_block  0.010137319564819336
generate_one_block  0.02121567726135254
generate_one_block  0.012193441390991211
generate_one_block  0.014215469360351562
generate_one_block  0.019739866256713867
generate_one_block  0.017180204391479492
generate_one_block  0.020045995712280273
generate_one_block  0.006963014602661133
generate_one_block  0.014980554580688477
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001909494400024414
gen group dst list time:  0.004523277282714844
time for parepare:  0.0019297599792480469
local_output_nid generation:  0.0015804767608642578
local_in_edges_tensor generation:  0.0023164749145507812
mini_batch_src_global generation:  0.0019941329956054688
r_  generation:  0.023877859115600586
local_output_nid generation:  0.0014760494232177734
local_in_edges_tensor generation:  0.002352476119995117
mini_batch_src_global generation:  0.0024886131286621094
r_  generation:  0.02317070960998535
local_output_nid generation:  0.0009324550628662109
local_in_edges_tensor generation:  0.0011794567108154297
mini_batch_src_global generation:  0.0014574527740478516
r_  generation:  0.01602315902709961
local_output_nid generation:  0.0010075569152832031
local_in_edges_tensor generation:  0.0011749267578125
mini_batch_src_global generation:  0.0011785030364990234
r_  generation:  0.014299631118774414
local_output_nid generation:  0.0015759468078613281
local_in_edges_tensor generation:  0.0017364025115966797
mini_batch_src_global generation:  0.0016045570373535156
r_  generation:  0.022353172302246094
local_output_nid generation:  0.0010173320770263672
local_in_edges_tensor generation:  0.001331329345703125
mini_batch_src_global generation:  0.0015423297882080078
r_  generation:  0.01763749122619629
local_output_nid generation:  0.0009710788726806641
local_in_edges_tensor generation:  0.0013380050659179688
mini_batch_src_global generation:  0.0014662742614746094
r_  generation:  0.01744556427001953
local_output_nid generation:  0.0014464855194091797
local_in_edges_tensor generation:  0.0023899078369140625
mini_batch_src_global generation:  0.0019030570983886719
r_  generation:  0.023585796356201172
local_output_nid generation:  0.0011153221130371094
local_in_edges_tensor generation:  0.0013492107391357422
mini_batch_src_global generation:  0.0015897750854492188
r_  generation:  0.0176389217376709
local_output_nid generation:  0.001032114028930664
local_in_edges_tensor generation:  0.0013239383697509766
mini_batch_src_global generation:  0.0014853477478027344
r_  generation:  0.01757979393005371
local_output_nid generation:  0.001506805419921875
local_in_edges_tensor generation:  0.0017812252044677734
mini_batch_src_global generation:  0.0019533634185791016
r_  generation:  0.023368358612060547
local_output_nid generation:  0.0012621879577636719
local_in_edges_tensor generation:  0.0021469593048095703
mini_batch_src_global generation:  0.001842498779296875
r_  generation:  0.021058320999145508
local_output_nid generation:  0.001455068588256836
local_in_edges_tensor generation:  0.0019860267639160156
mini_batch_src_global generation:  0.0018417835235595703
r_  generation:  0.022930145263671875
local_output_nid generation:  0.0006382465362548828
local_in_edges_tensor generation:  0.0008599758148193359
mini_batch_src_global generation:  0.0013082027435302734
r_  generation:  0.011723041534423828
local_output_nid generation:  0.0012786388397216797
local_in_edges_tensor generation:  0.001603841781616211
mini_batch_src_global generation:  0.001386880874633789
r_  generation:  0.020019054412841797
----------------------check_connections_block total spend ----------------------------- 0.4286367893218994
generate_one_block  0.031213045120239258
generate_one_block  0.031064510345458984
generate_one_block  0.022030353546142578
generate_one_block  0.019505023956298828
generate_one_block  0.029744386672973633
generate_one_block  0.02514815330505371
generate_one_block  0.024315595626831055
generate_one_block  0.029668331146240234
generate_one_block  0.025288820266723633
generate_one_block  0.024132490158081055
generate_one_block  0.03078174591064453
generate_one_block  0.03182196617126465
generate_one_block  0.03130698204040527
generate_one_block  0.016680240631103516
generate_one_block  0.026980876922607422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.08022403717041016  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

connection checking time:  0.7733516693115234
block generation total time  0.7685809135437012
average batch blocks generation time:  0.051238727569580075
block dataloader generation time/epoch 1.8018910884857178
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.07837867736816406  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([17496, 500])
torch.Size([14145, 128])
torch.Size([6670, 128])
torch.Size([1803, 128])
torch.Size([188, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3240966796875 GB
    Memory Allocated: 2.818054676055908  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.07888078689575195  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([17932, 500])
torch.Size([12890, 128])
torch.Size([5662, 128])
torch.Size([1398, 128])
torch.Size([280, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 2.645664691925049  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.0695810317993164  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([13040, 500])
torch.Size([7330, 128])
torch.Size([4041, 128])
torch.Size([1277, 128])
torch.Size([304, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 1.9522371292114258  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.07052326202392578  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([13699, 500])
torch.Size([7188, 128])
torch.Size([2072, 128])
torch.Size([461, 128])
torch.Size([116, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 1.531221866607666  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.07748126983642578  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([17177, 500])
torch.Size([12778, 128])
torch.Size([5121, 128])
torch.Size([1507, 128])
torch.Size([200, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 2.5997142791748047  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.07348060607910156  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([15193, 500])
torch.Size([7919, 128])
torch.Size([2859, 128])
torch.Size([395, 128])
torch.Size([57, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 1.9726109504699707  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.07447671890258789  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([15763, 500])
torch.Size([7577, 128])
torch.Size([2623, 128])
torch.Size([360, 128])
torch.Size([85, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 1.9100961685180664  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.07757329940795898  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([17148, 500])
torch.Size([12998, 128])
torch.Size([6946, 128])
torch.Size([2162, 128])
torch.Size([391, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 2.7548022270202637  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 0.07445621490478516  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([15296, 500])
torch.Size([8187, 128])
torch.Size([3051, 128])
torch.Size([346, 128])
torch.Size([87, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 1.944505214691162  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 0.07259559631347656  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([14607, 500])
torch.Size([8434, 128])
torch.Size([3675, 128])
torch.Size([661, 128])
torch.Size([122, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 2.040597915649414  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 0.07909297943115234  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([18013, 500])
torch.Size([13206, 128])
torch.Size([6664, 128])
torch.Size([1327, 128])
torch.Size([327, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 2.7269773483276367  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 0.07732629776000977  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([17147, 500])
torch.Size([10828, 128])
torch.Size([4944, 128])
torch.Size([712, 128])
torch.Size([149, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 2.4187111854553223  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 0.07958173751831055  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([18296, 500])
torch.Size([12953, 128])
torch.Size([7732, 128])
torch.Size([1432, 128])
torch.Size([353, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 2.6601901054382324  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 0.06833648681640625  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([12564, 500])
torch.Size([5047, 128])
torch.Size([1746, 128])
torch.Size([332, 128])
torch.Size([80, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 1.2339210510253906  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 0.07699298858642578  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

torch.Size([17006, 500])
torch.Size([10158, 128])
torch.Size([4762, 128])
torch.Size([696, 128])
torch.Size([180, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 2.294527530670166  GigaBytes
Max Memory Allocated: 2.9572057723999023  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013177490234375 |0.0031838258107503253 |0.2962306022644043 |0.00014065106709798176 |0.5401198705037434 |0.013799190521240234 |
----------------------------------------------------------pseudo_mini_loss sum 1.7147809267044067
Total (block generation + training)time/epoch 14.656924724578857
Training time/epoch 12.854676246643066
Training time without block to device /epoch 12.806918859481812
Training time without total dataloading part /epoch 12.561166048049927
load block tensor time/epoch 0.197662353515625
block to device time/epoch 0.04775738716125488
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  478728
Number of first layer input nodes during this epoch:  240377
