main start at this time 1648534541.69251
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007922649383544922
range selection method range initialization spend 9.894371032714844e-05
time for parepare:  5.650520324707031e-05
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0013654232025146484
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  8.511543273925781e-05
----------------------check_connections_block total spend ----------------------------- 0.0021369457244873047
generate_one_block  0.0015268325805664062
generate_one_block  0.0013926029205322266
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006773471832275391
gen group dst list time:  3.123283386230469e-05
time for parepare:  0.000293731689453125
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0006122589111328125
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  0.0001316070556640625
r_  generation:  0.0009253025054931641
----------------------check_connections_block total spend ----------------------------- 0.0029175281524658203
generate_one_block  0.0021059513092041016
generate_one_block  0.002458810806274414
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013384819030761719
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.0009152889251708984
local_output_nid generation:  0.000110626220703125
local_in_edges_tensor generation:  0.00041222572326660156
mini_batch_src_global generation:  0.00027680397033691406
r_  generation:  0.0033893585205078125
local_output_nid generation:  0.0001533031463623047
local_in_edges_tensor generation:  0.00041103363037109375
mini_batch_src_global generation:  0.0007431507110595703
r_  generation:  0.006154775619506836
----------------------check_connections_block total spend ----------------------------- 0.01530003547668457
generate_one_block  0.004633188247680664
generate_one_block  0.00704193115234375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019369125366210938
gen group dst list time:  0.0002460479736328125
time for parepare:  0.0016641616821289062
local_output_nid generation:  0.00042366981506347656
local_in_edges_tensor generation:  0.0009856224060058594
mini_batch_src_global generation:  0.0014050006866455078
r_  generation:  0.012128591537475586
local_output_nid generation:  0.0004620552062988281
local_in_edges_tensor generation:  0.001317739486694336
mini_batch_src_global generation:  0.0017592906951904297
r_  generation:  0.015585899353027344
----------------------check_connections_block total spend ----------------------------- 0.04309535026550293
generate_one_block  0.01610255241394043
generate_one_block  0.02139592170715332
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017781257629394531
gen group dst list time:  0.0005002021789550781
time for parepare:  0.0016624927520751953
local_output_nid generation:  0.0010008811950683594
local_in_edges_tensor generation:  0.0019123554229736328
mini_batch_src_global generation:  0.002354145050048828
r_  generation:  0.023158788681030273
local_output_nid generation:  0.0012636184692382812
local_in_edges_tensor generation:  0.002437591552734375
mini_batch_src_global generation:  0.002682924270629883
r_  generation:  0.024405717849731445
----------------------check_connections_block total spend ----------------------------- 0.07185196876525879
generate_one_block  0.02788853645324707
generate_one_block  0.03134417533874512
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018570423126220703
gen group dst list time:  0.0007894039154052734
time for parepare:  0.0017437934875488281
local_output_nid generation:  0.0014727115631103516
local_in_edges_tensor generation:  0.002505779266357422
mini_batch_src_global generation:  0.002203702926635742
r_  generation:  0.02686929702758789
local_output_nid generation:  0.0016775131225585938
local_in_edges_tensor generation:  0.0024929046630859375
mini_batch_src_global generation:  0.002690553665161133
r_  generation:  0.027056217193603516
----------------------check_connections_block total spend ----------------------------- 0.08035540580749512
generate_one_block  0.03134799003601074
generate_one_block  0.03334498405456543
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.010906696319580078  GigaBytes

connection checking time:  0.21352028846740723
block generation total time  0.17766404151916504
average batch blocks generation time:  0.08883202075958252
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1424560546875 GB
    Memory Allocated: 0.04830503463745117  GigaBytes
Max Memory Allocated: 0.04830503463745117  GigaBytes

torch.Size([19262, 500])
torch.Size([17700, 128])
torch.Size([13327, 128])
torch.Size([4386, 128])
torch.Size([1182, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6444091796875 GB
    Memory Allocated: 3.4242911338806152  GigaBytes
Max Memory Allocated: 3.4243879318237305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7576904296875 GB
    Memory Allocated: 0.05977964401245117  GigaBytes
Max Memory Allocated: 3.4251914024353027  GigaBytes

torch.Size([19323, 500])
torch.Size([17840, 128])
torch.Size([14300, 128])
torch.Size([5965, 128])
torch.Size([1579, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0936279296875 GB
    Memory Allocated: 3.625154495239258  GigaBytes
Max Memory Allocated: 3.6252799034118652  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02427542209625244 |0.17462122440338135 |0.687848687171936 |0.0002295970916748047 |0.5271077156066895 |0.01324772834777832 |
----------------------------------------------------------pseudo_mini_loss sum 1.9366466999053955
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  115220
Number of first layer input nodes during this epoch:  38585
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 5.0916748046875 GB
    Memory Allocated: 0.0851125717163086  GigaBytes
Max Memory Allocated: 3.6260266304016113  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005950927734375
range selection method range initialization spend 6.651878356933594e-05
time for parepare:  7.200241088867188e-05
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001246929168701172Using backend: pytorch

mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  6.67572021484375e-05
----------------------check_connections_block total spend ----------------------------- 0.0009186267852783203
generate_one_block  0.0013134479522705078
generate_one_block  0.0011479854583740234
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005745887756347656
gen group dst list time:  3.0279159545898438e-05
time for parepare:  0.00027632713317871094
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.0006320476531982422
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  0.00011396408081054688
r_  generation:  0.0006525516510009766
----------------------check_connections_block total spend ----------------------------- 0.002547025680541992
generate_one_block  0.0020210742950439453
generate_one_block  0.002075672149658203
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001016378402709961
gen group dst list time:  7.772445678710938e-05
time for parepare:  0.0008087158203125
local_output_nid generation:  0.0001494884490966797
local_in_edges_tensor generation:  0.00038361549377441406
mini_batch_src_global generation:  0.00048089027404785156
r_  generation:  0.0041158199310302734
local_output_nid generation:  0.00015354156494140625
local_in_edges_tensor generation:  0.00031304359436035156
mini_batch_src_global generation:  0.0005500316619873047
r_  generation:  0.0040929317474365234
----------------------check_connections_block total spend ----------------------------- 0.013142585754394531
generate_one_block  0.007904052734375
generate_one_block  0.006719112396240234
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002122163772583008
gen group dst list time:  0.00021958351135253906
time for parepare:  0.0013303756713867188
local_output_nid generation:  0.0004119873046875
local_in_edges_tensor generation:  0.0012514591217041016
mini_batch_src_global generation:  0.001384735107421875
r_  generation:  0.01392221450805664
local_output_nid generation:  0.0004177093505859375
local_in_edges_tensor generation:  0.0008306503295898438
mini_batch_src_global generation:  0.0015745162963867188
r_  generation:  0.013747930526733398
----------------------check_connections_block total spend ----------------------------- 0.04174947738647461
generate_one_block  0.021997451782226562
generate_one_block  0.021999597549438477
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018908977508544922
gen group dst list time:  0.0005342960357666016
time for parepare:  0.0015001296997070312
local_output_nid generation:  0.0009958744049072266
local_in_edges_tensor generation:  0.001955270767211914
mini_batch_src_global generation:  0.002015352249145508
r_  generation:  0.023023128509521484
local_output_nid generation:  0.0012867450714111328
local_in_edges_tensor generation:  0.0023610591888427734
mini_batch_src_global generation:  0.0026404857635498047
r_  generation:  0.02347421646118164
----------------------check_connections_block total spend ----------------------------- 0.0699000358581543
generate_one_block  0.03297781944274902
generate_one_block  0.03256583213806152
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002203702926635742
gen group dst list time:  0.0009548664093017578
time for parepare:  0.0016682147979736328
local_output_nid generation:  0.0013966560363769531
local_in_edges_tensor generation:  0.0026960372924804688
mini_batch_src_global generation:  0.001957416534423828
r_  generation:  0.025853872299194336
local_output_nid generation:  0.0016293525695800781
local_in_edges_tensor generation:  0.002409219741821289
mini_batch_src_global generation:  0.0026819705963134766
r_  generation:  0.0258939266204834
----------------------check_connections_block total spend ----------------------------- 0.07761526107788086
generate_one_block  0.03531813621520996
generate_one_block  0.035249948501586914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.0916748046875 GB
    Memory Allocated: 0.0851125717163086  GigaBytes
Max Memory Allocated: 3.6260266304016113  GigaBytes

connection checking time:  0.2049543857574463
block generation total time  0.19882869720458984
average batch blocks generation time:  0.09941434860229492
block dataloader generation time/epoch 0.46393704414367676
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0916748046875 GB
    Memory Allocated: 0.0819706916809082  GigaBytes
Max Memory Allocated: 3.6260266304016113  GigaBytes

torch.Size([19332, 500])
torch.Size([18051, 128])
torch.Size([13392, 128])
torch.Size([5626, 128])
torch.Size([1237, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1502685546875 GB
    Memory Allocated: 3.5828990936279297  GigaBytes
Max Memory Allocated: 3.6260266304016113  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1502685546875 GB
    Memory Allocated: 0.08190393447875977  GigaBytes
Max Memory Allocated: 3.6260266304016113  GigaBytes

torch.Size([19291, 500])
torch.Size([17748, 128])
torch.Size([14474, 128])
torch.Size([5146, 128])
torch.Size([1538, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1502685546875 GB
    Memory Allocated: 3.585981845855713  GigaBytes
Max Memory Allocated: 3.6260266304016113  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018662333488464355 |0.0037904977798461914 |0.3995656967163086 |0.00016248226165771484 |0.5421795845031738 |0.009669303894042969 |
----------------------------------------------------------pseudo_mini_loss sum 1.572441816329956
Total (block generation + training)time/epoch 2.4131877422332764
Training time/epoch 1.9489290714263916
Training time without block to device /epoch 1.9413480758666992
Training time without total dataloading part /epoch 1.8934848308563232
load block tensor time/epoch 0.03732466697692871
block to device time/epoch 0.007580995559692383
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  116191
Number of first layer input nodes during this epoch:  38623
