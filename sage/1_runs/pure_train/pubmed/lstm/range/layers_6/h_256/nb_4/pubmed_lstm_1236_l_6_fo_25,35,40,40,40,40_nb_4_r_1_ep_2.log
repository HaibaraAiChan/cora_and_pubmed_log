main start at this time 1648534652.8450553
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0009458065032958984
range selection method range initialization spend 0.00010347366333007812
time for parepare:  5.650520324707031e-05
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0018086433410644531
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  7.867813110351562e-05
----------------------check_connections_block total spend ----------------------------- 0.0025932788848876953
generate_one_block  0.0016117095947265625
generate_one_block  0.0013837814331054688
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007171630859375
gen group dst list time:  3.0994415283203125e-05
time for parepare:  0.0003025531768798828
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0006570816040039062
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0008673667907714844
----------------------check_connections_block total spend ----------------------------- 0.002885103225708008
generate_one_block  0.002159595489501953
generate_one_block  0.0023734569549560547
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012772083282470703
gen group dst list time:  7.748603820800781e-05
time for parepare:  0.0009312629699707031
local_output_nid generation:  0.00011587142944335938
local_in_edges_tensor generation:  0.00042438507080078125
mini_batch_src_global generation:  0.0003185272216796875
r_  generation:  0.003936052322387695
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.000385284423828125
mini_batch_src_global generation:  0.00069427490234375
r_  generation:  0.005354404449462891
----------------------check_connections_block total spend ----------------------------- 0.015005350112915039
generate_one_block  0.0051577091217041016
generate_one_block  0.0062978267669677734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0022051334381103516
gen group dst list time:  0.0002465248107910156
time for parepare:  0.0016825199127197266
local_output_nid generation:  0.0004515647888183594
local_in_edges_tensor generation:  0.0011379718780517578
mini_batch_src_global generation:  0.0015606880187988281
r_  generation:  0.015440940856933594
local_output_nid generation:  0.0004127025604248047
local_in_edges_tensor generation:  0.0008602142333984375
mini_batch_src_global generation:  0.0018911361694335938
r_  generation:  0.016303300857543945
----------------------check_connections_block total spend ----------------------------- 0.047724008560180664
generate_one_block  0.016933917999267578
generate_one_block  0.021511077880859375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001981496810913086
gen group dst list time:  0.0006692409515380859
time for parepare:  0.00201416015625
local_output_nid generation:  0.0013077259063720703
local_in_edges_tensor generation:  0.0023202896118164062
mini_batch_src_global generation:  0.0024538040161132812
r_  generation:  0.025605201721191406
local_output_nid generation:  0.0012254714965820312
local_in_edges_tensor generation:  0.0018181800842285156
mini_batch_src_global generation:  0.0028405189514160156
r_  generation:  0.025442123413085938
----------------------check_connections_block total spend ----------------------------- 0.07786273956298828
generate_one_block  0.027611255645751953
generate_one_block  0.030968904495239258
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001874685287475586
gen group dst list time:  0.00077056884765625
time for parepare:  0.001741170883178711
local_output_nid generation:  0.0013270378112792969
local_in_edges_tensor generation:  0.002534627914428711
mini_batch_src_global generation:  0.0022580623626708984
r_  generation:  0.02625417709350586
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.002492189407348633
mini_batch_src_global generation:  0.002617359161376953
r_  generation:  0.026386260986328125
----------------------check_connections_block total spend ----------------------------- 0.0787968635559082
generate_one_block  0.031162500381469727
generate_one_block  0.03315854072570801
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

connection checking time:  0.2222740650177002
block generation total time  0.17733478546142578
average batch blocks generation time:  0.08866739273071289
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1522216796875 GB
    Memory Allocated: 0.05775737762451172  GigaBytes
Max Memory Allocated: 0.05775737762451172  GigaBytes

torch.Size([19313, 500])
torch.Size([17870, 256])
torch.Size([13825, 256])
torch.Size([4898, 256])
torch.Size([1279, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7791748046875 GB
    Memory Allocated: 4.553221702575684  GigaBytes
Max Memory Allocated: 4.553412914276123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0155029296875 GB
    Memory Allocated: 0.07844400405883789  GigaBytes
Max Memory Allocated: 4.556949615478516  GigaBytes

torch.Size([19259, 500])
torch.Size([17733, 256])
torch.Size([13546, 256])
torch.Size([5330, 256])
torch.Size([1435, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1229248046875 GB
    Memory Allocated: 4.664906978607178  GigaBytes
Max Memory Allocated: 4.665137767791748  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018372178077697754 |0.17444217205047607 |0.7224044799804688 |0.00019466876983642578 |0.564008355140686 |0.01218867301940918 |
----------------------------------------------------------pseudo_mini_loss sum 2.0633413791656494
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  114843
Number of first layer input nodes during this epoch:  38572
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 6.1268310546875 GB
    Memory Allocated: 0.12178277969360352  GigaBytes
Max Memory Allocated: 4.668610572814941  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006198883056640625
range selection method range initialization spend 6.437301635742188e-05
time for parepare:  6.413459777832031e-05
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013899803161621094Using backend: pytorch

mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  9.274482727050781e-05
----------------------check_connections_block total spend ----------------------------- 0.0009322166442871094
generate_one_block  0.001445770263671875
generate_one_block  0.001424551010131836
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006320476531982422
gen group dst list time:  3.4332275390625e-05
time for parepare:  0.00030803680419921875
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00023126602172851562
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.0007219314575195312
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  0.00012159347534179688
r_  generation:  0.0008404254913330078
----------------------check_connections_block total spend ----------------------------- 0.0029981136322021484
generate_one_block  0.002421140670776367
generate_one_block  0.0025196075439453125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012001991271972656
gen group dst list time:  8.7738037109375e-05
time for parepare:  0.0009584426879882812
local_output_nid generation:  0.0001747608184814453
local_in_edges_tensor generation:  0.0004401206970214844
mini_batch_src_global generation:  0.0005042552947998047
r_  generation:  0.004904747009277344
local_output_nid generation:  0.00018024444580078125
local_in_edges_tensor generation:  0.0003705024719238281
mini_batch_src_global generation:  0.00055694580078125
r_  generation:  0.005126237869262695
----------------------check_connections_block total spend ----------------------------- 0.015854358673095703
generate_one_block  0.007501840591430664
generate_one_block  0.006739139556884766
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020475387573242188
gen group dst list time:  0.00027370452880859375
time for parepare:  0.0016858577728271484
local_output_nid generation:  0.0005211830139160156
local_in_edges_tensor generation:  0.001119375228881836
mini_batch_src_global generation:  0.0013382434844970703
r_  generation:  0.014649629592895508
local_output_nid generation:  0.0004603862762451172
local_in_edges_tensor generation:  0.0008919239044189453
mini_batch_src_global generation:  0.0016696453094482422
r_  generation:  0.014713287353515625
----------------------check_connections_block total spend ----------------------------- 0.04532814025878906
generate_one_block  0.02160787582397461
generate_one_block  0.0220487117767334
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001741170883178711
gen group dst list time:  0.0005223751068115234
time for parepare:  0.0015537738800048828
local_output_nid generation:  0.0010325908660888672
local_in_edges_tensor generation:  0.001964092254638672
mini_batch_src_global generation:  0.0020580291748046875
r_  generation:  0.02404046058654785
local_output_nid generation:  0.0012500286102294922
local_in_edges_tensor generation:  0.002412080764770508
mini_batch_src_global generation:  0.002620697021484375
r_  generation:  0.02539658546447754
----------------------check_connections_block total spend ----------------------------- 0.07332921028137207
generate_one_block  0.03209400177001953
generate_one_block  0.03361248970031738
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019524097442626953
gen group dst list time:  0.0008983612060546875
time for parepare:  0.0017044544219970703
local_output_nid generation:  0.0013887882232666016
local_in_edges_tensor generation:  0.002429962158203125
mini_batch_src_global generation:  0.0020422935485839844
r_  generation:  0.027938127517700195
local_output_nid generation:  0.0016980171203613281
local_in_edges_tensor generation:  0.0025408267974853516
mini_batch_src_global generation:  0.002640962600708008
r_  generation:  0.026859760284423828
----------------------check_connections_block total spend ----------------------------- 0.08103418350219727
generate_one_block  0.034531354904174805
generate_one_block  0.03728961944580078
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 6.1268310546875 GB
    Memory Allocated: 0.12178277969360352  GigaBytes
Max Memory Allocated: 4.668610572814941  GigaBytes

connection checking time:  0.21854400634765625
block generation total time  0.20036578178405762
average batch blocks generation time:  0.10018289089202881
block dataloader generation time/epoch 0.4816122055053711
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1268310546875 GB
    Memory Allocated: 0.11898279190063477  GigaBytes
Max Memory Allocated: 4.668610572814941  GigaBytes

torch.Size([19339, 500])
torch.Size([17740, 256])
torch.Size([14112, 256])
torch.Size([5267, 256])
torch.Size([1356, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1346435546875 GB
    Memory Allocated: 4.718748092651367  GigaBytes
Max Memory Allocated: 4.718931198120117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1385498046875 GB
    Memory Allocated: 0.11897087097167969  GigaBytes
Max Memory Allocated: 4.722498893737793  GigaBytes

torch.Size([19328, 500])
torch.Size([18029, 256])
torch.Size([13950, 256])
torch.Size([5549, 256])
torch.Size([1455, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1990966796875 GB
    Memory Allocated: 4.751443862915039  GigaBytes
Max Memory Allocated: 4.751684188842773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015131711959838867 |0.003277897834777832 |0.39525437355041504 |0.00016236305236816406 |0.578350305557251 |0.015981674194335938 |
----------------------------------------------------------pseudo_mini_loss sum 2.638375759124756
Total (block generation + training)time/epoch 2.4985082149505615
Training time/epoch 2.01629900932312
Training time without block to device /epoch 2.0097432136535645
Training time without total dataloading part /epoch 1.9635157585144043
load block tensor time/epoch 0.030263423919677734
block to device time/epoch 0.006555795669555664
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  116481
Number of first layer input nodes during this epoch:  38667
