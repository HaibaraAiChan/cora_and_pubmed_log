main start at this time 1648534686.5737932
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0017037391662597656
range selection method range initialization spend 8.177757263183594e-05
time for parepare:  4.6253204345703125e-05
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0012156963348388672
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.2649765014648438e-05
----------------------check_connections_block total spend ----------------------------- 0.0028228759765625
generate_one_block  0.0012488365173339844
generate_one_block  0.001028299331665039
generate_one_block  0.000995635986328125
generate_one_block  0.0010461807250976562
generate_one_block  0.0009942054748535156
generate_one_block  0.0010044574737548828
generate_one_block  0.0009944438934326172
generate_one_block  0.0009884834289550781
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009720325469970703
gen group dst list time:  4.9591064453125e-05
time for parepare:  0.00025153160095214844
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0002002716064453125
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00014090538024902344
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00018453598022460938
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00012946128845214844
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00022864341735839844
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00013899803161621094
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00020241737365722656
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00013327598571777344
----------------------check_connections_block total spend ----------------------------- 0.003383636474609375
generate_one_block  0.0012731552124023438
generate_one_block  0.0011622905731201172
generate_one_block  0.001285552978515625
generate_one_block  0.0011446475982666016
generate_one_block  0.0013115406036376953
generate_one_block  0.0011508464813232422
generate_one_block  0.0012485980987548828
generate_one_block  0.0011749267578125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012040138244628906
gen group dst list time:  9.1552734375e-05
time for parepare:  0.0007922649383544922
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.000270843505859375
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.001013040542602539
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  0.00010514259338378906
r_  generation:  0.0008592605590820312
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.0012416839599609375
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  0.00011754035949707031
r_  generation:  0.0008864402770996094
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.001781463623046875
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  0.00011491775512695312
r_  generation:  0.0007834434509277344
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  0.0001628398895263672
r_  generation:  0.0016698837280273438
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  0.00011324882507324219
r_  generation:  0.0007584095001220703
----------------------check_connections_block total spend ----------------------------- 0.014850378036499023
generate_one_block  0.0022737979888916016
generate_one_block  0.0019583702087402344
generate_one_block  0.0024623870849609375
generate_one_block  0.002015829086303711
generate_one_block  0.0031309127807617188
generate_one_block  0.0017709732055664062
generate_one_block  0.0028867721557617188
generate_one_block  0.0017588138580322266
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002141237258911133
gen group dst list time:  0.0002605915069580078
time for parepare:  0.001596689224243164
local_output_nid generation:  0.00012612342834472656
local_in_edges_tensor generation:  0.0006206035614013672
mini_batch_src_global generation:  0.000614166259765625
r_  generation:  0.0052187442779541016
local_output_nid generation:  0.0001220703125
local_in_edges_tensor generation:  0.00035500526428222656
mini_batch_src_global generation:  0.000652313232421875
r_  generation:  0.00487518310546875
local_output_nid generation:  0.0001595020294189453
local_in_edges_tensor generation:  0.00040531158447265625
mini_batch_src_global generation:  0.0006511211395263672
r_  generation:  0.0065348148345947266
local_output_nid generation:  0.00014519691467285156
local_in_edges_tensor generation:  0.0003437995910644531
mini_batch_src_global generation:  0.0004718303680419922
r_  generation:  0.004579067230224609
local_output_nid generation:  0.00017189979553222656
local_in_edges_tensor generation:  0.0004093647003173828
mini_batch_src_global generation:  0.0006103515625
r_  generation:  0.006764411926269531
local_output_nid generation:  0.00012159347534179688
local_in_edges_tensor generation:  0.0003001689910888672
mini_batch_src_global generation:  0.0004639625549316406
r_  generation:  0.004078388214111328
local_output_nid generation:  0.00015211105346679688
local_in_edges_tensor generation:  0.0003693103790283203
mini_batch_src_global generation:  0.0005509853363037109
r_  generation:  0.0059087276458740234
local_output_nid generation:  0.00010824203491210938
local_in_edges_tensor generation:  0.0002741813659667969
mini_batch_src_global generation:  0.00037217140197753906
r_  generation:  0.0030896663665771484
----------------------check_connections_block total spend ----------------------------- 0.062038421630859375
generate_one_block  0.008069515228271484
generate_one_block  0.007044553756713867
generate_one_block  0.009456157684326172
generate_one_block  0.006753206253051758
generate_one_block  0.01004338264465332
generate_one_block  0.006321430206298828
generate_one_block  0.00843358039855957
generate_one_block  0.004830121994018555
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022172927856445312
gen group dst list time:  0.00128173828125
time for parepare:  0.0017616748809814453
local_output_nid generation:  0.0006513595581054688
local_in_edges_tensor generation:  0.0016162395477294922
mini_batch_src_global generation:  0.0013821125030517578
r_  generation:  0.015002250671386719
local_output_nid generation:  0.0005731582641601562
local_in_edges_tensor generation:  0.0010712146759033203
mini_batch_src_global generation:  0.0016255378723144531
r_  generation:  0.014893293380737305
local_output_nid generation:  0.0008389949798583984
local_in_edges_tensor generation:  0.0022687911987304688
mini_batch_src_global generation:  0.0016391277313232422
r_  generation:  0.01806044578552246
local_output_nid generation:  0.0005915164947509766
local_in_edges_tensor generation:  0.0009431838989257812
mini_batch_src_global generation:  0.0012705326080322266
r_  generation:  0.015013456344604492
local_output_nid generation:  0.0007061958312988281
local_in_edges_tensor generation:  0.0011298656463623047
mini_batch_src_global generation:  0.0014224052429199219
r_  generation:  0.016767263412475586
local_output_nid generation:  0.0005598068237304688
local_in_edges_tensor generation:  0.000911712646484375
mini_batch_src_global generation:  0.0013294219970703125
r_  generation:  0.014760971069335938
local_output_nid generation:  0.0005173683166503906
local_in_edges_tensor generation:  0.0008983612060546875
mini_batch_src_global generation:  0.0010924339294433594
r_  generation:  0.012929201126098633
local_output_nid generation:  0.0005314350128173828
local_in_edges_tensor generation:  0.0007884502410888672
mini_batch_src_global generation:  0.0008840560913085938
r_  generation:  0.00947713851928711
----------------------check_connections_block total spend ----------------------------- 0.17057394981384277
generate_one_block  0.019457340240478516
generate_one_block  0.020658254623413086
generate_one_block  0.024433135986328125
generate_one_block  0.020534038543701172
generate_one_block  0.021348953247070312
generate_one_block  0.01976609230041504
generate_one_block  0.017470359802246094
generate_one_block  0.015179872512817383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002044200897216797
gen group dst list time:  0.002705097198486328
time for parepare:  0.0017001628875732422
local_output_nid generation:  0.0011615753173828125
local_in_edges_tensor generation:  0.0025331974029541016
mini_batch_src_global generation:  0.0022323131561279297
r_  generation:  0.02281951904296875
local_output_nid generation:  0.0011816024780273438
local_in_edges_tensor generation:  0.0023415088653564453
mini_batch_src_global generation:  0.0024118423461914062
r_  generation:  0.022643327713012695
local_output_nid generation:  0.0013697147369384766
local_in_edges_tensor generation:  0.0021715164184570312
mini_batch_src_global generation:  0.0018756389617919922
r_  generation:  0.023742198944091797
local_output_nid generation:  0.0014069080352783203
local_in_edges_tensor generation:  0.0019152164459228516
mini_batch_src_global generation:  0.00183868408203125
r_  generation:  0.023745059967041016
local_output_nid generation:  0.0012404918670654297
local_in_edges_tensor generation:  0.002020597457885742
mini_batch_src_global generation:  0.0017232894897460938
r_  generation:  0.02275824546813965
local_output_nid generation:  0.0012073516845703125
local_in_edges_tensor generation:  0.0020723342895507812
mini_batch_src_global generation:  0.0018362998962402344
r_  generation:  0.02289271354675293
local_output_nid generation:  0.0009789466857910156
local_in_edges_tensor generation:  0.0013949871063232422
mini_batch_src_global generation:  0.0016505718231201172
r_  generation:  0.019689321517944336
local_output_nid generation:  0.0009944438934326172
local_in_edges_tensor generation:  0.0015032291412353516
mini_batch_src_global generation:  0.0015456676483154297
r_  generation:  0.019208669662475586
----------------------check_connections_block total spend ----------------------------- 0.2572164535522461
generate_one_block  0.02835702896118164
generate_one_block  0.029880762100219727
generate_one_block  0.029637813568115234
generate_one_block  0.02909111976623535
generate_one_block  0.028605937957763672
generate_one_block  0.0288083553314209
generate_one_block  0.025049209594726562
generate_one_block  0.024407148361206055
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

connection checking time:  0.5080628395080566
block generation total time  0.471646785736084
average batch blocks generation time:  0.0589558482170105
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.056418418884277344  GigaBytes
Max Memory Allocated: 0.056418418884277344  GigaBytes

torch.Size([18509, 500])
torch.Size([13961, 256])
torch.Size([8178, 256])
torch.Size([1720, 256])
torch.Size([442, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 3.3165173530578613  GigaBytes
Max Memory Allocated: 3.316582679748535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6678466796875 GB
    Memory Allocated: 0.07489490509033203  GigaBytes
Max Memory Allocated: 3.321578025817871  GigaBytes

torch.Size([17954, 500])
torch.Size([13558, 256])
torch.Size([6407, 256])
torch.Size([1487, 256])
torch.Size([298, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7186279296875 GB
    Memory Allocated: 3.305753231048584  GigaBytes
Max Memory Allocated: 3.321578025817871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7713623046875 GB
    Memory Allocated: 0.07676362991333008  GigaBytes
Max Memory Allocated: 3.321578025817871  GigaBytes

torch.Size([18498, 500])
torch.Size([14619, 256])
torch.Size([8927, 256])
torch.Size([1899, 256])
torch.Size([461, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1170654296875 GB
    Memory Allocated: 3.666749954223633  GigaBytes
Max Memory Allocated: 3.6669158935546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1209716796875 GB
    Memory Allocated: 0.0750722885131836  GigaBytes
Max Memory Allocated: 3.67061185836792  GigaBytes

torch.Size([18044, 500])
torch.Size([14337, 256])
torch.Size([6441, 256])
torch.Size([1805, 256])
torch.Size([249, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1209716796875 GB
    Memory Allocated: 3.3570566177368164  GigaBytes
Max Memory Allocated: 3.67061185836792  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1209716796875 GB
    Memory Allocated: 0.07541036605834961  GigaBytes
Max Memory Allocated: 3.67061185836792  GigaBytes

torch.Size([18160, 500])
torch.Size([13675, 256])
torch.Size([8228, 256])
torch.Size([2223, 256])
torch.Size([537, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 3.583000659942627  GigaBytes
Max Memory Allocated: 3.67061185836792  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 0.07526874542236328  GigaBytes
Max Memory Allocated: 3.67061185836792  GigaBytes

torch.Size([18167, 500])
torch.Size([13619, 256])
torch.Size([6507, 256])
torch.Size([1430, 256])
torch.Size([269, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 3.2587404251098633  GigaBytes
Max Memory Allocated: 3.67061185836792  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 0.07067680358886719  GigaBytes
Max Memory Allocated: 3.67061185836792  GigaBytes

torch.Size([15716, 500])
torch.Size([10867, 256])
torch.Size([5499, 256])
torch.Size([1897, 256])
torch.Size([374, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 3.0456137657165527  GigaBytes
Max Memory Allocated: 3.67061185836792  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 0.07251453399658203  GigaBytes
Max Memory Allocated: 3.67061185836792  GigaBytes

torch.Size([16822, 500])
torch.Size([10957, 256])
torch.Size([4776, 256])
torch.Size([1318, 256])
torch.Size([282, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 2.5751161575317383  GigaBytes
Max Memory Allocated: 3.67061185836792  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021386831998825073 |0.04469349980354309 |0.40976470708847046 |0.00014793872833251953 |0.4865957498550415 |0.012539148330688477 |
----------------------------------------------------------pseudo_mini_loss sum 1.7486988306045532
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  319474
Number of first layer input nodes during this epoch:  141870
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 0.11533260345458984  GigaBytes
Max Memory Allocated: 3.67061185836792  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007224082946777344
range selection method range initialization spend 6.604194641113281e-05
time for parepare:  6.914138793945312e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.198883056640625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.52587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0018017292022705078
generate_one_block  0.0016148090362548828
generate_one_block  0.0011243820190429688
generate_one_block  0.001081228256225586
generate_one_block  0.001050710678100586
generate_one_block  0.0010743141174316406
generate_one_block  0.0010914802551269531
generate_one_block  0.0010704994201660156
generate_one_block  0.0010404586791992188
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006654262542724609
gen group dst list time:  5.7697296142578125e-05
time for parepare:  0.0003399848937988281
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0003795623779296875
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00016832351684570312
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00012731552124023438
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00012540817260742188
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0001842975616455078
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00025725364685058594
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00019478797912597656
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  8.368492126464844e-05
----------------------check_connections_block total spend ----------------------------- 0.003907918930053711
generate_one_block  0.001705169677734375
generate_one_block  0.0012471675872802734
generate_one_block  0.0012004375457763672
generate_one_block  0.0013186931610107422
generate_one_block  0.0013012886047363281
generate_one_block  0.0014634132385253906
generate_one_block  0.0012803077697753906
generate_one_block  0.001089334487915039
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012402534484863281
gen group dst list time:  0.00011157989501953125
time for parepare:  0.0009119510650634766
local_output_nid generation:  9.226799011230469e-05
local_in_edges_tensor generation:  0.00035500526428222656
mini_batch_src_global generation:  0.0003445148468017578
r_  generation:  0.0026133060455322266
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  0.00016927719116210938
r_  generation:  0.0008823871612548828
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.0007352828979492188
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.00010132789611816406
r_  generation:  0.0006768703460693359
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.00013184547424316406
r_  generation:  0.0010859966278076172
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  0.00020575523376464844
r_  generation:  0.0017459392547607422
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.00015854835510253906
r_  generation:  0.001150369644165039
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  8.225440979003906e-05
r_  generation:  0.0005104541778564453
----------------------check_connections_block total spend ----------------------------- 0.016442060470581055
generate_one_block  0.0046079158782958984
generate_one_block  0.0021619796752929688
generate_one_block  0.001917123794555664
generate_one_block  0.0017864704132080078
generate_one_block  0.0024347305297851562
generate_one_block  0.003301382064819336
generate_one_block  0.002557992935180664
generate_one_block  0.0015926361083984375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0022101402282714844
gen group dst list time:  0.00036406517028808594
time for parepare:  0.0015621185302734375
local_output_nid generation:  0.0003273487091064453
local_in_edges_tensor generation:  0.0011408329010009766
mini_batch_src_global generation:  0.0012140274047851562
r_  generation:  0.010589122772216797
local_output_nid generation:  0.00018358230590820312
local_in_edges_tensor generation:  0.0003726482391357422
mini_batch_src_global generation:  0.0006635189056396484
r_  generation:  0.004843950271606445
local_output_nid generation:  0.0001621246337890625
local_in_edges_tensor generation:  0.0003597736358642578
mini_batch_src_global generation:  0.0005035400390625
r_  generation:  0.004606008529663086
local_output_nid generation:  0.00011754035949707031
local_in_edges_tensor generation:  0.00030040740966796875
mini_batch_src_global generation:  0.00040912628173828125
r_  generation:  0.003725767135620117
local_output_nid generation:  0.00021123886108398438
local_in_edges_tensor generation:  0.0004012584686279297
mini_batch_src_global generation:  0.0005221366882324219
r_  generation:  0.005596160888671875
local_output_nid generation:  0.00025534629821777344
local_in_edges_tensor generation:  0.0011134147644042969
mini_batch_src_global generation:  0.0007188320159912109
r_  generation:  0.0071451663970947266
local_output_nid generation:  0.0002162456512451172
local_in_edges_tensor generation:  0.0003991127014160156
mini_batch_src_global generation:  0.0005915164947509766
r_  generation:  0.005582571029663086
local_output_nid generation:  8.7738037109375e-05
local_in_edges_tensor generation:  0.0002522468566894531
mini_batch_src_global generation:  0.00038313865661621094
r_  generation:  0.003838777542114258
----------------------check_connections_block total spend ----------------------------- 0.06972432136535645
generate_one_block  0.015351057052612305
generate_one_block  0.00814056396484375
generate_one_block  0.00821828842163086
generate_one_block  0.0068950653076171875
generate_one_block  0.008983612060546875
generate_one_block  0.011087417602539062
generate_one_block  0.008774280548095703
generate_one_block  0.0048847198486328125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022993087768554688
gen group dst list time:  0.0012598037719726562
time for parepare:  0.0016837120056152344
local_output_nid generation:  0.0010821819305419922
local_in_edges_tensor generation:  0.0021317005157470703
mini_batch_src_global generation:  0.0018918514251708984
r_  generation:  0.02106499671936035
local_output_nid generation:  0.0007421970367431641
local_in_edges_tensor generation:  0.0013015270233154297
mini_batch_src_global generation:  0.0016341209411621094
r_  generation:  0.013970136642456055
local_output_nid generation:  0.000762939453125
local_in_edges_tensor generation:  0.0011637210845947266
mini_batch_src_global generation:  0.0011811256408691406
r_  generation:  0.015540599822998047
local_output_nid generation:  0.0007190704345703125
local_in_edges_tensor generation:  0.0010519027709960938
mini_batch_src_global generation:  0.0014603137969970703
r_  generation:  0.014445781707763672
local_output_nid generation:  0.0008587837219238281
local_in_edges_tensor generation:  0.001445770263671875
mini_batch_src_global generation:  0.0015909671783447266
r_  generation:  0.016698837280273438
local_output_nid generation:  0.0009791851043701172
local_in_edges_tensor generation:  0.0012230873107910156
mini_batch_src_global generation:  0.001748800277709961
r_  generation:  0.018234968185424805
local_output_nid generation:  0.0008516311645507812
local_in_edges_tensor generation:  0.0011899471282958984
mini_batch_src_global generation:  0.0014944076538085938
r_  generation:  0.0171658992767334
local_output_nid generation:  0.0004642009735107422
local_in_edges_tensor generation:  0.0006511211395263672
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.010071277618408203
----------------------check_connections_block total spend ----------------------------- 0.18735408782958984
generate_one_block  0.028474092483520508
generate_one_block  0.019978046417236328
generate_one_block  0.021284103393554688
generate_one_block  0.02039051055908203
generate_one_block  0.025014400482177734
generate_one_block  0.025222063064575195
generate_one_block  0.024272680282592773
generate_one_block  0.014446496963500977
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019435882568359375
gen group dst list time:  0.002895832061767578
time for parepare:  0.0018236637115478516
local_output_nid generation:  0.001529693603515625
local_in_edges_tensor generation:  0.002465963363647461
mini_batch_src_global generation:  0.0020782947540283203
r_  generation:  0.02523970603942871
local_output_nid generation:  0.001420736312866211
local_in_edges_tensor generation:  0.002373933792114258
mini_batch_src_global generation:  0.002496004104614258
r_  generation:  0.022838830947875977
local_output_nid generation:  0.0014376640319824219
local_in_edges_tensor generation:  0.0021529197692871094
mini_batch_src_global generation:  0.001827239990234375
r_  generation:  0.023223400115966797
local_output_nid generation:  0.0014698505401611328
local_in_edges_tensor generation:  0.0021047592163085938
mini_batch_src_global generation:  0.0018339157104492188
r_  generation:  0.02252483367919922
local_output_nid generation:  0.0015447139739990234
local_in_edges_tensor generation:  0.001982450485229492
mini_batch_src_global generation:  0.0019965171813964844
r_  generation:  0.02369832992553711
local_output_nid generation:  0.001497030258178711
local_in_edges_tensor generation:  0.0020380020141601562
mini_batch_src_global generation:  0.0020720958709716797
r_  generation:  0.02413630485534668
local_output_nid generation:  0.0014884471893310547
local_in_edges_tensor generation:  0.0023183822631835938
mini_batch_src_global generation: Using backend: pytorch
 0.001971006393432617
r_  generation:  0.02445220947265625
local_output_nid generation:  0.0009520053863525391
local_in_edges_tensor generation:  0.0012753009796142578
mini_batch_src_global generation:  0.001607656478881836
r_  generation:  0.01914358139038086
----------------------check_connections_block total spend ----------------------------- 0.27010035514831543
generate_one_block  0.03353238105773926
generate_one_block  0.03087329864501953
generate_one_block  0.031174659729003906
generate_one_block  0.030621051788330078
generate_one_block  0.03085923194885254
generate_one_block  0.032033681869506836
generate_one_block  0.032486677169799805
generate_one_block  0.025043487548828125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 0.11533260345458984  GigaBytes
Max Memory Allocated: 3.67061185836792  GigaBytes

connection checking time:  0.5475287437438965
block generation total time  0.5290079116821289
average batch blocks generation time:  0.06612598896026611
block dataloader generation time/epoch 1.2398755550384521
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 0.11866426467895508  GigaBytes
Max Memory Allocated: 3.67061185836792  GigaBytes

torch.Size([18946, 500])
torch.Size([15908, 256])
torch.Size([11319, 256])
torch.Size([3061, 256])
torch.Size([731, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4627685546875 GB
    Memory Allocated: 4.1860246658325195  GigaBytes
Max Memory Allocated: 4.187204360961914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5018310546875 GB
    Memory Allocated: 0.11676788330078125  GigaBytes
Max Memory Allocated: 4.189857482910156  GigaBytes

torch.Size([18150, 500])
torch.Size([13604, 256])
torch.Size([6628, 256])
torch.Size([1655, 256])
torch.Size([290, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5018310546875 GB
    Memory Allocated: 3.225813388824463  GigaBytes
Max Memory Allocated: 4.189857482910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5018310546875 GB
    Memory Allocated: 0.11664009094238281  GigaBytes
Max Memory Allocated: 4.189857482910156  GigaBytes

torch.Size([18044, 500])
torch.Size([13583, 256])
torch.Size([6504, 256])
torch.Size([1420, 256])
torch.Size([231, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5018310546875 GB
    Memory Allocated: 3.3770594596862793  GigaBytes
Max Memory Allocated: 4.189857482910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5018310546875 GB
    Memory Allocated: 0.11651897430419922  GigaBytes
Max Memory Allocated: 4.189857482910156  GigaBytes

torch.Size([18017, 500])
torch.Size([12906, 256])
torch.Size([6150, 256])
torch.Size([1040, 256])
torch.Size([269, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5018310546875 GB
    Memory Allocated: 3.213602066040039  GigaBytes
Max Memory Allocated: 4.189857482910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5018310546875 GB
    Memory Allocated: 0.11698436737060547  GigaBytes
Max Memory Allocated: 4.189857482910156  GigaBytes

torch.Size([18194, 500])
torch.Size([14136, 256])
torch.Size([7707, 256])
torch.Size([1880, 256])
torch.Size([350, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5018310546875 GB
    Memory Allocated: 3.531240940093994  GigaBytes
Max Memory Allocated: 4.189857482910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5018310546875 GB
    Memory Allocated: 0.11835622787475586  GigaBytes
Max Memory Allocated: 4.189857482910156  GigaBytes

torch.Size([18557, 500])
torch.Size([14802, 256])
torch.Size([8683, 256])
torch.Size([2390, 256])
torch.Size([542, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5018310546875 GB
    Memory Allocated: 3.7660446166992188  GigaBytes
Max Memory Allocated: 4.189857482910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5018310546875 GB
    Memory Allocated: 0.11827230453491211  GigaBytes
Max Memory Allocated: 4.189857482910156  GigaBytes

torch.Size([18505, 500])
torch.Size([14967, 256])
torch.Size([7597, 256])
torch.Size([1987, 256])
torch.Size([362, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5018310546875 GB
    Memory Allocated: 3.6140408515930176  GigaBytes
Max Memory Allocated: 4.189857482910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5018310546875 GB
    Memory Allocated: 0.1111307144165039  GigaBytes
Max Memory Allocated: 4.189857482910156  GigaBytes

torch.Size([15243, 500])
torch.Size([9122, 256])
torch.Size([3644, 256])
torch.Size([751, 256])
torch.Size([134, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5018310546875 GB
    Memory Allocated: 2.539851188659668  GigaBytes
Max Memory Allocated: 4.189857482910156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01725602149963379 |0.0038956105709075928 |0.33628445863723755 |0.0001398921012878418 |0.47696781158447266 |0.011164426803588867 |
----------------------------------------------------------pseudo_mini_loss sum 2.382355213165283
Total (block generation + training)time/epoch 7.953362464904785
Training time/epoch 6.713223457336426
Training time without block to device /epoch 6.682058572769165
Training time without total dataloading part /epoch 6.518301725387573
load block tensor time/epoch 0.1380481719970703
block to device time/epoch 0.031164884567260742
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  328366
Number of first layer input nodes during this epoch:  143656
