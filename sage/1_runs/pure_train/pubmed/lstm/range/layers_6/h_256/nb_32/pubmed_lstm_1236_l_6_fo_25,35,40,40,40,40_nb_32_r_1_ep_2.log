main start at this time 1648534712.382733
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0026357173919677734
range selection method range initialization spend 0.00010013580322265625
time for parepare:  5.316734313964844e-05
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00135040283203125
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.5987625122070312e-05
----------------------check_connections_block total spend ----------------------------- 0.004365682601928711
generate_one_block  0.0014047622680664062
generate_one_block  0.0011811256408691406
generate_one_block  0.0012333393096923828
generate_one_block  0.00115966796875
generate_one_block  0.0011622905731201172
generate_one_block  0.001173257827758789
generate_one_block  0.0011260509490966797
generate_one_block  0.0009799003601074219
generate_one_block  0.0009465217590332031
generate_one_block  0.0009851455688476562
generate_one_block  0.0010387897491455078
generate_one_block  0.0009360313415527344
generate_one_block  0.0009551048278808594
generate_one_block  0.0009350776672363281
generate_one_block  0.0009503364562988281
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0015723705291748047
gen group dst list time:  9.894371032714844e-05
time for parepare:  0.0003249645233154297
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00017118453979492188
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  7.009506225585938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  9.822845458984375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00012350082397460938
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010514259338378906
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.130073547363281e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.867813110351562e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00022220611572265625
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00012087821960449219
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  6.437301635742188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0002028942108154297
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.5299530029296875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.000148773193359375
----------------------check_connections_block total spend ----------------------------- 0.005210399627685547
generate_one_block  0.0014102458953857422
generate_one_block  0.0013079643249511719
generate_one_block  0.0012805461883544922
generate_one_block  0.0012514591217041016
generate_one_block  0.0013408660888671875
generate_one_block  0.0012812614440917969
generate_one_block  0.0010619163513183594
generate_one_block  0.001069784164428711
generate_one_block  0.001241445541381836
generate_one_block  0.0011146068572998047
generate_one_block  0.001094818115234375
generate_one_block  0.0010225772857666016
generate_one_block  0.001172780990600586
generate_one_block  0.0010073184967041016
generate_one_block  0.0011398792266845703
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011639595031738281
gen group dst list time:  0.00015401840209960938
time for parepare:  0.0009152889251708984
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.0003116130828857422
mini_batch_src_global generation:  9.465217590332031e-05
r_  generation:  0.0009479522705078125
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0002923011779785156
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0005087852478027344
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.00046539306640625
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.0007035732269287109
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.0006341934204101562
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0005781650543212891
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.00035190582275390625
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.0014405250549316406
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  8.463859558105469e-05
r_  generation:  0.00039958953857421875
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0004608631134033203
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0003082752227783203
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  0.00014495849609375
r_  generation:  0.0015330314636230469
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.00015783309936523438
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0007071495056152344
----------------------check_connections_block total spend ----------------------------- 0.017283201217651367
generate_one_block  0.0021049976348876953
generate_one_block  0.0012214183807373047
generate_one_block  0.0015022754669189453
generate_one_block  0.0014209747314453125
generate_one_block  0.0016863346099853516
generate_one_block  0.001644134521484375
generate_one_block  0.0016646385192871094
generate_one_block  0.0013513565063476562
generate_one_block  0.003047466278076172
generate_one_block  0.0014252662658691406
generate_one_block  0.0014951229095458984
generate_one_block  0.001322031021118164
generate_one_block  0.002767324447631836
generate_one_block  0.0011119842529296875
generate_one_block  0.0017671585083007812
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021028518676757812
gen group dst list time:  0.00030350685119628906
time for parepare:  0.0017025470733642578
local_output_nid generation:  0.00010538101196289062
local_in_edges_tensor generation:  0.0006384849548339844
mini_batch_src_global generation:  0.0005702972412109375
r_  generation:  0.00448155403137207
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  0.00024127960205078125
r_  generation:  0.0013391971588134766
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.0002605915069580078
mini_batch_src_global generation:  0.0002903938293457031
r_  generation:  0.003009319305419922
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.00024390220642089844
mini_batch_src_global generation:  0.0002541542053222656
r_  generation:  0.0022509098052978516
local_output_nid generation:  9.393692016601562e-05
local_in_edges_tensor generation:  0.00028204917907714844
mini_batch_src_global generation:  0.0003864765167236328
r_  generation:  0.003977537155151367
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.0002639293670654297
mini_batch_src_global generation:  0.0004153251647949219
r_  generation:  0.0034241676330566406
local_output_nid generation:  0.0001220703125
local_in_edges_tensor generation:  0.00028634071350097656
mini_batch_src_global generation:  0.00034689903259277344
r_  generation:  0.0033342838287353516
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.00025010108947753906
r_  generation:  0.0019404888153076172
local_output_nid generation:  0.00015687942504882812
local_in_edges_tensor generation:  0.0003628730773925781
mini_batch_src_global generation:  0.0005950927734375
r_  generation:  0.005947589874267578
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.0002315044403076172
mini_batch_src_global generation:  0.00040411949157714844
r_  generation:  0.002736806869506836
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.00023555755615234375
mini_batch_src_global generation:  0.00025391578674316406
r_  generation:  0.002295255661010742
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.0002541542053222656
r_  generation:  0.002274751663208008
local_output_nid generation:  0.00015354156494140625
local_in_edges_tensor generation:  0.0003402233123779297
mini_batch_src_global generation:  0.0005095005035400391
r_  generation:  0.0055332183837890625
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  0.00023818016052246094
r_  generation:  0.001096963882446289
local_output_nid generation:  0.00011110305786132812
local_in_edges_tensor generation:  0.00026798248291015625
mini_batch_src_global generation:  0.0002684593200683594
r_  generation:  0.003067493438720703
----------------------check_connections_block total spend ----------------------------- 0.07153058052062988
generate_one_block  0.007309913635253906
generate_one_block  0.0026204586029052734
generate_one_block  0.005106687545776367
generate_one_block  0.0036840438842773438
generate_one_block  0.006143808364868164
generate_one_block  0.005370616912841797
generate_one_block  0.005299568176269531
generate_one_block  0.0034601688385009766
generate_one_block  0.009117364883422852
generate_one_block  0.00455164909362793
generate_one_block  0.003967761993408203
generate_one_block  0.004015445709228516
generate_one_block  0.008243083953857422
generate_one_block  0.0022346973419189453
generate_one_block  0.004898786544799805
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022630691528320312
gen group dst list time:  0.0016145706176757812
time for parepare:  0.0018000602722167969
local_output_nid generation:  0.0006165504455566406
local_in_edges_tensor generation:  0.0016062259674072266
mini_batch_src_global generation:  0.0012907981872558594
r_  generation:  0.013440132141113281
local_output_nid generation:  0.00022912025451660156
local_in_edges_tensor generation:  0.0005068778991699219
mini_batch_src_global generation:  0.0009057521820068359
r_  generation:  0.0057544708251953125
local_output_nid generation:  0.0004172325134277344
local_in_edges_tensor generation:  0.0007791519165039062
mini_batch_src_global generation:  0.0010349750518798828
r_  generation:  0.010657072067260742
local_output_nid generation:  0.00036144256591796875
local_in_edges_tensor generation:  0.0006518363952636719
mini_batch_src_global generation:  0.0010066032409667969
r_  generation:  0.009957551956176758
local_output_nid generation:  0.0006036758422851562
local_in_edges_tensor generation:  0.0009703636169433594
mini_batch_src_global generation:  0.001068115234375
r_  generation:  0.013672828674316406
local_output_nid generation:  0.0004096031188964844
local_in_edges_tensor generation:  0.0006625652313232422
mini_batch_src_global generation:  0.0011487007141113281
r_  generation:  0.010705947875976562
local_output_nid generation:  0.0004513263702392578
local_in_edges_tensor generation:  0.0007131099700927734
mini_batch_src_global generation:  0.0008752346038818359
r_  generation:  0.011347293853759766
local_output_nid generation:  0.00034546852111816406
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.00090789794921875
r_  generation:  0.008293390274047852
local_output_nid generation:  0.0005955696105957031
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.0012347698211669922
r_  generation:  0.014824151992797852
local_output_nid generation:  0.0003261566162109375
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.000990152359008789
r_  generation:  0.008603811264038086
local_output_nid generation:  0.00036907196044921875
local_in_edges_tensor generation:  0.0005953311920166016
mini_batch_src_global generation:  0.0008082389831542969
r_  generation:  0.008339405059814453
local_output_nid generation:  0.00035691261291503906
local_in_edges_tensor generation:  0.0018649101257324219
mini_batch_src_global generation:  0.0009953975677490234
r_  generation:  0.010029077529907227
local_output_nid generation:  0.00042748451232910156
local_in_edges_tensor generation:  0.0008857250213623047
mini_batch_src_global generation:  0.0009407997131347656
r_  generation:  0.011479377746582031
local_output_nid generation:  0.00018644332885742188
local_in_edges_tensor generation:  0.00038933753967285156
mini_batch_src_global generation:  0.0007390975952148438
r_  generation:  0.00545048713684082
local_output_nid generation:  0.0004096031188964844
local_in_edges_tensor generation:  0.0006659030914306641
mini_batch_src_global generation:  0.0008037090301513672
r_  generation:  0.00922536849975586
----------------------check_connections_block total spend ----------------------------- 0.22300457954406738
generate_one_block  0.017873525619506836
generate_one_block  0.009020090103149414
generate_one_block  0.015317440032958984
generate_one_block  0.014278411865234375
generate_one_block  0.018897294998168945
generate_one_block  0.015037775039672852
generate_one_block  0.015829801559448242
generate_one_block  0.013402223587036133
generate_one_block  0.018913745880126953
generate_one_block  0.012981653213500977
generate_one_block  0.012365341186523438
generate_one_block  0.013273954391479492
generate_one_block  0.01703476905822754
generate_one_block  0.008722543716430664
generate_one_block  0.012897729873657227
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00229644775390625
gen group dst list time:  0.004380941390991211
time for parepare:  0.0017206668853759766
local_output_nid generation:  0.0011222362518310547
local_in_edges_tensor generation:  0.0025634765625
mini_batch_src_global generation:  0.002149820327758789
r_  generation:  0.02150130271911621
local_output_nid generation:  0.0007481575012207031
local_in_edges_tensor generation:  0.0015723705291748047
mini_batch_src_global generation:  0.0019235610961914062
r_  generation:  0.015503406524658203
local_output_nid generation:  0.0011069774627685547
local_in_edges_tensor generation:  0.001802206039428711
mini_batch_src_global generation:  0.001657247543334961
r_  generation:  0.019928693771362305
local_output_nid generation:  0.0011954307556152344
local_in_edges_tensor generation:  0.001588582992553711
mini_batch_src_global generation:  0.0020754337310791016
r_  generation:  0.020132064819335938
local_output_nid generation:  0.0012586116790771484
local_in_edges_tensor generation:  0.0018029212951660156
mini_batch_src_global generation:  0.0018057823181152344
r_  generation:  0.022022247314453125
local_output_nid generation:  0.0010187625885009766
local_in_edges_tensor generation:  0.0016088485717773438
mini_batch_src_global generation:  0.0017731189727783203
r_  generation:  0.019016027450561523
local_output_nid generation:  0.0012581348419189453
local_in_edges_tensor generation:  0.002071380615234375
mini_batch_src_global generation:  0.0017094612121582031
r_  generation:  0.021368741989135742
local_output_nid generation:  0.0010006427764892578
local_in_edges_tensor generation:  0.001415252685546875
mini_batch_src_global generation:  0.0016527175903320312
r_  generation:  0.0185089111328125
local_output_nid generation:  0.0011653900146484375
local_in_edges_tensor generation:  0.0019752979278564453
mini_batch_src_global generation:  0.0019402503967285156
r_  generation:  0.02181220054626465
local_output_nid generation:  0.0009844303131103516
local_in_edges_tensor generation:  0.0012896060943603516
mini_batch_src_global generation:  0.0016422271728515625
r_  generation:  0.017620563507080078
local_output_nid generation:  0.001123666763305664
local_in_edges_tensor generation:  0.0017392635345458984
mini_batch_src_global generation:  0.001760244369506836
r_  generation:  0.01944589614868164
local_output_nid generation:  0.0010116100311279297
local_in_edges_tensor generation:  0.001562356948852539
mini_batch_src_global generation:  0.001861572265625
r_  generation:  0.019321203231811523
local_output_nid generation:  0.0009770393371582031
local_in_edges_tensor generation:  0.0013091564178466797
mini_batch_src_global generation:  0.001634836196899414
r_  generation:  0.01807236671447754
local_output_nid generation:  0.0006668567657470703
local_in_edges_tensor generation:  0.0009210109710693359
mini_batch_src_global generation:  0.0013337135314941406
r_  generation:  0.013619184494018555
local_output_nid generation:  0.0011129379272460938
local_in_edges_tensor generation:  0.0015897750854492188
mini_batch_src_global generation:  0.0014483928680419922
r_  generation:  0.019395112991333008
----------------------check_connections_block total spend ----------------------------- 0.42012810707092285
generate_one_block  0.027535200119018555
generate_one_block  0.021377086639404297
generate_one_block  0.026035785675048828
generate_one_block  0.026752233505249023
generate_one_block  0.02869582176208496
generate_one_block  0.023964881896972656
generate_one_block  0.0277712345123291
generate_one_block  0.024755239486694336
generate_one_block  0.028010845184326172
generate_one_block  0.02360367774963379
generate_one_block  0.028500795364379883
generate_one_block  0.02617669105529785
generate_one_block  0.023831844329833984
generate_one_block  0.018657445907592773
generate_one_block  0.024830102920532227
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02020406723022461  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

connection checking time:  0.737156867980957
block generation total time  0.7156991958618164
average batch blocks generation time:  0.047713279724121094
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.05508136749267578  GigaBytes
Max Memory Allocated: 0.05508136749267578  GigaBytes

torch.Size([18199, 500])
torch.Size([12863, 256])
torch.Size([7499, 256])
torch.Size([1375, 256])
torch.Size([334, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3143310546875 GB
    Memory Allocated: 3.0975098609924316  GigaBytes
Max Memory Allocated: 3.0975565910339355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4373779296875 GB
    Memory Allocated: 0.06932926177978516  GigaBytes
Max Memory Allocated: 3.102963447570801  GigaBytes

torch.Size([15019, 500])
torch.Size([7763, 256])
torch.Size([2481, 256])
torch.Size([430, 256])
torch.Size([108, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4373779296875 GB
    Memory Allocated: 1.959639072418213  GigaBytes
Max Memory Allocated: 3.102963447570801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4373779296875 GB
    Memory Allocated: 0.07297945022583008  GigaBytes
Max Memory Allocated: 3.102963447570801  GigaBytes

torch.Size([16826, 500])
torch.Size([10780, 256])
torch.Size([4423, 256])
torch.Size([847, 256])
torch.Size([177, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4373779296875 GB
    Memory Allocated: 2.7646327018737793  GigaBytes
Max Memory Allocated: 3.102963447570801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4373779296875 GB
    Memory Allocated: 0.07261514663696289  GigaBytes
Max Memory Allocated: 3.102963447570801  GigaBytes

torch.Size([16651, 500])
torch.Size([11054, 256])
torch.Size([3590, 256])
torch.Size([720, 256])
torch.Size([123, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4373779296875 GB
    Memory Allocated: 2.6879615783691406  GigaBytes
Max Memory Allocated: 3.102963447570801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4373779296875 GB
    Memory Allocated: 0.07520198822021484  GigaBytes
Max Memory Allocated: 3.102963447570801  GigaBytes

torch.Size([17949, 500])
torch.Size([12649, 256])
torch.Size([6614, 256])
torch.Size([1047, 256])
torch.Size([269, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5897216796875 GB
    Memory Allocated: 3.1339683532714844  GigaBytes
Max Memory Allocated: 3.1341700553894043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5936279296875 GB
    Memory Allocated: 0.07153463363647461  GigaBytes
Max Memory Allocated: 3.1378464698791504  GigaBytes

torch.Size([16054, 500])
torch.Size([9842, 256])
torch.Size([4409, 256])
torch.Size([988, 256])
torch.Size([187, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5936279296875 GB
    Memory Allocated: 2.6975717544555664  GigaBytes
Max Memory Allocated: 3.1378464698791504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5936279296875 GB
    Memory Allocated: 0.07405614852905273  GigaBytes
Max Memory Allocated: 3.1378464698791504  GigaBytes

torch.Size([17385, 500])
torch.Size([12778, 256])
torch.Size([4774, 256])
torch.Size([1391, 256])
torch.Size([136, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5936279296875 GB
    Memory Allocated: 2.899362564086914  GigaBytes
Max Memory Allocated: 3.1378464698791504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5936279296875 GB
    Memory Allocated: 0.07112836837768555  GigaBytes
Max Memory Allocated: 3.1378464698791504  GigaBytes

torch.Size([15891, 500])
torch.Size([9337, 256])
torch.Size([3429, 256])
torch.Size([570, 256])
torch.Size([116, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5936279296875 GB
    Memory Allocated: 2.4722046852111816  GigaBytes
Max Memory Allocated: 3.1378464698791504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5936279296875 GB
    Memory Allocated: 0.07447624206542969  GigaBytes
Max Memory Allocated: 3.1378464698791504  GigaBytes

torch.Size([17499, 500])
torch.Size([12390, 256])
torch.Size([7203, 256])
torch.Size([1881, 256])
torch.Size([412, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8123779296875 GB
    Memory Allocated: 3.332029342651367  GigaBytes
Max Memory Allocated: 3.3321495056152344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 0.07043838500976562  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

torch.Size([15517, 500])
torch.Size([8845, 256])
torch.Size([3567, 256])
torch.Size([698, 256])
torch.Size([128, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 2.437659740447998  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 0.07348871231079102  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

torch.Size([17150, 500])
torch.Size([10536, 256])
torch.Size([4117, 256])
torch.Size([948, 256])
torch.Size([172, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 2.5556211471557617  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 0.07265520095825195  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

torch.Size([16681, 500])
torch.Size([9653, 256])
torch.Size([3978, 256])
torch.Size([593, 256])
torch.Size([101, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 2.618680000305176  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 0.0696558952331543  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

torch.Size([14997, 500])
torch.Size([9654, 256])
torch.Size([5058, 256])
torch.Size([1731, 256])
torch.Size([330, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 2.833127975463867  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 0.06366491317749023  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

torch.Size([12004, 500])
torch.Size([6269, 256])
torch.Size([1789, 256])
torch.Size([294, 256])
torch.Size([46, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 1.7623729705810547  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 0.07310819625854492  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

torch.Size([16932, 500])
torch.Size([10970, 256])
torch.Size([4820, 256])
torch.Size([1321, 256])
torch.Size([282, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 2.5759739875793457  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014707438151041667 |0.02484100659688314 |0.34228798548380535 |0.0001453558603922526 |0.4212395032246908 |0.011533975601196289 |
----------------------------------------------------------pseudo_mini_loss sum 2.034576177597046
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  486000
Number of first layer input nodes during this epoch:  244754
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 0.1150827407836914  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0009121894836425781
range selection method range initialization spend 7.2479248046875e-05
time for parepare:  8.082389831542969e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  5.91278076171875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.430511474609375e-05
----------------------check_connections_block total spend ----------------------------- 0.003045797348022461
generate_one_block  0.0016651153564453125
generate_one_block  0.0011103153228759766
generate_one_block  0.0010724067687988281
generate_one_block  0.0010724067687988281
generate_one_block  0.0010814666748046875
generate_one_block  0.0010635852813720703
generate_one_block  0.001051187515258789
generate_one_block  0.0010616779327392578
generate_one_block  0.0010766983032226562
generate_one_block  0.0010530948638916016
generate_one_block  0.0010478496551513672
generate_one_block  0.0011773109436035156
generate_one_block  0.0010876655578613281
generate_one_block  0.0010707378387451172
generate_one_block  0.0010571479797363281
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0008766651153564453
gen group dst list time:  9.036064147949219e-05
time for parepare:  0.00038933753967285156
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0002288818359375
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00020837783813476562
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.00019311904907226562
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.605552673339844e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  5.91278076171875e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  6.67572021484375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00012445449829101562
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.246566772460938e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00021886825561523438
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00017070770263671875
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.987022399902344e-05
----------------------check_connections_block total spend ----------------------------- 0.005412101745605469
generate_one_block  0.0014717578887939453
generate_one_block  0.0013532638549804688
generate_one_block  0.001177072525024414
generate_one_block  0.0011742115020751953
generate_one_block  0.0011363029479980469
generate_one_block  0.0011644363403320312
generate_one_block  0.0011687278747558594
generate_one_block  0.0011746883392333984
generate_one_block  0.0018618106842041016
generate_one_block  0.001094818115234375
generate_one_block  0.0010373592376708984
generate_one_block  0.0012886524200439453
generate_one_block  0.0012187957763671875
generate_one_block  0.0010106563568115234
generate_one_block  0.0010581016540527344
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013854503631591797
gen group dst list time:  0.00016045570373535156
time for parepare:  0.0010612010955810547
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.0003962516784667969
mini_batch_src_global generation:  0.00028634071350097656
r_  generation:  0.0016169548034667969
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.00023317337036132812
mini_batch_src_global generation:  0.0001919269561767578
r_  generation:  0.0011682510375976562
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0003685951232910156
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0006313323974609375
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.00045108795166015625
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.00034165382385253906
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.000278472900390625
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0004401206970214844
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0007317066192626953
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.00042819976806640625
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00029850006103515625
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.00015664100646972656
r_  generation:  0.0015246868133544922
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  0.0001392364501953125
r_  generation:  0.0010037422180175781
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0002608299255371094
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0005095005035400391
----------------------check_connections_block total spend ----------------------------- 0.01902914047241211
generate_one_block  0.0031769275665283203
generate_one_block  0.002569437026977539
generate_one_block  0.001371145248413086
generate_one_block  0.0018811225891113281
generate_one_block  0.001567840576171875
generate_one_block  0.0014753341674804688
generate_one_block  0.00125885009765625
generate_one_block  0.0014858245849609375
generate_one_block  0.0019369125366210938
generate_one_block  0.0015077590942382812
generate_one_block  0.0013170242309570312
generate_one_block  0.002918243408203125
generate_one_block  0.0022029876708984375
generate_one_block  0.0012505054473876953
generate_one_block  0.0015988349914550781
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002131223678588867
gen group dst list time:  0.00040721893310546875
time for parepare:  0.0018036365509033203
local_output_nid generation:  0.00019860267639160156
local_in_edges_tensor generation:  0.0008802413940429688
mini_batch_src_global generation:  0.0007908344268798828
r_  generation:  0.005816936492919922
local_output_nid generation:  0.00020194053649902344
local_in_edges_tensor generation:  0.00046634674072265625
mini_batch_src_global generation:  0.0008909702301025391
r_  generation:  0.00699305534362793
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  0.0003261566162109375
r_  generation:  0.0015566349029541016
local_output_nid generation:  0.0001575946807861328
local_in_edges_tensor generation:  0.0003304481506347656
mini_batch_src_global generation:  0.00033736228942871094
r_  generation:  0.0036857128143310547
local_output_nid generation:  0.00010633468627929688
local_in_edges_tensor generation:  0.0002944469451904297
mini_batch_src_global generation:  0.0003714561462402344
r_  generation:  0.0032265186309814453
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  0.00023555755615234375
r_  generation:  0.001636505126953125
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  0.00015664100646972656
r_  generation:  0.0010612010955810547
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.0002605915069580078
mini_batch_src_global generation:  0.0002696514129638672
r_  generation:  0.002717256546020508
local_output_nid generation:  0.0001552104949951172
local_in_edges_tensor generation:  0.0003120899200439453
mini_batch_src_global generation:  0.00037384033203125
r_  generation:  0.0037238597869873047
local_output_nid generation:  8.845329284667969e-05
local_in_edges_tensor generation:  0.000274658203125
mini_batch_src_global generation:  0.00033164024353027344
r_  generation:  0.0025963783264160156
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.00021123886108398438
r_  generation:  0.0014722347259521484
local_output_nid generation:  0.0002243518829345703
local_in_edges_tensor generation:  0.0004229545593261719
mini_batch_src_global generation:  0.0005156993865966797
r_  generation:  0.005851268768310547
local_output_nid generation:  0.0001842975616455078
local_in_edges_tensor generation:  0.0003590583801269531
mini_batch_src_global generation:  0.00047016143798828125
r_  generation:  0.004109621047973633
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  0.00027251243591308594
r_  generation:  0.001741647720336914
local_output_nid generation:  9.5367431640625e-05
local_in_edges_tensor generation:  0.0002689361572265625
mini_batch_src_global generation:  0.0003008842468261719
r_  generation:  0.0029020309448242188
----------------------check_connections_block total spend ----------------------------- 0.07662844657897949
generate_one_block  0.009742498397827148
generate_one_block  0.010811090469360352
generate_one_block  0.0031762123107910156
generate_one_block  0.006799221038818359
generate_one_block  0.00547480583190918
generate_one_block  0.003414630889892578
generate_one_block  0.0025093555450439453
generate_one_block  0.005143642425537109
generate_one_block  0.006017208099365234
generate_one_block  0.004883766174316406
generate_one_block  0.003125905990600586
generate_one_block  0.009238958358764648
generate_one_block  0.0066852569580078125
generate_one_block  0.0033915042877197266
generate_one_block  0.0050313472747802734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023746490478515625
gen group dst list time:  0.0017559528350830078
time for parepare:  0.0018253326416015625
local_output_nid generation:  0.0007145404815673828
local_in_edges_tensor generation:  0.0016307830810546875
mini_batch_src_global generation:  0.001325845718383789
r_  generation:  0.012294769287109375
local_output_nid generation:  0.00103759765625
local_in_edges_tensor generation:  0.0014595985412597656
mini_batch_src_global generation:  0.0018918514251708984
r_  generation:  0.01860523223876953
local_output_nid generation:  0.0003826618194580078
local_in_edges_tensor generation:  0.0005397796630859375
mini_batch_src_global generation:  0.0006916522979736328
r_  generation:  0.0053179264068603516
local_output_nid generation:  0.0007226467132568359
local_in_edges_tensor generation:  0.0008833408355712891
mini_batch_src_global generation:  0.0010182857513427734
r_  generation:  0.01279306411743164
local_output_nid generation:  0.0005578994750976562
local_in_edges_tensor generation:  0.0007555484771728516
mini_batch_src_global generation:  0.00107574462890625
r_  generation:  0.011233329772949219
local_output_nid generation:  0.0003917217254638672
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.0007476806640625
r_  generation:  0.006333112716674805
local_output_nid generation:  0.0002601146697998047
local_in_edges_tensor generation:  0.0004329681396484375
mini_batch_src_global generation:  0.00046706199645996094
r_  generation:  0.004099845886230469
local_output_nid generation:  0.0006043910980224609
local_in_edges_tensor generation:  0.0007574558258056641
mini_batch_src_global generation:  0.0009405612945556641
r_  generation:  0.011916637420654297
local_output_nid generation:  0.0006420612335205078
local_in_edges_tensor generation:  0.00083160400390625
mini_batch_src_global generation:  0.0010828971862792969
r_  generation:  0.013031005859375
local_output_nid generation:  0.0006389617919921875
local_in_edges_tensor generation:  0.0009176731109619141
mini_batch_src_global generation:  0.0010786056518554688
r_  generation:  0.011431455612182617
local_output_nid generation:  0.00039505958557128906
local_in_edges_tensor generation:  0.0005748271942138672
mini_batch_src_global generation:  0.0007114410400390625
r_  generation:  0.005791425704956055
local_output_nid generation:  0.0007736682891845703
local_in_edges_tensor generation:  0.0009098052978515625
mini_batch_src_global generation:  0.0011360645294189453
r_  generation:  0.014805316925048828
local_output_nid generation:  0.0007958412170410156
local_in_edges_tensor generation:  0.0010466575622558594
mini_batch_src_global generation:  0.0013461112976074219
r_  generation:  0.014678001403808594
local_output_nid generation:  0.0003497600555419922
local_in_edges_tensor generation:  0.000492095947265625
mini_batch_src_global generation:  0.0008265972137451172
r_  generation:  0.007030963897705078
local_output_nid generation:  0.0005183219909667969
local_in_edges_tensor generation:  0.00067901611328125
mini_batch_src_global generation:  0.0009746551513671875
r_  generation:  0.010192394256591797
----------------------check_connections_block total spend ----------------------------- 0.23616385459899902
generate_one_block  0.02025008201599121
generate_one_block  0.027067899703979492
generate_one_block  0.00894021987915039
generate_one_block  0.01757192611694336
generate_one_block  0.016736268997192383
generate_one_block  0.010734081268310547
generate_one_block  0.007193565368652344
generate_one_block  0.01688075065612793
generate_one_block  0.019277572631835938
generate_one_block  0.016223907470703125
generate_one_block  0.00977182388305664
generate_one_block  0.020153522491455078
generate_one_block  0.021364927291870117
generate_one_block  0.011864662170410156
generate_one_block  0.013837099075317383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0031218528747558594
gen group dst list time:  0.004422187805175781
time for parepare:  0.001932382583618164
local_output_nid generation:  0.0012655258178710938
local_in_edges_tensor generation:  0.0021042823791503906
mini_batch_src_global generation:  0.0017440319061279297
r_  generation:  0.01961827278137207
local_output_nid generation:  0.0016446113586425781
local_in_edges_tensor generation:  0.002545595169067383
mini_batch_src_global generation:  0.002755880355834961
r_  generation:  0.0242156982421875
local_output_nid generation:  0.0008072853088378906
local_in_edges_tensor generation:  0.0010449886322021484
mini_batch_src_global generation:  0.0013375282287597656
r_  generation:  0.013235092163085938
local_output_nid generation:  0.0015451908111572266
local_in_edges_tensor generation:  0.0018181800842285156
mini_batch_src_global generation:  0.0016298294067382812
r_  generation:  0.022264957427978516
local_output_nid generation:  0.0012087821960449219
local_in_edges_tensor generation:  0.0018978118896484375
mini_batch_src_global generation:  0.001764535903930664
r_  generation:  0.019948244094848633
local_output_nid generation:  0.0009434223175048828
local_in_edges_tensor generation:  0.0011801719665527344
mini_batch_src_global generation:  0.0013287067413330078
r_  generation:  0.015263795852661133
local_output_nid generation:  0.0007786750793457031
local_in_edges_tensor generation:  0.0009832382202148438
mini_batch_src_global generation:  0.0011529922485351562
r_  generation:  0.012548208236694336
local_output_nid generation:  0.0012521743774414062
local_in_edges_tensor generation:  0.0016617774963378906
mini_batch_src_global generation:  0.0017242431640625
r_  generation:  0.02013683319091797
local_output_nid generation:  0.0012774467468261719
local_in_edges_tensor generation:  0.0019237995147705078
mini_batch_src_global generation:  0.0017633438110351562
r_  generation:  0.0211789608001709
local_output_nid generation:  0.001157522201538086
local_in_edges_tensor generation:  0.001417398452758789
mini_batch_src_global generation:  0.0017058849334716797
r_  generation:  0.0203855037689209
local_output_nid generation:  0.0008687973022460938
local_in_edges_tensor generation:  0.0010623931884765625
mini_batch_src_global generation:  0.0013265609741210938
r_  generation:  0.01420903205871582
local_output_nid generation:  0.001458883285522461
local_in_edges_tensor generation:  0.0016257762908935547
mini_batch_src_global generation:  0.0018165111541748047
r_  generation:  0.022028684616088867
local_output_nid generation:  0.0014827251434326172
local_in_edges_tensor generation:  0.0023932456970214844
mini_batch_src_global generation:  0.0020592212677001953
r_  generation:  0.023615598678588867
local_output_nid generation:  0.0008141994476318359
local_in_edges_tensor generation:  0.0010383129119873047
mini_batch_src_global generation:  0.0015103816986083984
r_  generation:  0.015594005584716797
local_output_nid generation:  0.0010826587677001953
local_in_edges_tensor generation:  0.0012860298156738281
mini_batch_src_global generation:  0.001447439193725586
r_  generation:  0.01846790313720703
----------------------check_connections_block total spend ----------------------------- 0.41512489318847656
generate_one_block  0.02644801139831543
generate_one_block  0.03350567817687988
generate_one_block  0.01876354217529297
generate_one_block  0.029472827911376953
generate_one_block  0.027272462844848633
generate_one_block  0.0209043025970459
generate_one_block  0.017307281494140625
generate_one_block  0.027193546295166016
generate_one_block  0.028604507446289062
generate_one_block  0.027822256088256836
generate_one_block  0.019568443298339844
generate_one_block  0.03272700309753418
generate_one_block  0.0332033634185791
generate_one_block  0.02157449722290039
generate_one_block  0.025411367416381836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 0.1150827407836914  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

connection checking time:  0.7523584365844727
block generation total time  0.7590022087097168
average batch blocks generation time:  0.05060014724731445
block dataloader generation time/epoch 1.794459581375122
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 0.11130046844482422  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

torch.Size([15487, 500])
torch.Size([10257, 256])
torch.Size([5039, 256])
torch.Size([1590, 256])
torch.Size([339, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 2.9400148391723633  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 0.11786699295043945  GigaBytes
Max Memory Allocated: 3.3358893394470215  GigaBytes

torch.Size([18676, 500])
torch.Size([14722, 256])
torch.Size([9591, 256])
torch.Size([1778, 256])
torch.Size([399, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 3.7133431434631348  GigaBytes
Max Memory Allocated: 3.7134881019592285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 0.10785436630249023  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

torch.Size([13893, 500])
torch.Size([6433, 256])
torch.Size([2754, 256])
torch.Size([449, 256])
torch.Size([158, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 1.660841464996338  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 0.11530828475952148  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

torch.Size([17648, 500])
torch.Size([13123, 256])
torch.Size([5502, 256])
torch.Size([1400, 256])
torch.Size([135, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 3.0605568885803223  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 0.11231565475463867  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

torch.Size([16090, 500])
torch.Size([10115, 256])
torch.Size([4030, 256])
torch.Size([914, 256])
torch.Size([97, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 2.736989974975586  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 0.10942459106445312  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

torch.Size([14696, 500])
torch.Size([7837, 256])
torch.Size([2980, 256])
torch.Size([513, 256])
torch.Size([134, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 1.899120807647705  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 0.10730981826782227  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

torch.Size([13304, 500])
torch.Size([5986, 256])
torch.Size([1907, 256])
torch.Size([364, 256])
torch.Size([117, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 1.4939546585083008  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 0.11305570602416992  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

torch.Size([16479, 500])
torch.Size([10421, 256])
torch.Size([4699, 256])
torch.Size([691, 256])
torch.Size([152, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 2.792881965637207  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 0.11268043518066406  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

torch.Size([16247, 500])
torch.Size([11662, 256])
torch.Size([4764, 256])
torch.Size([1295, 256])
torch.Size([189, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 2.945758819580078  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 0.11376285552978516  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

torch.Size([16871, 500])
torch.Size([10208, 256])
torch.Size([4759, 256])
torch.Size([674, 256])
torch.Size([161, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 2.759760856628418  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 0.10823583602905273  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

torch.Size([14082, 500])
torch.Size([7041, 256])
torch.Size([3003, 256])
torch.Size([455, 256])
torch.Size([132, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 1.7621488571166992  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 0.11456918716430664  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

torch.Size([17178, 500])
torch.Size([12577, 256])
torch.Size([6246, 256])
torch.Size([1928, 256])
torch.Size([407, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 3.315842628479004  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 0.11632156372070312  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

torch.Size([18147, 500])
torch.Size([13774, 256])
torch.Size([6090, 256])
torch.Size([1612, 256])
torch.Size([296, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 3.2767200469970703  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 0.10750436782836914  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

torch.Size([13233, 500])
torch.Size([6845, 256])
torch.Size([2489, 256])
torch.Size([397, 256])
torch.Size([66, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 2.0510354042053223  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 0.11092090606689453  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

torch.Size([15374, 500])
torch.Size([9095, 256])
torch.Size([3732, 256])
torch.Size([773, 256])
torch.Size([133, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1405029296875 GB
    Memory Allocated: 2.555795192718506  GigaBytes
Max Memory Allocated: 3.7172088623046875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014864889780680339 |0.003762038548787435 |0.3014408588409424 |0.000145721435546875 |0.41516528129577634 |0.01275777816772461 |
----------------------------------------------------------pseudo_mini_loss sum 2.0820960998535156
Total (block generation + training)time/epoch 12.8865225315094
Training time/epoch 11.09177279472351
Training time without block to device /epoch 11.0353422164917
Training time without total dataloading part /epoch 10.764035701751709
load block tensor time/epoch 0.22297334671020508
block to device time/epoch 0.05643057823181152
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  473191
Number of first layer input nodes during this epoch:  237405
