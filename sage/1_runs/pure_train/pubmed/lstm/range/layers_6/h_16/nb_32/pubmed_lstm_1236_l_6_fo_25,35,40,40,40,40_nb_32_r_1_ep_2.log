main start at this time 1648534278.451038
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00165557861328125
range selection method range initialization spend 0.00010061264038085938
time for parepare:  4.553794860839844e-05
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.0012216567993164062
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.71661376953125e-05
----------------------check_connections_block total spend ----------------------------- 0.003994941711425781
generate_one_block  0.0012106895446777344
generate_one_block  0.0009982585906982422
generate_one_block  0.0010840892791748047
generate_one_block  0.0010099411010742188
generate_one_block  0.0009839534759521484
generate_one_block  0.00102996826171875
generate_one_block  0.0010135173797607422
generate_one_block  0.0010235309600830078
generate_one_block  0.0009846687316894531
generate_one_block  0.0010309219360351562
generate_one_block  0.0010328292846679688
generate_one_block  0.0009202957153320312
generate_one_block  0.0010042190551757812
generate_one_block  0.0009367465972900391
generate_one_block  0.0009293556213378906
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011649131774902344
gen group dst list time:  7.843971252441406e-05
time for parepare:  0.0002765655517578125
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00012159347534179688
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.343292236328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  9.465217590332031e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.000118255615234375
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00015854835510253906
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.580352783203125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00014591217041015625
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.580352783203125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.000171661376953125
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00010943412780761719
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.104873657226562e-05
----------------------check_connections_block total spend ----------------------------- 0.004637241363525391
generate_one_block  0.0012035369873046875
generate_one_block  0.0010921955108642578
generate_one_block  0.0010898113250732422
generate_one_block  0.00113677978515625
generate_one_block  0.0010673999786376953
generate_one_block  0.0010976791381835938
generate_one_block  0.001196146011352539
generate_one_block  0.001237630844116211
generate_one_block  0.0011010169982910156
generate_one_block  0.0011453628540039062
generate_one_block  0.0011813640594482422
generate_one_block  0.0009965896606445312
generate_one_block  0.0011508464813232422
generate_one_block  0.0010406970977783203
generate_one_block  0.001003265380859375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012278556823730469
gen group dst list time:  0.000125885009765625
time for parepare:  0.0007567405700683594
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0006058216094970703
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0001811981201171875
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0004410743713378906
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.0007848739624023438
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.00033783912658691406
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.00042128562927246094
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  9.131431579589844e-05
r_  generation:  0.0008571147918701172
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  0.0001308917999267578
r_  generation:  0.0013053417205810547
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.0004687309265136719
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00041556358337402344
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.00083160400390625
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0004513263702392578
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  0.00013566017150878906
r_  generation:  0.0014119148254394531
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  8.726119995117188e-05
r_  generation:  0.0004966259002685547
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  0.0001068115234375
r_  generation:  0.00047206878662109375
----------------------check_connections_block total spend ----------------------------- 0.016629457473754883
generate_one_block  0.0018246173858642578
generate_one_block  0.0011246204376220703
generate_one_block  0.0014271736145019531
generate_one_block  0.0019016265869140625
generate_one_block  0.0012688636779785156
generate_one_block  0.0014057159423828125
generate_one_block  0.001940011978149414
generate_one_block  0.002471446990966797
generate_one_block  0.001800537109375
generate_one_block  0.0014030933380126953
generate_one_block  0.0018324851989746094
generate_one_block  0.001424551010131836
generate_one_block  0.0025136470794677734
generate_one_block  0.0014424324035644531
generate_one_block  0.0015094280242919922
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002240419387817383
gen group dst list time:  0.00032520294189453125
time for parepare:  0.0017447471618652344
local_output_nid generation:  8.821487426757812e-05
local_in_edges_tensor generation:  0.0005266666412353516
mini_batch_src_global generation:  0.00039458274841308594
r_  generation:  0.003380298614501953
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.0002014636993408203
r_  generation:  0.0011768341064453125
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.0002455711364746094
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.002415895462036133
local_output_nid generation:  0.00014066696166992188
local_in_edges_tensor generation:  0.0003414154052734375
mini_batch_src_global generation:  0.00045180320739746094
r_  generation:  0.0043697357177734375
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.001832723617553711
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.00021982192993164062
r_  generation:  0.0021240711212158203
local_output_nid generation:  0.00012135505676269531
local_in_edges_tensor generation:  0.00032210350036621094
mini_batch_src_global generation:  0.0004444122314453125
r_  generation:  0.0050046443939208984
local_output_nid generation:  0.0001220703125
local_in_edges_tensor generation:  0.00032329559326171875
mini_batch_src_global generation:  0.0006086826324462891
r_  generation:  0.004904747009277344
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  0.0003414154052734375
r_  generation:  0.0029544830322265625
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.00022745132446289062
mini_batch_src_global generation:  0.00033545494079589844
r_  generation:  0.0032396316528320312
local_output_nid generation:  0.00011587142944335938
local_in_edges_tensor generation:  0.0002779960632324219
mini_batch_src_global generation:  0.0003287792205810547
r_  generation:  0.0033178329467773438
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  0.0002942085266113281
r_  generation:  0.0026035308837890625
local_output_nid generation:  0.00011420249938964844
local_in_edges_tensor generation:  0.0003063678741455078
mini_batch_src_global generation:  0.00047779083251953125
r_  generation:  0.004799604415893555
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.0003190040588378906
r_  generation:  0.00243377685546875
local_output_nid generation:  9.608268737792969e-05
local_in_edges_tensor generation:  0.0002541542053222656
mini_batch_src_global generation:  0.0003376007080078125
r_  generation:  0.0034666061401367188
----------------------check_connections_block total spend ----------------------------- 0.07275724411010742
generate_one_block  0.005286693572998047
generate_one_block  0.0023679733276367188
generate_one_block  0.004161357879638672
generate_one_block  0.006097078323364258
generate_one_block  0.0031371116638183594
generate_one_block  0.0035614967346191406
generate_one_block  0.008331537246704102
generate_one_block  0.007367610931396484
generate_one_block  0.00467228889465332
generate_one_block  0.005519866943359375
generate_one_block  0.00594329833984375
generate_one_block  0.004374027252197266
generate_one_block  0.007496833801269531
generate_one_block  0.004217863082885742
generate_one_block  0.005545854568481445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023429393768310547
gen group dst list time:  0.0016372203826904297
time for parepare:  0.0018355846405029297
local_output_nid generation:  0.0004978179931640625
local_in_edges_tensor generation:  0.0013415813446044922
mini_batch_src_global generation:  0.001104116439819336
r_  generation:  0.011301994323730469
local_output_nid generation:  0.00022268295288085938
local_in_edges_tensor generation:  0.0004839897155761719
mini_batch_src_global generation:  0.0006835460662841797
r_  generation:  0.005362749099731445
local_output_nid generation:  0.0003590583801269531
local_in_edges_tensor generation:  0.0006625652313232422
mini_batch_src_global generation:  0.000621795654296875
r_  generation:  0.007347583770751953
local_output_nid generation:  0.0004930496215820312
local_in_edges_tensor generation:  0.0011506080627441406
mini_batch_src_global generation:  0.0014901161193847656
r_  generation:  0.01409912109375
local_output_nid generation:  0.00032639503479003906
local_in_edges_tensor generation:  0.0006163120269775391
mini_batch_src_global generation:  0.0008440017700195312
r_  generation:  0.007454395294189453
local_output_nid generation:  0.0003299713134765625
local_in_edges_tensor generation:  0.0005903244018554688
mini_batch_src_global generation:  0.0007650852203369141
r_  generation:  0.008070230484008789
local_output_nid generation:  0.0007884502410888672
local_in_edges_tensor generation:  0.0013284683227539062
mini_batch_src_global generation:  0.0015926361083984375
r_  generation:  0.016826868057250977
local_output_nid generation:  0.0004975795745849609
local_in_edges_tensor generation:  0.0007963180541992188
mini_batch_src_global generation:  0.0011649131774902344
r_  generation:  0.012056112289428711
local_output_nid generation:  0.0003647804260253906
local_in_edges_tensor generation:  0.0006251335144042969
mini_batch_src_global generation:  0.0008871555328369141
r_  generation:  0.010026693344116211
local_output_nid generation:  0.0005829334259033203
local_in_edges_tensor generation:  0.0008461475372314453
mini_batch_src_global generation:  0.0009396076202392578
r_  generation:  0.012920856475830078
local_output_nid generation:  0.0005245208740234375
local_in_edges_tensor generation:  0.0008435249328613281
mini_batch_src_global generation:  0.0009949207305908203
r_  generation:  0.011391401290893555
local_output_nid generation:  0.00029969215393066406
local_in_edges_tensor generation:  0.0019073486328125
mini_batch_src_global generation:  0.0009090900421142578
r_  generation:  0.007897615432739258
local_output_nid generation:  0.00042724609375
local_in_edges_tensor generation:  0.0007088184356689453
mini_batch_src_global generation:  0.0010526180267333984
r_  generation:  0.011667490005493164
local_output_nid generation:  0.0004172325134277344
local_in_edges_tensor generation:  0.0007610321044921875
mini_batch_src_global generation:  0.0009038448333740234
r_  generation:  0.010771512985229492
local_output_nid generation:  0.0004177093505859375
local_in_edges_tensor generation:  0.0009856224060058594
mini_batch_src_global generation:  0.001070261001586914
r_  generation:  0.01211094856262207
----------------------check_connections_block total spend ----------------------------- 0.2340080738067627
generate_one_block  0.014954090118408203
generate_one_block  0.007608652114868164
generate_one_block  0.011627435684204102
generate_one_block  0.01813650131225586
generate_one_block  0.011181831359863281
generate_one_block  0.013161182403564453
generate_one_block  0.01960611343383789
generate_one_block  0.016305208206176758
generate_one_block  0.01395559310913086
generate_one_block  0.016948223114013672
generate_one_block  0.014713525772094727
generate_one_block  0.012392759323120117
generate_one_block  0.015387296676635742
generate_one_block  0.014954090118408203
generate_one_block  0.01728534698486328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001708984375
gen group dst list time:  0.004385709762573242
time for parepare:  0.001802206039428711
local_output_nid generation:  0.001119375228881836
local_in_edges_tensor generation:  0.002138853073120117
mini_batch_src_global generation:  0.0018513202667236328
r_  generation:  0.02091503143310547
local_output_nid generation:  0.0006697177886962891
local_in_edges_tensor generation:  0.0013077259063720703
mini_batch_src_global generation:  0.0018627643585205078
r_  generation:  0.015115737915039062
local_output_nid generation:  0.0009591579437255859
local_in_edges_tensor generation:  0.0014157295227050781
mini_batch_src_global generation:  0.0013098716735839844
r_  generation:  0.016237497329711914
local_output_nid generation:  0.001483917236328125
local_in_edges_tensor generation:  0.0021200180053710938
mini_batch_src_global generation:  0.002001523971557617
r_  generation:  0.023020505905151367
local_output_nid generation:  0.0009696483612060547
local_in_edges_tensor generation:  0.0012013912200927734
mini_batch_src_global generation:  0.0016527175903320312
r_  generation:  0.0183560848236084
local_output_nid generation:  0.0009715557098388672
local_in_edges_tensor generation:  0.001172780990600586
mini_batch_src_global generation:  0.001527547836303711
r_  generation:  0.017693758010864258
local_output_nid generation:  0.0014009475708007812
local_in_edges_tensor generation:  0.002118825912475586
mini_batch_src_global generation:  0.0017893314361572266
r_  generation:  0.023540019989013672
local_output_nid generation:  0.0010111331939697266
local_in_edges_tensor generation:  0.0016930103302001953
mini_batch_src_global generation:  0.0017330646514892578
r_  generation:  0.019704818725585938
local_output_nid generation:  0.0009343624114990234
local_in_edges_tensor generation:  0.0012354850769042969
mini_batch_src_global generation:  0.001631021499633789
r_  generation:  0.017969131469726562
local_output_nid generation:  0.0011370182037353516
local_in_edges_tensor generation:  0.001878499984741211
mini_batch_src_global generation:  0.0018820762634277344
r_  generation:  0.021169424057006836
local_output_nid generation:  0.0011916160583496094
local_in_edges_tensor generation:  0.0017101764678955078
mini_batch_src_global generation:  0.001741647720336914
r_  generation:  0.021158456802368164
local_output_nid generation:  0.0008015632629394531
local_in_edges_tensor generation:  0.0012366771697998047
mini_batch_src_global generation:  0.0014634132385253906
r_  generation:  0.0159151554107666
local_output_nid generation:  0.0010023117065429688
local_in_edges_tensor generation:  0.0015668869018554688
mini_batch_src_global generation:  0.001397848129272461
r_  generation:  0.0187532901763916
local_output_nid generation:  0.001104116439819336
local_in_edges_tensor generation:  0.0015971660614013672
mini_batch_src_global generation:  0.001691579818725586
r_  generation:  0.020346879959106445
local_output_nid generation:  0.001110076904296875
local_in_edges_tensor generation:  0.0015959739685058594
mini_batch_src_global generation:  0.0017168521881103516
r_  generation:  0.02024054527282715
----------------------check_connections_block total spend ----------------------------- 0.4215550422668457
generate_one_block  0.0260770320892334
generate_one_block  0.020694255828857422
generate_one_block  0.02085399627685547
generate_one_block  0.029330730438232422
generate_one_block  0.02372145652770996
generate_one_block  0.022907495498657227
generate_one_block  0.029710054397583008
generate_one_block  0.025075912475585938
generate_one_block  0.022733688354492188
generate_one_block  0.027068376541137695
generate_one_block  0.029216527938842773
generate_one_block  0.02086162567138672
generate_one_block  0.02394723892211914
generate_one_block  0.02633810043334961
generate_one_block  0.025796175003051758
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

connection checking time:  0.7495870590209961
block generation total time  0.7126619815826416
average batch blocks generation time:  0.04751079877217611
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1346435546875 GB
    Memory Allocated: 0.04164695739746094  GigaBytes
Max Memory Allocated: 0.04164695739746094  GigaBytes

torch.Size([17735, 500])
torch.Size([11628, 16])
torch.Size([5502, 16])
torch.Size([1028, 16])
torch.Size([266, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4490966796875 GB
    Memory Allocated: 2.0434494018554688  GigaBytes
Max Memory Allocated: 2.159085273742676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4490966796875 GB
    Memory Allocated: 0.04347085952758789  GigaBytes
Max Memory Allocated: 2.159085273742676  GigaBytes

torch.Size([14915, 500])
torch.Size([6428, 16])
torch.Size([2317, 16])
torch.Size([330, 16])
torch.Size([85, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4490966796875 GB
    Memory Allocated: 1.4813108444213867  GigaBytes
Max Memory Allocated: 2.159085273742676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4490966796875 GB
    Memory Allocated: 0.04412078857421875  GigaBytes
Max Memory Allocated: 2.159085273742676  GigaBytes

torch.Size([15204, 500])
torch.Size([8875, 16])
torch.Size([3879, 16])
torch.Size([853, 16])
torch.Size([156, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4490966796875 GB
    Memory Allocated: 1.5264992713928223  GigaBytes
Max Memory Allocated: 2.159085273742676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4490966796875 GB
    Memory Allocated: 0.04938077926635742  GigaBytes
Max Memory Allocated: 2.159085273742676  GigaBytes

torch.Size([17580, 500])
torch.Size([13847, 16])
torch.Size([5450, 16])
torch.Size([1669, 16])
torch.Size([169, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6561279296875 GB
    Memory Allocated: 2.2323555946350098  GigaBytes
Max Memory Allocated: 2.3525519371032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6561279296875 GB
    Memory Allocated: 0.04513883590698242  GigaBytes
Max Memory Allocated: 2.3525519371032715  GigaBytes

torch.Size([15700, 500])
torch.Size([8484, 16])
torch.Size([3262, 16])
torch.Size([487, 16])
torch.Size([131, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6561279296875 GB
    Memory Allocated: 1.7677664756774902  GigaBytes
Max Memory Allocated: 2.3525519371032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6561279296875 GB
    Memory Allocated: 0.04345226287841797  GigaBytes
Max Memory Allocated: 2.3525519371032715  GigaBytes

torch.Size([14803, 500])
torch.Size([8467, 16])
torch.Size([3290, 16])
torch.Size([657, 16])
torch.Size([162, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6561279296875 GB
    Memory Allocated: 1.7393264770507812  GigaBytes
Max Memory Allocated: 2.3525519371032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6561279296875 GB
    Memory Allocated: 0.05047130584716797  GigaBytes
Max Memory Allocated: 2.3525519371032715  GigaBytes

torch.Size([18362, 500])
torch.Size([13759, 16])
torch.Size([8396, 16])
torch.Size([1506, 16])
torch.Size([309, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7928466796875 GB
    Memory Allocated: 2.2716903686523438  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7928466796875 GB
    Memory Allocated: 0.04597187042236328  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([16032, 500])
torch.Size([10327, 16])
torch.Size([5029, 16])
torch.Size([1538, 16])
torch.Size([318, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7928466796875 GB
    Memory Allocated: 1.949167251586914  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7928466796875 GB
    Memory Allocated: 0.04328012466430664  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([14609, 500])
torch.Size([9184, 16])
torch.Size([3676, 16])
torch.Size([820, 16])
torch.Size([113, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7928466796875 GB
    Memory Allocated: 1.7347564697265625  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7928466796875 GB
    Memory Allocated: 0.04928922653198242  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([17525, 500])
torch.Size([11244, 16])
torch.Size([5454, 16])
torch.Size([794, 16])
torch.Size([143, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.0896902084350586  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.048821449279785156  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([17613, 500])
torch.Size([11659, 16])
torch.Size([5237, 16])
torch.Size([1389, 16])
torch.Size([314, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.0027995109558105  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04045915603637695  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([13211, 500])
torch.Size([7280, 16])
torch.Size([3048, 16])
torch.Size([709, 16])
torch.Size([134, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5535545349121094  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.045382022857666016  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([15341, 500])
torch.Size([9557, 16])
torch.Size([4926, 16])
torch.Size([1363, 16])
torch.Size([318, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.8565411567687988  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04711103439331055  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([16705, 500])
torch.Size([10576, 16])
torch.Size([4280, 16])
torch.Size([773, 16])
torch.Size([183, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.9830679893493652  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.046341896057128906  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([16255, 500])
torch.Size([10781, 16])
torch.Size([4544, 16])
torch.Size([1057, 16])
torch.Size([129, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.9803037643432617  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01550463040669759 |0.024827226003011068 |0.33895511627197267 |0.00015277862548828124 |0.3897172768910726 |0.012305498123168945 |
----------------------------------------------------------pseudo_mini_loss sum 1.6491857767105103
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  480236
Number of first layer input nodes during this epoch:  241590
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.0638422966003418  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007529258728027344
range selection method range initialization spend 6.723403930664062e-05
time for parepare:  7.295608520507812e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.5735626220703125e-05
----------------------check_connections_block total spend ----------------------------- 0.0029900074005126953
generate_one_block  0.0014178752899169922
generate_one_block  0.001130819320678711
generate_one_block  0.0010635852813720703
generate_one_block  0.0010609626770019531
generate_one_block  0.0010666847229003906
generate_one_block  0.0010559558868408203
generate_one_block  0.0010485649108886719
generate_one_block  0.0010724067687988281
generate_one_block  0.0010693073272705078
generate_one_block  0.0010459423065185547
generate_one_block  0.001066446304321289
generate_one_block  0.0010461807250976562
generate_one_block  0.0009655952453613281
generate_one_block  0.0009725093841552734
generate_one_block  0.0009706020355224609
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0008015632629394531
gen group dst list time:  8.845329284667969e-05
time for parepare:  0.0003693103790283203
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.00022912025451660156
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  9.322166442871094e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  9.989738464355469e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  8.606910705566406e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  8.058547973632812e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010204315185546875
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001480579376220703
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00021696090698242188
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001380443572998047
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.320808410644531e-05
----------------------check_connections_block total spend ----------------------------- 0.0053446292877197266
generate_one_block  0.0014777183532714844
generate_one_block  0.0010912418365478516
generate_one_block  0.0011985301971435547
generate_one_block  0.0011894702911376953
generate_one_block  0.0011868476867675781
generate_one_block  0.0011570453643798828
generate_one_block  0.0011444091796875
generate_one_block  0.0011911392211914062
generate_one_block  0.0019578933715820312
generate_one_block  0.0011265277862548828
generate_one_block  0.0012309551239013672
generate_one_block  0.0011646747589111328
generate_one_block  0.001087188720703125
generate_one_block  0.0010819435119628906
generate_one_block  0.0010848045349121094
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013530254364013672
gen group dst list time:  0.00016427040100097656
time for parepare:  0.0010998249053955078
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.0035152435302734375
mini_batch_src_global generation:  0.00023674964904785156
r_  generation:  0.0015349388122558594
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.00016760826110839844
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0005326271057128906
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0006244182586669922
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  0.0001010894775390625
r_  generation:  0.0006392002105712891
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0004942417144775391
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0004942417144775391
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.00047397613525390625
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0008146762847900391
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0005817413330078125
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.0001780986785888672
r_  generation:  0.0014197826385498047
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.0008113384246826172
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  8.225440979003906e-05
r_  generation:  0.0004146099090576172
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.0006008148193359375
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0004374980926513672
----------------------check_connections_block total spend ----------------------------- 0.02222418785095215
generate_one_block  0.003091573715209961
generate_one_block  0.001209259033203125
generate_one_block  0.0016334056854248047
generate_one_block  0.001744985580444336
generate_one_block  0.001796722412109375
generate_one_block  0.0016481876373291016
generate_one_block  0.0016438961029052734
generate_one_block  0.001523733139038086
generate_one_block  0.0019817352294921875
generate_one_block  0.00170135498046875
generate_one_block  0.002693653106689453
generate_one_block  0.0019359588623046875
generate_one_block  0.0014548301696777344
generate_one_block  0.0018045902252197266
generate_one_block  0.0014646053314208984
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021355152130126953
gen group dst list time:  0.00041484832763671875
time for parepare:  0.0019087791442871094
local_output_nid generation:  0.00018310546875
local_in_edges_tensor generation:  0.0008785724639892578
mini_batch_src_global generation:  0.0007619857788085938
r_  generation:  0.005556583404541016
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.00026345252990722656
r_  generation:  0.0012273788452148438
local_output_nid generation:  9.751319885253906e-05
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  0.0003535747528076172
r_  generation:  0.0037004947662353516
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.0003223419189453125
mini_batch_src_global generation:  0.0004620552062988281
r_  generation:  0.004336118698120117
local_output_nid generation:  0.00012540817260742188
local_in_edges_tensor generation:  0.0002923011779785156
mini_batch_src_global generation:  0.0004074573516845703
r_  generation:  0.0034852027893066406
local_output_nid generation:  8.845329284667969e-05
local_in_edges_tensor generation:  0.00026345252990722656
mini_batch_src_global generation:  0.00033545494079589844
r_  generation:  0.002843618392944336
local_output_nid generation:  0.00010013580322265625
local_in_edges_tensor generation:  0.00028443336486816406
mini_batch_src_global generation:  0.00035500526428222656
r_  generation:  0.003262042999267578
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.00027108192443847656
mini_batch_src_global generation:  0.00028824806213378906
r_  generation:  0.0023140907287597656
local_output_nid generation:  0.00016117095947265625
local_in_edges_tensor generation:  0.0003249645233154297
mini_batch_src_global generation:  0.0003380775451660156
r_  generation:  0.003387451171875
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.0003075599670410156
mini_batch_src_global generation:  0.0003857612609863281
r_  generation:  0.0035665035247802734
local_output_nid generation:  0.00018930435180664062
local_in_edges_tensor generation:  0.00039005279541015625
mini_batch_src_global generation:  0.0005190372467041016
r_  generation:  0.005026340484619141
local_output_nid generation:  0.0001392364501953125
local_in_edges_tensor generation:  0.00033545494079589844
mini_batch_src_global generation:  0.0004773139953613281
r_  generation:  0.0042955875396728516
local_output_nid generation:  9.322166442871094e-05
local_in_edges_tensor generation:  0.0002694129943847656
mini_batch_src_global generation:  0.00031185150146484375
r_  generation:  0.002298116683959961
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.0003170967102050781
mini_batch_src_global generation:  0.0003383159637451172
r_  generation:  0.003694772720336914
local_output_nid generation:  7.915496826171875e-05
local_in_edges_tensor generation:  0.0002505779266357422
mini_batch_src_global generation:  0.00029850006103515625
r_  generation:  0.002176046371459961
----------------------check_connections_block total spend ----------------------------- 0.07932519912719727
generate_one_block  0.009098529815673828
generate_one_block  0.002758026123046875
generate_one_block  0.0063037872314453125
generate_one_block  0.007372856140136719
generate_one_block  0.00587153434753418
generate_one_block  0.005246400833129883
generate_one_block  0.005785942077636719
generate_one_block  0.004315614700317383
generate_one_block  0.005766630172729492
generate_one_block  0.005928516387939453
generate_one_block  0.008016347885131836
generate_one_block  0.007146596908569336
generate_one_block  0.004296302795410156
generate_one_block  0.005941152572631836
generate_one_block  0.004052639007568359
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0024521350860595703
gen group dst list time:  0.0018737316131591797
time for parepare:  0.001987934112548828
local_output_nid generation:  0.0006849765777587891
local_in_edges_tensor generation:  0.0016446113586425781
mini_batch_src_global generation:  0.0012919902801513672
r_  generation:  0.011653900146484375
local_output_nid generation:  0.00025153160095214844
local_in_edges_tensor generation:  0.0005636215209960938
mini_batch_src_global generation:  0.0008747577667236328
r_  generation:  0.006089210510253906
local_output_nid generation:  0.0007483959197998047
local_in_edges_tensor generation:  0.0010480880737304688
mini_batch_src_global generation:  0.0012080669403076172
r_  generation:  0.013867378234863281
local_output_nid generation:  0.0007603168487548828
local_in_edges_tensor generation:  0.0010900497436523438
mini_batch_src_global generation:  0.0012669563293457031
r_  generation:  0.01405477523803711
local_output_nid generation:  0.0005781650543212891
local_in_edges_tensor generation:  0.0008511543273925781
mini_batch_src_global generation:  0.0011744499206542969
r_  generation:  0.012690544128417969
local_output_nid generation:  0.0006623268127441406
local_in_edges_tensor generation:  0.0008974075317382812
mini_batch_src_global generation:  0.001102447509765625
r_  generation:  0.01173090934753418
local_output_nid generation:  0.0006086826324462891
local_in_edges_tensor generation:  0.0008356571197509766
mini_batch_src_global generation:  0.0009267330169677734
r_  generation:  0.011798381805419922
local_output_nid generation:  0.0005674362182617188
local_in_edges_tensor generation:  0.0007758140563964844
mini_batch_src_global generation:  0.0009636878967285156
r_  generation:  0.008857250213623047
local_output_nid generation:  0.0006465911865234375
local_in_edges_tensor generation:  0.0008418560028076172
mini_batch_src_global generation:  0.0010585784912109375
r_  generation:  0.012476205825805664
local_output_nid generation:  0.0005509853363037109
local_in_edges_tensor generation:  0.0008008480072021484
mini_batch_src_global generation:  0.0009806156158447266
r_  generation:  0.011956214904785156
local_output_nid generation:  0.0006015300750732422
local_in_edges_tensor generation:  0.0008080005645751953
mini_batch_src_global generation:  0.0009415149688720703
r_  generation:  0.011739492416381836
local_output_nid generation:  0.0009324550628662109
local_in_edges_tensor generation:  0.0011258125305175781
mini_batch_src_global generation:  0.0010192394256591797
r_  generation:  0.013405799865722656
local_output_nid generation:  0.0005123615264892578
local_in_edges_tensor generation:  0.0007307529449462891
mini_batch_src_global generation:  0.0010175704956054688
r_  generation:  0.010523080825805664
local_output_nid generation:  0.0006897449493408203
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0009288787841796875
r_  generation:  0.01285243034362793
local_output_nid generation:  0.0004706382751464844
local_in_edges_tensor generation:  0.0006966590881347656
mini_batch_src_global generation:  0.0009605884552001953
r_  generation:  0.008702993392944336
----------------------check_connections_block total spend ----------------------------- 0.2532215118408203
generate_one_block  0.01826000213623047
generate_one_block  0.010785818099975586
generate_one_block  0.01938486099243164
generate_one_block  0.019325733184814453
generate_one_block  0.017618179321289062
generate_one_block  0.016314029693603516
generate_one_block  0.016604185104370117
generate_one_block  0.014002799987792969
generate_one_block  0.016028642654418945
generate_one_block  0.017656564712524414
generate_one_block  0.016236066818237305
generate_one_block  0.0176393985748291
generate_one_block  0.015259742736816406
generate_one_block  0.01802849769592285
generate_one_block  0.014097213745117188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022542476654052734
gen group dst list time:  0.0048601627349853516
time for parepare:  0.0019109249114990234
local_output_nid generation:  0.0012469291687011719
local_in_edges_tensor generation:  0.0020461082458496094
mini_batch_src_global generation:  0.0018625259399414062
r_  generation:  0.01916050910949707
local_output_nid generation:  0.0008182525634765625
local_in_edges_tensor generation:  0.0014438629150390625
mini_batch_src_global generation:  0.0018398761749267578
r_  generation:  0.015446662902832031
local_output_nid generation:  0.0014393329620361328
local_in_edges_tensor generation:  0.0020797252655029297
mini_batch_src_global generation:  0.0018992424011230469
r_  generation:  0.021877050399780273
local_output_nid generation:  0.0014081001281738281
local_in_edges_tensor generation:  0.0018057823181152344
mini_batch_src_global generation:  0.0022935867309570312
r_  generation:  0.022105932235717773
local_output_nid generation:  0.0014052391052246094
local_in_edges_tensor generation:  0.0016040802001953125
mini_batch_src_global generation:  0.001711130142211914
r_  generation:  0.021020889282226562
local_output_nid generation:  0.0013418197631835938
local_in_edges_tensor generation:  0.0016748905181884766
mini_batch_src_global generation:  0.0018808841705322266
r_  generation:  0.020631790161132812
local_output_nid generation:  0.0011963844299316406
local_in_edges_tensor generation:  0.0017457008361816406
mini_batch_src_global generation:  0.0016748905181884766
r_  generation:  0.020418882369995117
local_output_nid generation:  0.0012428760528564453
local_in_edges_tensor generation:  0.0017244815826416016
mini_batch_src_global generation:  0.0017325878143310547
r_  generation:  0.020694732666015625
local_output_nid generation:  0.001440286636352539
local_in_edges_tensor generation:  0.00179290771484375
mini_batch_src_global generation:  0.0020711421966552734
r_  generation:  0.02297377586364746
local_output_nid generation:  0.0011785030364990234
local_in_edges_tensor generation:  0.0015377998352050781
mini_batch_src_global generation:  0.0016589164733886719
r_  generation:  0.020368576049804688
local_output_nid generation:  0.0010862350463867188
local_in_edges_tensor generation:  0.0015017986297607422
mini_batch_src_global generation:  0.0015931129455566406
r_  generation:  0.0184781551361084
local_output_nid generation:  0.0013427734375
local_in_edges_tensor generation:  0.001802206039428711
mini_batch_src_global generation:  0.0017292499542236328
r_  generation:  0.02141427993774414
local_output_nid generation:  0.0012316703796386719
local_in_edges_tensor generation:  0.0017879009246826172
mini_batch_src_global generation:  0.0017871856689453125
r_  generation:  0.02117919921875
local_output_nid generation:  0.0014345645904541016
local_in_edges_tensor generation:  0.002057313919067383
mini_batch_src_global generation:  0.0019736289978027344
r_  generation:  0.02247142791748047
local_output_nid generation:  0.0011038780212402344
local_in_edges_tensor generation:  0.0014753341674804688
mini_batch_src_global generation:  0.0016787052154541016
r_  generation:  0.01945662498474121
----------------------check_connections_block total spend ----------------------------- 0.44945740699768066
generate_one_block  0.02618885040283203
generate_one_block  0.021880388259887695
generate_one_block  0.02957296371459961
generate_one_block  0.030124664306640625
generate_one_block  0.027080059051513672
generate_one_block  0.027423381805419922
generate_one_block  0.026767253875732422
generate_one_block  0.02754950523376465
generate_one_block  0.030109167098999023
generate_one_block  0.02617955207824707
generate_one_block  0.02409958839416504
generate_one_block  0.03240394592285156
generate_one_block  0.028931617736816406
generate_one_block  0.02946162223815918
generate_one_block  0.026195049285888672
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.0638422966003418  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

connection checking time:  0.8095729351043701
block generation total time  0.794809103012085
average batch blocks generation time:  0.052987273534139
block dataloader generation time/epoch 1.879882574081421
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.06145191192626953  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([15645, 500])
torch.Size([9698, 16])
torch.Size([4890, 16])
torch.Size([1418, 16])
torch.Size([351, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.88881254196167  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.0566706657409668  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([13350, 500])
torch.Size([6467, 16])
torch.Size([1945, 16])
torch.Size([254, 16])
torch.Size([44, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5347833633422852  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.06539058685302734  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([17400, 500])
torch.Size([11980, 16])
torch.Size([5870, 16])
torch.Size([838, 16])
torch.Size([198, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.1348471641540527  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.0650796890258789  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([17648, 500])
torch.Size([11749, 16])
torch.Size([6174, 16])
torch.Size([977, 16])
torch.Size([195, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 2.144376754760742  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 0.062375545501708984  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([16232, 500])
torch.Size([11188, 16])
torch.Size([4588, 16])
torch.Size([1078, 16])
torch.Size([152, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 2.011969566345215  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 0.06387853622436523  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([17065, 500])
torch.Size([10537, 16])
torch.Size([4936, 16])
torch.Size([748, 16])
torch.Size([170, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 2.022202968597412  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 0.06250858306884766  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([16324, 500])
torch.Size([10722, 16])
torch.Size([4649, 16])
torch.Size([851, 16])
torch.Size([153, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 1.9714360237121582  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 0.06392574310302734  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([17131, 500])
torch.Size([10710, 16])
torch.Size([4223, 16])
torch.Size([824, 16])
torch.Size([190, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 1.997835636138916  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 0.06546211242675781  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([17881, 500])
torch.Size([12821, 16])
torch.Size([5279, 16])
torch.Size([1361, 16])
torch.Size([285, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 2.1925816535949707  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 0.06158781051635742  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([15827, 500])
torch.Size([10321, 16])
torch.Size([4240, 16])
torch.Size([1093, 16])
torch.Size([159, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 1.9306764602661133  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 0.05969095230102539  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([14797, 500])
torch.Size([9580, 16])
torch.Size([4761, 16])
torch.Size([1666, 16])
torch.Size([343, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 1.8007311820983887  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 0.06562995910644531  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([17968, 500])
torch.Size([12024, 16])
torch.Size([7009, 16])
torch.Size([1280, 16])
torch.Size([305, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 2.0865368843078613  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 0.0637674331665039  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([17024, 500])
torch.Size([10929, 16])
torch.Size([3842, 16])
torch.Size([731, 16])
torch.Size([110, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 2.0420689582824707  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 0.06468915939331055  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([17467, 500])
torch.Size([12836, 16])
torch.Size([5176, 16])
torch.Size([1335, 16])
torch.Size([154, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 2.1296024322509766  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 0.0615692138671875  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

torch.Size([15878, 500])
torch.Size([9270, 16])
torch.Size([3416, 16])
torch.Size([624, 16])
torch.Size([127, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8084716796875 GB
    Memory Allocated: 1.8638391494750977  GigaBytes
Max Memory Allocated: 2.3820242881774902  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01468054453531901 |0.0031442801157633466 |0.3050861835479736 |0.00013793309529622395 |0.3859304745992025 |0.011426210403442383 |
----------------------------------------------------------pseudo_mini_loss sum 1.4183281660079956
Total (block generation + training)time/epoch 12.570006132125854
Training time/epoch 10.68968653678894
Training time without block to device /epoch 10.64252233505249
Training time without total dataloading part /epoch 10.378745079040527
load block tensor time/epoch 0.22020816802978516
block to device time/epoch 0.047164201736450195
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  497838
Number of first layer input nodes during this epoch:  247637
