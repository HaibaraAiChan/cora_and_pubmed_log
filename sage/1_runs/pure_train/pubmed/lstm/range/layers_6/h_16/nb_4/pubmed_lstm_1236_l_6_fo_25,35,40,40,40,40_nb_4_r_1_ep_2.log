main start at this time 1648534220.961055
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0011785030364990234
range selection method range initialization spend 0.00010776519775390625
time for parepare:  6.127357482910156e-05
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0018210411071777344
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  8.559226989746094e-05
----------------------check_connections_block total spend ----------------------------- 0.002630472183227539
generate_one_block  0.0015101432800292969
generate_one_block  0.0013616085052490234
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000858306884765625
gen group dst list time:  2.9802322387695312e-05
time for parepare:  0.00029659271240234375
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0002319812774658203
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0006139278411865234
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  0.00012755393981933594
r_  generation:  0.0008928775787353516
----------------------check_connections_block total spend ----------------------------- 0.002892732620239258
generate_one_block  0.0021047592163085938
generate_one_block  0.0023658275604248047
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012443065643310547
gen group dst list time:  7.557868957519531e-05
time for parepare:  0.0008845329284667969
local_output_nid generation:  0.00011086463928222656
local_in_edges_tensor generation:  0.0004303455352783203
mini_batch_src_global generation:  0.00029754638671875
r_  generation:  0.003344297409057617
local_output_nid generation:  0.00011014938354492188
local_in_edges_tensor generation:  0.00031495094299316406
mini_batch_src_global generation:  0.0005693435668945312
r_  generation:  0.00458526611328125
----------------------check_connections_block total spend ----------------------------- 0.012821435928344727
generate_one_block  0.005446195602416992
generate_one_block  0.006345987319946289
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0015788078308105469
gen group dst list time:  0.00018095970153808594
time for parepare:  0.0014417171478271484
local_output_nid generation:  0.0003306865692138672
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.0012171268463134766
r_  generation:  0.01226043701171875
local_output_nid generation:  0.00039196014404296875
local_in_edges_tensor generation:  0.0009665489196777344
mini_batch_src_global generation:  0.001621246337890625
r_  generation:  0.013907670974731445
----------------------check_connections_block total spend ----------------------------- 0.03936147689819336
generate_one_block  0.016241073608398438
generate_one_block  0.019462108612060547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001699686050415039
gen group dst list time:  0.0005128383636474609
time for parepare:  0.0016522407531738281
local_output_nid generation:  0.0009732246398925781
local_in_edges_tensor generation:  0.0019750595092773438
mini_batch_src_global generation:  0.002111196517944336
r_  generation:  0.022985219955444336
local_output_nid generation:  0.001134634017944336
local_in_edges_tensor generation:  0.0022656917572021484
mini_batch_src_global generation:  0.0025458335876464844
r_  generation:  0.02315974235534668
----------------------check_connections_block total spend ----------------------------- 0.0693356990814209
generate_one_block  0.027711153030395508
generate_one_block  0.030144214630126953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018949508666992188
gen group dst list time:  0.0007598400115966797
time for parepare:  0.0016770362854003906
local_output_nid generation:  0.0012981891632080078
local_in_edges_tensor generation:  0.002557039260864258
mini_batch_src_global generation:  0.0022063255310058594
r_  generation:  0.026673078536987305
local_output_nid generation:  0.001674652099609375
local_in_edges_tensor generation:  0.0027620792388916016
mini_batch_src_global generation:  0.0027756690979003906
r_  generation:  0.02654099464416504
----------------------check_connections_block total spend ----------------------------- 0.07999014854431152
generate_one_block  0.031280517578125
generate_one_block  0.03317403793334961
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

connection checking time:  0.20440149307250977
block generation total time  0.17427587509155273
average batch blocks generation time:  0.08713793754577637
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.045017242431640625  GigaBytes
Max Memory Allocated: 0.045017242431640625  GigaBytes

torch.Size([19273, 500])
torch.Size([17590, 16])
torch.Size([13448, 16])
torch.Size([4703, 16])
torch.Size([1217, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9959716796875 GB
    Memory Allocated: 2.5590996742248535  GigaBytes
Max Memory Allocated: 2.6443028450012207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9979248046875 GB
    Memory Allocated: 0.0530095100402832  GigaBytes
Max Memory Allocated: 2.6443028450012207  GigaBytes

torch.Size([19256, 500])
torch.Size([17551, 16])
torch.Size([12942, 16])
torch.Size([5218, 16])
torch.Size([1475, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 2.5752696990966797  GigaBytes
Max Memory Allocated: 2.6484484672546387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023596525192260742 |0.17030251026153564 |0.6470504999160767 |0.0002301931381225586 |0.4941750764846802 |0.010183572769165039 |
----------------------------------------------------------pseudo_mini_loss sum 1.6757357120513916
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  113028
Number of first layer input nodes during this epoch:  38529
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07145977020263672  GigaBytes
Max Memory Allocated: 2.6484484672546387  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005552768707275391
range selection method range initialization spend 5.555152893066406e-05
time for parepare:  5.53131103515625e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  6.127357482910156e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00011897087097167969Using backend: pytorch

mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  8.845329284667969e-05
----------------------check_connections_block total spend ----------------------------- 0.00083160400390625
generate_one_block  0.0012183189392089844
generate_one_block  0.0012221336364746094
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005629062652587891
gen group dst list time:  2.8848648071289062e-05
time for parepare:  0.0002739429473876953
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0005688667297363281
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  9.465217590332031e-05
r_  generation:  0.0007460117340087891
----------------------check_connections_block total spend ----------------------------- 0.0025386810302734375
generate_one_block  0.002056598663330078
generate_one_block  0.0022749900817871094
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010442733764648438
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.0007481575012207031
local_output_nid generation:  0.00014638900756835938
local_in_edges_tensor generation:  0.0003902912139892578
mini_batch_src_global generation:  0.00031685829162597656
r_  generation:  0.0037987232208251953
local_output_nid generation:  0.00015401840209960938
local_in_edges_tensor generation:  0.0003380775451660156
mini_batch_src_global generation:  0.0005006790161132812
r_  generation:  0.0046880245208740234
----------------------check_connections_block total spend ----------------------------- 0.013240575790405273
generate_one_block  0.007091045379638672
generate_one_block  0.008919477462768555
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0017461776733398438
gen group dst list time:  0.00021195411682128906
time for parepare:  0.001321554183959961
local_output_nid generation:  0.0003311634063720703
local_in_edges_tensor generation:  0.0009107589721679688
mini_batch_src_global generation:  0.0011129379272460938
r_  generation:  0.01308584213256836
local_output_nid generation:  0.0005166530609130859
local_in_edges_tensor generation:  0.0009772777557373047
mini_batch_src_global generation:  0.001764535903930664
r_  generation:  0.016057491302490234
----------------------check_connections_block total spend ----------------------------- 0.04353022575378418
generate_one_block  0.020016193389892578
generate_one_block  0.023995637893676758
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017547607421875
gen group dst list time:  0.0005161762237548828
time for parepare:  0.0015778541564941406
local_output_nid generation:  0.0009620189666748047
local_in_edges_tensor generation:  0.0019390583038330078
mini_batch_src_global generation:  0.0018939971923828125
r_  generation:  0.022603988647460938
local_output_nid generation:  0.001268148422241211
local_in_edges_tensor generation:  0.0025262832641601562
mini_batch_src_global generation:  0.0028390884399414062
r_  generation:  0.025120258331298828
----------------------check_connections_block total spend ----------------------------- 0.07317471504211426
generate_one_block  0.03058147430419922
generate_one_block  0.0357668399810791
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020101070404052734
gen group dst list time:  0.0008580684661865234
time for parepare:  0.0017666816711425781
local_output_nid generation:  0.0014154911041259766
local_in_edges_tensor generation:  0.0025506019592285156
mini_batch_src_global generation:  0.0019757747650146484
r_  generation:  0.025954484939575195
local_output_nid generation:  0.0016052722930908203
local_in_edges_tensor generation:  0.0024716854095458984
mini_batch_src_global generation:  0.0028095245361328125
r_  generation:  0.028427600860595703
----------------------check_connections_block total spend ----------------------------- 0.08068156242370605
generate_one_block  0.0340425968170166
generate_one_block  0.03599190711975098
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.07145977020263672  GigaBytes
Max Memory Allocated: 2.6484484672546387  GigaBytes

connection checking time:  0.2131657600402832
block generation total time  0.20073676109313965
average batch blocks generation time:  0.10036838054656982
block dataloader generation time/epoch 0.47025012969970703
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.06821060180664062  GigaBytes
Max Memory Allocated: 2.6484484672546387  GigaBytes

torch.Size([19111, 500])
torch.Size([16974, 16])
torch.Size([12658, 16])
torch.Size([4297, 16])
torch.Size([1254, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 2.550780773162842  GigaBytes
Max Memory Allocated: 2.6484484672546387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.06896638870239258  GigaBytes
Max Memory Allocated: 2.6484484672546387  GigaBytes

torch.Size([19437, 500])
torch.Size([18340, 16])
torch.Size([14861, 16])
torch.Size([6378, 16])
torch.Size([1538, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3240966796875 GB
    Memory Allocated: 2.642902374267578  GigaBytes
Max Memory Allocated: 2.71052885055542  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018418550491333008 |0.0047588348388671875 |0.39437270164489746 |0.00015795230865478516 |0.5282647609710693 |0.011172771453857422 |
----------------------------------------------------------pseudo_mini_loss sum 1.6860837936401367
Total (block generation + training)time/epoch 2.3843517303466797
Training time/epoch 1.9135112762451172
Training time without block to device /epoch 1.9039936065673828
Training time without total dataloading part /epoch 1.8567636013031006
load block tensor time/epoch 0.036837100982666016
block to device time/epoch 0.009517669677734375
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  115205
Number of first layer input nodes during this epoch:  38548
