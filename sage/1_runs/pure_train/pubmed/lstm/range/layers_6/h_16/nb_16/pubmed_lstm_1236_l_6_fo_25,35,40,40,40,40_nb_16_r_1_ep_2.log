main start at this time 1648534253.365556
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001325845718383789
range selection method range initialization spend 7.271766662597656e-05
time for parepare:  4.6253204345703125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.001088857650756836
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0503997802734375e-05
----------------------check_connections_block total spend ----------------------------- 0.002753734588623047
generate_one_block  0.0011949539184570312
generate_one_block  0.0010714530944824219
generate_one_block  0.0010440349578857422
generate_one_block  0.0011048316955566406
generate_one_block  0.0010416507720947266
generate_one_block  0.0010542869567871094
generate_one_block  0.0010557174682617188
generate_one_block  0.0010294914245605469
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0008535385131835938
gen group dst list time:  5.269050598144531e-05
time for parepare:  0.0002696514129638672
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00015926361083984375
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00015354156494140625
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001442432403564453
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00026702880859375
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00012135505676269531
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00020503997802734375
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.0002753734588623047
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  8.487701416015625e-05
----------------------check_connections_block total spend ----------------------------- 0.003548145294189453
generate_one_block  0.001262664794921875
generate_one_block  0.0012404918670654297
generate_one_block  0.0012807846069335938
generate_one_block  0.0014452934265136719
generate_one_block  0.0011837482452392578
generate_one_block  0.0013079643249511719
generate_one_block  0.0013904571533203125
generate_one_block  0.0011353492736816406
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011322498321533203
gen group dst list time:  9.632110595703125e-05
time for parepare:  0.0007605552673339844
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0007665157318115234
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  0.00011920928955078125
r_  generation:  0.0011267662048339844
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0007181167602539062
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00020265579223632812
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.002118825912475586
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  0.0001308917999267578
r_  generation:  0.0008730888366699219
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  0.00012183189392089844
r_  generation:  0.0012137889862060547
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.0018541812896728516
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  9.989738464355469e-05
r_  generation:  0.0004968643188476562
----------------------check_connections_block total spend ----------------------------- 0.015107870101928711
generate_one_block  0.002113819122314453
generate_one_block  0.0024399757385253906
generate_one_block  0.0017380714416503906
generate_one_block  0.0034503936767578125
generate_one_block  0.0018775463104248047
generate_one_block  0.0023450851440429688
generate_one_block  0.0030519962310791016
generate_one_block  0.0015132427215576172
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018024444580078125
gen group dst list time:  0.00026869773864746094
time for parepare:  0.0016009807586669922
local_output_nid generation:  0.00010275840759277344
local_in_edges_tensor generation:  0.000560760498046875
mini_batch_src_global generation:  0.0004761219024658203
r_  generation:  0.0038518905639648438
local_output_nid generation:  0.00017380714416503906
local_in_edges_tensor generation:  0.0004177093505859375
mini_batch_src_global generation:  0.0007181167602539062
r_  generation:  0.0056607723236083984
local_output_nid generation:  9.775161743164062e-05
local_in_edges_tensor generation:  0.0002841949462890625
mini_batch_src_global generation:  0.00038743019104003906
r_  generation:  0.0037789344787597656
local_output_nid generation:  0.00024628639221191406
local_in_edges_tensor generation:  0.0005240440368652344
mini_batch_src_global generation:  0.0008435249328613281
r_  generation:  0.009504318237304688
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.0003457069396972656
mini_batch_src_global generation:  0.0007255077362060547
r_  generation:  0.005383014678955078
local_output_nid generation:  0.00018095970153808594
local_in_edges_tensor generation:  0.00040268898010253906
mini_batch_src_global generation:  0.0006093978881835938
r_  generation:  0.0053806304931640625
local_output_nid generation:  0.00017189979553222656
local_in_edges_tensor generation:  0.0003864765167236328
mini_batch_src_global generation:  0.0006530284881591797
r_  generation:  0.0066716670989990234
local_output_nid generation:  9.679794311523438e-05
local_in_edges_tensor generation:  0.0002548694610595703
mini_batch_src_global generation:  0.00043892860412597656
r_  generation:  0.0034360885620117188
----------------------check_connections_block total spend ----------------------------- 0.0656273365020752
generate_one_block  0.007219791412353516
generate_one_block  0.0076923370361328125
generate_one_block  0.005388021469116211
generate_one_block  0.012948751449584961
generate_one_block  0.008804798126220703
generate_one_block  0.009253501892089844
generate_one_block  0.010925769805908203
generate_one_block  0.005424022674560547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002079010009765625
gen group dst list time:  0.0013246536254882812
time for parepare:  0.0018219947814941406
local_output_nid generation:  0.0005822181701660156
local_in_edges_tensor generation:  0.001279592514038086
mini_batch_src_global generation:  0.0012159347534179688
r_  generation:  0.012773752212524414
local_output_nid generation:  0.0006244182586669922
local_in_edges_tensor generation:  0.0013685226440429688
mini_batch_src_global generation:  0.0016474723815917969
r_  generation:  0.0153961181640625
local_output_nid generation:  0.0005483627319335938
local_in_edges_tensor generation:  0.0019805431365966797
mini_batch_src_global generation:  0.0012021064758300781
r_  generation:  0.013282299041748047
local_output_nid generation:  0.0009810924530029297
local_in_edges_tensor generation:  0.0017588138580322266
mini_batch_src_global generation:  0.0017976760864257812
r_  generation:  0.01994919776916504
local_output_nid generation:  0.0006506443023681641
local_in_edges_tensor generation:  0.0010368824005126953
mini_batch_src_global generation:  0.0013637542724609375
r_  generation:  0.015255212783813477
local_output_nid generation:  0.0007398128509521484
local_in_edges_tensor generation:  0.0010976791381835938
mini_batch_src_global generation:  0.0013887882232666016
r_  generation:  0.016428470611572266
local_output_nid generation:  0.0007193088531494141
local_in_edges_tensor generation:  0.0010275840759277344
mini_batch_src_global generation:  0.0013480186462402344
r_  generation:  0.01678776741027832
local_output_nid generation:  0.0004532337188720703
local_in_edges_tensor generation:  0.0006978511810302734
mini_batch_src_global generation:  0.001194000244140625
r_  generation:  0.011996746063232422
----------------------check_connections_block total spend ----------------------------- 0.17879080772399902
generate_one_block  0.01661062240600586
generate_one_block  0.02089095115661621
generate_one_block  0.017782926559448242
generate_one_block  0.025994062423706055
generate_one_block  0.020098447799682617
generate_one_block  0.021654129028320312
generate_one_block  0.021686792373657227
generate_one_block  0.0179293155670166
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001912832260131836
gen group dst list time:  0.0027289390563964844
time for parepare:  0.0017185211181640625
local_output_nid generation:  0.0011029243469238281
local_in_edges_tensor generation:  0.0022499561309814453
mini_batch_src_global generation:  0.002073526382446289
r_  generation:  0.02202153205871582
local_output_nid generation:  0.001293182373046875
local_in_edges_tensor generation:  0.0024597644805908203
mini_batch_src_global generation:  0.0026051998138427734
r_  generation:  0.0238039493560791
local_output_nid generation:  0.0012645721435546875
local_in_edges_tensor generation:  0.001567840576171875
mini_batch_src_global generation:  0.0017948150634765625
r_  generation:  0.0215911865234375
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.0024814605712890625
mini_batch_src_global generation:  0.002092599868774414
r_  generation:  0.025003671646118164
local_output_nid generation:  0.0013229846954345703
local_in_edges_tensor generation:  0.0017695426940917969
mini_batch_src_global generation:  0.0019032955169677734
r_  generation:  0.02299213409423828
local_output_nid generation:  0.0013298988342285156
local_in_edges_tensor generation:  0.0019643306732177734
mini_batch_src_global generation:  0.0019893646240234375
r_  generation:  0.024007320404052734
local_output_nid generation:  0.0013103485107421875
local_in_edges_tensor generation:  0.001901865005493164
mini_batch_src_global generation:  0.0017242431640625
r_  generation:  0.022668123245239258
local_output_nid generation:  0.0011134147644042969
local_in_edges_tensor generation:  0.0014371871948242188
mini_batch_src_global generation:  0.0015912055969238281
r_  generation:  0.020247459411621094
----------------------check_connections_block total spend ----------------------------- 0.26468753814697266
generate_one_block  0.027264118194580078
generate_one_block  0.030536413192749023
generate_one_block  0.028070688247680664
generate_one_block  0.031423091888427734
generate_one_block  0.028751373291015625
generate_one_block  0.02946758270263672
generate_one_block  0.028578996658325195
generate_one_block  0.026118040084838867
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

connection checking time:  0.527761697769165
block generation total time  0.4892914295196533
average batch blocks generation time:  0.061161428689956665
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.04229116439819336  GigaBytes
Max Memory Allocated: 0.04229116439819336  GigaBytes

torch.Size([18132, 500])
torch.Size([12514, 16])
torch.Size([6366, 16])
torch.Size([1272, 16])
torch.Size([353, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 2.1407370567321777  GigaBytes
Max Memory Allocated: 2.2594618797302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5408935546875 GB
    Memory Allocated: 0.049945831298828125  GigaBytes
Max Memory Allocated: 2.2594618797302246  GigaBytes

torch.Size([18085, 500])
torch.Size([14327, 16])
torch.Size([7092, 16])
torch.Size([2201, 16])
torch.Size([324, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 2.2862048149108887  GigaBytes
Max Memory Allocated: 2.400679588317871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.049314022064208984  GigaBytes
Max Memory Allocated: 2.400679588317871  GigaBytes

torch.Size([17357, 500])
torch.Size([11913, 16])
torch.Size([5601, 16])
torch.Size([1073, 16])
torch.Size([290, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 2.127816677093506  GigaBytes
Max Memory Allocated: 2.400679588317871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.0516819953918457  GigaBytes
Max Memory Allocated: 2.400679588317871  GigaBytes

torch.Size([18764, 500])
torch.Size([15500, 16])
torch.Size([10826, 16])
torch.Size([2824, 16])
torch.Size([624, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8768310546875 GB
    Memory Allocated: 2.4180097579956055  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8748779296875 GB
    Memory Allocated: 0.049474239349365234  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

torch.Size([17845, 500])
torch.Size([13013, 16])
torch.Size([6742, 16])
torch.Size([1446, 16])
torch.Size([254, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8748779296875 GB
    Memory Allocated: 2.224362850189209  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8748779296875 GB
    Memory Allocated: 0.051457881927490234  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

torch.Size([18352, 500])
torch.Size([14314, 16])
torch.Size([7462, 16])
torch.Size([2002, 16])
torch.Size([442, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8748779296875 GB
    Memory Allocated: 2.3297271728515625  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8748779296875 GB
    Memory Allocated: 0.0495448112487793  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

torch.Size([17557, 500])
torch.Size([13080, 16])
torch.Size([7677, 16])
torch.Size([2086, 16])
torch.Size([498, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 2.219902515411377  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 0.04622602462768555  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

torch.Size([16196, 500])
torch.Size([10672, 16])
torch.Size([4513, 16])
torch.Size([1033, 16])
torch.Size([127, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 1.9767847061157227  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01812654733657837 |0.0448174774646759 |0.3968247175216675 |0.00014957785606384277 |0.4402424097061157 |0.014774560928344727 |
----------------------------------------------------------pseudo_mini_loss sum 1.9661014080047607
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  321106
Number of first layer input nodes during this epoch:  142288
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 0.06414651870727539  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007634162902832031
range selection method range initialization spend 6.29425048828125e-05
time for parepare:  7.843971252441406e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.0018553733825683594
generate_one_block  0.001674652099609375
generate_one_block  0.001125335693359375
generate_one_block  0.0010852813720703125
generate_one_block  0.0010933876037597656
generate_one_block  0.0011239051818847656
generate_one_block  0.0011191368103027344
generate_one_block  0.0010905265808105469
generate_one_block  0.001073598861694336
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006906986236572266
gen group dst list time:  6.103515625e-05
time for parepare:  0.0003685951232910156
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0002510547637939453
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00020003318786621094
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00015592575073242188
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00017380714416503906
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.00022792816162109375
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00032711029052734375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00013566017150878906
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  8.893013000488281e-05
----------------------check_connections_block total spend ----------------------------- 0.004114866256713867
generate_one_block  0.001482248306274414
generate_one_block  0.001360177993774414
generate_one_block  0.0012972354888916016
generate_one_block  0.00139617919921875
generate_one_block  0.001386404037475586
generate_one_block  0.0015521049499511719
generate_one_block  0.0012407302856445312
generate_one_block  0.0011289119720458984
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012035369873046875
gen group dst list time:  0.00012612342834472656
time for parepare:  0.0010035037994384766
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.00033354759216308594
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.0016565322875976562
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  0.0001957416534423828
r_  generation:  0.0011281967163085938
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  0.00013566017150878906
r_  generation:  0.0011026859283447266
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  0.0001361370086669922
r_  generation:  0.0009257793426513672
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  0.00015854835510253906
r_  generation:  0.0013248920440673828
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.00023674964904785156
mini_batch_src_global generation:  0.0002942085266113281
r_  generation:  0.002217531204223633
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  0.00016808509826660156
r_  generation:  0.0009851455688476562
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0004153251647949219
----------------------check_connections_block total spend ----------------------------- 0.01713085174560547
generate_one_block  0.0033550262451171875
generate_one_block  0.0024538040161132812
generate_one_block  0.0024187564849853516
generate_one_block  0.002187967300415039
generate_one_block  0.002763032913208008
generate_one_block  0.003795146942138672
generate_one_block  0.0023691654205322266
generate_one_block  0.0014715194702148438
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002028942108154297
gen group dst list time:  0.00038933753967285156
time for parepare:  0.0016415119171142578
local_output_nid generation:  0.0002028942108154297
local_in_edges_tensor generation:  0.0007615089416503906
mini_batch_src_global generation:  0.0008625984191894531
r_  generation:  0.006336688995361328
local_output_nid generation:  0.00017976760864257812
local_in_edges_tensor generation:  0.00040435791015625
mini_batch_src_global generation:  0.0008428096771240234
r_  generation:  0.006581306457519531
local_output_nid generation:  0.0001983642578125
local_in_edges_tensor generation:  0.0003802776336669922
mini_batch_src_global generation:  0.0005972385406494141
r_  generation:  0.0057239532470703125
local_output_nid generation:  0.00018095970153808594
local_in_edges_tensor generation:  0.00035381317138671875
mini_batch_src_global generation:  0.0005333423614501953
r_  generation:  0.005126476287841797
local_output_nid generation:  0.00026917457580566406
local_in_edges_tensor generation:  0.00042176246643066406
mini_batch_src_global generation:  0.0005970001220703125
r_  generation:  0.006177186965942383
local_output_nid generation:  0.0003306865692138672
local_in_edges_tensor generation:  0.0011830329895019531
mini_batch_src_global generation:  0.0009737014770507812
r_  generation:  0.009802818298339844
local_output_nid generation:  0.00023865699768066406
local_in_edges_tensor generation:  0.00042629241943359375
mini_batch_src_global generation:  0.0006742477416992188
r_  generation:  0.005774497985839844
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  0.0003323554992675781
r_  generation:  0.0023033618927001953
----------------------check_connections_block total spend ----------------------------- 0.07280874252319336
generate_one_block  0.009273052215576172
generate_one_block  0.010277509689331055
generate_one_block  0.009300708770751953
generate_one_block  0.00840902328491211
generate_one_block  0.009420156478881836
generate_one_block  0.013944387435913086
generate_one_block  0.008926630020141602
generate_one_block  0.004399776458740234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018854141235351562
gen group dst list time:  0.0012984275817871094
time for parepare:  0.0017974376678466797
local_output_nid generation:  0.0007188320159912109
local_in_edges_tensor generation:  0.0012347698211669922
mini_batch_src_global generation:  0.0011749267578125
r_  generation:  0.01334238052368164
local_output_nid generation:  0.0009965896606445312
local_in_edges_tensor generation:  0.0012946128845214844
mini_batch_src_global generation:  0.002087116241455078
r_  generation:  0.018169879913330078
local_output_nid generation:  0.0008542537689208984
local_in_edges_tensor generation:  0.0014500617980957031
mini_batch_src_global generation:  0.001461029052734375
r_  generation:  0.016892194747924805
local_output_nid generation:  0.0009751319885253906
local_in_edges_tensor generation:  0.0011031627655029297
mini_batch_src_global generation:  0.0014820098876953125
r_  generation:  0.01691269874572754
local_output_nid generation:  0.0009062290191650391
local_in_edges_tensor generation:  0.0011811256408691406
mini_batch_src_global generation:  0.0013949871063232422
r_  generation:  0.017720460891723633
local_output_nid generation:  0.0013072490692138672
local_in_edges_tensor generation:  0.0015354156494140625
mini_batch_src_global generation:  0.002048492431640625
r_  generation:  0.020464181900024414
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0010552406311035156
mini_batch_src_global generation:  0.0014145374298095703
r_  generation:  0.016503334045410156
local_output_nid generation:  0.0004980564117431641
local_in_edges_tensor generation:  0.0006368160247802734
mini_batch_src_global generation:  0.0009648799896240234
r_  generation:  0.008710622787475586
----------------------check_connections_block total spend ----------------------------- 0.1888566017150879
generate_one_block  0.018305301666259766
generate_one_block  0.026078224182128906
generate_one_block  0.02323174476623535
generate_one_block  0.023247241973876953
generate_one_block  0.026259183883666992
generate_one_block  0.027479887008666992
generate_one_block  0.02274298667907715
generate_one_block  0.014060020446777344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017600059509277344
gen group dst list time:  0.002804279327392578
time for parepare:  0.0019087791442871094
local_output_nid generation:  0.0013070106506347656
local_in_edges_tensor generation:  0.0019381046295166016
mini_batch_src_global generation:  0.001963376998901367
r_  generation:  0.020740985870361328
local_output_nid generation:  0.0014917850494384766
local_in_edges_tensor generation:  0.00252532958984375
mini_batch_src_global generation:  0.0027284622192382812
r_  generation:  0.02424144744873047
local_output_nid generation:  0.0015017986297607422
local_in_edges_tensor generation:  0.002181529998779297
mini_batch_src_global generation:  0.0018618106842041016
r_  generation:  0.023766756057739258
local_output_nid generation:  0.0017421245574951172
local_in_edges_tensor generation:  0.002239704132080078
mini_batch_src_global generation:  0.0020401477813720703
r_  generation:  0.02425551414489746
local_output_nid generation:  0.0018439292907714844
local_in_edges_tensor generation:  0.002557992935180664
mini_batch_src_global generation:  0.001947641372680664
r_  generation:  0.025150537490844727
local_output_nid generation:  0.00173187255859375
local_in_edges_tensor generation:  0.0019290447235107422
mini_batch_src_global generation:  0.002046346664428711
r_  generation:  0.025305747985839844
local_output_nid generation:  0.0016083717346191406
local_in_edges_tensor generation:  0.0018546581268310547
mini_batch_src_global generation:  0.0019447803497314453Using backend: pytorch

r_  generation:  0.024919986724853516
local_output_nid generation:  0.0011031627655029297
local_in_edges_tensor generation:  0.0014989376068115234
mini_batch_src_global generation:  0.0017256736755371094
r_  generation:  0.019156694412231445
----------------------check_connections_block total spend ----------------------------- 0.2746708393096924
generate_one_block  0.027670621871948242
generate_one_block  0.03240656852722168
generate_one_block  0.031016826629638672
generate_one_block  0.032094717025756836
generate_one_block  0.03273892402648926
generate_one_block  0.032437801361083984
generate_one_block  0.03175234794616699
generate_one_block  0.026303768157958984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 0.06414651870727539  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

connection checking time:  0.557581901550293
block generation total time  0.5334358215332031
average batch blocks generation time:  0.06667947769165039
block dataloader generation time/epoch 1.2691445350646973
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 0.06369972229003906  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

torch.Size([16655, 500])
torch.Size([10960, 16])
torch.Size([5584, 16])
torch.Size([1596, 16])
torch.Size([395, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 2.0412230491638184  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 0.06801652908325195  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

torch.Size([18558, 500])
torch.Size([14386, 16])
torch.Size([8975, 16])
torch.Size([1639, 16])
torch.Size([390, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 2.364353656768799  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 0.0659937858581543  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

torch.Size([17818, 500])
torch.Size([13641, 16])
torch.Size([7478, 16])
torch.Size([1770, 16])
torch.Size([326, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 2.261259078979492  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 0.06795167922973633  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

torch.Size([18473, 500])
torch.Size([14351, 16])
torch.Size([7771, 16])
torch.Size([1638, 16])
torch.Size([343, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 2.3506922721862793  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 0.06689643859863281  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

torch.Size([18277, 500])
torch.Size([14966, 16])
torch.Size([7700, 16])
torch.Size([2273, 16])
torch.Size([436, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.367133617401123  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 0.06820917129516602  GigaBytes
Max Memory Allocated: 2.5112948417663574  GigaBytes

torch.Size([18886, 500])
torch.Size([15730, 16])
torch.Size([10750, 16])
torch.Size([2938, 16])
torch.Size([652, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9217529296875 GB
    Memory Allocated: 2.448561191558838  GigaBytes
Max Memory Allocated: 2.543402671813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9217529296875 GB
    Memory Allocated: 0.06691694259643555  GigaBytes
Max Memory Allocated: 2.543402671813965  GigaBytes

torch.Size([18327, 500])
torch.Size([14833, 16])
torch.Size([7056, 16])
torch.Size([2029, 16])
torch.Size([261, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9217529296875 GB
    Memory Allocated: 2.347543716430664  GigaBytes
Max Memory Allocated: 2.543402671813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9217529296875 GB
    Memory Allocated: 0.06197834014892578  GigaBytes
Max Memory Allocated: 2.543402671813965  GigaBytes

torch.Size([15868, 500])
torch.Size([9203, 16])
torch.Size([3420, 16])
torch.Size([625, 16])
torch.Size([127, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9217529296875 GB
    Memory Allocated: 1.8623628616333008  GigaBytes
Max Memory Allocated: 2.543402671813965  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018945306539535522 |0.0034399032592773438 |0.3351392447948456 |0.000140458345413208 |0.43738383054733276 |0.010354042053222656 |
----------------------------------------------------------pseudo_mini_loss sum 1.4545496702194214
Total (block generation + training)time/epoch 7.667793273925781
Training time/epoch 6.39827561378479
Training time without block to device /epoch 6.370756387710571
Training time without total dataloading part /epoch 6.191662311553955
load block tensor time/epoch 0.15156245231628418
block to device time/epoch 0.02751922607421875
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  327461
Number of first layer input nodes during this epoch:  142862
