main start at this time 1648534235.388166
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0020830631256103516
range selection method range initialization spend 9.5367431640625e-05
time for parepare:  4.1484832763671875e-05
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.0011239051818847656
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.695487976074219e-05
----------------------check_connections_block total spend ----------------------------- 0.002076864242553711
generate_one_block  0.0011246204376220703
generate_one_block  0.0010492801666259766
generate_one_block  0.0010027885437011719
generate_one_block  0.0010178089141845703
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012059211730957031
gen group dst list time:  3.147125244140625e-05
time for parepare:  0.00022101402282714844
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0002391338348388672
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.00026702880859375
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00036525726318359375
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.00033855438232421875
----------------------check_connections_block total spend ----------------------------- 0.0026268959045410156
generate_one_block  0.0013561248779296875
generate_one_block  0.0013251304626464844
generate_one_block  0.0014290809631347656
generate_one_block  0.0014553070068359375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00099945068359375
gen group dst list time:  6.866455078125e-05
time for parepare:  0.0006842613220214844
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.0002853870391845703
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0015940666198730469
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  0.00018072128295898438
r_  generation:  0.0016376972198486328
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0002224445343017578
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.0025315284729003906
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.00022602081298828125
mini_batch_src_global generation:  0.0002779960632324219
r_  generation:  0.002251863479614258
----------------------check_connections_block total spend ----------------------------- 0.012854337692260742
generate_one_block  0.0032317638397216797
generate_one_block  0.0029442310333251953
generate_one_block  0.004420757293701172
generate_one_block  0.0038466453552246094
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021126270294189453
gen group dst list time:  0.00020885467529296875
time for parepare:  0.0013799667358398438
local_output_nid generation:  0.0001990795135498047
local_in_edges_tensor generation:  0.0007545948028564453
mini_batch_src_global generation:  0.000804901123046875
r_  generation:  0.006700992584228516
local_output_nid generation:  0.00020360946655273438
local_in_edges_tensor generation:  0.00047659873962402344
mini_batch_src_global generation:  0.0010023117065429688
r_  generation:  0.007990837097167969
local_output_nid generation:  0.0002562999725341797
local_in_edges_tensor generation:  0.0005731582641601562
mini_batch_src_global generation:  0.0008983612060546875
r_  generation:  0.00945591926574707
local_output_nid generation:  0.0002346038818359375
local_in_edges_tensor generation:  0.0004968643188476562
mini_batch_src_global generation:  0.0008764266967773438
r_  generation:  0.008499860763549805
----------------------check_connections_block total spend ----------------------------- 0.048970699310302734
generate_one_block  0.01072239875793457
generate_one_block  0.01158761978149414
generate_one_block  0.013222932815551758
generate_one_block  0.012093067169189453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002103090286254883
gen group dst list time:  0.0007388591766357422
time for parepare:  0.0015883445739746094
local_output_nid generation:  0.0006432533264160156
local_in_edges_tensor generation:  0.0015747547149658203
mini_batch_src_global generation:  0.0015070438385009766
r_  generation:  0.01597309112548828
local_output_nid generation:  0.0008728504180908203
local_in_edges_tensor generation:  0.0020051002502441406
mini_batch_src_global generation:  0.0022993087768554688
r_  generation:  0.019318342208862305
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.0016024112701416016
mini_batch_src_global generation:  0.0017616748809814453
r_  generation:  0.018653392791748047
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.0012736320495605469
mini_batch_src_global generation:  0.0014107227325439453
r_  generation:  0.01708197593688965
----------------------check_connections_block total spend ----------------------------- 0.1052858829498291
generate_one_block  0.02097916603088379
generate_one_block  0.0266568660736084
generate_one_block  0.02470850944519043
generate_one_block  0.022507667541503906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017943382263183594
gen group dst list time:  0.001369476318359375
time for parepare:  0.0015025138854980469
local_output_nid generation:  0.0011663436889648438
local_in_edges_tensor generation:  0.0023889541625976562
mini_batch_src_global generation:  0.0019981861114501953
r_  generation:  0.023049354553222656
local_output_nid generation:  0.0013153553009033203
local_in_edges_tensor generation:  0.002248525619506836
mini_batch_src_global generation:  0.0023751258850097656
r_  generation:  0.02382826805114746
local_output_nid generation:  0.0013926029205322266
local_in_edges_tensor generation:  0.0023789405822753906
mini_batch_src_global generation:  0.0023796558380126953
r_  generation:  0.023919105529785156
local_output_nid generation:  0.0012946128845214844
local_in_edges_tensor generation:  0.0017976760864257812
mini_batch_src_global generation:  0.001897573471069336
r_  generation:  0.02233719825744629
----------------------check_connections_block total spend ----------------------------- 0.1371598243713379
generate_one_block  0.02952289581298828
generate_one_block  0.030091524124145508
generate_one_block  0.029882431030273438
generate_one_block  0.02862858772277832
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007589817047119141  GigaBytes
Max Memory Allocated: 0.007589817047119141  GigaBytes

connection checking time:  0.3068976402282715
block generation total time  0.2806127071380615
average batch blocks generation time:  0.07015317678451538
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.043938636779785156  GigaBytes
Max Memory Allocated: 0.043938636779785156  GigaBytes

torch.Size([18740, 500])
torch.Size([15522, 16])
torch.Size([9383, 16])
torch.Size([2990, 16])
torch.Size([628, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 2.3647379875183105  GigaBytes
Max Memory Allocated: 2.4771499633789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.051873207092285156  GigaBytes
Max Memory Allocated: 2.4771499633789062  GigaBytes

torch.Size([18984, 500])
torch.Size([16009, 16])
torch.Size([11088, 16])
torch.Size([2725, 16])
torch.Size([660, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9412841796875 GB
    Memory Allocated: 2.4568114280700684  GigaBytes
Max Memory Allocated: 2.557410717010498  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9412841796875 GB
    Memory Allocated: 0.05173301696777344  GigaBytes
Max Memory Allocated: 2.557410717010498  GigaBytes

torch.Size([18875, 500])
torch.Size([16180, 16])
torch.Size([10345, 16])
torch.Size([3633, 16])
torch.Size([850, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 2.468107223510742  GigaBytes
Max Memory Allocated: 2.560798168182373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9901123046875 GB
    Memory Allocated: 0.050601959228515625  GigaBytes
Max Memory Allocated: 2.560798168182373  GigaBytes

torch.Size([18318, 500])
torch.Size([14545, 16])
torch.Size([9160, 16])
torch.Size([2973, 16])
torch.Size([716, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 2.344832420349121  GigaBytes
Max Memory Allocated: 2.560798168182373  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.019562482833862305 |0.08860808610916138 |0.5013700723648071 |0.00018644332885742188 |0.47931259870529175 |0.011167049407958984 |
----------------------------------------------------------pseudo_mini_loss sum 1.6279548406600952
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  192680
Number of first layer input nodes during this epoch:  74917
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 0.06912422180175781  GigaBytes
Max Memory Allocated: 2.560798168182373  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006473064422607422
range selection method range initialization spend 7.867813110351562e-05
time for parepare:  6.914138793945312e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.723403930664062e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.457069396972656e-05
----------------------check_connections_block total spend ----------------------------- 0.0012402534484863281
generate_one_block  0.0017273426055908203
generate_one_block  0.00127410888671875
generate_one_block  0.0013003349304199219
generate_one_block  0.0014467239379882812
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006687641143798828
gen group dst list time:  4.863739013671875e-05
time for parepare:  0.0003638267517089844
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.00041222572326660156
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0002589225769042969
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0005769729614257812
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00027441978454589844
----------------------check_connections_block total spend ----------------------------- 0.0034596920013427734
generate_one_block  0.0018744468688964844
generate_one_block  0.0015652179718017578
generate_one_block  0.0021927356719970703
generate_one_block  0.0015134811401367188
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012171268463134766
gen group dst list time:  0.00011014938354492188
time for parepare:  0.0009992122650146484
local_output_nid generation:  0.00010728836059570312
local_in_edges_tensor generation:  0.0003807544708251953
mini_batch_src_global generation:  0.00035452842712402344
r_  generation:  0.00275421142578125
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  0.0002655982971191406
r_  generation:  0.0017864704132080078
local_output_nid generation:  0.00014448165893554688
local_in_edges_tensor generation:  0.0003161430358886719
mini_batch_src_global generation:  0.00039887428283691406
r_  generation:  0.0038034915924072266
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  0.00018525123596191406
r_  generation:  0.0013318061828613281
----------------------check_connections_block total spend ----------------------------- 0.01611638069152832
generate_one_block  0.0046002864837646484
generate_one_block  0.0031194686889648438
generate_one_block  0.005616903305053711
generate_one_block  0.002822399139404297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0022253990173339844
gen group dst list time:  0.00031447410583496094
time for parepare:  0.0016987323760986328
local_output_nid generation:  0.00032806396484375
local_in_edges_tensor generation:  0.0009801387786865234
mini_batch_src_global generation:  0.001224517822265625
r_  generation:  0.019639253616333008
local_output_nid generation:  0.0003085136413574219
local_in_edges_tensor generation:  0.0006482601165771484
mini_batch_src_global generation:  0.0013620853424072266
r_  generation:  0.0088043212890625
local_output_nid generation:  0.00040221214294433594
local_in_edges_tensor generation:  0.0007398128509521484
mini_batch_src_global generation:  0.0012483596801757812
r_  generation:  0.012933015823364258
local_output_nid generation: Using backend: pytorch
 0.0002636909484863281
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.0007834434509277344
r_  generation:  0.006655693054199219
----------------------check_connections_block total spend ----------------------------- 0.06910085678100586
generate_one_block  0.014628171920776367
generate_one_block  0.012702703475952148
generate_one_block  0.018582820892333984
generate_one_block  0.011249303817749023
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019872188568115234
gen group dst list time:  0.0007500648498535156
time for parepare:  0.0015628337860107422
local_output_nid generation:  0.0008704662322998047
local_in_edges_tensor generation:  0.0018405914306640625
mini_batch_src_global generation:  0.001739501953125
r_  generation:  0.019333362579345703
local_output_nid generation:  0.0008108615875244141
local_in_edges_tensor generation:  0.0016183853149414062
mini_batch_src_global generation:  0.0021505355834960938
r_  generation:  0.01831650733947754
local_output_nid generation:  0.0012085437774658203
local_in_edges_tensor generation:  0.002043485641479492
mini_batch_src_global generation:  0.002057313919067383
r_  generation:  0.023227453231811523
local_output_nid generation:  0.0009920597076416016
local_in_edges_tensor generation:  0.0012555122375488281
mini_batch_src_global generation:  0.0016677379608154297
r_  generation:  0.018207550048828125
----------------------check_connections_block total spend ----------------------------- 0.11711573600769043
generate_one_block  0.027070999145507812
generate_one_block  0.02549147605895996
generate_one_block  0.03124690055847168
generate_one_block  0.02508258819580078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018084049224853516
gen group dst list time:  0.0014548301696777344
time for parepare:  0.00167083740234375
local_output_nid generation:  0.0014383792877197266
local_in_edges_tensor generation:  0.0025708675384521484
mini_batch_src_global generation:  0.001947164535522461
r_  generation:  0.024198293685913086
local_output_nid generation:  0.0013947486877441406
local_in_edges_tensor generation:  0.0023627281188964844
mini_batch_src_global generation:  0.002532482147216797
r_  generation:  0.02348017692565918
local_output_nid generation:  0.0016222000122070312
local_in_edges_tensor generation:  0.002706289291381836
mini_batch_src_global generation:  0.002285003662109375
r_  generation:  0.02603316307067871
local_output_nid generation:  0.0016374588012695312
local_in_edges_tensor generation:  0.0023546218872070312
mini_batch_src_global generation:  0.002084016799926758
r_  generation:  0.024680614471435547
----------------------check_connections_block total spend ----------------------------- 0.14577412605285645
generate_one_block  0.03241157531738281
generate_one_block  0.03244447708129883
generate_one_block  0.03384995460510254
generate_one_block  0.03265666961669922
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 0.06912422180175781  GigaBytes
Max Memory Allocated: 2.560798168182373  GigaBytes

connection checking time:  0.35156679153442383
block generation total time  0.3207225799560547
average batch blocks generation time:  0.08018064498901367
block dataloader generation time/epoch 0.7792432308197021
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 0.06757593154907227  GigaBytes
Max Memory Allocated: 2.560798168182373  GigaBytes

torch.Size([18674, 500])
torch.Size([15510, 16])
torch.Size([10479, 16])
torch.Size([2770, 16])
torch.Size([764, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 2.4444832801818848  GigaBytes
Max Memory Allocated: 2.560798168182373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 0.06680774688720703  GigaBytes
Max Memory Allocated: 2.560798168182373  GigaBytes

torch.Size([18324, 500])
torch.Size([14685, 16])
torch.Size([9283, 16])
torch.Size([2545, 16])
torch.Size([519, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 2.3504018783569336  GigaBytes
Max Memory Allocated: 2.560798168182373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 0.0689992904663086  GigaBytes
Max Memory Allocated: 2.560798168182373  GigaBytes

torch.Size([19326, 500])
torch.Size([17621, 16])
torch.Size([13574, 16])
torch.Size([4862, 16])
torch.Size([1144, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.58903169631958  GigaBytes
Max Memory Allocated: 2.667161464691162  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 0.06781435012817383  GigaBytes
Max Memory Allocated: 2.667161464691162  GigaBytes

torch.Size([18712, 500])
torch.Size([15945, 16])
torch.Size([8725, 16])
torch.Size([2522, 16])
torch.Size([441, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1541748046875 GB
    Memory Allocated: 2.448272705078125  GigaBytes
Max Memory Allocated: 2.667161464691162  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024380147457122803 |0.002719700336456299 |0.3510746359825134 |0.00013583898544311523 |0.47641271352767944 |0.012952327728271484 |
----------------------------------------------------------pseudo_mini_loss sum 1.2952336072921753
Total (block generation + training)time/epoch 4.22559928894043
Training time/epoch 3.445923089981079
Training time without block to device /epoch 3.435044288635254
Training time without total dataloading part /epoch 3.3234450817108154
load block tensor time/epoch 0.09752058982849121
block to device time/epoch 0.010878801345825195
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  196782
Number of first layer input nodes during this epoch:  75036
