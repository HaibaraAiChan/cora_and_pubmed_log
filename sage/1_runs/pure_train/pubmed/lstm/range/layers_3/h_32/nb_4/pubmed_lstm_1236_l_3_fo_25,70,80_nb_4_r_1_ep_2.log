main start at this time 1648529523.3586118
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0015461444854736328
range selection method range initialization spend 8.249282836914062e-05
time for parepare:  6.079673767089844e-05
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0016007423400878906
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  7.486343383789062e-05
----------------------check_connections_block total spend ----------------------------- 0.002400636672973633
generate_one_block  0.0015413761138916016
generate_one_block  0.0013895034790039062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011363029479980469
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.0003209114074707031
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.0008547306060791016
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0008957386016845703
----------------------check_connections_block total spend ----------------------------- 0.003210783004760742
generate_one_block  0.002397298812866211
generate_one_block  0.002300262451171875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012898445129394531
gen group dst list time:  8.463859558105469e-05
time for parepare:  0.0009362697601318359
local_output_nid generation:  0.0001304149627685547
local_in_edges_tensor generation:  0.00045680999755859375
mini_batch_src_global generation:  0.0003581047058105469
r_  generation:  0.004418134689331055
local_output_nid generation:  0.0001468658447265625
local_in_edges_tensor generation:  0.0003783702850341797
mini_batch_src_global generation:  0.0006589889526367188
r_  generation:  0.0051915645599365234
----------------------check_connections_block total spend ----------------------------- 0.015262842178344727
generate_one_block  0.005556344985961914
generate_one_block  0.00603485107421875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

connection checking time:  0.01847362518310547
block generation total time  0.01628875732421875
average batch blocks generation time:  0.008144378662109375
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.016745567321777344  GigaBytes
Max Memory Allocated: 0.016745567321777344  GigaBytes

torch.Size([4821, 500])
torch.Size([1431, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3593316078186035  GigaBytes
Max Memory Allocated: 0.38092708587646484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.02566242218017578  GigaBytes
Max Memory Allocated: 0.38092708587646484  GigaBytes

torch.Size([5487, 500])
torch.Size([1448, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.4258589744567871  GigaBytes
Max Memory Allocated: 0.4528489112854004  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0036431550979614258 |0.17297780513763428 |0.4010666608810425 |0.0001800060272216797 |0.19343018531799316 |0.00811767578125 |
----------------------------------------------------------pseudo_mini_loss sum 2.003878593444824
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13542
Number of first layer input nodes during this epoch:  10308
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.04203367233276367  GigaBytes
Max Memory Allocated: 0.4528489112854004  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005087852478027344
range selection method range initialization spend 5.1021575927734375e-05
time for parepare:  5.7697296142578125e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  7.033348083496094e-05
----------------------check_connections_block total spend ----------------------------- 0.0007092952728271484
generate_one_block  0.0012655258178710938
generate_one_block  0.0011675357818603516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005605220794677734
gen group dst list time:  2.956390380859375e-05
time for parepare:  0.0002777576446533203
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0005917549133300781
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  0.00014019012451171875
r_  generation:  0.00079345703125
----------------------check_connections_block total spend ----------------------------- 0.002675294876098633
generate_one_block  0.001955270767211914
generate_one_block  0.002163410186767578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010464191436767578
gen group dst list time:  7.534027099609375e-05
time for parepare:  0.0007526874542236328
local_output_nid generation:  0.00012731552124023438
local_in_edges_tensor generation:  0.0003914833068847656
mini_batch_src_global generation:  0.0003082752227783203
r_  generation:  0.003284454345703125
local_output_nid generation:  0.00014543533325195312
local_in_edges_tensor generation:  0.00032782554626464844
mini_batch_src_global generation:  0.0005793571472167969
r_  generation:  0.004473686218261719
----------------------check_connections_block total spend ----------------------------- 0.01273202896118164
generate_one_block  0.005816459655761719
generate_one_block  0.007372617721557617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.04203367233276367  GigaBytes
Max Memory Allocated: 0.4528489112854004  GigaBytes

connection checking time:  0.015407323837280273
block generation total time  0.017307758331298828
average batch blocks generation time:  0.008653879165649414
block dataloader generation time/epoch 0.055413007736206055
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.04084968566894531  GigaBytes
Max Memory Allocated: 0.4528489112854004  GigaBytes
Using backend: pytorch

torch.Size([4947, 500])
torch.Size([1343, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.34227466583251953  GigaBytes
Max Memory Allocated: 0.4528489112854004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.04189348220825195  GigaBytes
Max Memory Allocated: 0.4528489112854004  GigaBytes

torch.Size([5309, 500])
torch.Size([1579, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.4680318832397461  GigaBytes
Max Memory Allocated: 0.49593448638916016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002737879753112793 |0.0007840394973754883 |0.15885233879089355 |0.00014126300811767578 |0.20768988132476807 |0.0066983699798583984 |
----------------------------------------------------------pseudo_mini_loss sum 2.2233307361602783
Total (block generation + training)time/epoch 0.8075423240661621
Training time/epoch 0.7519392967224121
Training time without block to device /epoch 0.7503712177276611
Training time without total dataloading part /epoch 0.740065336227417
load block tensor time/epoch 0.005475759506225586
block to device time/epoch 0.0015680789947509766
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13535
Number of first layer input nodes during this epoch:  10256
