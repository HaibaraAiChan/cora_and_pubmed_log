main start at this time 1648529598.825479
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0022978782653808594
range selection method range initialization spend 0.00011587142944335938
time for parepare:  8.249282836914062e-05
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00028228759765625
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00212860107421875
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  6.175041198730469e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  5.745887756347656e-05
----------------------check_connections_block total spend ----------------------------- 0.003795146942138672
generate_one_block  0.001901388168334961
generate_one_block  0.0014090538024902344
generate_one_block  0.0012998580932617188
generate_one_block  0.0012955665588378906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012786388397216797
gen group dst list time:  4.9591064453125e-05
time for parepare:  0.00032973289489746094
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0002238750457763672
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0005559921264648438
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0002593994140625
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00040459632873535156
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00042510032653808594
----------------------check_connections_block total spend ----------------------------- 0.0034720897674560547
generate_one_block  0.00205230712890625
generate_one_block  0.0016095638275146484
generate_one_block  0.001743316650390625
generate_one_block  0.0017647743225097656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0013954639434814453
gen group dst list time:  0.00010275840759277344
time for parepare:  0.0010170936584472656
local_output_nid generation:  9.250640869140625e-05
local_in_edges_tensor generation:  0.00038361549377441406
mini_batch_src_global generation:  0.00031685829162597656
r_  generation:  0.003557920455932617
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  0.00023889541625976562
r_  generation:  0.0014917850494384766
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.0002689361572265625
mini_batch_src_global generation:  0.0002639293670654297
r_  generation:  0.0028095245361328125
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.0005664825439453125
mini_batch_src_global generation:  0.0003619194030761719
r_  generation:  0.002578258514404297
----------------------check_connections_block total spend ----------------------------- 0.01743030548095703
generate_one_block  0.005158901214599609
generate_one_block  0.0024154186248779297
generate_one_block  0.003974199295043945
generate_one_block  0.004071235656738281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

connection checking time:  0.020902395248413086
block generation total time  0.022789716720581055
average batch blocks generation time:  0.005697429180145264
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.015447616577148438  GigaBytes
Max Memory Allocated: 0.015447616577148438  GigaBytes

torch.Size([4133, 500])
torch.Size([935, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.3088397979736328  GigaBytes
Max Memory Allocated: 0.3282747268676758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.01973867416381836  GigaBytes
Max Memory Allocated: 0.3282747268676758  GigaBytes

torch.Size([1893, 500])
torch.Size([526, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.12898492813110352  GigaBytes
Max Memory Allocated: 0.3282747268676758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.023158550262451172  GigaBytes
Max Memory Allocated: 0.3282747268676758  GigaBytes

torch.Size([4171, 500])
torch.Size([780, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.2510495185852051  GigaBytes
Max Memory Allocated: 0.3282747268676758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.021060466766357422  GigaBytes
Max Memory Allocated: 0.3282747268676758  GigaBytes

torch.Size([3040, 500])
torch.Size([697, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.27454233169555664  GigaBytes
Max Memory Allocated: 0.3282747268676758  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006409108638763428 |0.09066665172576904 |0.3025345206260681 |0.0001671314239501953 |0.2542456388473511 |0.008627891540527344 |
----------------------------------------------------------pseudo_mini_loss sum 2.168369770050049
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16530
Number of first layer input nodes during this epoch:  13237
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.03737354278564453  GigaBytes
Max Memory Allocated: 0.3282747268676758  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005321502685546875
range selection method range initialization spend 5.3882598876953125e-05
time for parepare:  5.2928924560546875e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001049041748046875Using backend: pytorch

mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  4.6253204345703125e-05
----------------------check_connections_block total spend ----------------------------- 0.0011279582977294922
generate_one_block  0.001209259033203125
generate_one_block  0.001134634017944336
generate_one_block  0.0010521411895751953
generate_one_block  0.0010840892791748047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005652904510498047
gen group dst list time:  3.504753112792969e-05
time for parepare:  0.00030303001403808594
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0003285408020019531
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.00029921531677246094
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.00037360191345214844
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.00038051605224609375
----------------------check_connections_block total spend ----------------------------- 0.0030667781829833984
generate_one_block  0.0016102790832519531
generate_one_block  0.0014498233795166016
generate_one_block  0.0018987655639648438
generate_one_block  0.0016357898712158203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001016378402709961
gen group dst list time:  9.655952453613281e-05
time for parepare:  0.002023935317993164
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.00030994415283203125
mini_batch_src_global generation:  0.00018072128295898438
r_  generation:  0.0018835067749023438
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  0.00027298927307128906
r_  generation:  0.001817464828491211
local_output_nid generation:  7.891654968261719e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  0.0002849102020263672
r_  generation:  0.0027129650115966797
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.0002288818359375
mini_batch_src_global generation:  0.0002579689025878906
r_  generation:  0.0025899410247802734
----------------------check_connections_block total spend ----------------------------- 0.015880584716796875
generate_one_block  0.0037360191345214844
generate_one_block  0.0038900375366210938
generate_one_block  0.004785776138305664
generate_one_block  0.004729747772216797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.03737354278564453  GigaBytes
Max Memory Allocated: 0.3282747268676758  GigaBytes

connection checking time:  0.018947362899780273
block generation total time  0.023736238479614258
average batch blocks generation time:  0.0059340596199035645
block dataloader generation time/epoch 0.08533191680908203
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.03756856918334961  GigaBytes
Max Memory Allocated: 0.3282747268676758  GigaBytes

torch.Size([3206, 500])
torch.Size([726, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5447998046875 GB
    Memory Allocated: 0.21632862091064453  GigaBytes
Max Memory Allocated: 0.3282747268676758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5447998046875 GB
    Memory Allocated: 0.03798675537109375  GigaBytes
Max Memory Allocated: 0.3282747268676758  GigaBytes

torch.Size([3429, 500])
torch.Size([649, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5447998046875 GB
    Memory Allocated: 0.2238907814025879  GigaBytes
Max Memory Allocated: 0.3282747268676758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5447998046875 GB
    Memory Allocated: 0.037815093994140625  GigaBytes
Max Memory Allocated: 0.3282747268676758  GigaBytes

torch.Size([3322, 500])
torch.Size([776, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5447998046875 GB
    Memory Allocated: 0.32091236114501953  GigaBytes
Max Memory Allocated: 0.33934783935546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5447998046875 GB
    Memory Allocated: 0.03882265090942383  GigaBytes
Max Memory Allocated: 0.33934783935546875  GigaBytes

torch.Size([3865, 500])
torch.Size([886, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5447998046875 GB
    Memory Allocated: 0.30617856979370117  GigaBytes
Max Memory Allocated: 0.33934783935546875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005477786064147949 |0.0008872747421264648 |0.19226813316345215 |0.00013941526412963867 |0.28099387884140015 |0.007451772689819336 |
----------------------------------------------------------pseudo_mini_loss sum 1.948302984237671
Total (block generation + training)time/epoch 2.0229837894439697
Training time/epoch 1.937312126159668
Training time without block to device /epoch 1.933763027191162
Training time without total dataloading part /epoch 1.901057481765747
load block tensor time/epoch 0.021911144256591797
block to device time/epoch 0.0035490989685058594
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17216
Number of first layer input nodes during this epoch:  13822
