main start at this time 1648529437.8479683
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005841255187988281
range selection method range initialization spend 0.00010323524475097656
time for parepare:  4.315376281738281e-05
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  0.0013158321380615234
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.1682510375976562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6689300537109375e-05
----------------------check_connections_block total spend ----------------------------- 0.004060983657836914
generate_one_block  0.0011887550354003906
generate_one_block  0.0010116100311279297
generate_one_block  0.0009992122650146484
generate_one_block  0.0010128021240234375
generate_one_block  0.0009882450103759766
generate_one_block  0.0009927749633789062
generate_one_block  0.0009877681732177734
generate_one_block  0.0010406970977783203
generate_one_block  0.0009837150573730469
generate_one_block  0.001004934310913086
generate_one_block  0.0010056495666503906
generate_one_block  0.00098419189453125
generate_one_block  0.0009946823120117188
generate_one_block  0.001004934310913086
generate_one_block  0.0010030269622802734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006301403045654297
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.00023889541625976562
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.031990051269531e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0001964569091796875
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  8.177757263183594e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00017523765563964844
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.556510925292969e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  7.82012939453125e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.000171661376953125
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00010371208190917969
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00022029876708984375
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  7.486343383789062e-05
----------------------check_connections_block total spend ----------------------------- 0.00458979606628418
generate_one_block  0.0010590553283691406
generate_one_block  0.0012619495391845703
generate_one_block  0.001074075698852539
generate_one_block  0.0012242794036865234
generate_one_block  0.0010726451873779297
generate_one_block  0.0010533332824707031
generate_one_block  0.0010945796966552734
generate_one_block  0.0010738372802734375
generate_one_block  0.0010411739349365234
generate_one_block  0.0011301040649414062
generate_one_block  0.001047372817993164
generate_one_block  0.0009720325469970703
generate_one_block  0.0009593963623046875
generate_one_block  0.0012066364288330078
generate_one_block  0.0010590553283691406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010666847229003906
gen group dst list time:  0.00011992454528808594
time for parepare:  0.00072479248046875
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00026035308837890625
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00014901161193847656
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0011301040649414062
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.00025081634521484375
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  0.00010967254638671875
r_  generation:  0.0011780261993408203
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.0002770423889160156
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00023221969604492188
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0002493858337402344
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.0004329681396484375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  9.298324584960938e-05
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0008947849273681641
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0006651878356933594
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0002613067626953125
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001888275146484375
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  0.00013494491577148438
r_  generation:  0.0015604496002197266
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.00045800209045410156
----------------------check_connections_block total spend ----------------------------- 0.014756202697753906
generate_one_block  0.0012865066528320312
generate_one_block  0.002540111541748047
generate_one_block  0.0012509822845458984
generate_one_block  0.0023572444915771484
generate_one_block  0.0012400150299072266
generate_one_block  0.0012874603271484375
generate_one_block  0.0012331008911132812
generate_one_block  0.0014383792877197266
generate_one_block  0.0010225772857666016
generate_one_block  0.001990795135498047
generate_one_block  0.0017714500427246094
generate_one_block  0.0012600421905517578
generate_one_block  0.0011494159698486328
generate_one_block  0.0031347274780273438
generate_one_block  0.0014431476593017578
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

connection checking time:  0.019345998764038086
block generation total time  0.040735483169555664
average batch blocks generation time:  0.0027156988779703777
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.008131027221679688  GigaBytes
Max Memory Allocated: 0.008131027221679688  GigaBytes

torch.Size([249, 500])
torch.Size([82, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2147216796875 GB
    Memory Allocated: 0.019340991973876953  GigaBytes
Max Memory Allocated: 0.019993305206298828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.019966602325439453  GigaBytes
Max Memory Allocated: 0.034687042236328125  GigaBytes

torch.Size([1990, 500])
torch.Size([414, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.12805557250976562  GigaBytes
Max Memory Allocated: 0.13494443893432617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.01700735092163086  GigaBytes
Max Memory Allocated: 0.13975143432617188  GigaBytes

torch.Size([415, 500])
torch.Size([108, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.03624582290649414  GigaBytes
Max Memory Allocated: 0.13975143432617188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.01913309097290039  GigaBytes
Max Memory Allocated: 0.13975143432617188  GigaBytes

torch.Size([1541, 500])
torch.Size([356, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.1373147964477539  GigaBytes
Max Memory Allocated: 0.14598846435546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.017071247100830078  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

torch.Size([449, 500])
torch.Size([113, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.03924751281738281  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.017011642456054688  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

torch.Size([417, 500])
torch.Size([109, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.036805152893066406  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.01701831817626953  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

torch.Size([421, 500])
torch.Size([118, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.03831672668457031  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.017625808715820312  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

torch.Size([744, 500])
torch.Size([167, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.05651569366455078  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.016457557678222656  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

torch.Size([122, 500])
torch.Size([50, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.022087574005126953  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.019114971160888672  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

torch.Size([1537, 500])
torch.Size([370, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.1018228530883789  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.018787384033203125  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

torch.Size([1364, 500])
torch.Size([223, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.0821833610534668  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.01710033416748047  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

torch.Size([465, 500])
torch.Size([82, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.03953123092651367  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.016931533813476562  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

torch.Size([375, 500])
torch.Size([63, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.03238248825073242  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.019794464111328125  GigaBytes
Max Memory Allocated: 0.14817476272583008  GigaBytes

torch.Size([1890, 500])
torch.Size([443, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.17706871032714844  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.01766681671142578  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([766, 500])
torch.Size([151, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.05662059783935547  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0017201423645019532 |0.024129597345987956 |0.10237549146016439 |0.00012162526448567708 |0.07352727254231771 |0.010022163391113281 |
----------------------------------------------------------pseudo_mini_loss sum 2.2231593132019043
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15951
Number of first layer input nodes during this epoch:  12745
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.033907413482666016  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002234935760498047
range selection method range initialization spend 5.435943603515625e-05
time for parepare:  5.793571472167969e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.9788742065429688e-05
----------------------check_connections_block total spend ----------------------------- 0.0028181076049804688
generate_one_block  0.0011715888977050781
generate_one_block  0.0010685920715332031
generate_one_block  0.0010807514190673828
generate_one_block  0.0010745525360107422
generate_one_block  0.0010569095611572266
generate_one_block  0.0010595321655273438
generate_one_block  0.0010592937469482422
generate_one_block  0.001058816909790039
generate_one_block  0.001062154769897461
generate_one_block  0.0011303424835205078
generate_one_block  0.001050710678100586
generate_one_block  0.0010600090026855469
generate_one_block  0.001043558120727539
generate_one_block  0.0009982585906982422
generate_one_block  0.0009922981262207031
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012402534484863281
gen group dst list time:  8.130073547363281e-05
time for parepare:  0.0002522468566894531
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.628036499023438e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00013065338134765625
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00013136863708496094
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  8.58306884765625e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00010538101196289062
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.14984130859375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.153915405273438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  8.7738037109375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0001747608184814453
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0001354217529296875
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00018358230590820312
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  8.225440979003906e-05
----------------------check_connections_block total spend ----------------------------- 0.004693508148193359
generate_one_block  0.0011310577392578125
generate_one_block  0.0011448860168457031
generate_one_block  0.0012629032135009766
generate_one_block  0.0012135505676269531
generate_one_block  0.0011515617370605469
generate_one_block  0.0011286735534667969
generate_one_block  0.0012691020965576172
generate_one_block  0.0010991096496582031
generate_one_block  0.00103759765625
generate_one_block  0.001085519790649414
generate_one_block  0.0010979175567626953
generate_one_block  0.0012214183807373047
generate_one_block  0.0011556148529052734
generate_one_block  0.0012164115905761719
generate_one_block  0.0010769367218017578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012087821960449219
gen group dst list time:  0.00013017654418945312
time for parepare:  0.0008449554443359375
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0001823902130126953
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.00040078163146972656
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  9.465217590332031e-05
r_  generation:  0.0007266998291015625
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0005435943603515625
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00036144256591796875
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.00032901763916015625
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0006916522979736328
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.000247955322265625
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.000274658203125
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0005576610565185547
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0005266666412353516
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.0011897087097167969
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  0.00010561943054199219
r_  generation:  0.0007240772247314453
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.0012178421020507812
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.0003724098205566406
----------------------check_connections_block total spend ----------------------------- 0.01580071449279785
generate_one_block  0.00136566162109375
generate_one_block  0.0016791820526123047
generate_one_block  0.0019214153289794922
generate_one_block  0.0017480850219726562
generate_one_block  0.0014073848724365234
generate_one_block  0.0013871192932128906
generate_one_block  0.0019326210021972656
generate_one_block  0.0012614727020263672
generate_one_block  0.0013442039489746094
generate_one_block  0.0016911029815673828
generate_one_block  0.0016405582427978516
generate_one_block  0.0024504661560058594
generate_one_block  0.0018808841705322266
generate_one_block  0.002542734146118164
generate_one_block  0.0014264583587646484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.033907413482666016  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

connection checking time:  0.02049422264099121
block generation total time  0.04297161102294922
average batch blocks generation time:  0.0028647740681966146
block dataloader generation time/epoch 0.13495540618896484
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.03306770324707031  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([330, 500])
torch.Size([75, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.04713630676269531  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.03403806686401367  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([847, 500])
torch.Size([125, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.070037841796875  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.03484487533569336  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([1276, 500])
torch.Size([324, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.0989828109741211  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.03410530090332031  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([881, 500])
torch.Size([221, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.08108711242675781  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.03431415557861328  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([527, 500])
torch.Size([149, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.06506967544555664  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.03349876403808594  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([559, 500])
torch.Size([115, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.06184720993041992  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.034972190856933594  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([1344, 500])
torch.Size([219, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.09976625442504883  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.033197879791259766  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([399, 500])
torch.Size([96, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.052168846130371094  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.03338623046875  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([499, 500])
torch.Size([98, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.05734968185424805  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.03441619873046875  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([1048, 500])
torch.Size([166, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.08588123321533203  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.03413200378417969  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([896, 500])
torch.Size([182, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.08082962036132812  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.034951210021972656  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([1324, 500])
torch.Size([312, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.15581130981445312  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.034886837005615234  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([1298, 500])
torch.Size([269, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.10074043273925781  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.03554821014404297  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([1645, 500])
torch.Size([371, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.15278053283691406  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.03442716598510742  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes

torch.Size([707, 500])
torch.Size([151, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.06378889083862305  GigaBytes
Max Memory Allocated: 0.1896357536315918  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0019406318664550782 |0.0008028507232666016 |0.0735491116841634 |0.00011386871337890626 |0.07719415028889974 |0.006309032440185547 |
----------------------------------------------------------pseudo_mini_loss sum 1.3659776449203491
Total (block generation + training)time/epoch 2.472280740737915
Training time/epoch 2.3370137214660645
Training time without block to device /epoch 2.3249709606170654
Training time without total dataloading part /epoch 2.2691659927368164
load block tensor time/epoch 0.029109477996826172
block to device time/epoch 0.012042760848999023
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16810
Number of first layer input nodes during this epoch:  13580
