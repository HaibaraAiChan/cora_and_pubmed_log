main start at this time 1648529534.9067042
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002696514129638672
range selection method range initialization spend 7.891654968261719e-05
time for parepare:  5.054473876953125e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0013420581817626953
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.4332275390625e-05
----------------------check_connections_block total spend ----------------------------- 0.002428770065307617
generate_one_block  0.0013508796691894531
generate_one_block  0.0012271404266357422
generate_one_block  0.0012259483337402344
generate_one_block  0.0011622905731201172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0013010501861572266
gen group dst list time:  4.1961669921875e-05
time for parepare:  0.00029087066650390625
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005147457122802734
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.00022912025451660156
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00035643577575683594
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00036835670471191406
----------------------check_connections_block total spend ----------------------------- 0.003131866455078125
generate_one_block  0.0019145011901855469
generate_one_block  0.0014355182647705078
generate_one_block  0.0016391277313232422
generate_one_block  0.0016162395477294922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012671947479248047
gen group dst list time:  8.606910705566406e-05
time for parepare:  0.0009822845458984375
local_output_nid generation:  8.749961853027344e-05
local_in_edges_tensor generation:  0.00039887428283691406
mini_batch_src_global generation:  0.0002446174621582031
r_  generation:  0.002892017364501953
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00021457672119140625
mini_batch_src_global generation:  0.00018835067749023438
r_  generation:  0.0012216567993164062
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  0.00021648406982421875
r_  generation:  0.002418994903564453
local_output_nid generation:  6.842613220214844e-05
local_in_edges_tensor generation:  0.0005023479461669922
mini_batch_src_global generation:  0.00025653839111328125
r_  generation:  0.002271413803100586
----------------------check_connections_block total spend ----------------------------- 0.014718055725097656
generate_one_block  0.004282712936401367
generate_one_block  0.0022411346435546875
generate_one_block  0.0036652088165283203
generate_one_block  0.003541231155395508
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

connection checking time:  0.01784992218017578
block generation total time  0.020335674285888672
average batch blocks generation time:  0.005083918571472168
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014800071716308594  GigaBytes
Max Memory Allocated: 0.014800071716308594  GigaBytes

torch.Size([3791, 500])
torch.Size([935, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4803466796875 GB
    Memory Allocated: 0.26734018325805664  GigaBytes
Max Memory Allocated: 0.2840700149536133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4822998046875 GB
    Memory Allocated: 0.01866436004638672  GigaBytes
Max Memory Allocated: 0.2840700149536133  GigaBytes

torch.Size([1777, 500])
torch.Size([526, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4822998046875 GB
    Memory Allocated: 0.11751031875610352  GigaBytes
Max Memory Allocated: 0.2840700149536133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4822998046875 GB
    Memory Allocated: 0.022478580474853516  GigaBytes
Max Memory Allocated: 0.2840700149536133  GigaBytes

torch.Size([3809, 500])
torch.Size([785, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4822998046875 GB
    Memory Allocated: 0.22890329360961914  GigaBytes
Max Memory Allocated: 0.2840700149536133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4822998046875 GB
    Memory Allocated: 0.02044963836669922  GigaBytes
Max Memory Allocated: 0.2840700149536133  GigaBytes

torch.Size([2718, 500])
torch.Size([697, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4822998046875 GB
    Memory Allocated: 0.2310795783996582  GigaBytes
Max Memory Allocated: 0.2840700149536133  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002710282802581787 |0.0867229700088501 |0.24009114503860474 |0.0001391768455505371 |0.15319210290908813 |0.008651971817016602 |
----------------------------------------------------------pseudo_mini_loss sum 2.161320447921753
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15393
Number of first layer input nodes during this epoch:  12095
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.03584766387939453  GigaBytes
Max Memory Allocated: 0.2840700149536133  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005080699920654297
range selection method range initialization spend 5.173683166503906e-05
time for parepare:  5.412101745605469e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011038780212402344Using backend: pytorch

mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.887580871582031e-05
----------------------check_connections_block total spend ----------------------------- 0.0011620521545410156
generate_one_block  0.0011851787567138672
generate_one_block  0.0011141300201416016
generate_one_block  0.0011334419250488281
generate_one_block  0.0011401176452636719
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005581378936767578
gen group dst list time:  3.4809112548828125e-05
time for parepare:  0.00026726722717285156
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00032782554626464844
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0002930164337158203
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0003933906555175781
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0004074573516845703
----------------------check_connections_block total spend ----------------------------- 0.0030601024627685547
generate_one_block  0.0016150474548339844
generate_one_block  0.0015420913696289062
generate_one_block  0.0019609928131103516
generate_one_block  0.0016772747039794922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010175704956054688
gen group dst list time:  9.274482727050781e-05
time for parepare:  0.0007479190826416016
local_output_nid generation:  8.726119995117188e-05
local_in_edges_tensor generation:  0.0003101825714111328
mini_batch_src_global generation:  0.0001685619354248047
r_  generation:  0.0016884803771972656
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.00026035308837890625
r_  generation:  0.0017733573913574219
local_output_nid generation:  8.821487426757812e-05
local_in_edges_tensor generation:  0.00023603439331054688
mini_batch_src_global generation:  0.0002684593200683594
r_  generation:  0.002471923828125
local_output_nid generation:  9.870529174804688e-05
local_in_edges_tensor generation:  0.0002586841583251953
mini_batch_src_global generation:  0.0002651214599609375
r_  generation:  0.002490520477294922
----------------------check_connections_block total spend ----------------------------- 0.013881683349609375
generate_one_block  0.003724336624145508
generate_one_block  0.003596782684326172
generate_one_block  0.0044345855712890625
generate_one_block  0.005091190338134766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.03584766387939453  GigaBytes
Max Memory Allocated: 0.2840700149536133  GigaBytes

connection checking time:  0.01694178581237793
block generation total time  0.023642301559448242
average batch blocks generation time:  0.0059105753898620605
block dataloader generation time/epoch 0.08526730537414551
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.03605461120605469  GigaBytes
Max Memory Allocated: 0.2840700149536133  GigaBytes

torch.Size([2882, 500])
torch.Size([726, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.18912172317504883  GigaBytes
Max Memory Allocated: 0.2840700149536133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.036405086517333984  GigaBytes
Max Memory Allocated: 0.2840700149536133  GigaBytes

torch.Size([3068, 500])
torch.Size([649, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.20033645629882812  GigaBytes
Max Memory Allocated: 0.2840700149536133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.03632068634033203  GigaBytes
Max Memory Allocated: 0.2840700149536133  GigaBytes

torch.Size([3011, 500])
torch.Size([779, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.27922964096069336  GigaBytes
Max Memory Allocated: 0.2967648506164551  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03777265548706055  GigaBytes
Max Memory Allocated: 0.2967648506164551  GigaBytes

torch.Size([3582, 500])
torch.Size([886, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2740182876586914  GigaBytes
Max Memory Allocated: 0.2967648506164551  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00495147705078125 |0.0009011626243591309 |0.12713885307312012 |0.00012868642807006836 |0.16416573524475098 |0.00669550895690918 |
----------------------------------------------------------pseudo_mini_loss sum 1.9492803812026978
Total (block generation + training)time/epoch 1.2896225452423096
Training time/epoch 1.2040646076202393
Training time without block to device /epoch 1.2004599571228027
Training time without total dataloading part /epoch 1.1724286079406738
load block tensor time/epoch 0.019805908203125
block to device time/epoch 0.0036046504974365234
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15940
Number of first layer input nodes during this epoch:  12543
