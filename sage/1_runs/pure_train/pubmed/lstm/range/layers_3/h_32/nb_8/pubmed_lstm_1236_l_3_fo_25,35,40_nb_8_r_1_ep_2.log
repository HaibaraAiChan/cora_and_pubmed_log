main start at this time 1648529412.874463
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019257068634033203
range selection method range initialization spend 9.417533874511719e-05
time for parepare:  4.482269287109375e-05
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0014765262603759766
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.504753112792969e-05
----------------------check_connections_block total spend ----------------------------- 0.002503633499145508
generate_one_block  0.001321554183959961
generate_one_block  0.00112152099609375
generate_one_block  0.0010712146759033203
generate_one_block  0.001056671142578125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011582374572753906
gen group dst list time:  3.600120544433594e-05
time for parepare:  0.00022721290588378906
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00043010711669921875
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00019884109497070312
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00031304359436035156
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0003228187561035156
----------------------check_connections_block total spend ----------------------------- 0.0026972293853759766
generate_one_block  0.001644134521484375
generate_one_block  0.0013396739959716797
generate_one_block  0.0014524459838867188
generate_one_block  0.0014390945434570312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009715557098388672
gen group dst list time:  7.295608520507812e-05
time for parepare:  0.0007541179656982422
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.0003192424774169922
mini_batch_src_global generation:  0.0001976490020751953
r_  generation:  0.0024085044860839844
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.00016355514526367188
r_  generation:  0.001010894775390625
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  0.0001609325408935547
r_  generation:  0.0018742084503173828
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.0004279613494873047
mini_batch_src_global generation:  0.00024175643920898438
r_  generation:  0.002103090286254883
----------------------check_connections_block total spend ----------------------------- 0.012230396270751953
generate_one_block  0.00426173210144043
generate_one_block  0.002087116241455078
generate_one_block  0.003223896026611328
generate_one_block  0.0035004615783691406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

connection checking time:  0.01492762565612793
block generation total time  0.01894855499267578
average batch blocks generation time:  0.004737138748168945
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014516830444335938  GigaBytes
Max Memory Allocated: 0.014516830444335938  GigaBytes

torch.Size([3642, 500])
torch.Size([870, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.24540424346923828  GigaBytes
Max Memory Allocated: 0.2604365348815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.01836252212524414  GigaBytes
Max Memory Allocated: 0.2604365348815918  GigaBytes

torch.Size([1617, 500])
torch.Size([458, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.10525131225585938  GigaBytes
Max Memory Allocated: 0.2604365348815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.022160053253173828  GigaBytes
Max Memory Allocated: 0.2604365348815918  GigaBytes

torch.Size([3275, 500])
torch.Size([715, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.19784927368164062  GigaBytes
Max Memory Allocated: 0.2604365348815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.020438194274902344  GigaBytes
Max Memory Allocated: 0.2604365348815918  GigaBytes

torch.Size([2713, 500])
torch.Size([682, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.22737360000610352  GigaBytes
Max Memory Allocated: 0.2604365348815918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005984902381896973 |0.08658027648925781 |0.2306218147277832 |0.0001633167266845703 |0.12275344133377075 |0.008756160736083984 |
----------------------------------------------------------pseudo_mini_loss sum 2.1436924934387207
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14327
Number of first layer input nodes during this epoch:  11247
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4783935546875 GB
    Memory Allocated: 0.03583335876464844  GigaBytes
Max Memory Allocated: 0.2604365348815918  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004951953887939453
range selection method range initialization spend 5.078315734863281e-05
time for parepare:  5.173683166503906e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.649162292480469e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001125335693359375Using backend: pytorch

mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  4.100799560546875e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.696846008300781e-05
----------------------check_connections_block total spend ----------------------------- 0.0011456012725830078
generate_one_block  0.0011706352233886719
generate_one_block  0.0010833740234375
generate_one_block  0.0011069774627685547
generate_one_block  0.001127481460571289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005459785461425781
gen group dst list time:  3.4809112548828125e-05
time for parepare:  0.00024771690368652344
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00029730796813964844
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00028228759765625
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0003485679626464844
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00039315223693847656
----------------------check_connections_block total spend ----------------------------- 0.0028717517852783203
generate_one_block  0.001485586166381836
generate_one_block  0.0014448165893554688
generate_one_block  0.0018236637115478516
generate_one_block  0.0015685558319091797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009577274322509766
gen group dst list time:  7.724761962890625e-05
time for parepare:  0.0007102489471435547
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.0003027915954589844
mini_batch_src_global generation:  0.0001804828643798828
r_  generation:  0.0016379356384277344
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.0015568733215332031
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  0.0002315044403076172
r_  generation:  0.002275228500366211
local_output_nid generation:  8.726119995117188e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  0.0002276897430419922
r_  generation:  0.002349853515625
----------------------check_connections_block total spend ----------------------------- 0.012832880020141602
generate_one_block  0.003398895263671875
generate_one_block  0.0029897689819335938
generate_one_block  0.003885984420776367
generate_one_block  0.0040187835693359375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4783935546875 GB
    Memory Allocated: 0.03583335876464844  GigaBytes
Max Memory Allocated: 0.2604365348815918  GigaBytes

connection checking time:  0.015704631805419922
block generation total time  0.02061605453491211
average batch blocks generation time:  0.005154013633728027
block dataloader generation time/epoch 0.06599617004394531
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4783935546875 GB
    Memory Allocated: 0.035924434661865234  GigaBytes
Max Memory Allocated: 0.2604365348815918  GigaBytes

torch.Size([2813, 500])
torch.Size([679, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4783935546875 GB
    Memory Allocated: 0.1823596954345703  GigaBytes
Max Memory Allocated: 0.2604365348815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4783935546875 GB
    Memory Allocated: 0.03573799133300781  GigaBytes
Max Memory Allocated: 0.2604365348815918  GigaBytes

torch.Size([2709, 500])
torch.Size([586, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4783935546875 GB
    Memory Allocated: 0.1814126968383789  GigaBytes
Max Memory Allocated: 0.2604365348815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4783935546875 GB
    Memory Allocated: 0.036150455474853516  GigaBytes
Max Memory Allocated: 0.2604365348815918  GigaBytes

torch.Size([2922, 500])
torch.Size([709, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.26226091384887695  GigaBytes
Max Memory Allocated: 0.2790961265563965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.03734445571899414  GigaBytes
Max Memory Allocated: 0.2790961265563965  GigaBytes

torch.Size([3520, 500])
torch.Size([840, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.2575869560241699  GigaBytes
Max Memory Allocated: 0.2790961265563965  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004919707775115967 |0.0007581114768981934 |0.1121833324432373 |0.00012725591659545898 |0.12670761346817017 |0.006563663482666016 |
----------------------------------------------------------pseudo_mini_loss sum 1.9324239492416382
Total (block generation + training)time/epoch 1.0594501495361328
Training time/epoch 0.9932200908660889
Training time without block to device /epoch 0.9901876449584961
Training time without total dataloading part /epoch 0.9626364707946777
load block tensor time/epoch 0.019678831100463867
block to device time/epoch 0.0030324459075927734
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15135
Number of first layer input nodes during this epoch:  11964
