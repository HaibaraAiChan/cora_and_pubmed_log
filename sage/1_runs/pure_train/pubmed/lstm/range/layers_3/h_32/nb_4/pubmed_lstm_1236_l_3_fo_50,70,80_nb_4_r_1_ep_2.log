main start at this time 1648529586.6389358
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.003702878952026367
range selection method range initialization spend 7.939338684082031e-05
time for parepare:  4.1961669921875e-05
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0011239051818847656
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  5.841255187988281e-05
----------------------check_connections_block total spend ----------------------------- 0.0017476081848144531
generate_one_block  0.001201629638671875
generate_one_block  0.00106048583984375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021080970764160156
gen group dst list time:  2.5033950805664062e-05
time for parepare:  0.00025653839111328125
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0006639957427978516
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  9.608268737792969e-05
r_  generation:  0.0006136894226074219
----------------------check_connections_block total spend ----------------------------- 0.002398252487182617
generate_one_block  0.0018150806427001953
generate_one_block  0.0017588138580322266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010495185852050781
gen group dst list time:  5.91278076171875e-05
time for parepare:  0.0007050037384033203
local_output_nid generation:  9.250640869140625e-05
local_in_edges_tensor generation:  0.00039267539978027344
mini_batch_src_global generation:  0.00028252601623535156
r_  generation:  0.003580808639526367
local_output_nid generation:  0.000102996826171875
local_in_edges_tensor generation:  0.00029087066650390625
mini_batch_src_global generation:  0.0005512237548828125
r_  generation:  0.004241466522216797
----------------------check_connections_block total spend ----------------------------- 0.012387990951538086
generate_one_block  0.006033420562744141
generate_one_block  0.006626605987548828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0076618194580078125  GigaBytes
Max Memory Allocated: 0.0076618194580078125  GigaBytes

connection checking time:  0.014786243438720703
block generation total time  0.01623392105102539
average batch blocks generation time:  0.008116960525512695
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.01738452911376953  GigaBytes
Max Memory Allocated: 0.01738452911376953  GigaBytes

torch.Size([5157, 500])
torch.Size([1431, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.40311431884765625  GigaBytes
Max Memory Allocated: 0.42863893508911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.026638031005859375  GigaBytes
Max Memory Allocated: 0.42863893508911133  GigaBytes

torch.Size([6002, 500])
torch.Size([1450, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.4861030578613281  GigaBytes
Max Memory Allocated: 0.5158743858337402  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0051032304763793945 |0.17078065872192383 |0.4745512008666992 |0.00018358230590820312 |0.3103214502334595 |0.008046865463256836 |
----------------------------------------------------------pseudo_mini_loss sum 2.0116443634033203
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14395
Number of first layer input nodes during this epoch:  11159
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.04302549362182617  GigaBytes
Max Memory Allocated: 0.5158743858337402  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000499725341796875
range selection method range initialization spend 4.935264587402344e-05
time for parepare:  4.696846008300781e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  5.9604644775390625e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.198883056640625e-05
----------------------check_connections_block total spend ----------------------------- 0.0006659030914306641
generate_one_block  0.0011506080627441406
generate_one_block  0.0010988712310791016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005419254302978516
gen group dst list time:  2.6702880859375e-05
time for parepare:  0.0002665519714355469
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0005245208740234375
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.0007059574127197266
----------------------check_connections_block total spend ----------------------------- 0.0023903846740722656
generate_one_block  0.0019626617431640625
generate_one_block  0.0019752979278564453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010406970977783203
gen group dst list time:  7.2479248046875e-05
time for parepare:  0.0007097721099853516
local_output_nid generation:  0.00012230873107910156
local_in_edges_tensor generation:  0.00038909912109375
mini_batch_src_global generation:  0.00030231475830078125
r_  generation:  0.0032777786254882812
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.0003142356872558594
mini_batch_src_global generation:  0.0005974769592285156
r_  generation:  0.0046007633209228516
----------------------check_connections_block total spend ----------------------------- 0.012728452682495117
generate_one_block  0.0059473514556884766
generate_one_block  0.007491350173950195
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.04302549362182617  GigaBytes
Max Memory Allocated: 0.5158743858337402  GigaBytes

connection checking time:  0.015118837356567383
block generation total time  0.01737666130065918
average batch blocks generation time:  0.00868833065032959
block dataloader generation time/epoch 0.058098793029785156
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.04184246063232422  GigaBytes
Max Memory Allocated: 0.5158743858337402  GigaBytes
Using backend: pytorch

torch.Size([5474, 500])
torch.Size([1341, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.386721134185791  GigaBytes
Max Memory Allocated: 0.5158743858337402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.04286813735961914  GigaBytes
Max Memory Allocated: 0.5158743858337402  GigaBytes

torch.Size([5703, 500])
torch.Size([1579, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5277132987976074  GigaBytes
Max Memory Allocated: 0.5588774681091309  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0047882795333862305 |0.0014339685440063477 |0.2393026351928711 |0.00014150142669677734 |0.32853472232818604 |0.006088972091674805 |
----------------------------------------------------------pseudo_mini_loss sum 2.232343912124634
Total (block generation + training)time/epoch 1.2202332019805908
Training time/epoch 1.1619477272033691
Training time without block to device /epoch 1.1590797901153564
Training time without total dataloading part /epoch 1.1420466899871826
load block tensor time/epoch 0.009576559066772461
block to device time/epoch 0.0028679370880126953
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14454
Number of first layer input nodes during this epoch:  11177
