main start at this time 1648530329.2491336
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014615058898925781
range selection method range initialization spend 8.535385131835938e-05
time for parepare:  4.57763671875e-05
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.001150369644165039
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.5497207641601562e-05
----------------------check_connections_block total spend ----------------------------- 0.004024028778076172
generate_one_block  0.0011715888977050781
generate_one_block  0.0010466575622558594
generate_one_block  0.0010552406311035156
generate_one_block  0.0010311603546142578
generate_one_block  0.0010466575622558594
generate_one_block  0.0010385513305664062
generate_one_block  0.001043558120727539
generate_one_block  0.0010745525360107422
generate_one_block  0.0010364055633544922
generate_one_block  0.001033782958984375
generate_one_block  0.0010411739349365234
generate_one_block  0.0010294914245605469
generate_one_block  0.001020193099975586
generate_one_block  0.0010399818420410156
generate_one_block  0.0010271072387695312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009815692901611328
gen group dst list time:  8.058547973632812e-05
time for parepare:  0.00026488304138183594
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.322166442871094e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.985664367675781e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.000194549560546875
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  7.724761962890625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00011563301086425781
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001819133758544922
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0001537799835205078
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00018739700317382812
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.000133514404296875
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.413459777832031e-05
----------------------check_connections_block total spend ----------------------------- 0.004862070083618164
generate_one_block  0.001135110855102539
generate_one_block  0.0011208057403564453
generate_one_block  0.0012907981872558594
generate_one_block  0.0011208057403564453
generate_one_block  0.0011608600616455078
generate_one_block  0.0012764930725097656
generate_one_block  0.0011394023895263672
generate_one_block  0.0010967254638671875
generate_one_block  0.0012514591217041016
generate_one_block  0.0010180473327636719
generate_one_block  0.001168966293334961
generate_one_block  0.0011131763458251953
generate_one_block  0.0010333061218261719
generate_one_block  0.0010094642639160156
generate_one_block  0.0010504722595214844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011637210845947266
gen group dst list time:  0.00013017654418945312
time for parepare:  0.0007948875427246094
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0002658367156982422
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0003261566162109375
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0003361701965332031
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0012526512145996094
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  0.00010800361633300781
r_  generation:  0.0006585121154785156
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0006635189056396484
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.0012438297271728516
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0002448558807373047
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0003190040588378906
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  8.177757263183594e-05
r_  generation:  0.0008692741394042969
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00033473968505859375
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0010275840759277344
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.000885009765625
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.00038623809814453125
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.00035953521728515625
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0002582073211669922
----------------------check_connections_block total spend ----------------------------- 0.016518354415893555
generate_one_block  0.0014913082122802734
generate_one_block  0.0013475418090820312
generate_one_block  0.0023796558380126953
generate_one_block  0.001775503158569336
generate_one_block  0.0016925334930419922
generate_one_block  0.002432584762573242
generate_one_block  0.001226186752319336
generate_one_block  0.0012881755828857422
generate_one_block  0.001901865005493164
generate_one_block  0.0013165473937988281
generate_one_block  0.002130746841430664
generate_one_block  0.0019664764404296875
generate_one_block  0.0013153553009033203
generate_one_block  0.001619100570678711
generate_one_block  0.001218557357788086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

connection checking time:  0.02138042449951172
block generation total time  0.04208803176879883
average batch blocks generation time:  0.0028058687845865884
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.014086723327636719  GigaBytes
Max Memory Allocated: 0.014086723327636719  GigaBytes

torch.Size([661, 500])
torch.Size([126, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2381591796875 GB
    Memory Allocated: 0.04408836364746094  GigaBytes
Max Memory Allocated: 0.04412984848022461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.026873111724853516  GigaBytes
Max Memory Allocated: 0.0606236457824707  GigaBytes

torch.Size([632, 500])
torch.Size([132, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.057630062103271484  GigaBytes
Max Memory Allocated: 0.0606236457824707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.028503894805908203  GigaBytes
Max Memory Allocated: 0.06997156143188477  GigaBytes

torch.Size([1493, 500])
torch.Size([352, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.15651845932006836  GigaBytes
Max Memory Allocated: 0.15842580795288086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.029428958892822266  GigaBytes
Max Memory Allocated: 0.1603717803955078  GigaBytes

torch.Size([1523, 500])
torch.Size([167, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.09154462814331055  GigaBytes
Max Memory Allocated: 0.1603717803955078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.027985572814941406  GigaBytes
Max Memory Allocated: 0.1603717803955078  GigaBytes

torch.Size([1224, 500])
torch.Size([173, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.0926370620727539  GigaBytes
Max Memory Allocated: 0.1603717803955078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.028118133544921875  GigaBytes
Max Memory Allocated: 0.1603717803955078  GigaBytes

torch.Size([1286, 500])
torch.Size([328, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.15792417526245117  GigaBytes
Max Memory Allocated: 0.1603717803955078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.026581764221191406  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

torch.Size([477, 500])
torch.Size([111, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.04828834533691406  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.026926517486572266  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

torch.Size([537, 500])
torch.Size([103, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.056639671325683594  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.028439998626708984  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

torch.Size([1466, 500])
torch.Size([378, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.11146831512451172  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.026668548583984375  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

torch.Size([522, 500])
torch.Size([127, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.056856632232666016  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.02944040298461914  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

torch.Size([1566, 500])
torch.Size([397, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13201522827148438  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.028247356414794922  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

torch.Size([1362, 500])
torch.Size([328, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.11510324478149414  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.026927471160888672  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

torch.Size([539, 500])
torch.Size([149, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.05757713317871094  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.026877880096435547  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

torch.Size([634, 500])
torch.Size([103, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.06048870086669922  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.0265045166015625  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

torch.Size([435, 500])
torch.Size([129, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.04938650131225586  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002503776550292969 |0.023613103230794272 |0.10898365974426269 |0.00011909802754720053 |0.09147879282633463 |0.007656097412109375 |
----------------------------------------------------------pseudo_mini_loss sum 2.2280845642089844
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17817
Number of first layer input nodes during this epoch:  14357
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.05219745635986328  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005021095275878906
range selection method range initialization spend 5.245208740234375e-05
time for parepare:  5.5789947509765625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.4781951904296875e-05
----------------------check_connections_block total spend ----------------------------- 0.0027616024017333984
generate_one_block  0.0011255741119384766
generate_one_block  0.0010671615600585938
generate_one_block  0.0010738372802734375
generate_one_block  0.0010581016540527344
generate_one_block  0.0010385513305664062
generate_one_block  0.0010845661163330078
generate_one_block  0.0010411739349365234
generate_one_block  0.001176595687866211
generate_one_block  0.0010652542114257812
generate_one_block  0.001056671142578125
generate_one_block  0.0010478496551513672
generate_one_block  0.0010454654693603516
generate_one_block  0.0010783672332763672
generate_one_block  0.0010273456573486328
generate_one_block  0.0010221004486083984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006070137023925781
gen group dst list time:  8.058547973632812e-05
time for parepare:  0.00027441978454589844
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.079673767089844e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00018715858459472656
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.000209808349609375
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  9.107589721679688e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0001952648162841797
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00017905235290527344
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  6.127357482910156e-05
----------------------check_connections_block total spend ----------------------------- 0.0048444271087646484
generate_one_block  0.0011878013610839844
generate_one_block  0.001104116439819336
generate_one_block  0.0013308525085449219
generate_one_block  0.001140594482421875
generate_one_block  0.001394510269165039
generate_one_block  0.0011897087097167969
generate_one_block  0.0010788440704345703
generate_one_block  0.001271963119506836
generate_one_block  0.0011017322540283203
generate_one_block  0.0010175704956054688
generate_one_block  0.001085042953491211
generate_one_block  0.0010783672332763672
generate_one_block  0.0012576580047607422
generate_one_block  0.0010843276977539062
generate_one_block  0.0010561943054199219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011835098266601562
gen group dst list time:  0.00013399124145507812
time for parepare:  0.0008769035339355469
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00027871131896972656
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0003311634063720703
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.00041174888610839844
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  0.0001354217529296875
r_  generation:  0.0010938644409179688
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0002734661102294922
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.0015993118286132812
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0004673004150390625
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0003230571746826172
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  0.00013136863708496094
r_  generation:  0.0014073848724365234
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.00042557716369628906
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00020241737365722656
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0003504753112792969
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002124309539794922
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  9.489059448242188e-05
r_  generation:  0.0009849071502685547
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.00042939186096191406
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00041484832763671875
----------------------check_connections_block total spend ----------------------------- 0.016677141189575195
generate_one_block  0.0015530586242675781
generate_one_block  0.0017652511596679688
generate_one_block  0.0024068355560302734
generate_one_block  0.0013041496276855469
generate_one_block  0.003259897232055664
generate_one_block  0.0015473365783691406
generate_one_block  0.0014445781707763672
generate_one_block  0.0027921199798583984
generate_one_block  0.0015864372253417969
generate_one_block  0.001238107681274414
generate_one_block  0.001425027847290039
generate_one_block  0.0012946128845214844
generate_one_block  0.002178668975830078
generate_one_block  0.0028128623962402344
generate_one_block  0.0017158985137939453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.05219745635986328  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

connection checking time:  0.021521568298339844
block generation total time  0.04570412635803223
average batch blocks generation time:  0.0030469417572021483
block dataloader generation time/epoch 0.1392514705657959
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.05232381820678711  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

torch.Size([510, 500])
torch.Size([124, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.08527851104736328  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.052659034729003906  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

torch.Size([688, 500])
torch.Size([135, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.09350347518920898  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.05482959747314453  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

torch.Size([1844, 500])
torch.Size([444, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.16134405136108398  GigaBytes
Max Memory Allocated: 0.1617908477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.05217933654785156  GigaBytes
Max Memory Allocated: 0.1651926040649414  GigaBytes

torch.Size([433, 500])
torch.Size([129, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.07596111297607422  GigaBytes
Max Memory Allocated: 0.1651926040649414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.05613279342651367  GigaBytes
Max Memory Allocated: 0.1651926040649414  GigaBytes

torch.Size([2533, 500])
torch.Size([422, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.23397445678710938  GigaBytes
Max Memory Allocated: 0.23779535293579102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.052876949310302734  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

torch.Size([805, 500])
torch.Size([170, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.0953679084777832  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.05260515213012695  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

torch.Size([556, 500])
torch.Size([86, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.0836787223815918  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.05480241775512695  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

torch.Size([1777, 500])
torch.Size([420, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.20129632949829102  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.05271768569946289  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

torch.Size([720, 500])
torch.Size([118, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.09084892272949219  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.05202817916870117  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

torch.Size([353, 500])
torch.Size([61, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.06966447830200195  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.052350521087646484  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

torch.Size([524, 500])
torch.Size([189, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.0862126350402832  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.052233219146728516  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

torch.Size([463, 500])
torch.Size([99, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.07235956192016602  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.054789066314697266  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

torch.Size([1539, 500])
torch.Size([399, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.1500091552734375  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.05265235900878906  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

torch.Size([685, 500])
torch.Size([189, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.09242105484008789  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.053093910217285156  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

torch.Size([922, 500])
torch.Size([121, 256])Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.09197759628295898  GigaBytes
Max Memory Allocated: 0.23783349990844727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0032090187072753907 |0.0009155909220377605 |0.07693985303243002 |0.00012024243672688802 |0.09239892959594727 |0.006253719329833984 |
----------------------------------------------------------pseudo_mini_loss sum 4.7807512283325195
Total (block generation + training)time/epoch 2.776244640350342
Training time/epoch 2.6367547512054443
Training time without block to device /epoch 2.623020887374878
Training time without total dataloading part /epoch 2.5481390953063965
load block tensor time/epoch 0.04813528060913086
block to device time/epoch 0.013733863830566406
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17815
Number of first layer input nodes during this epoch:  14352
