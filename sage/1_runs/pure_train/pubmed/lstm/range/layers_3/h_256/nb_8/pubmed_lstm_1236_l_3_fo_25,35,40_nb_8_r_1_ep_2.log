main start at this time 1648530180.088203
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002500295639038086
range selection method range initialization spend 8.511543273925781e-05
time for parepare:  4.2438507080078125e-05
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.0011477470397949219
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.5299530029296875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.9087066650390625e-05
----------------------check_connections_block total spend ----------------------------- 0.002137422561645508
generate_one_block  0.001161813735961914
generate_one_block  0.0011010169982910156
generate_one_block  0.0010356903076171875
generate_one_block  0.001016855239868164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012812614440917969
gen group dst list time:  3.695487976074219e-05
time for parepare:  0.00023055076599121094
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.0002865791320800781
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0003554821014404297
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0003895759582519531
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00024127960205078125
----------------------check_connections_block total spend ----------------------------- 0.0026760101318359375
generate_one_block  0.0013957023620605469
generate_one_block  0.0014498233795166016
generate_one_block  0.0015072822570800781
generate_one_block  0.0013089179992675781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010592937469482422
gen group dst list time:  7.295608520507812e-05
time for parepare:  0.0007548332214355469
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.0002894401550292969
mini_batch_src_global generation:  0.00014901161193847656
r_  generation:  0.0016736984252929688
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.00022602081298828125
mini_batch_src_global generation:  0.0002548694610595703
r_  generation:  0.002355337142944336
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  0.0002162456512451172
r_  generation:  0.0021185874938964844
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.0004172325134277344
mini_batch_src_global generation:  0.00015425682067871094
r_  generation:  0.001302480697631836
----------------------check_connections_block total spend ----------------------------- 0.012175559997558594
generate_one_block  0.003293752670288086
generate_one_block  0.003880739212036133
generate_one_block  0.0035452842712402344
generate_one_block  0.002505779266357422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

connection checking time:  0.014851570129394531
block generation total time  0.01888728141784668
average batch blocks generation time:  0.00472182035446167
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.01788330078125  GigaBytes
Max Memory Allocated: 0.01788330078125  GigaBytes

torch.Size([2678, 500])
torch.Size([613, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.19703292846679688  GigaBytes
Max Memory Allocated: 0.1971440315246582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.033390045166015625  GigaBytes
Max Memory Allocated: 0.20130681991577148  GigaBytes

torch.Size([3325, 500])
torch.Size([703, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.2891120910644531  GigaBytes
Max Memory Allocated: 0.2904319763183594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.03252410888671875  GigaBytes
Max Memory Allocated: 0.2929062843322754  GigaBytes

torch.Size([3347, 500])
torch.Size([911, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5506591796875 GB
    Memory Allocated: 0.2529792785644531  GigaBytes
Max Memory Allocated: 0.2929062843322754  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5545654296875 GB
    Memory Allocated: 0.030200481414794922  GigaBytes
Max Memory Allocated: 0.2929062843322754  GigaBytes

torch.Size([2113, 500])
torch.Size([593, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5545654296875 GB
    Memory Allocated: 0.1631932258605957  GigaBytes
Max Memory Allocated: 0.2929062843322754  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012917399406433105 |0.0865136981010437 |0.22780495882034302 |0.0001431107521057129 |0.13918298482894897 |0.008053302764892578 |
----------------------------------------------------------pseudo_mini_loss sum 2.540743589401245
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14640
Number of first layer input nodes during this epoch:  11463
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5545654296875 GB
    Memory Allocated: 0.05662202835083008  GigaBytes
Max Memory Allocated: 0.2929062843322754  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004894733428955078
range selection method range initialization spend 5.054473876953125e-05
time for parepare:  5.14984130859375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  5.364418029785156e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011110305786132812Using backend: pytorch

mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.600120544433594e-05
----------------------check_connections_block total spend ----------------------------- 0.0011322498321533203
generate_one_block  0.0011849403381347656
generate_one_block  0.0011098384857177734
generate_one_block  0.0010380744934082031
generate_one_block  0.0010557174682617188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005309581756591797
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.00023412704467773438
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00034332275390625
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0004596710205078125
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00018858909606933594
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00029015541076660156
----------------------check_connections_block total spend ----------------------------- 0.0027654170989990234
generate_one_block  0.0014870166778564453
generate_one_block  0.0016400814056396484
generate_one_block  0.00154876708984375
generate_one_block  0.0013949871063232422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009169578552246094
gen group dst list time:  7.414817810058594e-05
time for parepare:  0.0006809234619140625
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.0003037452697753906
mini_batch_src_global generation:  0.00015020370483398438
r_  generation:  0.001708984375
local_output_nid generation:  8.606910705566406e-05
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  0.00036334991455078125
r_  generation:  0.0028429031372070312
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  0.0001468658447265625
r_  generation:  0.0010027885437011719
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.0002238750457763672
mini_batch_src_global generation:  0.0001544952392578125
r_  generation:  0.0016753673553466797
----------------------check_connections_block total spend ----------------------------- 0.01194000244140625
generate_one_block  0.0033767223358154297
generate_one_block  0.004843235015869141
generate_one_block  0.0021805763244628906
generate_one_block  0.0031614303588867188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5545654296875 GB
    Memory Allocated: 0.05662202835083008  GigaBytes
Max Memory Allocated: 0.2929062843322754  GigaBytes

connection checking time:  0.014705419540405273
block generation total time  0.019632816314697266
average batch blocks generation time:  0.004908204078674316
block dataloader generation time/epoch 0.06602358818054199
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5545654296875 GB
    Memory Allocated: 0.05798196792602539  GigaBytes
Max Memory Allocated: 0.2929062843322754  GigaBytes

torch.Size([2864, 500])
torch.Size([726, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5545654296875 GB
    Memory Allocated: 0.23157644271850586  GigaBytes
Max Memory Allocated: 0.2929062843322754  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5545654296875 GB
    Memory Allocated: 0.0595393180847168  GigaBytes
Max Memory Allocated: 0.2929062843322754  GigaBytes

torch.Size([3679, 500])
torch.Size([940, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3744034767150879  GigaBytes
Max Memory Allocated: 0.37472057342529297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.056244850158691406  GigaBytes
Max Memory Allocated: 0.3781900405883789  GigaBytes

torch.Size([1666, 500])
torch.Size([408, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.15290069580078125  GigaBytes
Max Memory Allocated: 0.3781900405883789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.05813932418823242  GigaBytes
Max Memory Allocated: 0.3781900405883789  GigaBytes

torch.Size([2949, 500])
torch.Size([682, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.22701406478881836  GigaBytes
Max Memory Allocated: 0.3781900405883789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00366973876953125 |0.0007907748222351074 |0.11014097929000854 |0.00011926889419555664 |0.13910949230194092 |0.006555080413818359 |
----------------------------------------------------------pseudo_mini_loss sum 3.5596446990966797
Total (block generation + training)time/epoch 1.095893383026123
Training time/epoch 1.0296006202697754
Training time without block to device /epoch 1.026437520980835
Training time without total dataloading part /epoch 1.0040340423583984
load block tensor time/epoch 0.014678955078125
block to device time/epoch 0.0031630992889404297
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14271
Number of first layer input nodes during this epoch:  11158
