main start at this time 1648530368.0745726
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012156963348388672
range selection method range initialization spend 8.082389831542969e-05
time for parepare:  5.412101745605469e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0013167858123779297
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.2901763916015625e-05
----------------------check_connections_block total spend ----------------------------- 0.0024831295013427734
generate_one_block  0.001434326171875
generate_one_block  0.0013742446899414062
generate_one_block  0.0013010501861572266
generate_one_block  0.001260995864868164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008530616760253906
gen group dst list time:  4.220008850097656e-05
time for parepare:  0.00030922889709472656
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.00035643577575683594
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.000457763671875
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0004889965057373047
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.00031113624572753906
----------------------check_connections_block total spend ----------------------------- 0.003412961959838867
generate_one_block  0.00177001953125
generate_one_block  0.0018465518951416016
generate_one_block  0.001912832260131836
generate_one_block  0.0016434192657470703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0013306140899658203
gen group dst list time:  9.918212890625e-05
time for parepare:  0.0009922981262207031
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.0003478527069091797
mini_batch_src_global generation:  0.00024700164794921875
r_  generation:  0.0026094913482666016
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00029778480529785156
mini_batch_src_global generation:  0.0004572868347167969
r_  generation:  0.003804922103881836
local_output_nid generation:  9.965896606445312e-05
local_in_edges_tensor generation:  0.00029969215393066406
mini_batch_src_global generation:  0.0003323554992675781
r_  generation:  0.0032231807708740234
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.0004508495330810547
mini_batch_src_global generation:  0.00019812583923339844
r_  generation:  0.0015327930450439453
----------------------check_connections_block total spend ----------------------------- 0.017922639846801758
generate_one_block  0.0037381649017333984
generate_one_block  0.004939556121826172
generate_one_block  0.004064798355102539
generate_one_block  0.0028150081634521484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

connection checking time:  0.021335601806640625
block generation total time  0.022730350494384766
average batch blocks generation time:  0.005682587623596191
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.018488407135009766  GigaBytes
Max Memory Allocated: 0.018488407135009766  GigaBytes

torch.Size([2997, 500])
torch.Size([643, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.24058866500854492  GigaBytes
Max Memory Allocated: 0.24069976806640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.03398323059082031  GigaBytes
Max Memory Allocated: 0.24487590789794922  GigaBytes

torch.Size([4405, 500])
torch.Size([774, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5975341796875 GB
    Memory Allocated: 0.37044382095336914  GigaBytes
Max Memory Allocated: 0.37398481369018555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03285026550292969  GigaBytes
Max Memory Allocated: 0.3742380142211914  GigaBytes

torch.Size([3807, 500])
torch.Size([994, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3006720542907715  GigaBytes
Max Memory Allocated: 0.3742380142211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03023529052734375  GigaBytes
Max Memory Allocated: 0.3742380142211914  GigaBytes

torch.Size([2419, 500])
torch.Size([630, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1862783432006836  GigaBytes
Max Memory Allocated: 0.3742380142211914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004025101661682129 |0.08609014749526978 |0.3159608840942383 |0.00015294551849365234 |0.28505486249923706 |0.007805824279785156 |
----------------------------------------------------------pseudo_mini_loss sum 2.5657739639282227
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17026
Number of first layer input nodes during this epoch:  13628
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.05597114562988281  GigaBytes
Max Memory Allocated: 0.3742380142211914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006012916564941406
range selection method range initialization spend 6.29425048828125e-05
time for parepare:  6.318092346191406e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013065338134765625
Using backend: pytorch
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  6.103515625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.100799560546875e-05
----------------------check_connections_block total spend ----------------------------- 0.0013320446014404297
generate_one_block  0.0014910697937011719
generate_one_block  0.0013680458068847656
generate_one_block  0.0013136863708496094
generate_one_block  0.001333475112915039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006520748138427734
gen group dst list time:  4.315376281738281e-05
time for parepare:  0.0003407001495361328
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00023436546325683594
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.00043702125549316406
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0006113052368164062
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0002377033233642578
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00015783309936523438
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004057884216308594
----------------------check_connections_block total spend ----------------------------- 0.0036716461181640625
generate_one_block  0.0020089149475097656
generate_one_block  0.002209186553955078
generate_one_block  0.001975536346435547
generate_one_block  0.0018453598022460938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012772083282470703
gen group dst list time:  0.00011014938354492188
time for parepare:  0.0009775161743164062
local_output_nid generation:  0.00011324882507324219
local_in_edges_tensor generation:  0.0003745555877685547
mini_batch_src_global generation:  0.00024437904357910156
r_  generation:  0.0026438236236572266
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.00031876564025878906
mini_batch_src_global generation:  0.0006122589111328125
r_  generation:  0.004556417465209961
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00022530555725097656
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.0014066696166992188
local_output_nid generation:  9.679794311523438e-05
local_in_edges_tensor generation:  0.0002684593200683594
mini_batch_src_global generation:  0.00021958351135253906
r_  generation:  0.0019092559814453125
----------------------check_connections_block total spend ----------------------------- 0.01753377914428711
generate_one_block  0.0040662288665771484
generate_one_block  0.005757808685302734
generate_one_block  0.0024178028106689453
generate_one_block  0.0035467147827148438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.05597114562988281  GigaBytes
Max Memory Allocated: 0.3742380142211914  GigaBytes

connection checking time:  0.021205425262451172
block generation total time  0.023827552795410156
average batch blocks generation time:  0.005956888198852539
block dataloader generation time/epoch 0.09494209289550781
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.05764007568359375  GigaBytes
Max Memory Allocated: 0.3742380142211914  GigaBytes

torch.Size([3337, 500])
torch.Size([786, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.27464866638183594  GigaBytes
Max Memory Allocated: 0.3742380142211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.059940338134765625  GigaBytes
Max Memory Allocated: 0.3742380142211914  GigaBytes

torch.Size([4545, 500])
torch.Size([1005, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.46018123626708984  GigaBytes
Max Memory Allocated: 0.4609184265136719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.05498027801513672  GigaBytes
Max Memory Allocated: 0.46396780014038086  GigaBytes

torch.Size([1925, 500])
torch.Size([409, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.16442489624023438  GigaBytes
Max Memory Allocated: 0.46396780014038086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.057587623596191406  GigaBytes
Max Memory Allocated: 0.46396780014038086  GigaBytes

torch.Size([3312, 500])
torch.Size([747, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.2518124580383301  GigaBytes
Max Memory Allocated: 0.46396780014038086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006901443004608154 |0.0009899139404296875 |0.18795406818389893 |0.00014132261276245117 |0.2802056670188904 |0.006731510162353516 |
----------------------------------------------------------pseudo_mini_loss sum 3.5273358821868896
Total (block generation + training)time/epoch 2.016940116882324
Training time/epoch 1.921802043914795
Training time without block to device /epoch 1.9178423881530762
Training time without total dataloading part /epoch 1.8799357414245605
load block tensor time/epoch 0.027605772018432617
block to device time/epoch 0.00395965576171875
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16423
Number of first layer input nodes during this epoch:  13119
