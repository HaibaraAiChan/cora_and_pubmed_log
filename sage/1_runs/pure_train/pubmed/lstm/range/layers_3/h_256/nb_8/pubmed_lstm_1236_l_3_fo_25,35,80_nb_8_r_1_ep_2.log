main start at this time 1648530241.6963828
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.003527402877807617
range selection method range initialization spend 7.009506225585938e-05
time for parepare:  4.506111145019531e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.0010294914245605469
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.5299530029296875e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.218650817871094e-05
----------------------check_connections_block total spend ----------------------------- 0.0020046234130859375
generate_one_block  0.001171112060546875
generate_one_block  0.0011081695556640625
generate_one_block  0.0010693073272705078
generate_one_block  0.0010066032409667969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017638206481933594
gen group dst list time:  3.62396240234375e-05
time for parepare:  0.00022792816162109375
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00028514862060546875
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.00035762786865234375
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0003933906555175781
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0002377033233642578
----------------------check_connections_block total spend ----------------------------- 0.0027017593383789062
generate_one_block  0.0014166831970214844
generate_one_block  0.0014584064483642578
generate_one_block  0.001497030258178711
generate_one_block  0.0013110637664794922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009810924530029297
gen group dst list time:  6.67572021484375e-05
time for parepare:  0.0007545948028564453
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00029397010803222656
mini_batch_src_global generation:  0.00014448165893554688
r_  generation:  0.0016372203826904297
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.0002224445343017578
mini_batch_src_global generation:  0.0002994537353515625
r_  generation:  0.0023179054260253906
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  0.00020933151245117188
r_  generation:  0.0020918846130371094
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00040149688720703125
mini_batch_src_global generation:  0.0001533031463623047
r_  generation:  0.0013117790222167969
----------------------check_connections_block total spend ----------------------------- 0.012138605117797852
generate_one_block  0.003251791000366211
generate_one_block  0.003887653350830078
generate_one_block  0.003488302230834961
generate_one_block  0.0025072097778320312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0408935546875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.012844085693359375  GigaBytes

connection checking time:  0.014840364456176758
block generation total time  0.018818140029907227
average batch blocks generation time:  0.004704535007476807
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.01781749725341797  GigaBytes
Max Memory Allocated: 0.01781749725341797  GigaBytes

torch.Size([2643, 500])
torch.Size([610, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.1944417953491211  GigaBytes
Max Memory Allocated: 0.19455289840698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.033455848693847656  GigaBytes
Max Memory Allocated: 0.19871854782104492  GigaBytes

torch.Size([3357, 500])
torch.Size([700, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.2899608612060547  GigaBytes
Max Memory Allocated: 0.2917470932006836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.03242635726928711  GigaBytes
Max Memory Allocated: 0.29375505447387695  GigaBytes

torch.Size([3295, 500])
torch.Size([912, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.2502250671386719  GigaBytes
Max Memory Allocated: 0.29375505447387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.030233383178710938  GigaBytes
Max Memory Allocated: 0.29375505447387695  GigaBytes

torch.Size([2130, 500])
torch.Size([594, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.16438865661621094  GigaBytes
Max Memory Allocated: 0.29375505447387695  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0031041502952575684 |0.08745080232620239 |0.22743874788284302 |0.00015729665756225586 |0.13909083604812622 |0.007962226867675781 |
----------------------------------------------------------pseudo_mini_loss sum 2.559253215789795
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14598
Number of first layer input nodes during this epoch:  11425
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.05662393569946289  GigaBytes
Max Memory Allocated: 0.29375505447387695  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005693435668945312
range selection method range initialization spend 5.841255187988281e-05
time for parepare:  6.175041198730469e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00014543533325195312Using backend: pytorch

mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  6.437301635742188e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.1484832763671875e-05
----------------------check_connections_block total spend ----------------------------- 0.0013408660888671875
generate_one_block  0.0013811588287353516
generate_one_block  0.0013163089752197266
generate_one_block  0.0012958049774169922
generate_one_block  0.0012924671173095703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006339550018310547
gen group dst list time:  4.482269287109375e-05
time for parepare:  0.0003006458282470703
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0002460479736328125
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.00041961669921875
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0005664825439453125
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.00023555755615234375
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0003535747528076172
----------------------check_connections_block total spend ----------------------------- 0.003438234329223633
generate_one_block  0.001847982406616211
generate_one_block  0.00203704833984375
generate_one_block  0.0018999576568603516
generate_one_block  0.0017292499542236328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011529922485351562
gen group dst list time:  9.703636169433594e-05
time for parepare:  0.0008466243743896484
local_output_nid generation:  9.465217590332031e-05
local_in_edges_tensor generation:  0.00035452842712402344
mini_batch_src_global generation:  0.00023508071899414062
r_  generation:  0.0021195411682128906
local_output_nid generation:  0.0001068115234375
local_in_edges_tensor generation:  0.00029921531677246094
mini_batch_src_global generation:  0.0004570484161376953
r_  generation:  0.0035295486450195312
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  0.00018310546875
r_  generation:  0.0012536048889160156
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.00026416778564453125
mini_batch_src_global generation:  0.00019502639770507812
r_  generation:  0.002076387405395508
----------------------check_connections_block total spend ----------------------------- 0.014940500259399414
generate_one_block  0.003411531448364258
generate_one_block  0.0047206878662109375
generate_one_block  0.002163410186767578
generate_one_block  0.0031235218048095703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.05662393569946289  GigaBytes
Max Memory Allocated: 0.29375505447387695  GigaBytes

connection checking time:  0.018378734588623047
block generation total time  0.02093338966369629
average batch blocks generation time:  0.005233347415924072
block dataloader generation time/epoch 0.07261276245117188
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.057951927185058594  GigaBytes
Max Memory Allocated: 0.29375505447387695  GigaBytes

torch.Size([2865, 500])
torch.Size([726, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.23151636123657227  GigaBytes
Max Memory Allocated: 0.29375505447387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.05945396423339844  GigaBytes
Max Memory Allocated: 0.29375505447387695  GigaBytes

torch.Size([3651, 500])
torch.Size([921, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.37129831314086914  GigaBytes
Max Memory Allocated: 0.3715801239013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.05626344680786133  GigaBytes
Max Memory Allocated: 0.37508487701416016  GigaBytes

torch.Size([1667, 500])
torch.Size([408, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.15291929244995117  GigaBytes
Max Memory Allocated: 0.37508487701416016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.05812788009643555  GigaBytes
Max Memory Allocated: 0.37508487701416016  GigaBytes

torch.Size([2960, 500])
torch.Size([682, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.22604131698608398  GigaBytes
Max Memory Allocated: 0.37508487701416016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0036745667457580566 |0.0008113384246826172 |0.11095857620239258 |0.00012940168380737305 |0.13867586851119995 |0.006421327590942383 |
----------------------------------------------------------pseudo_mini_loss sum 3.8091635704040527
Total (block generation + training)time/epoch 1.104050636291504
Training time/epoch 1.0312469005584717
Training time without block to device /epoch 1.0280015468597412
Training time without total dataloading part /epoch 1.005476713180542
load block tensor time/epoch 0.014698266983032227
block to device time/epoch 0.0032453536987304688
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14237
Number of first layer input nodes during this epoch:  11143
