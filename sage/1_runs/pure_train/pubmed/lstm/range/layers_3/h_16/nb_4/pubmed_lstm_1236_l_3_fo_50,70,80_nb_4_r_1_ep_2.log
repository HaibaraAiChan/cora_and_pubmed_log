main start at this time 1648529332.585613
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021135807037353516
range selection method range initialization spend 7.939338684082031e-05
time for parepare:  4.3392181396484375e-05
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0011951923370361328
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  5.4836273193359375e-05
----------------------check_connections_block total spend ----------------------------- 0.0018634796142578125
generate_one_block  0.0012960433959960938
generate_one_block  0.0011048316955566406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012454986572265625
gen group dst list time:  2.5510787963867188e-05
time for parepare:  0.00026726722717285156
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.00080108642578125
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0005240440368652344
----------------------check_connections_block total spend ----------------------------- 0.002503633499145508
generate_one_block  0.002128124237060547
generate_one_block  0.001699686050415039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001110076904296875
gen group dst list time:  6.532669067382812e-05
time for parepare:  0.0007948875427246094
local_output_nid generation:  0.00012063980102539062
local_in_edges_tensor generation:  0.00046062469482421875
mini_batch_src_global generation:  0.0003924369812011719
r_  generation:  0.004972696304321289
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.0002989768981933594
mini_batch_src_global generation:  0.0004925727844238281
r_  generation:  0.00359344482421875
----------------------check_connections_block total spend ----------------------------- 0.013563871383666992
generate_one_block  0.007276296615600586
generate_one_block  0.0054051876068115234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.0160675048828125
block generation total time  0.016509294509887695
average batch blocks generation time:  0.008254647254943848
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.019778728485107422  GigaBytes
Max Memory Allocated: 0.019778728485107422  GigaBytes

torch.Size([6232, 500])
torch.Size([1758, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.5114178657531738  GigaBytes
Max Memory Allocated: 0.5451297760009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.024545669555664062  GigaBytes
Max Memory Allocated: 0.5451297760009766  GigaBytes

torch.Size([5014, 500])
torch.Size([1142, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.37909412384033203  GigaBytes
Max Memory Allocated: 0.5451297760009766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0045964717864990234 |0.17499935626983643 |0.48512697219848633 |0.0001857280731201172 |0.32718896865844727 |0.007783651351928711 |
----------------------------------------------------------pseudo_mini_loss sum 2.021414279937744
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14501
Number of first layer input nodes during this epoch:  11246
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.039771080017089844  GigaBytes
Max Memory Allocated: 0.5451297760009766  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005009174346923828
range selection method range initialization spend 5.054473876953125e-05
time for parepare:  5.0067901611328125e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.940696716308594e-05
----------------------check_connections_block total spend ----------------------------- 0.0007214546203613281
generate_one_block  0.001232147216796875
generate_one_block  0.0012590885162353516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005500316619873047
gen group dst list time:  2.8133392333984375e-05
time for parepare:  0.0002639293670654297
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0006461143493652344
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.000705718994140625
----------------------check_connections_block total spend ----------------------------- 0.002593994140625
generate_one_block  0.0020685195922851562
generate_one_block  0.0020017623901367188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010929107666015625
gen group dst list time:  7.05718994140625e-05
time for parepare:  0.0007395744323730469
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.00045037269592285156
mini_batch_src_global generation:  0.00045108795166015625
r_  generation:  0.004488706588745117
local_output_nid generation:  0.00012922286987304688
local_in_edges_tensor generation:  0.00032806396484375
mini_batch_src_global generation:  0.0005514621734619141
r_  generation:  0.004336833953857422
----------------------check_connections_block total spend ----------------------------- 0.014053106307983398
generate_one_block  0.0072171688079833984
generate_one_block  0.006482601165771484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.039771080017089844  GigaBytes
Max Memory Allocated: 0.5451297760009766  GigaBytes

connection checking time:  0.0166471004486084
block generation total time  0.017770051956176758
average batch blocks generation time:  0.008885025978088379
block dataloader generation time/epoch 0.062087297439575195
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.04081106185913086  GigaBytes
Max Memory Allocated: 0.5451297760009766  GigaBytes
Using backend: pytorch

torch.Size([5628, 500])
torch.Size([1458, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.4833040237426758  GigaBytes
Max Memory Allocated: 0.5451297760009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.04085826873779297  GigaBytes
Max Memory Allocated: 0.5451297760009766  GigaBytes

torch.Size([5657, 500])
torch.Size([1454, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.4476199150085449  GigaBytes
Max Memory Allocated: 0.5451297760009766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00529634952545166 |0.001110076904296875 |0.23776519298553467 |0.00014162063598632812 |0.34782445430755615 |0.0066394805908203125 |
----------------------------------------------------------pseudo_mini_loss sum 1.6281087398529053
Total (block generation + training)time/epoch 1.259739637374878
Training time/epoch 1.1974430084228516
Training time without block to device /epoch 1.1952228546142578
Training time without total dataloading part /epoch 1.1781020164489746
load block tensor time/epoch 0.01059269905090332
block to device time/epoch 0.00222015380859375
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14552
Number of first layer input nodes during this epoch:  11285
