main start at this time 1648529268.8073928
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002661466598510742
range selection method range initialization spend 8.20159912109375e-05
time for parepare:  5.5789947509765625e-05
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0016562938690185547
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  6.365776062011719e-05
----------------------check_connections_block total spend ----------------------------- 0.0024390220642089844
generate_one_block  0.0015599727630615234
generate_one_block  0.001352071762084961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016102790832519531
gen group dst list time:  2.9802322387695312e-05
time for parepare:  0.00032901763916015625
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0009679794311523438
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  0.00010800361633300781
r_  generation:  0.0006330013275146484
----------------------check_connections_block total spend ----------------------------- 0.003048419952392578
generate_one_block  0.002583026885986328
generate_one_block  0.0020999908447265625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0013213157653808594
gen group dst list time:  8.96453857421875e-05
time for parepare:  0.0009694099426269531
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.0005106925964355469
mini_batch_src_global generation:  0.0005040168762207031
r_  generation:  0.005338430404663086
local_output_nid generation:  0.0001201629638671875
local_in_edges_tensor generation:  0.00033783912658691406
mini_batch_src_global generation:  0.0005328655242919922
r_  generation:  0.003880739212036133
----------------------check_connections_block total spend ----------------------------- 0.014943838119506836
generate_one_block  0.006634712219238281
generate_one_block  0.0049533843994140625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.017992258071899414
block generation total time  0.016271114349365234
average batch blocks generation time:  0.008135557174682617
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.01847076416015625  GigaBytes
Max Memory Allocated: 0.01847076416015625  GigaBytes

torch.Size([5793, 500])
torch.Size([1758, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.4448575973510742  GigaBytes
Max Memory Allocated: 0.47441673278808594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.023697376251220703  GigaBytes
Max Memory Allocated: 0.47441673278808594  GigaBytes

torch.Size([4565, 500])
torch.Size([1142, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.3346853256225586  GigaBytes
Max Memory Allocated: 0.47441673278808594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0036017894744873047 |0.1722186803817749 |0.39760899543762207 |0.00018024444580078125 |0.20819544792175293 |0.008077383041381836 |
----------------------------------------------------------pseudo_mini_loss sum 2.0196006298065186
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13613
Number of first layer input nodes during this epoch:  10358
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.0401158332824707  GigaBytes
Max Memory Allocated: 0.47441673278808594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005860328674316406
range selection method range initialization spend 6.175041198730469e-05
time for parepare:  6.246566772460938e-05
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0002224445343017578
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  8.606910705566406e-05
----------------------check_connections_block total spend ----------------------------- 0.0008263587951660156
generate_one_block  0.001428365707397461
generate_one_block  0.0014083385467529297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006499290466308594
gen group dst list time:  3.5762786865234375e-05
time for parepare:  0.0003268718719482422
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.0007922649383544922
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  0.00010323524475097656
r_  generation:  0.0008447170257568359
----------------------check_connections_block total spend ----------------------------- 0.0030829906463623047
generate_one_block  0.00244903564453125
generate_one_block  0.0024178028106689453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012221336364746094
gen group dst list time:  8.893013000488281e-05
time for parepare:  0.0008852481842041016
local_output_nid generation:  0.0001780986785888672
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0005524158477783203
r_  generation:  0.004654884338378906
local_output_nid generation:  0.0001850128173828125
local_in_edges_tensor generation:  0.0003757476806640625
mini_batch_src_global generation:  0.0005788803100585938
r_  generation:  0.0046503543853759766
----------------------check_connections_block total spend ----------------------------- 0.015278339385986328
generate_one_block  0.006356477737426758
generate_one_block  0.006032705307006836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.0401158332824707  GigaBytes
Max Memory Allocated: 0.47441673278808594  GigaBytes

connection checking time:  0.018361330032348633
block generation total time  0.01725602149963379
average batch blocks generation time:  0.008628010749816895
block dataloader generation time/epoch 0.059996604919433594
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.04109477996826172  GigaBytes
Max Memory Allocated: 0.47441673278808594  GigaBytes
Using backend: pytorch

torch.Size([5143, 500])
torch.Size([1458, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.4158964157104492  GigaBytes
Max Memory Allocated: 0.47441673278808594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.04135465621948242  GigaBytes
Max Memory Allocated: 0.47441673278808594  GigaBytes

torch.Size([5283, 500])
torch.Size([1454, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.40575408935546875  GigaBytes
Max Memory Allocated: 0.47441673278808594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0029153823852539062 |0.0007848739624023438 |0.15245449542999268 |0.0001379251480102539 |0.20946133136749268 |0.006722927093505859 |
----------------------------------------------------------pseudo_mini_loss sum 1.606011152267456
Total (block generation + training)time/epoch 0.8034396171569824
Training time/epoch 0.7432515621185303
Training time without block to device /epoch 0.7416818141937256
Training time without total dataloading part /epoch 0.7308304309844971
load block tensor time/epoch 0.0058307647705078125
block to device time/epoch 0.0015697479248046875
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13693
Number of first layer input nodes during this epoch:  10426
