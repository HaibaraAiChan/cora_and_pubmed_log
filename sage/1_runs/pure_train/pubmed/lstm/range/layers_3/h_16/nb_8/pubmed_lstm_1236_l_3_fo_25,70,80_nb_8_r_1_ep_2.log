main start at this time 1648529280.181804
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002351999282836914
range selection method range initialization spend 7.891654968261719e-05
time for parepare:  4.2438507080078125e-05
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.0011432170867919922
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.9802322387695312e-05
----------------------check_connections_block total spend ----------------------------- 0.002110004425048828
generate_one_block  0.0011591911315917969
generate_one_block  0.001112222671508789
generate_one_block  0.0010225772857666016
generate_one_block  0.0010042190551757812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012307167053222656
gen group dst list time:  3.2901763916015625e-05
time for parepare:  0.0002415180206298828
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0003647804260253906
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0004467964172363281
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00034236907958984375
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00018835067749023438
----------------------check_connections_block total spend ----------------------------- 0.002782106399536133
generate_one_block  0.0014996528625488281
generate_one_block  0.0015850067138671875
generate_one_block  0.0014362335205078125
generate_one_block  0.0012054443359375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010123252868652344
gen group dst list time:  7.319450378417969e-05
time for parepare:  0.0007343292236328125
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.00032520294189453125
mini_batch_src_global generation:  0.00018525123596191406
r_  generation:  0.002092599868774414
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.00024056434631347656
mini_batch_src_global generation:  0.0002586841583251953
r_  generation:  0.0026285648345947266
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.00022602081298828125
mini_batch_src_global generation:  0.00025153160095214844
r_  generation:  0.0024008750915527344
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0003910064697265625
mini_batch_src_global generation:  0.00013971328735351562
r_  generation:  0.0009508132934570312
----------------------check_connections_block total spend ----------------------------- 0.013095855712890625
generate_one_block  0.0038175582885742188
generate_one_block  0.004210710525512695
generate_one_block  0.004069328308105469
generate_one_block  0.0020012855529785156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.015877962112426758
block generation total time  0.019825220108032227
average batch blocks generation time:  0.004956305027008057
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014308452606201172  GigaBytes
Max Memory Allocated: 0.014308452606201172  GigaBytes

torch.Size([3594, 500])
torch.Size([885, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.21761465072631836  GigaBytes
Max Memory Allocated: 0.23249387741088867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.021812915802001953  GigaBytes
Max Memory Allocated: 0.23249387741088867  GigaBytes

torch.Size([3561, 500])
torch.Size([989, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.2854437828063965  GigaBytes
Max Memory Allocated: 0.30469846725463867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.021916866302490234  GigaBytes
Max Memory Allocated: 0.30469846725463867  GigaBytes

torch.Size([3620, 500])
torch.Size([814, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.2651791572570801  GigaBytes
Max Memory Allocated: 0.30469846725463867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.018218517303466797  GigaBytes
Max Memory Allocated: 0.30469846725463867  GigaBytes

torch.Size([1659, 500])
torch.Size([363, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.10255050659179688  GigaBytes
Max Memory Allocated: 0.30469846725463867  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006062686443328857 |0.08523786067962646 |0.24126625061035156 |0.00014227628707885742 |0.15668600797653198 |0.010522842407226562 |
----------------------------------------------------------pseudo_mini_loss sum 1.806429386138916
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15842
Number of first layer input nodes during this epoch:  12434
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.033350467681884766  GigaBytes
Max Memory Allocated: 0.30469846725463867  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004825592041015625
range selection method range initialization spend 4.76837158203125e-05
time for parepare:  5.125999450683594e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00010395050048828125
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.673004150390625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  6.031990051269531e-05
----------------------check_connections_block total spend ----------------------------- 0.0011148452758789062
generate_one_block  0.0011708736419677734
generate_one_block  0.0010662078857421875
generate_one_block  0.0010535717010498047
generate_one_block  0.0010478496551513672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005180835723876953
gen group dst list time:  4.0531158447265625e-05
time for parepare:  0.00026297569274902344
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00025343894958496094
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0004029273986816406
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0002720355987548828
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.00040459632873535156
----------------------check_connections_block total spend ----------------------------- 0.0028848648071289062
generate_one_block  0.0014007091522216797
generate_one_block  0.0016238689422607422
generate_one_block  0.0013518333435058594
generate_one_block  0.001878976821899414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009450912475585938
gen group dst list time:  8.273124694824219e-05
time for parepare:  0.0006797313690185547
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.000308990478515625
mini_batch_src_global generation:  0.00018596649169921875
r_  generation:  0.0016722679138183594
local_output_nid generation:  8.463859558105469e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  0.0003249645233154297
r_  generation:  0.0024738311767578125
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  0.0001723766326904297
r_  generation:  0.001417398452758789
local_output_nid generation:  8.893013000488281e-05
local_in_edges_tensor generation:  0.00023889541625976562
mini_batch_src_global generation:  0.00022149085998535156
r_  generation:  0.0024619102478027344
----------------------check_connections_block total spend ----------------------------- 0.013214826583862305
generate_one_block  0.0034990310668945312
generate_one_block  0.004030942916870117
generate_one_block  0.004415035247802734
generate_one_block  0.0049092769622802734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.033350467681884766  GigaBytes
Max Memory Allocated: 0.30469846725463867  GigaBytes

connection checking time:  0.01609969139099121
block generation total time  0.02310967445373535
average batch blocks generation time:  0.005777418613433838
block dataloader generation time/epoch 0.07318258285522461
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.03623247146606445  GigaBytes
Max Memory Allocated: 0.30469846725463867  GigaBytes

torch.Size([3214, 500])
torch.Size([629, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1998462677001953  GigaBytes
Max Memory Allocated: 0.30469846725463867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.03636312484741211  GigaBytes
Max Memory Allocated: 0.30469846725463867  GigaBytes

torch.Size([3156, 500])
torch.Size([900, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.27443838119506836  GigaBytes
Max Memory Allocated: 0.30469846725463867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.03506278991699219  GigaBytes
Max Memory Allocated: 0.30469846725463867  GigaBytes

torch.Size([2590, 500])
torch.Size([565, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.16663312911987305  GigaBytes
Max Memory Allocated: 0.30469846725463867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.03696727752685547  GigaBytes
Max Memory Allocated: 0.30469846725463867  GigaBytes

torch.Size([3517, 500])
torch.Size([914, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.2835731506347656  GigaBytes
Max Memory Allocated: 0.30469846725463867  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0040468573570251465 |0.0008058547973632812 |0.11943066120147705 |0.0001341700553894043 |0.15350282192230225 |0.006501674652099609 |
----------------------------------------------------------pseudo_mini_loss sum 1.8383989334106445
Total (block generation + training)time/epoch 1.199521780014038
Training time/epoch 1.1261484622955322
Training time without block to device /epoch 1.122925043106079
Training time without total dataloading part /epoch 1.0987722873687744
load block tensor time/epoch 0.016187429428100586
block to device time/epoch 0.003223419189453125
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15841
Number of first layer input nodes during this epoch:  12477
