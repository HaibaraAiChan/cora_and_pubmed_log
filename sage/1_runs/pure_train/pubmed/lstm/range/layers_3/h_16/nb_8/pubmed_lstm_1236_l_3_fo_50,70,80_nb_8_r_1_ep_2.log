main start at this time 1648529344.8989794
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002173900604248047
range selection method range initialization spend 8.153915405273438e-05
time for parepare:  4.482269287109375e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.0011279582977294922
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.123283386230469e-05
----------------------check_connections_block total spend ----------------------------- 0.0021219253540039062
generate_one_block  0.0012753009796142578
generate_one_block  0.0011658668518066406
generate_one_block  0.0010867118835449219
generate_one_block  0.0010478496551513672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012269020080566406
gen group dst list time:  3.409385681152344e-05
time for parepare:  0.0002474784851074219
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0003695487976074219
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0004520416259765625
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00034809112548828125
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0001919269561767578
----------------------check_connections_block total spend ----------------------------- 0.0028429031372070312
generate_one_block  0.0015621185302734375
generate_one_block  0.0016276836395263672
generate_one_block  0.001491546630859375
generate_one_block  0.001241922378540039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001041412353515625
gen group dst list time:  7.414817810058594e-05
time for parepare:  0.0007674694061279297
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.0003426074981689453
mini_batch_src_global generation:  0.00020003318786621094
r_  generation:  0.002424001693725586
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.0002529621124267578
mini_batch_src_global generation:  0.00042891502380371094
r_  generation:  0.0031554698944091797
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.0002372264862060547
mini_batch_src_global generation:  0.00028514862060546875
r_  generation:  0.0028166770935058594
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0004210472106933594
mini_batch_src_global generation:  0.00015664100646972656
r_  generation:  0.0010671615600585938
----------------------check_connections_block total spend ----------------------------- 0.01521158218383789
generate_one_block  0.004180192947387695
generate_one_block  0.004807949066162109
generate_one_block  0.004472494125366211
generate_one_block  0.0021300315856933594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.018054485321044922
block generation total time  0.021513938903808594
average batch blocks generation time:  0.0053784847259521484
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.015070438385009766  GigaBytes
Max Memory Allocated: 0.015070438385009766  GigaBytes

torch.Size([3999, 500])
torch.Size([885, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.24832439422607422  GigaBytes
Max Memory Allocated: 0.26517820358276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.02246236801147461  GigaBytes
Max Memory Allocated: 0.26517820358276367  GigaBytes

torch.Size([3902, 500])
torch.Size([990, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.33682918548583984  GigaBytes
Max Memory Allocated: 0.35784053802490234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.023540973663330078  GigaBytes
Max Memory Allocated: 0.35784053802490234  GigaBytes

torch.Size([3988, 500])
torch.Size([815, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.305661678314209  GigaBytes
Max Memory Allocated: 0.35784053802490234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.018856525421142578  GigaBytes
Max Memory Allocated: 0.35784053802490234  GigaBytes

torch.Size([1909, 500])
torch.Size([363, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.11295509338378906  GigaBytes
Max Memory Allocated: 0.35784053802490234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003960907459259033 |0.08594578504562378 |0.31545817852020264 |0.0001513957977294922 |0.26483410596847534 |0.008477449417114258 |
----------------------------------------------------------pseudo_mini_loss sum 1.8052047491073608
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17208
Number of first layer input nodes during this epoch:  13798
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.03489494323730469  GigaBytes
Max Memory Allocated: 0.35784053802490234  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005183219909667969
range selection method range initialization spend 5.269050598144531e-05
time for parepare:  5.650520324707031e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00011348724365234375
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  4.57763671875e-05
----------------------check_connections_block total spend ----------------------------- 0.0011737346649169922
generate_one_block  0.0012578964233398438
generate_one_block  0.0010976791381835938
generate_one_block  0.0011088848114013672
generate_one_block  0.0010998249053955078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005660057067871094
gen group dst list time:  3.457069396972656e-05
time for parepare:  0.000286102294921875
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00026416778564453125
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.00041031837463378906
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0002834796905517578
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0004165172576904297
----------------------check_connections_block total spend ----------------------------- 0.0030264854431152344
generate_one_block  0.001468658447265625
generate_one_block  0.001636505126953125
generate_one_block  0.0017383098602294922
generate_one_block  0.0016422271728515625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010559558868408203
gen group dst list time:  9.655952453613281e-05
time for parepare:  0.0007588863372802734
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00031280517578125
mini_batch_src_global generation:  0.00025534629821777344
r_  generation:  0.001979827880859375
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.0003821849822998047
r_  generation:  0.002873659133911133
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.0001900196075439453
r_  generation:  0.001659393310546875
local_output_nid generation:  9.870529174804688e-05
local_in_edges_tensor generation:  0.0002522468566894531
mini_batch_src_global generation:  0.00025153160095214844
r_  generation:  0.0028922557830810547
----------------------check_connections_block total spend ----------------------------- 0.01531982421875
generate_one_block  0.004002571105957031
generate_one_block  0.004511594772338867
generate_one_block  0.0029754638671875
generate_one_block  0.004614830017089844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.03489494323730469  GigaBytes
Max Memory Allocated: 0.35784053802490234  GigaBytes

connection checking time:  0.018346309661865234
block generation total time  0.022590160369873047
average batch blocks generation time:  0.005647540092468262
block dataloader generation time/epoch 0.08803415298461914
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.03784608840942383  GigaBytes
Max Memory Allocated: 0.35784053802490234  GigaBytes

torch.Size([3591, 500])
torch.Size([630, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.23031282424926758  GigaBytes
Max Memory Allocated: 0.35784053802490234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.03757762908935547  GigaBytes
Max Memory Allocated: 0.35784053802490234  GigaBytes

torch.Size([3432, 500])
torch.Size([900, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.31957340240478516  GigaBytes
Max Memory Allocated: 0.35784053802490234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.03635835647583008  GigaBytes
Max Memory Allocated: 0.35784053802490234  GigaBytes

torch.Size([2799, 500])
torch.Size([565, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.17833280563354492  GigaBytes
Max Memory Allocated: 0.35784053802490234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.038285255432128906  GigaBytes
Max Memory Allocated: 0.35784053802490234  GigaBytes

torch.Size([3811, 500])
torch.Size([914, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.32218503952026367  GigaBytes
Max Memory Allocated: 0.35784053802490234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006591200828552246 |0.0009505748748779297 |0.19457393884658813 |0.00013822317123413086 |0.26297521591186523 |0.007165193557739258 |
----------------------------------------------------------pseudo_mini_loss sum 1.8535521030426025
Total (block generation + training)time/epoch 1.9649176597595215
Training time/epoch 1.8766205310821533
Training time without block to device /epoch 1.8728182315826416
Training time without total dataloading part /epoch 1.8379147052764893
load block tensor time/epoch 0.026364803314208984
block to device time/epoch 0.0038022994995117188
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16998
Number of first layer input nodes during this epoch:  13633
