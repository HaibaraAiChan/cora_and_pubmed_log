main start at this time 1648529182.7681155
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018191337585449219
range selection method range initialization spend 7.843971252441406e-05
time for parepare:  4.863739013671875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.001138925552368164
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5497207641601562e-05
----------------------check_connections_block total spend ----------------------------- 0.004014015197753906
generate_one_block  0.0011892318725585938
generate_one_block  0.0010480880737304688
generate_one_block  0.0011479854583740234
generate_one_block  0.0010449886322021484
generate_one_block  0.0010509490966796875
generate_one_block  0.0010406970977783203
generate_one_block  0.0010516643524169922
generate_one_block  0.0010869503021240234
generate_one_block  0.001033782958984375
generate_one_block  0.0010311603546142578
generate_one_block  0.001047372817993164
generate_one_block  0.0010476112365722656
generate_one_block  0.0010285377502441406
generate_one_block  0.0010361671447753906
generate_one_block  0.0010139942169189453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010216236114501953
gen group dst list time:  8.511543273925781e-05
time for parepare:  0.0002574920654296875
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00015664100646972656
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  9.894371032714844e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00011134147644042969
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0002741813659667969
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  6.079673767089844e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00020313262939453125
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.100799560546875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.4849853515625e-05
----------------------check_connections_block total spend ----------------------------- 0.004740476608276367
generate_one_block  0.0011625289916992188
generate_one_block  0.0011510848999023438
generate_one_block  0.001257181167602539
generate_one_block  0.0011849403381347656
generate_one_block  0.0011568069458007812
generate_one_block  0.0010859966278076172
generate_one_block  0.0014612674713134766
generate_one_block  0.0011372566223144531
generate_one_block  0.0010373592376708984
generate_one_block  0.0009868144989013672
generate_one_block  0.0010225772857666016
generate_one_block  0.0011975765228271484
generate_one_block  0.0009844303131103516
generate_one_block  0.0009860992431640625
generate_one_block  0.001058816909790039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011076927185058594
gen group dst list time:  0.00013113021850585938
time for parepare:  0.0007543563842773438
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00027561187744140625
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00031065940856933594
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.00045752525329589844
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  0.00010895729064941406
r_  generation:  0.0009636878967285156
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0005853176116943359
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0005087852478027344
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.00025582313537597656
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.00016069412231445312
r_  generation:  0.0017597675323486328
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  0.00010037422180175781
r_  generation:  0.0004215240478515625
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.00045800209045410156
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00018739700317382812
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0004284381866455078
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  0.0001316070556640625
r_  generation:  0.0013844966888427734
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0001633167266845703
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.000148773193359375
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0003421306610107422
----------------------check_connections_block total spend ----------------------------- 0.015313386917114258
generate_one_block  0.0016183853149414062
generate_one_block  0.0016314983367919922
generate_one_block  0.0022656917572021484
generate_one_block  0.0016529560089111328
generate_one_block  0.0015490055084228516
generate_one_block  0.0012874603271484375
generate_one_block  0.003070354461669922
generate_one_block  0.0013973712921142578
generate_one_block  0.0014467239379882812
generate_one_block  0.0011436939239501953
generate_one_block  0.0015180110931396484
generate_one_block  0.002577066421508789
generate_one_block  0.0011150836944580078
generate_one_block  0.0014150142669677734
generate_one_block  0.0013260841369628906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.020053863525390625
block generation total time  0.0418851375579834
average batch blocks generation time:  0.0027923425038655597
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.008504867553710938  GigaBytes
Max Memory Allocated: 0.008504867553710938  GigaBytes

torch.Size([506, 500])
torch.Size([150, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.03544187545776367  GigaBytes
Max Memory Allocated: 0.03735542297363281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.016590118408203125  GigaBytes
Max Memory Allocated: 0.05033111572265625  GigaBytes

torch.Size([792, 500])
torch.Size([194, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.055144309997558594  GigaBytes
Max Memory Allocated: 0.057817935943603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.01867198944091797  GigaBytes
Max Memory Allocated: 0.0701146125793457  GigaBytes

torch.Size([1902, 500])
torch.Size([308, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.10685443878173828  GigaBytes
Max Memory Allocated: 0.1132354736328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.016839981079101562  GigaBytes
Max Memory Allocated: 0.11972427368164062  GigaBytes

torch.Size([924, 500])
torch.Size([229, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.0678567886352539  GigaBytes
Max Memory Allocated: 0.11972427368164062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.017119884490966797  GigaBytes
Max Memory Allocated: 0.11972427368164062  GigaBytes

torch.Size([984, 500])
torch.Size([174, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.06297445297241211  GigaBytes
Max Memory Allocated: 0.11972427368164062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.015878677368164062  GigaBytes
Max Memory Allocated: 0.11972427368164062  GigaBytes

torch.Size([413, 500])
torch.Size([98, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.035624027252197266  GigaBytes
Max Memory Allocated: 0.11972427368164062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.019782066345214844  GigaBytes
Max Memory Allocated: 0.11972427368164062  GigaBytes

torch.Size([2302, 500])
torch.Size([564, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.19046974182128906  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.01629781723022461  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([636, 500])
torch.Size([183, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.04936504364013672  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.016459941864013672  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([722, 500])
torch.Size([145, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.05768251419067383  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.015662670135498047  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([298, 500])
torch.Size([87, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.029552936553955078  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.017121315002441406  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([1077, 500])
torch.Size([123, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.05715465545654297  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.01977062225341797  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([2045, 500])
torch.Size([391, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.15169143676757812  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.015523433685302734  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([224, 500])
torch.Size([63, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.025682926177978516  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.015610218048095703  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([270, 500])
torch.Size([53, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.027334213256835938  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.01615142822265625  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([558, 500])
torch.Size([119, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.046210289001464844  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0019892215728759765 |0.02443354924519857 |0.10457434654235839 |0.0001244386037190755 |0.07575639088948567 |0.009381771087646484 |
----------------------------------------------------------pseudo_mini_loss sum 1.7312690019607544
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16891
Number of first layer input nodes during this epoch:  13653
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03216695785522461  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005383491516113281
range selection method range initialization spend 5.602836608886719e-05
time for parepare:  6.461143493652344e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6941299438476562e-05
----------------------check_connections_block total spend ----------------------------- 0.0029592514038085938
generate_one_block  0.001191854476928711
generate_one_block  0.0011088848114013672
generate_one_block  0.0011005401611328125
generate_one_block  0.0010936260223388672
generate_one_block  0.0011000633239746094
generate_one_block  0.0010921955108642578
generate_one_block  0.0010898113250732422
generate_one_block  0.0010864734649658203
generate_one_block  0.0010967254638671875
generate_one_block  0.001173257827758789
generate_one_block  0.001094818115234375
generate_one_block  0.0010859966278076172
generate_one_block  0.0010845661163330078
generate_one_block  0.0010886192321777344
generate_one_block  0.0010902881622314453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006513595581054688
gen group dst list time:  8.440017700195312e-05
time for parepare:  0.0002846717834472656
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  8.726119995117188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  8.463859558105469e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.20159912109375e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00017523765563964844
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  7.390975952148438e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  8.7738037109375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.000133514404296875
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0001442432403564453
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  7.319450378417969e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.106231689453125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00015091896057128906
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  9.870529174804688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00013208389282226562
----------------------check_connections_block total spend ----------------------------- 0.004889011383056641
generate_one_block  0.0012216567993164062
generate_one_block  0.0011739730834960938
generate_one_block  0.0011723041534423828
generate_one_block  0.00113677978515625
generate_one_block  0.0013370513916015625
generate_one_block  0.0011713504791259766
generate_one_block  0.0012693405151367188
generate_one_block  0.0012359619140625
generate_one_block  0.0011518001556396484
generate_one_block  0.0010726451873779297
generate_one_block  0.0010597705841064453
generate_one_block  0.0011839866638183594
generate_one_block  0.001087188720703125
generate_one_block  0.0011126995086669922
generate_one_block  0.0011363029479980469
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011067390441894531
gen group dst list time:  0.00014257431030273438
time for parepare:  0.0008578300476074219
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00040984153747558594
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0004165172576904297
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  8.559226989746094e-05
r_  generation:  0.0004754066467285156
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0004811286926269531
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0002651214599609375
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00013303756713867188
r_  generation:  0.0012278556823730469
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.00031638145446777344
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004489421844482422
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0007610321044921875
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0007736682891845703
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0004322528839111328
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0002894401550292969
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.0001049041748046875
r_  generation:  0.00104522705078125
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.00041866302490234375
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0005993843078613281
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  8.7738037109375e-05
r_  generation:  0.0006461143493652344
----------------------check_connections_block total spend ----------------------------- 0.017176151275634766
generate_one_block  0.0019865036010742188
generate_one_block  0.0017731189727783203
generate_one_block  0.001604318618774414
generate_one_block  0.0015034675598144531
generate_one_block  0.0024611949920654297
generate_one_block  0.0013577938079833984
generate_one_block  0.0015270709991455078
generate_one_block  0.001950979232788086
generate_one_block  0.0019257068634033203
generate_one_block  0.0014793872833251953
generate_one_block  0.0013647079467773438
generate_one_block  0.0022735595703125
generate_one_block  0.0014901161193847656
generate_one_block  0.0017547607421875
generate_one_block  0.0018188953399658203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03216695785522461  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

connection checking time:  0.022065162658691406
block generation total time  0.04379439353942871
average batch blocks generation time:  0.002919626235961914
block dataloader generation time/epoch 0.14190292358398438
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03238534927368164  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([683, 500])
torch.Size([184, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.0673213005065918  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03319883346557617  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([1118, 500])
torch.Size([144, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.07523202896118164  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.0336613655090332  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([935, 500])
torch.Size([137, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.07357597351074219  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.032050132751464844  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([505, 500])
torch.Size([81, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.05350780487060547  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.033400535583496094  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([1214, 500])
torch.Size([306, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.15440130233764648  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03191423416137695  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([431, 500])
torch.Size([129, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.05633831024169922  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03236055374145508  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([669, 500])
torch.Size([184, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.06884145736694336  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03363752365112305  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([1350, 500])
torch.Size([314, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.10117340087890625  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03359842300415039  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([1329, 500])
torch.Size([280, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.10088825225830078  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03249931335449219  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([744, 500])
torch.Size([124, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.06554603576660156  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.031961917877197266  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([457, 500])
torch.Size([97, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.05381155014038086  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.033626556396484375  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([1339, 500])
torch.Size([299, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.1324291229248047  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03240966796875  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([696, 500])
torch.Size([134, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.06579923629760742  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.0329136848449707  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([963, 500])
torch.Size([229, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.08643341064453125  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03276395797729492  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes

torch.Size([883, 500])
torch.Size([225, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.08279609680175781  GigaBytes
Max Memory Allocated: 0.2036590576171875  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0028615951538085937 |0.0008450031280517578 |0.07566240628560385 |0.00012687047322591146 |0.07924524943033855 |0.008844614028930664 |
----------------------------------------------------------pseudo_mini_loss sum 2.111184597015381
Total (block generation + training)time/epoch 2.5604987144470215
Training time/epoch 2.418154716491699
Training time without block to device /epoch 2.405479669570923
Training time without total dataloading part /epoch 2.334362506866455
load block tensor time/epoch 0.042923927307128906
block to device time/epoch 0.012675046920776367
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16540
Number of first layer input nodes during this epoch:  13316
