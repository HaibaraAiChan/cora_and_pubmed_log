main start at this time 1648529147.0121708
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0023992061614990234
range selection method range initialization spend 8.296966552734375e-05
time for parepare:  4.363059997558594e-05
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0011725425720214844
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  5.340576171875e-05
----------------------check_connections_block total spend ----------------------------- 0.0018143653869628906
generate_one_block  0.0012874603271484375
generate_one_block  0.0010733604431152344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016665458679199219
gen group dst list time:  2.4318695068359375e-05
time for parepare:  0.00023221969604492188
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0007731914520263672
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  9.369850158691406e-05
r_  generation:  0.0004677772521972656
----------------------check_connections_block total spend ----------------------------- 0.002340078353881836
generate_one_block  0.002018451690673828
generate_one_block  0.0016791820526123047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009918212890625
gen group dst list time:  6.222724914550781e-05
time for parepare:  0.00075531005859375
local_output_nid generation:  0.0001068115234375
local_in_edges_tensor generation:  0.00041937828063964844
mini_batch_src_global generation:  0.00035762786865234375
r_  generation:  0.004198312759399414
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  0.00039649009704589844
r_  generation:  0.0028960704803466797
----------------------check_connections_block total spend ----------------------------- 0.01128697395324707
generate_one_block  0.006910562515258789
generate_one_block  0.0047914981842041016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.013627052307128906
block generation total time  0.015399694442749023
average batch blocks generation time:  0.007699847221374512
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.018247127532958984  GigaBytes
Max Memory Allocated: 0.018247127532958984  GigaBytes

torch.Size([5676, 500])
torch.Size([1646, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.4278297424316406  GigaBytes
Max Memory Allocated: 0.4564023017883301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.02340555191040039  GigaBytes
Max Memory Allocated: 0.4564023017883301  GigaBytes

torch.Size([4224, 500])
torch.Size([1053, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6795654296875 GB
    Memory Allocated: 0.30208253860473633  GigaBytes
Max Memory Allocated: 0.4564023017883301  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005324721336364746 |0.17059624195098877 |0.3677632808685303 |0.00017380714416503906 |0.1554265022277832 |0.008046865463256836 |
----------------------------------------------------------pseudo_mini_loss sum 2.012213945388794
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12954
Number of first layer input nodes during this epoch:  9900
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6795654296875 GB
    Memory Allocated: 0.03951263427734375  GigaBytes
Max Memory Allocated: 0.4564023017883301  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000514984130859375
range selection method range initialization spend 4.887580871582031e-05
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.2479248046875e-05
----------------------check_connections_block total spend ----------------------------- 0.0006916522979736328
generate_one_block  0.0012459754943847656
generate_one_block  0.001132965087890625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005390644073486328
gen group dst list time:  2.5272369384765625e-05
time for parepare:  0.0002460479736328125
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0005693435668945312
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  9.512901306152344e-05
r_  generation:  0.0006792545318603516
----------------------check_connections_block total spend ----------------------------- 0.002409219741821289
generate_one_block  0.001889944076538086
generate_one_block  0.0018711090087890625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009374618530273438
gen group dst list time:  6.4849853515625e-05
time for parepare:  0.0006527900695800781
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.0003924369812011719
mini_batch_src_global generation:  0.0003008842468261719
r_  generation:  0.0034508705139160156
local_output_nid generation:  0.00011897087097167969
local_in_edges_tensor generation:  0.0002982616424560547
mini_batch_src_global generation:  0.0004673004150390625
r_  generation:  0.0035300254821777344
----------------------check_connections_block total spend ----------------------------- 0.011370182037353516
generate_one_block  0.005896091461181641
generate_one_block  0.0058286190032958984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6795654296875 GB
    Memory Allocated: 0.03951263427734375  GigaBytes
Max Memory Allocated: 0.4564023017883301  GigaBytes

connection checking time:  0.013779401779174805
block generation total time  0.015485763549804688
average batch blocks generation time:  0.007742881774902344
block dataloader generation time/epoch 0.04889416694641113
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6795654296875 GB
    Memory Allocated: 0.040517330169677734  GigaBytes
Max Memory Allocated: 0.4564023017883301  GigaBytes
Using backend: pytorch

torch.Size([4811, 500])
torch.Size([1328, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6795654296875 GB
    Memory Allocated: 0.385251522064209  GigaBytes
Max Memory Allocated: 0.4564023017883301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6795654296875 GB
    Memory Allocated: 0.04121685028076172  GigaBytes
Max Memory Allocated: 0.4564023017883301  GigaBytes

torch.Size([5185, 500])
torch.Size([1387, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6795654296875 GB
    Memory Allocated: 0.3892979621887207  GigaBytes
Max Memory Allocated: 0.4564023017883301  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00386202335357666 |0.0006885528564453125 |0.12123286724090576 |0.00012624263763427734 |0.15102136135101318 |0.009945154190063477 |
----------------------------------------------------------pseudo_mini_loss sum 1.5307731628417969
Total (block generation + training)time/epoch 0.6170318126678467
Training time/epoch 0.5679497718811035
Training time without block to device /epoch 0.5665726661682129
Training time without total dataloading part /epoch 0.5547060966491699
load block tensor time/epoch 0.00772404670715332
block to device time/epoch 0.001377105712890625
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13066
Number of first layer input nodes during this epoch:  9996
