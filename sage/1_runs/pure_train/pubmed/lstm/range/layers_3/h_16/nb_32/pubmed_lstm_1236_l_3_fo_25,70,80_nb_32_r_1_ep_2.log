main start at this time 1648529305.5900576
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018906593322753906
range selection method range initialization spend 0.00010776519775390625
time for parepare:  5.340576171875e-05
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00022125244140625
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.002802610397338867
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.006101846694946289
generate_one_block  0.0014243125915527344
generate_one_block  0.0012378692626953125
generate_one_block  0.0012621879577636719
generate_one_block  0.0012388229370117188
generate_one_block  0.0012462139129638672
generate_one_block  0.001214742660522461
generate_one_block  0.0010459423065185547
generate_one_block  0.0010747909545898438
generate_one_block  0.0010409355163574219
generate_one_block  0.001028299331665039
generate_one_block  0.001035928726196289
generate_one_block  0.001062154769897461
generate_one_block  0.0009443759918212891
generate_one_block  0.0010373592376708984
generate_one_block  0.0009510517120361328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009343624114990234
gen group dst list time:  0.00010824203491210938
time for parepare:  0.0003268718719482422
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001361370086669922
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.000110626220703125
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.000186920166015625
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00012230873107910156
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00014090538024902344
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00033974647521972656
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00011038780212402344
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  9.393692016601562e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.177757263183594e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0002548694610595703
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.534027099609375e-05
----------------------check_connections_block total spend ----------------------------- 0.0056726932525634766
generate_one_block  0.0013742446899414062
generate_one_block  0.0013685226440429688
generate_one_block  0.0014698505401611328
generate_one_block  0.001407623291015625
generate_one_block  0.0013952255249023438
generate_one_block  0.0012302398681640625
generate_one_block  0.0014812946319580078
generate_one_block  0.0011532306671142578
generate_one_block  0.0010387897491455078
generate_one_block  0.0009968280792236328
generate_one_block  0.0010280609130859375
generate_one_block  0.0012183189392089844
generate_one_block  0.0009951591491699219
generate_one_block  0.0009772777557373047
generate_one_block  0.001062154769897461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011687278747558594
gen group dst list time:  0.0001761913299560547
time for parepare:  0.0009298324584960938
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00028395652770996094
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004246234893798828
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0005457401275634766
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.00011682510375976562
r_  generation:  0.001148223876953125
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0007395744323730469
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0007681846618652344
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0003056526184082031
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.00024056434631347656
mini_batch_src_global generation:  0.00020956993103027344
r_  generation:  0.0022132396697998047
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  0.00011491775512695312
r_  generation:  0.0005490779876708984
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0005419254302978516
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00022268295288085938
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0006997585296630859
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  0.00015544891357421875
r_  generation:  0.001529693603515625
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.000164031982421875
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00014662742614746094
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0003407001495361328
----------------------check_connections_block total spend ----------------------------- 0.01858663558959961
generate_one_block  0.0015583038330078125
generate_one_block  0.0014796257019042969
generate_one_block  0.002119779586791992
generate_one_block  0.0016436576843261719
generate_one_block  0.0017237663269042969
generate_one_block  0.0012950897216796875
generate_one_block  0.003167390823364258
generate_one_block  0.001445770263671875
generate_one_block  0.0014901161193847656
generate_one_block  0.0011432170867919922
generate_one_block  0.0017125606536865234
generate_one_block  0.0027489662170410156
generate_one_block  0.0010950565338134766
generate_one_block  0.0013976097106933594
generate_one_block  0.0013191699981689453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.024259328842163086
block generation total time  0.04353690147399902
average batch blocks generation time:  0.0029024600982666014
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.008574962615966797  GigaBytes
Max Memory Allocated: 0.008574962615966797  GigaBytes

torch.Size([543, 500])
torch.Size([176, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.040312767028808594  GigaBytes
Max Memory Allocated: 0.04242372512817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.016603469848632812  GigaBytes
Max Memory Allocated: 0.05401325225830078  GigaBytes

torch.Size([799, 500])
torch.Size([200, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.05614328384399414  GigaBytes
Max Memory Allocated: 0.05875682830810547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.018694400787353516  GigaBytes
Max Memory Allocated: 0.07006168365478516  GigaBytes

torch.Size([1914, 500])
torch.Size([308, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.10687685012817383  GigaBytes
Max Memory Allocated: 0.11314964294433594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.01701211929321289  GigaBytes
Max Memory Allocated: 0.11884307861328125  GigaBytes

torch.Size([1016, 500])
torch.Size([255, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.07264566421508789  GigaBytes
Max Memory Allocated: 0.11884307861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.017303943634033203  GigaBytes
Max Memory Allocated: 0.11884307861328125  GigaBytes

torch.Size([1172, 500])
torch.Size([208, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.07621526718139648  GigaBytes
Max Memory Allocated: 0.11884307861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.015878677368164062  GigaBytes
Max Memory Allocated: 0.11884307861328125  GigaBytes

torch.Size([413, 500])
torch.Size([98, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.035624027252197266  GigaBytes
Max Memory Allocated: 0.11884307861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.019556522369384766  GigaBytes
Max Memory Allocated: 0.11884307861328125  GigaBytes

torch.Size([2362, 500])
torch.Size([604, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.19899654388427734  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.016423702239990234  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([703, 500])
torch.Size([209, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.05372762680053711  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.017422199249267578  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([731, 500])
torch.Size([145, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.058644771575927734  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.015660762786865234  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([297, 500])
torch.Size([87, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.029551029205322266  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.018735885620117188  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([1441, 500])
torch.Size([158, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.07367229461669922  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.019060134887695312  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([2101, 500])
torch.Size([425, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.16662073135375977  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.015520095825195312  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([222, 500])
torch.Size([63, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.025679588317871094  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.01560831069946289  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([269, 500])
torch.Size([53, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.027332305908203125  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.016153335571289062  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([559, 500])
torch.Size([119, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.046212196350097656  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002207771937052409 |0.024053414662679035 |0.10751005808512369 |0.00012784004211425782 |0.11109989484151205 |0.009361982345581055 |
----------------------------------------------------------pseudo_mini_loss sum 1.7342922687530518
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  18007
Number of first layer input nodes during this epoch:  14542
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.0312652587890625  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005061626434326172
range selection method range initialization spend 5.364418029785156e-05
time for parepare:  6.103515625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.4557113647460938e-05
----------------------check_connections_block total spend ----------------------------- 0.0027539730072021484
generate_one_block  0.0011129379272460938
generate_one_block  0.0010352134704589844
generate_one_block  0.0010373592376708984
generate_one_block  0.001009225845336914
generate_one_block  0.0010204315185546875
generate_one_block  0.0010194778442382812
generate_one_block  0.001010894775390625
generate_one_block  0.0011539459228515625
generate_one_block  0.0010280609130859375
generate_one_block  0.0010328292846679688
generate_one_block  0.0010263919830322266
generate_one_block  0.0010209083557128906
generate_one_block  0.001028299331665039
generate_one_block  0.0010097026824951172
generate_one_block  0.0010170936584472656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006513595581054688
gen group dst list time:  8.0108642578125e-05
time for parepare:  0.000270843505859375
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.000102996826171875
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  9.226799011230469e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.082389831542969e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.340576171875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00016951560974121094
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  6.890296936035156e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.153915405273438e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00012946128845214844
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0001327991485595703
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.557868957519531e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00015664100646972656
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.915496826171875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00010156631469726562
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00012421607971191406
----------------------check_connections_block total spend ----------------------------- 0.004759073257446289
generate_one_block  0.0011625289916992188
generate_one_block  0.0011241436004638672
generate_one_block  0.001111745834350586
generate_one_block  0.0010879039764404297
generate_one_block  0.0013377666473388672
generate_one_block  0.001100301742553711
generate_one_block  0.0011286735534667969
generate_one_block  0.001186370849609375
generate_one_block  0.0011413097381591797
generate_one_block  0.0010631084442138672
generate_one_block  0.0010457038879394531
generate_one_block  0.001186370849609375
generate_one_block  0.0010695457458496094
generate_one_block  0.0011093616485595703
generate_one_block  0.0011262893676757812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001117706298828125
gen group dst list time:  0.00013113021850585938
time for parepare:  0.0007801055908203125
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0002872943878173828
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.00042819976806640625
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.0006251335144042969
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.000499725341796875
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0004107952117919922
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.00015783309936523438
r_  generation:  0.0012013912200927734
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.00029778480529785156
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0004239082336425781
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.0007753372192382812
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0007352828979492188
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.00038695335388183594
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0002644062042236328
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.001154184341430664
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.00040030479431152344
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0006172657012939453
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0005652904510498047
----------------------check_connections_block total spend ----------------------------- 0.01643538475036621
generate_one_block  0.0017611980438232422
generate_one_block  0.002126932144165039
generate_one_block  0.0016510486602783203
generate_one_block  0.0015392303466796875
generate_one_block  0.0025157928466796875
generate_one_block  0.0013489723205566406
generate_one_block  0.0015082359313964844
generate_one_block  0.0019817352294921875
generate_one_block  0.0019240379333496094
generate_one_block  0.0014722347259521484
generate_one_block  0.0013241767883300781
generate_one_block  0.0024428367614746094
generate_one_block  0.00148773193359375
generate_one_block  0.0018117427825927734
generate_one_block  0.001743316650390625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.0312652587890625  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

connection checking time:  0.0211944580078125
block generation total time  0.04362034797668457
average batch blocks generation time:  0.002908023198445638
block dataloader generation time/epoch 0.1374645233154297
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.031557559967041016  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([723, 500])
torch.Size([211, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.07006502151489258  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.03309345245361328  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([1544, 500])
torch.Size([180, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.09325742721557617  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.03206014633178711  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([992, 500])
torch.Size([163, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.07676935195922852  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.03197908401489258  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([711, 500])
torch.Size([115, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.06892776489257812  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.03255462646484375  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([1244, 500])
torch.Size([322, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.1587371826171875  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.031012535095214844  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([432, 500])
torch.Size([129, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.05543661117553711  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.031456947326660156  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([669, 500])
torch.Size([184, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.06797504425048828  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.032865047454833984  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([1420, 500])
torch.Size([338, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.1039724349975586  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.03270769119262695  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([1336, 500])
torch.Size([280, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.09999752044677734  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.03159379959106445  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([743, 500])
torch.Size([124, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.06464052200317383  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.03105640411376953  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([456, 500])
torch.Size([97, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.052906036376953125  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.033850669860839844  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([1424, 500])
torch.Size([335, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.15012741088867188  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.03149700164794922  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([691, 500])
torch.Size([135, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.06518220901489258  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.032228946685791016  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

torch.Size([1080, 500])
torch.Size([259, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.09046363830566406  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.0318603515625  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes
Using backend: pytorch

torch.Size([883, 500])
torch.Size([225, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.08189249038696289  GigaBytes
Max Memory Allocated: 0.21272039413452148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004794613520304362 |0.0009099801381429036 |0.07899808883666992 |0.00011749267578125 |0.11439967155456543 |0.006116628646850586 |
----------------------------------------------------------pseudo_mini_loss sum 2.100191831588745
Total (block generation + training)time/epoch 3.1584739685058594
Training time/epoch 3.0206925868988037
Training time without block to device /epoch 3.00704288482666
Training time without total dataloading part /epoch 2.9088454246520996
load block tensor time/epoch 0.07191920280456543
block to device time/epoch 0.013649702072143555
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17802
Number of first layer input nodes during this epoch:  14348
