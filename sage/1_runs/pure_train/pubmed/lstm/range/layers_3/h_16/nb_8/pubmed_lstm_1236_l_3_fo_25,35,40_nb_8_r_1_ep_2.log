main start at this time 1648529157.9130998
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.003280162811279297
range selection method range initialization spend 8.296966552734375e-05
time for parepare:  4.315376281738281e-05
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0023517608642578125
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.2901763916015625e-05
----------------------check_connections_block total spend ----------------------------- 0.003392934799194336
generate_one_block  0.0012328624725341797
generate_one_block  0.001157999038696289
generate_one_block  0.0010612010955810547
generate_one_block  0.001041412353515625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001394033432006836
gen group dst list time:  3.552436828613281e-05
time for parepare:  0.0002353191375732422
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0003821849822998047
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0004324913024902344
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0003228187561035156
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00019121170043945312
----------------------check_connections_block total spend ----------------------------- 0.0027849674224853516
generate_one_block  0.0015251636505126953
generate_one_block  0.0015921592712402344
generate_one_block  0.0014333724975585938
generate_one_block  0.0012383460998535156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010139942169189453
gen group dst list time:  7.462501525878906e-05
time for parepare:  0.000743865966796875
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00031757354736328125
mini_batch_src_global generation:  0.0001742839813232422
r_  generation:  0.0020508766174316406
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.00024056434631347656
mini_batch_src_global generation:  0.00033545494079589844
r_  generation:  0.0025365352630615234
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  0.0002262592315673828
r_  generation:  0.0021390914916992188
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.0003998279571533203
mini_batch_src_global generation:  0.00013685226440429688
r_  generation:  0.0009481906890869141
----------------------check_connections_block total spend ----------------------------- 0.01263117790222168
generate_one_block  0.0038352012634277344
generate_one_block  0.004179239273071289
generate_one_block  0.003670215606689453
generate_one_block  0.0020287036895751953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.015416145324707031
block generation total time  0.01950240135192871
average batch blocks generation time:  0.004875600337982178
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014134883880615234  GigaBytes
Max Memory Allocated: 0.014134883880615234  GigaBytes

torch.Size([3502, 500])
torch.Size([830, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.20932483673095703  GigaBytes
Max Memory Allocated: 0.22315502166748047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.02249908447265625  GigaBytes
Max Memory Allocated: 0.22315502166748047  GigaBytes

torch.Size([3422, 500])
torch.Size([916, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.26961421966552734  GigaBytes
Max Memory Allocated: 0.28801488876342773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.022635459899902344  GigaBytes
Max Memory Allocated: 0.28801488876342773  GigaBytes

torch.Size([3172, 500])
torch.Size([717, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.23038959503173828  GigaBytes
Max Memory Allocated: 0.28801488876342773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.019198894500732422  GigaBytes
Max Memory Allocated: 0.28801488876342773  GigaBytes

torch.Size([1676, 500])
torch.Size([363, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.10370254516601562  GigaBytes
Max Memory Allocated: 0.28801488876342773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0023467540740966797 |0.08581262826919556 |0.22593361139297485 |0.0001488327980041504 |0.12870943546295166 |0.010496139526367188 |
----------------------------------------------------------pseudo_mini_loss sum 1.8038727045059204
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14955
Number of first layer input nodes during this epoch:  11772
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.03433084487915039  GigaBytes
Max Memory Allocated: 0.28801488876342773  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004963874816894531
range selection method range initialization spend 4.9591064453125e-05
time for parepare:  4.887580871582031e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00010704994201660156
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.363059997558594e-05
----------------------check_connections_block total spend ----------------------------- 0.0011119842529296875
generate_one_block  0.0011439323425292969
generate_one_block  0.0011146068572998047
generate_one_block  0.0010919570922851562
generate_one_block  0.0010819435119628906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005261898040771484
gen group dst list time:  3.266334533691406e-05
time for parepare:  0.00024056434631347656
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00021648406982421875
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0003879070281982422
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.00027680397033691406
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0003833770751953125
----------------------check_connections_block total spend ----------------------------- 0.0028028488159179688
generate_one_block  0.0013663768768310547
generate_one_block  0.0015769004821777344
generate_one_block  0.0016758441925048828
generate_one_block  0.0015745162963867188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009419918060302734
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.0006551742553710938
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.000293731689453125
mini_batch_src_global generation:  0.0001418590545654297
r_  generation:  0.0013682842254638672
local_output_nid generation:  8.463859558105469e-05
local_in_edges_tensor generation:  0.00023055076599121094
mini_batch_src_global generation:  0.00029754638671875
r_  generation:  0.0023393630981445312
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.00017023086547851562
r_  generation:  0.0014111995697021484
local_output_nid generation:  8.511543273925781e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  0.00020885467529296875
r_  generation:  0.002304553985595703
----------------------check_connections_block total spend ----------------------------- 0.01217341423034668
generate_one_block  0.0031418800354003906
generate_one_block  0.003950357437133789
generate_one_block  0.0028488636016845703
generate_one_block  0.004701852798461914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.03433084487915039  GigaBytes
Max Memory Allocated: 0.28801488876342773  GigaBytes

connection checking time:  0.014976263046264648
block generation total time  0.020836591720581055
average batch blocks generation time:  0.005209147930145264
block dataloader generation time/epoch 0.06724929809570312
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.036260128021240234  GigaBytes
Max Memory Allocated: 0.28801488876342773  GigaBytes

torch.Size([2724, 500])
torch.Size([526, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.16917753219604492  GigaBytes
Max Memory Allocated: 0.28801488876342773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.03698158264160156  GigaBytes
Max Memory Allocated: 0.28801488876342773  GigaBytes

torch.Size([3095, 500])
torch.Size([857, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5545654296875 GB
    Memory Allocated: 0.26561975479125977  GigaBytes
Max Memory Allocated: 0.28801488876342773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5545654296875 GB
    Memory Allocated: 0.03626108169555664  GigaBytes
Max Memory Allocated: 0.28801488876342773  GigaBytes

torch.Size([2591, 500])
torch.Size([565, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5545654296875 GB
    Memory Allocated: 0.1683497428894043  GigaBytes
Max Memory Allocated: 0.28801488876342773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5545654296875 GB
    Memory Allocated: 0.03822183609008789  GigaBytes
Max Memory Allocated: 0.28801488876342773  GigaBytes

torch.Size([3375, 500])
torch.Size([851, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5545654296875 GB
    Memory Allocated: 0.26416730880737305  GigaBytes
Max Memory Allocated: 0.28801488876342773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00414121150970459 |0.0007660388946533203 |0.10544860363006592 |0.0001252889633178711 |0.12428861856460571 |0.010193347930908203 |
----------------------------------------------------------pseudo_mini_loss sum 1.6878225803375244
Total (block generation + training)time/epoch 1.024486780166626
Training time/epoch 0.9569530487060547
Training time without block to device /epoch 0.9538888931274414
Training time without total dataloading part /epoch 0.9296433925628662
load block tensor time/epoch 0.01656484603881836
block to device time/epoch 0.0030641555786132812
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14940
Number of first layer input nodes during this epoch:  11785
