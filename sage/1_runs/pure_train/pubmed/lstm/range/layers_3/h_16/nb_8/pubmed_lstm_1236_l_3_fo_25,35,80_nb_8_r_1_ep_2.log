main start at this time 1648529219.2588334
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010874271392822266
range selection method range initialization spend 0.00010418891906738281
time for parepare:  4.363059997558594e-05
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0012159347534179688
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  5.2928924560546875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.1948089599609375e-05
----------------------check_connections_block total spend ----------------------------- 0.0022513866424560547
generate_one_block  0.0012335777282714844
generate_one_block  0.001195669174194336
generate_one_block  0.0010902881622314453
generate_one_block  0.0010707378387451172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007326602935791016
gen group dst list time:  3.4809112548828125e-05
time for parepare:  0.00024366378784179688
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003654956817626953
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0004513263702392578
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0003285408020019531
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00019741058349609375
----------------------check_connections_block total spend ----------------------------- 0.0028073787689208984
generate_one_block  0.0015664100646972656
generate_one_block  0.0016298294067382812
generate_one_block  0.0014712810516357422
generate_one_block  0.0012698173522949219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009980201721191406
gen group dst list time:  7.700920104980469e-05
time for parepare:  0.0007817745208740234
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.0003123283386230469
mini_batch_src_global generation:  0.00017070770263671875
r_  generation:  0.002126455307006836
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.0002391338348388672
mini_batch_src_global generation:  0.0002613067626953125
r_  generation:  0.002573251724243164
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.00021839141845703125
mini_batch_src_global generation:  0.00022673606872558594
r_  generation:  0.002212047576904297
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00040030479431152344
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.0009768009185791016
----------------------check_connections_block total spend ----------------------------- 0.012790918350219727
generate_one_block  0.004069805145263672
generate_one_block  0.003985881805419922
generate_one_block  0.003593921661376953
generate_one_block  0.0020232200622558594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.015598297119140625
block generation total time  0.019610166549682617
average batch blocks generation time:  0.004902541637420654
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014173030853271484  GigaBytes
Max Memory Allocated: 0.014173030853271484  GigaBytes

torch.Size([3523, 500])
torch.Size([830, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.20851802825927734  GigaBytes
Max Memory Allocated: 0.22225522994995117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.022492408752441406  GigaBytes
Max Memory Allocated: 0.22225522994995117  GigaBytes

torch.Size([3419, 500])
torch.Size([917, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.26474809646606445  GigaBytes
Max Memory Allocated: 0.28266000747680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.022674560546875  GigaBytes
Max Memory Allocated: 0.28266000747680664  GigaBytes

torch.Size([3164, 500])
torch.Size([718, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.23004722595214844  GigaBytes
Max Memory Allocated: 0.28266000747680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.019210338592529297  GigaBytes
Max Memory Allocated: 0.28266000747680664  GigaBytes

torch.Size([1682, 500])
torch.Size([363, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.10367488861083984  GigaBytes
Max Memory Allocated: 0.28266000747680664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0023977160453796387 |0.08691960573196411 |0.22751784324645996 |0.00015419721603393555 |0.1262146234512329 |0.010152816772460938 |
----------------------------------------------------------pseudo_mini_loss sum 1.7941029071807861
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14973
Number of first layer input nodes during this epoch:  11788
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.034342288970947266  GigaBytes
Max Memory Allocated: 0.28266000747680664  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005466938018798828
range selection method range initialization spend 5.8650970458984375e-05
time for parepare:  5.7220458984375e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00012159347534179688
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.7206878662109375e-05
----------------------check_connections_block total spend ----------------------------- 0.0012421607971191406
generate_one_block  0.0013401508331298828
generate_one_block  0.0012679100036621094
generate_one_block  0.0012812614440917969
generate_one_block  0.001291036605834961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005903244018554688
gen group dst list time:  4.00543212890625e-05
time for parepare:  0.00028705596923828125
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.0002486705780029297
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0004534721374511719
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.00032711029052734375
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.00045680999755859375
----------------------check_connections_block total spend ----------------------------- 0.003231525421142578
generate_one_block  0.0016016960144042969
generate_one_block  0.0018734931945800781
generate_one_block  0.0019991397857666016
generate_one_block  0.001857757568359375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011010169982910156
gen group dst list time:  9.417533874511719e-05
time for parepare:  0.0008199214935302734
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.0003485679626464844
mini_batch_src_global generation:  0.00019049644470214844
r_  generation:  0.001644134521484375
local_output_nid generation:  9.72747802734375e-05
local_in_edges_tensor generation:  0.000270843505859375
mini_batch_src_global generation:  0.00034809112548828125
r_  generation:  0.0027866363525390625
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  0.00020384788513183594
r_  generation:  0.001659393310546875
local_output_nid generation:  0.00010156631469726562
local_in_edges_tensor generation:  0.0002722740173339844
mini_batch_src_global generation:  0.00026154518127441406
r_  generation:  0.002737283706665039
----------------------check_connections_block total spend ----------------------------- 0.014616966247558594
generate_one_block  0.0030951499938964844
generate_one_block  0.003947257995605469
generate_one_block  0.0028259754180908203
generate_one_block  0.004083395004272461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.034342288970947266  GigaBytes
Max Memory Allocated: 0.28266000747680664  GigaBytes

connection checking time:  0.017848491668701172
block generation total time  0.021283864974975586
average batch blocks generation time:  0.0053209662437438965
block dataloader generation time/epoch 0.07264161109924316
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.03634214401245117  GigaBytes
Max Memory Allocated: 0.28266000747680664  GigaBytes

torch.Size([2768, 500])
torch.Size([527, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.17039108276367188  GigaBytes
Max Memory Allocated: 0.28266000747680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.036966800689697266  GigaBytes
Max Memory Allocated: 0.28266000747680664  GigaBytes

torch.Size([3087, 500])
torch.Size([859, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5526123046875 GB
    Memory Allocated: 0.26543235778808594  GigaBytes
Max Memory Allocated: 0.28266000747680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5526123046875 GB
    Memory Allocated: 0.03634309768676758  GigaBytes
Max Memory Allocated: 0.28266000747680664  GigaBytes

torch.Size([2589, 500])
torch.Size([565, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5526123046875 GB
    Memory Allocated: 0.16842031478881836  GigaBytes
Max Memory Allocated: 0.28266000747680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5526123046875 GB
    Memory Allocated: 0.03813982009887695  GigaBytes
Max Memory Allocated: 0.28266000747680664  GigaBytes

torch.Size([3401, 500])
torch.Size([849, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5545654296875 GB
    Memory Allocated: 0.26680612564086914  GigaBytes
Max Memory Allocated: 0.28278303146362305  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004267394542694092 |0.0009021162986755371 |0.10559117794036865 |0.00012540817260742188 |0.1234164834022522 |0.00944828987121582 |
----------------------------------------------------------pseudo_mini_loss sum 1.7755292654037476
Total (block generation + training)time/epoch 1.0277791023254395
Training time/epoch 0.9548490047454834
Training time without block to device /epoch 0.9512405395507812
Training time without total dataloading part /epoch 0.9259805679321289
load block tensor time/epoch 0.017069578170776367
block to device time/epoch 0.0036084651947021484
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15001
Number of first layer input nodes during this epoch:  11845
