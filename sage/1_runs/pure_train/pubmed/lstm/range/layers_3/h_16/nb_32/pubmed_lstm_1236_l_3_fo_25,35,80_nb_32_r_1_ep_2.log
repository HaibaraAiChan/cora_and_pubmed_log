main start at this time 1648529243.4056606
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018982887268066406
range selection method range initialization spend 9.1552734375e-05
time for parepare:  3.910064697265625e-05
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  0.0010800361633300781
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.678436279296875e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.630752563476562e-05
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  8.392333984375e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.487701416015625e-05
mini_batch_src_global generation:  1.2636184692382812e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.487701416015625e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.463859558105469e-05
mini_batch_src_global generation:  1.2159347534179688e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.440017700195312e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.273124694824219e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.535385131835938e-05
mini_batch_src_global generation:  1.2159347534179688e-05
r_  generation:  1.33514404296875e-05
----------------------check_connections_block total spend ----------------------------- 0.0036215782165527344
generate_one_block  0.0011296272277832031
generate_one_block  0.0009560585021972656
generate_one_block  0.0009603500366210938
generate_one_block  0.0009326934814453125
generate_one_block  0.0009429454803466797
generate_one_block  0.0009417533874511719
generate_one_block  0.0009958744049072266
generate_one_block  0.0009737014770507812
generate_one_block  0.0009326934814453125
generate_one_block  0.0009391307830810547
generate_one_block  0.0009815692901611328
generate_one_block  0.0009510517120361328
generate_one_block  0.0009279251098632812
generate_one_block  0.0009405612945556641
generate_one_block  0.0009322166442871094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010309219360351562
gen group dst list time:  7.414817810058594e-05
time for parepare:  0.0002238750457763672
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00014066696166992188
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  9.918212890625e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.125999450683594e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00024366378784179688
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  7.557868957519531e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  5.459785461425781e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00018215179443359375
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  5.7697296142578125e-05
----------------------check_connections_block total spend ----------------------------- 0.004218578338623047
generate_one_block  0.0010399818420410156
generate_one_block  0.0010440349578857422
generate_one_block  0.0011267662048339844
generate_one_block  0.0010552406311035156
generate_one_block  0.0010623931884765625
generate_one_block  0.0009777545928955078
generate_one_block  0.0013153553009033203
generate_one_block  0.0010290145874023438
generate_one_block  0.0010554790496826172
generate_one_block  0.0009691715240478516
generate_one_block  0.0009932518005371094
generate_one_block  0.0011870861053466797
generate_one_block  0.0009603500366210938
generate_one_block  0.0009567737579345703
generate_one_block  0.0010466575622558594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011250972747802734
gen group dst list time:  0.0001125335693359375
time for parepare:  0.0006687641143798828
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00026106834411621094
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.00029087066650390625
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00040435791015625
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0008542537689208984
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0005295276641845703
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.000469207763671875
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0002307891845703125
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  0.000141143798828125
r_  generation:  0.001577138900756836
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.000377655029296875
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0004088878631591797
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0001678466796875
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0003848075866699219
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0012199878692626953
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00014400482177734375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0001323223114013672
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00030493736267089844
----------------------check_connections_block total spend ----------------------------- 0.013704061508178711
generate_one_block  0.0014584064483642578
generate_one_block  0.0014569759368896484
generate_one_block  0.002152681350708008
generate_one_block  0.0016241073608398438
generate_one_block  0.0015988349914550781
generate_one_block  0.0012614727020263672
generate_one_block  0.0030601024627685547
generate_one_block  0.0013818740844726562
generate_one_block  0.0014412403106689453
generate_one_block  0.001119375228881836
generate_one_block  0.0014777183532714844
generate_one_block  0.0025527477264404297
generate_one_block  0.0010721683502197266
generate_one_block  0.0013709068298339844
generate_one_block  0.0012996196746826172
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

connection checking time:  0.017922639846801758
block generation total time  0.04014754295349121
average batch blocks generation time:  0.002676502863566081
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.008529186248779297  GigaBytes
Max Memory Allocated: 0.008529186248779297  GigaBytes

torch.Size([519, 500])
torch.Size([150, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.03654670715332031  GigaBytes
Max Memory Allocated: 0.03853130340576172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.017482757568359375  GigaBytes
Max Memory Allocated: 0.0513920783996582  GigaBytes

torch.Size([786, 500])
torch.Size([193, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.05580472946166992  GigaBytes
Max Memory Allocated: 0.05846118927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.01957559585571289  GigaBytes
Max Memory Allocated: 0.06994390487670898  GigaBytes

torch.Size([1902, 500])
torch.Size([308, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.1077580451965332  GigaBytes
Max Memory Allocated: 0.11413908004760742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.01779937744140625  GigaBytes
Max Memory Allocated: 0.11972427368164062  GigaBytes

torch.Size([954, 500])
torch.Size([230, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.07057476043701172  GigaBytes
Max Memory Allocated: 0.11972427368164062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.01796865463256836  GigaBytes
Max Memory Allocated: 0.11972427368164062  GigaBytes

torch.Size([994, 500])
torch.Size([174, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.0652627944946289  GigaBytes
Max Memory Allocated: 0.11972427368164062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.01678752899169922  GigaBytes
Max Memory Allocated: 0.11972427368164062  GigaBytes

torch.Size([416, 500])
torch.Size([98, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03653287887573242  GigaBytes
Max Memory Allocated: 0.11972427368164062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02038288116455078  GigaBytes
Max Memory Allocated: 0.11972427368164062  GigaBytes

torch.Size([2322, 500])
torch.Size([566, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.1923980712890625  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.01727771759033203  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([677, 500])
torch.Size([180, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.05100202560424805  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.01737070083618164  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([726, 500])
torch.Size([145, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.0585932731628418  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.016564369201660156  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([297, 500])
torch.Size([87, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.030454635620117188  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.01795196533203125  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([1038, 500])
torch.Size([122, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.056987762451171875  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.019861698150634766  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([2049, 500])
torch.Size([392, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.15222454071044922  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.01641988754272461  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([220, 500])
torch.Size([63, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.02657938003540039  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.016523361206054688  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([275, 500])
torch.Size([53, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.028247356414794922  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.01706075668334961  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([561, 500])
torch.Size([119, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.0471196174621582  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002086194356282552 |0.023547983169555663 |0.10342623392740885 |0.00011771519978841146 |0.07835995356241862 |0.009137630462646484 |
----------------------------------------------------------pseudo_mini_loss sum 1.7387213706970215
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16973
Number of first layer input nodes during this epoch:  13736
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03217267990112305  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005016326904296875
range selection method range initialization spend 5.1975250244140625e-05
time for parepare:  5.698204040527344e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2411346435546875e-05
----------------------check_connections_block total spend ----------------------------- 0.002672433853149414
generate_one_block  0.0011990070343017578
generate_one_block  0.0010867118835449219
generate_one_block  0.0010845661163330078
generate_one_block  0.001088857650756836
generate_one_block  0.0010573863983154297
generate_one_block  0.001046895980834961
generate_one_block  0.0010449886322021484
generate_one_block  0.0012288093566894531
generate_one_block  0.0010669231414794922
generate_one_block  0.001058816909790039
generate_one_block  0.0010805130004882812
generate_one_block  0.0010921955108642578
generate_one_block  0.001066446304321289
generate_one_block  0.0010876655578613281
generate_one_block  0.001089334487915039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006046295166015625
gen group dst list time:  7.891654968261719e-05
time for parepare:  0.00025463104248046875
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  8.034706115722656e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.82012939453125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.462501525878906e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00016927719116210938
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  6.818771362304688e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  8.177757263183594e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0001251697540283203
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00013065338134765625
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.653236389160156e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001430511474609375
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  8.082389831542969e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  9.202957153320312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0001239776611328125
----------------------check_connections_block total spend ----------------------------- 0.004572391510009766
generate_one_block  0.001226186752319336
generate_one_block  0.0011920928955078125
generate_one_block  0.0011930465698242188
generate_one_block  0.0011701583862304688
generate_one_block  0.001390218734741211
generate_one_block  0.0011410713195800781
generate_one_block  0.0011959075927734375
generate_one_block  0.0012214183807373047
generate_one_block  0.0011713504791259766
generate_one_block  0.0010900497436523438
generate_one_block  0.001081705093383789
generate_one_block  0.0012009143829345703
generate_one_block  0.001104116439819336
generate_one_block  0.0011441707611083984
generate_one_block  0.0011587142944335938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011403560638427734
gen group dst list time:  0.0001327991485595703
time for parepare:  0.0007987022399902344
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00028324127197265625
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.00037860870361328125
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.00045871734619140625
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.00044655799865722656
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0002799034118652344
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  0.00014090538024902344
r_  generation:  0.0011599063873291016
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0003218650817871094
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0004150867462158203
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.000720977783203125
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0007302761077880859
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0004119873046875
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0002713203430175781
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0010247230529785156
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0003974437713623047
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0005707740783691406
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0005567073822021484
----------------------check_connections_block total spend ----------------------------- 0.01549530029296875
generate_one_block  0.0016665458679199219
generate_one_block  0.0018186569213867188
generate_one_block  0.0016109943389892578
generate_one_block  0.0013895034790039062
generate_one_block  0.002501964569091797
generate_one_block  0.0013663768768310547
generate_one_block  0.0015490055084228516
generate_one_block  0.0019347667694091797
generate_one_block  0.0019402503967285156
generate_one_block  0.0014882087707519531
generate_one_block  0.0013353824615478516
generate_one_block  0.0023000240325927734
generate_one_block  0.0014934539794921875
generate_one_block  0.0017774105072021484
generate_one_block  0.0017511844635009766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03217267990112305  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

connection checking time:  0.020067691802978516
block generation total time  0.04360485076904297
average batch blocks generation time:  0.002906990051269531
block dataloader generation time/epoch 0.13152170181274414
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03234529495239258  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([662, 500])
torch.Size([183, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.0662527084350586  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03320598602294922  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([1122, 500])
torch.Size([143, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.0756373405456543  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.033654212951660156  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([949, 500])
torch.Size([137, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.07359647750854492  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.0321202278137207  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([542, 500])
torch.Size([81, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.05640125274658203  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03345060348510742  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([1241, 500])
torch.Size([307, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.15431690216064453  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03191423416137695  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([431, 500])
torch.Size([129, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.05633831024169922  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.032367706298828125  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([673, 500])
torch.Size([184, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.0688486099243164  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.033652305603027344  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([1358, 500])
torch.Size([313, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.10062122344970703  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03360748291015625  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([1334, 500])
torch.Size([280, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.10089731216430664  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03249549865722656  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([742, 500])
torch.Size([124, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.06554222106933594  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03195810317993164  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([455, 500])
torch.Size([97, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.053807735443115234  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03361797332763672  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([1334, 500])
torch.Size([303, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.13626432418823242  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.032405853271484375  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([694, 500])
torch.Size([134, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.06582403182983398  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.032975196838378906  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([996, 500])
torch.Size([230, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.08643007278442383  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03277111053466797  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes

torch.Size([887, 500])
torch.Size([225, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.08280324935913086  GigaBytes
Max Memory Allocated: 0.2057352066040039  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0034789244333902993 |0.0008491039276123047 |0.07352291742960612 |0.00011477470397949218 |0.08287836710611979 |0.008492469787597656 |
----------------------------------------------------------pseudo_mini_loss sum 2.1354329586029053
Total (block generation + training)time/epoch 2.5794787406921387
Training time/epoch 2.447730302810669
Training time without block to device /epoch 2.4349937438964844
Training time without total dataloading part /epoch 2.3562333583831787
load block tensor time/epoch 0.05218386650085449
block to device time/epoch 0.01273655891418457
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16647
Number of first layer input nodes during this epoch:  13420
