main start at this time 1648529728.1374087
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0026187896728515625
range selection method range initialization spend 0.0001163482666015625
time for parepare:  4.2438507080078125e-05
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.002335786819458008
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.9591064453125e-05
----------------------check_connections_block total spend ----------------------------- 0.003348827362060547
generate_one_block  0.001294851303100586
generate_one_block  0.001112222671508789
generate_one_block  0.0010161399841308594
generate_one_block  0.0010983943939208984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012447834014892578
gen group dst list time:  3.4809112548828125e-05
time for parepare:  0.0002307891845703125
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0003132820129394531
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0002071857452392578
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00029015541076660156
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.0004813671112060547
----------------------check_connections_block total spend ----------------------------- 0.0027074813842773438
generate_one_block  0.0014176368713378906
generate_one_block  0.001280069351196289
generate_one_block  0.0014069080352783203
generate_one_block  0.0016238689422607422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010285377502441406
gen group dst list time:  6.985664367675781e-05
time for parepare:  0.0007953643798828125
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.00031685829162597656
mini_batch_src_global generation:  0.00015735626220703125
r_  generation:  0.0017235279083251953
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  0.00016880035400390625
r_  generation:  0.0013308525085449219
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.00016021728515625
r_  generation:  0.0016546249389648438
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.0004782676696777344
mini_batch_src_global generation:  0.0002560615539550781
r_  generation:  0.002674102783203125
----------------------check_connections_block total spend ----------------------------- 0.012317419052124023
generate_one_block  0.003400564193725586
generate_one_block  0.0026345252990722656
generate_one_block  0.0030155181884765625
generate_one_block  0.004320621490478516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

connection checking time:  0.015024900436401367
block generation total time  0.019099712371826172
average batch blocks generation time:  0.004774928092956543
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.012215614318847656  GigaBytes
Max Memory Allocated: 0.012215614318847656  GigaBytes

torch.Size([2239, 500])
torch.Size([546, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.19522571563720703  GigaBytes
Max Memory Allocated: 0.2073836326599121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.020674705505371094  GigaBytes
Max Memory Allocated: 0.2073836326599121  GigaBytes

torch.Size([2501, 500])
torch.Size([540, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.1453533172607422  GigaBytes
Max Memory Allocated: 0.2073836326599121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.021311283111572266  GigaBytes
Max Memory Allocated: 0.2073836326599121  GigaBytes

torch.Size([2837, 500])
torch.Size([688, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.18120145797729492  GigaBytes
Max Memory Allocated: 0.2073836326599121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.02353382110595703  GigaBytes
Max Memory Allocated: 0.2073836326599121  GigaBytes

torch.Size([4013, 500])
torch.Size([1017, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.2891530990600586  GigaBytes
Max Memory Allocated: 0.3037114143371582  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0030918121337890625 |0.08684366941452026 |0.226986825466156 |0.0001621246337890625 |0.12289047241210938 |0.008486270904541016 |
----------------------------------------------------------pseudo_mini_loss sum 1.5701764822006226
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14737
Number of first layer input nodes during this epoch:  11590
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.041031837463378906  GigaBytes
Max Memory Allocated: 0.3037114143371582  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004937648773193359
range selection method range initialization spend 5.078315734863281e-05
time for parepare:  4.863739013671875e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00010633468627929688
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.838539123535156e-05
----------------------check_connections_block total spend ----------------------------- 0.0011034011840820312
generate_one_block  0.0011513233184814453
generate_one_block  0.001071929931640625
generate_one_block  0.0013642311096191406
generate_one_block  0.0010538101196289062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005247592926025391
gen group dst list time:  3.337860107421875e-05
time for parepare:  0.00023055076599121094
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0003399848937988281
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00024008750915527344
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00019598007202148438
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.00047206878662109375
----------------------check_connections_block total spend ----------------------------- 0.0027616024017333984
generate_one_block  0.0014958381652832031
generate_one_block  0.0013384819030761719
generate_one_block  0.001293182373046875
generate_one_block  0.0016999244689941406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009348392486572266
gen group dst list time:  7.390975952148438e-05
time for parepare:  0.0006670951843261719
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.0003185272216796875
mini_batch_src_global generation:  0.00017118453979492188
r_  generation:  0.0017464160919189453
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.00017523765563964844
r_  generation:  0.0012981891632080078
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  0.00013399124145507812
r_  generation:  0.0011875629425048828
local_output_nid generation:  9.250640869140625e-05
local_in_edges_tensor generation:  0.00024700164794921875
mini_batch_src_global generation:  0.0002999305725097656
r_  generation:  0.002956390380859375
----------------------check_connections_block total spend ----------------------------- 0.011876583099365234
generate_one_block  0.0036535263061523438
generate_one_block  0.0026853084564208984
generate_one_block  0.002383708953857422
generate_one_block  0.004807472229003906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.041031837463378906  GigaBytes
Max Memory Allocated: 0.3037114143371582  GigaBytes

connection checking time:  0.014638185501098633
block generation total time  0.01935744285583496
average batch blocks generation time:  0.00483936071395874
block dataloader generation time/epoch 0.06142544746398926
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.039508819580078125  GigaBytes
Max Memory Allocated: 0.3037114143371582  GigaBytes

torch.Size([3266, 500])
torch.Size([716, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.20818281173706055  GigaBytes
Max Memory Allocated: 0.3037114143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.03760862350463867  GigaBytes
Max Memory Allocated: 0.3037114143371582  GigaBytes

torch.Size([2254, 500])
torch.Size([583, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.15394353866577148  GigaBytes
Max Memory Allocated: 0.3037114143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.03720808029174805  GigaBytes
Max Memory Allocated: 0.3037114143371582  GigaBytes

torch.Size([2040, 500])
torch.Size([422, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.14516353607177734  GigaBytes
Max Memory Allocated: 0.3037114143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.03957223892211914  GigaBytes
Max Memory Allocated: 0.3037114143371582  GigaBytes

torch.Size([3279, 500])
torch.Size([1000, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.34488773345947266  GigaBytes
Max Memory Allocated: 0.3628726005554199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004193365573883057 |0.0007728934288024902 |0.1090812087059021 |0.00012415647506713867 |0.1232418417930603 |0.009177207946777344 |
----------------------------------------------------------pseudo_mini_loss sum 1.675947666168213
Total (block generation + training)time/epoch 1.0282783508300781
Training time/epoch 0.9665365219116211
Training time without block to device /epoch 0.9634449481964111
Training time without total dataloading part /epoch 0.9389660358428955
load block tensor time/epoch 0.016773462295532227
block to device time/epoch 0.003091573715209961
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13916
Number of first layer input nodes during this epoch:  10839
