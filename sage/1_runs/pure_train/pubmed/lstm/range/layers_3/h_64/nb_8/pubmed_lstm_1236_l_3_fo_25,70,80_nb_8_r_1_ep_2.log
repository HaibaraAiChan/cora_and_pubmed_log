main start at this time 1648529790.611396
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002531766891479492
range selection method range initialization spend 8.0108642578125e-05
time for parepare:  4.3392181396484375e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00263214111328125
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  6.246566772460938e-05
----------------------check_connections_block total spend ----------------------------- 0.0036652088165283203
generate_one_block  0.0012218952178955078
generate_one_block  0.0011050701141357422
generate_one_block  0.0010416507720947266
generate_one_block  0.0010619163513183594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011241436004638672
gen group dst list time:  5.5789947509765625e-05
time for parepare:  0.00023651123046875
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00034618377685546875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0002410411834716797
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0003311634063720703
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0004620552062988281
----------------------check_connections_block total spend ----------------------------- 0.0028295516967773438
generate_one_block  0.0013959407806396484
generate_one_block  0.001355886459350586
generate_one_block  0.001455545425415039
generate_one_block  0.0016319751739501953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010402202606201172
gen group dst list time:  7.367134094238281e-05
time for parepare:  0.0007300376892089844
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00028824806213378906
mini_batch_src_global generation:  0.00016427040100097656
r_  generation:  0.0018277168273925781
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  0.00017118453979492188
r_  generation:  0.0015039443969726562
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  0.000186920166015625
r_  generation:  0.0018970966339111328
local_output_nid generation:  8.320808410644531e-05
local_in_edges_tensor generation:  0.0004553794860839844
mini_batch_src_global generation:  0.0002684593200683594
r_  generation:  0.0028600692749023438
----------------------check_connections_block total spend ----------------------------- 0.013167858123779297
generate_one_block  0.003389120101928711
generate_one_block  0.002867460250854492
generate_one_block  0.0032455921173095703
generate_one_block  0.004487037658691406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

connection checking time:  0.01599740982055664
block generation total time  0.01982855796813965
average batch blocks generation time:  0.004957139492034912
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.012278556823730469  GigaBytes
Max Memory Allocated: 0.012278556823730469  GigaBytes

torch.Size([2272, 500])
torch.Size([561, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.20084095001220703  GigaBytes
Max Memory Allocated: 0.2118988037109375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.022640705108642578  GigaBytes
Max Memory Allocated: 0.2118988037109375  GigaBytes

torch.Size([2896, 500])
torch.Size([627, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.16852045059204102  GigaBytes
Max Memory Allocated: 0.2118988037109375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02219533920288086  GigaBytes
Max Memory Allocated: 0.2118988037109375  GigaBytes

torch.Size([3095, 500])
torch.Size([775, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.20490312576293945  GigaBytes
Max Memory Allocated: 0.2145400047302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02412128448486328  GigaBytes
Max Memory Allocated: 0.2145400047302246  GigaBytes

torch.Size([4113, 500])
torch.Size([1052, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.3067789077758789  GigaBytes
Max Memory Allocated: 0.32177162170410156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003467082977294922 |0.08618563413619995 |0.24039322137832642 |0.00015050172805786133 |0.1567319631576538 |0.008205652236938477 |
----------------------------------------------------------pseudo_mini_loss sum 1.573744773864746
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15747
Number of first layer input nodes during this epoch:  12376
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.04070854187011719  GigaBytes
Max Memory Allocated: 0.32177162170410156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005240440368652344
range selection method range initialization spend 4.935264587402344e-05
time for parepare:  5.2928924560546875e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  5.602836608886719e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  Using backend: pytorch
0.00011014938354492188
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.9577484130859375e-05
----------------------check_connections_block total spend ----------------------------- 0.0011692047119140625
generate_one_block  0.001219034194946289
generate_one_block  0.001096487045288086
generate_one_block  0.001070261001586914
generate_one_block  0.0010764598846435547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005562305450439453
gen group dst list time:  3.361701965332031e-05
time for parepare:  0.0002665519714355469
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00037670135498046875
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.00025844573974609375
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0001995563507080078
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0005345344543457031
----------------------check_connections_block total spend ----------------------------- 0.0030050277709960938
generate_one_block  0.0015871524810791016
generate_one_block  0.0014111995697021484
generate_one_block  0.0016214847564697266
generate_one_block  0.0018346309661865234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001004934310913086
gen group dst list time:  8.392333984375e-05
time for parepare:  0.0007033348083496094
local_output_nid generation:  8.392333984375e-05
local_in_edges_tensor generation:  0.0003192424774169922
mini_batch_src_global generation:  0.00018715858459472656
r_  generation:  0.001990079879760742
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.0001971721649169922
r_  generation:  0.0013425350189208984
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  0.00013875961303710938
r_  generation:  0.0011675357818603516
local_output_nid generation:  0.00010848045349121094
local_in_edges_tensor generation:  0.00026416778564453125
mini_batch_src_global generation:  0.0003218650817871094
r_  generation:  0.003202199935913086
----------------------check_connections_block total spend ----------------------------- 0.012813806533813477
generate_one_block  0.0039920806884765625
generate_one_block  0.002672910690307617
generate_one_block  0.0024139881134033203
generate_one_block  0.00513458251953125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.04070854187011719  GigaBytes
Max Memory Allocated: 0.32177162170410156  GigaBytes

connection checking time:  0.01581883430480957
block generation total time  0.02066802978515625
average batch blocks generation time:  0.0051670074462890625
block dataloader generation time/epoch 0.0695347785949707
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.03972578048706055  GigaBytes
Max Memory Allocated: 0.32177162170410156  GigaBytes

torch.Size([3658, 500])
torch.Size([783, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.22835016250610352  GigaBytes
Max Memory Allocated: 0.32177162170410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.0379486083984375  GigaBytes
Max Memory Allocated: 0.32177162170410156  GigaBytes

torch.Size([2322, 500])
torch.Size([610, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.15737628936767578  GigaBytes
Max Memory Allocated: 0.32177162170410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.03672361373901367  GigaBytes
Max Memory Allocated: 0.32177162170410156  GigaBytes

torch.Size([2058, 500])
torch.Size([422, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.14475250244140625  GigaBytes
Max Memory Allocated: 0.32177162170410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.039310455322265625  GigaBytes
Max Memory Allocated: 0.32177162170410156  GigaBytes

torch.Size([3412, 500])
torch.Size([1106, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.36940431594848633  GigaBytes
Max Memory Allocated: 0.3886561393737793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00367051362991333 |0.0008224844932556152 |0.1230660080909729 |0.00012481212615966797 |0.16196471452713013 |0.00671696662902832 |
----------------------------------------------------------pseudo_mini_loss sum 1.6992477178573608
Total (block generation + training)time/epoch 1.2434072494506836
Training time/epoch 1.173581838607788
Training time without block to device /epoch 1.1702919006347656
Training time without total dataloading part /epoch 1.147339105606079
load block tensor time/epoch 0.01468205451965332
block to device time/epoch 0.003289937973022461
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14727
Number of first layer input nodes during this epoch:  11450
