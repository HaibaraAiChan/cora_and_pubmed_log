main start at this time 1648529855.109473
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018053054809570312
range selection method range initialization spend 8.225440979003906e-05
time for parepare:  4.458427429199219e-05
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0011858940124511719
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.650520324707031e-05
----------------------check_connections_block total spend ----------------------------- 0.0022246837615966797
generate_one_block  0.001219034194946289
generate_one_block  0.0011353492736816406
generate_one_block  0.0010592937469482422
generate_one_block  0.0011005401611328125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010068416595458984
gen group dst list time:  3.528594970703125e-05
time for parepare:  0.0002524852752685547
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0003075599670410156
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.00024247169494628906
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0003390312194824219
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00048828125
----------------------check_connections_block total spend ----------------------------- 0.0028662681579589844
generate_one_block  0.0014662742614746094
generate_one_block  0.0013675689697265625
generate_one_block  0.0014736652374267578
generate_one_block  0.0016870498657226562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011491775512695312
gen group dst list time:  7.62939453125e-05
time for parepare:  0.0008268356323242188
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.0003123283386230469
mini_batch_src_global generation:  0.00020432472229003906
r_  generation:  0.0022077560424804688
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  0.00025653839111328125
r_  generation:  0.0018239021301269531
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  0.0002560615539550781
r_  generation:  0.0022497177124023438
local_output_nid generation:  8.511543273925781e-05
local_in_edges_tensor generation:  0.0004892349243164062
mini_batch_src_global generation:  0.0003368854522705078
r_  generation:  0.0033233165740966797
----------------------check_connections_block total spend ----------------------------- 0.015558242797851562
generate_one_block  0.003885984420776367
generate_one_block  0.0031855106353759766
generate_one_block  0.0035991668701171875
generate_one_block  0.004925966262817383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

connection checking time:  0.018424510955810547
block generation total time  0.0215911865234375
average batch blocks generation time:  0.005397796630859375
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.012868404388427734  GigaBytes
Max Memory Allocated: 0.012868404388427734  GigaBytes

torch.Size([2583, 500])
torch.Size([561, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.2396073341369629  GigaBytes
Max Memory Allocated: 0.2519350051879883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.022919654846191406  GigaBytes
Max Memory Allocated: 0.2519350051879883  GigaBytes

torch.Size([3311, 500])
torch.Size([628, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.19313335418701172  GigaBytes
Max Memory Allocated: 0.2519350051879883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.023041248321533203  GigaBytes
Max Memory Allocated: 0.2519350051879883  GigaBytes

torch.Size([3370, 500])
torch.Size([775, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.23334360122680664  GigaBytes
Max Memory Allocated: 0.2519350051879883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.025131702423095703  GigaBytes
Max Memory Allocated: 0.2519350051879883  GigaBytes

torch.Size([4475, 500])
torch.Size([1052, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.3478126525878906  GigaBytes
Max Memory Allocated: 0.36506032943725586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002992570400238037 |0.08564597368240356 |0.3101711869239807 |0.0001475214958190918 |0.2682545781135559 |0.007409572601318359 |
----------------------------------------------------------pseudo_mini_loss sum 1.567462682723999
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17111
Number of first layer input nodes during this epoch:  13739
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.04122304916381836  GigaBytes
Max Memory Allocated: 0.36506032943725586  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005497932434082031
range selection method range initialization spend 5.3882598876953125e-05
time for parepare:  5.650520324707031e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  Using backend: pytorch
0.00011539459228515625
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.124641418457031e-05
----------------------check_connections_block total spend ----------------------------- 0.0012001991271972656
generate_one_block  0.0012972354888916016
generate_one_block  0.0011816024780273438
generate_one_block  0.0011556148529052734
generate_one_block  0.0011713504791259766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005869865417480469
gen group dst list time:  3.695487976074219e-05
time for parepare:  0.0002903938293457031
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.00038123130798339844
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0002696514129638672
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0002071857452392578
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0005552768707275391
----------------------check_connections_block total spend ----------------------------- 0.0031309127807617188
generate_one_block  0.0017330646514892578
generate_one_block  0.0015420913696289062
generate_one_block  0.0017426013946533203
generate_one_block  0.001996755599975586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010917186737060547
gen group dst list time:  8.916854858398438e-05
time for parepare:  0.0007898807525634766
local_output_nid generation:  8.749961853027344e-05
local_in_edges_tensor generation:  0.0003337860107421875
mini_batch_src_global generation:  0.00020074844360351562
r_  generation:  0.0022368431091308594
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.0015420913696289062
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  0.00015211105346679688
r_  generation:  0.0013937950134277344
local_output_nid generation:  0.00012111663818359375
local_in_edges_tensor generation:  0.00028252601623535156
mini_batch_src_global generation:  0.0003960132598876953
r_  generation:  0.003798246383666992
----------------------check_connections_block total spend ----------------------------- 0.014762401580810547
generate_one_block  0.004296541213989258
generate_one_block  0.0030045509338378906
generate_one_block  0.002778768539428711
generate_one_block  0.005875825881958008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.04122304916381836  GigaBytes
Max Memory Allocated: 0.36506032943725586  GigaBytes

connection checking time:  0.017893314361572266
block generation total time  0.022970199584960938
average batch blocks generation time:  0.005742549896240234
block dataloader generation time/epoch 0.08441710472106934
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.04001140594482422  GigaBytes
Max Memory Allocated: 0.36506032943725586  GigaBytes

torch.Size([3906, 500])
torch.Size([784, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.24771690368652344  GigaBytes
Max Memory Allocated: 0.36506032943725586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.037453651428222656  GigaBytes
Max Memory Allocated: 0.36506032943725586  GigaBytes

torch.Size([2543, 500])
torch.Size([610, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.17418909072875977  GigaBytes
Max Memory Allocated: 0.36506032943725586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.03734397888183594  GigaBytes
Max Memory Allocated: 0.36506032943725586  GigaBytes

torch.Size([2368, 500])
torch.Size([422, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.16585063934326172  GigaBytes
Max Memory Allocated: 0.36506032943725586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.03962993621826172  GigaBytes
Max Memory Allocated: 0.36506032943725586  GigaBytes

torch.Size([3673, 500])
torch.Size([1105, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.41968393325805664  GigaBytes
Max Memory Allocated: 0.4404487609863281  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006504654884338379 |0.001136183738708496 |0.1860358715057373 |0.00013214349746704102 |0.26614195108413696 |0.0069849491119384766 |
----------------------------------------------------------pseudo_mini_loss sum 1.6072900295257568
Total (block generation + training)time/epoch 1.941436529159546
Training time/epoch 1.8567702770233154
Training time without block to device /epoch 1.8522255420684814
Training time without total dataloading part /epoch 1.8162248134613037
load block tensor time/epoch 0.026018619537353516
block to device time/epoch 0.004544734954833984
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15767
Number of first layer input nodes during this epoch:  12490
