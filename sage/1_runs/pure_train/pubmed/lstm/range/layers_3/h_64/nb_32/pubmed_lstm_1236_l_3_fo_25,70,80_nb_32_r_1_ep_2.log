main start at this time 1648529816.2912474
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014116764068603516
range selection method range initialization spend 9.012222290039062e-05
time for parepare:  4.506111145019531e-05
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  0.002766132354736328
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.4318695068359375e-05
----------------------check_connections_block total spend ----------------------------- 0.005639076232910156
generate_one_block  0.0013022422790527344
generate_one_block  0.0010752677917480469
generate_one_block  0.0010371208190917969
generate_one_block  0.0010287761688232422
generate_one_block  0.0010390281677246094
generate_one_block  0.0010235309600830078
generate_one_block  0.0010263919830322266
generate_one_block  0.0010840892791748047
generate_one_block  0.001024484634399414
generate_one_block  0.001055002212524414
generate_one_block  0.0010380744934082031
generate_one_block  0.001039743423461914
generate_one_block  0.001049041748046875
generate_one_block  0.0010230541229248047
generate_one_block  0.0009646415710449219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007071495056152344
gen group dst list time:  8.273124694824219e-05
time for parepare:  0.0002574920654296875
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00024700164794921875
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.079673767089844e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  8.177757263183594e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.389617919921875e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00010204315185546875
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.651878356933594e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.000118255615234375
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  0.00010418891906738281
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0001456737518310547
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0002646446228027344
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.00012135505676269531
----------------------check_connections_block total spend ----------------------------- 0.004909038543701172
generate_one_block  0.0013401508331298828
generate_one_block  0.001081705093383789
generate_one_block  0.0010957717895507812
generate_one_block  0.0011332035064697266
generate_one_block  0.0011072158813476562
generate_one_block  0.0010628700256347656
generate_one_block  0.0012142658233642578
generate_one_block  0.00118255615234375
generate_one_block  0.001047372817993164
generate_one_block  0.0010933876037597656
generate_one_block  0.001056671142578125
generate_one_block  0.0011508464813232422
generate_one_block  0.001312255859375
generate_one_block  0.0009801387786865234
generate_one_block  0.0012028217315673828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011761188507080078
gen group dst list time:  0.0001277923583984375
time for parepare:  0.0007641315460205078
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00027489662170410156
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0013921260833740234
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0002028942108154297
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0003037452697753906
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0007197856903076172
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0002837181091308594
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00016307830810546875
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0004742145538330078
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0005505084991455078
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0004572868347167969
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0006873607635498047
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.0005311965942382812
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.0007369518280029297
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  0.0001773834228515625
r_  generation:  0.0018124580383300781
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  7.462501525878906e-05
r_  generation:  0.000179290771484375
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0006203651428222656
----------------------check_connections_block total spend ----------------------------- 0.016273021697998047
generate_one_block  0.002913951873779297
generate_one_block  0.0011603832244873047
generate_one_block  0.00130462646484375
generate_one_block  0.0018699169158935547
generate_one_block  0.0012433528900146484
generate_one_block  0.001188516616821289
generate_one_block  0.001466989517211914
generate_one_block  0.0016179084777832031
generate_one_block  0.0014388561248779297
generate_one_block  0.0017206668853759766
generate_one_block  0.0015683174133300781
generate_one_block  0.0017652511596679688
generate_one_block  0.003110647201538086
generate_one_block  0.001390218734741211
generate_one_block  0.0016238689422607422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007989883422851562  GigaBytes
Max Memory Allocated: 0.007989883422851562  GigaBytes

connection checking time:  0.02118206024169922
block generation total time  0.042444705963134766
average batch blocks generation time:  0.0028296470642089843
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.010861873626708984  GigaBytes
Max Memory Allocated: 0.010861873626708984  GigaBytes

torch.Size([1519, 500])
torch.Size([382, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.1487898826599121  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.017156600952148438  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

torch.Size([329, 500])
torch.Size([61, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.03212165832519531  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.018347740173339844  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

torch.Size([607, 500])
torch.Size([76, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.0464320182800293  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.019702911376953125  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

torch.Size([1688, 500])
torch.Size([186, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.08796119689941406  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.017217159271240234  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

torch.Size([360, 500])
torch.Size([138, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.03932905197143555  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.017052173614501953  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

torch.Size([273, 500])
torch.Size([75, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.030077457427978516  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.01835155487060547  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

torch.Size([845, 500])
torch.Size([176, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.061034202575683594  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.018288135528564453  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

torch.Size([931, 500])
torch.Size([261, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.06777572631835938  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.018349647521972656  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

torch.Size([930, 500])
torch.Size([132, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.05586671829223633  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.018792152404785156  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

torch.Size([1200, 500])
torch.Size([310, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.08078432083129883  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.018352508544921875  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

torch.Size([837, 500])
torch.Size([172, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.06654596328735352  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.018778324127197266  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

torch.Size([1191, 500])
torch.Size([282, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.08632183074951172  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.02119302749633789  GigaBytes
Max Memory Allocated: 0.15883111953735352  GigaBytes

torch.Size([2471, 500])
torch.Size([553, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.19579410552978516  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.017015933990478516  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([254, 500])
torch.Size([78, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.028428077697753906  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.018455982208251953  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([1020, 500])
torch.Size([224, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.07596015930175781  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0031528472900390625 |0.02370430628458659 |0.10743950208028158 |0.0001194000244140625 |0.08540835380554199 |0.010502099990844727 |
----------------------------------------------------------pseudo_mini_loss sum 1.7500324249267578
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17918
Number of first layer input nodes during this epoch:  14455
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.03592634201049805  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005290508270263672
range selection method range initialization spend 5.602836608886719e-05
time for parepare:  6.008148193359375e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4080276489257812e-05
----------------------check_connections_block total spend ----------------------------- 0.0028738975524902344
generate_one_block  0.0011484622955322266
generate_one_block  0.0010840892791748047
generate_one_block  0.0010464191436767578
generate_one_block  0.001065969467163086
generate_one_block  0.0010590553283691406
generate_one_block  0.0010342597961425781
generate_one_block  0.001039266586303711
generate_one_block  0.0011692047119140625
generate_one_block  0.0010483264923095703
generate_one_block  0.0010333061218261719
generate_one_block  0.0010256767272949219
generate_one_block  0.0010383129119873047
generate_one_block  0.0010232925415039062
generate_one_block  0.0009665489196777344
generate_one_block  0.0010132789611816406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006873607635498047
gen group dst list time:  8.106231689453125e-05
time for parepare:  0.0002970695495605469
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00018715858459472656
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  8.821487426757812e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00012683868408203125
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00012922286987304688
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.7206878662109375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00011730194091796875
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00022339820861816406
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00021123886108398438
----------------------check_connections_block total spend ----------------------------- 0.004968166351318359
generate_one_block  0.0011222362518310547
generate_one_block  0.001294851303100586
generate_one_block  0.0011272430419921875
generate_one_block  0.0011789798736572266
generate_one_block  0.0012993812561035156
generate_one_block  0.0010728836059570312
generate_one_block  0.00112152099609375
generate_one_block  0.0010797977447509766
generate_one_block  0.0010726451873779297
generate_one_block  0.0010249614715576172
generate_one_block  0.0010104179382324219
generate_one_block  0.0011453628540039062
generate_one_block  0.001272439956665039
generate_one_block  0.00107574462890625
generate_one_block  0.0012607574462890625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011386871337890625
gen group dst list time:  0.00014019012451171875
time for parepare:  0.0008182525634765625
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.00020742416381835938
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  0.00012969970703125
r_  generation:  0.0010304450988769531
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.0006628036499023438
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.00044727325439453125
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.0007827281951904297
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00020384788513183594
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0003046989440917969
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00018310546875
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00039505958557128906
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003597736358642578
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00022792816162109375
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0007481575012207031
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.0001964569091796875
r_  generation:  0.0015027523040771484
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0004901885986328125
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.00014901161193847656
r_  generation:  0.0014505386352539062
----------------------check_connections_block total spend ----------------------------- 0.016978740692138672
generate_one_block  0.0014252662658691406
generate_one_block  0.002427816390991211
generate_one_block  0.0019254684448242188
generate_one_block  0.0015299320220947266
generate_one_block  0.0031723976135253906
generate_one_block  0.001184225082397461
generate_one_block  0.0013475418090820312
generate_one_block  0.0011947154998779297
generate_one_block  0.0014815330505371094
generate_one_block  0.0014557838439941406
generate_one_block  0.0012431144714355469
generate_one_block  0.0019526481628417969
generate_one_block  0.0028870105743408203
generate_one_block  0.0015723705291748047
generate_one_block  0.002950429916381836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.03592634201049805  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

connection checking time:  0.02194690704345703
block generation total time  0.04490947723388672
average batch blocks generation time:  0.0029939651489257813
block dataloader generation time/epoch 0.1453087329864502
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.0346074104309082  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([332, 500])
torch.Size([88, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.051679134368896484  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.03751564025878906  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([1881, 500])
torch.Size([389, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.13277244567871094  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.036859989166259766  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([1534, 500])
torch.Size([171, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.09769201278686523  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.035796165466308594  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([746, 500])
torch.Size([216, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.0732736587524414  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.036618709564208984  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([1403, 500])
torch.Size([329, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.10822105407714844  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.034522056579589844  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([286, 500])
torch.Size([60, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.04752349853515625  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.03579235076904297  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([563, 500])
torch.Size([146, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.060968875885009766  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.03456306457519531  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([308, 500])
torch.Size([79, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.048633575439453125  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.03579521179199219  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([713, 500])
torch.Size([110, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.07213354110717773  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.035893917083740234  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([801, 500])
torch.Size([94, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.06721735000610352  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.03466081619262695  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([360, 500])
torch.Size([79, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.05228137969970703  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.036246299743652344  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([1203, 500])
torch.Size([294, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.10654926300048828  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.03725910186767578  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([1734, 500])
torch.Size([453, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.188323974609375  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.035797119140625  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([720, 500])
torch.Size([141, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.07837247848510742  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.03744363784790039  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes

torch.Size([1834, 500])
torch.Size([450, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.18348169326782227  GigaBytes
Max Memory Allocated: 0.2057948112487793  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0027880350748697917 |0.0008490562438964843 |0.07507123947143554 |0.00011981328328450521 |0.09490202267964681 |0.0065152645111083984 |
----------------------------------------------------------pseudo_mini_loss sum 1.9643255472183228
Total (block generation + training)time/epoch 2.783517599105835
Training time/epoch 2.6379876136779785
Training time without block to device /epoch 2.6252517700195312
Training time without total dataloading part /epoch 2.5579113960266113
load block tensor time/epoch 0.041820526123046875
block to device time/epoch 0.012735843658447266
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17874
Number of first layer input nodes during this epoch:  14418
