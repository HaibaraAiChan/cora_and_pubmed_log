main start at this time 1648529948.3049157
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002718687057495117
range selection method range initialization spend 0.000102996826171875
time for parepare:  4.267692565917969e-05
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.0011441707611083984
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.1920928955078125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.239776611328125e-05
----------------------check_connections_block total spend ----------------------------- 0.0038957595825195312
generate_one_block  0.0011169910430908203
generate_one_block  0.0009827613830566406
generate_one_block  0.0010139942169189453
generate_one_block  0.0009806156158447266
generate_one_block  0.0009903907775878906
generate_one_block  0.0010001659393310547
generate_one_block  0.0009801387786865234
generate_one_block  0.0010123252868652344
generate_one_block  0.0009713172912597656
generate_one_block  0.0010068416595458984
generate_one_block  0.0009856224060058594
generate_one_block  0.0009696483612060547
generate_one_block  0.0010008811950683594
generate_one_block  0.001026153564453125
generate_one_block  0.0009908676147460938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0014805793762207031
gen group dst list time:  7.700920104980469e-05
time for parepare:  0.0002551078796386719
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0002238750457763672
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  9.989738464355469e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.987022399902344e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.7738037109375e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0002925395965576172
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001418590545654297
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.291534423828125e-05
----------------------check_connections_block total spend ----------------------------- 0.004536867141723633
generate_one_block  0.0012669563293457031
generate_one_block  0.001110076904296875
generate_one_block  0.0010509490966796875
generate_one_block  0.0010426044464111328
generate_one_block  0.0010309219360351562
generate_one_block  0.0010838508605957031
generate_one_block  0.0011303424835205078
generate_one_block  0.0009968280792236328
generate_one_block  0.0010104179382324219
generate_one_block  0.0010423660278320312
generate_one_block  0.0009713172912597656
generate_one_block  0.0010290145874023438
generate_one_block  0.0013623237609863281
generate_one_block  0.0011012554168701172
generate_one_block  0.0010013580322265625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011191368103027344
gen group dst list time:  0.0001163482666015625
time for parepare:  0.0007371902465820312
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00030350685119628906
mini_batch_src_global generation:  0.00012087821960449219
r_  generation:  0.0013134479522705078
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  9.369850158691406e-05
r_  generation:  0.0004930496215820312
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00022935867309570312
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.000270843505859375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00014472007751464844
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0005006790161132812
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.0005679130554199219
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.000148773193359375
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00035190582275390625
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0003724098205566406
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00018477439880371094
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0005145072937011719
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  0.00017070770263671875
r_  generation:  0.001817464828491211
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  0.00012159347534179688
r_  generation:  0.0008857250213623047
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0002410411834716797
----------------------check_connections_block total spend ----------------------------- 0.014612674713134766
generate_one_block  0.002797842025756836
generate_one_block  0.0014793872833251953
generate_one_block  0.0012052059173583984
generate_one_block  0.0012884140014648438
generate_one_block  0.0011081695556640625
generate_one_block  0.0017058849334716797
generate_one_block  0.0016632080078125
generate_one_block  0.0010852813720703125
generate_one_block  0.0014162063598632812
generate_one_block  0.0013518333435058594
generate_one_block  0.0011188983917236328
generate_one_block  0.0016090869903564453
generate_one_block  0.0031604766845703125
generate_one_block  0.0022051334381103516
generate_one_block  0.0012083053588867188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

connection checking time:  0.0191495418548584
block generation total time  0.0406339168548584
average batch blocks generation time:  0.0027089277903238934
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.012053966522216797  GigaBytes
Max Memory Allocated: 0.012053966522216797  GigaBytes

torch.Size([1586, 500])
torch.Size([410, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.1518855094909668  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.020454883575439453  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

torch.Size([707, 500])
torch.Size([211, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.06508016586303711  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.019397735595703125  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

torch.Size([336, 500])
torch.Size([99, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.03778696060180664  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.02044820785522461  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

torch.Size([538, 500])
torch.Size([87, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.04519081115722656  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.01932525634765625  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

torch.Size([298, 500])
torch.Size([72, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.031362056732177734  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.02045583724975586  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

torch.Size([897, 500])
torch.Size([166, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.07152318954467773  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.021172046661376953  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

torch.Size([1283, 500])
torch.Size([156, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.07869338989257812  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.019256114959716797  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

torch.Size([261, 500])
torch.Size([55, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.030716419219970703  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.020451068878173828  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

torch.Size([581, 500])
torch.Size([146, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.05532550811767578  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.019907474517822266  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

torch.Size([607, 500])
torch.Size([177, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.05467844009399414  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.01942300796508789  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

torch.Size([350, 500])
torch.Size([91, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.03423738479614258  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.021040916442871094  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

torch.Size([1213, 500])
torch.Size([183, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.07279634475708008  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.024057388305664062  GigaBytes
Max Memory Allocated: 0.15918827056884766  GigaBytes

torch.Size([2813, 500])
torch.Size([634, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.20447778701782227  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.02163982391357422  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([1530, 500])
torch.Size([311, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.1027064323425293  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.01960897445678711  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([449, 500])
torch.Size([74, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.04072427749633789  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0059049129486083984 |0.023653427759806316 |0.10031879742940267 |0.00011719067891438803 |0.07688894271850585 |0.007825851440429688 |
----------------------------------------------------------pseudo_mini_loss sum 2.146918773651123
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16678
Number of first layer input nodes during this epoch:  13449
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.03827095031738281  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004971027374267578
range selection method range initialization spend 5.221366882324219e-05
time for parepare:  5.221366882324219e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.0967254638671875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.821487426757812e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.049041748046875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.821487426757812e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5735626220703125e-05
----------------------check_connections_block total spend ----------------------------- 0.0027379989624023438
generate_one_block  0.0010762214660644531
generate_one_block  0.0009958744049072266
generate_one_block  0.0010251998901367188
generate_one_block  0.0009608268737792969
generate_one_block  0.0009534358978271484
generate_one_block  0.0009925365447998047
generate_one_block  0.0009837150573730469
generate_one_block  0.0011467933654785156
generate_one_block  0.0009541511535644531
generate_one_block  0.0010044574737548828
generate_one_block  0.0009584426879882812
generate_one_block  0.000949859619140625
generate_one_block  0.0009870529174804688
generate_one_block  0.00099945068359375
generate_one_block  0.0009520053863525391
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005483627319335938
gen group dst list time:  7.62939453125e-05
time for parepare:  0.00025081634521484375
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  6.556510925292969e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001742839813232422
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00017309188842773438
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00011491775512695312
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  9.560585021972656e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001895427703857422
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  7.867813110351562e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00012040138244628906
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  8.893013000488281e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00011610984802246094
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  4.6253204345703125e-05
----------------------check_connections_block total spend ----------------------------- 0.004586219787597656
generate_one_block  0.0011167526245117188
generate_one_block  0.0009946823120117188
generate_one_block  0.0011637210845947266
generate_one_block  0.0012199878692626953
generate_one_block  0.0011608600616455078
generate_one_block  0.001035451889038086
generate_one_block  0.001087188720703125
generate_one_block  0.0012574195861816406
generate_one_block  0.0010445117950439453
generate_one_block  0.0011322498321533203
generate_one_block  0.0010554790496826172
generate_one_block  0.0009922981262207031
generate_one_block  0.000993967056274414
generate_one_block  0.0011572837829589844
generate_one_block  0.0010170936584472656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011212825775146484
gen group dst list time:  0.00013113021850585938
time for parepare:  0.0007550716400146484
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0002524852752685547
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0002696514129638672
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0001399517059326172
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.0007867813110351562
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  0.00016689300537109375
r_  generation:  0.0011510848999023438
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0005838871002197266
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0002067089080810547
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0005152225494384766
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  0.0001480579376220703
r_  generation:  0.0013511180877685547
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0003349781036376953
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.0006983280181884766
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0005280971527099609
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.001374959945678711
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0001709461212158203
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0006897449493408203
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0001583099365234375
----------------------check_connections_block total spend ----------------------------- 0.016073942184448242
generate_one_block  0.0014269351959228516
generate_one_block  0.0012738704681396484
generate_one_block  0.0020449161529541016
generate_one_block  0.002485990524291992
generate_one_block  0.0016248226165771484
generate_one_block  0.0012159347534179688
generate_one_block  0.0016865730285644531
generate_one_block  0.0027892589569091797
generate_one_block  0.0013666152954101562
generate_one_block  0.0018918514251708984
generate_one_block  0.001705169677734375
generate_one_block  0.0012323856353759766
generate_one_block  0.0011806488037109375
generate_one_block  0.0018885135650634766
generate_one_block  0.0012059211730957031
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.03827095031738281  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

connection checking time:  0.0206601619720459
block generation total time  0.041448354721069336
average batch blocks generation time:  0.002763223648071289
block dataloader generation time/epoch 0.1268012523651123
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.038268089294433594  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([453, 500])
torch.Size([125, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.06402730941772461  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.03798866271972656  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([305, 500])
torch.Size([53, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.049910545349121094  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.04039478302001953  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([1474, 500])
torch.Size([329, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.11988639831542969  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.039806365966796875  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([1263, 500])
torch.Size([321, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.1669001579284668  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.03910636901855469  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([881, 500])
torch.Size([173, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.08950996398925781  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.03815793991088867  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([395, 500])
torch.Size([75, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.056078433990478516  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.04038524627685547  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([1234, 500])
torch.Size([172, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.08997249603271484  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.041001319885253906  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([1903, 500])
torch.Size([425, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.1796131134033203  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.038387298583984375  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([516, 500])
torch.Size([164, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.06824922561645508  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.04039192199707031  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([1352, 500])
torch.Size([334, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.11194944381713867  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.039644718170166016  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([1188, 500])
torch.Size([191, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.0934605598449707  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.03818035125732422  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([407, 500])
torch.Size([87, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.05757474899291992  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.03795957565307617  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([289, 500])
torch.Size([94, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.05341625213623047  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.04039192199707031  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

torch.Size([1364, 500])
torch.Size([242, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.1132206916809082  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.03799152374267578  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes
Using backend: pytorch

torch.Size([306, 500])
torch.Size([78, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.0514225959777832  GigaBytes
Max Memory Allocated: 0.21127653121948242  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0033761024475097655 |0.0009039560953776042 |0.0709781805674235 |0.00011515617370605469 |0.07897259394327799 |0.006353855133056641 |
----------------------------------------------------------pseudo_mini_loss sum 1.7551624774932861
Total (block generation + training)time/epoch 2.4751431941986084
Training time/epoch 2.3480021953582764
Training time without block to device /epoch 2.3344428539276123
Training time without total dataloading part /epoch 2.25734281539917
load block tensor time/epoch 0.050641536712646484
block to device time/epoch 0.013559341430664062
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16550
Number of first layer input nodes during this epoch:  13330
