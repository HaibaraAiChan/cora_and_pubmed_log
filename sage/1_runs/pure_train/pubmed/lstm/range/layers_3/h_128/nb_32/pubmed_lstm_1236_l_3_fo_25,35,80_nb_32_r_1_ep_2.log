main start at this time 1648530010.338427
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002444028854370117
range selection method range initialization spend 0.00010371208190917969
time for parepare:  4.4345855712890625e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  0.0015475749969482422
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.2636184692382812e-05
----------------------check_connections_block total spend ----------------------------- 0.004333972930908203
generate_one_block  0.0012104511260986328
generate_one_block  0.0010151863098144531
generate_one_block  0.0010104179382324219
generate_one_block  0.0009989738464355469
generate_one_block  0.0009942054748535156
generate_one_block  0.0010056495666503906
generate_one_block  0.0010237693786621094
generate_one_block  0.0010516643524169922
generate_one_block  0.0010120868682861328
generate_one_block  0.0010077953338623047
generate_one_block  0.001005411148071289
generate_one_block  0.0010063648223876953
generate_one_block  0.0010356903076171875
generate_one_block  0.0009732246398925781
generate_one_block  0.0010001659393310547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012841224670410156
gen group dst list time:  7.891654968261719e-05
time for parepare:  0.00023293495178222656
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0002238750457763672
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00010132789611816406
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.340576171875e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  8.106231689453125e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  7.390975952148438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.893013000488281e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.673004150390625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  8.606910705566406e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.0002949237823486328
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001442432403564453
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.3392181396484375e-05
----------------------check_connections_block total spend ----------------------------- 0.004549503326416016
generate_one_block  0.0013229846954345703
generate_one_block  0.0011489391326904297
generate_one_block  0.001062154769897461
generate_one_block  0.001071929931640625
generate_one_block  0.00103759765625
generate_one_block  0.0010974407196044922
generate_one_block  0.0011692047119140625
generate_one_block  0.0010361671447753906
generate_one_block  0.001046895980834961
generate_one_block  0.0010480880737304688
generate_one_block  0.0009844303131103516
generate_one_block  0.0010421276092529297
generate_one_block  0.0013909339904785156
generate_one_block  0.0011279582977294922
generate_one_block  0.0010135173797607422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010831356048583984
gen group dst list time:  0.00012183189392089844
time for parepare:  0.0007271766662597656
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00031065940856933594
mini_batch_src_global generation:  0.0001266002655029297
r_  generation:  0.0013544559478759766
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  9.584426879882812e-05
r_  generation:  0.000499725341796875
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.00022077560424804688
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0002682209014892578
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0001583099365234375
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0005364418029785156
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0005831718444824219
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00015115737915039062
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0003654956817626953
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.00038743019104003906
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00018978118896484375
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00052642822265625
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  0.0001685619354248047
r_  generation:  0.0018508434295654297
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  0.00012421607971191406
r_  generation:  0.0008857250213623047
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0002467632293701172
----------------------check_connections_block total spend ----------------------------- 0.01491999626159668
generate_one_block  0.002910614013671875
generate_one_block  0.0016198158264160156
generate_one_block  0.0012922286987304688
generate_one_block  0.00125885009765625
generate_one_block  0.0011360645294189453
generate_one_block  0.0017192363739013672
generate_one_block  0.0016493797302246094
generate_one_block  0.0011010169982910156
generate_one_block  0.001346588134765625
generate_one_block  0.0013611316680908203
generate_one_block  0.0011441707611083984
generate_one_block  0.0016355514526367188
generate_one_block  0.0032203197479248047
generate_one_block  0.0021944046020507812
generate_one_block  0.001224517822265625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

connection checking time:  0.019469499588012695
block generation total time  0.04141426086425781
average batch blocks generation time:  0.002760950724283854
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.01210784912109375  GigaBytes
Max Memory Allocated: 0.01210784912109375  GigaBytes

torch.Size([1615, 500])
torch.Size([413, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.1531524658203125  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.02030801773071289  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

torch.Size([704, 500])
torch.Size([211, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.06495904922485352  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.019345760345458984  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

torch.Size([358, 500])
torch.Size([99, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.03825187683105469  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.020301342010498047  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

torch.Size([533, 500])
torch.Size([87, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.0450439453125  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.01932811737060547  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

torch.Size([349, 500])
torch.Size([72, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.032930850982666016  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.02041769027709961  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

torch.Size([928, 500])
torch.Size([168, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.07423067092895508  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.02103281021118164  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

torch.Size([1258, 500])
torch.Size([156, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.07850027084350586  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.019170761108398438  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

torch.Size([265, 500])
torch.Size([55, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.030631065368652344  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.020304203033447266  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

torch.Size([579, 500])
torch.Size([146, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.055207252502441406  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.01979207992553711  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

torch.Size([595, 500])
torch.Size([177, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.054563045501708984  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.01933002471923828  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

torch.Size([350, 500])
torch.Size([91, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.03414440155029297  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.020975589752197266  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

torch.Size([1228, 500])
torch.Size([184, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.07271194458007812  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.023994922637939453  GigaBytes
Max Memory Allocated: 0.1602935791015625  GigaBytes

torch.Size([2829, 500])
torch.Size([637, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.20701265335083008  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.021532058715820312  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([1522, 500])
torch.Size([311, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.10254478454589844  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.019525527954101562  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([454, 500])
torch.Size([74, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.040640830993652344  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0028781890869140625 |0.024159797032674155 |0.10310182571411133 |0.00012022654215494791 |0.07523457209269206 |0.008135795593261719 |
----------------------------------------------------------pseudo_mini_loss sum 2.1224441528320312
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16805
Number of first layer input nodes during this epoch:  13567
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.038187503814697266  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005025863647460938
range selection method range initialization spend 5.5789947509765625e-05
time for parepare:  5.459785461425781e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.1920928955078125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.1205673217773438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.430511474609375e-05
----------------------check_connections_block total spend ----------------------------- 0.002760171890258789
generate_one_block  0.0011637210845947266
generate_one_block  0.001047372817993164
generate_one_block  0.0010752677917480469
generate_one_block  0.0010595321655273438
generate_one_block  0.0010466575622558594
generate_one_block  0.0010344982147216797
generate_one_block  0.001041412353515625
generate_one_block  0.00119781494140625
generate_one_block  0.0010428428649902344
generate_one_block  0.001046895980834961
generate_one_block  0.0010559558868408203
generate_one_block  0.0010349750518798828
generate_one_block  0.0010349750518798828
generate_one_block  0.0010514259338378906
generate_one_block  0.0010342597961425781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006425380706787109
gen group dst list time:  8.034706115722656e-05
time for parepare:  0.00025272369384765625
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00017762184143066406
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0001728534698486328
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00010561943054199219
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  8.726119995117188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00020384788513183594
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00012874603271484375
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  9.5367431640625e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.649162292480469e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00012445449829101562
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.9591064453125e-05
----------------------check_connections_block total spend ----------------------------- 0.0047113895416259766
generate_one_block  0.0011534690856933594
generate_one_block  0.0010819435119628906
generate_one_block  0.0012657642364501953
generate_one_block  0.0012774467468261719
generate_one_block  0.0012705326080322266
generate_one_block  0.0010845661163330078
generate_one_block  0.0011396408081054688
generate_one_block  0.0025644302368164062
generate_one_block  0.0010616779327392578
generate_one_block  0.0011510848999023438
generate_one_block  0.001077890396118164
generate_one_block  0.0010151863098144531
generate_one_block  0.0010292530059814453
generate_one_block  0.001130819320678711
generate_one_block  0.0010178089141845703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010983943939208984
gen group dst list time:  0.00014138221740722656
time for parepare:  0.0007920265197753906
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0002739429473876953
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00029349327087402344
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0001475811004638672
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  0.00010514259338378906
r_  generation:  0.0008554458618164062
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.000186920166015625
r_  generation:  0.0011856555938720703
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0005896091461181641
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00022840499877929688
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0005517005920410156
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  0.00015401840209960938
r_  generation:  0.0013866424560546875
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0003600120544433594
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.0007579326629638672
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.000579833984375
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0002467632293701172
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00019168853759765625
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0007476806640625
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0001647472381591797
----------------------check_connections_block total spend ----------------------------- 0.015845060348510742
generate_one_block  0.0015263557434082031
generate_one_block  0.001361846923828125
generate_one_block  0.002199888229370117
generate_one_block  0.002526521682739258
generate_one_block  0.001657247543334961
generate_one_block  0.0012500286102294922
generate_one_block  0.0017657279968261719
generate_one_block  0.0027408599853515625
generate_one_block  0.0014057159423828125
generate_one_block  0.001985788345336914
generate_one_block  0.0017561912536621094
generate_one_block  0.0012738704681396484
generate_one_block  0.0012307167053222656
generate_one_block  0.0019483566284179688
generate_one_block  0.0012385845184326172
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.038187503814697266  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

connection checking time:  0.02055644989013672
block generation total time  0.0441892147064209
average batch blocks generation time:  0.0029459476470947267
block dataloader generation time/epoch 0.13071513175964355
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.03816938400268555  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([450, 500])
torch.Size([125, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.06392860412597656  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.037873268127441406  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([293, 500])
torch.Size([53, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.04979515075683594  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.040355682373046875  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([1466, 500])
torch.Size([329, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.11984729766845703  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.039667606353759766  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([1239, 500])
torch.Size([318, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.16470956802368164  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.03897237777709961  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([877, 500])
torch.Size([173, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.08937597274780273  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.038066864013671875  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([396, 500])
torch.Size([75, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.05598735809326172  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.04034709930419922  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([1283, 500])
torch.Size([174, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.09258651733398438  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.04089927673339844  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([1898, 500])
torch.Size([425, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.1789722442626953  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.038301944732666016  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([520, 500])
torch.Size([164, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.06816387176513672  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.040352821350097656  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([1354, 500])
torch.Size([331, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.11182689666748047  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.03959941864013672  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([1213, 500])
torch.Size([190, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.09444999694824219  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.03809499740600586  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([411, 500])
torch.Size([87, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.05748939514160156  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.03792381286621094  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([319, 500])
torch.Size([94, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.0541229248046875  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.040352821350097656  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([1358, 500])
torch.Size([242, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.1131277084350586  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.037872314453125  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

torch.Size([292, 500])Using backend: pytorch

torch.Size([78, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.05064535140991211  GigaBytes
Max Memory Allocated: 0.21404170989990234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002568817138671875 |0.0009691238403320313 |0.07328449885050456 |0.00011703173319498698 |0.07681231498718262 |0.006622314453125 |
----------------------------------------------------------pseudo_mini_loss sum 1.7616239786148071
Total (block generation + training)time/epoch 2.470745325088501
Training time/epoch 2.3397164344787598
Training time without block to device /epoch 2.3251795768737793
Training time without total dataloading part /epoch 2.2598299980163574
load block tensor time/epoch 0.038532257080078125
block to device time/epoch 0.014536857604980469
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16584
Number of first layer input nodes during this epoch:  13369
