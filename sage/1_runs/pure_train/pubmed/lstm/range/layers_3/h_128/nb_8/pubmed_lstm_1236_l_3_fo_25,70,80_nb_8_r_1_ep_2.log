main start at this time 1648530047.1167357
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0024247169494628906
range selection method range initialization spend 8.320808410644531e-05
time for parepare:  4.553794860839844e-05
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0011830329895019531
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.412101745605469e-05
----------------------check_connections_block total spend ----------------------------- 0.0022504329681396484
generate_one_block  0.0012447834014892578
generate_one_block  0.0011425018310546875
generate_one_block  0.0010712146759033203
generate_one_block  0.0011174678802490234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011639595031738281
gen group dst list time:  3.4809112548828125e-05
time for parepare:  0.00025272369384765625
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00039696693420410156
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00022530555725097656
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002465248107910156
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.000522613525390625
----------------------check_connections_block total spend ----------------------------- 0.0029060840606689453
generate_one_block  0.0016124248504638672
generate_one_block  0.001331329345703125
generate_one_block  0.0013811588287353516
generate_one_block  0.0017328262329101562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010509490966796875
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.0007803440093994141
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.00033164024353027344
mini_batch_src_global generation:  0.00019550323486328125
r_  generation:  0.0023462772369384766
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  0.0002071857452392578
r_  generation:  0.0015568733215332031
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.00015926361083984375
r_  generation:  0.001493692398071289
local_output_nid generation:  8.845329284667969e-05
local_in_edges_tensor generation:  0.00047206878662109375
mini_batch_src_global generation:  0.0002739429473876953
r_  generation:  0.003128528594970703
----------------------check_connections_block total spend ----------------------------- 0.013879537582397461
generate_one_block  0.004082202911376953
generate_one_block  0.0028214454650878906
generate_one_block  0.002727508544921875
generate_one_block  0.004651784896850586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

connection checking time:  0.016785621643066406
block generation total time  0.020340681076049805
average batch blocks generation time:  0.005085170269012451
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014585018157958984  GigaBytes
Max Memory Allocated: 0.014585018157958984  GigaBytes

torch.Size([2931, 500])
torch.Size([828, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.2463979721069336  GigaBytes
Max Memory Allocated: 0.2543220520019531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.02285003662109375  GigaBytes
Max Memory Allocated: 0.2543220520019531  GigaBytes

torch.Size([2520, 500])
torch.Size([507, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.16992521286010742  GigaBytes
Max Memory Allocated: 0.2543220520019531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.023614883422851562  GigaBytes
Max Memory Allocated: 0.2543220520019531  GigaBytes

torch.Size([2674, 500])
torch.Size([571, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.16486549377441406  GigaBytes
Max Memory Allocated: 0.2543220520019531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.02655649185180664  GigaBytes
Max Memory Allocated: 0.2543220520019531  GigaBytes

torch.Size([4295, 500])
torch.Size([1137, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.33001041412353516  GigaBytes
Max Memory Allocated: 0.33826351165771484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0025413036346435547 |0.08551722764968872 |0.23831510543823242 |0.00014603137969970703 |0.20340436697006226 |0.008133649826049805 |
----------------------------------------------------------pseudo_mini_loss sum 1.8184155225753784
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15819
Number of first layer input nodes during this epoch:  12420
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.04568195343017578  GigaBytes
Max Memory Allocated: 0.33826351165771484  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005059242248535156
range selection method range initialization spend 5.078315734863281e-05
time for parepare:  6.29425048828125e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00011396408081054688
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  5.364418029785156e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.361701965332031e-05
----------------------check_connections_block total spend ----------------------------- 0.0011894702911376953
generate_one_block  0.0011990070343017578
generate_one_block  0.0011272430419921875
generate_one_block  0.0011074542999267578
generate_one_block  0.0010857582092285156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005598068237304688
gen group dst list time:  3.600120544433594e-05
time for parepare:  0.00027871131896972656
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0003027915954589844
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0005156993865966797
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.00036525726318359375
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.00023674964904785156
----------------------check_connections_block total spend ----------------------------- 0.003108978271484375
generate_one_block  0.0015316009521484375
generate_one_block  0.0018069744110107422
generate_one_block  0.0019333362579345703
generate_one_block  0.0014088153839111328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010080337524414062
gen group dst list time:  8.58306884765625e-05
time for parepare:  0.0007350444793701172
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.00031185150146484375
mini_batch_src_global generation:  0.000156402587890625
r_  generation:  0.0015780925750732422
local_output_nid generation:  9.584426879882812e-05
local_in_edges_tensor generation:  0.0002613067626953125
mini_batch_src_global generation:  0.0004253387451171875
r_  generation:  0.003294706344604492
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  0.0002429485321044922
r_  generation:  0.003126859664916992
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.0013453960418701172
----------------------check_connections_block total spend ----------------------------- 0.014630317687988281
generate_one_block  0.0033173561096191406
generate_one_block  0.005185842514038086
generate_one_block  0.0033807754516601562
generate_one_block  0.0026085376739501953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.04568195343017578  GigaBytes
Max Memory Allocated: 0.33826351165771484  GigaBytes

connection checking time:  0.017739295959472656
block generation total time  0.02117323875427246
average batch blocks generation time:  0.005293309688568115
block dataloader generation time/epoch 0.07091236114501953
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.04198503494262695  GigaBytes
Max Memory Allocated: 0.33826351165771484  GigaBytes

torch.Size([2586, 500])
torch.Size([611, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.18877220153808594  GigaBytes
Max Memory Allocated: 0.33826351165771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.04557609558105469  GigaBytes
Max Memory Allocated: 0.33826351165771484  GigaBytes

torch.Size([4118, 500])
torch.Size([988, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5916748046875 GB
    Memory Allocated: 0.3769807815551758  GigaBytes
Max Memory Allocated: 0.39058542251586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.043010711669921875  GigaBytes
Max Memory Allocated: 0.39058542251586914  GigaBytes

torch.Size([3131, 500])
torch.Size([845, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.22402429580688477  GigaBytes
Max Memory Allocated: 0.39058542251586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.04138898849487305  GigaBytes
Max Memory Allocated: 0.39058542251586914  GigaBytes

torch.Size([2269, 500])
torch.Size([515, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.1637578010559082  GigaBytes
Max Memory Allocated: 0.39058542251586914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007409989833831787 |0.000998854637145996 |0.12484735250473022 |0.0001259446144104004 |0.21526563167572021 |0.0094146728515625 |
----------------------------------------------------------pseudo_mini_loss sum 1.8072816133499146
Total (block generation + training)time/epoch 1.4837384223937988
Training time/epoch 1.4125699996948242
Training time without block to device /epoch 1.4085745811462402
Training time without total dataloading part /epoch 1.3703703880310059
load block tensor time/epoch 0.02963995933532715
block to device time/epoch 0.003995418548583984
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15420
Number of first layer input nodes during this epoch:  12104
