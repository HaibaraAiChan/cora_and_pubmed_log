main start at this time 1648529984.5797722
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0030798912048339844
range selection method range initialization spend 7.772445678710938e-05
time for parepare:  4.673004150390625e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0013759136199951172
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.173683166503906e-05
----------------------check_connections_block total spend ----------------------------- 0.0024166107177734375
generate_one_block  0.001226186752319336
generate_one_block  0.0011169910430908203
generate_one_block  0.0010242462158203125
generate_one_block  0.0010955333709716797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001443624496459961
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.00022745132446289062
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.00035691261291503906
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00018787384033203125
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00022172927856445312
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0005054473876953125
----------------------check_connections_block total spend ----------------------------- 0.00264739990234375
generate_one_block  0.0015377998352050781
generate_one_block  0.0012259483337402344
generate_one_block  0.001338958740234375
generate_one_block  0.0016438961029052734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009925365447998047
gen group dst list time:  7.081031799316406e-05
time for parepare:  0.0007829666137695312
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.0003273487091064453
mini_batch_src_global generation:  0.00019049644470214844
r_  generation:  0.0021572113037109375
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  0.00019550323486328125
r_  generation:  0.0012979507446289062
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  0.00013303756713867188
r_  generation:  0.0012638568878173828
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.00045490264892578125
mini_batch_src_global generation:  0.00024247169494628906
r_  generation:  0.00286102294921875
----------------------check_connections_block total spend ----------------------------- 0.012576580047607422
generate_one_block  0.0038928985595703125
generate_one_block  0.002599954605102539
generate_one_block  0.002520322799682617
generate_one_block  0.004486560821533203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

connection checking time:  0.015223979949951172
block generation total time  0.019246339797973633
average batch blocks generation time:  0.004811584949493408
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014414310455322266  GigaBytes
Max Memory Allocated: 0.014414310455322266  GigaBytes

torch.Size([2841, 500])
torch.Size([774, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.23451805114746094  GigaBytes
Max Memory Allocated: 0.24248790740966797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.022511959075927734  GigaBytes
Max Memory Allocated: 0.24248790740966797  GigaBytes

torch.Size([2341, 500])
torch.Size([422, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.14988279342651367  GigaBytes
Max Memory Allocated: 0.24248790740966797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.02344226837158203  GigaBytes
Max Memory Allocated: 0.24248790740966797  GigaBytes

torch.Size([2318, 500])
torch.Size([536, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.14920330047607422  GigaBytes
Max Memory Allocated: 0.24248790740966797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.025942325592041016  GigaBytes
Max Memory Allocated: 0.24248790740966797  GigaBytes

torch.Size([4158, 500])
torch.Size([1085, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.3116297721862793  GigaBytes
Max Memory Allocated: 0.3199481964111328  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01372528076171875 |0.0877944827079773 |0.2433713674545288 |0.00016266107559204102 |0.12411558628082275 |0.01009225845336914 |
----------------------------------------------------------pseudo_mini_loss sum 1.8159126043319702
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14831
Number of first layer input nodes during this epoch:  11658
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.04476785659790039  GigaBytes
Max Memory Allocated: 0.3199481964111328  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005562305450439453
range selection method range initialization spend 5.698204040527344e-05
time for parepare:  5.078315734863281e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012302398681640625Using backend: pytorch

mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.528594970703125e-05
----------------------check_connections_block total spend ----------------------------- 0.0013642311096191406
generate_one_block  0.0013158321380615234
generate_one_block  0.0011687278747558594
generate_one_block  0.0014879703521728516
generate_one_block  0.0011138916015625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005819797515869141
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.000225067138671875
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00026535987854003906
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0004525184631347656
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00030517578125
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00020623207092285156
----------------------check_connections_block total spend ----------------------------- 0.0028905868530273438
generate_one_block  0.0015070438385009766
generate_one_block  0.0017161369323730469
generate_one_block  0.0015103816986083984
generate_one_block  0.0013654232025146484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009622573852539062
gen group dst list time:  7.748603820800781e-05
time for parepare:  0.0006463527679443359
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.0003075599670410156
mini_batch_src_global generation:  0.00013709068298339844
r_  generation:  0.0012521743774414062
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.00025177001953125
mini_batch_src_global generation:  0.0003502368927001953
r_  generation:  0.003740072250366211
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.00023174285888671875
mini_batch_src_global generation:  0.00020432472229003906
r_  generation:  0.001714468002319336
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  0.00014138221740722656
r_  generation:  0.00115203857421875
----------------------check_connections_block total spend ----------------------------- 0.012531757354736328
generate_one_block  0.0028886795043945312
generate_one_block  0.0048770904541015625
generate_one_block  0.0033750534057617188
generate_one_block  0.002653360366821289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.04476785659790039  GigaBytes
Max Memory Allocated: 0.3199481964111328  GigaBytes

connection checking time:  0.015422344207763672
block generation total time  0.019893169403076172
average batch blocks generation time:  0.004973292350769043
block dataloader generation time/epoch 0.16920161247253418
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.041283607482910156  GigaBytes
Max Memory Allocated: 0.3199481964111328  GigaBytes

torch.Size([2370, 500])
torch.Size([576, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.17161846160888672  GigaBytes
Max Memory Allocated: 0.3199481964111328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.04458427429199219  GigaBytes
Max Memory Allocated: 0.3199481964111328  GigaBytes

torch.Size([3680, 500])
torch.Size([915, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.34662675857543945  GigaBytes
Max Memory Allocated: 0.35890626907348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.042505741119384766  GigaBytes
Max Memory Allocated: 0.35890626907348633  GigaBytes

torch.Size([3019, 500])
torch.Size([789, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.21584272384643555  GigaBytes
Max Memory Allocated: 0.35890626907348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.040956974029541016  GigaBytes
Max Memory Allocated: 0.35890626907348633  GigaBytes

torch.Size([2196, 500])
torch.Size([483, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.15982484817504883  GigaBytes
Max Memory Allocated: 0.35890626907348633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00439608097076416 |0.000957787036895752 |0.13689708709716797 |0.00015485286712646484 |0.12689918279647827 |0.012198209762573242 |
----------------------------------------------------------pseudo_mini_loss sum 1.7587321996688843
Total (block generation + training)time/epoch 1.2672646045684814
Training time/epoch 1.0978672504425049
Training time without block to device /epoch 1.0940361022949219
Training time without total dataloading part /epoch 1.068002700805664
load block tensor time/epoch 0.01758432388305664
block to device time/epoch 0.003831148147583008
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14385
Number of first layer input nodes during this epoch:  11265
