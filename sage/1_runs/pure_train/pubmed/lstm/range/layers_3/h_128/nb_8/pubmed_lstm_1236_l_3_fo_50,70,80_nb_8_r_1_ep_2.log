main start at this time 1648530111.830689
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0028002262115478516
range selection method range initialization spend 8.7738037109375e-05
time for parepare:  4.4345855712890625e-05
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.001508951187133789
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  5.1021575927734375e-05
----------------------check_connections_block total spend ----------------------------- 0.002521038055419922
generate_one_block  0.0012025833129882812
generate_one_block  0.0010902881622314453
generate_one_block  0.0010232925415039062
generate_one_block  0.0010609626770019531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012853145599365234
gen group dst list time:  3.719329833984375e-05
time for parepare:  0.00024628639221191406
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0003743171691894531
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0002162456512451172
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00023031234741210938
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004916191101074219
----------------------check_connections_block total spend ----------------------------- 0.002790689468383789
generate_one_block  0.0015327930450439453
generate_one_block  0.0012667179107666016
generate_one_block  0.001310586929321289
generate_one_block  0.001649618148803711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010974407196044922
gen group dst list time:  7.367134094238281e-05
time for parepare:  0.0007617473602294922
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.0003266334533691406
mini_batch_src_global generation:  0.0002167224884033203
r_  generation:  0.002560853958129883
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.00025010108947753906
r_  generation:  0.001741647720336914
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  0.0001704692840576172
r_  generation:  0.0015721321105957031
local_output_nid generation:  8.559226989746094e-05
local_in_edges_tensor generation:  0.00046324729919433594
mini_batch_src_global generation:  0.0002970695495605469
r_  generation:  0.003256082534790039
----------------------check_connections_block total spend ----------------------------- 0.01478123664855957
generate_one_block  0.0044019222259521484
generate_one_block  0.0030879974365234375
generate_one_block  0.0029129981994628906
generate_one_block  0.005224943161010742
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

connection checking time:  0.01757192611694336
block generation total time  0.021387577056884766
average batch blocks generation time:  0.005346894264221191
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.015062808990478516  GigaBytes
Max Memory Allocated: 0.015062808990478516  GigaBytes

torch.Size([3182, 500])
torch.Size([828, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.2860841751098633  GigaBytes
Max Memory Allocated: 0.29617834091186523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.02346038818359375  GigaBytes
Max Memory Allocated: 0.29617834091186523  GigaBytes

torch.Size([2844, 500])
torch.Size([506, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.19692277908325195  GigaBytes
Max Memory Allocated: 0.29617834091186523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.024085044860839844  GigaBytes
Max Memory Allocated: 0.29617834091186523  GigaBytes

torch.Size([2895, 500])
torch.Size([571, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.17906713485717773  GigaBytes
Max Memory Allocated: 0.29617834091186523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.026874065399169922  GigaBytes
Max Memory Allocated: 0.29617834091186523  GigaBytes

torch.Size([4650, 500])
torch.Size([1137, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.3695106506347656  GigaBytes
Max Memory Allocated: 0.3808326721191406  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006408035755157471 |0.08678680658340454 |0.31192952394485474 |0.0001614093780517578 |0.2553793787956238 |0.008014678955078125 |
----------------------------------------------------------pseudo_mini_loss sum 1.8103928565979004
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16969
Number of first layer input nodes during this epoch:  13571
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.04510641098022461  GigaBytes
Max Memory Allocated: 0.3808326721191406  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005309581756591797
range selection method range initialization spend 5.14984130859375e-05
time for parepare:  5.7220458984375e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001125335693359375Using backend: pytorch

mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.266334533691406e-05
----------------------check_connections_block total spend ----------------------------- 0.0012116432189941406
generate_one_block  0.0012545585632324219
generate_one_block  0.0011496543884277344
generate_one_block  0.0011630058288574219
generate_one_block  0.001134634017944336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005578994750976562
gen group dst list time:  3.361701965332031e-05
time for parepare:  0.0002779960632324219
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0002880096435546875
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0005137920379638672
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.0003631114959716797
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0002307891845703125
----------------------check_connections_block total spend ----------------------------- 0.003056049346923828
generate_one_block  0.0016093254089355469
generate_one_block  0.0019199848175048828
generate_one_block  0.0019199848175048828
generate_one_block  0.0014615058898925781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010800361633300781
gen group dst list time:  8.344650268554688e-05
time for parepare:  0.0007274150848388672
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00032210350036621094
mini_batch_src_global generation:  0.00016570091247558594
r_  generation:  0.0017118453979492188
local_output_nid generation:  9.465217590332031e-05
local_in_edges_tensor generation:  0.00026035308837890625
mini_batch_src_global generation:  0.00047707557678222656
r_  generation:  0.003588438034057617
local_output_nid generation:  8.249282836914062e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.002238035202026367
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.001451730728149414
----------------------check_connections_block total spend ----------------------------- 0.01451730728149414
generate_one_block  0.003516674041748047
generate_one_block  0.007039546966552734
generate_one_block  0.003828287124633789
generate_one_block  0.0029113292694091797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.04510641098022461  GigaBytes
Max Memory Allocated: 0.3808326721191406  GigaBytes

connection checking time:  0.01757335662841797
block generation total time  0.02420663833618164
average batch blocks generation time:  0.00605165958404541
block dataloader generation time/epoch 0.08481216430664062
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.041571617126464844  GigaBytes
Max Memory Allocated: 0.3808326721191406  GigaBytes

torch.Size([2847, 500])
torch.Size([611, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.20427417755126953  GigaBytes
Max Memory Allocated: 0.3808326721191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.044992923736572266  GigaBytes
Max Memory Allocated: 0.3808326721191406  GigaBytes

torch.Size([4495, 500])
torch.Size([989, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.4277968406677246  GigaBytes
Max Memory Allocated: 0.44206857681274414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.042654991149902344  GigaBytes
Max Memory Allocated: 0.44206857681274414  GigaBytes

torch.Size([3421, 500])
torch.Size([845, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.2511434555053711  GigaBytes
Max Memory Allocated: 0.44206857681274414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.04091930389404297  GigaBytes
Max Memory Allocated: 0.44206857681274414  GigaBytes

torch.Size([2500, 500])
torch.Size([515, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.1802053451538086  GigaBytes
Max Memory Allocated: 0.44206857681274414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004763305187225342 |0.0009590387344360352 |0.19707262516021729 |0.00014084577560424805 |0.2599185109138489 |0.0069828033447265625 |
----------------------------------------------------------pseudo_mini_loss sum 1.5883984565734863
Total (block generation + training)time/epoch 1.9525339603424072
Training time/epoch 1.867516040802002
Training time without block to device /epoch 1.8636798858642578
Training time without total dataloading part /epoch 1.8355107307434082
load block tensor time/epoch 0.019053220748901367
block to device time/epoch 0.0038361549377441406
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16580
Number of first layer input nodes during this epoch:  13263
