main start at this time 1648529913.3484702
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0017719268798828125
range selection method range initialization spend 8.368492126464844e-05
time for parepare:  4.38690185546875e-05
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0011382102966308594
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  7.462501525878906e-05
----------------------check_connections_block total spend ----------------------------- 0.0018360614776611328
generate_one_block  0.0012633800506591797
generate_one_block  0.0011355876922607422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001127481460571289
gen group dst list time:  2.574920654296875e-05
time for parepare:  0.0002319812774658203
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.000225067138671875
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0005238056182861328
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  0.00011682510375976562
r_  generation:  0.0006902217864990234
----------------------check_connections_block total spend ----------------------------- 0.002355337142944336
generate_one_block  0.0017774105072021484
generate_one_block  0.0019457340240478516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009572505950927734
gen group dst list time:  6.29425048828125e-05
time for parepare:  0.0007505416870117188
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.0003712177276611328
mini_batch_src_global generation:  0.00025177001953125
r_  generation:  0.003103017807006836
local_output_nid generation:  0.00011372566223144531
local_in_edges_tensor generation:  0.0003197193145751953
mini_batch_src_global generation:  0.0004444122314453125
r_  generation:  0.00391697883605957
----------------------check_connections_block total spend ----------------------------- 0.011171579360961914
generate_one_block  0.005360126495361328
generate_one_block  0.005780696868896484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

connection checking time:  0.01352691650390625
block generation total time  0.014863967895507812
average batch blocks generation time:  0.007431983947753906
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.017020702362060547  GigaBytes
Max Memory Allocated: 0.017020702362060547  GigaBytes

torch.Size([4225, 500])
torch.Size([1150, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5526123046875 GB
    Memory Allocated: 0.34238100051879883  GigaBytes
Max Memory Allocated: 0.3532543182373047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5526123046875 GB
    Memory Allocated: 0.029082775115966797  GigaBytes
Max Memory Allocated: 0.3532543182373047  GigaBytes

torch.Size([5568, 500])
torch.Size([1565, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.42107295989990234  GigaBytes
Max Memory Allocated: 0.4308161735534668  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009699583053588867 |0.17197179794311523 |0.36478614807128906 |0.00016927719116210938 |0.15598857402801514 |0.007810115814208984 |
----------------------------------------------------------pseudo_mini_loss sum 1.7034497261047363
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12863
Number of first layer input nodes during this epoch:  9793
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.04775571823120117  GigaBytes
Max Memory Allocated: 0.4308161735534668  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00047898292541503906
range selection method range initialization spend 4.744529724121094e-05
time for parepare:  4.482269287109375e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  7.724761962890625e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  5.435943603515625e-05
----------------------check_connections_block total spend ----------------------------- 0.0006856918334960938
generate_one_block  0.0012788772583007812
generate_one_block  0.0010876655578613281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005223751068115234
gen group dst list time:  2.574920654296875e-05
time for parepare:  0.00024509429931640625
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0006937980651855469
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0004878044128417969
----------------------check_connections_block total spend ----------------------------- 0.0023202896118164062
generate_one_block  0.002047300338745117
generate_one_block  0.0017611980438232422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009539127349853516
gen group dst list time:  6.103515625e-05
time for parepare:  0.0006389617919921875
local_output_nid generation:  0.00012063980102539062
local_in_edges_tensor generation:  0.0004200935363769531
mini_batch_src_global generation:  0.00034236907958984375
r_  generation:  0.0038480758666992188
local_output_nid generation:  0.00010728836059570312
local_in_edges_tensor generation:  0.000270843505859375
mini_batch_src_global generation:  0.00037980079650878906
r_  generation:  0.0027098655700683594
----------------------check_connections_block total spend ----------------------------- 0.010776519775390625
generate_one_block  0.006456136703491211
generate_one_block  0.0048596858978271484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.04775571823120117  GigaBytes
Max Memory Allocated: 0.4308161735534668  GigaBytes

connection checking time:  0.013096809387207031
block generation total time  0.015124320983886719
average batch blocks generation time:  0.007562160491943359
block dataloader generation time/epoch 0.04666876792907715
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.046915531158447266  GigaBytes
Max Memory Allocated: 0.4308161735534668  GigaBytes
Using backend: pytorch

torch.Size([5192, 500])
torch.Size([1427, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.45976829528808594  GigaBytes
Max Memory Allocated: 0.4711732864379883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.045533180236816406  GigaBytes
Max Memory Allocated: 0.4711732864379883  GigaBytes

torch.Size([4471, 500])
torch.Size([1214, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.32318830490112305  GigaBytes
Max Memory Allocated: 0.4711732864379883  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0036536455154418945 |0.0006806850433349609 |0.12058556079864502 |0.00012600421905517578 |0.15951061248779297 |0.006532907485961914 |
----------------------------------------------------------pseudo_mini_loss sum 1.4401909112930298
Total (block generation + training)time/epoch 0.6269097328186035
Training time/epoch 0.5800504684448242
Training time without block to device /epoch 0.5786890983581543
Training time without total dataloading part /epoch 0.5669772624969482
load block tensor time/epoch 0.007307291030883789
block to device time/epoch 0.0013613700866699219
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  12658
Number of first layer input nodes during this epoch:  9663
