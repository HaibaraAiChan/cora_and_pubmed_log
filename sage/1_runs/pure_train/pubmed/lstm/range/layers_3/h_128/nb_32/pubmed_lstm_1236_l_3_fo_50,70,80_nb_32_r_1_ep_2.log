main start at this time 1648530141.0033038
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019180774688720703
range selection method range initialization spend 8.654594421386719e-05
time for parepare:  4.673004150390625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.001071929931640625
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.2159347534179688e-05
----------------------check_connections_block total spend ----------------------------- 0.0038940906524658203
generate_one_block  0.001188516616821289
generate_one_block  0.0010254383087158203
generate_one_block  0.0010182857513427734
generate_one_block  0.0010225772857666016
generate_one_block  0.0010106563568115234
generate_one_block  0.0010225772857666016
generate_one_block  0.0010247230529785156
generate_one_block  0.0010690689086914062
generate_one_block  0.0010182857513427734
generate_one_block  0.0010194778442382812
generate_one_block  0.0010235309600830078
generate_one_block  0.0010199546813964844
generate_one_block  0.0010542869567871094
generate_one_block  0.0010347366333007812
generate_one_block  0.0010249614715576172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006835460662841797
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.00026535987854003906
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.000244140625
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00010371208190917969
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.555152893066406e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.555152893066406e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.839897155761719e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  9.369850158691406e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  7.653236389160156e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  9.179115295410156e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  9.679794311523438e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00034165382385253906
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00015234947204589844
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.5299530029296875e-05
----------------------check_connections_block total spend ----------------------------- 0.004827022552490234
generate_one_block  0.0013713836669921875
generate_one_block  0.001168966293334961
generate_one_block  0.0010769367218017578
generate_one_block  0.0010790824890136719
generate_one_block  0.0010726451873779297
generate_one_block  0.0011408329010009766
generate_one_block  0.0011827945709228516
generate_one_block  0.001071929931640625
generate_one_block  0.0010378360748291016
generate_one_block  0.0010373592376708984
generate_one_block  0.0009922981262207031
generate_one_block  0.0010499954223632812
generate_one_block  0.0014307498931884766
generate_one_block  0.0011169910430908203
generate_one_block  0.0010080337524414062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012106895446777344
gen group dst list time:  0.0001285076141357422
time for parepare:  0.0008008480072021484
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0003070831298828125
mini_batch_src_global generation:  0.00020456314086914062
r_  generation:  0.0017795562744140625
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0005440711975097656
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0002570152282714844
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00030541419982910156
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00023412704467773438
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0008301734924316406
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  9.1552734375e-05
r_  generation:  0.0007066726684570312
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0001976490020751953
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.00039386749267578125
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0004177093505859375
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002028942108154297
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0008172988891601562
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  0.000232696533203125
r_  generation:  0.0024347305297851562
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  0.0001418590545654297
r_  generation:  0.0009717941284179688
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0003218650817871094
----------------------check_connections_block total spend ----------------------------- 0.01818370819091797
generate_one_block  0.0032312870025634766
generate_one_block  0.0015246868133544922
generate_one_block  0.0012009143829345703
generate_one_block  0.0012874603271484375
generate_one_block  0.0011942386627197266
generate_one_block  0.0020074844360351562
generate_one_block  0.0017423629760742188
generate_one_block  0.0011293888092041016
generate_one_block  0.0013654232025146484
generate_one_block  0.001377105712890625
generate_one_block  0.001135110855102539
generate_one_block  0.0019872188568115234
generate_one_block  0.0037581920623779297
generate_one_block  0.0022754669189453125
generate_one_block  0.0012621879577636719
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

connection checking time:  0.023010730743408203
block generation total time  0.04331636428833008
average batch blocks generation time:  0.002887757619222005
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.012592315673828125  GigaBytes
Max Memory Allocated: 0.012592315673828125  GigaBytes

torch.Size([1869, 500])
torch.Size([457, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.1965317726135254  GigaBytes
Max Memory Allocated: 0.20375680923461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.020076274871826172  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

torch.Size([754, 500])
torch.Size([212, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.06794214248657227  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.019402503967285156  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

torch.Size([397, 500])
torch.Size([105, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.04109668731689453  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.019782543182373047  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

torch.Size([600, 500])
torch.Size([87, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.04751920700073242  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.01949024200439453  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

torch.Size([444, 500])
torch.Size([97, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.039397239685058594  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.020972251892089844  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

torch.Size([1231, 500])
torch.Size([226, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.10390472412109375  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.02136707305908203  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

torch.Size([1445, 500])
torch.Size([156, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.08753347396850586  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.019324302673339844  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

torch.Size([356, 500])
torch.Size([55, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.03432035446166992  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.01978158950805664  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

torch.Size([598, 500])
torch.Size([147, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.056496620178222656  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.019886016845703125  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

torch.Size([654, 500])
torch.Size([177, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.0572514533996582  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.019361495971679688  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

torch.Size([376, 500])
torch.Size([91, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.035040855407714844  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.02216053009033203  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

torch.Size([1866, 500])
torch.Size([220, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.10157632827758789  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.02477121353149414  GigaBytes
Max Memory Allocated: 0.20574951171875  GigaBytes

torch.Size([3247, 500])
torch.Size([693, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.2597389221191406  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.02216339111328125  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([1673, 500])
torch.Size([311, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.10931205749511719  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.019690513610839844  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([551, 500])
torch.Size([74, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.045690059661865234  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002075449625651042 |0.02375955581665039 |0.13733034133911132 |0.00012947718302408855 |0.13955515225728352 |0.011413335800170898 |
----------------------------------------------------------pseudo_mini_loss sum 2.13602352142334
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  19526
Number of first layer input nodes during this epoch:  16061
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.037932395935058594  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005457401275634766
range selection method range initialization spend 5.626678466796875e-05
time for parepare:  6.341934204101562e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.1682510375976562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.430511474609375e-05
----------------------check_connections_block total spend ----------------------------- 0.002863168716430664
generate_one_block  0.001157999038696289
generate_one_block  0.0010578632354736328
generate_one_block  0.0010869503021240234
generate_one_block  0.0010652542114257812
generate_one_block  0.0010497570037841797
generate_one_block  0.0010383129119873047
generate_one_block  0.0010533332824707031
generate_one_block  0.0012004375457763672
generate_one_block  0.0010485649108886719
generate_one_block  0.0010457038879394531
generate_one_block  0.0010602474212646484
generate_one_block  0.0010349750518798828
generate_one_block  0.0010290145874023438
generate_one_block  0.0010561943054199219
generate_one_block  0.001039266586303711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005977153778076172
gen group dst list time:  8.20159912109375e-05
time for parepare:  0.0003178119659423828
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  7.390975952148438e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.0001919269561767578
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00021982192993164062
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00011396408081054688
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00022721290588378906
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0001583099365234375
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00011038780212402344
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.887580871582031e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00012969970703125
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  5.698204040527344e-05
----------------------check_connections_block total spend ----------------------------- 0.005118131637573242
generate_one_block  0.0011687278747558594
generate_one_block  0.0010683536529541016
generate_one_block  0.0012731552124023438
generate_one_block  0.0013346672058105469
generate_one_block  0.001245260238647461
generate_one_block  0.00107574462890625
generate_one_block  0.0011646747589111328
generate_one_block  0.0013544559478759766
generate_one_block  0.0010433197021484375
generate_one_block  0.001165151596069336
generate_one_block  0.001081228256225586
generate_one_block  0.0010037422180175781
generate_one_block  0.0010051727294921875
generate_one_block  0.0011188983917236328
generate_one_block  0.0010116100311279297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012540817260742188
gen group dst list time:  0.00014710426330566406
time for parepare:  0.0009822845458984375
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00027632713317871094
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00031828880310058594
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00020885467529296875
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0009443759918212891
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00021457672119140625
mini_batch_src_global generation:  0.00024962425231933594
r_  generation:  0.0017545223236083984
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  0.00010967254638671875
r_  generation:  0.0005905628204345703
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00026607513427734375
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0008425712585449219
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  0.0001823902130126953
r_  generation:  0.0017971992492675781
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0004076957702636719
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.00010824203491210938
r_  generation:  0.001024007797241211
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0007941722869873047
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.00028777122497558594
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00023674964904785156
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0008902549743652344
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00024080276489257812
----------------------check_connections_block total spend ----------------------------- 0.0194246768951416
generate_one_block  0.0016355514526367188
generate_one_block  0.0014376640319824219
generate_one_block  0.002298593521118164
generate_one_block  0.0030612945556640625
generate_one_block  0.001707315444946289
generate_one_block  0.0012564659118652344
generate_one_block  0.0021877288818359375
generate_one_block  0.0032308101654052734
generate_one_block  0.001413583755493164
generate_one_block  0.0022983551025390625
generate_one_block  0.001928567886352539
generate_one_block  0.0013003349304199219
generate_one_block  0.0012149810791015625
generate_one_block  0.0020499229431152344
generate_one_block  0.001291036605834961
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.037932395935058594  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

connection checking time:  0.024542808532714844
block generation total time  0.045426368713378906
average batch blocks generation time:  0.003028424580891927
block dataloader generation time/epoch 0.1643204689025879
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.0378117561340332  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([493, 500])
torch.Size([125, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.06517839431762695  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.03763294219970703  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([398, 500])
torch.Size([53, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.05418539047241211  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.04039192199707031  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([1574, 500])
torch.Size([329, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.12460947036743164  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.03973960876464844  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([1505, 500])
torch.Size([369, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.2189617156982422  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.03863048553466797  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([928, 500])
torch.Size([173, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.09219121932983398  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.037715911865234375  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([442, 500])
torch.Size([75, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.05762481689453125  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.040398597717285156  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([1874, 500])
torch.Size([208, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.1194148063659668  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.04090595245361328  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([2131, 500])
torch.Size([458, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.21806049346923828  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.0379638671875  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([573, 500])
torch.Size([164, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.07071256637573242  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.039920806884765625  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([1615, 500])
torch.Size([380, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.13299560546875  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.04038810729980469  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([1487, 500])
torch.Size([220, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.11040925979614258  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.03773832321166992  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([454, 500])
torch.Size([87, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.06018495559692383  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.03753232955932617  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([344, 500])
torch.Size([100, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.05571556091308594  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.040390968322753906  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([1537, 500])
torch.Size([242, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.1234898567199707  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.037644386291503906  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes

torch.Size([404, 500])
torch.Size([103, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.05597734451293945  GigaBytes
Max Memory Allocated: 0.26813316345214844  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0028751214345296224 |0.000901333491007487 |0.10505639712015788 |0.00012178421020507813 |0.1399439811706543 |0.006445884704589844 |
----------------------------------------------------------pseudo_mini_loss sum 1.725727915763855
Total (block generation + training)time/epoch 3.934199333190918
Training time/epoch 3.76957106590271
Training time without block to device /epoch 3.7560510635375977
Training time without total dataloading part /epoch 3.6832783222198486
load block tensor time/epoch 0.043126821517944336
block to device time/epoch 0.013520002365112305
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  19202
Number of first layer input nodes during this epoch:  15759
