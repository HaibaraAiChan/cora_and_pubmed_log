main start at this time 1648529923.3198702
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0022416114807128906
range selection method range initialization spend 0.00014448165893554688
time for parepare:  4.458427429199219e-05
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0019693374633789062
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  5.2928924560546875e-05
----------------------check_connections_block total spend ----------------------------- 0.0030851364135742188
generate_one_block  0.0013051033020019531
generate_one_block  0.0011324882507324219
generate_one_block  0.001051187515258789
generate_one_block  0.0010914802551269531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0013298988342285156
gen group dst list time:  5.269050598144531e-05
time for parepare:  0.0002307891845703125
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.000362396240234375
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00019073486328125
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0002269744873046875
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0004911422729492188
----------------------check_connections_block total spend ----------------------------- 0.002669811248779297
generate_one_block  0.0015411376953125
generate_one_block  0.0012617111206054688
generate_one_block  0.0013384819030761719
generate_one_block  0.0016663074493408203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009777545928955078
gen group dst list time:  7.677078247070312e-05
time for parepare:  0.0020546913146972656
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00032019615173339844
mini_batch_src_global generation:  0.00018477439880371094
r_  generation:  0.0021893978118896484
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  0.00018334388732910156
r_  generation:  0.0013077259063720703
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  0.00013494491577148438
r_  generation:  0.001312255859375
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.0004355907440185547
mini_batch_src_global generation:  0.00024127960205078125
r_  generation:  0.0028400421142578125
----------------------check_connections_block total spend ----------------------------- 0.01382136344909668
generate_one_block  0.003951549530029297
generate_one_block  0.0026140213012695312
generate_one_block  0.0025141239166259766
generate_one_block  0.0044634342193603516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

connection checking time:  0.016491174697875977
block generation total time  0.019350767135620117
average batch blocks generation time:  0.004837691783905029
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014364242553710938  GigaBytes
Max Memory Allocated: 0.014364242553710938  GigaBytes

torch.Size([2814, 500])
torch.Size([774, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.23491525650024414  GigaBytes
Max Memory Allocated: 0.24288606643676758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.022545337677001953  GigaBytes
Max Memory Allocated: 0.24288606643676758  GigaBytes

torch.Size([2359, 500])
torch.Size([424, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.1512622833251953  GigaBytes
Max Memory Allocated: 0.24288606643676758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.02236032485961914  GigaBytes
Max Memory Allocated: 0.24288606643676758  GigaBytes

torch.Size([2260, 500])
torch.Size([534, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.14434432983398438  GigaBytes
Max Memory Allocated: 0.24288606643676758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.025989532470703125  GigaBytes
Max Memory Allocated: 0.24288606643676758  GigaBytes

torch.Size([4184, 500])
torch.Size([1079, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.3077554702758789  GigaBytes
Max Memory Allocated: 0.315976619720459  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0033615827560424805 |0.08714950084686279 |0.2282857894897461 |0.00016582012176513672 |0.1256822943687439 |0.0082855224609375 |
----------------------------------------------------------pseudo_mini_loss sum 1.819532036781311
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14784
Number of first layer input nodes during this epoch:  11617
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.0442047119140625  GigaBytes
Max Memory Allocated: 0.315976619720459  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005071163177490234
range selection method range initialization spend 5.078315734863281e-05
time for parepare:  5.0067901611328125e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011229515075683594Using backend: pytorch

mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  5.459785461425781e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.266334533691406e-05
----------------------check_connections_block total spend ----------------------------- 0.0011527538299560547
generate_one_block  0.0011789798736572266
generate_one_block  0.0011124610900878906
generate_one_block  0.0014300346374511719
generate_one_block  0.001092672348022461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005433559417724609
gen group dst list time:  3.4809112548828125e-05
time for parepare:  0.00024127960205078125
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00028634071350097656
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0004649162292480469
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0003311634063720703
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.00022220611572265625
----------------------check_connections_block total spend ----------------------------- 0.0028531551361083984
generate_one_block  0.001461029052734375
generate_one_block  0.0017101764678955078
generate_one_block  0.0014946460723876953
generate_one_block  0.0013470649719238281
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009577274322509766
gen group dst list time:  7.62939453125e-05
time for parepare:  0.0007073879241943359
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.00029206275939941406
mini_batch_src_global generation:  0.0001423358917236328
r_  generation:  0.0013890266418457031
local_output_nid generation:  8.416175842285156e-05
local_in_edges_tensor generation:  0.00024366378784179688
mini_batch_src_global generation:  0.0003688335418701172
r_  generation:  0.0029609203338623047
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  0.00020813941955566406
r_  generation:  0.0018427371978759766
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.0012655258178710938
----------------------check_connections_block total spend ----------------------------- 0.012262105941772461
generate_one_block  0.003077268600463867
generate_one_block  0.004858493804931641
generate_one_block  0.0033431053161621094
generate_one_block  0.002556324005126953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.0442047119140625  GigaBytes
Max Memory Allocated: 0.315976619720459  GigaBytes

connection checking time:  0.01511526107788086
block generation total time  0.019848108291625977
average batch blocks generation time:  0.004962027072906494
block dataloader generation time/epoch 0.06641626358032227
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.040755271911621094  GigaBytes
Max Memory Allocated: 0.315976619720459  GigaBytes

torch.Size([2413, 500])
torch.Size([576, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.1751699447631836  GigaBytes
Max Memory Allocated: 0.315976619720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.04410266876220703  GigaBytes
Max Memory Allocated: 0.315976619720459  GigaBytes

torch.Size([3758, 500])
torch.Size([912, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.3501567840576172  GigaBytes
Max Memory Allocated: 0.3624453544616699  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.0419011116027832  GigaBytes
Max Memory Allocated: 0.3624453544616699  GigaBytes

torch.Size([3022, 500])
torch.Size([781, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.21465396881103516  GigaBytes
Max Memory Allocated: 0.3624453544616699  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.04039955139160156  GigaBytes
Max Memory Allocated: 0.3624453544616699  GigaBytes

torch.Size([2224, 500])
torch.Size([486, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.1599416732788086  GigaBytes
Max Memory Allocated: 0.3624453544616699  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004255771636962891 |0.0008200407028198242 |0.11133873462677002 |0.00012969970703125 |0.12660491466522217 |0.011520862579345703 |
----------------------------------------------------------pseudo_mini_loss sum 1.6821057796478271
Total (block generation + training)time/epoch 1.0589375495910645
Training time/epoch 0.9922056198120117
Training time without block to device /epoch 0.9889254570007324
Training time without total dataloading part /epoch 0.9638142585754395
load block tensor time/epoch 0.017023086547851562
block to device time/epoch 0.003280162811279297
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14529
Number of first layer input nodes during this epoch:  11417
