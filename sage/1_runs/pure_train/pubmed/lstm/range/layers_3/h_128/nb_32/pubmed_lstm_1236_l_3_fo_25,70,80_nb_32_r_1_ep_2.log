main start at this time 1648530073.037444
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014450550079345703
range selection method range initialization spend 9.918212890625e-05
time for parepare:  4.601478576660156e-05
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.002394437789916992
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.239776611328125e-05
----------------------check_connections_block total spend ----------------------------- 0.0052106380462646484
generate_one_block  0.0012259483337402344
generate_one_block  0.0010471343994140625
generate_one_block  0.0010225772857666016
generate_one_block  0.0010166168212890625
generate_one_block  0.0010221004486083984
generate_one_block  0.0010225772857666016
generate_one_block  0.0010249614715576172
generate_one_block  0.0010635852813720703
generate_one_block  0.0010263919830322266
generate_one_block  0.001024007797241211
generate_one_block  0.001013040542602539
generate_one_block  0.0010230541229248047
generate_one_block  0.0010342597961425781
generate_one_block  0.0009455680847167969
generate_one_block  0.0010194778442382812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007829666137695312
gen group dst list time:  8.058547973632812e-05
time for parepare:  0.00026869773864746094
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0002696514129638672
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00010442733764648438
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  9.322166442871094e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  8.487701416015625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.653236389160156e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  9.179115295410156e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  4.887580871582031e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  9.965896606445312e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0003361701965332031
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00015091896057128906
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.482269287109375e-05
----------------------check_connections_block total spend ----------------------------- 0.004811763763427734
generate_one_block  0.0013594627380371094
generate_one_block  0.0011754035949707031
generate_one_block  0.0010762214660644531
generate_one_block  0.0010766983032226562
generate_one_block  0.0010595321655273438
generate_one_block  0.001142263412475586
generate_one_block  0.0011734962463378906
generate_one_block  0.0010504722595214844
generate_one_block  0.0010955333709716797
generate_one_block  0.0010406970977783203
generate_one_block  0.0009734630584716797
generate_one_block  0.0010576248168945312
generate_one_block  0.0014300346374511719
generate_one_block  0.00110626220703125
generate_one_block  0.0010135173797607422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010912418365478516
gen group dst list time:  0.00012826919555664062
time for parepare:  0.0007555484771728516
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0003666877746582031
mini_batch_src_global generation:  0.0001347064971923828
r_  generation:  0.0015115737915039062
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.00051116943359375
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.00023627281188964844
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0002765655517578125
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00019550323486328125
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0007109642028808594
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0006084442138671875
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00015544891357421875
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0003743171691894531
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0003962516784667969
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00019598007202148438
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0007328987121582031
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  0.00021028518676757812
r_  generation:  0.002062559127807617
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  0.0001270771026611328
r_  generation:  0.0009126663208007812
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00025773048400878906
----------------------check_connections_block total spend ----------------------------- 0.016451358795166016
generate_one_block  0.003152608871459961
generate_one_block  0.0015172958374023438
generate_one_block  0.0012025833129882812
generate_one_block  0.0012471675872802734
generate_one_block  0.0011589527130126953
generate_one_block  0.0018856525421142578
generate_one_block  0.001638650894165039
generate_one_block  0.0010824203491210938
generate_one_block  0.0013489723205566406
generate_one_block  0.001344919204711914
generate_one_block  0.0011296272277832031
generate_one_block  0.0018787384033203125
generate_one_block  0.0034689903259277344
generate_one_block  0.002234220504760742
generate_one_block  0.0012116432189941406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.009057044982910156  GigaBytes
Max Memory Allocated: 0.009057044982910156  GigaBytes

connection checking time:  0.02126312255859375
block generation total time  0.042333126068115234
average batch blocks generation time:  0.002822208404541016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.012263298034667969  GigaBytes
Max Memory Allocated: 0.012263298034667969  GigaBytes

torch.Size([1697, 500])
torch.Size([457, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.16422605514526367  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.020099639892578125  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

torch.Size([695, 500])
torch.Size([212, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.06479549407958984  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.01949167251586914  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

torch.Size([373, 500])
torch.Size([105, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.03928375244140625  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.019798755645751953  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

torch.Size([537, 500])
torch.Size([87, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.044541358947753906  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.01953601837158203  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

torch.Size([397, 500])
torch.Size([97, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.03590726852416992  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.020830154418945312  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

torch.Size([1084, 500])
torch.Size([226, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.09010457992553711  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.021167278289794922  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

torch.Size([1267, 500])
torch.Size([156, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.07831811904907227  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.01928091049194336  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

torch.Size([261, 500])
torch.Size([55, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.030741214752197266  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.01987600326538086  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

torch.Size([577, 500])
torch.Size([147, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.054823875427246094  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.019911766052246094  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

torch.Size([596, 500])
torch.Size([177, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.05468273162841797  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.019451141357421875  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

torch.Size([352, 500])
torch.Size([91, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.03426551818847656  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.0225372314453125  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

torch.Size([1696, 500])
torch.Size([220, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.09346437454223633  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.024344921112060547  GigaBytes
Max Memory Allocated: 0.17131328582763672  GigaBytes

torch.Size([2951, 500])
torch.Size([693, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.2239542007446289  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.02254009246826172  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([1533, 500])
torch.Size([311, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.10304975509643555  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.019643306732177734  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([454, 500])
torch.Size([74, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.040758609771728516  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0027754783630371095 |0.023710600535074868 |0.10694352785746257 |0.00012682278951009113 |0.08466869990030924 |0.007959127426147461 |
----------------------------------------------------------pseudo_mini_loss sum 2.1297953128814697
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17935
Number of first layer input nodes during this epoch:  14470
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.03799009323120117  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005095005035400391
range selection method range initialization spend 5.4836273193359375e-05
time for parepare:  5.53131103515625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.1682510375976562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.4781951904296875e-05
----------------------check_connections_block total spend ----------------------------- 0.002808094024658203
generate_one_block  0.001134634017944336
generate_one_block  0.0010449886322021484
generate_one_block  0.0010766983032226562
generate_one_block  0.00104522705078125
generate_one_block  0.0010409355163574219
generate_one_block  0.0010263919830322266
generate_one_block  0.0010521411895751953
generate_one_block  0.001180887222290039
generate_one_block  0.0010378360748291016
generate_one_block  0.0010554790496826172
generate_one_block  0.0010323524475097656
generate_one_block  0.0010251998901367188
generate_one_block  0.0010259151458740234
generate_one_block  0.0010552406311035156
generate_one_block  0.0010328292846679688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000579833984375
gen group dst list time:  8.392333984375e-05
time for parepare:  0.0002892017364501953
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  7.224082946777344e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001823902130126953
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00021123886108398438
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00010943412780761719
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.57763671875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  9.822845458984375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0002238750457763672
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00015544891357421875
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00010752677917480469
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.14984130859375e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00012874603271484375
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.6743621826171875e-05
----------------------check_connections_block total spend ----------------------------- 0.004958391189575195
generate_one_block  0.0011625289916992188
generate_one_block  0.001066446304321289
generate_one_block  0.0012679100036621094
generate_one_block  0.001344442367553711
generate_one_block  0.0012400150299072266
generate_one_block  0.0010769367218017578
generate_one_block  0.0011649131774902344
generate_one_block  0.0013511180877685547
generate_one_block  0.0010406970977783203
generate_one_block  0.001157522201538086
generate_one_block  0.0010714530944824219
generate_one_block  0.0009877681732177734
generate_one_block  0.0010113716125488281
generate_one_block  0.0011072158813476562
generate_one_block  0.0010089874267578125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012083053588867188
gen group dst list time:  0.00014352798461914062
time for parepare:  0.0008909702301025391
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0002486705780029297
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0003027915954589844
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00015282630920410156
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.0008742809295654297
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.00020074844360351562
r_  generation:  0.0014183521270751953
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.0005838871002197266
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.00023412704467773438
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0007262229919433594
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  0.00019931793212890625
r_  generation:  0.0015447139739990234
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0003695487976074219
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  9.131431579589844e-05
r_  generation:  0.0008494853973388672
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0006506443023681641
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0002536773681640625
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00020074844360351562
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  8.463859558105469e-05
r_  generation:  0.0007805824279785156
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.00021505355834960938
----------------------check_connections_block total spend ----------------------------- 0.017113208770751953
generate_one_block  0.0015170574188232422
generate_one_block  0.0012750625610351562
generate_one_block  0.0019769668579101562
generate_one_block  0.002661466598510742
generate_one_block  0.0016140937805175781
generate_one_block  0.0012187957763671875
generate_one_block  0.0019290447235107422
generate_one_block  0.0028390884399414062
generate_one_block  0.0013659000396728516
generate_one_block  0.001981496810913086
generate_one_block  0.001748800277709961
generate_one_block  0.001276254653930664
generate_one_block  0.0011904239654541016
generate_one_block  0.0018668174743652344
generate_one_block  0.0012676715850830078
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.03799009323120117  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

connection checking time:  0.02207159996032715
block generation total time  0.04278826713562012
average batch blocks generation time:  0.0028525511423746746
block dataloader generation time/epoch 0.13346552848815918
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.0379796028137207  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([454, 500])
torch.Size([125, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.06373882293701172  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.037677764892578125  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([294, 500])
torch.Size([53, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.049599647521972656  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.039890289306640625  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([1471, 500])
torch.Size([329, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.11938190460205078  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.039728641510009766  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([1375, 500])
torch.Size([371, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1835322380065918  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03878641128540039  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([883, 500])
torch.Size([173, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.08919000625610352  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03786945343017578  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([396, 500])
torch.Size([75, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.055789947509765625  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.04021501541137695  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([1648, 500])
torch.Size([208, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.10696125030517578  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.04083967208862305  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([1970, 500])
torch.Size([458, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.19238615036010742  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.038106441497802734  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([521, 500])
torch.Size([164, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.06796836853027344  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03978586196899414  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([1415, 500])
torch.Size([380, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.11841773986816406  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03950977325439453  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([1270, 500])
torch.Size([220, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.09855222702026367  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03789377212524414  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([409, 500])
torch.Size([87, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.057288169860839844  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03772449493408203  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([318, 500])
torch.Size([100, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.05418539047241211  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03968238830566406  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([1361, 500])
torch.Size([242, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.11232662200927734  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.0378565788269043  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

torch.Size([389, 500])Using backend: pytorch

torch.Size([103, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.054761409759521484  GigaBytes
Max Memory Allocated: 0.23127174377441406  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002814769744873047 |0.0008897940317789713 |0.07583001454671225 |0.0001174608866373698 |0.0883923848470052 |0.006376028060913086 |
----------------------------------------------------------pseudo_mini_loss sum 1.8342927694320679
Total (block generation + training)time/epoch 2.688107490539551
Training time/epoch 2.5543134212493896
Training time without block to device /epoch 2.540966510772705
Training time without total dataloading part /epoch 2.4714739322662354
load block tensor time/epoch 0.0422215461730957
block to device time/epoch 0.01334691047668457
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17619
Number of first layer input nodes during this epoch:  14174
