main start at this time 1648532686.4834173
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0014805793762207031
range selection method range initialization spend 9.584426879882812e-05
time for parepare:  4.482269287109375e-05
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00146484375
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.09808349609375e-05
----------------------check_connections_block total spend ----------------------------- 0.003202199935913086
generate_one_block  0.0012679100036621094
generate_one_block  0.0010519027709960938
generate_one_block  0.0010578632354736328
generate_one_block  0.001058340072631836
generate_one_block  0.0010309219360351562
generate_one_block  0.001077890396118164
generate_one_block  0.0010292530059814453
generate_one_block  0.0010421276092529297
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0008673667907714844
gen group dst list time:  5.054473876953125e-05
time for parepare:  0.000240325927734375
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0003228187561035156
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00012230873107910156
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0002117156982421875
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0002315044403076172
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00013518333435058594
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00013637542724609375
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.940696716308594e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0001590251922607422
----------------------check_connections_block total spend ----------------------------- 0.003498554229736328
generate_one_block  0.0014832019805908203
generate_one_block  0.0011670589447021484
generate_one_block  0.0013206005096435547
generate_one_block  0.0013256072998046875
generate_one_block  0.0012433528900146484
generate_one_block  0.001207113265991211
generate_one_block  0.0011279582977294922
generate_one_block  0.0012481212615966797
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011458396911621094
gen group dst list time:  0.00010037422180175781
time for parepare:  0.0007648468017578125
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.0003006458282470703
mini_batch_src_global generation:  0.00021529197692871094
r_  generation:  0.0023145675659179688
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  0.00012040138244628906
r_  generation:  0.00067901611328125
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  0.00011324882507324219
r_  generation:  0.001262664794921875
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  0.0001354217529296875
r_  generation:  0.0012993812561035156
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.0007736682891845703
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.0009253025054931641
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0005347728729248047
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.001344919204711914
----------------------check_connections_block total spend ----------------------------- 0.015077829360961914
generate_one_block  0.004597902297973633
generate_one_block  0.0016987323760986328
generate_one_block  0.002382040023803711
generate_one_block  0.0025048255920410156
generate_one_block  0.0017533302307128906
generate_one_block  0.001965761184692383
generate_one_block  0.0016298294067382812
generate_one_block  0.002518177032470703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020601749420166016
gen group dst list time:  0.0002865791320800781
time for parepare:  0.0016016960144042969
local_output_nid generation:  0.00023412704467773438
local_in_edges_tensor generation:  0.0008063316345214844
mini_batch_src_global generation:  0.0010013580322265625
r_  generation:  0.009480953216552734
local_output_nid generation:  0.00011610984802246094
local_in_edges_tensor generation:  0.0003209114074707031
mini_batch_src_global generation:  0.0006551742553710938
r_  generation:  0.004441022872924805
local_output_nid generation:  0.00016427040100097656
local_in_edges_tensor generation:  0.0004074573516845703
mini_batch_src_global generation:  0.0005934238433837891
r_  generation:  0.005537509918212891
local_output_nid generation:  0.00016999244689941406
local_in_edges_tensor generation:  0.00038242340087890625
mini_batch_src_global generation:  0.0005109310150146484
r_  generation:  0.0054280757904052734
local_output_nid generation:  0.00010418891906738281
local_in_edges_tensor generation:  0.00028324127197265625
mini_batch_src_global generation:  0.0004260540008544922
r_  generation:  0.004088163375854492
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.00033473968505859375
mini_batch_src_global generation:  0.0005204677581787109
r_  generation:  0.004894733428955078
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  0.00039386749267578125
r_  generation:  0.0034296512603759766
local_output_nid generation:  0.00011467933654785156
local_in_edges_tensor generation:  0.000301361083984375
mini_batch_src_global generation:  0.00045013427734375
r_  generation:  0.004631757736206055
----------------------check_connections_block total spend ----------------------------- 0.0628204345703125
generate_one_block  0.013283967971801758
generate_one_block  0.00720977783203125
generate_one_block  0.009398221969604492
generate_one_block  0.008707046508789062
generate_one_block  0.0066454410552978516
generate_one_block  0.00834965705871582
generate_one_block  0.00552821159362793
generate_one_block  0.006960630416870117
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00202178955078125
gen group dst list time:  0.0014758110046386719
time for parepare:  0.0018143653869628906
local_output_nid generation:  0.0007793903350830078
local_in_edges_tensor generation:  0.0017266273498535156
mini_batch_src_global generation:  0.0017938613891601562
r_  generation:  0.018975019454956055
local_output_nid generation:  0.0005309581756591797
local_in_edges_tensor generation:  0.0011093616485595703
mini_batch_src_global generation:  0.0015957355499267578
r_  generation:  0.01346445083618164
local_output_nid generation:  0.0008187294006347656
local_in_edges_tensor generation:  0.00140380859375
mini_batch_src_global generation:  0.0011968612670898438
r_  generation:  0.016253948211669922
local_output_nid generation:  0.0007393360137939453
local_in_edges_tensor generation:  0.0010402202606201172
mini_batch_src_global generation:  0.0012912750244140625
r_  generation:  0.015510797500610352
local_output_nid generation:  0.0006058216094970703
local_in_edges_tensor generation:  0.0009284019470214844
mini_batch_src_global generation:  0.0012111663818359375
r_  generation:  0.014728307723999023
local_output_nid generation:  0.0006670951843261719
local_in_edges_tensor generation:  0.0009777545928955078
mini_batch_src_global generation:  0.0011858940124511719
r_  generation:  0.015367269515991211
local_output_nid generation:  0.00043010711669921875
local_in_edges_tensor generation:  0.0006806850433349609
mini_batch_src_global generation:  0.0010447502136230469
r_  generation:  0.01073455810546875
local_output_nid generation:  0.000392913818359375
local_in_edges_tensor generation:  0.0006868839263916016
mini_batch_src_global generation:  0.0009427070617675781
r_  generation:  0.00917673110961914
----------------------check_connections_block total spend ----------------------------- 0.16654706001281738
generate_one_block  0.02541828155517578
generate_one_block  0.018288850784301758
generate_one_block  0.02100992202758789
generate_one_block  0.020145654678344727
generate_one_block  0.018845558166503906
generate_one_block  0.020190715789794922
generate_one_block  0.014698028564453125
generate_one_block  0.013907670974731445
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

connection checking time:  0.24794387817382812
block generation total time  0.24776124954223633
average batch blocks generation time:  0.03097015619277954
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1307373046875 GB
    Memory Allocated: 0.03763914108276367  GigaBytes
Max Memory Allocated: 0.03763914108276367  GigaBytes

torch.Size([15648, 500])
torch.Size([9736, 16])
torch.Size([3283, 16])
torch.Size([595, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2362060546875 GB
    Memory Allocated: 1.8620538711547852  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2362060546875 GB
    Memory Allocated: 0.03829765319824219  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

torch.Size([12184, 500])
torch.Size([5437, 16])
torch.Size([1312, 16])
torch.Size([206, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.3272857666015625  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.04267072677612305  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

torch.Size([14475, 500])
torch.Size([8969, 16])
torch.Size([2041, 16])
torch.Size([485, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 1.5458407402038574  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 0.04229879379272461  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

torch.Size([14287, 500])
torch.Size([7934, 16])
torch.Size([2175, 16])
torch.Size([479, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 1.4949254989624023  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 0.03906822204589844  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

torch.Size([12487, 500])
torch.Size([6952, 16])
torch.Size([1222, 16])
torch.Size([317, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 1.4183692932128906  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 0.040637969970703125  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

torch.Size([13400, 500])
torch.Size([7174, 16])
torch.Size([1552, 16])
torch.Size([312, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 1.506211280822754  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 0.03252267837524414  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

torch.Size([9128, 500])
torch.Size([4796, 16])
torch.Size([919, 16])
torch.Size([198, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 1.0545110702514648  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 0.030951499938964844  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

torch.Size([8258, 500])
torch.Size([4423, 16])
torch.Size([1470, 16])
torch.Size([323, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 1.005925178527832  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01228359341621399 |0.045212626457214355 |0.29257962107658386 |0.00016352534294128418 |0.30764636397361755 |0.011671781539916992 |
----------------------------------------------------------pseudo_mini_loss sum 1.58402419090271
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  172534
Number of first layer input nodes during this epoch:  99867
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 0.04716157913208008  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005855560302734375
range selection method range initialization spend 7.009506225585938e-05
time for parepare:  7.224082946777344e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.09808349609375e-05
----------------------check_connections_block total spend ----------------------------- 0.0019161701202392578
generate_one_block  0.0012974739074707031
generate_one_block  0.0013854503631591797
generate_one_block  0.0010998249053955078
generate_one_block  0.0011038780212402344
generate_one_block  0.0010895729064941406
generate_one_block  0.001093149185180664
generate_one_block  0.0010764598846435547
generate_one_block  0.0010669231414794922
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005970001220703125
gen group dst list time:  6.008148193359375e-05
time for parepare:  0.0003521442413330078
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.0003905296325683594
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0001811981201171875
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00018095970153808594
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00031113624572753906
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00014829635620117188
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00014138221740722656
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  9.894371032714844e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  8.535385131835938e-05
----------------------check_connections_block total spend ----------------------------- 0.004042148590087891
generate_one_block  0.0017185211181640625
generate_one_block  0.0013239383697509766
generate_one_block  0.0013430118560791016
generate_one_block  0.0015151500701904297
generate_one_block  0.001268148422241211
generate_one_block  0.0013353824615478516
generate_one_block  0.0011873245239257812
generate_one_block  0.001123666763305664
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011775493621826172
gen group dst list time:  0.00012731552124023438
time for parepare:  0.0009431838989257812
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.0004024505615234375
mini_batch_src_global generation:  0.0003695487976074219
r_  generation:  0.0024802684783935547
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  0.0001685619354248047
r_  generation:  0.0010313987731933594
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0009708404541015625
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  0.000217437744140625
r_  generation:  0.0022165775299072266
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  0.00015425682067871094
r_  generation:  0.001001596450805664
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  0.00011610984802246094
r_  generation:  0.0008413791656494141
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0005257129669189453
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0004138946533203125
----------------------check_connections_block total spend ----------------------------- 0.016544342041015625
generate_one_block  0.004703521728515625
generate_one_block  0.0022559165954589844
generate_one_block  0.0022029876708984375
generate_one_block  0.0037937164306640625
generate_one_block  0.0023605823516845703
generate_one_block  0.0019927024841308594
generate_one_block  0.0016880035400390625
generate_one_block  0.0015065670013427734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019676685333251953
gen group dst list time:  0.00036907196044921875
time for parepare:  0.0015997886657714844
local_output_nid generation:  0.0003917217254638672
local_in_edges_tensor generation:  0.0011014938354492188
mini_batch_src_global generation:  0.0010814666748046875
r_  generation:  0.009978294372558594
local_output_nid generation:  0.0001628398895263672
local_in_edges_tensor generation:  0.00039005279541015625
mini_batch_src_global generation:  0.0007851123809814453
r_  generation:  0.0054585933685302734
local_output_nid generation:  0.00016498565673828125
local_in_edges_tensor generation:  0.00036597251892089844
mini_batch_src_global generation:  0.0005156993865966797
r_  generation:  0.004603147506713867
local_output_nid generation:  0.0002512931823730469
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0006401538848876953
r_  generation:  0.00702214241027832
local_output_nid generation:  0.00021958351135253906
local_in_edges_tensor generation:  0.0004093647003173828
mini_batch_src_global generation:  0.0005588531494140625
r_  generation:  0.005403995513916016
local_output_nid generation:  0.00015854835510253906
local_in_edges_tensor generation:  0.0003292560577392578
mini_batch_src_global generation:  0.00048661231994628906
r_  generation:  0.004263162612915039
local_output_nid generation:  0.00010228157043457031
local_in_edges_tensor generation:  0.00027561187744140625
mini_batch_src_global generation:  0.0003650188446044922
r_  generation:  0.0031282901763916016
local_output_nid generation:  9.226799011230469e-05
local_in_edges_tensor generation:  0.0002391338348388672
mini_batch_src_global generation:  0.00026702880859375
r_  generation:  0.0023446083068847656
----------------------check_connections_block total spend ----------------------------- 0.06465816497802734
generate_one_block  0.014367341995239258
generate_one_block  0.010295867919921875
generate_one_block  0.008657693862915039
generate_one_block  0.011820793151855469
generate_one_block  0.008761405944824219
generate_one_block  0.006855964660644531
generate_one_block  0.00540471076965332
generate_one_block  0.00417780876159668
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002332448959350586
gen group dst list time:  0.0013973712921142578
time for parepare:  0.0018677711486816406
local_output_nid generation:  0.0009646415710449219
local_in_edges_tensor generation:  0.0021562576293945312
mini_batch_src_global generation:  0.0018815994262695312
r_  generation:  0.019042491912841797
local_output_nid generation:  0.000865936279296875
local_in_edges_tensor generation:  0.0014615058898925781
mini_batch_src_global generation:  0.0018360614776611328
r_  generation:  0.015893220901489258
local_output_nid generation:  0.0008933544158935547
local_in_edges_tensor generation:  0.0011208057403564453
mini_batch_src_global generation:  0.0011327266693115234
r_  generation:  0.013830184936523438
local_output_nid generation:  0.0008578300476074219
local_in_edges_tensor generation:  0.0010771751403808594
mini_batch_src_global generation:  0.0011639595031738281
r_  generation:  0.015468597412109375
local_output_nid generation:  0.00089263916015625
local_in_edges_tensor generation:  0.0012347698211669922
mini_batch_src_global generation:  0.0015146732330322266
r_  generation:  0.016843795776367188
local_output_nid generation:  0.0007491111755371094
local_in_edges_tensor generation:  0.0009982585906982422
mini_batch_src_global generation:  0.001190185546875
r_  generation:  0.014844417572021484
local_output_nid generation:  0.0005970001220703125
local_in_edges_tensor generation:  0.0008149147033691406
mini_batch_src_global generation:  0.0010061264038085938
r_  generation:  0.010644674301147461
local_output_nid generation:  0.0004954338073730469
local_in_edges_tensor generation:  0.0006906986236572266
mini_batch_src_global generation:  0.0009462833404541016
r_  generation:  0.008974790573120117
----------------------check_connections_block total spend ----------------------------- 0.17143750190734863
generate_one_block  0.026801586151123047
generate_one_block  0.02222132682800293
generate_one_block  0.018527984619140625
generate_one_block  0.021395206451416016
generate_one_block  0.024024486541748047
generate_one_block  0.02082967758178711
generate_one_block  0.016354799270629883
generate_one_block  0.014626502990722656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 0.04716157913208008  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

connection checking time:  0.2566821575164795
block generation total time  0.26644229888916016
average batch blocks generation time:  0.03330528736114502
block dataloader generation time/epoch 0.6472959518432617
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 0.06077718734741211  GigaBytes
Max Memory Allocated: 1.968167781829834  GigaBytes

torch.Size([15580, 500])
torch.Size([9795, 16])
torch.Size([3473, 16])
torch.Size([684, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 1.8788599967956543  GigaBytes
Max Memory Allocated: 1.9833598136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 0.05610036849975586  GigaBytes
Max Memory Allocated: 1.9833598136901855  GigaBytes

torch.Size([13340, 500])
torch.Size([7941, 16])
torch.Size([1470, 16])
torch.Size([360, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 1.5379271507263184  GigaBytes
Max Memory Allocated: 1.9833598136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 0.054680824279785156  GigaBytes
Max Memory Allocated: 1.9833598136901855  GigaBytes

torch.Size([12623, 500])
torch.Size([7564, 16])
torch.Size([1510, 16])
torch.Size([386, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 1.2889347076416016  GigaBytes
Max Memory Allocated: 1.9833598136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 0.05519914627075195  GigaBytes
Max Memory Allocated: 1.9833598136901855  GigaBytes

torch.Size([12805, 500])
torch.Size([7207, 16])
torch.Size([2325, 16])
torch.Size([557, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 1.536259651184082  GigaBytes
Max Memory Allocated: 1.9833598136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 0.05912446975708008  GigaBytes
Max Memory Allocated: 1.9833598136901855  GigaBytes

torch.Size([14943, 500])
torch.Size([7917, 16])
torch.Size([1983, 16])
torch.Size([315, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 1.6673402786254883  GigaBytes
Max Memory Allocated: 1.9833598136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 0.05595731735229492  GigaBytes
Max Memory Allocated: 1.9833598136901855  GigaBytes

torch.Size([13291, 500])
torch.Size([6427, 16])
torch.Size([1425, 16])
torch.Size([255, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 1.4566264152526855  GigaBytes
Max Memory Allocated: 1.9833598136901855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 0.04870748519897461  GigaBytes
Max Memory Allocated: 1.9833598136901855  GigaBytes

torch.Size([9472, 500])
torch.Size([4686, 16])
torch.Size([886, 16])
torch.Size([182, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 1.0421347618103027  GigaBytes
Max Memory Allocated: 1.9833598136901855  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 0.0506134033203125  GigaBytes
Max Memory Allocated: 1.9833598136901855  GigaBytes

torch.Size([10513, 500])
torch.Size([3905, 16])
torch.Size([797, 16])
torch.Size([158, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4608154296875 GB
    Memory Allocated: 1.0107340812683105  GigaBytes
Max Memory Allocated: 1.9833598136901855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01052248477935791 |0.002000182867050171 |0.23071515560150146 |0.000138014554977417 |0.298334538936615 |0.008945941925048828 |
----------------------------------------------------------pseudo_mini_loss sum 1.301370620727539
Total (block generation + training)time/epoch 5.010016441345215
Training time/epoch 4.362447261810303
Training time without block to device /epoch 4.346445798873901
Training time without total dataloading part /epoch 4.2424476146698
load block tensor time/epoch 0.08417987823486328
block to device time/epoch 0.016001462936401367
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  175132
Number of first layer input nodes during this epoch:  102567
