main start at this time 1648532645.3958077
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0020568370819091797
range selection method range initialization spend 6.747245788574219e-05
time for parepare:  4.220008850097656e-05
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0012023448944091797
----------------------check_connections_block total spend ----------------------------- 0.001644134521484375
generate_one_block  0.001438140869140625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001081228256225586
gen group dst list time:  1.9073486328125e-05
time for parepare:  0.00022172927856445312
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.0011730194091796875
----------------------check_connections_block total spend ----------------------------- 0.002103567123413086
generate_one_block  0.0026400089263916016
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010695457458496094
gen group dst list time:  5.435943603515625e-05
time for parepare:  0.0007054805755615234
local_output_nid generation:  0.0001575946807861328
local_in_edges_tensor generation:  0.0005011558532714844
mini_batch_src_global generation:  0.0006492137908935547
r_  generation:  0.00650334358215332
----------------------check_connections_block total spend ----------------------------- 0.010462522506713867
generate_one_block  0.010453939437866211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002012968063354492
gen group dst list time:  0.00014209747314453125
time for parepare:  0.0014090538024902344
local_output_nid generation:  0.0004868507385253906
local_in_edges_tensor generation:  0.0012700557708740234
mini_batch_src_global generation:  0.001827239990234375
r_  generation:  0.01717066764831543
----------------------check_connections_block total spend ----------------------------- 0.02730584144592285
generate_one_block  0.023795604705810547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020248889923095703
gen group dst list time:  0.00027441978454589844
time for parepare:  0.0015611648559570312
local_output_nid generation:  0.0009989738464355469
local_in_edges_tensor generation:  0.0022716522216796875
mini_batch_src_global generation:  0.0021257400512695312
r_  generation:  0.02367877960205078
----------------------check_connections_block total spend ----------------------------- 0.03681373596191406
generate_one_block  0.030280351638793945
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

connection checking time:  0.07668566703796387
block generation total time  0.0671699047088623
average batch blocks generation time:  0.0671699047088623
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.04396390914916992  GigaBytes
Max Memory Allocated: 0.04396390914916992  GigaBytes

torch.Size([18650, 500])
torch.Size([16196, 16])
torch.Size([8106, 16])
torch.Size([2581, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8612060546875 GB
    Memory Allocated: 2.4280076026916504  GigaBytes
Max Memory Allocated: 2.542109966278076  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014135599136352539 |0.34710001945495605 |0.8271679878234863 |0.00022912025451660156 |0.3974885940551758 |0.01524496078491211 |
----------------------------------------------------------pseudo_mini_loss sum 1.5359517335891724
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  45887
Number of first layer input nodes during this epoch:  18650
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 0.06931400299072266  GigaBytes
Max Memory Allocated: 2.542109966278076  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005128383636474609
range selection method range initialization spend 5.1975250244140625e-05
time for parepare:  4.9591064453125e-05
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0001049041748046875
----------------------check_connections_block total spend ----------------------------- 0.0004999637603759766
generate_one_block  0.0014386177062988281
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005588531494140625
gen group dst list time:  2.002716064453125e-05
time for parepare:  0.0002484321594238281
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.000225067138671875
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0011432170867919922
----------------------check_connections_block total spend ----------------------------- 0.0020952224731445312
generate_one_block  0.0032172203063964844
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009751319885253906
gen group dst list time:  6.151199340820312e-05
time for parepare:  0.000675201416015625
local_output_nid generation:  0.00017213821411132812
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.0005745887756347656
r_  generation:  0.006554841995239258
----------------------check_connections_block total spend ----------------------------- 0.010443687438964844
generate_one_block  0.011047124862670898
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002021312713623047
gen group dst list time:  0.00014138221740722656
time for parepare:  0.0012612342834472656
local_output_nid generation:  0.0005245208740234375
local_in_edges_tensor generation:  0.0013086795806884766
mini_batch_src_global generation:  0.0015833377838134766
r_  generation:  0.016993999481201172
----------------------check_connections_block total spend ----------------------------- 0.02654743194580078
generate_one_block  0.0259549617767334
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002122163772583008
gen group dst list time:  0.0002951622009277344
time for parepare:  0.0013990402221679688
local_output_nid generation:  0.0010755062103271484
local_in_edges_tensor generation:  0.002280712127685547
mini_batch_src_global generation:  0.0022919178009033203
r_  generation:  0.02353811264038086
----------------------check_connections_block total spend ----------------------------- 0.03653740882873535
generate_one_block  0.03341197967529297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 0.06931400299072266  GigaBytes
Max Memory Allocated: 2.542109966278076  GigaBytes

connection checking time:  0.07562375068664551
block generation total time  0.07363128662109375
average batch blocks generation time:  0.07363128662109375
block dataloader generation time/epoch 0.17878437042236328Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8631591796875 GB
    Memory Allocated: 0.06681489944458008  GigaBytes
Max Memory Allocated: 2.542109966278076  GigaBytes

torch.Size([18658, 500])
torch.Size([16225, 16])
torch.Size([8078, 16])
torch.Size([2574, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 2.454056739807129  GigaBytes
Max Memory Allocated: 2.569732189178467  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013686180114746094 |0.001493692398071289 |0.32358264923095703 |0.00013327598571777344 |0.4040539264678955 |0.008592844009399414 |
----------------------------------------------------------pseudo_mini_loss sum 1.496242880821228
Total (block generation + training)time/epoch 0.9500775337219238
Training time/epoch 0.7710356712341309
Training time without block to device /epoch 0.7695419788360596
Training time without total dataloading part /epoch 0.7363626956939697
load block tensor time/epoch 0.013686180114746094
block to device time/epoch 0.001493692398071289
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.1920928955078125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  45889
Number of first layer input nodes during this epoch:  18658
