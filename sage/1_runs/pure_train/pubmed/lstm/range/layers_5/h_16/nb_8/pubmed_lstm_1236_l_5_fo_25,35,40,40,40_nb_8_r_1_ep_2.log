main start at this time 1648532670.3407187
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0019822120666503906
range selection method range initialization spend 8.440017700195312e-05
time for parepare:  5.8650970458984375e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00029468536376953125
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0016145706176757812
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.361701965332031e-05
----------------------check_connections_block total spend ----------------------------- 0.0028862953186035156
generate_one_block  0.0014979839324951172
generate_one_block  0.0013241767883300781
generate_one_block  0.0012545585632324219
generate_one_block  0.0012698173522949219
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013451576232910156
gen group dst list time:  4.410743713378906e-05
time for parepare:  0.0003139972686767578
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0005061626434326172
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0004990100860595703
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00026106834411621094
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00034356117248535156
----------------------check_connections_block total spend ----------------------------- 0.0034084320068359375
generate_one_block  0.0019366741180419922
generate_one_block  0.0019524097442626953
generate_one_block  0.0015630722045898438
generate_one_block  0.001680135726928711
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012607574462890625
gen group dst list time:  9.179115295410156e-05
time for parepare:  0.0009081363677978516
local_output_nid generation:  7.653236389160156e-05
local_in_edges_tensor generation:  0.0003685951232910156
mini_batch_src_global generation:  0.0003333091735839844
r_  generation:  0.003448486328125
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.0002827644348144531
mini_batch_src_global generation:  0.0003523826599121094
r_  generation:  0.0027971267700195312
local_output_nid generation:  6.222724914550781e-05
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  0.00019168853759765625
r_  generation:  0.0015523433685302734
local_output_nid generation:  6.771087646484375e-05
local_in_edges_tensor generation:  0.00024819374084472656
mini_batch_src_global generation:  0.0002510547637939453
r_  generation:  0.002373218536376953
----------------------check_connections_block total spend ----------------------------- 0.016460180282592773
generate_one_block  0.00504755973815918
generate_one_block  0.0036842823028564453
generate_one_block  0.002395153045654297
generate_one_block  0.0034923553466796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00243377685546875
gen group dst list time:  0.0003066062927246094
time for parepare:  0.0018897056579589844
local_output_nid generation:  0.00037598609924316406
local_in_edges_tensor generation:  0.0010461807250976562
mini_batch_src_global generation:  0.0012593269348144531
r_  generation:  0.01153874397277832
local_output_nid generation:  0.0002770423889160156
local_in_edges_tensor generation:  0.0006113052368164062
mini_batch_src_global generation:  0.0011720657348632812
r_  generation:  0.008619546890258789
local_output_nid generation:  0.0002079010009765625
local_in_edges_tensor generation:  0.0011386871337890625
mini_batch_src_global generation:  0.0006773471832275391
r_  generation:  0.006196498870849609
local_output_nid generation:  0.0002040863037109375
local_in_edges_tensor generation:  0.0004756450653076172
mini_batch_src_global generation:  0.0006697177886962891
r_  generation:  0.0069751739501953125
----------------------check_connections_block total spend ----------------------------- 0.051569461822509766
generate_one_block  0.015336990356445312
generate_one_block  0.013210773468017578
generate_one_block  0.010572671890258789
generate_one_block  0.010490655899047852
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019588470458984375
gen group dst list time:  0.0007874965667724609
time for parepare:  0.0018939971923828125
local_output_nid generation:  0.0008740425109863281
local_in_edges_tensor generation:  0.0019114017486572266
mini_batch_src_global generation:  0.002139568328857422
r_  generation:  0.020473718643188477
local_output_nid generation:  0.0010821819305419922
local_in_edges_tensor generation:  0.001981496810913086
mini_batch_src_global generation:  0.0022165775299072266
r_  generation:  0.02005600929260254
local_output_nid generation:  0.0010223388671875
local_in_edges_tensor generation:  0.0014622211456298828
mini_batch_src_global generation:  0.0014276504516601562
r_  generation:  0.01854252815246582
local_output_nid generation:  0.0007634162902832031
local_in_edges_tensor generation:  0.0010461807250976562
mini_batch_src_global generation:  0.0013058185577392578
r_  generation:  0.015191078186035156
----------------------check_connections_block total spend ----------------------------- 0.11054229736328125
generate_one_block  0.025774240493774414
generate_one_block  0.026404142379760742
generate_one_block  0.02409195899963379
generate_one_block  0.0204622745513916
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

connection checking time:  0.18198037147521973
block generation total time  0.16809535026550293
average batch blocks generation time:  0.04202383756637573
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1326904296875 GB
    Memory Allocated: 0.03968381881713867  GigaBytes
Max Memory Allocated: 0.03968381881713867  GigaBytes

torch.Size([16619, 500])
torch.Size([11049, 16])
torch.Size([4093, 16])
torch.Size([780, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 2.0080814361572266  GigaBytes
Max Memory Allocated: 2.121234893798828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.04708147048950195  GigaBytes
Max Memory Allocated: 2.121234893798828  GigaBytes

torch.Size([16361, 500])
torch.Size([11391, 16])
torch.Size([3426, 16])
torch.Size([884, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 1.8949289321899414  GigaBytes
Max Memory Allocated: 2.121234893798828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.04441356658935547  GigaBytes
Max Memory Allocated: 2.121234893798828  GigaBytes

torch.Size([14980, 500])
torch.Size([9442, 16])
torch.Size([2010, 16])
torch.Size([556, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 1.781362533569336  GigaBytes
Max Memory Allocated: 2.121234893798828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.039923667907714844  GigaBytes
Max Memory Allocated: 2.121234893798828  GigaBytes

torch.Size([12499, 500])
torch.Size([7350, 16])
torch.Size([2484, 16])
torch.Size([621, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 1.4785594940185547  GigaBytes
Max Memory Allocated: 2.121234893798828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011886000633239746 |0.086544930934906 |0.39826488494873047 |0.00017207860946655273 |0.3585909605026245 |0.011310100555419922 |
----------------------------------------------------------pseudo_mini_loss sum 1.5661779642105103
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  114902
Number of first layer input nodes during this epoch:  60459
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.05601787567138672  GigaBytes
Max Memory Allocated: 2.121234893798828  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005586147308349609
range selection method range initialization spend 5.626678466796875e-05
time for parepare:  6.508827209472656e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  6.198883056640625e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.695487976074219e-05
----------------------check_connections_block total spend ----------------------------- 0.0011382102966308594
generate_one_block  0.001333475112915039
generate_one_block  0.0011277198791503906
generate_one_block  0.0011146068572998047
generate_one_block  0.0011096000671386719
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005981922149658203
gen group dst list time:  3.981590270996094e-05
time for parepare:  0.0002899169921875
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0004971027374267578
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.00029587745666503906
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.00037550926208496094
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00023889541625976562
----------------------check_connections_block total spend ----------------------------- 0.003110170364379883
generate_one_block  0.002048015594482422
generate_one_block  0.001543283462524414
generate_one_block  0.0016193389892578125
generate_one_block  0.001413583755493164
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010535717010498047
gen group dst list time:  9.655952453613281e-05
time for parepare:  0.0007984638214111328
local_output_nid generation:  0.00012350082397460938
local_in_edges_tensor generation:  0.0003497600555419922
mini_batch_src_global generation:  0.0003514289855957031
r_  generation:  0.0032532215118408203
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.0002486705780029297
r_  generation:  0.0018966197967529297
local_output_nid generation:  8.416175842285156e-05
local_in_edges_tensor generation:  0.00023674964904785156
mini_batch_src_global generation:  0.00028228759765625
r_  generation:  0.0027718544006347656
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.0001838207244873047
r_  generation:  0.0013468265533447266
----------------------check_connections_block total spend ----------------------------- 0.014852285385131836
generate_one_block  0.005553483963012695
generate_one_block  0.003382444381713867
generate_one_block  0.004690408706665039
generate_one_block  0.0026557445526123047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019328594207763672
gen group dst list time:  0.00026035308837890625
time for parepare:  0.0015614032745361328
local_output_nid generation:  0.00038814544677734375
local_in_edges_tensor generation:  0.0009343624114990234
mini_batch_src_global generation:  0.0010280609130859375
r_  generation:  0.012684822082519531
local_output_nid generation:  0.00027298927307128906
local_in_edges_tensor generation:  0.0005636215209960938
mini_batch_src_global generation:  0.0012028217315673828
r_  generation:  0.009141921997070312
local_output_nid generation:  0.000347137451171875
local_in_edges_tensor generation:  0.0006363391876220703
mini_batch_src_global generation:  0.0009849071502685547
r_  generation:  0.010834455490112305
local_output_nid generation:  0.00023174285888671875
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0007479190826416016
r_  generation:  0.006866931915283203
----------------------check_connections_block total spend ----------------------------- 0.0582733154296875
generate_one_block  0.018743038177490234
generate_one_block  0.013966560363769531
generate_one_block  0.015733718872070312
generate_one_block  0.011187314987182617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017495155334472656
gen group dst list time:  0.0008563995361328125
time for parepare:  0.0016057491302490234
local_output_nid generation:  0.0010688304901123047
local_in_edges_tensor generation:  0.0020492076873779297
mini_batch_src_global generation:  0.002229452133178711
r_  generation:  0.023555755615234375
local_output_nid generation:  0.0011951923370361328
local_in_edges_tensor generation:  0.002151012420654297
mini_batch_src_global generation:  0.0023124217987060547
r_  generation:  0.020226716995239258
local_output_nid generation:  0.0011963844299316406
local_in_edges_tensor generation:  0.0018396377563476562
mini_batch_src_global generation:  0.001758575439453125
r_  generation:  0.02069568634033203
local_output_nid generation:  0.0011425018310546875
local_in_edges_tensor generation:  0.0013175010681152344
mini_batch_src_global generation:  0.0015459060668945312
r_  generation: Using backend: pytorch
 0.019806861877441406
----------------------check_connections_block total spend ----------------------------- 0.1257336139678955
generate_one_block  0.03347277641296387
generate_one_block  0.03012681007385254
generate_one_block  0.028560638427734375
generate_one_block  0.029655933380126953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.05601787567138672  GigaBytes
Max Memory Allocated: 2.121234893798828  GigaBytes

connection checking time:  0.20196938514709473
block generation total time  0.20435309410095215
average batch blocks generation time:  0.05108827352523804
block dataloader generation time/epoch 0.47678160667419434
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.06345415115356445  GigaBytes
Max Memory Allocated: 2.121234893798828  GigaBytes

torch.Size([16929, 500])
torch.Size([12469, 16])
torch.Size([4350, 16])
torch.Size([1004, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 2.1349072456359863  GigaBytes
Max Memory Allocated: 2.2534666061401367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.06148242950439453  GigaBytes
Max Memory Allocated: 2.2534666061401367  GigaBytes

torch.Size([15962, 500])
torch.Size([10773, 16])
torch.Size([2783, 16])
torch.Size([650, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 1.947697639465332  GigaBytes
Max Memory Allocated: 2.2534666061401367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.06251382827758789  GigaBytes
Max Memory Allocated: 2.2534666061401367  GigaBytes

torch.Size([16463, 500])
torch.Size([10792, 16])
torch.Size([3723, 16])
torch.Size([752, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 2.015104293823242  GigaBytes
Max Memory Allocated: 2.2534666061401367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.0591588020324707  GigaBytes
Max Memory Allocated: 2.2534666061401367  GigaBytes

torch.Size([14778, 500])
torch.Size([8540, 16])
torch.Size([2128, 16])
torch.Size([475, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 1.7016563415527344  GigaBytes
Max Memory Allocated: 2.2534666061401367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010951638221740723 |0.0021153688430786133 |0.2686334252357483 |0.0001723766326904297 |0.3595302104949951 |0.010850667953491211 |
----------------------------------------------------------pseudo_mini_loss sum 1.2956371307373047
Total (block generation + training)time/epoch 3.0672314167022705
Training time/epoch 2.5898897647857666
Training time without block to device /epoch 2.581428289413452
Training time without total dataloading part /epoch 2.5241947174072266
load block tensor time/epoch 0.04380655288696289
block to device time/epoch 0.008461475372314453
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  122928
Number of first layer input nodes during this epoch:  64132
