main start at this time 1648532657.0346737
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0019373893737792969
range selection method range initialization spend 8.7738037109375e-05
time for parepare:  5.9604644775390625e-05
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0002930164337158203
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.001627206802368164
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  5.1975250244140625e-05
----------------------check_connections_block total spend ----------------------------- 0.002473115921020508
generate_one_block  0.0015912055969238281
generate_one_block  0.001367330551147461
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012688636779785156
gen group dst list time:  3.266334533691406e-05
time for parepare:  0.000301361083984375
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00024127960205078125
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.0009586811065673828
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0005712509155273438
----------------------check_connections_block total spend ----------------------------- 0.0029540061950683594
generate_one_block  0.002596616744995117
generate_one_block  0.002046823501586914
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012383460998535156
gen group dst list time:  9.179115295410156e-05
time for parepare:  0.0009086132049560547
local_output_nid generation:  0.00014710426330566406
local_in_edges_tensor generation:  0.0004820823669433594
mini_batch_src_global generation:  0.0005755424499511719
r_  generation:  0.005779266357421875
local_output_nid generation:  0.00012040138244628906
local_in_edges_tensor generation:  0.00033402442932128906
mini_batch_src_global generation:  0.00055694580078125
r_  generation:  0.003973960876464844
----------------------check_connections_block total spend ----------------------------- 0.01560521125793457
generate_one_block  0.007874250411987305
generate_one_block  0.005104780197143555
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002003192901611328
gen group dst list time:  0.0002532005310058594
time for parepare:  0.0018067359924316406
local_output_nid generation:  0.0005729198455810547
local_in_edges_tensor generation:  0.0012831687927246094
mini_batch_src_global generation:  0.0017192363739013672
r_  generation:  0.01574254035949707
local_output_nid generation:  0.00033855438232421875
local_in_edges_tensor generation:  0.0007336139678955078
mini_batch_src_global generation:  0.0014374256134033203
r_  generation:  0.012267351150512695
----------------------check_connections_block total spend ----------------------------- 0.042807817459106445
generate_one_block  0.020972251892089844
generate_one_block  0.017172574996948242
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018355846405029297
gen group dst list time:  0.0004980564117431641
time for parepare:  0.0017240047454833984
local_output_nid generation:  0.0010044574737548828
local_in_edges_tensor generation:  0.0023925304412841797
mini_batch_src_global generation:  0.0023984909057617188
r_  generation:  0.024093151092529297
local_output_nid generation:  0.0011751651763916016
local_in_edges_tensor generation:  0.002248525619506836
mini_batch_src_global generation:  0.002368927001953125
r_  generation:  0.022029399871826172
----------------------check_connections_block total spend ----------------------------- 0.06990432739257812
generate_one_block  0.028883695602416992
generate_one_block  0.028119564056396484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007576942443847656  GigaBytes
Max Memory Allocated: 0.007576942443847656  GigaBytes

connection checking time:  0.1312713623046875
block generation total time  0.11277055740356445
average batch blocks generation time:  0.05638527870178223
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.042681217193603516  GigaBytes
Max Memory Allocated: 0.042681217193603516  GigaBytes

torch.Size([18262, 500])
torch.Size([14879, 16])
torch.Size([6507, 16])
torch.Size([1624, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 2.3188438415527344  GigaBytes
Max Memory Allocated: 2.4404525756835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7518310546875 GB
    Memory Allocated: 0.046939849853515625  GigaBytes
Max Memory Allocated: 2.4404525756835938  GigaBytes

torch.Size([16582, 500])
torch.Size([12358, 16])
torch.Size([4070, 16])
torch.Size([1166, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7635498046875 GB
    Memory Allocated: 2.1003127098083496  GigaBytes
Max Memory Allocated: 2.4404525756835938  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02100050449371338 |0.17312633991241455 |0.5588089227676392 |0.00019168853759765625 |0.36886537075042725 |0.018157482147216797 |
----------------------------------------------------------pseudo_mini_loss sum 1.790444016456604
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  75805
Number of first layer input nodes during this epoch:  34844
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7635498046875 GB
    Memory Allocated: 0.0646047592163086  GigaBytes
Max Memory Allocated: 2.4404525756835938  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005822181701660156
range selection method range initialization spend 5.841255187988281e-05
time for parepare:  5.793571472167969e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  7.987022399902344e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  6.29425048828125e-05
----------------------check_connections_block total spend ----------------------------- 0.0007615089416503906
generate_one_block  0.001302480697631836
generate_one_block  0.0012056827545166016
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007333755493164062
gen group dst list time:  3.0040740966796875e-05
time for parepare:  0.00029087066650390625
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.0007433891296386719
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation: Using backend: pytorch
 9.083747863769531e-05
r_  generation:  0.0005776882171630859
----------------------check_connections_block total spend ----------------------------- 0.0026426315307617188
generate_one_block  0.0023691654205322266
generate_one_block  0.001983642578125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010445117950439453
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.0007700920104980469
local_output_nid generation:  0.00015664100646972656
local_in_edges_tensor generation:  0.00040721893310546875
mini_batch_src_global generation:  0.000476837158203125
r_  generation:  0.00477290153503418
local_output_nid generation:  0.00012135505676269531
local_in_edges_tensor generation:  0.0002911090850830078
mini_batch_src_global generation:  0.0004911422729492188
r_  generation:  0.003997087478637695
----------------------check_connections_block total spend ----------------------------- 0.01357269287109375
generate_one_block  0.008479833602905273
generate_one_block  0.006525278091430664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017180442810058594
gen group dst list time:  0.0002110004425048828
time for parepare:  0.0013725757598876953
local_output_nid generation:  0.0004322528839111328
local_in_edges_tensor generation:  0.0010943412780761719
mini_batch_src_global generation:  0.0014500617980957031
r_  generation:  0.015349149703979492
local_output_nid generation:  0.000431060791015625
local_in_edges_tensor generation:  0.0008399486541748047
mini_batch_src_global generation:  0.0015540122985839844
r_  generation:  0.013637781143188477
----------------------check_connections_block total spend ----------------------------- 0.04534602165222168
generate_one_block  0.022558212280273438
generate_one_block  0.019986867904663086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018086433410644531
gen group dst list time:  0.0005435943603515625
time for parepare:  0.0015015602111816406
local_output_nid generation:  0.0010364055633544922
local_in_edges_tensor generation:  0.0025124549865722656
mini_batch_src_global generation:  0.002224445343017578
r_  generation:  0.025440692901611328
local_output_nid generation:  0.0013580322265625
local_in_edges_tensor generation:  0.002179861068725586
mini_batch_src_global generation:  0.002405405044555664
r_  generation:  0.022688627243041992
----------------------check_connections_block total spend ----------------------------- 0.07194995880126953
generate_one_block  0.03179478645324707
generate_one_block  0.03297305107116699
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7635498046875 GB
    Memory Allocated: 0.0646047592163086  GigaBytes
Max Memory Allocated: 2.4404525756835938  GigaBytes

connection checking time:  0.13351130485534668
block generation total time  0.12667083740234375
average batch blocks generation time:  0.06333541870117188
block dataloader generation time/epoch 0.3081533908843994
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7635498046875 GB
    Memory Allocated: 0.06569194793701172  GigaBytes
Max Memory Allocated: 2.4404525756835938  GigaBytes

torch.Size([17856, 500])
torch.Size([14591, 16])
torch.Size([5856, 16])
torch.Size([1564, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7928466796875 GB
    Memory Allocated: 2.3182992935180664  GigaBytes
Max Memory Allocated: 2.4404525756835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7928466796875 GB
    Memory Allocated: 0.06532144546508789  GigaBytes
Max Memory Allocated: 2.4404525756835938  GigaBytes

torch.Size([17703, 500])
torch.Size([13044, 16])
torch.Size([5015, 16])
torch.Size([1194, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7928466796875 GB
    Memory Allocated: 2.2249655723571777  GigaBytes
Max Memory Allocated: 2.4404525756835938  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009232521057128906 |0.0022072792053222656 |0.31000208854675293 |0.00016045570373535156 |0.40153968334198 |0.011188745498657227 |
----------------------------------------------------------pseudo_mini_loss sum 1.4509389400482178
Total (block generation + training)time/epoch 1.773834466934204
Training time/epoch 1.4654467105865479
Training time without block to device /epoch 1.4610321521759033
Training time without total dataloading part /epoch 1.4345932006835938
load block tensor time/epoch 0.018465042114257812
block to device time/epoch 0.004414558410644531
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  77179
Number of first layer input nodes during this epoch:  35559
