main start at this time 1648532756.7125013
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007744789123535156  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.003141641616821289
range selection method range initialization spend 8.177757263183594e-05
time for parepare:  4.315376281738281e-05
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00024390220642089844
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.002607107162475586
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.504753112792969e-05
----------------------check_connections_block total spend ----------------------------- 0.003684520721435547
generate_one_block  0.0012085437774658203
generate_one_block  0.0010902881622314453
generate_one_block  0.0010180473327636719
generate_one_block  0.0009899139404296875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0015935897827148438
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.00023865699768066406
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00029778480529785156
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0005030632019042969
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0001819133758544922
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002961158752441406
----------------------check_connections_block total spend ----------------------------- 0.0026993751525878906
generate_one_block  0.0013797283172607422
generate_one_block  0.0017185211181640625
generate_one_block  0.0012061595916748047
generate_one_block  0.0014216899871826172
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009660720825195312
gen group dst list time:  6.67572021484375e-05
time for parepare:  0.0006918907165527344
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.0002827644348144531
mini_batch_src_global generation:  0.00015854835510253906
r_  generation:  0.0016927719116210938
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.0002593994140625
mini_batch_src_global generation:  0.0004444122314453125
r_  generation:  0.003429889678955078
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  0.00016736984252929688
r_  generation:  0.0011000633239746094
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  0.00016617774963378906
r_  generation:  0.0017480850219726562
----------------------check_connections_block total spend ----------------------------- 0.01287531852722168
generate_one_block  0.003844022750854492
generate_one_block  0.00558924674987793
generate_one_block  0.002277374267578125
generate_one_block  0.003160238265991211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021071434020996094
gen group dst list time:  0.00021767616271972656
time for parepare:  0.0015947818756103516
local_output_nid generation:  0.00016927719116210938
local_in_edges_tensor generation:  0.0007171630859375
mini_batch_src_global generation:  0.0009076595306396484
r_  generation:  0.0068356990814208984
local_output_nid generation:  0.0003533363342285156
local_in_edges_tensor generation:  0.0007777214050292969
mini_batch_src_global generation:  0.0015206336975097656
r_  generation:  0.012955427169799805
local_output_nid generation:  0.00018453598022460938
local_in_edges_tensor generation:  0.0011074542999267578
mini_batch_src_global generation:  0.0007469654083251953
r_  generation:  0.006237506866455078
local_output_nid generation:  0.0002467632293701172
local_in_edges_tensor generation:  0.0005130767822265625
mini_batch_src_global generation:  0.0007450580596923828
r_  generation:  0.007796049118041992
----------------------check_connections_block total spend ----------------------------- 0.0518794059753418
generate_one_block  0.010689020156860352
generate_one_block  0.0180203914642334
generate_one_block  0.01029348373413086
generate_one_block  0.011659622192382812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00177764892578125
gen group dst list time:  0.0007798671722412109
time for parepare:  0.0016820430755615234
local_output_nid generation:  0.0005998611450195312
local_in_edges_tensor generation:  0.001447439193725586
mini_batch_src_global generation:  0.0014796257019042969
r_  generation:  0.015069961547851562
local_output_nid generation:  0.0011284351348876953
local_in_edges_tensor generation:  0.002231121063232422
mini_batch_src_global generation:  0.0023665428161621094
r_  generation:  0.02194356918334961
local_output_nid generation:  0.0008482933044433594
local_in_edges_tensor generation:  0.0013899803161621094
mini_batch_src_global generation:  0.0014731884002685547
r_  generation:  0.017213821411132812
local_output_nid generation:  0.001283407211303711
local_in_edges_tensor generation:  0.0017566680908203125
mini_batch_src_global generation:  0.0015323162078857422
r_  generation:  0.01911330223083496
----------------------check_connections_block total spend ----------------------------- 0.10984587669372559
generate_one_block  0.02184748649597168
generate_one_block  0.029570579528808594
generate_one_block  0.022545576095581055
generate_one_block  0.025298595428466797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007744789123535156  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

connection checking time:  0.17729997634887695
block generation total time  0.17052173614501953
average batch blocks generation time:  0.04263043403625488
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1287841796875 GB
    Memory Allocated: 0.034021854400634766  GigaBytes
Max Memory Allocated: 0.034021854400634766  GigaBytes

torch.Size([13766, 500])
torch.Size([8214, 32])
torch.Size([2350, 32])
torch.Size([584, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9842529296875 GB
    Memory Allocated: 1.6270861625671387  GigaBytes
Max Memory Allocated: 1.6893396377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9842529296875 GB
    Memory Allocated: 0.049938201904296875  GigaBytes
Max Memory Allocated: 1.6893396377563477  GigaBytes

torch.Size([17660, 500])
torch.Size([13833, 32])
torch.Size([5069, 32])
torch.Size([1152, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 2.3022446632385254  GigaBytes
Max Memory Allocated: 2.366952896118164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 0.04401254653930664  GigaBytes
Max Memory Allocated: 2.366952896118164  GigaBytes

torch.Size([14305, 500])
torch.Size([8762, 32])
torch.Size([1888, 32])
torch.Size([420, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 1.7229113578796387  GigaBytes
Max Memory Allocated: 2.366952896118164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 0.0465540885925293  GigaBytes
Max Memory Allocated: 2.366952896118164  GigaBytes

torch.Size([15985, 500])
torch.Size([9953, 32])
torch.Size([3076, 32])
torch.Size([669, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 1.9223971366882324  GigaBytes
Max Memory Allocated: 2.366952896118164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01574862003326416 |0.08656543493270874 |0.3932924270629883 |0.00016862154006958008 |0.3573850393295288 |0.011284828186035156 |
----------------------------------------------------------pseudo_mini_loss sum 1.7161483764648438
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  118042
Number of first layer input nodes during this epoch:  61716
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 0.06347417831420898  GigaBytes
Max Memory Allocated: 2.366952896118164  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006327629089355469
range selection method range initialization spend 6.842613220214844e-05
time for parepare:  6.651878356933594e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  7.367134094238281e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.4809112548828125e-05
----------------------check_connections_block total spend ----------------------------- 0.001171112060546875
generate_one_block  0.0012726783752441406
generate_one_block  0.0011103153228759766
generate_one_block  0.0010921955108642578
generate_one_block  0.001079559326171875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005810260772705078
gen group dst list time:  3.886222839355469e-05
time for parepare:  0.00030994415283203125
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0003535747528076172
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0003402233123779297
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.00034165382385253906
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.000331878662109375
----------------------check_connections_block total spend ----------------------------- 0.003090381622314453
generate_one_block  0.0018014907836914062
generate_one_block  0.0015444755554199219
generate_one_block  0.0015735626220703125
generate_one_block  0.0015430450439453125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00101470947265625
gen group dst list time:  9.131431579589844e-05
time for parepare:  0.0008387565612792969
local_output_nid generation:  8.821487426757812e-05
local_in_edges_tensor generation:  0.0003592967987060547
mini_batch_src_global generation:  0.00024437904357910156
r_  generation:  0.0017518997192382812
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  0.00027298927307128906
r_  generation:  0.001978158950805664
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  0.0003123283386230469
r_  generation:  0.0026051998138427734
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  0.0002598762512207031
r_  generation:  0.0022094249725341797
----------------------check_connections_block total spend ----------------------------- 0.014201879501342773
generate_one_block  0.0035126209259033203
generate_one_block  0.0036695003509521484
generate_one_block  0.004708766937255859
generate_one_block  0.003974437713623047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020766258239746094
gen group dst list time:  0.0002422332763671875
time for parepare:  0.0014636516571044922
local_output_nid generation:  0.00028777122497558594
local_in_edges_tensor generation:  0.0009307861328125
mini_batch_src_global generation:  0.0008950233459472656
r_  generation:  0.00761103630065918
local_output_nid generation:  0.00029087066650390625
local_in_edges_tensor generation:  0.0005941390991210938
mini_batch_src_global generation:  0.0011451244354248047
r_  generation:  0.009666204452514648
local_output_nid generation:  0.00033283233642578125
local_in_edges_tensor generation:  0.0006775856018066406
mini_batch_src_global generation:  0.0009713172912597656
r_  generation:  0.010386228561401367
local_output_nid generation:  0.0002732276916503906
local_in_edges_tensor generation:  0.0004975795745849609
mini_batch_src_global generation:  0.0008838176727294922
r_  generation:  0.00801849365234375
----------------------check_connections_block total spend ----------------------------- 0.054096221923828125
generate_one_block  0.012382745742797852
generate_one_block  0.014826059341430664
generate_one_block  0.015938520431518555
generate_one_block  0.012925863265991211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001756906509399414
gen group dst list time:  0.0007545948028564453
time for parepare:  0.0016398429870605469
local_output_nid generation:  0.0008912086486816406
local_in_edges_tensor generation:  0.0018413066864013672
mini_batch_src_global generation:  0.0017774105072021484
r_  generation:  0.017714500427246094
local_output_nid generation:  0.0010313987731933594
local_in_edges_tensor generation:  0.001970052719116211
mini_batch_src_global generation:  0.0024318695068359375
r_  generation:  0.02018880844116211
local_output_nid generation:  0.0010225772857666016
local_in_edges_tensor generation:  0.00151824951171875
mini_batch_src_global generation:  0.0018038749694824219
r_  generation:  0.019042491912841797
local_output_nid generation:  0.001020193099975586
local_in_edges_tensor generation:  0.0013701915740966797
mini_batch_src_global generation:  0.0015559196472167969Using backend: pytorch

r_  generation:  0.01815509796142578
----------------------check_connections_block total spend ----------------------------- 0.11287498474121094
generate_one_block  0.025880098342895508
generate_one_block  0.0300295352935791
generate_one_block  0.026986360549926758
generate_one_block  0.02523016929626465
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 0.06347417831420898  GigaBytes
Max Memory Allocated: 2.366952896118164  GigaBytes

connection checking time:  0.1842634677886963
block generation total time  0.18652725219726562
average batch blocks generation time:  0.046631813049316406
block dataloader generation time/epoch 0.45201563835144043
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 0.06152677536010742  GigaBytes
Max Memory Allocated: 2.366952896118164  GigaBytes

torch.Size([15559, 500])
torch.Size([9522, 32])
torch.Size([2828, 32])
torch.Size([683, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 1.8611226081848145  GigaBytes
Max Memory Allocated: 2.366952896118164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 0.06328248977661133  GigaBytes
Max Memory Allocated: 2.366952896118164  GigaBytes

torch.Size([16437, 500])
torch.Size([11669, 32])
torch.Size([3244, 32])
torch.Size([738, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 2.0882019996643066  GigaBytes
Max Memory Allocated: 2.366952896118164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 0.0624547004699707  GigaBytes
Max Memory Allocated: 2.366952896118164  GigaBytes

torch.Size([15970, 500])
torch.Size([10425, 32])
torch.Size([3766, 32])
torch.Size([724, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 1.9948935508728027  GigaBytes
Max Memory Allocated: 2.366952896118164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 0.060785770416259766  GigaBytes
Max Memory Allocated: 2.366952896118164  GigaBytes

torch.Size([15135, 500])
torch.Size([9662, 32])
torch.Size([2725, 32])
torch.Size([711, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 1.8742294311523438  GigaBytes
Max Memory Allocated: 2.366952896118164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.019741594791412354 |0.0017189383506774902 |0.27021294832229614 |0.00014930963516235352 |0.35282033681869507 |0.010223388671875 |
----------------------------------------------------------pseudo_mini_loss sum 1.9459705352783203
Total (block generation + training)time/epoch 3.0539629459381104
Training time/epoch 2.601536750793457
Training time without block to device /epoch 2.594660997390747
Training time without total dataloading part /epoch 2.5029537677764893
load block tensor time/epoch 0.07896637916564941
block to device time/epoch 0.006875753402709961
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  120154
Number of first layer input nodes during this epoch:  63101
