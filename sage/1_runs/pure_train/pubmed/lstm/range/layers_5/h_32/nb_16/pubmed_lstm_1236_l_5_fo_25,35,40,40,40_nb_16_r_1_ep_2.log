main start at this time 1648532772.6174164
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007744789123535156  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.002739429473876953
range selection method range initialization spend 9.202957153320312e-05
time for parepare:  4.4345855712890625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0002646446228027344
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0010712146759033203
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2172927856445312e-05
----------------------check_connections_block total spend ----------------------------- 0.002756357192993164
generate_one_block  0.0011322498321533203
generate_one_block  0.0010406970977783203
generate_one_block  0.0010232925415039062
generate_one_block  0.0010437965393066406
generate_one_block  0.0010380744934082031
generate_one_block  0.0010533332824707031
generate_one_block  0.0009884834289550781
generate_one_block  0.0009801387786865234
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0014865398406982422
gen group dst list time:  4.982948303222656e-05
time for parepare:  0.00023412704467773438
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00011277198791503906
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00018858909606933594
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00014638900756835938
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00040030479431152344
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00010132789611816406
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010991096496582031
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00019788742065429688
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  9.036064147949219e-05
----------------------check_connections_block total spend ----------------------------- 0.0033843517303466797
generate_one_block  0.0011582374572753906
generate_one_block  0.0012345314025878906
generate_one_block  0.0012030601501464844
generate_one_block  0.001528024673461914
generate_one_block  0.001127481460571289
generate_one_block  0.0011496543884277344
generate_one_block  0.0012660026550292969
generate_one_block  0.001065969467163086
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011022090911865234
gen group dst list time:  9.465217590332031e-05
time for parepare:  0.0007200241088867188
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00024199485778808594
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0005240440368652344
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  0.0001461505889892578
r_  generation:  0.0014865398406982422
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  0.000125885009765625
r_  generation:  0.0009558200836181641
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0002257823944091797
mini_batch_src_global generation:  0.000255584716796875
r_  generation:  0.002820253372192383
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  0.00012159347534179688
r_  generation:  0.0005254745483398438
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  8.177757263183594e-05
r_  generation:  0.0008089542388916016
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.00012803077697753906
r_  generation:  0.00127410888671875
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0002944469451904297
----------------------check_connections_block total spend ----------------------------- 0.014377355575561523
generate_one_block  0.0023832321166992188
generate_one_block  0.002759218215942383
generate_one_block  0.002079486846923828
generate_one_block  0.004547834396362305
generate_one_block  0.0014688968658447266
generate_one_block  0.001825094223022461
generate_one_block  0.0024852752685546875
generate_one_block  0.0012714862823486328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002010822296142578
gen group dst list time:  0.0002689361572265625
time for parepare:  0.001522064208984375
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.0005376338958740234
mini_batch_src_global generation:  0.0004150867462158203
r_  generation:  0.003063678741455078
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.0003693103790283203
mini_batch_src_global generation:  0.0007345676422119141
r_  generation:  0.0056765079498291016
local_output_nid generation:  0.00014090538024902344
local_in_edges_tensor generation:  0.00037550926208496094
mini_batch_src_global generation:  0.0005848407745361328
r_  generation:  0.0054781436920166016
local_output_nid generation:  0.00029349327087402344
local_in_edges_tensor generation:  0.0006403923034667969
mini_batch_src_global generation:  0.0010297298431396484
r_  generation:  0.011020421981811523
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.00028228759765625
mini_batch_src_global generation:  0.0005204677581787109
r_  generation:  0.0036423206329345703
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.0003256797790527344
mini_batch_src_global generation:  0.0004532337188720703
r_  generation:  0.004291534423828125
local_output_nid generation:  0.00018644332885742188
local_in_edges_tensor generation:  0.0004127025604248047
mini_batch_src_global generation:  0.0006062984466552734
r_  generation:  0.0063323974609375
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.00023889541625976562
r_  generation:  0.0009872913360595703
----------------------check_connections_block total spend ----------------------------- 0.06099247932434082
generate_one_block  0.005761861801147461
generate_one_block  0.008406639099121094
generate_one_block  0.008907794952392578
generate_one_block  0.014945030212402344
generate_one_block  0.005597114562988281
generate_one_block  0.0070683956146240234
generate_one_block  0.010168313980102539
generate_one_block  0.0021228790283203125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019435882568359375
gen group dst list time:  0.0012607574462890625
time for parepare:  0.0017957687377929688
local_output_nid generation:  0.00044465065002441406
local_in_edges_tensor generation:  0.0011458396911621094
mini_batch_src_global generation:  0.0011293888092041016
r_  generation:  0.01142120361328125
local_output_nid generation:  0.0004591941833496094
local_in_edges_tensor generation:  0.0013155937194824219
mini_batch_src_global generation:  0.0013432502746582031
r_  generation:  0.011735916137695312
local_output_nid generation:  0.0007796287536621094
local_in_edges_tensor generation:  0.0012590885162353516
mini_batch_src_global generation:  0.001482248306274414
r_  generation:  0.01653742790222168
local_output_nid generation:  0.0008943080902099609
local_in_edges_tensor generation:  0.0019257068634033203
mini_batch_src_global generation:  0.0020508766174316406
r_  generation:  0.02051091194152832
local_output_nid generation:  0.0004944801330566406
local_in_edges_tensor generation:  0.0008082389831542969
mini_batch_src_global generation:  0.0012600421905517578
r_  generation:  0.01124262809753418
local_output_nid generation:  0.0005865097045898438
local_in_edges_tensor generation:  0.0009381771087646484
mini_batch_src_global generation:  0.0010280609130859375
r_  generation:  0.013838052749633789
local_output_nid generation:  0.0007715225219726562
local_in_edges_tensor generation:  0.001310110092163086
mini_batch_src_global generation:  0.001592874526977539
r_  generation:  0.016433000564575195
local_output_nid generation:  0.00016498565673828125
local_in_edges_tensor generation:  0.00032782554626464844
mini_batch_src_global generation:  0.0005719661712646484
r_  generation:  0.003667116165161133
----------------------check_connections_block total spend ----------------------------- 0.15556001663208008
generate_one_block  0.01615619659423828
generate_one_block  0.015883684158325195
generate_one_block  0.022197961807250977
generate_one_block  0.026352643966674805
generate_one_block  0.014874696731567383
generate_one_block  0.018168210983276367
generate_one_block  0.021335124969482422
generate_one_block  0.0056018829345703125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007744789123535156  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

connection checking time:  0.2343142032623291
block generation total time  0.2321019172668457
average batch blocks generation time:  0.029012739658355713
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1229248046875 GB
    Memory Allocated: 0.029610157012939453  GigaBytes
Max Memory Allocated: 0.029610157012939453  GigaBytes

torch.Size([11402, 500])
torch.Size([5315, 32])
torch.Size([984, 32])
torch.Size([223, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4666748046875 GB
    Memory Allocated: 1.1547551155090332  GigaBytes
Max Memory Allocated: 1.217726230621338  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 0.036612510681152344  GigaBytes
Max Memory Allocated: 1.217726230621338  GigaBytes

torch.Size([10787, 500])
torch.Size([5482, 32])
torch.Size([1735, 32])
torch.Size([408, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 1.2431654930114746  GigaBytes
Max Memory Allocated: 1.2860431671142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5740966796875 GB
    Memory Allocated: 0.043417930603027344  GigaBytes
Max Memory Allocated: 1.2860431671142578  GigaBytes

torch.Size([14390, 500])
torch.Size([9199, 32])
torch.Size([1750, 32])
torch.Size([372, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1444091796875 GB
    Memory Allocated: 1.6941866874694824  GigaBytes
Max Memory Allocated: 1.780937671661377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1444091796875 GB
    Memory Allocated: 0.04856729507446289  GigaBytes
Max Memory Allocated: 1.780937671661377  GigaBytes

torch.Size([17005, 500])
torch.Size([11414, 32])
torch.Size([4044, 32])
torch.Size([821, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4822998046875 GB
    Memory Allocated: 2.10916805267334  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.03594064712524414  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

torch.Size([10044, 500])
torch.Size([5103, 32])
torch.Size([879, 32])
torch.Size([196, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 1.1558961868286133  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.04089927673339844  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

torch.Size([13092, 500])
torch.Size([6307, 32])
torch.Size([1452, 32])
torch.Size([241, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 1.434542179107666  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.043335914611816406  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

torch.Size([14327, 500])
torch.Size([8144, 32])
torch.Size([2162, 32])
torch.Size([454, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 1.7021937370300293  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.026792049407958984  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

torch.Size([5718, 500])
torch.Size([1640, 32])
torch.Size([453, 32])
torch.Size([121, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.36104917526245117  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012349814176559448 |0.04359745979309082 |0.29369446635246277 |0.00015845894813537598 |0.33762094378471375 |0.0109405517578125 |
----------------------------------------------------------pseudo_mini_loss sum 2.1601109504699707
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  166020
Number of first layer input nodes during this epoch:  96765
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.04297447204589844  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0008127689361572266
range selection method range initialization spend 6.318092346191406e-05
time for parepare:  6.67572021484375e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  6.103515625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.4557113647460938e-05
----------------------check_connections_block total spend ----------------------------- 0.0018541812896728516
generate_one_block  0.0013797283172607422
generate_one_block  0.0013580322265625
generate_one_block  0.0011043548583984375
generate_one_block  0.0011153221130371094
generate_one_block  0.0010514259338378906
generate_one_block  0.0010857582092285156
generate_one_block  0.0010755062103271484
generate_one_block  0.0010333061218261719
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007154941558837891
gen group dst list time:  5.7697296142578125e-05
time for parepare:  0.00033092498779296875
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0002002716064453125
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0002300739288330078
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00012874603271484375
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0003094673156738281
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001251697540283203
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0001201629638671875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.0001347064971923828
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00020623207092285156
----------------------check_connections_block total spend ----------------------------- 0.0038299560546875
generate_one_block  0.001430511474609375
generate_one_block  0.0013885498046875
generate_one_block  0.0012280941009521484
generate_one_block  0.001512765884399414
generate_one_block  0.0011959075927734375
generate_one_block  0.0012774467468261719
generate_one_block  0.0012574195861816406
generate_one_block  0.001283884048461914
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012209415435791016
gen group dst list time:  0.00011420249938964844
time for parepare:  0.0009100437164306641
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.0003292560577392578
mini_batch_src_global generation:  0.0001342296600341797
r_  generation:  0.0009484291076660156
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  0.00018072128295898438
r_  generation:  0.0012319087982177734
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.0009448528289794922
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  0.00033354759216308594
r_  generation:  0.0020394325256347656
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0009229183197021484
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  0.00010371208190917969
r_  generation:  0.0007719993591308594
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.00070953369140625
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  0.00016450881958007812
r_  generation:  0.0014796257019042969
----------------------check_connections_block total spend ----------------------------- 0.015923500061035156
generate_one_block  0.002493143081665039
generate_one_block  0.0025556087493896484
generate_one_block  0.0021958351135253906
generate_one_block  0.003722667694091797
generate_one_block  0.002252817153930664
generate_one_block  0.0019636154174804688
generate_one_block  0.001856088638305664
generate_one_block  0.002842426300048828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018091201782226562
gen group dst list time:  0.00035643577575683594
time for parepare:  0.0015380382537841797
local_output_nid generation:  0.00019216537475585938
local_in_edges_tensor generation:  0.0007772445678710938
mini_batch_src_global generation:  0.0005137920379638672
r_  generation:  0.004668474197387695
local_output_nid generation:  0.00019860267639160156
local_in_edges_tensor generation:  0.00041103363037109375
mini_batch_src_global generation:  0.0007641315460205078
r_  generation:  0.0061075687408447266
local_output_nid generation:  0.00017786026000976562
local_in_edges_tensor generation:  0.0004131793975830078
mini_batch_src_global generation:  0.0006172657012939453
r_  generation:  0.005522012710571289
local_output_nid generation:  0.0003123283386230469
local_in_edges_tensor generation:  0.0005624294281005859
mini_batch_src_global generation:  0.0008845329284667969
r_  generation:  0.008461236953735352
local_output_nid generation:  0.00023055076599121094
local_in_edges_tensor generation:  0.0004241466522216797
mini_batch_src_global generation:  0.0006735324859619141
r_  generation:  0.0059850215911865234
local_output_nid generation:  0.00014781951904296875
local_in_edges_tensor generation:  0.0003173351287841797
mini_batch_src_global generation:  0.0004811286926269531
r_  generation:  0.003958463668823242
local_output_nid generation:  0.00012612342834472656
local_in_edges_tensor generation:  0.0002884864807128906
mini_batch_src_global generation:  0.00036907196044921875
r_  generation:  0.0030832290649414062
local_output_nid generation:  0.00017213821411132812
local_in_edges_tensor generation:  0.00036072731018066406
mini_batch_src_global generation:  0.0004949569702148438
r_  generation:  0.0052967071533203125
----------------------check_connections_block total spend ----------------------------- 0.06592369079589844
generate_one_block  0.008247613906860352
generate_one_block  0.009959936141967773
generate_one_block  0.008983612060546875
generate_one_block  0.013567209243774414
generate_one_block  0.009425878524780273
generate_one_block  0.006404399871826172
generate_one_block  0.0052950382232666016
generate_one_block  0.00817418098449707
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002215862274169922
gen group dst list time:  0.001255035400390625
time for parepare:  0.001806020736694336
local_output_nid generation:  0.0007598400115966797
local_in_edges_tensor generation:  0.0019888877868652344
mini_batch_src_global generation:  0.0015149116516113281
r_  generation:  0.014224529266357422
local_output_nid generation:  0.0007953643798828125
local_in_edges_tensor generation:  0.0014426708221435547
mini_batch_src_global generation:  0.0017876625061035156
r_  generation:  0.016623973846435547
local_output_nid generation:  0.0007658004760742188
local_in_edges_tensor generation:  0.0012722015380859375
mini_batch_src_global generation:  0.0015163421630859375
r_  generation:  0.015079498291015625
local_output_nid generation:  0.0011210441589355469
local_in_edges_tensor generation:  0.0017044544219970703
mini_batch_src_global generation:  0.0018515586853027344
r_  generation:  0.019347190856933594
local_output_nid generation:  0.0009553432464599609
local_in_edges_tensor generation:  0.0012123584747314453
mini_batch_src_global generation:  0.0014739036560058594
r_  generation:  0.01708221435546875
local_output_nid generation:  0.0006709098815917969
local_in_edges_tensor generation:  0.0008296966552734375
mini_batch_src_global generation:  0.0012173652648925781
r_  generation:  0.012586593627929688
local_output_nid generation:  0.0006196498870849609
local_in_edges_tensor generation:  0.0007994174957275391
mini_batch_src_global generation:  0.0008745193481445312
r_  generation:  0.009002923965454102
local_output_nid generation:  0.0007028579711914062
local_in_edges_tensor generation:  0.0008435249328613281
mini_batch_src_global generation:  0.001064300537109375
r_  generation:  0.011884450912475586
----------------------check_connections_block total spend ----------------------------- 0.17251229286193848
generate_one_block  0.02094125747680664
generate_one_block  0.022936582565307617
generate_one_block  0.020956039428710938
generate_one_block  0.0258939266204834
generate_one_block  0.023397207260131836
generate_one_block  0.01724529266357422
generate_one_block  0.014678239822387695
generate_one_block  0.015548944473266602
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.04297447204589844  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

connection checking time:  0.25818943977355957
block generation total time  0.2621121406555176
average batch blocks generation time:  0.0327640175819397
block dataloader generation time/epoch 0.6316072940826416
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.05818986892700195  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

torch.Size([13774, 500])
torch.Size([7036, 32])
torch.Size([1726, 32])
torch.Size([377, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 1.45658540725708  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.0587611198425293  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

torch.Size([14032, 500])
torch.Size([8138, 32])
torch.Size([1904, 32])
torch.Size([441, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 1.6373677253723145  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.0566258430480957  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

torch.Size([12901, 500])
torch.Size([6809, 32])
torch.Size([1681, 32])
torch.Size([289, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 1.5516133308410645  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.06181621551513672  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

torch.Size([15576, 500])
torch.Size([10786, 32])
torch.Size([2876, 32])
torch.Size([632, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 1.9574484825134277  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.06026935577392578  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

torch.Size([14831, 500])
torch.Size([8170, 32])
torch.Size([1978, 32])
torch.Size([263, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 1.7206721305847168  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.0539703369140625  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

torch.Size([11387, 500])
torch.Size([5185, 32])
torch.Size([1279, 32])
torch.Size([211, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 1.2954130172729492  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.05189990997314453  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

torch.Size([10389, 500])
torch.Size([5056, 32])
torch.Size([1181, 32])
torch.Size([310, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.9517707824707031  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 0.052062034606933594  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

torch.Size([10151, 500])
torch.Size([5609, 32])
torch.Size([1524, 32])
torch.Size([380, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4842529296875 GB
    Memory Allocated: 1.231147289276123  GigaBytes
Max Memory Allocated: 2.1777782440185547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010226994752883911 |0.0020067691802978516 |0.2353760004043579 |0.00013962388038635254 |0.3739662170410156 |0.01113271713256836 |
----------------------------------------------------------pseudo_mini_loss sum 1.8412234783172607
Total (block generation + training)time/epoch 5.634660243988037
Training time/epoch 5.002603054046631
Training time without block to device /epoch 4.986548900604248
Training time without total dataloading part /epoch 4.8869874477386475
load block tensor time/epoch 0.08181595802307129
block to device time/epoch 0.016054153442382812
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  177238
Number of first layer input nodes during this epoch:  103041
