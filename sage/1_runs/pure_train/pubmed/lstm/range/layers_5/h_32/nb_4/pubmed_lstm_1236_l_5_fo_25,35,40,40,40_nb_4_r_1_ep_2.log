main start at this time 1648532743.3849008
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007744789123535156  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.002347707748413086
range selection method range initialization spend 8.487701416015625e-05
time for parepare:  4.553794860839844e-05
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0002665519714355469
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0015468597412109375
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  5.91278076171875e-05
----------------------check_connections_block total spend ----------------------------- 0.002308368682861328
generate_one_block  0.0013396739959716797
generate_one_block  0.0011353492736816406
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00122833251953125
gen group dst list time:  2.5272369384765625e-05
time for parepare:  0.0002391338348388672
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0008020401000976562
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  8.463859558105469e-05
r_  generation:  0.0004878044128417969
----------------------check_connections_block total spend ----------------------------- 0.002420663833618164
generate_one_block  0.0021581649780273438
generate_one_block  0.0016913414001464844
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010333061218261719
gen group dst list time:  6.318092346191406e-05
time for parepare:  0.0007421970367431641
local_output_nid generation:  0.00011444091796875
local_in_edges_tensor generation:  0.0004322528839111328
mini_batch_src_global generation:  0.0004725456237792969
r_  generation:  0.00499415397644043
local_output_nid generation:  8.535385131835938e-05
local_in_edges_tensor generation:  0.0002636909484863281
mini_batch_src_global generation:  0.00039458274841308594
r_  generation:  0.0028896331787109375
----------------------check_connections_block total spend ----------------------------- 0.012511014938354492
generate_one_block  0.007982730865478516
generate_one_block  0.0045013427734375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020341873168945312
gen group dst list time:  0.00018906593322753906
time for parepare:  0.001524209976196289
local_output_nid generation:  0.0003998279571533203
local_in_edges_tensor generation:  0.0011289119720458984
mini_batch_src_global generation:  0.0015406608581542969
r_  generation:  0.015234231948852539
local_output_nid generation:  0.0004267692565917969
local_in_edges_tensor generation:  0.0006861686706542969
mini_batch_src_global generation:  0.0014286041259765625
r_  generation:  0.01229715347290039
----------------------check_connections_block total spend ----------------------------- 0.041486263275146484
generate_one_block  0.020144224166870117
generate_one_block  0.01736927032470703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018312931060791016
gen group dst list time:  0.0004947185516357422
time for parepare:  0.0017087459564208984
local_output_nid generation:  0.0010025501251220703
local_in_edges_tensor generation:  0.002131938934326172
mini_batch_src_global generation:  0.0021712779998779297
r_  generation:  0.023795127868652344
local_output_nid generation:  0.0011394023895263672
local_in_edges_tensor generation:  0.002328157424926758
mini_batch_src_global generation:  0.002532482147216797
r_  generation:  0.022497892379760742
----------------------check_connections_block total spend ----------------------------- 0.06962895393371582
generate_one_block  0.02862095832824707
generate_one_block  0.028879165649414062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007744789123535156  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

connection checking time:  0.12604689598083496
block generation total time  0.11134719848632812
average batch blocks generation time:  0.05567359924316406
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.042138099670410156  GigaBytes
Max Memory Allocated: 0.042138099670410156  GigaBytes

torch.Size([17890, 500])
torch.Size([14559, 32])
torch.Size([5971, 32])
torch.Size([1663, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7928466796875 GB
    Memory Allocated: 2.358095645904541  GigaBytes
Max Memory Allocated: 2.410003662109375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.04887104034423828  GigaBytes
Max Memory Allocated: 2.410003662109375  GigaBytes

torch.Size([17436, 500])
torch.Size([12853, 32])
torch.Size([4371, 32])
torch.Size([1061, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 2.230738639831543  GigaBytes
Max Memory Allocated: 2.410003662109375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021663904190063477 |0.17545092105865479 |0.5633819103240967 |0.00020551681518554688 |0.37801384925842285 |0.011093616485595703 |
----------------------------------------------------------pseudo_mini_loss sum 2.0445587635040283
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  76159
Number of first layer input nodes during this epoch:  35326
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.06686782836914062  GigaBytes
Max Memory Allocated: 2.410003662109375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005366802215576172
range selection method range initialization spend 5.2928924560546875e-05
time for parepare:  5.364418029785156e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  7.724761962890625e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  5.984306335449219e-05
----------------------check_connections_block total spend ----------------------------- 0.0007269382476806641
generate_one_block  0.0012335777282714844
generate_one_block  0.0011513233184814453
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005595684051513672
gen group dst list time:  3.075599670410156e-05
time for parepare:  0.0002677440643310547
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0006656646728515625
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation: Using backend: pytorch
 0.00010180473327636719
r_  generation:  0.0006573200225830078
----------------------check_connections_block total spend ----------------------------- 0.0026335716247558594
generate_one_block  0.0020666122436523438
generate_one_block  0.0020961761474609375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010385513305664062
gen group dst list time:  7.43865966796875e-05
time for parepare:  0.0007708072662353516
local_output_nid generation:  0.00013828277587890625
local_in_edges_tensor generation:  0.0003962516784667969
mini_batch_src_global generation:  0.0003466606140136719
r_  generation:  0.0037109851837158203
local_output_nid generation:  0.00013399124145507812
local_in_edges_tensor generation:  0.0003097057342529297
mini_batch_src_global generation:  0.0004677772521972656
r_  generation:  0.004364967346191406
----------------------check_connections_block total spend ----------------------------- 0.012699604034423828
generate_one_block  0.007391452789306641
generate_one_block  0.006667375564575195
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002161264419555664
gen group dst list time:  0.0001995563507080078
time for parepare:  0.001401662826538086
local_output_nid generation:  0.0003905296325683594
local_in_edges_tensor generation:  0.0010764598846435547
mini_batch_src_global generation:  0.0013079643249511719
r_  generation:  0.014142274856567383
local_output_nid generation:  0.0004100799560546875
local_in_edges_tensor generation:  0.0008406639099121094
mini_batch_src_global generation:  0.001491546630859375
r_  generation:  0.013504743576049805
----------------------check_connections_block total spend ----------------------------- 0.041224002838134766
generate_one_block  0.02131819725036621
generate_one_block  0.019891977310180664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018150806427001953
gen group dst list time:  0.0005316734313964844
time for parepare:  0.001558065414428711
local_output_nid generation:  0.0010693073272705078
local_in_edges_tensor generation:  0.002100229263305664
mini_batch_src_global generation:  0.0020940303802490234
r_  generation:  0.023529767990112305
local_output_nid generation:  0.0010819435119628906
local_in_edges_tensor generation:  0.0020532608032226562
mini_batch_src_global generation:  0.0024585723876953125
r_  generation:  0.02231454849243164
----------------------check_connections_block total spend ----------------------------- 0.06871271133422852
generate_one_block  0.032434940338134766
generate_one_block  0.030709266662597656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.06686782836914062  GigaBytes
Max Memory Allocated: 2.410003662109375  GigaBytes

connection checking time:  0.12526988983154297
block generation total time  0.12257599830627441
average batch blocks generation time:  0.06128799915313721
block dataloader generation time/epoch 0.29399633407592773
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.06637430191040039  GigaBytes
Max Memory Allocated: 2.410003662109375  GigaBytes

torch.Size([17897, 500])
torch.Size([14412, 32])
torch.Size([5288, 32])
torch.Size([1398, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 2.359168529510498  GigaBytes
Max Memory Allocated: 2.429070472717285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.06517982482910156  GigaBytes
Max Memory Allocated: 2.429070472717285  GigaBytes

torch.Size([17265, 500])
torch.Size([12702, 32])
torch.Size([5039, 32])
torch.Size([1343, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 2.244046211242676  GigaBytes
Max Memory Allocated: 2.429070472717285  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01961815357208252 |0.0026618242263793945 |0.2993156909942627 |0.00014066696166992188 |0.41291046142578125 |0.010532617568969727 |
----------------------------------------------------------pseudo_mini_loss sum 1.3703017234802246
Total (block generation + training)time/epoch 1.781130313873291
Training time/epoch 1.4867548942565918
Training time without block to device /epoch 1.481431245803833
Training time without total dataloading part /epoch 1.4352662563323975
load block tensor time/epoch 0.03923630714416504
block to device time/epoch 0.005323648452758789
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  75699
Number of first layer input nodes during this epoch:  35162
