main start at this time 1648532793.4318218
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007744789123535156  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.002194643020629883
range selection method range initialization spend 8.630752563476562e-05
time for parepare:  4.1484832763671875e-05
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00024390220642089844
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.0011150836944580078
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.2172927856445312e-05
----------------------check_connections_block total spend ----------------------------- 0.0038428306579589844
generate_one_block  0.0011229515075683594
generate_one_block  0.000988006591796875
generate_one_block  0.0010180473327636719
generate_one_block  0.0009865760803222656
generate_one_block  0.0010197162628173828
generate_one_block  0.0009958744049072266
generate_one_block  0.0010328292846679688
generate_one_block  0.0009891986846923828
generate_one_block  0.0009717941284179688
generate_one_block  0.0009818077087402344
generate_one_block  0.0009648799896240234
generate_one_block  0.0009295940399169922
generate_one_block  0.0009658336639404297
generate_one_block  0.0009403228759765625
generate_one_block  0.0009429454803466797
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013246536254882812
gen group dst list time:  7.700920104980469e-05
time for parepare:  0.00026226043701171875
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010514259338378906
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  4.7206878662109375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00015211105346679688
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  0.00010442733764648438
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.125999450683594e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00019812583923339844
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00021600723266601562
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  9.202957153320312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00011467933654785156
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.487701416015625e-05
----------------------check_connections_block total spend ----------------------------- 0.0045053958892822266
generate_one_block  0.0011458396911621094
generate_one_block  0.0010271072387695312
generate_one_block  0.0011861324310302734
generate_one_block  0.0010769367218017578
generate_one_block  0.0011279582977294922
generate_one_block  0.0010247230529785156
generate_one_block  0.0012717247009277344
generate_one_block  0.0012574195861816406
generate_one_block  0.0010502338409423828
generate_one_block  0.0010831356048583984
generate_one_block  0.0010526180267333984
generate_one_block  0.0010347366333007812
generate_one_block  0.0010533332824707031
generate_one_block  0.001119852066040039
generate_one_block  0.0010216236114501953
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001096487045288086
gen group dst list time:  0.0001163482666015625
time for parepare:  0.0007202625274658203
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00041937828063964844
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00017023086547851562
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  0.0001304149627685547
r_  generation:  0.0011820793151855469
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.00032258033752441406
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0007290840148925781
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0002472400665283203
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  0.00011205673217773438
r_  generation:  0.0012807846069335938
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  0.0002300739288330078
r_  generation:  0.0015964508056640625
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0003447532653808594
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0001666545867919922
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.000461578369140625
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0003218650817871094
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.0006308555603027344
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  7.677078247070312e-05
r_  generation:  0.0006515979766845703
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00028395652770996094
----------------------check_connections_block total spend ----------------------------- 0.01578068733215332
generate_one_block  0.0021975040435791016
generate_one_block  0.001146554946899414
generate_one_block  0.002476930618286133
generate_one_block  0.0013463497161865234
generate_one_block  0.0018069744110107422
generate_one_block  0.0012164115905761719
generate_one_block  0.002592325210571289
generate_one_block  0.002846240997314453
generate_one_block  0.0013027191162109375
generate_one_block  0.0011119842529296875
generate_one_block  0.0017921924591064453
generate_one_block  0.0013151168823242188
generate_one_block  0.001706838607788086
generate_one_block  0.0017549991607666016
generate_one_block  0.0012466907501220703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001821756362915039
gen group dst list time:  0.00029397010803222656
time for parepare:  0.0015501976013183594
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.0005056858062744141
mini_batch_src_global generation:  0.00028967857360839844
r_  generation:  0.0022127628326416016
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  0.00017142295837402344
r_  generation:  0.0010981559753417969
local_output_nid generation:  0.00011897087097167969
local_in_edges_tensor generation:  0.00033855438232421875
mini_batch_src_global generation:  0.0005099773406982422
r_  generation:  0.0049228668212890625
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  0.00032258033752441406
r_  generation:  0.0024089813232421875
local_output_nid generation:  0.00010418891906738281
local_in_edges_tensor generation:  0.00030112266540527344
mini_batch_src_global generation:  0.0003757476806640625
r_  generation:  0.004253864288330078
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  0.0002505779266357422
r_  generation:  0.001840353012084961
local_output_nid generation:  0.0001957416534423828
local_in_edges_tensor generation:  0.0004215240478515625
mini_batch_src_global generation:  0.000453948974609375
r_  generation:  0.005902290344238281
local_output_nid generation:  0.00014781951904296875
local_in_edges_tensor generation:  0.00037980079650878906
mini_batch_src_global generation:  0.0007264614105224609
r_  generation:  0.005931377410888672
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  0.00035381317138671875
r_  generation:  0.002660036087036133
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  0.0001385211944580078
r_  generation:  0.0007824897766113281
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  0.00023651123046875
r_  generation:  0.002814054489135742
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.00019931793212890625
r_  generation:  0.0015876293182373047
local_output_nid generation:  0.00011444091796875
local_in_edges_tensor generation:  0.0002872943878173828
mini_batch_src_global generation:  0.0003638267517089844
r_  generation:  0.0043659210205078125
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.00025010108947753906
mini_batch_src_global generation:  0.0003705024719238281
r_  generation:  0.003029346466064453
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  0.00016307830810546875
r_  generation:  0.0009810924530029297
----------------------check_connections_block total spend ----------------------------- 0.06795191764831543
generate_one_block  0.0044727325439453125
generate_one_block  0.0023126602172851562
generate_one_block  0.007197141647338867
generate_one_block  0.003894329071044922
generate_one_block  0.007199287414550781
generate_one_block  0.0033309459686279297
generate_one_block  0.009110689163208008
generate_one_block  0.009244918823242188
generate_one_block  0.004525184631347656
generate_one_block  0.0018315315246582031
generate_one_block  0.004616975784301758
generate_one_block  0.002939939498901367
generate_one_block  0.0066378116607666016
generate_one_block  0.005717039108276367
generate_one_block  0.0020265579223632812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002252340316772461
gen group dst list time:  0.0014684200286865234
time for parepare:  0.0017855167388916016
local_output_nid generation:  0.0003452301025390625
local_in_edges_tensor generation:  0.0011162757873535156
mini_batch_src_global generation:  0.0009617805480957031
r_  generation:  0.008057117462158203
local_output_nid generation:  0.00022459030151367188
local_in_edges_tensor generation:  0.0004665851593017578
mini_batch_src_global generation:  0.00070953369140625
r_  generation:  0.0055544376373291016
local_output_nid generation:  0.00038695335388183594
local_in_edges_tensor generation:  0.0007710456848144531
mini_batch_src_global generation:  0.0009038448333740234
r_  generation:  0.010344982147216797
local_output_nid generation:  0.00024318695068359375
local_in_edges_tensor generation:  0.0004916191101074219
mini_batch_src_global generation:  0.0007593631744384766
r_  generation:  0.0065081119537353516
local_output_nid generation:  0.0005662441253662109
local_in_edges_tensor generation:  0.0011720657348632812
mini_batch_src_global generation:  0.0010128021240234375
r_  generation:  0.011710882186889648
local_output_nid generation:  0.0002999305725097656
local_in_edges_tensor generation:  0.0005843639373779297
mini_batch_src_global generation:  0.0008213520050048828
r_  generation:  0.0077860355377197266
local_output_nid generation:  0.000640869140625
local_in_edges_tensor generation:  0.0012531280517578125
mini_batch_src_global generation:  0.0012624263763427734
r_  generation:  0.01449131965637207
local_output_nid generation:  0.0006492137908935547
local_in_edges_tensor generation:  0.001035928726196289
mini_batch_src_global generation:  0.0013039112091064453
r_  generation:  0.014232635498046875
local_output_nid generation:  0.0003991127014160156
local_in_edges_tensor generation:  0.000637054443359375
mini_batch_src_global generation:  0.0009698867797851562
r_  generation:  0.00895547866821289
local_output_nid generation:  0.0001499652862548828
local_in_edges_tensor generation:  0.00033283233642578125
mini_batch_src_global generation:  0.0005037784576416016
r_  generation:  0.0034291744232177734
local_output_nid generation:  0.00033974647521972656
local_in_edges_tensor generation:  0.0005819797515869141
mini_batch_src_global generation:  0.0007302761077880859
r_  generation:  0.008803367614746094
local_output_nid generation:  0.00025153160095214844
local_in_edges_tensor generation:  0.000438690185546875
mini_batch_src_global generation:  0.0006020069122314453
r_  generation:  0.0055675506591796875
local_output_nid generation:  0.0005285739898681641
local_in_edges_tensor generation:  0.0008082389831542969
mini_batch_src_global generation:  0.0010614395141601562
r_  generation:  0.013248443603515625
local_output_nid generation:  0.0004444122314453125
local_in_edges_tensor generation:  0.0009169578552246094
mini_batch_src_global generation:  0.0011894702911376953
r_  generation:  0.011403560638427734
local_output_nid generation:  0.0001671314239501953
local_in_edges_tensor generation:  0.0003478527069091797
mini_batch_src_global generation:  0.0005185604095458984
r_  generation:  0.0037064552307128906
----------------------check_connections_block total spend ----------------------------- 0.1987309455871582
generate_one_block  0.011726140975952148
generate_one_block  0.009243965148925781
generate_one_block  0.013849020004272461
generate_one_block  0.010218143463134766
generate_one_block  0.01538538932800293
generate_one_block  0.012085199356079102
generate_one_block  0.01929163932800293
generate_one_block  0.019434452056884766
generate_one_block  0.012923955917358398
generate_one_block  0.0054814815521240234
generate_one_block  0.012717485427856445
generate_one_block  0.00795602798461914
generate_one_block  0.017264366149902344
generate_one_block  0.01565241813659668
generate_one_block  0.005762338638305664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007744789123535156  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

connection checking time:  0.2869689464569092
block generation total time  0.3064429759979248
average batch blocks generation time:  0.020429531733194988
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.024354934692382812  GigaBytes
Max Memory Allocated: 0.024354934692382812  GigaBytes

torch.Size([8765, 500])
torch.Size([3711, 32])
torch.Size([688, 32])
torch.Size([152, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1444091796875 GB
    Memory Allocated: 0.8656420707702637  GigaBytes
Max Memory Allocated: 0.9133224487304688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1444091796875 GB
    Memory Allocated: 0.031466007232666016  GigaBytes
Max Memory Allocated: 0.9133224487304688  GigaBytes

torch.Size([7637, 500])
torch.Size([2363, 32])
torch.Size([315, 32])
torch.Size([71, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1444091796875 GB
    Memory Allocated: 0.5976052284240723  GigaBytes
Max Memory Allocated: 0.9133224487304688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1444091796875 GB
    Memory Allocated: 0.03469085693359375  GigaBytes
Max Memory Allocated: 0.9133224487304688  GigaBytes

torch.Size([9590, 500])
torch.Size([4739, 32])
torch.Size([1484, 32])
torch.Size([312, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4041748046875 GB
    Memory Allocated: 1.1252622604370117  GigaBytes
Max Memory Allocated: 1.1640377044677734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4041748046875 GB
    Memory Allocated: 0.028481483459472656  GigaBytes
Max Memory Allocated: 1.1640377044677734  GigaBytes

torch.Size([6356, 500])
torch.Size([2756, 32])
torch.Size([576, 32])
torch.Size([97, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4041748046875 GB
    Memory Allocated: 0.743105411529541  GigaBytes
Max Memory Allocated: 1.1640377044677734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4041748046875 GB
    Memory Allocated: 0.0386347770690918  GigaBytes
Max Memory Allocated: 1.1640377044677734  GigaBytes

torch.Size([11722, 500])
torch.Size([6970, 32])
torch.Size([1322, 32])
torch.Size([275, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 1.1810393333435059  GigaBytes
Max Memory Allocated: 1.2412033081054688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 0.032450199127197266  GigaBytes
Max Memory Allocated: 1.2412033081054688  GigaBytes

torch.Size([8479, 500])
torch.Size([3292, 32])
torch.Size([455, 32])
torch.Size([99, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 0.8677563667297363  GigaBytes
Max Memory Allocated: 1.2412033081054688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 0.044287681579589844  GigaBytes
Max Memory Allocated: 1.2412033081054688  GigaBytes

torch.Size([14688, 500])
torch.Size([7843, 32])
torch.Size([2673, 32])
torch.Size([430, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8260498046875 GB
    Memory Allocated: 1.4732723236083984  GigaBytes
Max Memory Allocated: 1.5380945205688477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8260498046875 GB
    Memory Allocated: 0.040380001068115234  GigaBytes
Max Memory Allocated: 1.5380945205688477  GigaBytes

torch.Size([12570, 500])
torch.Size([6974, 32])
torch.Size([1801, 32])
torch.Size([407, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 1.4908246994018555  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.032979488372802734  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([8735, 500])
torch.Size([4168, 32])
torch.Size([622, 32])
torch.Size([108, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.9767417907714844  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.025006771087646484  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([4566, 500])
torch.Size([1443, 32])
torch.Size([269, 32])
torch.Size([88, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.37743043899536133  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.0343022346496582  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([9339, 500])
torch.Size([3996, 32])
torch.Size([805, 32])
torch.Size([130, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.9998126029968262  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.03148698806762695  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([7695, 500])
torch.Size([2679, 32])
torch.Size([639, 32])
torch.Size([111, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.6070208549499512  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.03901958465576172  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([11897, 500])
torch.Size([6073, 32])
torch.Size([1285, 32])
torch.Size([216, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 1.385218620300293  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.03836870193481445  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([11593, 500])
torch.Size([4729, 32])
torch.Size([1011, 32])
torch.Size([238, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 1.1719341278076172  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.027149200439453125  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([5715, 500])
torch.Size([1637, 32])
torch.Size([451, 32])
torch.Size([121, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.36336755752563477  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009725205103556315 |0.024454482396443687 |0.234648593266805 |0.0001357396443684896 |0.2700786113739014 |0.012805461883544922 |
----------------------------------------------------------pseudo_mini_loss sum 2.0233421325683594
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  220327
Number of first layer input nodes during this epoch:  139347
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.04279041290283203  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007035732269287109
range selection method range initialization spend 6.318092346191406e-05
time for parepare:  7.2479248046875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.814697265625e-05
----------------------check_connections_block total spend ----------------------------- 0.0031592845916748047
generate_one_block  0.0012063980102539062
generate_one_block  0.0010673999786376953
generate_one_block  0.0010449886322021484
generate_one_block  0.001055002212524414
generate_one_block  0.0010292530059814453
generate_one_block  0.00125885009765625
generate_one_block  0.0010466575622558594
generate_one_block  0.0010650157928466797
generate_one_block  0.0010628700256347656
generate_one_block  0.0010428428649902344
generate_one_block  0.0010352134704589844
generate_one_block  0.0010213851928710938
generate_one_block  0.0010182857513427734
generate_one_block  0.000978231430053711
generate_one_block  0.0009868144989013672
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007100105285644531
gen group dst list time:  8.559226989746094e-05
time for parepare:  0.0003104209899902344
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00023245811462402344
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00014901161193847656
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  9.393692016601562e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00012493133544921875
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.100799560546875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00010538101196289062
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00012445449829101562
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0002086162567138672
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.942054748535156e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  6.866455078125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.605552673339844e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.000194549560546875
----------------------check_connections_block total spend ----------------------------- 0.004990816116333008
generate_one_block  0.0013082027435302734
generate_one_block  0.0011234283447265625
generate_one_block  0.0012733936309814453
generate_one_block  0.0012354850769042969
generate_one_block  0.0010645389556884766
generate_one_block  0.0012307167053222656
generate_one_block  0.00122833251953125
generate_one_block  0.0013284683227539062
generate_one_block  0.0011224746704101562
generate_one_block  0.0010366439819335938
generate_one_block  0.0011129379272460938
generate_one_block  0.0010581016540527344
generate_one_block  0.001081228256225586
generate_one_block  0.0010678768157958984
generate_one_block  0.0012972354888916016
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013856887817382812
gen group dst list time:  0.00014925003051757812
time for parepare:  0.0010044574737548828
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.0003764629364013672
mini_batch_src_global generation:  0.00015544891357421875
r_  generation:  0.0008230209350585938
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.00021982192993164062
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0005278587341308594
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.0006735324859619141
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0001671314239501953
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0008609294891357422
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.00012135505676269531
r_  generation:  0.0007388591766357422
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  0.00018095970153808594
r_  generation:  0.0014371871948242188
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  0.00012612342834472656
r_  generation:  0.0006756782531738281
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.00032019615173339844
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  9.107589721679688e-05
r_  generation:  0.0006914138793945312
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00015783309936523438
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0003058910369873047
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.00043129920959472656
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  0.00014972686767578125
r_  generation:  0.0015218257904052734
----------------------check_connections_block total spend ----------------------------- 0.018336772918701172
generate_one_block  0.002507925033569336
generate_one_block  0.0012688636779785156
generate_one_block  0.0016703605651855469
generate_one_block  0.0019459724426269531
generate_one_block  0.0011723041534423828
generate_one_block  0.002127408981323242
generate_one_block  0.001959562301635742
generate_one_block  0.002796173095703125
generate_one_block  0.0019304752349853516
generate_one_block  0.001451730728149414
generate_one_block  0.001852273941040039
generate_one_block  0.0019345283508300781
generate_one_block  0.001348733901977539
generate_one_block  0.002128124237060547
generate_one_block  0.0029091835021972656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019550323486328125
gen group dst list time:  0.00039577484130859375
time for parepare:  0.0017445087432861328
local_output_nid generation:  0.00018405914306640625
local_in_edges_tensor generation:  0.0008246898651123047
mini_batch_src_global generation:  0.00044798851013183594
r_  generation:  0.003879070281982422
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  0.00021386146545410156
r_  generation:  0.0012297630310058594
local_output_nid generation:  9.298324584960938e-05
local_in_edges_tensor generation:  0.0002732276916503906
mini_batch_src_global generation:  0.0002586841583251953
r_  generation:  0.0028197765350341797
local_output_nid generation:  0.00012636184692382812
local_in_edges_tensor generation:  0.0003285408020019531
mini_batch_src_global generation:  0.0004124641418457031
r_  generation:  0.003887176513671875
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.00018286705017089844
r_  generation:  0.0008869171142578125
local_output_nid generation:  0.00016236305236816406
local_in_edges_tensor generation:  0.00040531158447265625
mini_batch_src_global generation:  0.00046181678771972656
r_  generation:  0.005167722702026367
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.0003497600555419922
mini_batch_src_global generation:  0.0005538463592529297
r_  generation:  0.004271984100341797
local_output_nid generation:  0.00020647048950195312
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0006101131439208984
r_  generation:  0.005500078201293945
local_output_nid generation:  0.00016498565673828125
local_in_edges_tensor generation:  0.000385284423828125
mini_batch_src_global generation:  0.00044536590576171875
r_  generation:  0.004177093505859375
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  0.00031447410583496094
r_  generation:  0.0024962425231933594
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.00031638145446777344
mini_batch_src_global generation:  0.0003333091735839844
r_  generation:  0.003262758255004883
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  0.0001933574676513672
r_  generation:  0.0011172294616699219
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00015306472778320312
r_  generation:  0.0012705326080322266
local_output_nid generation:  9.608268737792969e-05
local_in_edges_tensor generation:  0.0002677440643310547
mini_batch_src_global generation:  0.000217437744140625
r_  generation:  0.002158641815185547
local_output_nid generation:  0.00017714500427246094
local_in_edges_tensor generation:  0.000392913818359375
mini_batch_src_global generation:  0.0004918575286865234
r_  generation:  0.0052797794342041016
----------------------check_connections_block total spend ----------------------------- 0.07450413703918457
generate_one_block  0.007190227508544922
generate_one_block  0.0029740333557128906
generate_one_block  0.004896879196166992
generate_one_block  0.006516218185424805
generate_one_block  0.002058744430541992
generate_one_block  0.00807332992553711
generate_one_block  0.0073168277740478516
generate_one_block  0.008635282516479492
generate_one_block  0.006876468658447266
generate_one_block  0.004541158676147461
generate_one_block  0.0058672428131103516
generate_one_block  0.002584218978881836
generate_one_block  0.002826213836669922
generate_one_block  0.004162788391113281
generate_one_block  0.008354902267456055
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022521018981933594
gen group dst list time:  0.0016927719116210938
time for parepare:  0.0019648075103759766
local_output_nid generation:  0.0007059574127197266
local_in_edges_tensor generation:  0.001802206039428711
mini_batch_src_global generation:  0.0012865066528320312
r_  generation:  0.012286663055419922
local_output_nid generation:  0.00029158592224121094
local_in_edges_tensor generation:  0.000560760498046875
mini_batch_src_global generation:  0.0007491111755371094
r_  generation:  0.005501270294189453
local_output_nid generation:  0.0004429817199707031
local_in_edges_tensor generation:  0.0007426738739013672
mini_batch_src_global generation:  0.0013298988342285156
r_  generation:  0.009089231491088867
local_output_nid generation:  0.0007259845733642578
local_in_edges_tensor generation:  0.0010554790496826172
mini_batch_src_global generation:  0.0013663768768310547
r_  generation:  0.013111591339111328
local_output_nid generation:  0.0001952648162841797
local_in_edges_tensor generation:  0.0003972053527832031
mini_batch_src_global generation:  0.0005812644958496094
r_  generation:  0.0041997432708740234
local_output_nid generation:  0.0007007122039794922
local_in_edges_tensor generation:  0.000980377197265625
mini_batch_src_global generation:  0.0009925365447998047
r_  generation:  0.013379812240600586
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0010790824890136719
mini_batch_src_global generation:  0.0013873577117919922
r_  generation:  0.013442754745483398
local_output_nid generation:  0.0006842613220214844
local_in_edges_tensor generation:  0.0009131431579589844
mini_batch_src_global generation:  0.001196146011352539
r_  generation:  0.013070821762084961
local_output_nid generation:  0.0008070468902587891
local_in_edges_tensor generation:  0.0010063648223876953
mini_batch_src_global generation:  0.0014200210571289062
r_  generation:  0.014290809631347656
local_output_nid generation:  0.0004799365997314453
local_in_edges_tensor generation:  0.0006973743438720703
mini_batch_src_global generation:  0.0008921623229980469
r_  generation:  0.008556842803955078
local_output_nid generation:  0.0005142688751220703
local_in_edges_tensor generation:  0.0007085800170898438
mini_batch_src_global generation:  0.0009684562683105469
r_  generation:  0.010104179382324219
local_output_nid generation:  0.0003294944763183594
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.0006866455078125
r_  generation:  0.005864381790161133
local_output_nid generation:  0.000339508056640625
local_in_edges_tensor generation:  0.0004897117614746094
mini_batch_src_global generation:  0.00047135353088378906
r_  generation:  0.004721879959106445
local_output_nid generation:  0.00048160552978515625
local_in_edges_tensor generation:  0.0006952285766601562
mini_batch_src_global generation:  0.0006334781646728516
r_  generation:  0.007288217544555664
local_output_nid generation:  0.0006732940673828125
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0010323524475097656
r_  generation:  0.01192474365234375
----------------------check_connections_block total spend ----------------------------- 0.22075819969177246
generate_one_block  0.019907236099243164
generate_one_block  0.009093284606933594
generate_one_block  0.013566732406616211
generate_one_block  0.017728567123413086
generate_one_block  0.006578683853149414
generate_one_block  0.018372297286987305
generate_one_block  0.0180051326751709
generate_one_block  0.01736593246459961
generate_one_block  0.02182793617248535
generate_one_block  0.012958049774169922
generate_one_block  0.014253616333007812
generate_one_block  0.009286165237426758
generate_one_block  0.007386922836303711
generate_one_block  0.010532379150390625
generate_one_block  0.015602827072143555
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.04279041290283203  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

connection checking time:  0.3185899257659912
block generation total time  0.34191298484802246
average batch blocks generation time:  0.022794198989868165
block dataloader generation time/epoch 0.8470685482025146
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.0556793212890625  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([12561, 500])
torch.Size([5690, 32])
torch.Size([1403, 32])
torch.Size([293, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 1.2653179168701172  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.04570627212524414  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([7179, 500])
torch.Size([2489, 32])
torch.Size([375, 32])
torch.Size([86, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.5746269226074219  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.050255775451660156  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([9696, 500])
torch.Size([3915, 32])
torch.Size([803, 32])
torch.Size([167, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 1.0099892616271973  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.055722713470458984  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([12572, 500])
torch.Size([6355, 32])
torch.Size([1181, 32])
torch.Size([274, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 1.3550982475280762  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.042464256286621094  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([5626, 500])
torch.Size([1423, 32])
torch.Size([239, 32])
torch.Size([56, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.41377687454223633  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.05401611328125  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([11622, 500])
torch.Size([5979, 32])
torch.Size([1507, 32])
torch.Size([232, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 1.4117708206176758  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.056298255920410156  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([12875, 500])
torch.Size([7422, 32])
torch.Size([1299, 32])
torch.Size([284, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 1.3433012962341309  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.05401897430419922  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([11519, 500])
torch.Size([5930, 32])
torch.Size([1772, 32])
torch.Size([353, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 1.3274383544921875  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.058518409729003906  GigaBytes
Max Memory Allocated: 1.5469183921813965  GigaBytes

torch.Size([14048, 500])
torch.Size([6498, 32])
torch.Size([1498, 32])
torch.Size([163, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 1.4935288429260254  GigaBytes
Max Memory Allocated: 1.5724334716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.047792911529541016  GigaBytes
Max Memory Allocated: 1.5724334716796875  GigaBytes

torch.Size([8136, 500])
torch.Size([3901, 32])
torch.Size([573, 32])
torch.Size([100, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.9334611892700195  GigaBytes
Max Memory Allocated: 1.5724334716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.05176591873168945  GigaBytes
Max Memory Allocated: 1.5724334716796875  GigaBytes

torch.Size([10096, 500])
torch.Size([3868, 32])
torch.Size([1072, 32])
torch.Size([172, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 1.0923466682434082  GigaBytes
Max Memory Allocated: 1.5724334716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.0457158088684082  GigaBytes
Max Memory Allocated: 1.5724334716796875  GigaBytes

torch.Size([6990, 500])
torch.Size([2310, 32])
torch.Size([279, 32])
torch.Size([42, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.6114583015441895  GigaBytes
Max Memory Allocated: 1.5724334716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.04314422607421875  GigaBytes
Max Memory Allocated: 1.5724334716796875  GigaBytes

torch.Size([5973, 500])
torch.Size([2494, 32])
torch.Size([436, 32])
torch.Size([147, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.48262596130371094  GigaBytes
Max Memory Allocated: 1.5724334716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.04851722717285156  GigaBytes
Max Memory Allocated: 1.5724334716796875  GigaBytes
Using backend: pytorch

torch.Size([8805, 500])
torch.Size([3808, 32])
torch.Size([796, 32])
torch.Size([162, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.7804970741271973  GigaBytes
Max Memory Allocated: 1.5724334716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 0.05188131332397461  GigaBytes
Max Memory Allocated: 1.5724334716796875  GigaBytes

torch.Size([10045, 500])
torch.Size([5701, 32])
torch.Size([1514, 32])
torch.Size([379, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9862060546875 GB
    Memory Allocated: 1.2286252975463867  GigaBytes
Max Memory Allocated: 1.5724334716796875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00792849858601888 |0.0021938323974609376 |0.20310037930806477 |0.0001628875732421875 |0.2674562136332194 |0.009172916412353516 |
----------------------------------------------------------pseudo_mini_loss sum 1.8099768161773682
Total (block generation + training)time/epoch 8.101597547531128
Training time/epoch 7.254289388656616
Training time without block to device /epoch 7.221381902694702
Training time without total dataloading part /epoch 7.069965124130249
load block tensor time/epoch 0.1189274787902832
block to device time/epoch 0.03290748596191406
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  233539
Number of first layer input nodes during this epoch:  147743
