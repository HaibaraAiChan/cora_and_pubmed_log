main start at this time 1648532932.7892592
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0017611980438232422
range selection method range initialization spend 0.00010061264038085938
time for parepare:  4.744529724121094e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0014739036560058594
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.552436828613281e-05
----------------------check_connections_block total spend ----------------------------- 0.0025739669799804688
generate_one_block  0.0012366771697998047
generate_one_block  0.0011148452758789062
generate_one_block  0.001064300537109375
generate_one_block  0.0010726451873779297
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0009398460388183594
gen group dst list time:  3.337860107421875e-05
time for parepare:  0.0002472400665283203
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00023937225341796875
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0005357265472412109
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0002589225769042969
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0003418922424316406
----------------------check_connections_block total spend ----------------------------- 0.002862215042114258
generate_one_block  0.0013720989227294922
generate_one_block  0.0017902851104736328
generate_one_block  0.0013251304626464844
generate_one_block  0.0014917850494384766
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011093616485595703
gen group dst list time:  7.367134094238281e-05
time for parepare:  0.0007855892181396484
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0011332035064697266
local_output_nid generation:  7.152557373046875e-05
local_in_edges_tensor generation:  0.00026345252990722656
mini_batch_src_global generation:  0.0003075599670410156
r_  generation:  0.0034875869750976562
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00021338462829589844
r_  generation:  0.001543283462524414
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  0.00023937225341796875
r_  generation:  0.0023522377014160156
----------------------check_connections_block total spend ----------------------------- 0.013582944869995117
generate_one_block  0.0024862289428710938
generate_one_block  0.00516200065612793
generate_one_block  0.0027163028717041016
generate_one_block  0.0036139488220214844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019197463989257812
gen group dst list time:  0.00022649765014648438
time for parepare:  0.0015206336975097656
local_output_nid generation:  0.00013446807861328125
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.0006206035614013672
r_  generation:  0.005193471908569336
local_output_nid generation:  0.00029754638671875
local_in_edges_tensor generation:  0.0006737709045410156
mini_batch_src_global generation:  0.0013003349304199219
r_  generation:  0.011658906936645508
local_output_nid generation:  0.0002307891845703125
local_in_edges_tensor generation:  0.00113677978515625
mini_batch_src_global generation:  0.0008471012115478516
r_  generation:  0.006877899169921875
local_output_nid generation:  0.0002932548522949219
local_in_edges_tensor generation:  0.0006263256072998047
mini_batch_src_global generation:  0.001005411148071289
r_  generation:  0.011084556579589844
----------------------check_connections_block total spend ----------------------------- 0.05301046371459961
generate_one_block  0.00829935073852539
generate_one_block  0.014648199081420898
generate_one_block  0.011110782623291016
generate_one_block  0.015252828598022461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017120838165283203
gen group dst list time:  0.0007891654968261719
time for parepare:  0.0017244815826416016
local_output_nid generation:  0.0006759166717529297
local_in_edges_tensor generation:  0.0014562606811523438
mini_batch_src_global generation:  0.0014233589172363281
r_  generation:  0.015705347061157227
local_output_nid generation:  0.0009241104125976562
local_in_edges_tensor generation:  0.0014641284942626953
mini_batch_src_global generation:  0.002252340316772461
r_  generation:  0.020474910736083984
local_output_nid generation:  0.0008983612060546875
local_in_edges_tensor generation:  0.001432180404663086
mini_batch_src_global generation:  0.0016205310821533203
r_  generation:  0.019172191619873047
local_output_nid generation:  0.0012018680572509766
local_in_edges_tensor generation:  0.0019526481628417969
mini_batch_src_global generation:  0.0019135475158691406
r_  generation:  0.021720170974731445
----------------------check_connections_block total spend ----------------------------- 0.11353445053100586
generate_one_block  0.019581317901611328
generate_one_block  0.02706170082092285
generate_one_block  0.024611711502075195
generate_one_block  0.02816319465637207
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

connection checking time:  0.18299007415771484
block generation total time  0.1686868667602539
average batch blocks generation time:  0.04217171669006348
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1307373046875 GB
    Memory Allocated: 0.03688955307006836  GigaBytes
Max Memory Allocated: 0.03688955307006836  GigaBytes

torch.Size([13996, 500])
torch.Size([8036, 128])
torch.Size([1720, 128])
torch.Size([495, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9783935546875 GB
    Memory Allocated: 1.664717674255371  GigaBytes
Max Memory Allocated: 1.6647658348083496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9783935546875 GB
    Memory Allocated: 0.0530548095703125  GigaBytes
Max Memory Allocated: 1.6656579971313477  GigaBytes

torch.Size([16621, 500])
torch.Size([11289, 128])
torch.Size([4147, 128])
torch.Size([1022, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7420654296875 GB
    Memory Allocated: 2.397843837738037  GigaBytes
Max Memory Allocated: 2.397918701171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7420654296875 GB
    Memory Allocated: 0.052281856536865234  GigaBytes
Max Memory Allocated: 2.3987550735473633  GigaBytes

torch.Size([16318, 500])
torch.Size([9670, 128])
torch.Size([2803, 128])
torch.Size([499, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7420654296875 GB
    Memory Allocated: 2.05843448638916  GigaBytes
Max Memory Allocated: 2.3987550735473633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7420654296875 GB
    Memory Allocated: 0.053231239318847656  GigaBytes
Max Memory Allocated: 2.3987550735473633  GigaBytes

torch.Size([16731, 500])
torch.Size([12486, 128])
torch.Size([3400, 128])
torch.Size([800, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8690185546875 GB
    Memory Allocated: 2.419921875  GigaBytes
Max Memory Allocated: 2.419982433319092  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014623641967773438 |0.08702892065048218 |0.4036743640899658 |0.00017386674880981445 |0.35157352685928345 |0.011903762817382812 |
----------------------------------------------------------pseudo_mini_loss sum 2.1743454933166504
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  120389
Number of first layer input nodes during this epoch:  63666
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.8690185546875 GB
    Memory Allocated: 0.075927734375  GigaBytes
Max Memory Allocated: 2.4208474159240723  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005502700805664062
range selection method range initialization spend 5.340576171875e-05
time for parepare:  6.0558319091796875e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.076957702636719e-05
----------------------check_connections_block total spend ----------------------------- 0.0011074542999267578
generate_one_block  0.0012156963348388672
generate_one_block  0.0011837482452392578
generate_one_block  0.0011153221130371094
generate_one_block  0.0011017322540283203
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005652904510498047
gen group dst list time:  3.886222839355469e-05
time for parepare:  0.00029468536376953125
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0002281665802001953
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.00044465065002441406
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0002536773681640625
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.00043272972106933594
----------------------check_connections_block total spend ----------------------------- 0.003048419952392578
generate_one_block  0.0016105175018310547
generate_one_block  0.0017852783203125
generate_one_block  0.001435995101928711
generate_one_block  0.0017383098602294922
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001065969467163086
gen group dst list time:  9.393692016601562e-05
time for parepare:  0.0008084774017333984
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.0002696514129638672
mini_batch_src_global generation:  0.0001461505889892578
r_  generation:  0.001224517822265625
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  0.00028896331787109375
r_  generation:  0.0027723312377929688
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.0017216205596923828
local_output_nid generation:  0.00010848045349121094
local_in_edges_tensor generation:  0.0002613067626953125
mini_batch_src_global generation:  0.00029850006103515625
r_  generation:  0.0032210350036621094
----------------------check_connections_block total spend ----------------------------- 0.014408588409423828
generate_one_block  0.0028858184814453125
generate_one_block  0.004544258117675781
generate_one_block  0.0032460689544677734
generate_one_block  0.004980802536010742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019123554229736328
gen group dst list time:  0.00024580955505371094
time for parepare:  0.0013811588287353516
local_output_nid generation:  0.00018596649169921875
local_in_edges_tensor generation:  0.000591278076171875
mini_batch_src_global generation:  0.0006153583526611328
r_  generation:  0.006209611892700195
local_output_nid generation:  0.0003113746643066406
local_in_edges_tensor generation:  0.0006208419799804688
mini_batch_src_global generation:  0.0011548995971679688
r_  generation:  0.010892629623413086
local_output_nid generation:  0.0002853870391845703
local_in_edges_tensor generation:  0.0005559921264648438
mini_batch_src_global generation:  0.0009028911590576172
r_  generation:  0.007976770401000977
local_output_nid generation:  0.00034356117248535156
local_in_edges_tensor generation:  0.0006582736968994141
mini_batch_src_global generation:  0.0011208057403564453
r_  generation:  0.011906623840332031
----------------------check_connections_block total spend ----------------------------- 0.054900407791137695
generate_one_block  0.010489463806152344
generate_one_block  0.015337467193603516
generate_one_block  0.013504266738891602
generate_one_block  0.01718425750732422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019459724426269531
gen group dst list time:  0.0008139610290527344
time for parepare:  0.0017535686492919922
local_output_nid generation:  0.0007793903350830078
local_in_edges_tensor generation:  0.0014712810516357422
mini_batch_src_global generation:  0.001543283462524414
r_  generation:  0.01633930206298828
local_output_nid generation:  0.0010542869567871094
local_in_edges_tensor generation:  0.0017747879028320312
mini_batch_src_global generation:  0.002340078353881836
r_  generation:  0.020667314529418945
local_output_nid generation:  0.0011036396026611328
local_in_edges_tensor generation:  0.0016307830810546875
mini_batch_src_global generation:  0.0018138885498046875
r_  generation:  0.020136594772338867
local_output_nid generation:  0.0013437271118164062
local_in_edges_tensor generation:  0.0014941692352294922
mini_batch_src_global generation:  0.0019850730895996094
Using backend: pytorch
r_  generation:  0.021497726440429688
----------------------check_connections_block total spend ----------------------------- 0.11692070960998535
generate_one_block  0.022480010986328125
generate_one_block  0.03057861328125
generate_one_block  0.02816319465637207
generate_one_block  0.02808070182800293
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8690185546875 GB
    Memory Allocated: 0.075927734375  GigaBytes
Max Memory Allocated: 2.4208474159240723  GigaBytes

connection checking time:  0.18927812576293945
block generation total time  0.18804502487182617
average batch blocks generation time:  0.04701125621795654
block dataloader generation time/epoch 0.4422733783721924
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8690185546875 GB
    Memory Allocated: 0.06906270980834961  GigaBytes
Max Memory Allocated: 2.4208474159240723  GigaBytes

torch.Size([13901, 500])
torch.Size([7656, 128])
torch.Size([1866, 128])
torch.Size([420, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8690185546875 GB
    Memory Allocated: 1.8038320541381836  GigaBytes
Max Memory Allocated: 2.4208474159240723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8690185546875 GB
    Memory Allocated: 0.07412958145141602  GigaBytes
Max Memory Allocated: 2.4208474159240723  GigaBytes

torch.Size([16489, 500])
torch.Size([11460, 128])
torch.Size([3682, 128])
torch.Size([903, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8690185546875 GB
    Memory Allocated: 2.3584232330322266  GigaBytes
Max Memory Allocated: 2.4208474159240723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8690185546875 GB
    Memory Allocated: 0.07425642013549805  GigaBytes
Max Memory Allocated: 2.4208474159240723  GigaBytes

torch.Size([16612, 500])
torch.Size([10449, 128])
torch.Size([3150, 128])
torch.Size([560, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8690185546875 GB
    Memory Allocated: 2.216099262237549  GigaBytes
Max Memory Allocated: 2.4208474159240723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8690185546875 GB
    Memory Allocated: 0.07418394088745117  GigaBytes
Max Memory Allocated: 2.4208474159240723  GigaBytes

torch.Size([16268, 500])
torch.Size([12115, 128])
torch.Size([3712, 128])
torch.Size([968, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8709716796875 GB
    Memory Allocated: 2.4292588233947754  GigaBytes
Max Memory Allocated: 2.4294023513793945  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0105782151222229 |0.0017794370651245117 |0.27483952045440674 |0.0001442432403564453 |0.3527109622955322 |0.012893915176391602 |
----------------------------------------------------------pseudo_mini_loss sum 1.872534990310669
Total (block generation + training)time/epoch 3.024998426437378
Training time/epoch 2.582395076751709
Training time without block to device /epoch 2.575277328491211
Training time without total dataloading part /epoch 2.5236728191375732
load block tensor time/epoch 0.0423128604888916
block to device time/epoch 0.007117748260498047
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  120567
Number of first layer input nodes during this epoch:  63270
