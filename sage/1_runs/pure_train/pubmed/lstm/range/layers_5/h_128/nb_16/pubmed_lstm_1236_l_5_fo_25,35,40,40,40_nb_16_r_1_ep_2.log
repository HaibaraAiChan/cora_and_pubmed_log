main start at this time 1648532948.6709068
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0016298294067382812
range selection method range initialization spend 9.751319885253906e-05
time for parepare:  5.435943603515625e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0002932548522949219
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0026397705078125
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.4557113647460938e-05
----------------------check_connections_block total spend ----------------------------- 0.0046825408935546875
generate_one_block  0.001447916030883789
generate_one_block  0.0012581348419189453
generate_one_block  0.0012943744659423828
generate_one_block  0.00125885009765625
generate_one_block  0.001239776611328125
generate_one_block  0.0013082027435302734
generate_one_block  0.0012001991271972656
generate_one_block  0.0010657310485839844
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007002353668212891
gen group dst list time:  6.723403930664062e-05
time for parepare:  0.0003006458282470703
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0002243518829345703
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.000171661376953125
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001659393310546875
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00034999847412109375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00029754638671875
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00011229515075683594
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0002903938293457031
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00017333030700683594
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00010919570922851562
----------------------check_connections_block total spend ----------------------------- 0.004158973693847656
generate_one_block  0.0014183521270751953
generate_one_block  0.0014503002166748047
generate_one_block  0.001712799072265625
generate_one_block  0.0016202926635742188
generate_one_block  0.001425027847290039
generate_one_block  0.0016131401062011719
generate_one_block  0.00125885009765625
generate_one_block  0.0010488033294677734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011830329895019531
gen group dst list time:  0.00011944770812988281
time for parepare:  0.0009467601776123047
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0002875328063964844
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0005431175231933594
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  9.274482727050781e-05
r_  generation:  0.0008556842803955078
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0002474784851074219
mini_batch_src_global generation:  0.0002548694610595703
r_  generation:  0.0026235580444335938
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00023627281188964844
mini_batch_src_global generation:  0.0003001689910888672
r_  generation:  0.0022382736206054688
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  0.00012350082397460938
r_  generation:  0.00072479248046875
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.0002429485321044922
mini_batch_src_global generation:  0.0002014636993408203
r_  generation:  0.002200603485107422
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0009615421295166016
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.00032973289489746094
----------------------check_connections_block total spend ----------------------------- 0.017436981201171875
generate_one_block  0.001560211181640625
generate_one_block  0.0017778873443603516
generate_one_block  0.003655672073364258
generate_one_block  0.003279447555541992
generate_one_block  0.001611471176147461
generate_one_block  0.0031960010528564453
generate_one_block  0.0020852088928222656
generate_one_block  0.0013430118560791016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019674301147460938
gen group dst list time:  0.0003440380096435547
time for parepare:  0.0018436908721923828
local_output_nid generation:  6.771087646484375e-05
local_in_edges_tensor generation:  0.0004451274871826172
mini_batch_src_global generation:  0.000263214111328125
r_  generation:  0.002131223678588867
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.00029015541076660156
mini_batch_src_global generation:  0.0005044937133789062
r_  generation:  0.0039594173431396484
local_output_nid generation:  0.0002415180206298828
local_in_edges_tensor generation:  0.0005462169647216797
mini_batch_src_global generation:  0.0010638236999511719
r_  generation:  0.008820772171020508
local_output_nid generation:  0.00018143653869628906
local_in_edges_tensor generation:  0.0004172325134277344
mini_batch_src_global generation:  0.0008273124694824219
r_  generation:  0.006964921951293945
local_output_nid generation:  0.00010919570922851562
local_in_edges_tensor generation:  0.0002818107604980469
mini_batch_src_global generation:  0.00045680999755859375
r_  generation:  0.0031239986419677734
local_output_nid generation:  0.0002720355987548828
local_in_edges_tensor generation:  0.0005240440368652344
mini_batch_src_global generation:  0.0007009506225585938
r_  generation:  0.008881568908691406
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.0003180503845214844
mini_batch_src_global generation:  0.0006344318389892578
r_  generation:  0.0050830841064453125
local_output_nid generation:  6.771087646484375e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.0003006458282470703
r_  generation:  0.002127408981323242
----------------------check_connections_block total spend ----------------------------- 0.06234025955200195
generate_one_block  0.003961086273193359
generate_one_block  0.0062944889068603516
generate_one_block  0.012071847915649414
generate_one_block  0.010784149169921875
generate_one_block  0.005117893218994141
generate_one_block  0.012634754180908203
generate_one_block  0.007699251174926758
generate_one_block  0.0037605762481689453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021071434020996094
gen group dst list time:  0.0012290477752685547
time for parepare:  0.0018124580383300781
local_output_nid generation:  0.0003619194030761719
local_in_edges_tensor generation:  0.0010623931884765625
mini_batch_src_global generation:  0.0009138584136962891
r_  generation:  0.00810861587524414
local_output_nid generation:  0.0005695819854736328
local_in_edges_tensor generation:  0.0010018348693847656
mini_batch_src_global generation:  0.001451253890991211
r_  generation:  0.013406515121459961
local_output_nid generation:  0.0007624626159667969
local_in_edges_tensor generation:  0.0016584396362304688
mini_batch_src_global generation:  0.0018143653869628906
r_  generation:  0.018126249313354492
local_output_nid generation:  0.00078582763671875
local_in_edges_tensor generation:  0.0012335777282714844
mini_batch_src_global generation:  0.0015652179718017578
r_  generation:  0.017084836959838867
local_output_nid generation:  0.0005395412445068359
local_in_edges_tensor generation:  0.0008442401885986328
mini_batch_src_global generation:  0.0011854171752929688
r_  generation:  0.012795448303222656
local_output_nid generation:  0.0010666847229003906
local_in_edges_tensor generation:  0.0015316009521484375
mini_batch_src_global generation:  0.001990079879760742
r_  generation:  0.020948410034179688
local_output_nid generation:  0.0005750656127929688
local_in_edges_tensor generation:  0.0009653568267822266
mini_batch_src_global generation:  0.0013196468353271484
r_  generation:  0.014260530471801758
local_output_nid generation:  0.0004334449768066406
local_in_edges_tensor generation:  0.0006954669952392578
mini_batch_src_global generation:  0.000986337661743164
r_  generation:  0.008742094039916992
----------------------check_connections_block total spend ----------------------------- 0.1671736240386963
generate_one_block  0.012346267700195312
generate_one_block  0.016430377960205078
generate_one_block  0.025147676467895508
generate_one_block  0.0219879150390625
generate_one_block  0.01724076271057129
generate_one_block  0.02680492401123047
generate_one_block  0.01869654655456543
generate_one_block  0.01338815689086914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

connection checking time:  0.2511098384857178
block generation total time  0.24442315101623535
average batch blocks generation time:  0.03055289387702942
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1229248046875 GB
    Memory Allocated: 0.028489112854003906  GigaBytes
Max Memory Allocated: 0.028489112854003906  GigaBytes

torch.Size([9632, 500])
torch.Size([3647, 128])
torch.Size([780, 128])
torch.Size([213, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1131591796875 GB
    Memory Allocated: 0.8549184799194336  GigaBytes
Max Memory Allocated: 0.8549485206604004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.0440516471862793  GigaBytes
Max Memory Allocated: 0.8560786247253418  GigaBytes

torch.Size([12077, 500])
torch.Size([6364, 128])
torch.Size([1112, 128])
torch.Size([302, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7225341796875 GB
    Memory Allocated: 1.4180588722229004  GigaBytes
Max Memory Allocated: 1.4180917739868164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7225341796875 GB
    Memory Allocated: 0.050164222717285156  GigaBytes
Max Memory Allocated: 1.4190149307250977  GigaBytes

torch.Size([15204, 500])
torch.Size([9065, 128])
torch.Size([3160, 128])
torch.Size([627, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4002685546875 GB
    Memory Allocated: 2.061314582824707  GigaBytes
Max Memory Allocated: 2.061368942260742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4022216796875 GB
    Memory Allocated: 0.04761648178100586  GigaBytes
Max Memory Allocated: 2.062246322631836  GigaBytes

torch.Size([13875, 500])
torch.Size([8264, 128])
torch.Size([2227, 128])
torch.Size([493, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4022216796875 GB
    Memory Allocated: 1.8803863525390625  GigaBytes
Max Memory Allocated: 2.062246322631836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4022216796875 GB
    Memory Allocated: 0.0450129508972168  GigaBytes
Max Memory Allocated: 2.062246322631836  GigaBytes

torch.Size([12610, 500])
torch.Size([5451, 128])
torch.Size([1099, 128])
torch.Size([193, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4022216796875 GB
    Memory Allocated: 1.3479609489440918  GigaBytes
Max Memory Allocated: 2.062246322631836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4022216796875 GB
    Memory Allocated: 0.05340766906738281  GigaBytes
Max Memory Allocated: 2.062246322631836  GigaBytes

torch.Size([16911, 500])
torch.Size([11650, 128])
torch.Size([3389, 128])
torch.Size([589, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 2.3290438652038574  GigaBytes
Max Memory Allocated: 2.329096794128418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 0.04387092590332031  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

torch.Size([11942, 500])
torch.Size([6332, 128])
torch.Size([1454, 128])
torch.Size([327, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 1.5508065223693848  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 0.04094743728637695  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

torch.Size([9977, 500])
torch.Size([4276, 128])
torch.Size([686, 128])
torch.Size([155, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 1.0186758041381836  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01234462857246399 |0.04330337047576904 |0.301631361246109 |0.00014984607696533203 |0.32252535223960876 |0.012603998184204102 |
----------------------------------------------------------pseudo_mini_loss sum 2.058617115020752
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  174439
Number of first layer input nodes during this epoch:  102228
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 0.06246376037597656  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005655288696289062
range selection method range initialization spend 6.508827209472656e-05
time for parepare:  7.033348083496094e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  5.2928924560546875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.430511474609375e-05
----------------------check_connections_block total spend ----------------------------- 0.001856088638305664
generate_one_block  0.0011713504791259766
generate_one_block  0.0014064311981201172
generate_one_block  0.0010979175567626953
generate_one_block  0.001093149185180664
generate_one_block  0.0010759830474853516
generate_one_block  0.0010695457458496094
generate_one_block  0.0010759830474853516
generate_one_block  0.0010318756103515625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005736351013183594
gen group dst list time:  6.103515625e-05
time for parepare:  0.000331878662109375
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.0001544952392578125
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.00021696090698242188
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0001678466796875
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00023317337036132812
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00013947486877441406
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  9.584426879882812e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.00037932395935058594
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  7.295608520507812e-05
----------------------check_connections_block total spend ----------------------------- 0.0039005279541015625
generate_one_block  0.0013048648834228516
generate_one_block  0.0013425350189208984
generate_one_block  0.0012555122375488281
generate_one_block  0.001374959945678711
generate_one_block  0.001230478286743164
generate_one_block  0.0012145042419433594
generate_one_block  0.001615762710571289
generate_one_block  0.0011017322540283203
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011897087097167969
gen group dst list time:  0.00012254714965820312
time for parepare:  0.0009250640869140625
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0004429817199707031
mini_batch_src_global generation:  0.00013589859008789062
r_  generation:  0.0008881092071533203
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  0.00015997886657714844
r_  generation:  0.0011224746704101562
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  0.0007319450378417969
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  0.00020241737365722656
r_  generation:  0.0016052722930908203
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  0.00014090538024902344
r_  generation:  0.0010368824005126953
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  0.00010132789611816406
r_  generation:  0.0006086826324462891
local_output_nid generation:  0.00010848045349121094
local_in_edges_tensor generation:  0.0002646446228027344
mini_batch_src_global generation:  0.00026416778564453125
r_  generation:  0.002899646759033203
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  0.00010752677917480469
r_  generation:  0.0002968311309814453
----------------------check_connections_block total spend ----------------------------- 0.016354084014892578
generate_one_block  0.0022530555725097656
generate_one_block  0.0024869441986083984
generate_one_block  0.0018627643585205078
generate_one_block  0.003180265426635742
generate_one_block  0.0023686885833740234
generate_one_block  0.0017461776733398438
generate_one_block  0.004528522491455078
generate_one_block  0.0012447834014892578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017507076263427734
gen group dst list time:  0.00034499168395996094
time for parepare:  0.0015456676483154297
local_output_nid generation:  0.0001671314239501953
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0005605220794677734
r_  generation:  0.005074262619018555
local_output_nid generation:  0.0001888275146484375
local_in_edges_tensor generation:  0.00038123130798339844
mini_batch_src_global generation:  0.0006480216979980469
r_  generation:  0.00523686408996582
local_output_nid generation:  0.00012493133544921875
local_in_edges_tensor generation:  0.00030303001403808594
mini_batch_src_global generation:  0.0003814697265625
r_  generation:  0.003407716751098633
local_output_nid generation:  0.0002474784851074219
local_in_edges_tensor generation:  0.0004296302795410156
mini_batch_src_global generation:  0.00058746337890625
r_  generation:  0.00684809684753418
local_output_nid generation:  0.0002110004425048828
local_in_edges_tensor generation:  0.000408172607421875
mini_batch_src_global generation:  0.00064849853515625
r_  generation:  0.00541377067565918
local_output_nid generation:  0.00012445449829101562
local_in_edges_tensor generation:  0.0002918243408203125
mini_batch_src_global generation:  0.00042748451232910156
r_  generation:  0.003530263900756836
local_output_nid generation:  0.00036978721618652344
local_in_edges_tensor generation:  0.0005955696105957031
mini_batch_src_global generation:  0.0009741783142089844
r_  generation:  0.011322021484375
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  0.0003769397735595703
r_  generation:  0.001338958740234375
----------------------check_connections_block total spend ----------------------------- 0.06447482109069824
generate_one_block  0.008726358413696289
generate_one_block  0.00856924057006836
generate_one_block  0.0058689117431640625
generate_one_block  0.010724782943725586
generate_one_block  0.008667469024658203
generate_one_block  0.005828380584716797
generate_one_block  0.015863895416259766
generate_one_block  0.0027976036071777344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020933151245117188
gen group dst list time:  0.0011475086212158203
time for parepare:  0.0019583702087402344
local_output_nid generation:  0.0007729530334472656
local_in_edges_tensor generation:  0.03272867202758789
mini_batch_src_global generation:  0.0016989707946777344
r_  generation:  0.016431093215942383
local_output_nid generation:  0.0007467269897460938
local_in_edges_tensor generation:  0.001306772232055664
mini_batch_src_global generation:  0.002173185348510742
r_  generation:  0.017947673797607422
local_output_nid generation:  0.0006992816925048828
local_in_edges_tensor generation:  0.0009219646453857422
mini_batch_src_global generation:  0.0012767314910888672
r_  generation:  0.014464139938354492
local_output_nid generation:  0.0008766651153564453
local_in_edges_tensor generation:  0.0012788772583007812
mini_batch_src_global generation:  0.0017974376678466797
r_  generation:  0.017958641052246094
local_output_nid generation:  0.0008213520050048828
local_in_edges_tensor generation:  0.0011861324310302734
mini_batch_src_global generation:  0.0015382766723632812
r_  generation:  0.01708054542541504
local_output_nid generation:  0.0006964206695556641
local_in_edges_tensor generation:  0.0008859634399414062
mini_batch_src_global generation:  0.0012662410736083984
r_  generation:  0.013501882553100586
local_output_nid generation:  0.0012798309326171875
local_in_edges_tensor generation:  0.0016260147094726562
mini_batch_src_global generation:  0.0016658306121826172
r_  generation:  0.02076888084411621
local_output_nid generation:  0.00038433074951171875
local_in_edges_tensor generation:  0.0005481243133544922
mini_batch_src_global generation:  0.0007426738739013672
r_  generation:  0.0055081844329833984
----------------------check_connections_block total spend ----------------------------- 0.21591448783874512
generate_one_block  0.019662141799926758
generate_one_block  0.024849414825439453
generate_one_block  0.016765117645263672
generate_one_block  0.02384805679321289
generate_one_block  0.023845911026000977
generate_one_block  0.018180131912231445
generate_one_block  0.028657913208007812
generate_one_block  0.00937199592590332
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 0.06246376037597656  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

connection checking time:  0.3006439208984375
block generation total time  0.26233887672424316
average batch blocks generation time:  0.032792359590530396
block dataloader generation time/epoch 0.6856513023376465
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 0.06621837615966797  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

torch.Size([12617, 500])
torch.Size([6258, 128])
torch.Size([1453, 128])
torch.Size([251, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 1.5641288757324219  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 0.0691227912902832  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

torch.Size([14157, 500])
torch.Size([7266, 128])
torch.Size([1765, 128])
torch.Size([416, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 1.69041109085083  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 0.06603813171386719  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

torch.Size([12098, 500])
torch.Size([5996, 128])
torch.Size([1136, 128])
torch.Size([328, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 1.233428955078125  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 0.07027244567871094  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

torch.Size([14709, 500])
torch.Size([8225, 128])
torch.Size([2324, 128])
torch.Size([453, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 1.9257192611694336  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 0.07118892669677734  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

torch.Size([15239, 500])
torch.Size([7627, 128])
torch.Size([2042, 128])
torch.Size([312, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 1.8318610191345215  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 0.06609058380126953  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

torch.Size([12287, 500])
torch.Size([5476, 128])
torch.Size([1152, 128])
torch.Size([187, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 1.4225058555603027  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6815185546875 GB
    Memory Allocated: 0.07268524169921875  GigaBytes
Max Memory Allocated: 2.329969882965088  GigaBytes

torch.Size([15898, 500])
torch.Size([11470, 128])
torch.Size([3408, 128])
torch.Size([829, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 2.3565778732299805  GigaBytes
Max Memory Allocated: 2.3567452430725098  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7362060546875 GB
    Memory Allocated: 0.05607318878173828  GigaBytes
Max Memory Allocated: 2.357515811920166  GigaBytes

torch.Size([7207, 500])
torch.Size([2478, 128])
torch.Size([344, 128])
torch.Size([108, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7362060546875 GB
    Memory Allocated: 0.6224799156188965  GigaBytes
Max Memory Allocated: 2.357515811920166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010236531496047974 |0.0022475719451904297 |0.23154839873313904 |0.00014388561248779297 |0.32235217094421387 |0.009216070175170898 |
----------------------------------------------------------pseudo_mini_loss sum 2.2326622009277344
Total (block generation + training)time/epoch 5.249147653579712
Training time/epoch 4.563169956207275
Training time without block to device /epoch 4.545189380645752
Training time without total dataloading part /epoch 4.4415717124938965
load block tensor time/epoch 0.08189225196838379
block to device time/epoch 0.017980575561523438
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  175872
Number of first layer input nodes during this epoch:  104212
