main start at this time 1648532919.5051098
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0032494068145751953
range selection method range initialization spend 7.724761962890625e-05
time for parepare:  4.124641418457031e-05
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0011162757873535156
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  5.9604644775390625e-05
----------------------check_connections_block total spend ----------------------------- 0.001798391342163086
generate_one_block  0.0012383460998535156
generate_one_block  0.0010533332824707031
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0016472339630126953
gen group dst list time:  2.384185791015625e-05
time for parepare:  0.0002582073211669922
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0007464885711669922
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0004792213439941406
----------------------check_connections_block total spend ----------------------------- 0.002328157424926758
generate_one_block  0.001922607421875
generate_one_block  0.001651763916015625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010311603546142578
gen group dst list time:  5.7220458984375e-05
time for parepare:  0.0007348060607910156
local_output_nid generation:  9.965896606445312e-05
local_in_edges_tensor generation:  0.00041413307189941406
mini_batch_src_global generation:  0.0003921985626220703
r_  generation:  0.004093170166015625
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  0.00041794776916503906
r_  generation:  0.003233671188354492
----------------------check_connections_block total spend ----------------------------- 0.011761665344238281
generate_one_block  0.0065000057220458984
generate_one_block  0.005244255065917969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019431114196777344
gen group dst list time:  0.00019598007202148438
time for parepare:  0.0014042854309082031
local_output_nid generation:  0.0003409385681152344
local_in_edges_tensor generation:  0.0010514259338378906
mini_batch_src_global generation:  0.0013172626495361328
r_  generation:  0.012835979461669922
local_output_nid generation:  0.00036978721618652344
local_in_edges_tensor generation:  0.0011675357818603516
mini_batch_src_global generation:  0.0016832351684570312
r_  generation:  0.013139009475708008
----------------------check_connections_block total spend ----------------------------- 0.0395505428314209
generate_one_block  0.01769876480102539
generate_one_block  0.01894354820251465
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018496513366699219
gen group dst list time:  0.0004961490631103516
time for parepare:  0.0014951229095458984
local_output_nid generation:  0.0008456707000732422
local_in_edges_tensor generation:  0.0020029544830322266
mini_batch_src_global generation:  0.0018787384033203125
r_  generation:  0.02123880386352539
local_output_nid generation:  0.0010938644409179688
local_in_edges_tensor generation:  0.002240419387817383
mini_batch_src_global generation:  0.002382040023803711
r_  generation:  0.022260665893554688
----------------------check_connections_block total spend ----------------------------- 0.0652163028717041
generate_one_block  0.02694559097290039
generate_one_block  0.02860116958618164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

connection checking time:  0.11885666847229004
block generation total time  0.10750770568847656
average batch blocks generation time:  0.05375385284423828
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.044497013092041016  GigaBytes
Max Memory Allocated: 0.044497013092041016  GigaBytes

torch.Size([17364, 500])
torch.Size([13375, 128])
torch.Size([5255, 128])
torch.Size([1498, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0076904296875 GB
    Memory Allocated: 2.6468505859375  GigaBytes
Max Memory Allocated: 2.6469688415527344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0096435546875 GB
    Memory Allocated: 0.055159568786621094  GigaBytes
Max Memory Allocated: 2.647732734680176  GigaBytes

torch.Size([18029, 500])
torch.Size([14402, 128])
torch.Size([5298, 128])
torch.Size([1241, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1463623046875 GB
    Memory Allocated: 2.7170844078063965  GigaBytes
Max Memory Allocated: 2.7171902656555176  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023338675498962402 |0.1710149049758911 |0.5693265199661255 |0.00017535686492919922 |0.4024622440338135 |0.010793447494506836 |
----------------------------------------------------------pseudo_mini_loss sum 1.8356263637542725
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  76817
Number of first layer input nodes during this epoch:  35393
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.1463623046875 GB
    Memory Allocated: 0.07734489440917969  GigaBytes
Max Memory Allocated: 2.71797513961792  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005443096160888672
range selection method range initialization spend 5.269050598144531e-05
time for parepare:  5.125999450683594e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  5.888938903808594e-05
----------------------check_connections_block total spend ----------------------------- 0.0007112026214599609
generate_one_block  0.0011718273162841797
generate_one_block  0.0011043548583984375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0018072128295898438
gen group dst list time:  2.8848648071289062e-05
time for parepare:  0.0002551078796386719
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0005998611450195312
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation: Using backend: pytorch
 9.441375732421875e-05
r_  generation:  0.000667572021484375
----------------------check_connections_block total spend ----------------------------- 0.0025262832641601562
generate_one_block  0.0019807815551757812
generate_one_block  0.001986265182495117
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010156631469726562
gen group dst list time:  6.937980651855469e-05
time for parepare:  0.0007050037384033203
local_output_nid generation:  0.0001399517059326172
local_in_edges_tensor generation:  0.0003790855407714844
mini_batch_src_global generation:  0.00032591819763183594
r_  generation:  0.0035321712493896484
local_output_nid generation:  0.00013947486877441406
local_in_edges_tensor generation:  0.0003154277801513672
mini_batch_src_global generation:  0.0005340576171875
r_  generation:  0.004514455795288086
----------------------check_connections_block total spend ----------------------------- 0.012635946273803711
generate_one_block  0.007193088531494141
generate_one_block  0.0071485042572021484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020525455474853516
gen group dst list time:  0.0001919269561767578
time for parepare:  0.0012829303741455078
local_output_nid generation:  0.0003399848937988281
local_in_edges_tensor generation:  0.0009987354278564453
mini_batch_src_global generation:  0.0010306835174560547
r_  generation:  0.012334585189819336
local_output_nid generation:  0.00044274330139160156
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0015532970428466797
r_  generation:  0.014632701873779297
----------------------check_connections_block total spend ----------------------------- 0.04029250144958496
generate_one_block  0.018280029296875
generate_one_block  0.0236358642578125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017566680908203125
gen group dst list time:  0.000514984130859375
time for parepare:  0.001425027847290039
local_output_nid generation:  0.0009429454803466797
local_in_edges_tensor generation:  0.001981973648071289
mini_batch_src_global generation:  0.0018191337585449219
r_  generation:  0.02118849754333496
local_output_nid generation:  0.0011234283447265625
local_in_edges_tensor generation:  0.0022156238555908203
mini_batch_src_global generation:  0.002514362335205078
r_  generation:  0.022964954376220703
----------------------check_connections_block total spend ----------------------------- 0.06617307662963867
generate_one_block  0.030333757400512695
generate_one_block  0.03129291534423828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.1463623046875 GB
    Memory Allocated: 0.07734489440917969  GigaBytes
Max Memory Allocated: 2.71797513961792  GigaBytes

connection checking time:  0.1216278076171875
block generation total time  0.12185120582580566
average batch blocks generation time:  0.06092560291290283
block dataloader generation time/epoch 0.28824377059936523
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1463623046875 GB
    Memory Allocated: 0.07418012619018555  GigaBytes
Max Memory Allocated: 2.71797513961792  GigaBytes

torch.Size([17231, 500])
torch.Size([12910, 128])
torch.Size([4787, 128])
torch.Size([1294, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1463623046875 GB
    Memory Allocated: 2.5776562690734863  GigaBytes
Max Memory Allocated: 2.71797513961792  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1463623046875 GB
    Memory Allocated: 0.07551002502441406  GigaBytes
Max Memory Allocated: 2.71797513961792  GigaBytes

torch.Size([17881, 500])
torch.Size([14452, 128])
torch.Size([5892, 128])
torch.Size([1496, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1463623046875 GB
    Memory Allocated: 2.7968616485595703  GigaBytes
Max Memory Allocated: 2.796967029571533  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015979766845703125 |0.002218008041381836 |0.29565954208374023 |0.00015664100646972656 |0.41813623905181885 |0.010454416275024414 |
----------------------------------------------------------pseudo_mini_loss sum 2.371215581893921
Total (block generation + training)time/epoch 1.770036220550537
Training time/epoch 1.4814963340759277
Training time without block to device /epoch 1.477060317993164
Training time without total dataloading part /epoch 1.438359260559082
load block tensor time/epoch 0.03195953369140625
block to device time/epoch 0.004436016082763672
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  76299
Number of first layer input nodes during this epoch:  35112
