main start at this time 1648532969.1046536
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0026781558990478516
range selection method range initialization spend 9.107589721679688e-05
time for parepare:  5.125999450683594e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0002601146697998047
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0012750625610351562
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.193450927734375e-05
----------------------check_connections_block total spend ----------------------------- 0.004314899444580078
generate_one_block  0.001253366470336914
generate_one_block  0.0011279582977294922
generate_one_block  0.0011105537414550781
generate_one_block  0.001104593276977539
generate_one_block  0.0011706352233886719
generate_one_block  0.0011146068572998047
generate_one_block  0.0010645389556884766
generate_one_block  0.00098419189453125
generate_one_block  0.0009624958038330078
generate_one_block  0.0009381771087646484
generate_one_block  0.000949859619140625
generate_one_block  0.0009474754333496094
generate_one_block  0.000965118408203125
generate_one_block  0.000942230224609375
generate_one_block  0.0009510517120361328
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013844966888427734
gen group dst list time:  9.584426879882812e-05
time for parepare:  0.00030612945556640625
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  9.250640869140625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.14984130859375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  9.894371032714844e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00018167495727539062
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001423358917236328
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  9.775161743164062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00017714500427246094
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00012302398681640625
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0001609325408935547
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00011992454528808594
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  9.775161743164062e-05
----------------------check_connections_block total spend ----------------------------- 0.00493931770324707
generate_one_block  0.0012314319610595703
generate_one_block  0.0011641979217529297
generate_one_block  0.001184701919555664
generate_one_block  0.0012731552124023438
generate_one_block  0.0014426708221435547
generate_one_block  0.0012509822845458984
generate_one_block  0.0010459423065185547
generate_one_block  0.0012145042419433594
generate_one_block  0.0010020732879638672
generate_one_block  0.0009768009185791016
generate_one_block  0.001127481460571289
generate_one_block  0.0011816024780273438
generate_one_block  0.000980377197265625
generate_one_block  0.00109100341796875
generate_one_block  0.00102996826171875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012230873107910156
gen group dst list time:  0.00014519691467285156
time for parepare:  0.0008413791656494141
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0003578662872314453
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0001823902130126953
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.00036644935607910156
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00046563148498535156
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.00016570091247558594
r_  generation:  0.0024018287658691406
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.0003523826599121094
mini_batch_src_global generation:  0.000225067138671875
r_  generation:  0.0017137527465820312
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00030159950256347656
mini_batch_src_global generation:  0.00014328956604003906
r_  generation:  0.0011546611785888672
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.0003418922424316406
mini_batch_src_global generation:  0.0002777576446533203
r_  generation:  0.0030732154846191406
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0002810955047607422
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0008499622344970703
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002682209014892578
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0005128383636474609
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0003066062927246094
mini_batch_src_global generation:  0.0001666545867919922
r_  generation:  0.0018565654754638672
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.0003409385681152344
mini_batch_src_global generation:  0.0002238750457763672
r_  generation:  0.0015437602996826172
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  8.511543273925781e-05
r_  generation:  0.0003876686096191406
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  0.00011372566223144531
r_  generation:  0.001154184341430664
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0005524158477783203
----------------------check_connections_block total spend ----------------------------- 0.028005599975585938
generate_one_block  0.0020148754119873047
generate_one_block  0.0016329288482666016
generate_one_block  0.0017018318176269531
generate_one_block  0.0014884471893310547
generate_one_block  0.0028219223022460938
generate_one_block  0.0018641948699951172
generate_one_block  0.0015804767608642578
generate_one_block  0.002541065216064453
generate_one_block  0.0013909339904785156
generate_one_block  0.0011925697326660156
generate_one_block  0.0022764205932617188
generate_one_block  0.0021746158599853516
generate_one_block  0.0011997222900390625
generate_one_block  0.0018343925476074219
generate_one_block  0.0013244152069091797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020956993103027344
gen group dst list time:  0.0002970695495605469
time for parepare:  0.0015566349029541016
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.0004482269287109375
mini_batch_src_global generation:  0.00017714500427246094
r_  generation:  0.0013117790222167969
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0006988048553466797
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  0.0002052783966064453
r_  generation:  0.002197265625
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.00027942657470703125
r_  generation:  0.002285003662109375
local_output_nid generation:  0.0001347064971923828
local_in_edges_tensor generation:  0.0003674030303955078
mini_batch_src_global generation:  0.0006325244903564453
r_  generation:  0.0057163238525390625
local_output_nid generation:  0.00010347366333007812
local_in_edges_tensor generation:  0.0002732276916503906
mini_batch_src_global generation:  0.00037407875061035156
r_  generation:  0.003293275833129883
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  0.00026869773864746094
r_  generation:  0.00270843505859375
local_output_nid generation:  0.00011396408081054688
local_in_edges_tensor generation:  0.0003056526184082031
mini_batch_src_global generation:  0.0004820823669433594
r_  generation:  0.004784822463989258
local_output_nid generation:  6.532669067382812e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.0002868175506591797
r_  generation:  0.0022814273834228516
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.00016236305236816406
r_  generation:  0.00121307373046875
local_output_nid generation:  0.000152587890625
local_in_edges_tensor generation:  0.0003466606140136719
mini_batch_src_global generation:  0.00036215782165527344
r_  generation:  0.0046346187591552734
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.0005383491516113281
mini_batch_src_global generation:  0.0007486343383789062
r_  generation:  0.005751609802246094
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  0.0003142356872558594
r_  generation:  0.002103567123413086
local_output_nid generation:  0.00010704994201660156
local_in_edges_tensor generation:  0.0002753734588623047
mini_batch_src_global generation:  0.00037598609924316406
r_  generation:  0.004212141036987305
local_output_nid generation:  6.842613220214844e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  0.0002894401550292969
r_  generation:  0.002277851104736328
----------------------check_connections_block total spend ----------------------------- 0.0693352222442627
generate_one_block  0.0036623477935791016
generate_one_block  0.0019042491912841797
generate_one_block  0.0037758350372314453
generate_one_block  0.004037380218505859
generate_one_block  0.008529424667358398
generate_one_block  0.005058765411376953
generate_one_block  0.004405021667480469
generate_one_block  0.007876873016357422
generate_one_block  0.003798961639404297
generate_one_block  0.0025556087493896484
generate_one_block  0.00693058967590332
generate_one_block  0.00910639762878418
generate_one_block  0.004262447357177734
generate_one_block  0.0066280364990234375
generate_one_block  0.003968000411987305
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021910667419433594
gen group dst list time:  0.0015289783477783203
time for parepare:  0.0017292499542236328
local_output_nid generation:  0.0002307891845703125
local_in_edges_tensor generation:  0.0009531974792480469
mini_batch_src_global generation:  0.0006384849548339844
r_  generation:  0.005755901336669922
local_output_nid generation:  0.0001220703125
local_in_edges_tensor generation:  0.00031828880310058594
mini_batch_src_global generation:  0.0004105567932128906
r_  generation:  0.0030727386474609375
local_output_nid generation:  0.000335693359375
local_in_edges_tensor generation:  0.0007534027099609375
mini_batch_src_global generation:  0.0008640289306640625
r_  generation:  0.008648872375488281
local_output_nid generation:  0.00037097930908203125
local_in_edges_tensor generation:  0.0006804466247558594
mini_batch_src_global generation:  0.0009338855743408203
r_  generation:  0.00864720344543457
local_output_nid generation:  0.0003859996795654297
local_in_edges_tensor generation:  0.0007281303405761719
mini_batch_src_global generation:  0.0009686946868896484
r_  generation:  0.010784149169921875
local_output_nid generation:  0.00047135353088378906
local_in_edges_tensor generation:  0.0008037090301513672
mini_batch_src_global generation:  0.0009737014770507812
r_  generation:  0.00991368293762207
local_output_nid generation:  0.0003871917724609375
local_in_edges_tensor generation:  0.0007393360137939453
mini_batch_src_global generation:  0.0010819435119628906
r_  generation:  0.009479999542236328
local_output_nid generation:  0.00045943260192871094
local_in_edges_tensor generation:  0.0007143020629882812
mini_batch_src_global generation:  0.0008001327514648438
r_  generation:  0.010712623596191406
local_output_nid generation:  0.00035643577575683594
local_in_edges_tensor generation:  0.0006053447723388672
mini_batch_src_global generation:  0.0007653236389160156
r_  generation:  0.009001016616821289
local_output_nid generation:  0.00025844573974609375
local_in_edges_tensor generation:  0.0004515647888183594
mini_batch_src_global generation:  0.0005950927734375
r_  generation:  0.005463838577270508
local_output_nid generation:  0.0005519390106201172
local_in_edges_tensor generation:  0.0012154579162597656
mini_batch_src_global generation:  0.0009737014770507812
r_  generation:  0.013232946395874023
local_output_nid generation:  0.0007607936859130859
local_in_edges_tensor generation:  0.001398324966430664
mini_batch_src_global generation:  0.0014874935150146484
r_  generation:  0.016292095184326172
local_output_nid generation:  0.00023794174194335938
local_in_edges_tensor generation:  0.0004525184631347656
mini_batch_src_global generation:  0.0007741451263427734
r_  generation:  0.006474971771240234
local_output_nid generation:  0.00046753883361816406
local_in_edges_tensor generation:  0.0007543563842773438
mini_batch_src_global generation:  0.0010044574737548828
r_  generation:  0.01201772689819336
local_output_nid generation:  0.0004215240478515625
local_in_edges_tensor generation:  0.0006415843963623047
mini_batch_src_global generation:  0.0009059906005859375
r_  generation:  0.008999109268188477
----------------------check_connections_block total spend ----------------------------- 0.2039344310760498
generate_one_block  0.009190559387207031
generate_one_block  0.0050411224365234375
generate_one_block  0.013167858123779297
generate_one_block  0.012404918670654297
generate_one_block  0.014719486236572266
generate_one_block  0.013247966766357422
generate_one_block  0.013554811477661133
generate_one_block  0.01419973373413086
generate_one_block  0.013480663299560547
generate_one_block  0.008157730102539062
generate_one_block  0.016971588134765625
generate_one_block  0.021931171417236328
generate_one_block  0.008973360061645508
generate_one_block  0.01572871208190918
generate_one_block  0.012605428695678711
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

connection checking time:  0.3062145709991455
block generation total time  0.31411075592041016
average batch blocks generation time:  0.020940717061360678
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.026107311248779297  GigaBytes
Max Memory Allocated: 0.026107311248779297  GigaBytes

torch.Size([7871, 500])
torch.Size([2605, 128])
torch.Size([486, 128])
torch.Size([142, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.6516671180725098  GigaBytes
Max Memory Allocated: 0.651881217956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.02974224090576172  GigaBytes
Max Memory Allocated: 0.6530070304870605  GigaBytes

torch.Size([4865, 500])
torch.Size([1371, 128])
torch.Size([294, 128])
torch.Size([71, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.36211633682250977  GigaBytes
Max Memory Allocated: 0.6530070304870605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.03890371322631836  GigaBytes
Max Memory Allocated: 0.6530070304870605  GigaBytes

torch.Size([9677, 500])
torch.Size([3971, 128])
torch.Size([596, 128])
torch.Size([116, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 1.0230631828308105  GigaBytes
Max Memory Allocated: 1.023515224456787  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.03936958312988281  GigaBytes
Max Memory Allocated: 1.0240259170532227  GigaBytes

torch.Size([9927, 500])
torch.Size([4585, 128])
torch.Size([647, 128])
torch.Size([196, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 1.0164060592651367  GigaBytes
Max Memory Allocated: 1.0240259170532227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.03916358947753906  GigaBytes
Max Memory Allocated: 1.0240259170532227  GigaBytes

torch.Size([9716, 500])
torch.Size([5128, 128])
torch.Size([1941, 128])
torch.Size([333, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 1.367508888244629  GigaBytes
Max Memory Allocated: 1.367541790008545  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.0419001579284668  GigaBytes
Max Memory Allocated: 1.3684587478637695  GigaBytes

torch.Size([11262, 500])
torch.Size([5109, 128])
torch.Size([1328, 128])
torch.Size([291, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 1.1112585067749023  GigaBytes
Max Memory Allocated: 1.3684587478637695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.041060447692871094  GigaBytes
Max Memory Allocated: 1.3684587478637695  GigaBytes

torch.Size([10820, 500])
torch.Size([4439, 128])
torch.Size([891, 128])
torch.Size([176, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 1.092689037322998  GigaBytes
Max Memory Allocated: 1.3684587478637695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.03861045837402344  GigaBytes
Max Memory Allocated: 1.3684587478637695  GigaBytes

torch.Size([9310, 500])
torch.Size([5324, 128])
torch.Size([1389, 128])
torch.Size([316, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 1.2997136116027832  GigaBytes
Max Memory Allocated: 1.3684587478637695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.0404205322265625  GigaBytes
Max Memory Allocated: 1.3684587478637695  GigaBytes

torch.Size([10439, 500])
torch.Size([3682, 128])
torch.Size([731, 128])
torch.Size([107, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 1.06181001663208  GigaBytes
Max Memory Allocated: 1.3684587478637695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.034759521484375  GigaBytes
Max Memory Allocated: 1.3684587478637695  GigaBytes

torch.Size([7519, 500])
torch.Size([2702, 128])
torch.Size([405, 128])
torch.Size([86, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.6152229309082031  GigaBytes
Max Memory Allocated: 1.3684587478637695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.04720163345336914  GigaBytes
Max Memory Allocated: 1.3684587478637695  GigaBytes

torch.Size([14037, 500])
torch.Size([6783, 128])
torch.Size([1884, 128])
torch.Size([252, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.5084762573242188  GigaBytes
Max Memory Allocated: 1.5085067749023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 0.048010826110839844  GigaBytes
Max Memory Allocated: 1.5094261169433594  GigaBytes

torch.Size([14402, 500])
torch.Size([9063, 128])
torch.Size([1818, 128])
torch.Size([343, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 1.8830842971801758  GigaBytes
Max Memory Allocated: 1.8831086158752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.03134632110595703  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([5656, 500])
torch.Size([2745, 128])
torch.Size([427, 128])
torch.Size([85, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.7554688453674316  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.042517662048339844  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([11423, 500])
torch.Size([5484, 128])
torch.Size([1209, 128])
torch.Size([248, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 1.4146943092346191  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.04041767120361328  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([10271, 500])
torch.Size([4541, 128])
torch.Size([720, 128])
torch.Size([155, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 1.055222988128662  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009400256474812825 |0.02383594512939453 |0.2393458048502604 |0.00014209747314453125 |0.27619428634643556 |0.013910055160522461 |
----------------------------------------------------------pseudo_mini_loss sum 1.8152590990066528
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  232767
Number of first layer input nodes during this epoch:  147195
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.06141090393066406  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0008425712585449219
range selection method range initialization spend 6.4849853515625e-05
time for parepare:  7.462501525878906e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.3828277587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0031080245971679688
generate_one_block  0.0011703968048095703
generate_one_block  0.0010564327239990234
generate_one_block  0.001068115234375
generate_one_block  0.001077890396118164
generate_one_block  0.001024007797241211
generate_one_block  0.0010521411895751953
generate_one_block  0.0011868476867675781
generate_one_block  0.0010645389556884766
generate_one_block  0.0010461807250976562
generate_one_block  0.0010690689086914062
generate_one_block  0.0010132789611816406
generate_one_block  0.0010235309600830078
generate_one_block  0.0010256767272949219
generate_one_block  0.0010509490966796875
generate_one_block  0.0009844303131103516
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00079345703125
gen group dst list time:  8.630752563476562e-05
time for parepare:  0.00031828880310058594
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  6.318092346191406e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00011515617370605469
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001513957977294922
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  8.726119995117188e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  9.846687316894531e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  5.316734313964844e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0001938343048095703
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  7.987022399902344e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  8.606910705566406e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001976490020751953
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0002028942108154297
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  8.034706115722656e-05
----------------------check_connections_block total spend ----------------------------- 0.005099058151245117
generate_one_block  0.0011527538299560547
generate_one_block  0.0011873245239257812
generate_one_block  0.0011417865753173828
generate_one_block  0.0013737678527832031
generate_one_block  0.0011398792266845703
generate_one_block  0.0011484622955322266
generate_one_block  0.0010988712310791016
generate_one_block  0.0012898445129394531
generate_one_block  0.001055002212524414
generate_one_block  0.0011606216430664062
generate_one_block  0.0010287761688232422
generate_one_block  0.0010437965393066406
generate_one_block  0.0012993812561035156
generate_one_block  0.0013074874877929688
generate_one_block  0.00103759765625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001176595687866211
gen group dst list time:  0.00015616416931152344
time for parepare:  0.0010929107666015625
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0002760887145996094
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.00027632713317871094
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  0.00012826919555664062
r_  generation:  0.0006854534149169922
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0003437995910644531
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  0.0001068115234375
r_  generation:  0.00081634521484375
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.00041556358337402344
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0003256797790527344
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00018715858459472656
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.0014102458953857422
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  9.1552734375e-05
r_  generation:  0.0004029273986816406
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.0006732940673828125
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.00023984909057617188
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.000392913818359375
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00022840499877929688
mini_batch_src_global generation:  0.00017833709716796875
r_  generation:  0.0016934871673583984
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.0001735687255859375
r_  generation:  0.0013020038604736328
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0002598762512207031
----------------------check_connections_block total spend ----------------------------- 0.018192768096923828
generate_one_block  0.0015282630920410156
generate_one_block  0.002101898193359375
generate_one_block  0.0014073848724365234
generate_one_block  0.002071857452392578
generate_one_block  0.0015180110931396484
generate_one_block  0.0013968944549560547
generate_one_block  0.0011878013610839844
generate_one_block  0.0029227733612060547
generate_one_block  0.0014531612396240234
generate_one_block  0.0019118785858154297
generate_one_block  0.0012462139129638672
generate_one_block  0.0014984607696533203
generate_one_block  0.003196239471435547
generate_one_block  0.002658367156982422
generate_one_block  0.0018618106842041016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002056598663330078
gen group dst list time:  0.0003845691680908203
time for parepare:  0.0017409324645996094
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.0005328655242919922
mini_batch_src_global generation:  0.0002117156982421875
r_  generation:  0.0014729499816894531
local_output_nid generation:  0.00014734268188476562
local_in_edges_tensor generation:  0.00034427642822265625
mini_batch_src_global generation:  0.0005519390106201172
r_  generation:  0.004227876663208008
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  0.0002617835998535156
r_  generation:  0.0016121864318847656
local_output_nid generation:  0.0001633167266845703
local_in_edges_tensor generation:  0.0003466606140136719
mini_batch_src_global generation:  0.0003590583801269531
r_  generation:  0.004122257232666016
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  0.00027751922607421875
r_  generation:  0.0020558834075927734
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.00019979476928710938
r_  generation:  0.0015749931335449219
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.00015091896057128906
r_  generation:  0.0011928081512451172
local_output_nid generation:  0.00022101402282714844
local_in_edges_tensor generation:  0.0004227161407470703
mini_batch_src_global generation:  0.0005135536193847656
r_  generation:  0.0059833526611328125
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.00025010108947753906
mini_batch_src_global generation:  0.0003368854522705078
r_  generation:  0.0021436214447021484
local_output_nid generation:  0.00015735626220703125
local_in_edges_tensor generation:  0.0003376007080078125
mini_batch_src_global generation:  0.0003521442413330078
r_  generation:  0.0038030147552490234
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  0.00023317337036132812
r_  generation:  0.0014314651489257812
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.0002532005310058594
mini_batch_src_global generation:  0.0002338886260986328
r_  generation:  0.0023436546325683594
local_output_nid generation:  0.00019550323486328125
local_in_edges_tensor generation:  0.00041961669921875
mini_batch_src_global generation:  0.0005109310150146484
r_  generation:  0.005510091781616211
local_output_nid generation:  0.00023221969604492188
local_in_edges_tensor generation:  0.0004355907440185547
mini_batch_src_global generation:  0.0007722377777099609
r_  generation:  0.0065495967864990234
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  0.0002799034118652344
r_  generation:  0.0012357234954833984
----------------------check_connections_block total spend ----------------------------- 0.07098960876464844
generate_one_block  0.0037097930908203125
generate_one_block  0.007057666778564453
generate_one_block  0.0031719207763671875
generate_one_block  0.00653076171875
generate_one_block  0.003960132598876953
generate_one_block  0.003031492233276367
generate_one_block  0.0026764869689941406
generate_one_block  0.009263277053833008
generate_one_block  0.0040514469146728516
generate_one_block  0.006252288818359375
generate_one_block  0.003031015396118164
generate_one_block  0.0046787261962890625
generate_one_block  0.008527994155883789
generate_one_block  0.011099100112915039
generate_one_block  0.002715587615966797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002225637435913086
gen group dst list time:  0.0015902519226074219
time for parepare:  0.0018146038055419922
local_output_nid generation:  0.0003135204315185547
local_in_edges_tensor generation:  0.001043558120727539
mini_batch_src_global generation:  0.0008001327514648438
r_  generation:  0.006443500518798828
local_output_nid generation:  0.0006644725799560547
local_in_edges_tensor generation:  0.0010325908660888672
mini_batch_src_global generation:  0.0013723373413085938
r_  generation:  0.012540102005004883
local_output_nid generation:  0.0002777576446533203
local_in_edges_tensor generation:  0.0005164146423339844
mini_batch_src_global generation:  0.0007047653198242188
r_  generation:  0.006226778030395508
local_output_nid generation:  0.0006763935089111328
local_in_edges_tensor generation:  0.0009915828704833984
mini_batch_src_global generation:  0.0011222362518310547
r_  generation:  0.012866497039794922
local_output_nid generation:  0.000453948974609375
local_in_edges_tensor generation:  0.0006973743438720703
mini_batch_src_global generation:  0.0008509159088134766
r_  generation:  0.0075838565826416016
local_output_nid generation:  0.0003509521484375
local_in_edges_tensor generation:  0.00055694580078125
mini_batch_src_global generation:  0.0005755424499511719
r_  generation:  0.005591392517089844
local_output_nid generation:  0.0002853870391845703
local_in_edges_tensor generation:  0.000476837158203125
mini_batch_src_global generation:  0.0004987716674804688
r_  generation:  0.0050890445709228516
local_output_nid generation:  0.0007295608520507812
local_in_edges_tensor generation:  0.0009927749633789062
mini_batch_src_global generation:  0.0011034011840820312
r_  generation:  0.014492034912109375
local_output_nid generation:  0.00042748451232910156
local_in_edges_tensor generation:  0.0006527900695800781
mini_batch_src_global generation:  0.0010294914245605469
r_  generation:  0.008144617080688477
local_output_nid generation:  0.0006558895111083984
local_in_edges_tensor generation:  0.0008549690246582031
mini_batch_src_global generation:  0.001100301742553711
r_  generation:  0.012420177459716797
local_output_nid generation:  0.00036072731018066406
local_in_edges_tensor generation:  0.000537872314453125
mini_batch_src_global generation:  0.0007882118225097656
r_  generation:  0.006568431854248047
local_output_nid generation:  0.0004620552062988281
local_in_edges_tensor generation:  0.0006330013275146484
mini_batch_src_global generation:  0.0008194446563720703
r_  generation:  0.008933782577514648
local_output_nid generation:  0.0005815029144287109
local_in_edges_tensor generation:  0.0007722377777099609
mini_batch_src_global generation:  0.0010242462158203125
r_  generation:  0.011193037033081055
local_output_nid generation:  0.0012450218200683594
local_in_edges_tensor generation:  0.0015134811401367188
mini_batch_src_global generation:  0.001558065414428711
r_  generation:  0.01793384552001953
local_output_nid generation:  0.0003349781036376953
local_in_edges_tensor generation:  0.0005173683166503906
mini_batch_src_global generation:  0.0007543563842773438
r_  generation:  0.005655050277709961
----------------------check_connections_block total spend ----------------------------- 0.2145991325378418
generate_one_block  0.01148223876953125
generate_one_block  0.017618417739868164
generate_one_block  0.01039576530456543
generate_one_block  0.01819777488708496
generate_one_block  0.011365175247192383
generate_one_block  0.008906364440917969
generate_one_block  0.008001089096069336
generate_one_block  0.019562959671020508
generate_one_block  0.014075517654418945
generate_one_block  0.017284870147705078
generate_one_block  0.010297298431396484
generate_one_block  0.013739585876464844
generate_one_block  0.014434576034545898
generate_one_block  0.024542808532714844
generate_one_block  0.008851051330566406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.06141090393066406  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

connection checking time:  0.3088805675506592
block generation total time  0.3339395523071289
average batch blocks generation time:  0.02226263682047526
block dataloader generation time/epoch 0.832528829574585
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.05697917938232422  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([7916, 500])
torch.Size([2200, 128])
torch.Size([509, 128])
torch.Size([74, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.7403016090393066  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.06307315826416016  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([11516, 500])
torch.Size([5704, 128])
torch.Size([1161, 128])
torch.Size([188, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 1.428769588470459  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.05503082275390625  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([7264, 500])
torch.Size([2386, 128])
torch.Size([467, 128])
torch.Size([133, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.7445187568664551  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.0658259391784668  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([13013, 500])
torch.Size([6191, 128])
torch.Size([1438, 128])
torch.Size([300, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 1.4474048614501953  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.058974266052246094  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([9258, 500])
torch.Size([3850, 128])
torch.Size([596, 128])
torch.Size([178, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.8627986907958984  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.05540180206298828  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([7556, 500])
torch.Size([2929, 128])
torch.Size([568, 128])
torch.Size([151, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.6417999267578125  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.05497932434082031  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([6903, 500])
torch.Size([2477, 128])
torch.Size([356, 128])
torch.Size([82, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.5912737846374512  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.0659475326538086  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([13014, 500])
torch.Size([6545, 128])
torch.Size([1977, 128])
torch.Size([367, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2947998046875 GB
    Memory Allocated: 1.6744303703308105  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.05900001525878906  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([9091, 500])
torch.Size([3523, 128])
torch.Size([634, 128])
torch.Size([142, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.9417891502380371  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.06615877151489258  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([13202, 500])
torch.Size([5536, 128])
torch.Size([1500, 128])
torch.Size([171, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.3875575065612793  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.05539703369140625  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([7537, 500])
torch.Size([2686, 128])
torch.Size([383, 128])
torch.Size([87, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.7633910179138184  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.0597987174987793  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([9847, 500])
torch.Size([3680, 128])
torch.Size([793, 128])
torch.Size([100, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.0638341903686523  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.0592041015625  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

torch.Size([9295, 500])
torch.Size([4906, 128])
torch.Size([1794, 128])
torch.Size([361, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.339160442352295  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.06925392150878906  GigaBytes
Max Memory Allocated: 1.884040355682373  GigaBytes
Using backend: pytorch

torch.Size([14742, 500])
torch.Size([9831, 128])
torch.Size([1992, 128])
torch.Size([486, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 1.9960298538208008  GigaBytes
Max Memory Allocated: 1.996077537536621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.05498790740966797  GigaBytes
Max Memory Allocated: 1.9969830513000488  GigaBytes

torch.Size([7311, 500])
torch.Size([2455, 128])
torch.Size([346, 128])
torch.Size([108, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4041748046875 GB
    Memory Allocated: 0.619781494140625  GigaBytes
Max Memory Allocated: 1.9969830513000488  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008768590291341145 |0.0020941734313964845 |0.20253683725992838 |0.00013375282287597656 |0.26811943054199217 |0.01141047477722168 |
----------------------------------------------------------pseudo_mini_loss sum 1.7455459833145142
Total (block generation + training)time/epoch 8.104301452636719
Training time/epoch 7.271512269973755
Training time without block to device /epoch 7.240099668502808
Training time without total dataloading part /epoch 7.07326078414917
load block tensor time/epoch 0.1315288543701172
block to device time/epoch 0.031412601470947266
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  230163
Number of first layer input nodes during this epoch:  147465
