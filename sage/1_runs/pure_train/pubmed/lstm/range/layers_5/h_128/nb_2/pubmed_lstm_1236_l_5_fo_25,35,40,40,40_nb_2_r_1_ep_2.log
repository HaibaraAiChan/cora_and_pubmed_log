main start at this time 1648532907.6491401
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0021407604217529297
range selection method range initialization spend 0.00010538101196289062
time for parepare:  4.458427429199219e-05
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00025153160095214844
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.002836465835571289
----------------------check_connections_block total spend ----------------------------- 0.0033087730407714844
generate_one_block  0.0015027523040771484
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001191854476928711
gen group dst list time:  1.9788742065429688e-05
time for parepare:  0.0002415180206298828
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  0.00013899803161621094
r_  generation:  0.0012021064758300781
----------------------check_connections_block total spend ----------------------------- 0.0021660327911376953
generate_one_block  0.002682209014892578
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010914802551269531
gen group dst list time:  5.1021575927734375e-05
time for parepare:  0.0007302761077880859
local_output_nid generation:  0.0001685619354248047
local_in_edges_tensor generation:  0.0005369186401367188
mini_batch_src_global generation:  0.0005843639373779297
r_  generation:  0.006651639938354492
----------------------check_connections_block total spend ----------------------------- 0.010689973831176758
generate_one_block  0.009757041931152344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021200180053710938
gen group dst list time:  0.0001437664031982422
time for parepare:  0.0013103485107421875
local_output_nid generation:  0.0005173683166503906
local_in_edges_tensor generation:  0.0013799667358398438
mini_batch_src_global generation:  0.0016739368438720703
r_  generation:  0.017560958862304688
----------------------check_connections_block total spend ----------------------------- 0.02762436866760254
generate_one_block  0.02320122718811035
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019884109497070312
gen group dst list time:  0.0002803802490234375
time for parepare:  0.0015120506286621094
local_output_nid generation:  0.0010488033294677734
local_in_edges_tensor generation:  0.0022559165954589844
mini_batch_src_global generation:  0.002034902572631836
r_  generation:  0.024251937866210938
----------------------check_connections_block total spend ----------------------------- 0.03737449645996094
generate_one_block  0.0298464298248291
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.010290145874023438  GigaBytes
Max Memory Allocated: 0.010290145874023438  GigaBytes

connection checking time:  0.07785487174987793
block generation total time  0.06548690795898438
average batch blocks generation time:  0.06548690795898438
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1405029296875 GB
    Memory Allocated: 0.046679019927978516  GigaBytes
Max Memory Allocated: 0.046679019927978516  GigaBytes

torch.Size([18620, 500])
torch.Size([16260, 128])
torch.Size([8122, 128])
torch.Size([2586, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3533935546875 GB
    Memory Allocated: 3.0435996055603027  GigaBytes
Max Memory Allocated: 3.043814182281494  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013938188552856445 |0.3446986675262451 |0.8771557807922363 |0.00033283233642578125 |0.4353344440460205 |0.014623165130615234 |
----------------------------------------------------------pseudo_mini_loss sum 2.009840726852417
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  45942
Number of first layer input nodes during this epoch:  18620
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 0.08071565628051758  GigaBytes
Max Memory Allocated: 3.044403076171875  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000514984130859375
range selection method range initialization spend 4.935264587402344e-05
time for parepare:  5.0067901611328125e-05
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0001125335693359375
----------------------check_connections_block total spend ----------------------------- 0.0005137920379638672
generate_one_block  0.0014111995697021484
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005397796630859375
gen group dst list time:  1.9073486328125e-05
time for parepare:  0.000255584716796875
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.0001239776611328125
r_  generation:  0.0012195110321044922
----------------------check_connections_block total spend ----------------------------- 0.0021991729736328125
generate_one_block  0.0032987594604492188
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010256767272949219
gen group dst list time:  6.031990051269531e-05
time for parepare:  0.0006985664367675781
local_output_nid generation:  0.00017309188842773438
local_in_edges_tensor generation:  0.0005338191986083984
mini_batch_src_global generation:  0.0005977153778076172
r_  generation:  0.006746768951416016
----------------------check_connections_block total spend ----------------------------- 0.01065373420715332
generate_one_block  0.011176347732543945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021288394927978516
gen group dst list time:  0.00014638900756835938
time for parepare:  0.0012867450714111328
local_output_nid generation:  0.0005152225494384766
local_in_edges_tensor generation:  0.0013744831085205078
mini_batch_src_global generation:  0.0015478134155273438
r_  generation:  0.017601966857910156
----------------------check_connections_block total spend ----------------------------- 0.027354717254638672
generate_one_block  0.025855064392089844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002048492431640625
gen group dst list time:  0.0002968311309814453
time for parepare:  0.0014469623565673828
local_output_nid generation:  0.0010714530944824219
local_in_edges_tensor generation:  0.0022683143615722656
mini_batch_src_global generation:  0.0020051002502441406
r_  generation:  0.024143695831298828
----------------------check_connections_block total spend ----------------------------- 0.03716540336608887
generate_one_block  0.03550362586975098
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 0.08071565628051758  GigaBytes
Max Memory Allocated: 3.044403076171875  GigaBytes

connection checking time:  0.07737302780151367
block generation total time  0.07583379745483398
average batch blocks generation time:  0.07583379745483398
block dataloader generation time/epoch 0.18298697471618652Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3572998046875 GB
    Memory Allocated: 0.07822990417480469  GigaBytes
Max Memory Allocated: 3.044403076171875  GigaBytes

torch.Size([18665, 500])
torch.Size([16256, 128])
torch.Size([8156, 128])
torch.Size([2581, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4276123046875 GB
    Memory Allocated: 3.083240032196045  GigaBytes
Max Memory Allocated: 3.0834555625915527  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013405323028564453 |0.0015354156494140625 |0.3177797794342041 |0.00014591217041015625 |0.44828343391418457 |0.008872032165527344 |
----------------------------------------------------------pseudo_mini_loss sum 1.6983284950256348
Total (block generation + training)time/epoch 0.9788789749145508
Training time/epoch 0.7954261302947998
Training time without block to device /epoch 0.7938907146453857
Training time without total dataloading part /epoch 0.7750811576843262
load block tensor time/epoch 0.013405323028564453
block to device time/epoch 0.0015354156494140625
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.1920928955078125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  46012
Number of first layer input nodes during this epoch:  18665
