main start at this time 1648532831.0958307
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008303642272949219  GigaBytes
Max Memory Allocated: 0.008303642272949219  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0018661022186279297
range selection method range initialization spend 9.036064147949219e-05
time for parepare:  5.936622619628906e-05
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00030231475830078125
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0016155242919921875
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  7.414817810058594e-05
----------------------check_connections_block total spend ----------------------------- 0.0024900436401367188
generate_one_block  0.0016474723815917969
generate_one_block  0.0013704299926757812
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001294851303100586
gen group dst list time:  3.123283386230469e-05
time for parepare:  0.0003154277801513672
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  8.845329284667969e-05
r_  generation:  0.0006864070892333984
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  0.00012183189392089844
r_  generation:  0.0008368492126464844
----------------------check_connections_block total spend ----------------------------- 0.0029268264770507812
generate_one_block  0.0022220611572265625
generate_one_block  0.0023605823516845703
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013055801391601562
gen group dst list time:  8.058547973632812e-05
time for parepare:  0.0009465217590332031
local_output_nid generation:  0.00011873245239257812
local_in_edges_tensor generation:  0.0004317760467529297
mini_batch_src_global generation:  0.0004038810729980469
r_  generation:  0.004263639450073242
local_output_nid generation:  0.0001506805419921875
local_in_edges_tensor generation:  0.00038552284240722656
mini_batch_src_global generation:  0.0007050037384033203
r_  generation:  0.005508899688720703
----------------------check_connections_block total spend ----------------------------- 0.015650510787963867
generate_one_block  0.005635261535644531
generate_one_block  0.0068132877349853516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020766258239746094
gen group dst list time:  0.0002658367156982422
time for parepare:  0.0017991065979003906
local_output_nid generation:  0.0004627704620361328
local_in_edges_tensor generation:  0.0010921955108642578
mini_batch_src_global generation:  0.001558065414428711
r_  generation:  0.013240575790405273
local_output_nid generation:  0.0004391670227050781
local_in_edges_tensor generation:  0.0009367465972900391
mini_batch_src_global generation:  0.0016787052154541016
r_  generation:  0.015409469604492188
----------------------check_connections_block total spend ----------------------------- 0.04420208930969238
generate_one_block  0.017014265060424805
generate_one_block  0.0213165283203125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001798391342163086
gen group dst list time:  0.0005362033843994141
time for parepare:  0.0016901493072509766
local_output_nid generation:  0.0009913444519042969
local_in_edges_tensor generation:  0.001901865005493164
mini_batch_src_global generation:  0.0019299983978271484
r_  generation:  0.022435426712036133
local_output_nid generation:  0.001245737075805664
local_in_edges_tensor generation:  0.0019981861114501953
mini_batch_src_global generation:  0.002327442169189453
r_  generation:  0.023658275604248047
----------------------check_connections_block total spend ----------------------------- 0.06859016418457031
generate_one_block  0.027438640594482422
generate_one_block  0.031000137329101562
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008303642272949219  GigaBytes
Max Memory Allocated: 0.008303642272949219  GigaBytes

connection checking time:  0.13136959075927734
block generation total time  0.1138007640838623
average batch blocks generation time:  0.05690038204193115
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1346435546875 GB
    Memory Allocated: 0.042470455169677734  GigaBytes
Max Memory Allocated: 0.042470455169677734  GigaBytes

torch.Size([17761, 500])
torch.Size([13199, 64])
torch.Size([5125, 64])
torch.Size([1240, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7889404296875 GB
    Memory Allocated: 2.3816370964050293  GigaBytes
Max Memory Allocated: 2.3817005157470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 0.05102396011352539  GigaBytes
Max Memory Allocated: 2.3818359375  GigaBytes

torch.Size([17803, 500])
torch.Size([14560, 64])
torch.Size([5660, 64])
torch.Size([1526, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9705810546875 GB
    Memory Allocated: 2.497553825378418  GigaBytes
Max Memory Allocated: 2.4976158142089844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018436789512634277 |0.17126083374023438 |0.5622848272323608 |0.00019097328186035156 |0.3766862154006958 |0.010268449783325195 |
----------------------------------------------------------pseudo_mini_loss sum 1.6674842834472656
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  77229
Number of first layer input nodes during this epoch:  35564
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9705810546875 GB
    Memory Allocated: 0.07010126113891602  GigaBytes
Max Memory Allocated: 2.4977521896362305  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005855560302734375
range selection method range initialization spend 6.29425048828125e-05
time for parepare:  6.222724914550781e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  6.246566772460938e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  8.7738037109375e-05
----------------------check_connections_block total spend ----------------------------- 0.0007648468017578125
generate_one_block  0.0012052059173583984
generate_one_block  0.0012331008911132812
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005512237548828125
gen group dst list time:  3.0994415283203125e-05
time for parepare:  0.0003066062927246094
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0003981590270996094
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation: Using backend: pytorch
 0.00010943412780761719
r_  generation:  0.0008971691131591797
----------------------check_connections_block total spend ----------------------------- 0.0026683807373046875
generate_one_block  0.001734018325805664
generate_one_block  0.0023987293243408203
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010113716125488281
gen group dst list time:  7.796287536621094e-05
time for parepare:  0.00075531005859375
local_output_nid generation:  0.00010418891906738281
local_in_edges_tensor generation:  0.0003483295440673828
mini_batch_src_global generation:  0.0003180503845214844
r_  generation:  0.0027730464935302734
local_output_nid generation:  0.00017833709716796875
local_in_edges_tensor generation:  0.0003504753112792969
mini_batch_src_global generation:  0.0005950927734375
r_  generation:  0.005252361297607422
----------------------check_connections_block total spend ----------------------------- 0.012744903564453125
generate_one_block  0.006371736526489258
generate_one_block  0.0075571537017822266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002076864242553711
gen group dst list time:  0.00019025802612304688
time for parepare:  0.0013599395751953125
local_output_nid generation:  0.0003407001495361328
local_in_edges_tensor generation:  0.001003265380859375
mini_batch_src_global generation:  0.0011379718780517578
r_  generation:  0.012336254119873047
local_output_nid generation:  0.00044989585876464844
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.0016052722930908203
r_  generation:  0.014994144439697266
----------------------check_connections_block total spend ----------------------------- 0.040987253189086914
generate_one_block  0.018207311630249023
generate_one_block  0.02244853973388672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017879009246826172
gen group dst list time:  0.0005373954772949219
time for parepare:  0.0015072822570800781
local_output_nid generation:  0.0009450912475585938
local_in_edges_tensor generation:  0.0019347667694091797
mini_batch_src_global generation:  0.0018765926361083984
r_  generation:  0.02206897735595703
local_output_nid generation:  0.0012001991271972656
local_in_edges_tensor generation:  0.0023424625396728516
mini_batch_src_global generation:  0.0025949478149414062
r_  generation:  0.023459672927856445
----------------------check_connections_block total spend ----------------------------- 0.068389892578125
generate_one_block  0.03016042709350586
generate_one_block  0.03176116943359375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9705810546875 GB
    Memory Allocated: 0.07010126113891602  GigaBytes
Max Memory Allocated: 2.4977521896362305  GigaBytes

connection checking time:  0.12479043006896973
block generation total time  0.12063908576965332
average batch blocks generation time:  0.06031954288482666
block dataloader generation time/epoch 0.3336210250854492
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9705810546875 GB
    Memory Allocated: 0.06821584701538086  GigaBytes
Max Memory Allocated: 2.4977521896362305  GigaBytes

torch.Size([17414, 500])
torch.Size([12748, 64])
torch.Size([4608, 64])
torch.Size([934, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9705810546875 GB
    Memory Allocated: 2.3471646308898926  GigaBytes
Max Memory Allocated: 2.4977521896362305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9705810546875 GB
    Memory Allocated: 0.06840372085571289  GigaBytes
Max Memory Allocated: 2.4977521896362305  GigaBytes

torch.Size([17837, 500])
torch.Size([14792, 64])
torch.Size([5822, 64])
torch.Size([1795, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1151123046875 GB
    Memory Allocated: 2.5368595123291016  GigaBytes
Max Memory Allocated: 2.5369391441345215  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017814278602600098 |0.0021570920944213867 |0.3106193542480469 |0.00015294551849365234 |0.390444278717041 |0.009494781494140625 |
----------------------------------------------------------pseudo_mini_loss sum 1.6568036079406738
Total (block generation + training)time/epoch 1.7947938442230225
Training time/epoch 1.46065354347229
Training time without block to device /epoch 1.4563393592834473
Training time without total dataloading part /epoch 1.4119279384613037
load block tensor time/epoch 0.035628557205200195
block to device time/epoch 0.0043141841888427734
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  76306
Number of first layer input nodes during this epoch:  35251
