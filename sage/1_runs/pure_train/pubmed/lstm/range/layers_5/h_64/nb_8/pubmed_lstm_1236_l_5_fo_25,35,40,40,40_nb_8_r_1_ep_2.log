main start at this time 1648532844.6842768
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008303642272949219  GigaBytes
Max Memory Allocated: 0.008303642272949219  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.003095388412475586
range selection method range initialization spend 9.5367431640625e-05
time for parepare:  4.2438507080078125e-05
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0025484561920166016
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.100799560546875e-05
----------------------check_connections_block total spend ----------------------------- 0.0036077499389648438
generate_one_block  0.0012617111206054688
generate_one_block  0.0010368824005126953
generate_one_block  0.0010256767272949219
generate_one_block  0.0010421276092529297
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0014927387237548828
gen group dst list time:  3.24249267578125e-05
time for parepare:  0.0002334117889404297
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0004138946533203125
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0001888275146484375
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00030541419982910156
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0004248619079589844
----------------------check_connections_block total spend ----------------------------- 0.0027725696563720703
generate_one_block  0.0015289783477783203
generate_one_block  0.0012853145599365234
generate_one_block  0.001409769058227539
generate_one_block  0.0015037059783935547
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010502338409423828
gen group dst list time:  7.081031799316406e-05
time for parepare:  0.0007703304290771484
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.0003268718719482422
mini_batch_src_global generation:  0.00019741058349609375
r_  generation:  0.002382040023803711
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  0.0001823902130126953
r_  generation:  0.001255035400390625
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  0.00018644332885742188
r_  generation:  0.002014636993408203
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.0002319812774658203
mini_batch_src_global generation:  0.0002963542938232422
r_  generation:  0.002844572067260742
----------------------check_connections_block total spend ----------------------------- 0.013513803482055664
generate_one_block  0.004873991012573242
generate_one_block  0.0026700496673583984
generate_one_block  0.0034677982330322266
generate_one_block  0.004559755325317383
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021953582763671875
gen group dst list time:  0.00023984909057617188
time for parepare:  0.0015017986297607422
local_output_nid generation:  0.00024008750915527344
local_in_edges_tensor generation:  0.0008444786071777344
mini_batch_src_global generation:  0.0009739398956298828
r_  generation:  0.009264945983886719
local_output_nid generation:  0.00020074844360351562
local_in_edges_tensor generation:  0.0004868507385253906
mini_batch_src_global generation:  0.0009975433349609375
r_  generation:  0.007063627243041992
local_output_nid generation:  0.0002655982971191406
local_in_edges_tensor generation:  0.0011115074157714844
mini_batch_src_global generation:  0.0010378360748291016
r_  generation:  0.009844064712524414
local_output_nid generation:  0.00035071372985839844
local_in_edges_tensor generation:  0.0006406307220458984
mini_batch_src_global generation:  0.0009417533874511719
r_  generation:  0.010793685913085938
----------------------check_connections_block total spend ----------------------------- 0.055774688720703125
generate_one_block  0.013148784637451172
generate_one_block  0.010963916778564453
generate_one_block  0.014322519302368164
generate_one_block  0.015294313430786133
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017671585083007812
gen group dst list time:  0.0007979869842529297
time for parepare:  0.0017955303192138672
local_output_nid generation:  0.0007736682891845703
local_in_edges_tensor generation:  0.0017108917236328125
mini_batch_src_global generation:  0.001779794692993164
r_  generation:  0.01850128173828125
local_output_nid generation:  0.0008203983306884766
local_in_edges_tensor generation:  0.001621246337890625
mini_batch_src_global generation:  0.0021209716796875
r_  generation:  0.01756906509399414
local_output_nid generation:  0.001039743423461914
local_in_edges_tensor generation:  0.0018024444580078125
mini_batch_src_global generation:  0.0016326904296875
r_  generation:  0.02023029327392578
local_output_nid generation:  0.0010404586791992188
local_in_edges_tensor generation:  0.001691579818725586
mini_batch_src_global generation:  0.001971721649169922
r_  generation:  0.020064115524291992
----------------------check_connections_block total spend ----------------------------- 0.11376214027404785
generate_one_block  0.024077653884887695
generate_one_block  0.023776531219482422
generate_one_block  0.027088642120361328
generate_one_block  0.027042865753173828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008303642272949219  GigaBytes
Max Memory Allocated: 0.008303642272949219  GigaBytes

connection checking time:  0.1858232021331787
block generation total time  0.17701458930969238
average batch blocks generation time:  0.044253647327423096
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1326904296875 GB
    Memory Allocated: 0.038908958435058594  GigaBytes
Max Memory Allocated: 0.038908958435058594  GigaBytes

torch.Size([16014, 500])
torch.Size([10264, 64])
torch.Size([3473, 64])
torch.Size([830, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3924560546875 GB
    Memory Allocated: 2.026052474975586  GigaBytes
Max Memory Allocated: 2.026094913482666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3924560546875 GB
    Memory Allocated: 0.0462794303894043  GigaBytes
Max Memory Allocated: 2.0262656211853027  GigaBytes

torch.Size([15573, 500])
torch.Size([9225, 64])
torch.Size([2475, 64])
torch.Size([437, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 1.8983664512634277  GigaBytes
Max Memory Allocated: 2.0262656211853027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5037841796875 GB
    Memory Allocated: 0.04866504669189453  GigaBytes
Max Memory Allocated: 2.0262656211853027  GigaBytes

torch.Size([16380, 500])
torch.Size([11822, 64])
torch.Size([3211, 64])
torch.Size([763, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 2.1667609214782715  GigaBytes
Max Memory Allocated: 2.166790008544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.04843425750732422  GigaBytes
Max Memory Allocated: 2.1669845581054688  GigaBytes

torch.Size([16628, 500])
torch.Size([11465, 64])
torch.Size([3809, 64])
torch.Size([851, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6795654296875 GB
    Memory Allocated: 2.1824378967285156  GigaBytes
Max Memory Allocated: 2.1824803352355957  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015269875526428223 |0.08638989925384521 |0.40942221879959106 |0.00025457143783569336 |0.35320812463760376 |0.01128697395324707 |
----------------------------------------------------------pseudo_mini_loss sum 1.545829176902771
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  123577
Number of first layer input nodes during this epoch:  64595
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.6795654296875 GB
    Memory Allocated: 0.06637859344482422  GigaBytes
Max Memory Allocated: 2.182651996612549  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005497932434082031
range selection method range initialization spend 5.3882598876953125e-05
time for parepare:  6.175041198730469e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.887580871582031e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.14984130859375e-05
----------------------check_connections_block total spend ----------------------------- 0.0011057853698730469
generate_one_block  0.0011677742004394531
generate_one_block  0.0011110305786132812
generate_one_block  0.0011339187622070312
generate_one_block  0.0011029243469238281
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005505084991455078
gen group dst list time:  3.361701965332031e-05
time for parepare:  0.00029587745666503906
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.001302480697631836
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0002079010009765625
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0002243518829345703
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  9.1552734375e-05
r_  generation:  0.0005838871002197266
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0003654956817626953
----------------------check_connections_block total spend ----------------------------- 0.004233121871948242
generate_one_block  0.0016033649444580078
generate_one_block  0.001451253890991211
generate_one_block  0.002050638198852539
generate_one_block  0.0015218257904052734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010421276092529297
gen group dst list time:  9.489059448242188e-05
time for parepare:  0.0007634162902832031
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.0002779960632324219
mini_batch_src_global generation:  0.0001430511474609375
r_  generation:  0.001186370849609375
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  0.0001995563507080078
r_  generation:  0.0017447471618652344
local_output_nid generation:  0.0001246929168701172
local_in_edges_tensor generation:  0.0002830028533935547
mini_batch_src_global generation:  0.0003643035888671875
r_  generation:  0.003644704818725586
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.0002319812774658203
r_  generation:  0.0019383430480957031
----------------------check_connections_block total spend ----------------------------- 0.013683319091796875
generate_one_block  0.0032558441162109375
generate_one_block  0.0034723281860351562
generate_one_block  0.0059814453125
generate_one_block  0.0035674571990966797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021080970764160156
gen group dst list time:  0.0002415180206298828
time for parepare:  0.0013606548309326172
local_output_nid generation:  0.00025177001953125
local_in_edges_tensor generation:  0.0007283687591552734
mini_batch_src_global generation:  0.000644683837890625
r_  generation:  0.0071642398834228516
local_output_nid generation:  0.00028824806213378906
local_in_edges_tensor generation:  0.0006000995635986328
mini_batch_src_global generation:  0.0010895729064941406
r_  generation:  0.008759737014770508
local_output_nid generation:  0.0003628730773925781
local_in_edges_tensor generation:  0.0006821155548095703
mini_batch_src_global generation:  0.0012350082397460938
r_  generation:  0.012197494506835938
local_output_nid generation:  0.0003132820129394531
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.000980377197265625
r_  generation:  0.008196830749511719
----------------------check_connections_block total spend ----------------------------- 0.05436348915100098
generate_one_block  0.015238285064697266
generate_one_block  0.025179147720336914
generate_one_block  0.018705129623413086
generate_one_block  0.013179540634155273
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.003017425537109375
gen group dst list time:  0.0008606910705566406
time for parepare:  0.002601146697998047
local_output_nid generation:  0.0019571781158447266
local_in_edges_tensor generation:  0.002424478530883789
mini_batch_src_global generation:  0.0016071796417236328
r_  generation:  0.017305612564086914
local_output_nid generation:  0.0009636878967285156
local_in_edges_tensor generation:  0.002012014389038086
mini_batch_src_global generation:  0.0022821426391601562
r_  generation:  0.021450042724609375
local_output_nid generation:  0.0016126632690429688
local_in_edges_tensor generation:  0.0023818016052246094
mini_batch_src_global generation:  0.002170562744140625
r_  generation:  0.0232088565826416
local_output_nid generation:  0.0012276172637939453
local_in_edges_tensor generation:  0.0015211105346679688
mini_batch_src_global generation:  0.0018343925476074219
r_  generation: Using backend: pytorch
 0.019611358642578125
----------------------check_connections_block total spend ----------------------------- 0.127732515335083
generate_one_block  0.027779102325439453
generate_one_block  0.02882838249206543
generate_one_block  0.02952098846435547
generate_one_block  0.02732992172241211
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.6795654296875 GB
    Memory Allocated: 0.06637859344482422  GigaBytes
Max Memory Allocated: 2.182651996612549  GigaBytes

connection checking time:  0.2000124454498291
block generation total time  0.2086646556854248
average batch blocks generation time:  0.0521661639213562
block dataloader generation time/epoch 0.48319554328918457
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6795654296875 GB
    Memory Allocated: 0.06200075149536133  GigaBytes
Max Memory Allocated: 2.182651996612549  GigaBytes

torch.Size([15118, 500])
torch.Size([8817, 64])
torch.Size([2322, 64])
torch.Size([423, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6795654296875 GB
    Memory Allocated: 1.8475828170776367  GigaBytes
Max Memory Allocated: 2.182651996612549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6795654296875 GB
    Memory Allocated: 0.0642094612121582  GigaBytes
Max Memory Allocated: 2.182651996612549  GigaBytes

torch.Size([16251, 500])
torch.Size([10044, 64])
torch.Size([3089, 64])
torch.Size([528, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6795654296875 GB
    Memory Allocated: 2.0391759872436523  GigaBytes
Max Memory Allocated: 2.182651996612549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6795654296875 GB
    Memory Allocated: 0.06569862365722656  GigaBytes
Max Memory Allocated: 2.182651996612549  GigaBytes

torch.Size([16946, 500])
torch.Size([12858, 64])
torch.Size([4122, 64])
torch.Size([1183, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8260498046875 GB
    Memory Allocated: 2.3256287574768066  GigaBytes
Max Memory Allocated: 2.325688362121582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8260498046875 GB
    Memory Allocated: 0.06518936157226562  GigaBytes
Max Memory Allocated: 2.3258414268493652  GigaBytes

torch.Size([16335, 500])
torch.Size([10705, 64])
torch.Size([2983, 64])
torch.Size([682, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8260498046875 GB
    Memory Allocated: 2.0843253135681152  GigaBytes
Max Memory Allocated: 2.3258414268493652  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01572418212890625 |0.002978801727294922 |0.2660568356513977 |0.0001423954963684082 |0.3522961735725403 |0.010468006134033203 |
----------------------------------------------------------pseudo_mini_loss sum 1.5672086477279663
Total (block generation + training)time/epoch 3.058844566345215
Training time/epoch 2.5752437114715576
Training time without block to device /epoch 2.563328504562378
Training time without total dataloading part /epoch 2.484449625015259
load block tensor time/epoch 0.062896728515625
block to device time/epoch 0.011915206909179688
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  122763
Number of first layer input nodes during this epoch:  64650
