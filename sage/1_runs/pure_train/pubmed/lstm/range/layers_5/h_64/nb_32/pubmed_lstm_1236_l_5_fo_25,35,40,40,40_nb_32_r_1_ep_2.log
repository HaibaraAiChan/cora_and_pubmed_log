main start at this time 1648532882.1206727
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008303642272949219  GigaBytes
Max Memory Allocated: 0.008303642272949219  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.002782106399536133
range selection method range initialization spend 8.416175842285156e-05
time for parepare:  4.57763671875e-05
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0011415481567382812
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.5497207641601562e-05
----------------------check_connections_block total spend ----------------------------- 0.003871440887451172
generate_one_block  0.0011754035949707031
generate_one_block  0.0010466575622558594
generate_one_block  0.0010061264038085938
generate_one_block  0.0009868144989013672
generate_one_block  0.001024007797241211
generate_one_block  0.0010030269622802734
generate_one_block  0.0009942054748535156
generate_one_block  0.0010104179382324219
generate_one_block  0.0009927749633789062
generate_one_block  0.0010242462158203125
generate_one_block  0.0009877681732177734
generate_one_block  0.0009875297546386719
generate_one_block  0.0010137557983398438
generate_one_block  0.0009739398956298828
generate_one_block  0.0009329319000244141
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001692056655883789
gen group dst list time:  7.843971252441406e-05
time for parepare:  0.0002689361572265625
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00028443336486816406
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  8.654594421386719e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.57763671875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  6.4849853515625e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  9.298324584960938e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00014925003051757812
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.4849853515625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00023937225341796875
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  9.1552734375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.559226989746094e-05
----------------------check_connections_block total spend ----------------------------- 0.004477500915527344
generate_one_block  0.001041412353515625
generate_one_block  0.0013535022735595703
generate_one_block  0.0011026859283447266
generate_one_block  0.0010955333709716797
generate_one_block  0.001043558120727539
generate_one_block  0.0010480880737304688
generate_one_block  0.001043081283569336
generate_one_block  0.0011265277862548828
generate_one_block  0.0010707378387451172
generate_one_block  0.001210927963256836
generate_one_block  0.0010082721710205078
generate_one_block  0.001027822494506836
generate_one_block  0.001237630844116211
generate_one_block  0.0010349750518798828
generate_one_block  0.0010290145874023438
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001178741455078125
gen group dst list time:  0.00012040138244628906
time for parepare:  0.000766754150390625
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00026869773864746094
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00012755393981933594
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.00016808509826660156
r_  generation:  0.0019114017486572266
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0003390312194824219
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.0002319812774658203
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00031638145446777344
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00016880035400390625
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0002009868621826172
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0008265972137451172
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.00036716461181640625
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0009751319885253906
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0003376007080078125
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0003979206085205078
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  0.00015616416931152344
r_  generation:  0.0016820430755615234
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  0.00010919570922851562
r_  generation:  0.0006582736968994141
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0005102157592773438
----------------------check_connections_block total spend ----------------------------- 0.016164302825927734
generate_one_block  0.0013320446014404297
generate_one_block  0.003451824188232422
generate_one_block  0.0013821125030517578
generate_one_block  0.0012559890747070312
generate_one_block  0.0013589859008789062
generate_one_block  0.0011608600616455078
generate_one_block  0.0012087821960449219
generate_one_block  0.002034425735473633
generate_one_block  0.0014107227325439453
generate_one_block  0.002099752426147461
generate_one_block  0.0016639232635498047
generate_one_block  0.0014576911926269531
generate_one_block  0.0030345916748046875
generate_one_block  0.001744985580444336
generate_one_block  0.0015196800231933594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020682811737060547
gen group dst list time:  0.0003032684326171875
time for parepare:  0.001684427261352539
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0004329681396484375
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0006902217864990234
local_output_nid generation:  0.00019693374633789062
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.0009584426879882812
r_  generation:  0.00778961181640625
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  0.00028014183044433594
r_  generation:  0.0012068748474121094
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.0001533031463623047
r_  generation:  0.0015606880187988281
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  0.0001773834228515625
r_  generation:  0.0017745494842529297
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  0.0001361370086669922
r_  generation:  0.0009996891021728516
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  0.00012540817260742188
r_  generation:  0.001207113265991211
local_output_nid generation:  0.00014972686767578125
local_in_edges_tensor generation:  0.0003528594970703125
mini_batch_src_global generation:  0.0004451274871826172
r_  generation:  0.005278348922729492
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  0.00035119056701660156
r_  generation:  0.0024085044860839844
local_output_nid generation:  0.00013446807861328125
local_in_edges_tensor generation:  0.00033354759216308594
mini_batch_src_global generation:  0.0004696846008300781
r_  generation:  0.005082368850708008
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  0.0002856254577636719
r_  generation:  0.0019059181213378906
local_output_nid generation:  7.152557373046875e-05
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  0.00026226043701171875
r_  generation:  0.002628803253173828
local_output_nid generation:  0.0001652240753173828
local_in_edges_tensor generation:  0.0003719329833984375
mini_batch_src_global generation:  0.0005564689636230469
r_  generation:  0.0062253475189208984
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.0003085136413574219
mini_batch_src_global generation:  0.0004961490631103516
r_  generation:  0.00433349609375
local_output_nid generation:  7.534027099609375e-05
local_in_edges_tensor generation:  0.0002276897430419922
mini_batch_src_global generation:  0.0003294944763183594
r_  generation:  0.0028181076049804688
----------------------check_connections_block total spend ----------------------------- 0.0700380802154541
generate_one_block  0.002111196517944336
generate_one_block  0.01095438003540039
generate_one_block  0.002293109893798828
generate_one_block  0.002885103225708008
generate_one_block  0.0035054683685302734
generate_one_block  0.0022547245025634766
generate_one_block  0.0026166439056396484
generate_one_block  0.008125066757202148
generate_one_block  0.004059553146362305
generate_one_block  0.008124113082885742
generate_one_block  0.003434896469116211
generate_one_block  0.0044803619384765625
generate_one_block  0.009247064590454102
generate_one_block  0.006544589996337891
generate_one_block  0.004724740982055664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022134780883789062
gen group dst list time:  0.0015704631805419922
time for parepare:  0.0017902851104736328
local_output_nid generation:  0.00015211105346679688
local_in_edges_tensor generation:  0.0008056163787841797
mini_batch_src_global generation:  0.0004918575286865234
r_  generation:  0.004093647003173828
local_output_nid generation:  0.0006997585296630859
local_in_edges_tensor generation:  0.0012350082397460938
mini_batch_src_global generation:  0.0016655921936035156
r_  generation:  0.016498804092407227
local_output_nid generation:  0.0001761913299560547
local_in_edges_tensor generation:  0.0003681182861328125
mini_batch_src_global generation:  0.0005857944488525391
r_  generation:  0.0040471553802490234
local_output_nid generation:  0.00025963783264160156
local_in_edges_tensor generation:  0.0005104541778564453
mini_batch_src_global generation:  0.0005860328674316406
r_  generation:  0.00664520263671875
local_output_nid generation:  0.0002875328063964844
local_in_edges_tensor generation:  0.0005228519439697266
mini_batch_src_global generation:  0.0006849765777587891
r_  generation:  0.007277727127075195
local_output_nid generation:  0.0002231597900390625
local_in_edges_tensor generation:  0.00042700767517089844
mini_batch_src_global generation:  0.0005295276641845703
r_  generation:  0.005117893218994141
local_output_nid generation:  0.0002257823944091797
local_in_edges_tensor generation:  0.0004265308380126953
mini_batch_src_global generation:  0.0005002021789550781
r_  generation:  0.0050296783447265625
local_output_nid generation:  0.000583648681640625
local_in_edges_tensor generation:  0.0009860992431640625
mini_batch_src_global generation:  0.0013184547424316406
r_  generation:  0.015758752822875977
local_output_nid generation:  0.000324249267578125
local_in_edges_tensor generation:  0.0005600452423095703
mini_batch_src_global generation:  0.001010894775390625
r_  generation:  0.008063077926635742
local_output_nid generation:  0.0007228851318359375
local_in_edges_tensor generation:  0.001087188720703125
mini_batch_src_global generation:  0.0011849403381347656
r_  generation:  0.015114784240722656
local_output_nid generation:  0.00034356117248535156
local_in_edges_tensor generation:  0.0005714893341064453
mini_batch_src_global generation:  0.0008473396301269531
r_  generation:  0.007112741470336914
local_output_nid generation:  0.00034737586975097656
local_in_edges_tensor generation:  0.000591278076171875
mini_batch_src_global generation:  0.00080108642578125
r_  generation:  0.008829355239868164
local_output_nid generation:  0.0005407333374023438
local_in_edges_tensor generation:  0.0010347366333007812
mini_batch_src_global generation:  0.001232147216796875
r_  generation:  0.014427900314331055
local_output_nid generation:  0.0005085468292236328
local_in_edges_tensor generation:  0.0012416839599609375
mini_batch_src_global generation:  0.0011887550354003906
r_  generation:  0.013537168502807617
local_output_nid generation:  0.0004363059997558594
local_in_edges_tensor generation:  0.0006630420684814453
mini_batch_src_global generation:  0.0010080337524414062
r_  generation:  0.010451316833496094
----------------------check_connections_block total spend ----------------------------- 0.20930719375610352
generate_one_block  0.007344484329223633
generate_one_block  0.021332502365112305
generate_one_block  0.007511615753173828
generate_one_block  0.010392189025878906
generate_one_block  0.010745525360107422
generate_one_block  0.007251262664794922
generate_one_block  0.007379293441772461
generate_one_block  0.021016359329223633
generate_one_block  0.01271963119506836
generate_one_block  0.018631696701049805
generate_one_block  0.010350465774536133
generate_one_block  0.012814521789550781
generate_one_block  0.018104076385498047
generate_one_block  0.01835799217224121
generate_one_block  0.014253854751586914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008303642272949219  GigaBytes
Max Memory Allocated: 0.008303642272949219  GigaBytes

connection checking time:  0.2999870777130127
block generation total time  0.31615662574768066
average batch blocks generation time:  0.02107710838317871
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.020511150360107422  GigaBytes
Max Memory Allocated: 0.020511150360107422  GigaBytes

torch.Size([6123, 500])
torch.Size([1497, 64])
torch.Size([243, 64])
torch.Size([48, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.4363737106323242  GigaBytes
Max Memory Allocated: 0.4572587013244629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.04462146759033203  GigaBytes
Max Memory Allocated: 0.4572587013244629  GigaBytes

torch.Size([14494, 500])
torch.Size([8540, 64])
torch.Size([2715, 64])
torch.Size([586, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.7848625183105469  GigaBytes
Max Memory Allocated: 1.7848906517028809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1502685546875 GB
    Memory Allocated: 0.0284576416015625  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([5984, 500])
torch.Size([1936, 64])
torch.Size([473, 64])
torch.Size([129, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1502685546875 GB
    Memory Allocated: 0.4380331039428711  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1502685546875 GB
    Memory Allocated: 0.03192472457885742  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([8102, 500])
torch.Size([2796, 64])
torch.Size([427, 64])
torch.Size([90, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1502685546875 GB
    Memory Allocated: 0.7652692794799805  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1502685546875 GB
    Memory Allocated: 0.032427310943603516  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([8357, 500])
torch.Size([3099, 64])
torch.Size([528, 64])
torch.Size([106, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1502685546875 GB
    Memory Allocated: 0.8310794830322266  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1502685546875 GB
    Memory Allocated: 0.02884674072265625  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([6401, 500])
torch.Size([2467, 64])
torch.Size([303, 64])
torch.Size([92, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1502685546875 GB
    Memory Allocated: 0.5578985214233398  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1502685546875 GB
    Memory Allocated: 0.029910564422607422  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([7053, 500])
torch.Size([2614, 64])
torch.Size([420, 64])
torch.Size([97, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1502685546875 GB
    Memory Allocated: 0.565788745880127  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1502685546875 GB
    Memory Allocated: 0.044513702392578125  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([14488, 500])
torch.Size([7149, 64])
torch.Size([1856, 64])
torch.Size([206, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1502685546875 GB
    Memory Allocated: 1.6736578941345215  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1502685546875 GB
    Memory Allocated: 0.032772064208984375  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([8520, 500])
torch.Size([3327, 64])
torch.Size([647, 64])
torch.Size([116, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1502685546875 GB
    Memory Allocated: 0.9217052459716797  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1502685546875 GB
    Memory Allocated: 0.04267263412475586  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([13712, 500])
torch.Size([8426, 64])
torch.Size([1640, 64])
torch.Size([396, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 1.546459674835205  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.03296327590942383  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([8655, 500])
torch.Size([3801, 64])
torch.Size([514, 64])
torch.Size([150, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7648353576660156  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.03330421447753906  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([8791, 500])
torch.Size([3960, 64])
torch.Size([751, 64])
torch.Size([97, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 1.0124716758728027  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.0409693717956543  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([12771, 500])
torch.Size([6847, 64])
torch.Size([2043, 64])
torch.Size([458, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1912841796875 GB
    Memory Allocated: 1.5367026329040527  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1912841796875 GB
    Memory Allocated: 0.03983163833618164  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([12218, 500])
torch.Size([5869, 64])
torch.Size([1463, 64])
torch.Size([172, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.4279980659484863  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.03525257110595703  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([9821, 500])
torch.Size([4726, 64])
torch.Size([818, 64])
torch.Size([187, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.1165986061096191  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008105659484863281 |0.023781760533650716 |0.23177417119344076 |0.00013551712036132812 |0.26081703503926595 |0.012825727462768555 |
----------------------------------------------------------pseudo_mini_loss sum 1.4867117404937744
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  230672
Number of first layer input nodes during this epoch:  145490
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.05288267135620117  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009102821350097656
range selection method range initialization spend 6.365776062011719e-05
time for parepare:  7.724761962890625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.079673767089844e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.1920928955078125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  2.9087066650390625e-05
----------------------check_connections_block total spend ----------------------------- 0.003100156784057617
generate_one_block  0.0017659664154052734
generate_one_block  0.001171112060546875
generate_one_block  0.0010554790496826172
generate_one_block  0.0010445117950439453
generate_one_block  0.0010488033294677734
generate_one_block  0.0010547637939453125
generate_one_block  0.0011749267578125
generate_one_block  0.0010530948638916016
generate_one_block  0.0010569095611572266
generate_one_block  0.0010600090026855469
generate_one_block  0.001058340072631836
generate_one_block  0.0010328292846679688
generate_one_block  0.001020193099975586
generate_one_block  0.0010712146759033203
generate_one_block  0.0010039806365966797
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0008540153503417969
gen group dst list time:  8.58306884765625e-05
time for parepare:  0.00033593177795410156
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00011610984802246094
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  5.9604644775390625e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  9.584426879882812e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00011038780212402344
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00022220611572265625
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00016355514526367188
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00020623207092285156
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.000194549560546875
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00011658668518066406
----------------------check_connections_block total spend ----------------------------- 0.0050961971282958984
generate_one_block  0.0012960433959960938
generate_one_block  0.0011093616485595703
generate_one_block  0.001138448715209961
generate_one_block  0.001155853271484375
generate_one_block  0.0011391639709472656
generate_one_block  0.0011849403381347656
generate_one_block  0.0011219978332519531
generate_one_block  0.0012204647064208984
generate_one_block  0.0012583732604980469
generate_one_block  0.0012814998626708984
generate_one_block  0.0012352466583251953
generate_one_block  0.0009984970092773438
generate_one_block  0.0010786056518554688
generate_one_block  0.0012271404266357422
generate_one_block  0.0011043548583984375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012924671173095703
gen group dst list time:  0.00014138221740722656
time for parepare:  0.0010383129119873047
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0003368854522705078
mini_batch_src_global generation:  0.00011682510375976562
r_  generation:  0.0006830692291259766
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0002315044403076172
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0004012584686279297
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00016546249389648438
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00031375885009765625
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  9.489059448242188e-05
r_  generation:  0.0007581710815429688
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.00047087669372558594
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0006411075592041016
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.001596212387084961
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  0.0001506805419921875
r_  generation:  0.0009386539459228516
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.00016808509826660156
r_  generation:  0.0014312267303466797
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0001728534698486328
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00014281272888183594
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0011792182922363281
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  0.0001010894775390625
r_  generation:  0.0005574226379394531
----------------------check_connections_block total spend ----------------------------- 0.018429994583129883
generate_one_block  0.0022268295288085938
generate_one_block  0.001355886459350586
generate_one_block  0.0016086101531982422
generate_one_block  0.0011687278747558594
generate_one_block  0.0013668537139892578
generate_one_block  0.0020859241485595703
generate_one_block  0.0015327930450439453
generate_one_block  0.0017886161804199219
generate_one_block  0.002966642379760742
generate_one_block  0.0021059513092041016
generate_one_block  0.0028705596923828125
generate_one_block  0.0011250972747802734
generate_one_block  0.0011444091796875
generate_one_block  0.002543210983276367
generate_one_block  0.002279520034790039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019829273223876953
gen group dst list time:  0.00041747093200683594
time for parepare:  0.0016469955444335938
local_output_nid generation:  0.0001704692840576172
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.0005440711975097656
r_  generation:  0.004462718963623047
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.0002548694610595703
r_  generation:  0.0012612342834472656
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.0002837181091308594
mini_batch_src_global generation:  0.0003104209899902344
r_  generation:  0.003053903579711914
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  0.00018525123596191406
r_  generation:  0.0011360645294189453
local_output_nid generation:  6.151199340820312e-05
local_in_edges_tensor generation:  0.00023412704467773438
mini_batch_src_global generation:  0.00023508071899414062
r_  generation:  0.0024292469024658203
local_output_nid generation:  0.0001926422119140625
local_in_edges_tensor generation:  0.0003941059112548828
mini_batch_src_global generation:  0.0003952980041503906
r_  generation:  0.004177093505859375
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.00025010108947753906
mini_batch_src_global generation:  0.00032448768615722656
r_  generation:  0.0023453235626220703
local_output_nid generation:  0.00011324882507324219
local_in_edges_tensor generation:  0.0003070831298828125
mini_batch_src_global generation:  0.00034809112548828125
r_  generation:  0.003496885299682617
local_output_nid generation:  0.0001862049102783203
local_in_edges_tensor generation:  0.0004105567932128906
mini_batch_src_global generation:  0.0006763935089111328
r_  generation:  0.005882978439331055
local_output_nid generation:  0.00015354156494140625
local_in_edges_tensor generation:  0.0003523826599121094
mini_batch_src_global generation:  0.0005199909210205078
r_  generation:  0.004466056823730469
local_output_nid generation:  0.00019979476928710938
local_in_edges_tensor generation:  0.0004067420959472656
mini_batch_src_global generation:  0.0006310939788818359
r_  generation:  0.00577545166015625
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  0.0002071857452392578
r_  generation:  0.0006659030914306641
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.001010894775390625
local_output_nid generation:  0.00021529197692871094
local_in_edges_tensor generation:  0.0004258155822753906
mini_batch_src_global generation:  0.0004267692565917969
r_  generation:  0.0054094791412353516
local_output_nid generation:  0.00010347366333007812
local_in_edges_tensor generation:  0.00027561187744140625
mini_batch_src_global generation:  0.0003681182861328125
r_  generation:  0.002818584442138672
----------------------check_connections_block total spend ----------------------------- 0.07524919509887695
generate_one_block  0.007906198501586914
generate_one_block  0.0029053688049316406
generate_one_block  0.005360603332519531
generate_one_block  0.0024063587188720703
generate_one_block  0.004168033599853516
generate_one_block  0.0065844058990478516
generate_one_block  0.004222393035888672
generate_one_block  0.006166696548461914
generate_one_block  0.008822441101074219
generate_one_block  0.007641315460205078
generate_one_block  0.008955717086791992
generate_one_block  0.002142190933227539
generate_one_block  0.0023567676544189453
generate_one_block  0.008620738983154297
generate_one_block  0.004923582077026367
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0023195743560791016
gen group dst list time:  0.0016090869903564453
time for parepare:  0.0019702911376953125
local_output_nid generation:  0.00064849853515625
local_in_edges_tensor generation:  0.0018262863159179688
mini_batch_src_global generation:  0.0013806819915771484
r_  generation:  0.013013362884521484
local_output_nid generation:  0.0002923011779785156
local_in_edges_tensor generation:  0.0005476474761962891
mini_batch_src_global generation:  0.0008325576782226562
r_  generation:  0.005694866180419922
local_output_nid generation:  0.0005083084106445312
local_in_edges_tensor generation:  0.0008134841918945312
mini_batch_src_global generation:  0.000881195068359375
r_  generation:  0.009874105453491211
local_output_nid generation:  0.0002281665802001953
local_in_edges_tensor generation:  0.0004489421844482422
mini_batch_src_global generation:  0.0005972385406494141
r_  generation:  0.005223989486694336
local_output_nid generation:  0.00039267539978027344
local_in_edges_tensor generation:  0.0006265640258789062
mini_batch_src_global generation:  0.0006778240203857422
r_  generation:  0.007512807846069336
local_output_nid generation:  0.0006415843963623047
local_in_edges_tensor generation:  0.0008704662322998047
mini_batch_src_global generation:  0.0010843276977539062
r_  generation:  0.012112855911254883
local_output_nid generation:  0.0003783702850341797
local_in_edges_tensor generation:  0.0005981922149658203
mini_batch_src_global generation:  0.0008404254913330078
r_  generation:  0.007761955261230469
local_output_nid generation:  0.0007605552673339844
local_in_edges_tensor generation:  0.0009708404541015625
mini_batch_src_global generation:  0.0010805130004882812
r_  generation:  0.013033866882324219
local_output_nid generation:  0.0007233619689941406
local_in_edges_tensor generation:  0.0009708404541015625
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.013292551040649414
local_output_nid generation:  0.0009829998016357422
local_in_edges_tensor generation:  0.001079559326171875
mini_batch_src_global generation:  0.0011851787567138672
r_  generation:  0.014787435531616211
local_output_nid generation:  0.00080108642578125
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0012919902801513672
r_  generation:  0.013101816177368164
local_output_nid generation:  0.00014328956604003906
local_in_edges_tensor generation:  0.0002982616424560547
mini_batch_src_global generation:  0.0004811286926269531
r_  generation:  0.0025920867919921875
local_output_nid generation:  0.00025844573974609375
local_in_edges_tensor generation:  0.00041675567626953125
mini_batch_src_global generation:  0.0004565715789794922
r_  generation:  0.00467228889465332
local_output_nid generation:  0.0009522438049316406
local_in_edges_tensor generation:  0.0011019706726074219
mini_batch_src_global generation:  0.001280069351196289
r_  generation:  0.016651391983032227
local_output_nid generation:  0.00058746337890625
local_in_edges_tensor generation:  0.0007748603820800781
mini_batch_src_global generation:  0.0012307167053222656
r_  generation:  0.009229660034179688
----------------------check_connections_block total spend ----------------------------- 0.2226259708404541
generate_one_block  0.019079923629760742
generate_one_block  0.009711980819702148
generate_one_block  0.01417088508605957
generate_one_block  0.008211135864257812
generate_one_block  0.011584758758544922
generate_one_block  0.015992164611816406
generate_one_block  0.011917591094970703
generate_one_block  0.017597675323486328
generate_one_block  0.020083189010620117
generate_one_block  0.019798994064331055
generate_one_block  0.017685413360595703
generate_one_block  0.004626035690307617
generate_one_block  0.007904767990112305
generate_one_block  0.021805524826049805
generate_one_block  0.01412057876586914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.05288267135620117  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

connection checking time:  0.32140135765075684
block generation total time  0.34319305419921875
average batch blocks generation time:  0.022879536946614584
block dataloader generation time/epoch 0.8379268646240234
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.05703449249267578  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([12263, 500])
torch.Size([5474, 64])
torch.Size([1400, 64])
torch.Size([202, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.3899579048156738  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.04769325256347656  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([7396, 500])
torch.Size([2400, 64])
torch.Size([364, 64])
torch.Size([74, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.6185030937194824  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.051656246185302734  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([9344, 500])
torch.Size([4328, 64])
torch.Size([723, 64])
torch.Size([109, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.056234359741211  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.04395103454589844  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([5393, 500])
torch.Size([1785, 64])
torch.Size([264, 64])
torch.Size([61, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.5706310272216797  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.04805326461791992  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([7536, 500])
torch.Size([3313, 64])
torch.Size([535, 64])
torch.Size([119, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.8790030479431152  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.05807352066040039  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([12843, 500])
torch.Size([5534, 64])
torch.Size([1699, 64])
torch.Size([191, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.2517757415771484  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.04770231246948242  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([7349, 500])
torch.Size([3052, 64])
torch.Size([681, 64])
torch.Size([125, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.8458976745605469  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.056310176849365234  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([11891, 500])
torch.Size([6262, 64])
torch.Size([1003, 64])
torch.Size([259, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.3203506469726562  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.05575132369995117  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([11201, 500])
torch.Size([5927, 64])
torch.Size([1672, 64])
torch.Size([353, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.4077930450439453  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.059252262115478516  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([13440, 500])
torch.Size([7831, 64])
torch.Size([1442, 64])
torch.Size([348, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.4487910270690918  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.05574464797973633  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([11145, 500])
torch.Size([6211, 64])
torch.Size([1787, 64])
torch.Size([392, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.40419340133667  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.04061412811279297  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([3647, 500])
torch.Size([989, 64])
torch.Size([209, 64])
torch.Size([56, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.28163862228393555  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.0437312126159668  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([5278, 500])
torch.Size([1753, 64])
torch.Size([272, 64])
torch.Size([54, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.5453648567199707  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.061720848083496094  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes
Using backend: pytorch

torch.Size([14714, 500])
torch.Size([7810, 64])
torch.Size([1966, 64])
torch.Size([399, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.7149624824523926  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.0519719123840332  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

torch.Size([9610, 500])
torch.Size([4559, 64])
torch.Size([883, 64])
torch.Size([184, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.0443978309631348  GigaBytes
Max Memory Allocated: 1.7850875854492188  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007005230585734049 |0.0018643697102864584 |0.20130807558695477 |0.00012939771016438802 |0.25483330090840656 |0.007486581802368164 |
----------------------------------------------------------pseudo_mini_loss sum 1.975887417793274
Total (block generation + training)time/epoch 7.855197191238403
Training time/epoch 7.016948223114014
Training time without block to device /epoch 6.988982677459717
Training time without total dataloading part /epoch 6.851548194885254
load block tensor time/epoch 0.10507845878601074
block to device time/epoch 0.027965545654296875
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  228461
Number of first layer input nodes during this epoch:  143050
