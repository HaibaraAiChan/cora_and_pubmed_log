main start at this time 1648532860.5912378
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008303642272949219  GigaBytes
Max Memory Allocated: 0.008303642272949219  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005164146423339844
range selection method range initialization spend 7.081031799316406e-05
time for parepare:  6.604194641113281e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00024819374084472656
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0008940696716308594
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.7404556274414062e-05
----------------------check_connections_block total spend ----------------------------- 0.0025272369384765625
generate_one_block  0.0011026859283447266
generate_one_block  0.0010194778442382812
generate_one_block  0.0009891986846923828
generate_one_block  0.000993967056274414
generate_one_block  0.000993490219116211
generate_one_block  0.0010259151458740234
generate_one_block  0.0010063648223876953
generate_one_block  0.0009777545928955078
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00054931640625
gen group dst list time:  5.173683166503906e-05
time for parepare:  0.0002448558807373047
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0003020763397216797
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00012183189392089844
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00011014938354492188
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.0001266002655029297
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00019359588623046875
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00011014938354492188
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0002963542938232422
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0001068115234375
----------------------check_connections_block total spend ----------------------------- 0.003470182418823242
generate_one_block  0.0013897418975830078
generate_one_block  0.0010905265808105469
generate_one_block  0.0010755062103271484
generate_one_block  0.0011615753173828125
generate_one_block  0.0012764930725097656
generate_one_block  0.0010921955108642578
generate_one_block  0.0013871192932128906
generate_one_block  0.0010848045349121094
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010492801666259766
gen group dst list time:  9.465217590332031e-05
time for parepare:  0.0007536411285400391
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00030517578125
mini_batch_src_global generation:  0.00016927719116210938
r_  generation:  0.0020208358764648438
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  0.00011277198791503906
r_  generation:  0.0005595684051513672
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0004868507385253906
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  9.72747802734375e-05
r_  generation:  0.0009872913360595703
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  0.00012826919555664062
r_  generation:  0.0013327598571777344
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  9.942054748535156e-05
r_  generation:  0.0007338523864746094
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  0.00019693374633789062
r_  generation:  0.002320528030395508
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  0.00010704994201660156
r_  generation:  0.0004944801330566406
----------------------check_connections_block total spend ----------------------------- 0.014883756637573242
generate_one_block  0.0035037994384765625
generate_one_block  0.0015323162078857422
generate_one_block  0.0014781951904296875
generate_one_block  0.002302408218383789
generate_one_block  0.002494335174560547
generate_one_block  0.0017707347869873047
generate_one_block  0.0038137435913085938
generate_one_block  0.001476287841796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020804405212402344
gen group dst list time:  0.00026798248291015625
time for parepare:  0.0015478134155273438
local_output_nid generation:  0.00020813941955566406
local_in_edges_tensor generation:  0.0007917881011962891
mini_batch_src_global generation:  0.0009794235229492188
r_  generation:  0.008388042449951172
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.0002582073211669922
mini_batch_src_global generation:  0.00042510032653808594
r_  generation:  0.0026700496673583984
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00024580955505371094
mini_batch_src_global generation:  0.0002677440643310547
r_  generation:  0.002852201461791992
local_output_nid generation:  0.00017213821411132812
local_in_edges_tensor generation:  0.000469207763671875
mini_batch_src_global generation:  0.0005927085876464844
r_  generation:  0.006117105484008789
local_output_nid generation:  0.00018358230590820312
local_in_edges_tensor generation:  0.000732421875
mini_batch_src_global generation:  0.0009059906005859375
r_  generation:  0.0069696903228759766
local_output_nid generation:  0.00011491775512695312
local_in_edges_tensor generation:  0.0002994537353515625
mini_batch_src_global generation:  0.0005059242248535156
r_  generation:  0.0043942928314208984
local_output_nid generation:  0.00024318695068359375
local_in_edges_tensor generation:  0.0005066394805908203
mini_batch_src_global generation:  0.00078582763671875
r_  generation:  0.011303186416625977
local_output_nid generation:  0.00012683868408203125
local_in_edges_tensor generation:  0.0005059242248535156
mini_batch_src_global generation:  0.0004935264587402344
r_  generation:  0.002938508987426758
----------------------check_connections_block total spend ----------------------------- 0.06841492652893066
generate_one_block  0.01259469985961914
generate_one_block  0.004622220993041992
generate_one_block  0.0045621395111083984
generate_one_block  0.009314775466918945
generate_one_block  0.01121377944946289
generate_one_block  0.006781578063964844
generate_one_block  0.012477397918701172
generate_one_block  0.0047070980072021484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.006928682327270508
gen group dst list time:  0.0013303756713867188
time for parepare:  0.0017290115356445312
local_output_nid generation:  0.0007197856903076172
local_in_edges_tensor generation:  0.003555774688720703
mini_batch_src_global generation:  0.0018846988677978516
r_  generation:  0.017544984817504883
local_output_nid generation:  0.0003819465637207031
local_in_edges_tensor generation:  0.0008149147033691406
mini_batch_src_global generation:  0.0011813640594482422
r_  generation:  0.009236335754394531
local_output_nid generation:  0.00045371055603027344
local_in_edges_tensor generation:  0.0008037090301513672
mini_batch_src_global generation:  0.0009686946868896484
r_  generation:  0.01088571548461914
local_output_nid generation:  0.000732421875
local_in_edges_tensor generation:  0.0013957023620605469
mini_batch_src_global generation:  0.0015649795532226562
r_  generation:  0.016523361206054688
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0016238689422607422
mini_batch_src_global generation:  0.0016245841979980469
r_  generation:  0.018558979034423828
local_output_nid generation:  0.0006926059722900391
local_in_edges_tensor generation:  0.0010290145874023438
mini_batch_src_global generation:  0.0012814998626708984
r_  generation:  0.014319181442260742
local_output_nid generation:  0.0008924007415771484
local_in_edges_tensor generation:  0.0013039112091064453
mini_batch_src_global generation:  0.0017044544219970703
r_  generation:  0.018368005752563477
local_output_nid generation:  0.00045108795166015625
local_in_edges_tensor generation:  0.000728607177734375
mini_batch_src_global generation:  0.0010764598846435547
r_  generation:  0.01060628890991211
----------------------check_connections_block total spend ----------------------------- 0.17382311820983887
generate_one_block  0.024177074432373047
generate_one_block  0.013653039932250977
generate_one_block  0.014484405517578125
generate_one_block  0.023250102996826172
generate_one_block  0.024143695831298828
generate_one_block  0.018204212188720703
generate_one_block  0.024359941482543945
generate_one_block  0.014541864395141602
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.008303642272949219  GigaBytes
Max Memory Allocated: 0.008303642272949219  GigaBytes

connection checking time:  0.260591983795166
block generation total time  0.25101780891418457
average batch blocks generation time:  0.03137722611427307
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1307373046875 GB
    Memory Allocated: 0.03831338882446289  GigaBytes
Max Memory Allocated: 0.03831338882446289  GigaBytes

torch.Size([15210, 500])
torch.Size([9155, 64])
torch.Size([2926, 64])
torch.Size([629, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.8896231651306152  GigaBytes
Max Memory Allocated: 1.889655590057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.036721229553222656  GigaBytes
Max Memory Allocated: 1.8898468017578125  GigaBytes

torch.Size([10626, 500])
torch.Size([4339, 64])
torch.Size([902, 64])
torch.Size([221, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.043468952178955  GigaBytes
Max Memory Allocated: 1.8898468017578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.03698015213012695  GigaBytes
Max Memory Allocated: 1.8898468017578125  GigaBytes

torch.Size([10747, 500])
torch.Size([4919, 64])
torch.Size([820, 64])
torch.Size([198, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.154808521270752  GigaBytes
Max Memory Allocated: 1.8898468017578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.04502153396606445  GigaBytes
Max Memory Allocated: 1.8898468017578125  GigaBytes

torch.Size([14926, 500])
torch.Size([8259, 64])
torch.Size([2194, 64])
torch.Size([301, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 1.788834571838379  GigaBytes
Max Memory Allocated: 1.8898468017578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2557373046875 GB
    Memory Allocated: 0.045923709869384766  GigaBytes
Max Memory Allocated: 1.8898468017578125  GigaBytes

torch.Size([15374, 500])
torch.Size([10173, 64])
torch.Size([2194, 64])
torch.Size([511, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3924560546875 GB
    Memory Allocated: 1.9392280578613281  GigaBytes
Max Memory Allocated: 1.9622163772583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3924560546875 GB
    Memory Allocated: 0.04053020477294922  GigaBytes
Max Memory Allocated: 1.9622163772583008  GigaBytes

torch.Size([12560, 500])
torch.Size([6900, 64])
torch.Size([1256, 64])
torch.Size([250, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3924560546875 GB
    Memory Allocated: 1.4876232147216797  GigaBytes
Max Memory Allocated: 1.9622163772583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3924560546875 GB
    Memory Allocated: 0.0468597412109375  GigaBytes
Max Memory Allocated: 1.9622163772583008  GigaBytes

torch.Size([15833, 500])
torch.Size([9753, 64])
torch.Size([3151, 64])
torch.Size([629, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5447998046875 GB
    Memory Allocated: 2.003793716430664  GigaBytes
Max Memory Allocated: 2.00382661819458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5447998046875 GB
    Memory Allocated: 0.036495208740234375  GigaBytes
Max Memory Allocated: 2.0040154457092285  GigaBytes

torch.Size([9984, 500])
torch.Size([4781, 64])
torch.Size([820, 64])
torch.Size([187, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5447998046875 GB
    Memory Allocated: 1.1331071853637695  GigaBytes
Max Memory Allocated: 2.0040154457092285  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01276358962059021 |0.04383742809295654 |0.2919515371322632 |0.00015223026275634766 |0.39642658829689026 |0.013136625289916992 |
----------------------------------------------------------pseudo_mini_loss sum 1.967714548110962
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  181085
Number of first layer input nodes during this epoch:  105260
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5447998046875 GB
    Memory Allocated: 0.05449342727661133  GigaBytes
Max Memory Allocated: 2.0040154457092285  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005784034729003906
range selection method range initialization spend 6.4849853515625e-05
time for parepare:  6.914138793945312e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  4.982948303222656e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.9325485229492188e-05
----------------------check_connections_block total spend ----------------------------- 0.0018329620361328125
generate_one_block  0.0011799335479736328
generate_one_block  0.0013463497161865234
generate_one_block  0.001077413558959961
generate_one_block  0.0010564327239990234
generate_one_block  0.0010879039764404297
generate_one_block  0.001077413558959961
generate_one_block  0.0010790824890136719
generate_one_block  0.001069784164428711
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005795955657958984
gen group dst list time:  5.745887756347656e-05
time for parepare:  0.0003345012664794922
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00014638900756835938
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  8.749961853027344e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001380443572998047
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00017595291137695312
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00036025047302246094
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00023984909057617188
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00023126602172851562
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00011754035949707031
----------------------check_connections_block total spend ----------------------------- 0.003902435302734375
generate_one_block  0.0012814998626708984
generate_one_block  0.0011429786682128906
generate_one_block  0.0012531280517578125
generate_one_block  0.0012731552124023438
generate_one_block  0.0015518665313720703
generate_one_block  0.0014371871948242188
generate_one_block  0.001348257064819336
generate_one_block  0.0011475086212158203
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012965202331542969
gen group dst list time:  0.00011420249938964844
time for parepare:  0.000965118408203125
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0003390312194824219
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.0008332729339599609
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  0.00010848045349121094
r_  generation:  0.0005328655242919922
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  0.00012540817260742188
r_  generation:  0.00103759765625
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.00015544891357421875
r_  generation:  0.0011250972747802734
local_output_nid generation:  7.796287536621094e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  0.0002994537353515625
r_  generation:  0.002485990524291992
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.00022745132446289062
r_  generation:  0.0015866756439208984
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  0.00016236305236816406
r_  generation:  0.0013129711151123047
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0005116462707519531
----------------------check_connections_block total spend ----------------------------- 0.016457080841064453
generate_one_block  0.0022482872009277344
generate_one_block  0.0016970634460449219
generate_one_block  0.002428293228149414
generate_one_block  0.0023386478424072266
generate_one_block  0.004128694534301758
generate_one_block  0.0030221939086914062
generate_one_block  0.0026772022247314453
generate_one_block  0.0016198158264160156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021522045135498047
gen group dst list time:  0.0003509521484375
time for parepare:  0.0015423297882080078
local_output_nid generation:  0.00020384788513183594
local_in_edges_tensor generation:  0.0007863044738769531
mini_batch_src_global generation:  0.0006492137908935547
r_  generation:  0.005370616912841797
local_output_nid generation:  0.00010085105895996094
local_in_edges_tensor generation:  0.00030112266540527344
mini_batch_src_global generation:  0.0005092620849609375
r_  generation:  0.0036344528198242188
local_output_nid generation:  0.0002281665802001953
local_in_edges_tensor generation:  0.00043582916259765625
mini_batch_src_global generation:  0.00060272216796875
r_  generation:  0.005994319915771484
local_output_nid generation:  0.00017595291137695312
local_in_edges_tensor generation:  0.0003960132598876953
mini_batch_src_global generation:  0.0006177425384521484
r_  generation:  0.005440711975097656
local_output_nid generation:  0.00031757354736328125
local_in_edges_tensor generation:  0.0005962848663330078
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.010249853134155273
local_output_nid generation:  0.0002353191375732422
local_in_edges_tensor generation:  0.00045609474182128906
mini_batch_src_global generation:  0.0007636547088623047
r_  generation:  0.006862640380859375
local_output_nid generation:  0.00025200843811035156
local_in_edges_tensor generation:  0.000469207763671875
mini_batch_src_global generation:  0.000637054443359375
r_  generation:  0.00606083869934082
local_output_nid generation:  0.0001068115234375
local_in_edges_tensor generation:  0.00027251243591308594
mini_batch_src_global generation:  0.00039386749267578125
r_  generation:  0.0029191970825195312
----------------------check_connections_block total spend ----------------------------- 0.0705869197845459
generate_one_block  0.009062051773071289
generate_one_block  0.006695270538330078
generate_one_block  0.00938272476196289
generate_one_block  0.008953094482421875
generate_one_block  0.014750957489013672
generate_one_block  0.010424137115478516
generate_one_block  0.010012149810791016
generate_one_block  0.00501704216003418
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022826194763183594
gen group dst list time:  0.0013065338134765625
time for parepare:  0.001943826675415039
local_output_nid generation:  0.0008077621459960938
local_in_edges_tensor generation:  0.0018086433410644531
mini_batch_src_global generation:  0.0014886856079101562
r_  generation:  0.014777898788452148
local_output_nid generation:  0.0005459785461425781
local_in_edges_tensor generation:  0.0010139942169189453
mini_batch_src_global generation:  0.0013689994812011719
r_  generation:  0.011304378509521484
local_output_nid generation:  0.0008432865142822266
local_in_edges_tensor generation:  0.0015361309051513672
mini_batch_src_global generation:  0.0013785362243652344
r_  generation:  0.016584396362304688
local_output_nid generation:  0.0009620189666748047
local_in_edges_tensor generation:  0.0012958049774169922
mini_batch_src_global generation:  0.0016427040100097656
r_  generation:  0.016425371170043945
local_output_nid generation:  0.0012578964233398438
local_in_edges_tensor generation:  0.0017316341400146484
mini_batch_src_global generation:  0.001903533935546875
r_  generation:  0.02051091194152832
local_output_nid generation:  0.0009090900421142578
local_in_edges_tensor generation:  0.001157522201538086
mini_batch_src_global generation:  0.0014314651489257812
r_  generation:  0.015071392059326172
local_output_nid generation:  0.0010819435119628906
local_in_edges_tensor generation:  0.0013513565063476562
mini_batch_src_global generation:  0.0013782978057861328
r_  generation:  0.017301559448242188
local_output_nid generation:  0.0005834102630615234
local_in_edges_tensor generation:  0.000797271728515625
mini_batch_src_global generation:  0.0010020732879638672
r_  generation:  0.009226322174072266
----------------------check_connections_block total spend ----------------------------- 0.18118834495544434
generate_one_block  0.020824432373046875
generate_one_block  0.01647663116455078
generate_one_block  0.02354741096496582
generate_one_block  0.022767066955566406
generate_one_block  0.02700519561767578
generate_one_block  0.020061969757080078
generate_one_block  0.025541067123413086
generate_one_block  0.014238595962524414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5447998046875 GB
    Memory Allocated: 0.05449342727661133  GigaBytes
Max Memory Allocated: 2.0040154457092285  GigaBytes

connection checking time:  0.27213478088378906
block generation total time  0.27535557746887207
average batch blocks generation time:  0.03441944718360901
block dataloader generation time/epoch 0.679926872253418
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5447998046875 GB
    Memory Allocated: 0.0594482421875  GigaBytes
Max Memory Allocated: 2.0040154457092285  GigaBytes

torch.Size([13331, 500])
torch.Size([6624, 64])
torch.Size([1705, 64])
torch.Size([274, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5447998046875 GB
    Memory Allocated: 1.5562396049499512  GigaBytes
Max Memory Allocated: 2.0040154457092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5447998046875 GB
    Memory Allocated: 0.05405616760253906  GigaBytes
Max Memory Allocated: 2.0040154457092285  GigaBytes

torch.Size([10507, 500])
torch.Size([5006, 64])
torch.Size([924, 64])
torch.Size([170, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5447998046875 GB
    Memory Allocated: 1.1864757537841797  GigaBytes
Max Memory Allocated: 2.0040154457092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5447998046875 GB
    Memory Allocated: 0.062314510345458984  GigaBytes
Max Memory Allocated: 2.0040154457092285  GigaBytes

torch.Size([14830, 500])
torch.Size([7767, 64])
torch.Size([2098, 64])
torch.Size([307, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5447998046875 GB
    Memory Allocated: 1.7455697059631348  GigaBytes
Max Memory Allocated: 2.0040154457092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5447998046875 GB
    Memory Allocated: 0.06095552444458008  GigaBytes
Max Memory Allocated: 2.0040154457092285  GigaBytes

torch.Size([14109, 500])
torch.Size([8073, 64])
torch.Size([1664, 64])
torch.Size([385, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5447998046875 GB
    Memory Allocated: 1.70634126663208  GigaBytes
Max Memory Allocated: 2.0040154457092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5447998046875 GB
    Memory Allocated: 0.06507110595703125  GigaBytes
Max Memory Allocated: 2.0040154457092285  GigaBytes

torch.Size([16188, 500])
torch.Size([11456, 64])
torch.Size([3014, 64])
torch.Size([700, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6873779296875 GB
    Memory Allocated: 2.1545071601867676  GigaBytes
Max Memory Allocated: 2.15458345413208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6873779296875 GB
    Memory Allocated: 0.05816173553466797  GigaBytes
Max Memory Allocated: 2.154733180999756  GigaBytes

torch.Size([12607, 500])
torch.Size([7016, 64])
torch.Size([2006, 64])
torch.Size([454, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6873779296875 GB
    Memory Allocated: 1.5855793952941895  GigaBytes
Max Memory Allocated: 2.154733180999756  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6873779296875 GB
    Memory Allocated: 0.06303215026855469  GigaBytes
Max Memory Allocated: 2.154733180999756  GigaBytes

torch.Size([15203, 500])
torch.Size([8407, 64])
torch.Size([2144, 64])
torch.Size([448, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6873779296875 GB
    Memory Allocated: 1.8066935539245605  GigaBytes
Max Memory Allocated: 2.154733180999756  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6873779296875 GB
    Memory Allocated: 0.05240774154663086  GigaBytes
Max Memory Allocated: 2.154733180999756  GigaBytes

torch.Size([9650, 500])
torch.Size([4515, 64])
torch.Size([884, 64])
torch.Size([184, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6873779296875 GB
    Memory Allocated: 1.0459394454956055  GigaBytes
Max Memory Allocated: 2.154733180999756  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010469198226928711 |0.0020415782928466797 |0.2350102663040161 |0.00013586878776550293 |0.40516775846481323 |0.0106964111328125 |
----------------------------------------------------------pseudo_mini_loss sum 1.4570422172546387
Total (block generation + training)time/epoch 5.933964252471924
Training time/epoch 5.253731966018677
Training time without block to device /epoch 5.237399339675903
Training time without total dataloading part /epoch 5.133207559585571
load block tensor time/epoch 0.08375358581542969
block to device time/epoch 0.016332626342773438
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  183007
Number of first layer input nodes during this epoch:  106425
