main start at this time 1648533037.1546817
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0467529296875 GB
    Memory Allocated: 0.01775074005126953  GigaBytes
Max Memory Allocated: 0.01775074005126953  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.002421855926513672
range selection method range initialization spend 9.34600830078125e-05
time for parepare:  5.459785461425781e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00028204917907714844
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.002553224563598633
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.811981201171875e-05
----------------------check_connections_block total spend ----------------------------- 0.0045506954193115234
generate_one_block  0.0014758110046386719
generate_one_block  0.0012481212615966797
generate_one_block  0.0012853145599365234
generate_one_block  0.0012557506561279297
generate_one_block  0.0012485980987548828
generate_one_block  0.0013201236724853516
generate_one_block  0.0012183189392089844
generate_one_block  0.001033782958984375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012042522430419922
gen group dst list time:  6.556510925292969e-05
time for parepare:  0.00030159950256347656
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00022912025451660156
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001316070556640625
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00032520294189453125
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001423358917236328
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0001404285430908203
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0004417896270751953
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0001423358917236328
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00011134147644042969
----------------------check_connections_block total spend ----------------------------- 0.004158973693847656
generate_one_block  0.001493692398071289
generate_one_block  0.0013833045959472656
generate_one_block  0.001680135726928711
generate_one_block  0.0014028549194335938
generate_one_block  0.001466512680053711
generate_one_block  0.0018155574798583984
generate_one_block  0.0011761188507080078
generate_one_block  0.0010612010955810547
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00122833251953125
gen group dst list time:  0.00011730194091796875
time for parepare:  0.0009722709655761719
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.000301361083984375
mini_batch_src_global generation:  0.00010895729064941406
r_  generation:  0.0009570121765136719
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.000606536865234375
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  0.000213623046875
r_  generation:  0.002269744873046875
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  0.00016188621520996094
r_  generation:  0.0011353492736816406
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  0.00011301040649414062
r_  generation:  0.0009517669677734375
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  0.0003066062927246094
r_  generation:  0.0032100677490234375
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  0.0001270771026611328
r_  generation:  0.0006453990936279297
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0004508495330810547
----------------------check_connections_block total spend ----------------------------- 0.017194032669067383
generate_one_block  0.0019464492797851562
generate_one_block  0.0015239715576171875
generate_one_block  0.0032510757446289062
generate_one_block  0.002170085906982422
generate_one_block  0.0018169879913330078
generate_one_block  0.004018545150756836
generate_one_block  0.0016701221466064453
generate_one_block  0.0014600753784179688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002081155776977539
gen group dst list time:  0.00033664703369140625
time for parepare:  0.0019180774688720703
local_output_nid generation:  0.00014710426330566406
local_in_edges_tensor generation:  0.0006656646728515625
mini_batch_src_global generation:  0.0007236003875732422
r_  generation:  0.00584864616394043
local_output_nid generation:  8.96453857421875e-05
local_in_edges_tensor generation:  0.0002865791320800781
mini_batch_src_global generation:  0.00043845176696777344
r_  generation:  0.0028963088989257812
local_output_nid generation:  0.00034737586975097656
local_in_edges_tensor generation:  0.0006465911865234375
mini_batch_src_global generation:  0.0009865760803222656
r_  generation:  0.012112855911254883
local_output_nid generation:  0.00023245811462402344
local_in_edges_tensor generation:  0.0004987716674804688
mini_batch_src_global generation:  0.0009307861328125
r_  generation:  0.005650758743286133
local_output_nid generation:  0.00012564659118652344
local_in_edges_tensor generation:  0.00031185150146484375
mini_batch_src_global generation:  0.0005040168762207031
r_  generation:  0.00406956672668457
local_output_nid generation:  0.00022602081298828125
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0006852149963378906
r_  generation:  0.008060693740844727
local_output_nid generation:  0.00010943412780761719
local_in_edges_tensor generation:  0.0002739429473876953
mini_batch_src_global generation:  0.00048089027404785156
r_  generation:  0.0034520626068115234
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  0.0002872943878173828
r_  generation:  0.0025496482849121094
----------------------check_connections_block total spend ----------------------------- 0.06793022155761719
generate_one_block  0.0075206756591796875
generate_one_block  0.004370689392089844
generate_one_block  0.013039827346801758
generate_one_block  0.009472846984863281
generate_one_block  0.006831645965576172
generate_one_block  0.012143850326538086
generate_one_block  0.005404472351074219
generate_one_block  0.004309177398681641
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021445751190185547
gen group dst list time:  0.0012753009796142578
time for parepare:  0.0018303394317626953
local_output_nid generation:  0.0006194114685058594
local_in_edges_tensor generation:  0.001538991928100586
mini_batch_src_global generation:  0.001447916030883789
r_  generation:  0.014794111251831055
local_output_nid generation:  0.0003998279571533203
local_in_edges_tensor generation:  0.0007843971252441406
mini_batch_src_global generation:  0.0011038780212402344
r_  generation:  0.008239507675170898
local_output_nid generation:  0.000988006591796875
local_in_edges_tensor generation:  0.0014226436614990234
mini_batch_src_global generation:  0.0017457008361816406
r_  generation:  0.021039485931396484
local_output_nid generation:  0.0006165504455566406
local_in_edges_tensor generation:  0.0009982585906982422
mini_batch_src_global generation:  0.001554250717163086
r_  generation:  0.016047954559326172
local_output_nid generation:  0.0005393028259277344
local_in_edges_tensor generation:  0.0008463859558105469
mini_batch_src_global generation:  0.0012879371643066406
r_  generation:  0.01328897476196289
local_output_nid generation:  0.0008058547973632812
local_in_edges_tensor generation:  0.0012280941009521484
mini_batch_src_global generation:  0.0013816356658935547
r_  generation:  0.017672300338745117
local_output_nid generation:  0.0006003379821777344
local_in_edges_tensor generation:  0.0008726119995117188
mini_batch_src_global generation:  0.0012545585632324219
r_  generation:  0.013406515121459961
local_output_nid generation:  0.0004532337188720703
local_in_edges_tensor generation:  0.0007202625274658203
mini_batch_src_global generation:  0.0010247230529785156
r_  generation:  0.008989810943603516
----------------------check_connections_block total spend ----------------------------- 0.16591978073120117
generate_one_block  0.019458293914794922
generate_one_block  0.012882232666015625
generate_one_block  0.026598215103149414
generate_one_block  0.0219728946685791
generate_one_block  0.017481327056884766
generate_one_block  0.02278280258178711
generate_one_block  0.01777029037475586
generate_one_block  0.013895034790039062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0467529296875 GB
    Memory Allocated: 0.01775074005126953  GigaBytes
Max Memory Allocated: 0.01775074005126953  GigaBytes

connection checking time:  0.2552030086517334
block generation total time  0.2452709674835205
average batch blocks generation time:  0.030658870935440063
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.042269229888916016  GigaBytes
Max Memory Allocated: 0.042269229888916016  GigaBytes

torch.Size([12893, 500])
torch.Size([7158, 256])
torch.Size([1376, 256])
torch.Size([329, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0213623046875 GB
    Memory Allocated: 1.7480583190917969  GigaBytes
Max Memory Allocated: 1.748133659362793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0272216796875 GB
    Memory Allocated: 0.0553131103515625  GigaBytes
Max Memory Allocated: 1.753178596496582  GigaBytes

torch.Size([9991, 500])
torch.Size([4285, 256])
torch.Size([745, 256])
torch.Size([248, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0272216796875 GB
    Memory Allocated: 1.0584254264831543  GigaBytes
Max Memory Allocated: 1.753178596496582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0272216796875 GB
    Memory Allocated: 0.06740045547485352  GigaBytes
Max Memory Allocated: 1.753178596496582  GigaBytes

torch.Size([16701, 500])
torch.Size([11708, 256])
torch.Size([3395, 256])
torch.Size([623, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9764404296875 GB
    Memory Allocated: 2.6874032020568848  GigaBytes
Max Memory Allocated: 2.687497138977051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 0.06277179718017578  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

torch.Size([14337, 500])
torch.Size([7098, 256])
torch.Size([1991, 256])
torch.Size([259, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 1.9774508476257324  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 0.059383392333984375  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

torch.Size([12072, 500])
torch.Size([5634, 256])
torch.Size([1261, 256])
torch.Size([238, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 1.5923123359680176  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 0.0628213882446289  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

torch.Size([14281, 500])
torch.Size([8945, 256])
torch.Size([2816, 256])
torch.Size([723, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 2.367173671722412  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 0.060211181640625  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

torch.Size([13042, 500])
torch.Size([6114, 256])
torch.Size([1238, 256])
torch.Size([259, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 1.5397686958312988  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 0.0542144775390625  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

torch.Size([9878, 500])
torch.Size([4532, 256])
torch.Size([779, 256])
torch.Size([189, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 1.165146827697754  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012750744819641113 |0.04363560676574707 |0.29542049765586853 |0.0001551806926727295 |0.3258707523345947 |0.01141977310180664 |
----------------------------------------------------------pseudo_mini_loss sum 1.908569574356079
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  175494
Number of first layer input nodes during this epoch:  103195
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 0.09014511108398438  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009691715240478516
range selection method range initialization spend 6.270408630371094e-05
time for parepare:  7.176399230957031e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.0517578125e-05
----------------------check_connections_block total spend ----------------------------- 0.0018665790557861328
generate_one_block  0.0012805461883544922
generate_one_block  0.001407623291015625
generate_one_block  0.0011107921600341797
generate_one_block  0.0011169910430908203
generate_one_block  0.0010895729064941406
generate_one_block  0.0011165142059326172
generate_one_block  0.001110076904296875
generate_one_block  0.0010921955108642578
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007429122924804688
gen group dst list time:  5.888938903808594e-05
time for parepare:  0.0003459453582763672
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00025844573974609375
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0001513957977294922
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.0001926422119140625
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00015616416931152344
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00010704994201660156
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00026679039001464844
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00021791458129882812
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001590251922607422
----------------------check_connections_block total spend ----------------------------- 0.0039844512939453125
generate_one_block  0.0015535354614257812
generate_one_block  0.0013074874877929688
generate_one_block  0.0013365745544433594
generate_one_block  0.0012853145599365234
generate_one_block  0.0012178421020507812
generate_one_block  0.0015153884887695312
generate_one_block  0.0013782978057861328
generate_one_block  0.00131988525390625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012252330780029297
gen group dst list time:  0.00011348724365234375
time for parepare:  0.0009799003601074219
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.0003800392150878906
mini_batch_src_global generation:  0.0002906322479248047
r_  generation:  0.0018649101257324219
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.00016355514526367188
r_  generation:  0.0007534027099609375
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  0.00011682510375976562
r_  generation:  0.0009157657623291016
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  0.0001316070556640625
r_  generation:  0.0010724067687988281
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.000701904296875
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.0001983642578125
r_  generation:  0.0018267631530761719
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.00017571449279785156
r_  generation:  0.0013861656188964844
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  0.00013184547424316406
r_  generation:  0.0008718967437744141
----------------------check_connections_block total spend ----------------------------- 0.01654052734375
generate_one_block  0.003912210464477539
generate_one_block  0.0019707679748535156
generate_one_block  0.002126932144165039
generate_one_block  0.0026416778564453125
generate_one_block  0.0018532276153564453
generate_one_block  0.003429412841796875
generate_one_block  0.002854585647583008
generate_one_block  0.0021114349365234375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018439292907714844
gen group dst list time:  0.0003521442413330078
time for parepare:  0.0016422271728515625
local_output_nid generation:  0.00029921531677246094
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.0008826255798339844
r_  generation:  0.007928848266601562
local_output_nid generation:  0.00011801719665527344
local_in_edges_tensor generation:  0.0003018379211425781
mini_batch_src_global generation:  0.0005295276641845703
r_  generation:  0.003686666488647461
local_output_nid generation:  0.00014066696166992188
local_in_edges_tensor generation:  0.0003306865692138672
mini_batch_src_global generation:  0.00039577484130859375
r_  generation:  0.0040400028228759766
local_output_nid generation:  0.0002505779266357422
local_in_edges_tensor generation:  0.0004458427429199219
mini_batch_src_global generation:  0.0005512237548828125
r_  generation:  0.0063266754150390625
local_output_nid generation:  0.000125885009765625
local_in_edges_tensor generation:  0.0003037452697753906
mini_batch_src_global generation:  0.0004477500915527344
r_  generation:  0.003865957260131836
local_output_nid generation:  0.00022220611572265625
local_in_edges_tensor generation:  0.00041747093200683594
mini_batch_src_global generation:  0.0006043910980224609
r_  generation:  0.00637507438659668
local_output_nid generation:  0.0002498626708984375
local_in_edges_tensor generation:  0.000453948974609375
mini_batch_src_global generation:  0.0006768703460693359
r_  generation:  0.006455421447753906
local_output_nid generation:  0.000156402587890625
local_in_edges_tensor generation:  0.00031828880310058594
mini_batch_src_global generation:  0.0004374980926513672
r_  generation:  0.003829479217529297
----------------------check_connections_block total spend ----------------------------- 0.0649113655090332
generate_one_block  0.01188206672668457
generate_one_block  0.0064258575439453125
generate_one_block  0.006661891937255859
generate_one_block  0.010006189346313477
generate_one_block  0.006394147872924805
generate_one_block  0.010763883590698242
generate_one_block  0.01019597053527832
generate_one_block  0.005853414535522461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002275228500366211
gen group dst list time:  0.0011966228485107422
time for parepare:  0.0019030570983886719
local_output_nid generation:  0.00081634521484375
local_in_edges_tensor generation:  0.0019071102142333984
mini_batch_src_global generation:  0.0015876293182373047
r_  generation:  0.01575303077697754
local_output_nid generation:  0.0006315708160400391
local_in_edges_tensor generation:  0.0010416507720947266
mini_batch_src_global generation:  0.0014095306396484375
r_  generation:  0.012019872665405273
local_output_nid generation:  0.0007426738739013672
local_in_edges_tensor generation:  0.0010993480682373047
mini_batch_src_global generation:  0.00116729736328125
r_  generation:  0.013894081115722656
local_output_nid generation:  0.0009677410125732422
local_in_edges_tensor generation:  0.0012965202331542969
mini_batch_src_global generation:  0.0017542839050292969
r_  generation:  0.017778635025024414
local_output_nid generation:  0.0006439685821533203
local_in_edges_tensor generation:  0.0008680820465087891
mini_batch_src_global generation:  0.0011916160583496094
r_  generation:  0.012831926345825195
local_output_nid generation:  0.0008921623229980469
local_in_edges_tensor generation:  0.0012345314025878906
mini_batch_src_global generation:  0.0013709068298339844
r_  generation:  0.015657424926757812
local_output_nid generation:  0.0010280609130859375
local_in_edges_tensor generation:  0.0018374919891357422
mini_batch_src_global generation:  0.0016224384307861328
r_  generation:  0.018590211868286133
local_output_nid generation:  0.0007009506225585938
local_in_edges_tensor generation:  0.0008673667907714844
mini_batch_src_global generation:  0.0010349750518798828
r_  generation:  0.011645317077636719
----------------------check_connections_block total spend ----------------------------- 0.17578577995300293
generate_one_block  0.021599292755126953
generate_one_block  0.01721787452697754
generate_one_block  0.018733501434326172
generate_one_block  0.02523040771484375
generate_one_block  0.018201112747192383
generate_one_block  0.020446300506591797
generate_one_block  0.026515960693359375
generate_one_block  0.015902042388916016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 0.09014511108398438  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

connection checking time:  0.26122212409973145
block generation total time  0.26384449005126953
average batch blocks generation time:  0.03298056125640869
block dataloader generation time/epoch 0.6440811157226562
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 0.09532546997070312  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

torch.Size([12737, 500])
torch.Size([7589, 256])
torch.Size([2414, 256])
torch.Size([493, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 2.096120834350586  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 0.09284687042236328  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

torch.Size([11507, 500])
torch.Size([5524, 256])
torch.Size([1040, 256])
torch.Size([311, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 1.4192776679992676  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 0.09491348266601562  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

torch.Size([12614, 500])
torch.Size([6559, 256])
torch.Size([1332, 256])
torch.Size([368, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 1.609571933746338  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 0.10089874267578125  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

torch.Size([15595, 500])
torch.Size([8582, 256])
torch.Size([2331, 256])
torch.Size([313, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 2.208087921142578  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 0.09288406372070312  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

torch.Size([11193, 500])
torch.Size([5372, 256])
torch.Size([1132, 256])
torch.Size([208, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 1.526233196258545  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 0.09585428237915039  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

torch.Size([13032, 500])
torch.Size([7506, 256])
torch.Size([2009, 256])
torch.Size([448, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 2.041472911834717  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 0.10091209411621094  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

torch.Size([15331, 500])
torch.Size([9664, 256])
torch.Size([2294, 256])
torch.Size([455, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 2.2468652725219727  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 0.09321975708007812  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

torch.Size([11741, 500])
torch.Size([5508, 256])
torch.Size([1467, 256])
torch.Size([318, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9803466796875 GB
    Memory Allocated: 1.3649048805236816  GigaBytes
Max Memory Allocated: 2.69122314453125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008688807487487793 |0.0021992623805999756 |0.23738691210746765 |0.00013890862464904785 |0.33834654092788696 |0.01018071174621582 |
----------------------------------------------------------pseudo_mini_loss sum 3.2150514125823975
Total (block generation + training)time/epoch 5.369654417037964
Training time/epoch 4.725247383117676
Training time without block to device /epoch 4.707653284072876
Training time without total dataloading part /epoch 4.617159605026245
load block tensor time/epoch 0.06951045989990234
block to device time/epoch 0.017594099044799805
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  177344
Number of first layer input nodes during this epoch:  103750
