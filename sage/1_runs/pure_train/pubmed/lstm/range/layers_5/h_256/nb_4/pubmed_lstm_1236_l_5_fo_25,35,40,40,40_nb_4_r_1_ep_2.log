main start at this time 1648533007.221246
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0467529296875 GB
    Memory Allocated: 0.01775074005126953  GigaBytes
Max Memory Allocated: 0.01775074005126953  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.002201557159423828
range selection method range initialization spend 8.940696716308594e-05
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0002512931823730469
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0024955272674560547
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  7.653236389160156e-05
----------------------check_connections_block total spend ----------------------------- 0.0032579898834228516
generate_one_block  0.0013592243194580078
generate_one_block  0.001111745834350586
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010943412780761719
gen group dst list time:  2.4080276489257812e-05
time for parepare:  0.0002334117889404297
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.0006029605865478516
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  0.00010466575622558594
r_  generation:  0.0006525516510009766
----------------------check_connections_block total spend ----------------------------- 0.0023903846740722656
generate_one_block  0.001867532730102539
generate_one_block  0.001898050308227539
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011157989501953125
gen group dst list time:  6.198883056640625e-05
time for parepare:  0.0007405281066894531
local_output_nid generation:  8.988380432128906e-05
local_in_edges_tensor generation:  0.00038361549377441406
mini_batch_src_global generation:  0.0002789497375488281
r_  generation:  0.0032885074615478516
local_output_nid generation:  0.0001049041748046875
local_in_edges_tensor generation:  0.0003142356872558594
mini_batch_src_global generation:  0.0005521774291992188
r_  generation:  0.004149913787841797
----------------------check_connections_block total spend ----------------------------- 0.01206350326538086
generate_one_block  0.0054051876068115234
generate_one_block  0.0062868595123291016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021550655364990234
gen group dst list time:  0.00018739700317382812
time for parepare:  0.0015354156494140625
local_output_nid generation:  0.0003581047058105469
local_in_edges_tensor generation:  0.001070261001586914
mini_batch_src_global generation:  0.0012803077697753906
r_  generation:  0.01308894157409668
local_output_nid generation:  0.00039267539978027344
local_in_edges_tensor generation:  0.0007958412170410156
mini_batch_src_global generation:  0.0014133453369140625
r_  generation:  0.01319575309753418
----------------------check_connections_block total spend ----------------------------- 0.03949117660522461
generate_one_block  0.017880916595458984
generate_one_block  0.018267393112182617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018720626831054688
gen group dst list time:  0.0004749298095703125
time for parepare:  0.0017004013061523438
local_output_nid generation:  0.0009789466857910156
local_in_edges_tensor generation:  0.0019505023956298828
mini_batch_src_global generation:  0.0019617080688476562
r_  generation:  0.022574424743652344
local_output_nid generation:  0.0010552406311035156
local_in_edges_tensor generation:  0.0016939640045166016
mini_batch_src_global generation:  0.0022423267364501953
r_  generation:  0.021872520446777344
----------------------check_connections_block total spend ----------------------------- 0.06618022918701172
generate_one_block  0.027591466903686523
generate_one_block  0.02822422981262207
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0467529296875 GB
    Memory Allocated: 0.01775074005126953  GigaBytes
Max Memory Allocated: 0.01775074005126953  GigaBytes

connection checking time:  0.12012529373168945
block generation total time  0.1074216365814209
average batch blocks generation time:  0.05371081829071045
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1463623046875 GB
    Memory Allocated: 0.0520777702331543  GigaBytes
Max Memory Allocated: 0.0520777702331543  GigaBytes

torch.Size([17902, 500])
torch.Size([14026, 256])
torch.Size([5439, 256])
torch.Size([1309, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3709716796875 GB
    Memory Allocated: 3.1528773307800293  GigaBytes
Max Memory Allocated: 3.1531057357788086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4666748046875 GB
    Memory Allocated: 0.06937265396118164  GigaBytes
Max Memory Allocated: 3.1565918922424316  GigaBytes

torch.Size([17365, 500])
torch.Size([13391, 256])
torch.Size([5017, 256])
torch.Size([1414, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5467529296875 GB
    Memory Allocated: 3.167692184448242  GigaBytes
Max Memory Allocated: 3.1678876876831055  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.020678043365478516 |0.17241156101226807 |0.5928715467453003 |0.00020122528076171875 |0.4197438955307007 |0.013324975967407227 |
----------------------------------------------------------pseudo_mini_loss sum 1.5681469440460205
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  76218
Number of first layer input nodes during this epoch:  35267
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 0.10701465606689453  GigaBytes
Max Memory Allocated: 3.1714301109313965  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005125999450683594
range selection method range initialization spend 5.3882598876953125e-05
time for parepare:  5.316734313964844e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  6.67572021484375e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.4849853515625e-05
----------------------check_connections_block total spend ----------------------------- 0.0007014274597167969
generate_one_block  0.0011506080627441406
generate_one_block  0.005278348922729492
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010557174682617188
gen group dst list time:  5.245208740234375e-05
time for parepare:  0.0005402565002441406
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.0003654956817626953
mini_batch_src_global generation:  0.00013971328735351562
r_  generation:  0.0013856887817382812
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.000301361083984375
mini_batch_src_global generation: Using backend: pytorch
 0.0001709461212158203
r_  generation:  0.0014712810516357422
----------------------check_connections_block total spend ----------------------------- 0.005276679992675781
generate_one_block  0.0038444995880126953
generate_one_block  0.003759145736694336
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001957416534423828
gen group dst list time:  8.821487426757812e-05
time for parepare:  0.0009453296661376953
local_output_nid generation:  0.0001628398895263672
local_in_edges_tensor generation:  0.005130290985107422
mini_batch_src_global generation:  0.00047016143798828125
r_  generation:  0.004488706588745117
local_output_nid generation:  0.00011587142944335938
local_in_edges_tensor generation:  0.0002980232238769531
mini_batch_src_global generation:  0.0004470348358154297
r_  generation:  0.00408935546875
----------------------check_connections_block total spend ----------------------------- 0.01846456527709961
generate_one_block  0.007822036743164062
generate_one_block  0.0065460205078125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002016782760620117
gen group dst list time:  0.00018930435180664062
time for parepare:  0.0013287067413330078
local_output_nid generation:  0.0003643035888671875
local_in_edges_tensor generation:  0.0010917186737060547
mini_batch_src_global generation:  0.001207590103149414
r_  generation:  0.014919281005859375
local_output_nid generation:  0.0004239082336425781
local_in_edges_tensor generation:  0.0008730888366699219
mini_batch_src_global generation:  0.001512289047241211
r_  generation:  0.014110088348388672
----------------------check_connections_block total spend ----------------------------- 0.04248785972595215
generate_one_block  0.019727706909179688
generate_one_block  0.0210726261138916
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017671585083007812
gen group dst list time:  0.0005164146423339844
time for parepare:  0.0014493465423583984
local_output_nid generation:  0.0009217262268066406
local_in_edges_tensor generation:  0.0019481182098388672
mini_batch_src_global generation:  0.0020024776458740234
r_  generation:  0.02320265769958496
local_output_nid generation:  0.0011610984802246094
local_in_edges_tensor generation:  0.002269268035888672
mini_batch_src_global generation:  0.002641916275024414
r_  generation:  0.022873401641845703
----------------------check_connections_block total spend ----------------------------- 0.06849336624145508
generate_one_block  0.029752492904663086
generate_one_block  0.03152155876159668
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 0.10701465606689453  GigaBytes
Max Memory Allocated: 3.1714301109313965  GigaBytes

connection checking time:  0.13472247123718262
block generation total time  0.12404608726501465
average batch blocks generation time:  0.062023043632507324
block dataloader generation time/epoch 0.30852484703063965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 0.10562324523925781  GigaBytes
Max Memory Allocated: 3.1714301109313965  GigaBytes

torch.Size([17492, 500])
torch.Size([13276, 256])
torch.Size([5371, 256])
torch.Size([1394, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 3.183807373046875  GigaBytes
Max Memory Allocated: 3.184004783630371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5506591796875 GB
    Memory Allocated: 0.10651254653930664  GigaBytes
Max Memory Allocated: 3.1875438690185547  GigaBytes

torch.Size([17946, 500])
torch.Size([14395, 256])
torch.Size([5429, 256])
torch.Size([1394, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6190185546875 GB
    Memory Allocated: 3.312100887298584  GigaBytes
Max Memory Allocated: 3.3123269081115723  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014178037643432617 |0.001835942268371582 |0.3037451505661011 |0.0001531839370727539 |0.4377322196960449 |0.01304936408996582 |
----------------------------------------------------------pseudo_mini_loss sum 2.2556700706481934
Total (block generation + training)time/epoch 1.844407558441162
Training time/epoch 1.5355758666992188
Training time without block to device /epoch 1.5319039821624756
Training time without total dataloading part /epoch 1.4963104724884033
load block tensor time/epoch 0.028356075286865234
block to device time/epoch 0.003671884536743164
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  77053
Number of first layer input nodes during this epoch:  35438
