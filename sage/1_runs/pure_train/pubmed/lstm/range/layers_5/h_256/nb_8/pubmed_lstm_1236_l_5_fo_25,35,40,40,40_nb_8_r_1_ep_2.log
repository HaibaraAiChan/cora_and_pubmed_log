main start at this time 1648533020.7346342
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0467529296875 GB
    Memory Allocated: 0.01775074005126953  GigaBytes
Max Memory Allocated: 0.01775074005126953  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.002202272415161133
range selection method range initialization spend 8.916854858398438e-05
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.000274658203125
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.002572774887084961
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.314018249511719e-05
----------------------check_connections_block total spend ----------------------------- 0.0037240982055664062
generate_one_block  0.0013039112091064453
generate_one_block  0.001024007797241211
generate_one_block  0.0010259151458740234
generate_one_block  0.001039266586303711
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010974407196044922
gen group dst list time:  3.0517578125e-05
time for parepare:  0.00022745132446289062
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0002560615539550781
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0003597736358642578
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00037097930908203125
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0003464221954345703
----------------------check_connections_block total spend ----------------------------- 0.0027713775634765625
generate_one_block  0.0012772083282470703
generate_one_block  0.0015184879302978516
generate_one_block  0.0014574527740478516
generate_one_block  0.0013804435729980469
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010864734649658203
gen group dst list time:  7.43865966796875e-05
time for parepare:  0.0007612705230712891
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.00027489662170410156
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.001108407974243164
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  0.0002524852752685547
r_  generation:  0.002418041229248047
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.0002238750457763672
mini_batch_src_global generation:  0.00030684471130371094
r_  generation:  0.0025153160095214844
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  0.0002281665802001953
r_  generation:  0.0023145675659179688
----------------------check_connections_block total spend ----------------------------- 0.013315916061401367
generate_one_block  0.0024025440216064453
generate_one_block  0.004206657409667969
generate_one_block  0.004136800765991211
generate_one_block  0.003670930862426758
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022063255310058594
gen group dst list time:  0.0002276897430419922
time for parepare:  0.0015215873718261719
local_output_nid generation:  0.0001423358917236328
local_in_edges_tensor generation:  0.0006721019744873047
mini_batch_src_global generation:  0.0007359981536865234
r_  generation:  0.0058557987213134766
local_output_nid generation:  0.0003123283386230469
local_in_edges_tensor generation:  0.0006871223449707031
mini_batch_src_global generation:  0.0012857913970947266
r_  generation:  0.011319160461425781
local_output_nid generation:  0.000263214111328125
local_in_edges_tensor generation:  0.0013184547424316406
mini_batch_src_global generation:  0.0009338855743408203
r_  generation:  0.009587526321411133
local_output_nid generation:  0.00025010108947753906
local_in_edges_tensor generation:  0.0005359649658203125
mini_batch_src_global generation:  0.0009202957153320312
r_  generation:  0.008425235748291016
----------------------check_connections_block total spend ----------------------------- 0.05349087715148926
generate_one_block  0.009195566177368164
generate_one_block  0.015339851379394531
generate_one_block  0.013681650161743164
generate_one_block  0.01241612434387207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018162727355957031
gen group dst list time:  0.0008144378662109375
time for parepare:  0.0016913414001464844
local_output_nid generation:  0.0006909370422363281
local_in_edges_tensor generation:  0.0015957355499267578
mini_batch_src_global generation:  0.00145721435546875
r_  generation:  0.0159151554107666
local_output_nid generation:  0.0009675025939941406
local_in_edges_tensor generation:  0.0016016960144042969
mini_batch_src_global generation:  0.002131223678588867
r_  generation:  0.02116870880126953
local_output_nid generation:  0.0009987354278564453
local_in_edges_tensor generation:  0.0013704299926757812
mini_batch_src_global generation:  0.0017230510711669922
r_  generation:  0.01835179328918457
local_output_nid generation:  0.0009222030639648438
local_in_edges_tensor generation:  0.0013170242309570312
mini_batch_src_global generation:  0.0014483928680419922
r_  generation:  0.017940282821655273
----------------------check_connections_block total spend ----------------------------- 0.1075737476348877
generate_one_block  0.02166152000427246
generate_one_block  0.028548717498779297
generate_one_block  0.024005413055419922
generate_one_block  0.023895978927612305
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0467529296875 GB
    Memory Allocated: 0.01775074005126953  GigaBytes
Max Memory Allocated: 0.01775074005126953  GigaBytes

connection checking time:  0.17715191841125488
block generation total time  0.16879534721374512
average batch blocks generation time:  0.04219883680343628
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.0456995964050293  GigaBytes
Max Memory Allocated: 0.0456995964050293  GigaBytes

torch.Size([14466, 500])
torch.Size([8907, 256])
torch.Size([1918, 256])
torch.Size([516, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4139404296875 GB
    Memory Allocated: 2.090467929840088  GigaBytes
Max Memory Allocated: 2.0905656814575195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4197998046875 GB
    Memory Allocated: 0.06899499893188477  GigaBytes
Max Memory Allocated: 2.095064163208008  GigaBytes

torch.Size([17505, 500])
torch.Size([12947, 256])
torch.Size([4534, 256])
torch.Size([876, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2088623046875 GB
    Memory Allocated: 2.9431629180908203  GigaBytes
Max Memory Allocated: 2.94329833984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.06521940231323242  GigaBytes
Max Memory Allocated: 2.9469447135925293  GigaBytes

torch.Size([15529, 500])
torch.Size([10388, 256])
torch.Size([3436, 256])
torch.Size([771, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.6038436889648438  GigaBytes
Max Memory Allocated: 2.9469447135925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.06526470184326172  GigaBytes
Max Memory Allocated: 2.9469447135925293  GigaBytes

torch.Size([15578, 500])
torch.Size([10134, 256])
torch.Size([2958, 256])
torch.Size([724, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.497223377227783  GigaBytes
Max Memory Allocated: 2.9469447135925293  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014423370361328125 |0.0885777473449707 |0.41542595624923706 |0.00016808509826660156 |0.3819637894630432 |0.012658357620239258 |
----------------------------------------------------------pseudo_mini_loss sum 2.0283398628234863
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  121543
Number of first layer input nodes during this epoch:  63078
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.1019124984741211  GigaBytes
Max Memory Allocated: 2.9469447135925293  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005314350128173828
range selection method range initialization spend 5.316734313964844e-05
time for parepare:  5.53131103515625e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.4345855712890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0010573863983154297
generate_one_block  0.0011942386627197266
generate_one_block  0.0010814666748046875
generate_one_block  0.0010647773742675781
generate_one_block  0.0010728836059570312
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005786418914794922
gen group dst list time:  3.457069396972656e-05
time for parepare:  0.0002803802490234375
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0003266334533691406
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0003254413604736328
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0003151893615722656
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00035190582275390625
----------------------check_connections_block total spend ----------------------------- 0.002946138381958008
generate_one_block  0.001764535903930664
generate_one_block  0.001501321792602539
generate_one_block  0.0014929771423339844
generate_one_block  0.0015425682067871094
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001018524169921875
gen group dst list time:  9.179115295410156e-05
time for parepare:  0.0007541179656982422
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.0003399848937988281
mini_batch_src_global generation:  0.00025582313537597656
r_  generation:  0.0022923946380615234
local_output_nid generation:  6.532669067382812e-05
local_in_edges_tensor generation:  0.0002257823944091797
mini_batch_src_global generation:  0.00022602081298828125
r_  generation:  0.0018551349639892578
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  0.00022673606872558594
r_  generation:  0.002148866653442383
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  0.0002186298370361328
r_  generation:  0.002127408981323242
----------------------check_connections_block total spend ----------------------------- 0.013663053512573242
generate_one_block  0.006632089614868164
generate_one_block  0.0057985782623291016
generate_one_block  0.003931999206542969
generate_one_block  0.003993034362792969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002382516860961914
gen group dst list time:  0.00025463104248046875
time for parepare:  0.0014309883117675781
local_output_nid generation:  0.000362396240234375
local_in_edges_tensor generation:  0.0008549690246582031
mini_batch_src_global generation:  0.0008118152618408203
r_  generation:  0.009428739547729492
local_output_nid generation:  0.0002732276916503906
local_in_edges_tensor generation:  0.0005726814270019531
mini_batch_src_global generation:  0.0011148452758789062
r_  generation:  0.008121490478515625
local_output_nid generation:  0.0002353191375732422
local_in_edges_tensor generation:  0.0005183219909667969
mini_batch_src_global generation:  0.0007026195526123047
r_  generation:  0.007234096527099609
local_output_nid generation:  0.0003204345703125
local_in_edges_tensor generation:  0.0006973743438720703
mini_batch_src_global generation:  0.0008902549743652344
r_  generation:  0.009093284606933594
----------------------check_connections_block total spend ----------------------------- 0.05117225646972656
generate_one_block  0.015320539474487305
generate_one_block  0.016072511672973633
generate_one_block  0.011901617050170898
generate_one_block  0.014762639999389648
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.005900859832763672
gen group dst list time:  0.0009667873382568359
time for parepare:  0.001664876937866211
local_output_nid generation:  0.0009045600891113281
local_in_edges_tensor generation:  0.003993511199951172
mini_batch_src_global generation:  0.0018618106842041016
r_  generation:  0.01809215545654297
local_output_nid generation:  0.0009183883666992188
local_in_edges_tensor generation:  0.0021703243255615234
mini_batch_src_global generation:  0.002447843551635742
r_  generation:  0.019267559051513672
local_output_nid generation:  0.0008008480072021484
local_in_edges_tensor generation:  0.0011408329010009766
mini_batch_src_global generation:  0.0014145374298095703
r_  generation:  0.020842790603637695
local_output_nid generation:  0.0013148784637451172
local_in_edges_tensor generation:  0.002092123031616211
mini_batch_src_global generation:  0.002040386199951172Using backend: pytorch

r_  generation:  0.02089524269104004
----------------------check_connections_block total spend ----------------------------- 0.11928892135620117
generate_one_block  0.026039838790893555
generate_one_block  0.02873396873474121
generate_one_block  0.021831274032592773
generate_one_block  0.027924537658691406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.1019124984741211  GigaBytes
Max Memory Allocated: 2.9469447135925293  GigaBytes

connection checking time:  0.18707036972045898
block generation total time  0.18924403190612793
average batch blocks generation time:  0.04731100797653198
block dataloader generation time/epoch 0.4525930881500244
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.09965038299560547  GigaBytes
Max Memory Allocated: 2.9469447135925293  GigaBytes

torch.Size([14984, 500])
torch.Size([10004, 256])
torch.Size([3083, 256])
torch.Size([731, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.5383949279785156  GigaBytes
Max Memory Allocated: 2.9469447135925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.10219955444335938  GigaBytes
Max Memory Allocated: 2.9469447135925293  GigaBytes

torch.Size([16369, 500])
torch.Size([10427, 256])
torch.Size([3133, 256])
torch.Size([692, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.5191102027893066  GigaBytes
Max Memory Allocated: 2.9469447135925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.09699726104736328  GigaBytes
Max Memory Allocated: 2.9469447135925293  GigaBytes

torch.Size([13278, 500])
torch.Size([7604, 256])
torch.Size([2441, 256])
torch.Size([607, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.099053382873535  GigaBytes
Max Memory Allocated: 2.9469447135925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 0.10308647155761719  GigaBytes
Max Memory Allocated: 2.9469447135925293  GigaBytes

torch.Size([16815, 500])
torch.Size([11961, 256])
torch.Size([3579, 256])
torch.Size([830, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2518310546875 GB
    Memory Allocated: 2.693779945373535  GigaBytes
Max Memory Allocated: 2.9469447135925293  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0166165828704834 |0.0019819140434265137 |0.28147488832473755 |0.00015211105346679688 |0.39716851711273193 |0.010315895080566406 |
----------------------------------------------------------pseudo_mini_loss sum 3.053269624710083
Total (block generation + training)time/epoch 3.2660350799560547
Training time/epoch 2.813084602355957
Training time without block to device /epoch 2.805156946182251
Training time without total dataloading part /epoch 2.7254979610443115
load block tensor time/epoch 0.0664663314819336
block to device time/epoch 0.007927656173706055
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  116895
Number of first layer input nodes during this epoch:  61446
