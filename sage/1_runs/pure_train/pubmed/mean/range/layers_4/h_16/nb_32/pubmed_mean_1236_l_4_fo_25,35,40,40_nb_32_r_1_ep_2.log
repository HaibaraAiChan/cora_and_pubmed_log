main start at this time 1648530713.339834
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.200241088867188e-05  GigaBytes
Max Memory Allocated: 7.200241088867188e-05  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0026710033416748047
range selection method range initialization spend 9.298324584960938e-05
time for parepare:  4.0531158447265625e-05
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0024900436401367188
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.702278137207031e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.702278137207031e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  8.416175842285156e-05
mini_batch_src_global generation:  1.2636184692382812e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.440017700195312e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.654594421386719e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.702278137207031e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.8133392333984375e-05
----------------------check_connections_block total spend ----------------------------- 0.005092144012451172
generate_one_block  0.00131988525390625
generate_one_block  0.000993490219116211
generate_one_block  0.0010352134704589844
generate_one_block  0.0010199546813964844
generate_one_block  0.0009770393371582031
generate_one_block  0.0009810924530029297
generate_one_block  0.0010380744934082031
generate_one_block  0.0009698867797851562
generate_one_block  0.0009391307830810547
generate_one_block  0.0009357929229736328
generate_one_block  0.0009429454803466797
generate_one_block  0.0009372234344482422
generate_one_block  0.0009362697601318359
generate_one_block  0.0009696483612060547
generate_one_block  0.0010025501251220703
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010902881622314453
gen group dst list time:  7.414817810058594e-05
time for parepare:  0.0002307891845703125
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0002243518829345703
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0001957416534423828
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  8.726119995117188e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.127357482910156e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  6.866455078125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  6.580352783203125e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  6.67572021484375e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00013303756713867188
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0001747608184814453
----------------------check_connections_block total spend ----------------------------- 0.004220485687255859
generate_one_block  0.0012614727020263672
generate_one_block  0.0010483264923095703
generate_one_block  0.001230478286743164
generate_one_block  0.0010955333709716797
generate_one_block  0.0010819435119628906
generate_one_block  0.0010409355163574219
generate_one_block  0.0010297298431396484
generate_one_block  0.0010581016540527344
generate_one_block  0.000982522964477539
generate_one_block  0.0009849071502685547
generate_one_block  0.0010023117065429688
generate_one_block  0.0010619163513183594
generate_one_block  0.0010449886322021484
generate_one_block  0.001157522201538086
generate_one_block  0.0011754035949707031
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011043548583984375
gen group dst list time:  0.00011134147644042969
time for parepare:  0.0006871223449707031
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.0002963542938232422
mini_batch_src_global generation:  0.00013566017150878906
r_  generation:  0.0015606880187988281
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0002453327178955078
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  0.00013303756713867188
r_  generation:  0.0015888214111328125
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0004260540008544922
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0004940032958984375
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0002541542053222656
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003790855407714844
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.00029659271240234375
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00012421607971191406
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0002124309539794922
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00037384033203125
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0003237724304199219
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0003764629364013672
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0007967948913574219
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.001007080078125
----------------------check_connections_block total spend ----------------------------- 0.01512289047241211
generate_one_block  0.0030379295349121094
generate_one_block  0.0012383460998535156
generate_one_block  0.003054380416870117
generate_one_block  0.001432180404663086
generate_one_block  0.0017342567443847656
generate_one_block  0.0012326240539550781
generate_one_block  0.0014379024505615234
generate_one_block  0.001298666000366211
generate_one_block  0.0010809898376464844
generate_one_block  0.0011935234069824219
generate_one_block  0.0014238357543945312
generate_one_block  0.0013337135314941406
generate_one_block  0.0017468929290771484
generate_one_block  0.0019409656524658203
generate_one_block  0.0021486282348632812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002073526382446289
gen group dst list time:  0.0002779960632324219
time for parepare:  0.0015957355499267578
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.0006222724914550781
mini_batch_src_global generation:  0.0006389617919921875
r_  generation:  0.00531458854675293
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.0002543926239013672
r_  generation:  0.0014030933380126953
local_output_nid generation:  0.00017333030700683594
local_in_edges_tensor generation:  0.00039577484130859375
mini_batch_src_global generation:  0.0005927085876464844
r_  generation:  0.0062351226806640625
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.0002276897430419922
mini_batch_src_global generation:  0.0002906322479248047
r_  generation:  0.0018644332885742188
local_output_nid generation:  0.00010395050048828125
local_in_edges_tensor generation:  0.00027751922607421875
mini_batch_src_global generation:  0.00027060508728027344
r_  generation:  0.0031299591064453125
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.0002238750457763672
r_  generation:  0.0017273426055908203
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.00019049644470214844
r_  generation:  0.0018532276153564453
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.00016641616821289062
r_  generation:  0.0014960765838623047
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  0.00012063980102539062
r_  generation:  0.0008823871612548828
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  0.0001304149627685547
r_  generation:  0.001251220703125
local_output_nid generation:  7.534027099609375e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.002626657485961914
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.0002129077911376953
r_  generation:  0.0018336772918701172
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  0.00023865699768066406
r_  generation:  0.0023224353790283203
local_output_nid generation:  0.0001125335693359375
local_in_edges_tensor generation:  0.00029778480529785156
mini_batch_src_global generation:  0.00036263465881347656
r_  generation:  0.003977298736572266
local_output_nid generation:  0.00013637542724609375
local_in_edges_tensor generation:  0.0003323554992675781
mini_batch_src_global generation:  0.00043463706970214844
r_  generation:  0.004404783248901367
----------------------check_connections_block total spend ----------------------------- 0.061858177185058594
generate_one_block  0.008321762084960938
generate_one_block  0.0027480125427246094
generate_one_block  0.009992837905883789
generate_one_block  0.0033054351806640625
generate_one_block  0.005125761032104492
generate_one_block  0.003298044204711914
generate_one_block  0.0033309459686279297
generate_one_block  0.0029282569885253906
generate_one_block  0.0023980140686035156
generate_one_block  0.002633333206176758
generate_one_block  0.004314422607421875
generate_one_block  0.00334930419921875
generate_one_block  0.004051923751831055
generate_one_block  0.007264375686645508
generate_one_block  0.006629467010498047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.200241088867188e-05  GigaBytes
Max Memory Allocated: 7.200241088867188e-05  GigaBytes

connection checking time:  0.08120155334472656
block generation total time  0.1112828254699707
average batch blocks generation time:  0.0074188550313313804
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.011989593505859375  GigaBytes
Max Memory Allocated: 0.011989593505859375  GigaBytes

torch.Size([5929, 500])
torch.Size([1807, 16])
torch.Size([382, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.012669086456298828  GigaBytes
Max Memory Allocated: 0.012971878051757812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004703521728515625  GigaBytes
Max Memory Allocated: 0.016379833221435547  GigaBytes

torch.Size([2426, 500])
torch.Size([432, 16])
torch.Size([101, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004871368408203125  GigaBytes
Max Memory Allocated: 0.016379833221435547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013742446899414062  GigaBytes
Max Memory Allocated: 0.018036842346191406  GigaBytes

torch.Size([7181, 500])
torch.Size([2186, 16])
torch.Size([469, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014548778533935547  GigaBytes
Max Memory Allocated: 0.018036842346191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.005692958831787109  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

torch.Size([2948, 500])
torch.Size([810, 16])
torch.Size([117, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.005967140197753906  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.00939798355102539  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

torch.Size([4915, 500])
torch.Size([1317, 16])
torch.Size([140, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.009815692901611328  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.007035732269287109  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

torch.Size([3672, 500])
torch.Size([499, 16])
torch.Size([117, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.007232666015625  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006003379821777344  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

torch.Size([3113, 500])
torch.Size([630, 16])
torch.Size([146, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006243705749511719  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.005534648895263672  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

torch.Size([2869, 500])
torch.Size([627, 16])
torch.Size([145, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.005762577056884766  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.0035028457641601562  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

torch.Size([1789, 500])
torch.Size([257, 16])
torch.Size([48, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.00360870361328125  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.005526065826416016  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

torch.Size([2846, 500])
torch.Size([410, 16])
torch.Size([111, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.005687713623046875  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006687164306640625  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

torch.Size([3469, 500])
torch.Size([884, 16])
torch.Size([111, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006990909576416016  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006451129913330078  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

torch.Size([3355, 500])
torch.Size([561, 16])
torch.Size([150, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006678104400634766  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.0060596466064453125  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

torch.Size([3135, 500])
torch.Size([685, 16])
torch.Size([134, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006323337554931641  GigaBytes
Max Memory Allocated: 0.019009113311767578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.013967514038085938  GigaBytes
Max Memory Allocated: 0.01967334747314453  GigaBytes

torch.Size([6846, 500])
torch.Size([1443, 16])
torch.Size([343, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.014500141143798828  GigaBytes
Max Memory Allocated: 0.01967334747314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.013958454132080078  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

torch.Size([6929, 500])
torch.Size([1791, 16])
torch.Size([415, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014592647552490234  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0033187071482340493 |0.023269049326578774 |0.0556607723236084 |0.00014252662658691405 |0.0034380435943603517 |0.005023002624511719 |
----------------------------------------------------------pseudo_mini_loss sum 3.0291364192962646
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  79047
Number of first layer input nodes during this epoch:  61422
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014428138732910156  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006880760192871094
range selection method range initialization spend 7.295608520507812e-05
time for parepare:  6.4849853515625e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.239776611328125e-05
----------------------check_connections_block total spend ----------------------------- 0.002786397933959961
generate_one_block  0.0012712478637695312
generate_one_block  0.0010292530059814453
generate_one_block  0.0010271072387695312
generate_one_block  0.0010254383087158203
generate_one_block  0.0010232925415039062
generate_one_block  0.0010173320770263672
generate_one_block  0.0010104179382324219
generate_one_block  0.0011157989501953125
generate_one_block  0.0009882450103759766
generate_one_block  0.000982522964477539
generate_one_block  0.0009493827819824219
generate_one_block  0.0009889602661132812
generate_one_block  0.0009567737579345703
generate_one_block  0.0009350776672363281
generate_one_block  0.0009367465972900391
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006136894226074219
gen group dst list time:  7.271766662597656e-05
time for parepare:  0.000255584716796875
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00010895729064941406
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  9.274482727050781e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  7.557868957519531e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  9.846687316894531e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00016689300537109375
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0002295970916748047
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0001575946807861328
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.745887756347656e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.7206878662109375e-05
----------------------check_connections_block total spend ----------------------------- 0.004418849945068359
generate_one_block  0.0010395050048828125
generate_one_block  0.0010807514190673828
generate_one_block  0.0010945796966552734
generate_one_block  0.0010495185852050781
generate_one_block  0.0011289119720458984
generate_one_block  0.0011720657348632812
generate_one_block  0.0010368824005126953
generate_one_block  0.001008749008178711
generate_one_block  0.001003265380859375
generate_one_block  0.0013284683227539062
generate_one_block  0.0011188983917236328
generate_one_block  0.0009808540344238281
generate_one_block  0.0010204315185546875
generate_one_block  0.0010323524475097656
generate_one_block  0.0009613037109375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009446144104003906
gen group dst list time:  0.0001556873321533203
time for parepare:  0.0007314682006835938
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.000247955322265625
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0005543231964111328
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.0004582405090332031
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00025200843811035156
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0005178451538085938
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  0.0001506805419921875
r_  generation:  0.001264810562133789
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.0005307197570800781
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.00038623809814453125
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0004372596740722656
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.00016307830810546875
r_  generation:  0.0017476081848144531
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0010945796966552734
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0002582073211669922
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.000232696533203125
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00021719932556152344
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00012111663818359375
----------------------check_connections_block total spend ----------------------------- 0.015048027038574219
generate_one_block  0.001596689224243164
generate_one_block  0.0017213821411132812
generate_one_block  0.0015425682067871094
generate_one_block  0.0012657642364501953
generate_one_block  0.0015633106231689453
generate_one_block  0.002536773681640625
generate_one_block  0.0015957355499267578
generate_one_block  0.0013649463653564453
generate_one_block  0.0014736652374267578
generate_one_block  0.0031363964080810547
generate_one_block  0.002301931381225586
generate_one_block  0.0012352466583251953
generate_one_block  0.0012423992156982422
generate_one_block  0.0012388229370117188
generate_one_block  0.0011320114135742188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001996755599975586
gen group dst list time:  0.00030517578125
time for parepare:  0.0014772415161132812
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.0004162788391113281
mini_batch_src_global generation:  0.00014781951904296875
r_  generation:  0.0011332035064697266
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.00025582313537597656
mini_batch_src_global generation:  0.0004200935363769531
r_  generation:  0.003439664840698242
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.0002391338348388672
mini_batch_src_global generation:  0.00026535987854003906
r_  generation:  0.0022656917572021484
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00014901161193847656
r_  generation:  0.0011370182037353516
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  0.00020766258239746094
r_  generation:  0.0026366710662841797
local_output_nid generation:  0.00010704994201660156
local_in_edges_tensor generation:  0.0003058910369873047
mini_batch_src_global generation:  0.0004181861877441406
r_  generation:  0.0042724609375
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.0002586841583251953
mini_batch_src_global generation:  0.00032782554626464844
r_  generation:  0.0026547908782958984
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  0.00020241737365722656
r_  generation:  0.0016698837280273438
local_output_nid generation:  9.1552734375e-05
local_in_edges_tensor generation:  0.000255584716796875
mini_batch_src_global generation:  0.0002696514129638672
r_  generation:  0.0029289722442626953
local_output_nid generation:  0.00020551681518554688
local_in_edges_tensor generation:  0.00045752525329589844
mini_batch_src_global generation:  0.0006155967712402344
r_  generation:  0.006685972213745117
local_output_nid generation:  0.00017642974853515625
local_in_edges_tensor generation:  0.000415802001953125
mini_batch_src_global generation:  0.0006091594696044922
r_  generation:  0.005477428436279297
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.00028204917907714844
r_  generation:  0.0017604827880859375
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.0018498897552490234
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  0.0001537799835205078
r_  generation:  0.0011532306671142578
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.0007483959197998047
----------------------check_connections_block total spend ----------------------------- 0.06115388870239258
generate_one_block  0.0030698776245117188
generate_one_block  0.005771160125732422
generate_one_block  0.0038003921508789062
generate_one_block  0.0024030208587646484
generate_one_block  0.004527091979980469
generate_one_block  0.007015228271484375
generate_one_block  0.004539966583251953
generate_one_block  0.0031309127807617188
generate_one_block  0.004892826080322266
generate_one_block  0.009649276733398438
generate_one_block  0.008414745330810547
generate_one_block  0.0034875869750976562
generate_one_block  0.0033416748046875
generate_one_block  0.0024569034576416016
generate_one_block  0.0018262863159179688
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014428138732910156  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

connection checking time:  0.08062076568603516
block generation total time  0.10933113098144531
average batch blocks generation time:  0.007288742065429688
block dataloader generation time/epoch 0.23781991004943848
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.004648685455322266  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

torch.Size([2327, 500])
torch.Size([419, 16])
torch.Size([145, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.004823207855224609  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01140451431274414  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

torch.Size([5916, 500])
torch.Size([989, 16])
torch.Size([266, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011795520782470703  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.006873607635498047  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

torch.Size([3503, 500])
torch.Size([968, 16])
torch.Size([159, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.007198810577392578  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005507946014404297  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

torch.Size([2504, 500])
torch.Size([478, 16])
torch.Size([126, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005691051483154297  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008501052856445312  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

torch.Size([4370, 500])
torch.Size([879, 16])
torch.Size([236, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008838653564453125  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008234500885009766  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

torch.Size([4184, 500])
torch.Size([1324, 16])
torch.Size([318, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008763790130615234  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.007061481475830078  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

torch.Size([3594, 500])
torch.Size([907, 16])
torch.Size([158, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.007389545440673828  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005976200103759766  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

torch.Size([3031, 500])
torch.Size([700, 16])
torch.Size([131, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0062198638916015625  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008024215698242188  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

torch.Size([4108, 500])
torch.Size([1011, 16])
torch.Size([116, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008367061614990234  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01471090316772461  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

torch.Size([7622, 500])
torch.Size([2557, 16])
torch.Size([537, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01562643051147461  GigaBytes
Max Memory Allocated: 0.02750539779663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.016079425811767578  GigaBytes
Max Memory Allocated: 0.030099868774414062  GigaBytes

torch.Size([8090, 500])
torch.Size([2109, 16])
torch.Size([378, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.016798019409179688  GigaBytes
Max Memory Allocated: 0.030099868774414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.005417823791503906  GigaBytes
Max Memory Allocated: 0.030099868774414062  GigaBytes

torch.Size([2730, 500])
torch.Size([479, 16])
torch.Size([82, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.005602836608886719  GigaBytes
Max Memory Allocated: 0.030099868774414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.005219459533691406  GigaBytes
Max Memory Allocated: 0.030099868774414062  GigaBytes

torch.Size([2621, 500])
torch.Size([495, 16])
torch.Size([79, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.005410671234130859  GigaBytes
Max Memory Allocated: 0.030099868774414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.005400657653808594  GigaBytes
Max Memory Allocated: 0.030099868774414062  GigaBytes

torch.Size([2595, 500])
torch.Size([396, 16])
torch.Size([115, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.005561351776123047  GigaBytes
Max Memory Allocated: 0.030099868774414062  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.0029048919677734375  GigaBytes
Max Memory Allocated: 0.030099868774414062  GigaBytes

torch.Size([1398, 500])
torch.Size([235, 16])
torch.Size([52, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.003002166748046875  GigaBytes
Max Memory Allocated: 0.030099868774414062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0022614002227783203 |0.0005306879679361979 |0.004106442133585612 |0.00011561711629231771 |0.0040514469146728516 |0.0018532276153564453 |
----------------------------------------------------------pseudo_mini_loss sum 2.059753179550171
Total (block generation + training)time/epoch 0.42327404022216797
Training time/epoch 0.1851646900177002
Training time without block to device /epoch 0.17720437049865723
Training time without total dataloading part /epoch 0.12595582008361816
load block tensor time/epoch 0.033921003341674805
block to device time/epoch 0.007960319519042969
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  75793
Number of first layer input nodes during this epoch:  58593
