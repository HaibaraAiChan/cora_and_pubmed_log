main start at this time 1648530693.4355206
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.200241088867188e-05  GigaBytes
Max Memory Allocated: 7.200241088867188e-05  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0020418167114257812
range selection method range initialization spend 0.00013208389282226562
time for parepare:  4.3392181396484375e-05
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.001729726791381836
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  4.839897155761719e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.38690185546875e-05
----------------------check_connections_block total spend ----------------------------- 0.00279998779296875
generate_one_block  0.001434326171875
generate_one_block  0.0011515617370605469
generate_one_block  0.0010411739349365234
generate_one_block  0.0010273456573486328
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012879371643066406
gen group dst list time:  8.463859558105469e-05
time for parepare:  0.00022721290588378906
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0004951953887939453
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0001876354217529297
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001895427703857422
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00037026405334472656
----------------------check_connections_block total spend ----------------------------- 0.0026388168334960938
generate_one_block  0.0017075538635253906
generate_one_block  0.001268625259399414
generate_one_block  0.0012555122375488281
generate_one_block  0.0014865398406982422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010378360748291016
gen group dst list time:  6.747245788574219e-05
time for parepare:  0.0007162094116210938
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.00034332275390625
mini_batch_src_global generation:  0.0002677440643310547
r_  generation:  0.003128528594970703
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  0.00017070770263671875
r_  generation:  0.001188516616821289
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0010895729064941406
local_output_nid generation:  6.628036499023438e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  0.0001747608184814453
r_  generation:  0.0021593570709228516
----------------------check_connections_block total spend ----------------------------- 0.01212167739868164
generate_one_block  0.0053920745849609375
generate_one_block  0.0024483203887939453
generate_one_block  0.002370119094848633
generate_one_block  0.0036706924438476562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021080970764160156
gen group dst list time:  0.00019931793212890625
time for parepare:  0.0013148784637451172
local_output_nid generation:  0.00025582313537597656
local_in_edges_tensor generation:  0.0008680820465087891
mini_batch_src_global generation:  0.0010433197021484375
r_  generation:  0.009379386901855469
local_output_nid generation:  0.00018644332885742188
local_in_edges_tensor generation:  0.0004398822784423828
mini_batch_src_global generation:  0.0008358955383300781
r_  generation:  0.0061016082763671875
local_output_nid generation:  0.00018072128295898438
local_in_edges_tensor generation:  0.00040912628173828125
mini_batch_src_global generation:  0.0006339550018310547
r_  generation:  0.0059814453125
local_output_nid generation:  0.00026726722717285156
local_in_edges_tensor generation:  0.0005512237548828125
mini_batch_src_global generation:  0.0007910728454589844
r_  generation:  0.008837699890136719
----------------------check_connections_block total spend ----------------------------- 0.04613518714904785
generate_one_block  0.013805150985717773
generate_one_block  0.00936579704284668
generate_one_block  0.009828567504882812
generate_one_block  0.013229846954345703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.200241088867188e-05  GigaBytes
Max Memory Allocated: 7.200241088867188e-05  GigaBytes

connection checking time:  0.060895681381225586
block generation total time  0.06582880020141602
average batch blocks generation time:  0.016457200050354004
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.019965171813964844  GigaBytes
Max Memory Allocated: 0.019965171813964844  GigaBytes

torch.Size([10220, 500])
torch.Size([3927, 16])
torch.Size([986, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.021417617797851562  GigaBytes
Max Memory Allocated: 0.02172231674194336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.016750812530517578  GigaBytes
Max Memory Allocated: 0.0360870361328125  GigaBytes

torch.Size([8812, 500])
torch.Size([2343, 16])
torch.Size([428, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017551898956298828  GigaBytes
Max Memory Allocated: 0.0360870361328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.016731739044189453  GigaBytes
Max Memory Allocated: 0.0360870361328125  GigaBytes

torch.Size([8799, 500])
torch.Size([2285, 16])
torch.Size([495, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017543792724609375  GigaBytes
Max Memory Allocated: 0.0360870361328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.022514820098876953  GigaBytes
Max Memory Allocated: 0.038604736328125  GigaBytes

torch.Size([11850, 500])
torch.Size([3564, 16])
torch.Size([904, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.023804187774658203  GigaBytes
Max Memory Allocated: 0.038604736328125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00641024112701416 |0.08629864454269409 |0.19402021169662476 |0.0001811385154724121 |0.0041697025299072266 |0.0024535655975341797 |
----------------------------------------------------------pseudo_mini_loss sum 2.7976698875427246
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  54970
Number of first layer input nodes during this epoch:  39681
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.0233306884765625  GigaBytes
Max Memory Allocated: 0.038604736328125  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004723072052001953
range selection method range initialization spend 5.14984130859375e-05
time for parepare:  4.6253204345703125e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.3126602172851562e-05
----------------------check_connections_block total spend ----------------------------- 0.0009846687316894531
generate_one_block  0.0012600421905517578
generate_one_block  0.0010411739349365234
generate_one_block  0.001049041748046875
generate_one_block  0.0009753704071044922
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004937648773193359
gen group dst list time:  3.0994415283203125e-05
time for parepare:  0.00022840499877929688
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002415180206298828
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0003979206085205078
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0004432201385498047
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00014090538024902344
----------------------check_connections_block total spend ----------------------------- 0.0026335716247558594
generate_one_block  0.0012860298156738281
generate_one_block  0.0014955997467041016
generate_one_block  0.0015521049499511719
generate_one_block  0.0010988712310791016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009541511535644531
gen group dst list time:  7.700920104980469e-05
time for parepare:  0.0007450580596923828
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.0006136894226074219
mini_batch_src_global generation:  0.0001544952392578125
r_  generation:  0.0012898445129394531
local_output_nid generation:  6.151199340820312e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  0.000301361083984375
r_  generation:  0.002649068832397461
local_output_nid generation:  8.153915405273438e-05
local_in_edges_tensor generation:  0.00024318695068359375
mini_batch_src_global generation:  0.00033545494079589844
r_  generation:  0.0031480789184570312
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  0.00015687942504882812
r_  generation:  0.0008118152618408203
----------------------check_connections_block total spend ----------------------------- 0.013208866119384766
generate_one_block  0.0030024051666259766
generate_one_block  0.004320859909057617
generate_one_block  0.0051229000091552734
generate_one_block  0.001886606216430664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019030570983886719
gen group dst list time:  0.00021409988403320312
time for parepare:  0.0012531280517578125
local_output_nid generation:  0.00016880035400390625
local_in_edges_tensor generation:  0.0006978511810302734
mini_batch_src_global generation:  0.0007190704345703125
r_  generation:  0.00599360466003418
local_output_nid generation:  0.00023627281188964844
local_in_edges_tensor generation:  0.00052642822265625
mini_batch_src_global generation:  0.0010900497436523438
r_  generation:  0.00864100456237793
local_output_nid generation:  0.0003771781921386719
local_in_edges_tensor generation:  0.0007927417755126953
mini_batch_src_global generation:  0.0010650157928466797
r_  generation:  0.012367963790893555
local_output_nid generation:  0.00012755393981933594
local_in_edges_tensor generation:  0.0003104209899902344
mini_batch_src_global generation:  0.0005724430084228516
r_  generation:  0.004293203353881836
----------------------check_connections_block total spend ----------------------------- 0.04712700843811035
generate_one_block  0.009519577026367188
generate_one_block  0.012546539306640625
generate_one_block  0.017386436462402344
generate_one_block  0.006776571273803711
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.0233306884765625  GigaBytes
Max Memory Allocated: 0.038604736328125  GigaBytes

connection checking time:  0.06296944618225098
block generation total time  0.0659945011138916
average batch blocks generation time:  0.0164986252784729
block dataloader generation time/epoch 0.15200328826904297
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.018054485321044922  GigaBytes
Max Memory Allocated: 0.03992748260498047  GigaBytes

torch.Size([9268, 500])
torch.Size([2322, 16])
torch.Size([635, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.018916606903076172  GigaBytes
Max Memory Allocated: 0.03992748260498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.018805980682373047  GigaBytes
Max Memory Allocated: 0.03992748260498047  GigaBytes

torch.Size([9777, 500])
torch.Size([3329, 16])
torch.Size([815, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.02004528045654297  GigaBytes
Max Memory Allocated: 0.03992748260498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.026092052459716797  GigaBytes
Max Memory Allocated: 0.04387950897216797  GigaBytes

torch.Size([13204, 500])
torch.Size([5204, 16])
torch.Size([1079, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.027884483337402344  GigaBytes
Max Memory Allocated: 0.04387950897216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.011724472045898438  GigaBytes
Max Memory Allocated: 0.04387950897216797  GigaBytes

torch.Size([6074, 500])
torch.Size([1366, 16])
torch.Size([314, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.012235164642333984  GigaBytes
Max Memory Allocated: 0.04387950897216797  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005939185619354248 |0.0008107423782348633 |0.004870116710662842 |0.00014084577560424805 |0.002918541431427002 |0.003278970718383789 |
----------------------------------------------------------pseudo_mini_loss sum 2.5107953548431396
Total (block generation + training)time/epoch 0.22028255462646484
Training time/epoch 0.06796836853027344
Training time without block to device /epoch 0.06472539901733398
Training time without total dataloading part /epoch 0.034996986389160156
load block tensor time/epoch 0.023756742477416992
block to device time/epoch 0.003242969512939453
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  53743
Number of first layer input nodes during this epoch:  38323
