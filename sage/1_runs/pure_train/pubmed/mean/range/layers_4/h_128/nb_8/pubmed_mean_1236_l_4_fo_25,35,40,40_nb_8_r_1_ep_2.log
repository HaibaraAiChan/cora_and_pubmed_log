main start at this time 1648530847.9190905
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007309913635253906  GigaBytes
Max Memory Allocated: 0.0007309913635253906  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.002548694610595703
range selection method range initialization spend 9.369850158691406e-05
time for parepare:  4.315376281738281e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0014467239379882812
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.9577484130859375e-05
----------------------check_connections_block total spend ----------------------------- 0.0024690628051757812
generate_one_block  0.0017473697662353516
generate_one_block  0.0011339187622070312
generate_one_block  0.001079559326171875
generate_one_block  0.0010802745819091797
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014564990997314453
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.00022649765014648438
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0003285408020019531
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0003802776336669922
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0002923011779785156
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.0002892017364501953
----------------------check_connections_block total spend ----------------------------- 0.0026900768280029297
generate_one_block  0.001435995101928711
generate_one_block  0.0015327930450439453
generate_one_block  0.0013883113861083984
generate_one_block  0.0014197826385498047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011036396026611328
gen group dst list time:  7.43865966796875e-05
time for parepare:  0.0007569789886474609
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.00030303001403808594
mini_batch_src_global generation:  0.00016069412231445312
r_  generation:  0.001989603042602539
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00022840499877929688
mini_batch_src_global generation:  0.0002601146697998047
r_  generation:  0.0024938583374023438
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  0.00022792816162109375
r_  generation:  0.0021152496337890625
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00023865699768066406
mini_batch_src_global generation:  0.0001780986785888672
r_  generation:  0.0016558170318603516
----------------------check_connections_block total spend ----------------------------- 0.013065814971923828
generate_one_block  0.00360107421875
generate_one_block  0.003984928131103516
generate_one_block  0.0035872459411621094
generate_one_block  0.0028798580169677734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021369457244873047
gen group dst list time:  0.0002148151397705078
time for parepare:  0.0014529228210449219
local_output_nid generation:  0.00019502639770507812
local_in_edges_tensor generation:  0.0007619857788085938
mini_batch_src_global generation:  0.0009043216705322266
r_  generation:  0.007635354995727539
local_output_nid generation:  0.0002422332763671875
local_in_edges_tensor generation:  0.0005457401275634766
mini_batch_src_global generation:  0.0011184215545654297
r_  generation:  0.008523941040039062
local_output_nid generation:  0.00027489662170410156
local_in_edges_tensor generation:  0.0005753040313720703
mini_batch_src_global generation:  0.0009534358978271484
r_  generation:  0.009579658508300781
local_output_nid generation:  0.00024580955505371094
local_in_edges_tensor generation:  0.00048160552978515625
mini_batch_src_global generation:  0.0008296966552734375
r_  generation:  0.007558345794677734
----------------------check_connections_block total spend ----------------------------- 0.05035281181335449
generate_one_block  0.011401653289794922
generate_one_block  0.012823104858398438
generate_one_block  0.013770580291748047
generate_one_block  0.011518001556396484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007309913635253906  GigaBytes
Max Memory Allocated: 0.0007309913635253906  GigaBytes

connection checking time:  0.06610870361328125
block generation total time  0.06934332847595215
average batch blocks generation time:  0.017335832118988037
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.018571853637695312  GigaBytes
Max Memory Allocated: 0.018571853637695312  GigaBytes

torch.Size([8931, 500])
torch.Size([2760, 128])
torch.Size([673, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.024686336517333984  GigaBytes
Max Memory Allocated: 0.027003765106201172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02130270004272461  GigaBytes
Max Memory Allocated: 0.03856945037841797  GigaBytes

torch.Size([10368, 500])
torch.Size([3251, 128])
torch.Size([793, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02848958969116211  GigaBytes
Max Memory Allocated: 0.03856945037841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.02206134796142578  GigaBytes
Max Memory Allocated: 0.041285037994384766  GigaBytes

torch.Size([10895, 500])
torch.Size([3826, 128])
torch.Size([692, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.029899120330810547  GigaBytes
Max Memory Allocated: 0.041285037994384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.021236896514892578  GigaBytes
Max Memory Allocated: 0.041285037994384766  GigaBytes

torch.Size([10447, 500])
torch.Size([2691, 128])
torch.Size([650, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.027193546295166016  GigaBytes
Max Memory Allocated: 0.041285037994384766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009010016918182373 |0.0854722261428833 |0.19696485996246338 |0.00021308660507202148 |0.004605412483215332 |0.003460407257080078 |
----------------------------------------------------------pseudo_mini_loss sum 2.255392551422119
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  56332
Number of first layer input nodes during this epoch:  40641
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.023249149322509766  GigaBytes
Max Memory Allocated: 0.041285037994384766  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004699230194091797
range selection method range initialization spend 5.14984130859375e-05
time for parepare:  4.839897155761719e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.601478576660156e-05
----------------------check_connections_block total spend ----------------------------- 0.0009748935699462891
generate_one_block  0.0013878345489501953
generate_one_block  0.0010571479797363281
generate_one_block  0.0010280609130859375
generate_one_block  0.0010676383972167969
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005278587341308594
gen group dst list time:  3.528594970703125e-05
time for parepare:  0.00023937225341796875
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.000385284423828125
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00024318695068359375
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00022125244140625
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.00044655799865722656
----------------------check_connections_block total spend ----------------------------- 0.0027167797088623047
generate_one_block  0.0015330314636230469
generate_one_block  0.001300811767578125
generate_one_block  0.0012984275817871094
generate_one_block  0.0015919208526611328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009949207305908203
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.0007715225219726562
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.0006561279296875
mini_batch_src_global generation:  0.00028204917907714844
r_  generation:  0.002555370330810547
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  0.0002372264862060547
r_  generation:  0.0017962455749511719
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.000171661376953125
r_  generation:  0.0015609264373779297
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  0.00025534629821777344
r_  generation:  0.002748250961303711
----------------------check_connections_block total spend ----------------------------- 0.01424264907836914
generate_one_block  0.004378557205200195
generate_one_block  0.0031332969665527344
generate_one_block  0.0027704238891601562
generate_one_block  0.004298686981201172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019283294677734375
gen group dst list time:  0.0002460479736328125
time for parepare:  0.00141143798828125
local_output_nid generation:  0.00024127960205078125
local_in_edges_tensor generation:  0.0008542537689208984
mini_batch_src_global generation:  0.0010890960693359375
r_  generation:  0.010085821151733398
local_output_nid generation:  0.00028204917907714844
local_in_edges_tensor generation:  0.0006029605865478516
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.008168935775756836
local_output_nid generation:  0.00022125244140625
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0007150173187255859
r_  generation:  0.006906032562255859
local_output_nid generation:  0.0003058910369873047
local_in_edges_tensor generation:  0.0006749629974365234
mini_batch_src_global generation:  0.0009829998016357422
r_  generation:  0.010452985763549805
----------------------check_connections_block total spend ----------------------------- 0.05367565155029297
generate_one_block  0.014616012573242188
generate_one_block  0.012887239456176758
generate_one_block  0.010978460311889648
generate_one_block  0.013705730438232422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.023249149322509766  GigaBytes
Max Memory Allocated: 0.041285037994384766  GigaBytes

connection checking time:  0.07063508033752441
block generation total time  0.07249259948730469
average batch blocks generation time:  0.018123149871826172
block dataloader generation time/epoch 0.16842079162597656
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.025220870971679688  GigaBytes
Max Memory Allocated: 0.04441404342651367  GigaBytes

torch.Size([11795, 500])
torch.Size([3384, 128])
torch.Size([836, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.032713890075683594  GigaBytes
Max Memory Allocated: 0.04441404342651367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.021507740020751953  GigaBytes
Max Memory Allocated: 0.04441404342651367  GigaBytes

torch.Size([9838, 500])
torch.Size([3401, 128])
torch.Size([559, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.028385639190673828  GigaBytes
Max Memory Allocated: 0.04441404342651367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.020737648010253906  GigaBytes
Max Memory Allocated: 0.04441404342651367  GigaBytes

torch.Size([9442, 500])
torch.Size([2521, 128])
torch.Size([566, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.026454925537109375  GigaBytes
Max Memory Allocated: 0.04441404342651367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.024575233459472656  GigaBytes
Max Memory Allocated: 0.04441404342651367  GigaBytes

torch.Size([11448, 500])
torch.Size([3823, 128])
torch.Size([949, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.033367156982421875  GigaBytes
Max Memory Allocated: 0.04441404342651367  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005761325359344482 |0.0007379055023193359 |0.004335939884185791 |0.00012618303298950195 |0.0034379959106445312 |0.00177764892578125 |
----------------------------------------------------------pseudo_mini_loss sum 1.4445033073425293
Total (block generation + training)time/epoch 0.23334908485412598
Training time/epoch 0.06446361541748047
Training time without block to device /epoch 0.061511993408203125
Training time without total dataloading part /epoch 0.03337812423706055
load block tensor time/epoch 0.02304530143737793
block to device time/epoch 0.0029516220092773438
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  58919
Number of first layer input nodes during this epoch:  42523
