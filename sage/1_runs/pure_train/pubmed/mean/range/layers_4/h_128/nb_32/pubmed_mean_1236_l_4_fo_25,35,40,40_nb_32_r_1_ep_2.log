main start at this time 1648530868.9096518
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007309913635253906  GigaBytes
Max Memory Allocated: 0.0007309913635253906  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.003082275390625
range selection method range initialization spend 8.678436279296875e-05
time for parepare:  4.1484832763671875e-05
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.0011391639709472656
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.430511474609375e-05
----------------------check_connections_block total spend ----------------------------- 0.003898143768310547
generate_one_block  0.0016622543334960938
generate_one_block  0.001055002212524414
generate_one_block  0.0010123252868652344
generate_one_block  0.0009870529174804688
generate_one_block  0.0010030269622802734
generate_one_block  0.0010135173797607422
generate_one_block  0.0010459423065185547
generate_one_block  0.000986337661743164
generate_one_block  0.0010170936584472656
generate_one_block  0.0010068416595458984
generate_one_block  0.0010008811950683594
generate_one_block  0.0009999275207519531
generate_one_block  0.0010094642639160156
generate_one_block  0.0010039806365966797
generate_one_block  0.0009419918060302734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0015697479248046875
gen group dst list time:  7.963180541992188e-05
time for parepare:  0.0002455711364746094
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0001888275146484375
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  5.054473876953125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00027298927307128906
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.151199340820312e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  0.00010442733764648438
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.0001285076141357422
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00016355514526367188
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  7.367134094238281e-05
----------------------check_connections_block total spend ----------------------------- 0.004575490951538086
generate_one_block  0.0011124610900878906
generate_one_block  0.0012576580047607422
generate_one_block  0.0010654926300048828
generate_one_block  0.001066446304321289
generate_one_block  0.0013782978057861328
generate_one_block  0.0011115074157714844
generate_one_block  0.0010783672332763672
generate_one_block  0.0010457038879394531
generate_one_block  0.0010709762573242188
generate_one_block  0.0010745525360107422
generate_one_block  0.0010797977447509766
generate_one_block  0.0010752677917480469
generate_one_block  0.0011551380157470703
generate_one_block  0.001027822494506836
generate_one_block  0.0010328292846679688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011928081512451172
gen group dst list time:  0.00011754035949707031
time for parepare:  0.0007257461547851562
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00026535987854003906
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00028228759765625
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  0.0001289844512939453
r_  generation:  0.0014095306396484375
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.00018072128295898438
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00023603439331054688
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  0.00016450881958007812
r_  generation:  0.002019166946411133
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.0002741813659667969
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00024700164794921875
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0004012584686279297
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0004520416259765625
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003116130828857422
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0009818077087402344
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0004780292510986328
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.0010309219360351562
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.00026917457580566406
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0003643035888671875
----------------------check_connections_block total spend ----------------------------- 0.015779495239257812
generate_one_block  0.0014438629150390625
generate_one_block  0.0028696060180664062
generate_one_block  0.0011217594146728516
generate_one_block  0.0012140274047851562
generate_one_block  0.003440380096435547
generate_one_block  0.0012316703796386719
generate_one_block  0.0012111663818359375
generate_one_block  0.0014483928680419922
generate_one_block  0.0014760494232177734
generate_one_block  0.0013098716735839844
generate_one_block  0.00217437744140625
generate_one_block  0.0014529228210449219
generate_one_block  0.0024755001068115234
generate_one_block  0.0012350082397460938
generate_one_block  0.0013616085052490234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001959085464477539
gen group dst list time:  0.0002918243408203125
time for parepare:  0.0015671253204345703
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00047016143798828125
mini_batch_src_global generation:  0.00019478797912597656
r_  generation:  0.0015850067138671875
local_output_nid generation:  0.0001354217529296875
local_in_edges_tensor generation:  0.00039577484130859375
mini_batch_src_global generation:  0.0007717609405517578
r_  generation:  0.005980730056762695
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  0.0001964569091796875
r_  generation:  0.0006749629974365234
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  0.00011539459228515625
r_  generation:  0.0012269020080566406
local_output_nid generation:  0.00019168853759765625
local_in_edges_tensor generation:  0.00044155120849609375
mini_batch_src_global generation:  0.0006122589111328125
r_  generation:  0.0069730281829833984
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.0002465248107910156
r_  generation:  0.0011677742004394531
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  0.0001277923583984375
r_  generation:  0.0012128353118896484
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.00023698806762695312
mini_batch_src_global generation:  0.0002765655517578125
r_  generation:  0.002983570098876953
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.0002713203430175781
r_  generation:  0.0025076866149902344
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  0.0001900196075439453
r_  generation:  0.0015616416931152344
local_output_nid generation:  0.00016570091247558594
local_in_edges_tensor generation:  0.0003719329833984375
mini_batch_src_global generation:  0.0004227161407470703
r_  generation:  0.005213022232055664
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  0.00030112266540527344
r_  generation:  0.0021979808807373047
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.000339508056640625
mini_batch_src_global generation:  0.0004725456237792969
r_  generation:  0.00510859489440918
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  0.0002865791320800781
r_  generation:  0.0019009113311767578
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  0.00018262863159179688
r_  generation:  0.001645803451538086
----------------------check_connections_block total spend ----------------------------- 0.06429624557495117
generate_one_block  0.0038042068481445312
generate_one_block  0.008700370788574219
generate_one_block  0.0016608238220214844
generate_one_block  0.002490520477294922
generate_one_block  0.010019779205322266
generate_one_block  0.002403736114501953
generate_one_block  0.0026044845581054688
generate_one_block  0.004868030548095703
generate_one_block  0.0048329830169677734
generate_one_block  0.002999544143676758
generate_one_block  0.008411169052124023
generate_one_block  0.0038650035858154297
generate_one_block  0.007829666137695312
generate_one_block  0.003247976303100586
generate_one_block  0.0030794143676757812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007309913635253906  GigaBytes
Max Memory Allocated: 0.0007309913635253906  GigaBytes

connection checking time:  0.08465123176574707
block generation total time  0.11291623115539551
average batch blocks generation time:  0.007527748743693034
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005852222442626953  GigaBytes
Max Memory Allocated: 0.005852222442626953  GigaBytes

torch.Size([2723, 500])
torch.Size([577, 128])
torch.Size([118, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0070972442626953125  GigaBytes
Max Memory Allocated: 0.00801992416381836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.014294624328613281  GigaBytes
Max Memory Allocated: 0.019163131713867188  GigaBytes

torch.Size([6781, 500])
torch.Size([1885, 128])
torch.Size([408, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.018337726593017578  GigaBytes
Max Memory Allocated: 0.020400047302246094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0035419464111328125  GigaBytes
Max Memory Allocated: 0.020400047302246094  GigaBytes

torch.Size([1107, 500])
torch.Size([233, 128])
torch.Size([73, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004108428955078125  GigaBytes
Max Memory Allocated: 0.020400047302246094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.005702018737792969  GigaBytes
Max Memory Allocated: 0.020400047302246094  GigaBytes

torch.Size([2256, 500])
torch.Size([408, 128])
torch.Size([98, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006619930267333984  GigaBytes
Max Memory Allocated: 0.020400047302246094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.016102313995361328  GigaBytes
Max Memory Allocated: 0.020400047302246094  GigaBytes

torch.Size([7728, 500])
torch.Size([2505, 128])
torch.Size([536, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.021495342254638672  GigaBytes
Max Memory Allocated: 0.023612499237060547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.005190849304199219  GigaBytes
Max Memory Allocated: 0.023612499237060547  GigaBytes

torch.Size([1983, 500])
torch.Size([388, 128])
torch.Size([98, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.006066799163818359  GigaBytes
Max Memory Allocated: 0.023612499237060547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.006522655487060547  GigaBytes
Max Memory Allocated: 0.023612499237060547  GigaBytes

torch.Size([2696, 500])
torch.Size([434, 128])
torch.Size([119, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.007526397705078125  GigaBytes
Max Memory Allocated: 0.023612499237060547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.009497642517089844  GigaBytes
Max Memory Allocated: 0.023612499237060547  GigaBytes

torch.Size([4264, 500])
torch.Size([970, 128])
torch.Size([104, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011355876922607422  GigaBytes
Max Memory Allocated: 0.023612499237060547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.010332584381103516  GigaBytes
Max Memory Allocated: 0.023612499237060547  GigaBytes

torch.Size([4719, 500])
torch.Size([816, 128])
torch.Size([170, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012069225311279297  GigaBytes
Max Memory Allocated: 0.023612499237060547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.007193088531494141  GigaBytes
Max Memory Allocated: 0.023612499237060547  GigaBytes

torch.Size([3051, 500])
torch.Size([567, 128])
torch.Size([147, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.008464813232421875  GigaBytes
Max Memory Allocated: 0.023612499237060547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01459646224975586  GigaBytes
Max Memory Allocated: 0.023612499237060547  GigaBytes

torch.Size([6963, 500])
torch.Size([2101, 128])
torch.Size([239, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01858663558959961  GigaBytes
Max Memory Allocated: 0.023612499237060547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.0092315673828125  GigaBytes
Max Memory Allocated: 0.023612499237060547  GigaBytes

torch.Size([4134, 500])
torch.Size([785, 128])
torch.Size([198, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011020660400390625  GigaBytes
Max Memory Allocated: 0.023612499237060547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.017254352569580078  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([8282, 500])
torch.Size([1809, 128])
torch.Size([376, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.021085262298583984  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.006622791290283203  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([2741, 500])
torch.Size([452, 128])
torch.Size([98, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.007607936859130859  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.007289409637451172  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([3100, 500])
torch.Size([576, 128])
torch.Size([138, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008559703826904297  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003647486368815104 |0.023331244786580402 |0.0556883970896403 |0.00013939539591471353 |0.00396734873453776 |0.0027680397033691406 |
----------------------------------------------------------pseudo_mini_loss sum 2.397002935409546
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  80311
Number of first layer input nodes during this epoch:  62528
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.00887298583984375  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00045871734619140625
range selection method range initialization spend 5.1975250244140625e-05
time for parepare:  4.410743713378906e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  2.193450927734375e-05
----------------------check_connections_block total spend ----------------------------- 0.00257110595703125
generate_one_block  0.001294851303100586
generate_one_block  0.0010538101196289062
generate_one_block  0.0009918212890625
generate_one_block  0.001027822494506836
generate_one_block  0.0010025501251220703
generate_one_block  0.0009915828704833984
generate_one_block  0.0010001659393310547
generate_one_block  0.0011098384857177734
generate_one_block  0.0009856224060058594
generate_one_block  0.000982046127319336
generate_one_block  0.0010085105895996094
generate_one_block  0.001001596450805664
generate_one_block  0.0009410381317138672
generate_one_block  0.0009906291961669922
generate_one_block  0.0009589195251464844
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005462169647216797
gen group dst list time:  7.724761962890625e-05
time for parepare:  0.00024127960205078125
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0001838207244873047
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00012087821960449219
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.103515625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  8.463859558105469e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.130073547363281e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.96453857421875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001735687255859375
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00018835067749023438
----------------------check_connections_block total spend ----------------------------- 0.004584789276123047
generate_one_block  0.0012536048889160156
generate_one_block  0.0011529922485351562
generate_one_block  0.0010380744934082031
generate_one_block  0.001069784164428711
generate_one_block  0.00116729736328125
generate_one_block  0.001093149185180664
generate_one_block  0.0010800361633300781
generate_one_block  0.00110626220703125
generate_one_block  0.0010623931884765625
generate_one_block  0.0010433197021484375
generate_one_block  0.0010383129119873047
generate_one_block  0.0011968612670898438
generate_one_block  0.0009837150573730469
generate_one_block  0.001068115234375
generate_one_block  0.001173257827758789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011296272277832031
gen group dst list time:  0.00012230873107910156
time for parepare:  0.0007112026214599609
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00030159950256347656
mini_batch_src_global generation:  0.00015974044799804688
r_  generation:  0.001413106918334961
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  0.00010704994201660156
r_  generation:  0.0006814002990722656
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0002162456512451172
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0004360675811767578
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0005030632019042969
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004506111145019531
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0006151199340820312
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0004477500915527344
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00019216537475585938
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0005395412445068359
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0005474090576171875
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0008502006530761719
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0001266002655029297
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0005388259887695312
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  0.0001347064971923828
r_  generation:  0.0013737678527832031
----------------------check_connections_block total spend ----------------------------- 0.0159757137298584
generate_one_block  0.0027778148651123047
generate_one_block  0.001859426498413086
generate_one_block  0.001230478286743164
generate_one_block  0.001542806625366211
generate_one_block  0.0015261173248291016
generate_one_block  0.0015697479248046875
generate_one_block  0.0017271041870117188
generate_one_block  0.0015010833740234375
generate_one_block  0.0012099742889404297
generate_one_block  0.0015568733215332031
generate_one_block  0.0016090869903564453
generate_one_block  0.0020732879638671875
generate_one_block  0.0010824203491210938
generate_one_block  0.0015497207641601562
generate_one_block  0.0026733875274658203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002048492431640625
gen group dst list time:  0.0003077983856201172
time for parepare:  0.0014369487762451172
local_output_nid generation:  0.00011897087097167969
local_in_edges_tensor generation:  0.0005929470062255859
mini_batch_src_global generation:  0.0006091594696044922
r_  generation:  0.004917144775390625
local_output_nid generation:  0.00011658668518066406
local_in_edges_tensor generation:  0.00029277801513671875
mini_batch_src_global generation:  0.0005028247833251953
r_  generation:  0.003812551498413086
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  0.0001678466796875
r_  generation:  0.0009539127349853516
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  0.0002613067626953125
r_  generation:  0.0029630661010742188
local_output_nid generation:  9.131431579589844e-05
local_in_edges_tensor generation:  0.00026416778564453125
mini_batch_src_global generation:  0.00032830238342285156
r_  generation:  0.003075122833251953
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.0002391338348388672
mini_batch_src_global generation:  0.0002620220184326172
r_  generation:  0.0024797916412353516
local_output_nid generation:  0.00012564659118652344
local_in_edges_tensor generation:  0.0003037452697753906
mini_batch_src_global generation:  0.0003275871276855469
r_  generation:  0.003476858139038086
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.00022363662719726562
mini_batch_src_global generation:  0.000232696533203125
r_  generation:  0.001912832260131836
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  0.00014591217041015625
r_  generation:  0.0010907649993896484
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.0002932548522949219
r_  generation:  0.0033636093139648438
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.0002415180206298828
mini_batch_src_global generation:  0.00030422210693359375
r_  generation:  0.002583742141723633
local_output_nid generation:  0.0001201629638671875
local_in_edges_tensor generation:  0.0002999305725097656
mini_batch_src_global generation:  0.0003008842468261719
r_  generation:  0.003126859664916992
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  0.00013899803161621094
r_  generation:  0.0005998611450195312
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.00022602081298828125
mini_batch_src_global generation:  0.00020742416381835938
r_  generation:  0.0024154186248779297
local_output_nid generation:  0.00015091896057128906
local_in_edges_tensor generation:  0.0003509521484375
mini_batch_src_global generation:  0.0005118846893310547
r_  generation:  0.005207061767578125
----------------------check_connections_block total spend ----------------------------- 0.06462669372558594
generate_one_block  0.00774383544921875
generate_one_block  0.006185770034790039
generate_one_block  0.001966238021850586
generate_one_block  0.00496673583984375
generate_one_block  0.0052318572998046875
generate_one_block  0.0042798519134521484
generate_one_block  0.005675554275512695
generate_one_block  0.0033049583435058594
generate_one_block  0.002436399459838867
generate_one_block  0.005571603775024414
generate_one_block  0.004367351531982422
generate_one_block  0.005394935607910156
generate_one_block  0.0016922950744628906
generate_one_block  0.004446744918823242
generate_one_block  0.008106231689453125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.00887298583984375  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

connection checking time:  0.08518719673156738
block generation total time  0.11338686943054199
average batch blocks generation time:  0.007559124628702799
block dataloader generation time/epoch 0.24174809455871582
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.012279033660888672  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([4935, 500])
torch.Size([1438, 128])
torch.Size([338, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01544809341430664  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015250205993652344  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([6560, 500])
torch.Size([1239, 128])
torch.Size([299, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.017965316772460938  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.0060214996337890625  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([1655, 500])
torch.Size([286, 128])
torch.Size([89, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.006717205047607422  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012631893157958984  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([5166, 500])
torch.Size([939, 128])
torch.Size([139, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01451253890991211  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.009760856628417969  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([3623, 500])
torch.Size([1014, 128])
torch.Size([119, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011721611022949219  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.010279178619384766  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([3912, 500])
torch.Size([927, 128])
torch.Size([152, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012176990509033203  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013220787048339844  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([5475, 500])
torch.Size([1460, 128])
torch.Size([193, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016056060791015625  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.00824737548828125  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([2831, 500])
torch.Size([793, 128])
torch.Size([150, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.009898662567138672  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.00730133056640625  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([2337, 500])
torch.Size([338, 128])
torch.Size([88, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.008068561553955078  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013155937194824219  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([5439, 500])
torch.Size([949, 128])
torch.Size([194, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015175342559814453  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.010345458984375  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([3944, 500])
torch.Size([885, 128])
torch.Size([179, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01220846176147461  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011793136596679688  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([4711, 500])
torch.Size([1504, 128])
torch.Size([334, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015067577362060547  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.006341457366943359  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([1329, 500])
torch.Size([192, 128])
torch.Size([48, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.0067901611328125  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011581897735595703  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([4609, 500])
torch.Size([838, 128])
torch.Size([247, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013514041900634766  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01355600357055664  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

torch.Size([5613, 500])
torch.Size([1787, 128])
torch.Size([364, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.017345428466796875  GigaBytes
Max Memory Allocated: 0.024785518646240234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0023320515950520835 |0.0006368160247802734 |0.004625558853149414 |0.00012275377909342448 |0.0041043758392333984 |0.0020558834075927734 |
----------------------------------------------------------pseudo_mini_loss sum 1.8688256740570068
Total (block generation + training)time/epoch 0.44091224670410156
Training time/epoch 0.19893717765808105
Training time without block to device /epoch 0.18938493728637695
Training time without total dataloading part /epoch 0.13484621047973633
load block tensor time/epoch 0.03498077392578125
block to device time/epoch 0.009552240371704102
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  80018
Number of first layer input nodes during this epoch:  62139
