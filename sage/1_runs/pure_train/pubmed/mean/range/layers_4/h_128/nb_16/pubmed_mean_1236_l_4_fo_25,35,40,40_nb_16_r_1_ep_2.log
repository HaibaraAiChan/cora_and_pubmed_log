main start at this time 1648530858.3047352
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007309913635253906  GigaBytes
Max Memory Allocated: 0.0007309913635253906  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0015149116516113281
range selection method range initialization spend 9.584426879882812e-05
time for parepare:  5.1975250244140625e-05
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00139617919921875
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.003340005874633789
generate_one_block  0.0015265941619873047
generate_one_block  0.0012936592102050781
generate_one_block  0.001291513442993164
generate_one_block  0.00127410888671875
generate_one_block  0.0012602806091308594
generate_one_block  0.0012848377227783203
generate_one_block  0.0012731552124023438
generate_one_block  0.0011644363403320312
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008614063262939453
gen group dst list time:  6.67572021484375e-05
time for parepare:  0.0002899169921875
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0002734661102294922
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0003037452697753906
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00011897087097167969
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0003657341003417969
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.0001316070556640625
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001461505889892578
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00024700164794921875
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00023603439331054688
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  9.703636169433594e-05
----------------------check_connections_block total spend ----------------------------- 0.0041539669036865234
generate_one_block  0.0016796588897705078
generate_one_block  0.0013751983642578125
generate_one_block  0.0017337799072265625
generate_one_block  0.0014026165008544922
generate_one_block  0.001453399658203125
generate_one_block  0.0015742778778076172
generate_one_block  0.0013568401336669922
generate_one_block  0.001054525375366211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011477470397949219
gen group dst list time:  0.00011897087097167969
time for parepare:  0.0009481906890869141
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.0003714561462402344
mini_batch_src_global generation:  0.0001957416534423828
r_  generation:  0.0020165443420410156
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  0.00010323524475097656
r_  generation:  0.0004923343658447266
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  0.00023889541625976562
r_  generation:  0.0025975704193115234
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.00014352798461914062
r_  generation:  0.0008084774017333984
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.0008478164672851562
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  0.0001659393310546875
r_  generation:  0.0016682147979736328
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  0.00017595291137695312
r_  generation:  0.001340627670288086
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0003561973571777344
----------------------check_connections_block total spend ----------------------------- 0.01709580421447754
generate_one_block  0.003137826919555664
generate_one_block  0.0013854503631591797
generate_one_block  0.0035791397094726562
generate_one_block  0.0019137859344482422
generate_one_block  0.0017404556274414062
generate_one_block  0.0027484893798828125
generate_one_block  0.0024538040161132812
generate_one_block  0.0013704299926757812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0023310184478759766
gen group dst list time:  0.0003390312194824219
time for parepare:  0.001890420913696289
local_output_nid generation:  0.0002315044403076172
local_in_edges_tensor generation:  0.0007975101470947266
mini_batch_src_global generation:  0.0010418891906738281
r_  generation:  0.0073032379150390625
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  0.0003440380096435547
r_  generation:  0.0019893646240234375
local_output_nid generation:  0.00021219253540039062
local_in_edges_tensor generation:  0.0004684925079345703
mini_batch_src_global generation:  0.0006587505340576172
r_  generation:  0.00697779655456543
local_output_nid generation:  0.00011467933654785156
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  0.0005190372467041016
r_  generation:  0.004059314727783203
local_output_nid generation:  0.00010538101196289062
local_in_edges_tensor generation:  0.0002701282501220703
mini_batch_src_global generation:  0.00034689903259277344
r_  generation:  0.003465414047241211
local_output_nid generation:  0.00021600723266601562
local_in_edges_tensor generation:  0.0004379749298095703
mini_batch_src_global generation:  0.0005540847778320312
r_  generation:  0.006478786468505859
local_output_nid generation:  0.0001900196075439453
local_in_edges_tensor generation:  0.00039577484130859375
mini_batch_src_global generation:  0.0006415843963623047
r_  generation:  0.006289243698120117
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  0.00030159950256347656
r_  generation:  0.0017998218536376953
----------------------check_connections_block total spend ----------------------------- 0.05944252014160156
generate_one_block  0.010361671447753906
generate_one_block  0.0032575130462646484
generate_one_block  0.011063814163208008
generate_one_block  0.006387233734130859
generate_one_block  0.005964756011962891
generate_one_block  0.009676694869995117
generate_one_block  0.009776115417480469
generate_one_block  0.0031490325927734375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007309913635253906  GigaBytes
Max Memory Allocated: 0.0007309913635253906  GigaBytes

connection checking time:  0.08069229125976562
block generation total time  0.08959650993347168
average batch blocks generation time:  0.01119956374168396
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.01658916473388672  GigaBytes
Max Memory Allocated: 0.01658916473388672  GigaBytes

torch.Size([7946, 500])
torch.Size([2334, 128])
torch.Size([526, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.021651744842529297  GigaBytes
Max Memory Allocated: 0.02391815185546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.007517337799072266  GigaBytes
Max Memory Allocated: 0.02391815185546875  GigaBytes

torch.Size([3222, 500])
torch.Size([640, 128])
torch.Size([171, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.008989334106445312  GigaBytes
Max Memory Allocated: 0.02391815185546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.017342090606689453  GigaBytes
Max Memory Allocated: 0.02391815185546875  GigaBytes

torch.Size([8114, 500])
torch.Size([2628, 128])
torch.Size([614, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023084640502929688  GigaBytes
Max Memory Allocated: 0.02518320083618164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013071060180664062  GigaBytes
Max Memory Allocated: 0.028566837310791016  GigaBytes

torch.Size([6164, 500])
torch.Size([1382, 128])
torch.Size([221, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01588153839111328  GigaBytes
Max Memory Allocated: 0.028566837310791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013007164001464844  GigaBytes
Max Memory Allocated: 0.028566837310791016  GigaBytes

torch.Size([6139, 500])
torch.Size([1224, 128])
torch.Size([298, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.0157012939453125  GigaBytes
Max Memory Allocated: 0.028566837310791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01780414581298828  GigaBytes
Max Memory Allocated: 0.029022216796875  GigaBytes

torch.Size([8658, 500])
torch.Size([2701, 128])
torch.Size([436, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.023265361785888672  GigaBytes
Max Memory Allocated: 0.029022216796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.019282817840576172  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

torch.Size([9455, 500])
torch.Size([2193, 128])
torch.Size([473, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02484416961669922  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.0073909759521484375  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

torch.Size([3154, 500])
torch.Size([575, 128])
torch.Size([138, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.00866079330444336  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009227782487869263 |0.04288575053215027 |0.0999293327331543 |0.0001493692398071289 |0.004106193780899048 |0.002676248550415039 |
----------------------------------------------------------pseudo_mini_loss sum 2.2497010231018066
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  69762
Number of first layer input nodes during this epoch:  52852
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.008976459503173828  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000492095947265625
range selection method range initialization spend 4.982948303222656e-05
time for parepare:  4.744529724121094e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0002741813659667969
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.193450927734375e-05
----------------------check_connections_block total spend ----------------------------- 0.0018537044525146484
generate_one_block  0.0014009475708007812
generate_one_block  0.0010595321655273438
generate_one_block  0.0010023117065429688
generate_one_block  0.001039743423461914
generate_one_block  0.0010128021240234375
generate_one_block  0.0010230541229248047
generate_one_block  0.0010204315185546875
generate_one_block  0.0010280609130859375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000514984130859375
gen group dst list time:  4.887580871582031e-05
time for parepare:  0.0002529621124267578
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00028777122497558594
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00011730194091796875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.0001347064971923828
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00014162063598632812
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00011444091796875
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00024199485778808594
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001266002655029297
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00018525123596191406
----------------------check_connections_block total spend ----------------------------- 0.0034575462341308594
generate_one_block  0.0013811588287353516
generate_one_block  0.0012166500091552734
generate_one_block  0.001172780990600586
generate_one_block  0.0011754035949707031
generate_one_block  0.0011625289916992188
generate_one_block  0.0013165473937988281
generate_one_block  0.0011506080627441406
generate_one_block  0.001230478286743164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012323856353759766
gen group dst list time:  9.393692016601562e-05
time for parepare:  0.0007724761962890625
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.0003001689910888672
mini_batch_src_global generation:  0.00021004676818847656
r_  generation:  0.002058744430541992
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  0.00011777877807617188
r_  generation:  0.000629425048828125
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  0.000102996826171875
r_  generation:  0.0009393692016601562
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  0.0010232925415039062
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0006952285766601562
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.001378774642944336
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  9.584426879882812e-05
r_  generation:  0.0006570816040039062
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  0.00013637542724609375
r_  generation:  0.00136566162109375
----------------------check_connections_block total spend ----------------------------- 0.014648914337158203
generate_one_block  0.003493070602416992
generate_one_block  0.0016930103302001953
generate_one_block  0.0020318031311035156
generate_one_block  0.002284526824951172
generate_one_block  0.0017499923706054688
generate_one_block  0.0025992393493652344
generate_one_block  0.00176239013671875
generate_one_block  0.0026290416717529297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017232894897460938
gen group dst list time:  0.0002777576446533203
time for parepare:  0.0015003681182861328
local_output_nid generation:  0.00020360946655273438
local_in_edges_tensor generation:  0.0007474422454833984
mini_batch_src_global generation:  0.0009925365447998047
r_  generation:  0.008157014846801758
local_output_nid generation:  0.00011086463928222656
local_in_edges_tensor generation:  0.0003371238708496094
mini_batch_src_global generation:  0.0005848407745361328
r_  generation:  0.004000663757324219
local_output_nid generation:  0.0001652240753173828
local_in_edges_tensor generation:  0.0003802776336669922
mini_batch_src_global generation:  0.0004582405090332031
r_  generation:  0.00482630729675293
local_output_nid generation:  0.00017905235290527344
local_in_edges_tensor generation:  0.00038051605224609375
mini_batch_src_global generation:  0.00043773651123046875
r_  generation:  0.004705190658569336
local_output_nid generation:  0.00011420249938964844
local_in_edges_tensor generation:  0.0002887248992919922
mini_batch_src_global generation:  0.0004336833953857422
r_  generation:  0.004106283187866211
local_output_nid generation:  0.00019097328186035156
local_in_edges_tensor generation:  0.00040268898010253906
mini_batch_src_global generation:  0.0005011558532714844
r_  generation:  0.00548553466796875
local_output_nid generation:  9.298324584960938e-05
local_in_edges_tensor generation:  0.000255584716796875
mini_batch_src_global generation:  0.0003597736358642578
r_  generation:  0.0029909610748291016
local_output_nid generation:  0.00016164779663085938
local_in_edges_tensor generation:  0.00035643577575683594
mini_batch_src_global generation:  0.0004737377166748047
r_  generation:  0.005276679992675781
----------------------check_connections_block total spend ----------------------------- 0.0597074031829834
generate_one_block  0.01210784912109375
generate_one_block  0.0061070919036865234
generate_one_block  0.007220745086669922
generate_one_block  0.007114410400390625
generate_one_block  0.0065653324127197266
generate_one_block  0.008478403091430664
generate_one_block  0.0049419403076171875
generate_one_block  0.0077168941497802734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.008976459503173828  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

connection checking time:  0.07781386375427246
block generation total time  0.0883018970489502
average batch blocks generation time:  0.011037737131118774Using backend: pytorch

block dataloader generation time/epoch 0.19796514511108398
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.022724628448486328  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

torch.Size([10324, 500])
torch.Size([2620, 128])
torch.Size([631, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.028488636016845703  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.014067649841308594  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

torch.Size([5926, 500])
torch.Size([1195, 128])
torch.Size([228, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.016583919525146484  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.01435708999633789  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

torch.Size([6060, 500])
torch.Size([1794, 128])
torch.Size([269, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.017955303192138672  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.015811920166015625  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

torch.Size([6843, 500])
torch.Size([2064, 128])
torch.Size([339, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.019969940185546875  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.015160560607910156  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

torch.Size([6503, 500])
torch.Size([1215, 128])
torch.Size([280, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.01781177520751953  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.017482280731201172  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

torch.Size([7723, 500])
torch.Size([2321, 128])
torch.Size([511, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.022629737854003906  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.013072490692138672  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

torch.Size([5403, 500])
torch.Size([990, 128])
torch.Size([293, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.01537322998046875  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.013745307922363281  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

torch.Size([5714, 500])
torch.Size([1798, 128])
torch.Size([371, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.017568111419677734  GigaBytes
Max Memory Allocated: 0.03519868850708008  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0038656294345855713 |0.0007453262805938721 |0.005055636167526245 |0.00012695789337158203 |0.004270374774932861 |0.002068042755126953 |
----------------------------------------------------------pseudo_mini_loss sum 1.4702271223068237
Total (block generation + training)time/epoch 0.32395124435424805
Training time/epoch 0.1257457733154297
Training time without block to device /epoch 0.11978316307067871
Training time without total dataloading part /epoch 0.07769179344177246
load block tensor time/epoch 0.03092503547668457
block to device time/epoch 0.0059626102447509766
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  71772
Number of first layer input nodes during this epoch:  54496
