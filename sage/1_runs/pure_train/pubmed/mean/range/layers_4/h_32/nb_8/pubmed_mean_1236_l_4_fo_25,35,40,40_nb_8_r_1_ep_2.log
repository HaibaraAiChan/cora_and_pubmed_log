main start at this time 1648530743.3316138
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014257431030273438  GigaBytes
Max Memory Allocated: 0.00014257431030273438  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0015897750854492188
range selection method range initialization spend 0.00010395050048828125
time for parepare:  4.4345855712890625e-05
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0014338493347167969
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.4332275390625e-05
----------------------check_connections_block total spend ----------------------------- 0.0024094581604003906
generate_one_block  0.0011858940124511719
generate_one_block  0.0011162757873535156
generate_one_block  0.0010161399841308594
generate_one_block  0.0009860992431640625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008318424224853516
gen group dst list time:  3.337860107421875e-05
time for parepare:  0.00022864341735839844
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.000438690185546875
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00022149085998535156
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0003466606140136719
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0002536773681640625
----------------------check_connections_block total spend ----------------------------- 0.0026323795318603516
generate_one_block  0.0016314983367919922
generate_one_block  0.0012712478637695312
generate_one_block  0.0013854503631591797
generate_one_block  0.0013470649719238281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010018348693847656
gen group dst list time:  7.009506225585938e-05
time for parepare:  0.0007405281066894531
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.0003466606140136719
mini_batch_src_global generation:  0.00022721290588378906
r_  generation:  0.0027205944061279297
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.0014607906341552734
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.00022482872009277344
mini_batch_src_global generation:  0.00020313262939453125
r_  generation:  0.0021409988403320312
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.0001819133758544922
r_  generation:  0.0015854835510253906
----------------------check_connections_block total spend ----------------------------- 0.012604713439941406
generate_one_block  0.004888057708740234
generate_one_block  0.002743959426879883
generate_one_block  0.0038025379180908203
generate_one_block  0.002967357635498047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002024412155151367
gen group dst list time:  0.00023984909057617188
time for parepare:  0.001369476318359375
local_output_nid generation:  0.0002739429473876953
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0010986328125
r_  generation:  0.010533332824707031
local_output_nid generation:  0.00019407272338867188
local_in_edges_tensor generation:  0.0004379749298095703
mini_batch_src_global generation:  0.0009641647338867188
r_  generation:  0.0069844722747802734
local_output_nid generation:  0.00022649765014648438
local_in_edges_tensor generation:  0.0004832744598388672
mini_batch_src_global generation:  0.0007774829864501953
r_  generation:  0.007630109786987305
local_output_nid generation:  0.00021839141845703125
local_in_edges_tensor generation:  0.00045871734619140625
mini_batch_src_global generation:  0.0006535053253173828
r_  generation:  0.006433010101318359
----------------------check_connections_block total spend ----------------------------- 0.04751110076904297
generate_one_block  0.015097856521606445
generate_one_block  0.01117849349975586
generate_one_block  0.011747121810913086
generate_one_block  0.009503841400146484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014257431030273438  GigaBytes
Max Memory Allocated: 0.00014257431030273438  GigaBytes

connection checking time:  0.06274819374084473
block generation total time  0.06756448745727539
average batch blocks generation time:  0.016891121864318848
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.022000789642333984  GigaBytes
Max Memory Allocated: 0.022000789642333984  GigaBytes

torch.Size([11539, 500])
torch.Size([4382, 32])
torch.Size([997, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.024680137634277344  GigaBytes
Max Memory Allocated: 0.025824546813964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.016710281372070312  GigaBytes
Max Memory Allocated: 0.037972450256347656  GigaBytes

torch.Size([8695, 500])
torch.Size([2281, 32])
torch.Size([516, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.018144607543945312  GigaBytes
Max Memory Allocated: 0.037972450256347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.018009185791015625  GigaBytes
Max Memory Allocated: 0.037972450256347656  GigaBytes

torch.Size([9363, 500])
torch.Size([2902, 32])
torch.Size([702, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.019861221313476562  GigaBytes
Max Memory Allocated: 0.037972450256347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.018351078033447266  GigaBytes
Max Memory Allocated: 0.037972450256347656  GigaBytes

torch.Size([9582, 500])
torch.Size([2808, 32])
torch.Size([625, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.020049571990966797  GigaBytes
Max Memory Allocated: 0.037972450256347656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011735916137695312 |0.08455395698547363 |0.1948581337928772 |0.000156402587890625 |0.005188941955566406 |0.0035088062286376953 |
----------------------------------------------------------pseudo_mini_loss sum 2.713207244873047
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  54747
Number of first layer input nodes during this epoch:  39179
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.019130706787109375  GigaBytes
Max Memory Allocated: 0.037972450256347656  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007319450378417969
range selection method range initialization spend 8.296966552734375e-05
time for parepare:  7.390975952148438e-05
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0002429485321044922
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  6.556510925292969e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.267692565917969e-05
----------------------check_connections_block total spend ----------------------------- 0.001409292221069336
generate_one_block  0.0016694068908691406
generate_one_block  0.0011982917785644531
generate_one_block  0.001195669174194336
generate_one_block  0.0011925697326660156
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006356239318847656
gen group dst list time:  4.100799560546875e-05
time for parepare:  0.00029277801513671875
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.0003979206085205078
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0003654956817626953
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0003693103790283203
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0002560615539550781
----------------------check_connections_block total spend ----------------------------- 0.00312042236328125
generate_one_block  0.0016405582427978516
generate_one_block  0.0015916824340820312
generate_one_block  0.0016016960144042969
generate_one_block  0.001425027847290039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011050701141357422
gen group dst list time:  9.1552734375e-05
time for parepare:  0.0007846355438232422
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.0007312297821044922
mini_batch_src_global generation:  0.00036835670471191406
r_  generation:  0.002642393112182617
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.00024819374084472656
mini_batch_src_global generation:  0.0003342628479003906
r_  generation:  0.0025510787963867188
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  0.0002636909484863281
r_  generation:  0.0022597312927246094
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  0.00017070770263671875
r_  generation:  0.001360177993774414
----------------------check_connections_block total spend ----------------------------- 0.014764070510864258
generate_one_block  0.004266500473022461
generate_one_block  0.003906726837158203
generate_one_block  0.0036301612854003906
generate_one_block  0.002772808074951172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017621517181396484
gen group dst list time:  0.00025200843811035156
time for parepare:  0.001451253890991211
local_output_nid generation:  0.00028705596923828125
local_in_edges_tensor generation:  0.0007574558258056641
mini_batch_src_global generation:  0.0010597705841064453
r_  generation:  0.00953817367553711
local_output_nid generation:  0.0002620220184326172
local_in_edges_tensor generation:  0.0005674362182617188
mini_batch_src_global generation:  0.0011475086212158203
r_  generation:  0.008185386657714844
local_output_nid generation:  0.0003006458282470703
local_in_edges_tensor generation:  0.0006191730499267578
mini_batch_src_global generation:  0.0009071826934814453
r_  generation:  0.008565664291381836
local_output_nid generation:  0.00022220611572265625
local_in_edges_tensor generation:  0.0004379749298095703
mini_batch_src_global generation:  0.0005843639373779297
r_  generation:  0.0054934024810791016
----------------------check_connections_block total spend ----------------------------- 0.04845571517944336
generate_one_block  0.013092517852783203
generate_one_block  0.013132095336914062
generate_one_block  0.014060497283935547
generate_one_block  0.008261442184448242
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.019130706787109375  GigaBytes
Max Memory Allocated: 0.037972450256347656  GigaBytes

connection checking time:  0.06634020805358887
block generation total time  0.0693817138671875
average batch blocks generation time:  0.017345428466796875
block dataloader generation time/epoch 0.16418051719665527
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.019624710083007812  GigaBytes
Max Memory Allocated: 0.037972450256347656  GigaBytes

torch.Size([10064, 500])
torch.Size([3404, 32])
torch.Size([728, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.021716594696044922  GigaBytes
Max Memory Allocated: 0.037972450256347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.018429279327392578  GigaBytes
Max Memory Allocated: 0.037972450256347656  GigaBytes

torch.Size([9371, 500])
torch.Size([3039, 32])
torch.Size([759, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.02035665512084961  GigaBytes
Max Memory Allocated: 0.037972450256347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.022690773010253906  GigaBytes
Max Memory Allocated: 0.03997373580932617  GigaBytes

torch.Size([11723, 500])
torch.Size([3412, 32])
torch.Size([873, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.024838924407958984  GigaBytes
Max Memory Allocated: 0.03997373580932617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.015761852264404297  GigaBytes
Max Memory Allocated: 0.03997373580932617  GigaBytes

torch.Size([8065, 500])
torch.Size([2487, 32])
torch.Size([516, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.017245769500732422  GigaBytes
Max Memory Allocated: 0.03997373580932617  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012489795684814453 |0.000999152660369873 |0.0055463314056396484 |0.00014168024063110352 |0.005873501300811768 |0.002483367919921875 |
----------------------------------------------------------pseudo_mini_loss sum 1.6571381092071533
Total (block generation + training)time/epoch 0.2745635509490967
Training time/epoch 0.1098477840423584
Training time without block to device /epoch 0.1058511734008789
Training time without total dataloading part /epoch 0.04872941970825195
load block tensor time/epoch 0.04995918273925781
block to device time/epoch 0.003996610641479492
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  54798
Number of first layer input nodes during this epoch:  39223
