main start at this time 1648530900.496282
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019488334655761719  GigaBytes
Max Memory Allocated: 0.0019488334655761719  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.002308368682861328
range selection method range initialization spend 0.00010919570922851562
time for parepare:  5.3882598876953125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  0.0010166168212890625
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  5.1021575927734375e-05
----------------------check_connections_block total spend ----------------------------- 0.001964569091796875
generate_one_block  0.001283407211303711
generate_one_block  0.001157999038696289
generate_one_block  0.001035928726196289
generate_one_block  0.0010793209075927734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011432170867919922
gen group dst list time:  3.2901763916015625e-05
time for parepare:  0.00024771690368652344
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0002856254577636719
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.0002949237823486328
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00021982192993164062
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0004119873046875
----------------------check_connections_block total spend ----------------------------- 0.0026924610137939453
generate_one_block  0.0014753341674804688
generate_one_block  0.0013957023620605469
generate_one_block  0.0013148784637451172
generate_one_block  0.0015287399291992188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011167526245117188
gen group dst list time:  6.985664367675781e-05
time for parepare:  0.00077056884765625
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.0003204345703125
mini_batch_src_global generation:  0.00014853477478027344
r_  generation:  0.001708984375
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  0.00022101402282714844
r_  generation:  0.002070903778076172
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  0.0001475811004638672
r_  generation:  0.001285552978515625
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.0002574920654296875
mini_batch_src_global generation:  0.000247955322265625
r_  generation:  0.00267791748046875
----------------------check_connections_block total spend ----------------------------- 0.012579679489135742
generate_one_block  0.0033540725708007812
generate_one_block  0.003700733184814453
generate_one_block  0.002655506134033203
generate_one_block  0.0046558380126953125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.003492593765258789
gen group dst list time:  0.00022220611572265625
time for parepare:  0.0013494491577148438
local_output_nid generation:  0.0002028942108154297
local_in_edges_tensor generation:  0.0008056163787841797
mini_batch_src_global generation:  0.0009729862213134766
r_  generation:  0.008424520492553711
local_output_nid generation:  0.00023937225341796875
local_in_edges_tensor generation:  0.0005383491516113281
mini_batch_src_global generation:  0.0010673999786376953
r_  generation:  0.008551359176635742
local_output_nid generation:  0.00018548965454101562
local_in_edges_tensor generation:  0.00041294097900390625
mini_batch_src_global generation:  0.0005941390991210938
r_  generation:  0.006049633026123047
local_output_nid generation:  0.000278472900390625
local_in_edges_tensor generation:  0.0005586147308349609
mini_batch_src_global generation:  0.0007655620574951172
r_  generation:  0.008586645126342773
----------------------check_connections_block total spend ----------------------------- 0.04765820503234863
generate_one_block  0.013401508331298828
generate_one_block  0.011932373046875
generate_one_block  0.00898289680480957
generate_one_block  0.01251220703125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019488334655761719  GigaBytes
Max Memory Allocated: 0.0019488334655761719  GigaBytes

connection checking time:  0.06293034553527832
block generation total time  0.0669097900390625
average batch blocks generation time:  0.016727447509765625
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.023720741271972656  GigaBytes
Max Memory Allocated: 0.023720741271972656  GigaBytes

torch.Size([11458, 500])
torch.Size([2947, 256])
torch.Size([732, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.03645038604736328  GigaBytes
Max Memory Allocated: 0.04412841796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02268362045288086  GigaBytes
Max Memory Allocated: 0.04412841796875  GigaBytes

torch.Size([9929, 500])
torch.Size([3369, 256])
torch.Size([682, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03653430938720703  GigaBytes
Max Memory Allocated: 0.04412841796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.02035999298095703  GigaBytes
Max Memory Allocated: 0.04412841796875  GigaBytes

torch.Size([8736, 500])
torch.Size([2373, 256])
torch.Size([560, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03049945831298828  GigaBytes
Max Memory Allocated: 0.04412841796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.021979808807373047  GigaBytes
Max Memory Allocated: 0.04412841796875  GigaBytes

torch.Size([9537, 500])
torch.Size([3696, 256])
torch.Size([889, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.0379486083984375  GigaBytes
Max Memory Allocated: 0.04412841796875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00655442476272583 |0.08473765850067139 |0.1973170042037964 |0.00019472837448120117 |0.005205988883972168 |0.002513408660888672 |
----------------------------------------------------------pseudo_mini_loss sum 2.5271413326263428
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  55264
Number of first layer input nodes during this epoch:  39660
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.026581764221191406  GigaBytes
Max Memory Allocated: 0.04412841796875  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004620552062988281
range selection method range initialization spend 5.316734313964844e-05
time for parepare:  4.696846008300781e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.8623809814453125e-05
----------------------check_connections_block total spend ----------------------------- 0.0009768009185791016
generate_one_block  0.001299142837524414
generate_one_block  0.001130819320678711
generate_one_block  0.0010845661163330078
generate_one_block  0.001094818115234375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005071163177490234
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.00023102760314941406
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00019669532775878906
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0005903244018554688
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00020599365234375
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00026416778564453125
----------------------check_connections_block total spend ----------------------------- 0.00269317626953125
generate_one_block  0.0013251304626464844
generate_one_block  0.0018198490142822266
generate_one_block  0.0013117790222167969
generate_one_block  0.0013873577117919922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010330677032470703
gen group dst list time:  7.367134094238281e-05
time for parepare:  0.0007271766662597656
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.0005910396575927734
mini_batch_src_global generation:  0.0001404285430908203
r_  generation:  0.0012166500091552734
local_output_nid generation:  9.441375732421875e-05
local_in_edges_tensor generation:  0.000286102294921875
mini_batch_src_global generation:  0.00041222572326660156
r_  generation:  0.003771066665649414
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.00020623207092285156
r_  generation:  0.0014328956604003906
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.0014247894287109375
----------------------check_connections_block total spend ----------------------------- 0.012986421585083008
generate_one_block  0.0029859542846679688
generate_one_block  0.005551338195800781
generate_one_block  0.002686023712158203
generate_one_block  0.0026657581329345703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019533634185791016
gen group dst list time:  0.00022363662719726562
time for parepare:  0.001291513442993164
local_output_nid generation:  0.00018310546875
local_in_edges_tensor generation:  0.0007116794586181641
mini_batch_src_global generation:  0.0006489753723144531
r_  generation:  0.006105899810791016
local_output_nid generation:  0.00032639503479003906
local_in_edges_tensor generation:  0.0007021427154541016
mini_batch_src_global generation:  0.0012886524200439453
r_  generation:  0.01174020767211914
local_output_nid generation:  0.0002086162567138672
local_in_edges_tensor generation:  0.0004909038543701172
mini_batch_src_global generation:  0.0008306503295898438
r_  generation:  0.006986856460571289
local_output_nid generation:  0.00021839141845703125
local_in_edges_tensor generation:  0.0004475116729736328
mini_batch_src_global generation:  0.0006241798400878906
r_  generation:  0.006127119064331055
----------------------check_connections_block total spend ----------------------------- 0.0467534065246582
generate_one_block  0.009473085403442383
generate_one_block  0.015970468521118164
generate_one_block  0.011505603790283203
generate_one_block  0.00948643684387207
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.026581764221191406  GigaBytes
Max Memory Allocated: 0.04412841796875  GigaBytes

connection checking time:  0.06243300437927246
block generation total time  0.06616878509521484
average batch blocks generation time:  0.01654219627380371
block dataloader generation time/epoch 0.15662717819213867
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.023587703704833984  GigaBytes
Max Memory Allocated: 0.04412841796875  GigaBytes

torch.Size([8385, 500])
torch.Size([2530, 256])
torch.Size([455, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03377485275268555  GigaBytes
Max Memory Allocated: 0.04412841796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.032260894775390625  GigaBytes
Max Memory Allocated: 0.04746198654174805  GigaBytes

torch.Size([12921, 500])
torch.Size([4516, 256])
torch.Size([1283, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.05402994155883789  GigaBytes
Max Memory Allocated: 0.05784320831298828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.025445938110351562  GigaBytes
Max Memory Allocated: 0.05784320831298828  GigaBytes

torch.Size([9361, 500])
torch.Size([2479, 256])
torch.Size([517, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03568553924560547  GigaBytes
Max Memory Allocated: 0.05784320831298828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.02335643768310547  GigaBytes
Max Memory Allocated: 0.05784320831298828  GigaBytes

torch.Size([8253, 500])
torch.Size([2382, 256])
torch.Size([555, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03364133834838867  GigaBytes
Max Memory Allocated: 0.05784320831298828  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004248142242431641 |0.0008459091186523438 |0.005042552947998047 |0.00015997886657714844 |0.0028524398803710938 |0.0023741722106933594 |
----------------------------------------------------------pseudo_mini_loss sum 1.006842851638794
Total (block generation + training)time/epoch 0.2180614471435547
Training time/epoch 0.061176300048828125
Training time without block to device /epoch 0.05779266357421875
Training time without total dataloading part /epoch 0.034594058990478516
load block tensor time/epoch 0.016992568969726562
block to device time/epoch 0.003383636474609375
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  53993
Number of first layer input nodes during this epoch:  38920
