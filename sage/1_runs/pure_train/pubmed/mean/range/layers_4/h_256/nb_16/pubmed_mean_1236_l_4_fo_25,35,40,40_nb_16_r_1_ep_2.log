main start at this time 1648530910.8127768
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019488334655761719  GigaBytes
Max Memory Allocated: 0.0019488334655761719  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012483596801757812
range selection method range initialization spend 9.5367431640625e-05
time for parepare:  4.649162292480469e-05
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0014545917510986328
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.574920654296875e-05
----------------------check_connections_block total spend ----------------------------- 0.0031447410583496094
generate_one_block  0.0013720989227294922
generate_one_block  0.0011534690856933594
generate_one_block  0.0011453628540039062
generate_one_block  0.0011341571807861328
generate_one_block  0.0011341571807861328
generate_one_block  0.0011255741119384766
generate_one_block  0.001157999038696289
generate_one_block  0.001129150390625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007495880126953125
gen group dst list time:  5.2928924560546875e-05
time for parepare:  0.00024199485778808594
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00010657310485839844
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00022912025451660156
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0002574920654296875
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00012564659118652344
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00014209747314453125
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  9.965896606445312e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0002789497375488281
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00016641616821289062
----------------------check_connections_block total spend ----------------------------- 0.0035400390625
generate_one_block  0.0012650489807128906
generate_one_block  0.001439809799194336
generate_one_block  0.0014591217041015625
generate_one_block  0.0012946128845214844
generate_one_block  0.0013167858123779297
generate_one_block  0.0012323856353759766
generate_one_block  0.0015294551849365234
generate_one_block  0.0013375282287597656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010578632354736328
gen group dst list time:  9.489059448242188e-05
time for parepare:  0.0007843971252441406
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0002551078796386719
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.0005280971527099609
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  0.00013709068298339844
r_  generation:  0.0014412403106689453
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  0.00021886825561523438
r_  generation:  0.0019757747650146484
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0006701946258544922
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  8.845329284667969e-05
r_  generation:  0.0007548332214355469
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0005662441253662109
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.00016617774963378906
r_  generation:  0.0018498897552490234
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  0.00015497207641601562
r_  generation:  0.0012693405151367188
----------------------check_connections_block total spend ----------------------------- 0.015024423599243164
generate_one_block  0.001847982406616211
generate_one_block  0.0027115345001220703
generate_one_block  0.003337860107421875
generate_one_block  0.001975536346435547
generate_one_block  0.0018012523651123047
generate_one_block  0.001659393310546875
generate_one_block  0.003135204315185547
generate_one_block  0.002492666244506836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002074718475341797
gen group dst list time:  0.00027298927307128906
time for parepare:  0.001554727554321289
local_output_nid generation:  7.796287536621094e-05
local_in_edges_tensor generation:  0.0005166530609130859
mini_batch_src_global generation:  0.00041174888610839844
r_  generation:  0.0033288002014160156
local_output_nid generation:  0.00018143653869628906
local_in_edges_tensor generation:  0.000438690185546875
mini_batch_src_global generation:  0.0009214878082275391
r_  generation:  0.007273435592651367
local_output_nid generation:  0.0002415180206298828
local_in_edges_tensor generation:  0.000522613525390625
mini_batch_src_global generation:  0.00095367431640625
r_  generation:  0.007765054702758789
local_output_nid generation:  9.226799011230469e-05
local_in_edges_tensor generation:  0.00025463104248046875
mini_batch_src_global generation:  0.00038933753967285156
r_  generation:  0.003129720687866211
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.0003020763397216797
mini_batch_src_global generation:  0.00034165382385253906
r_  generation:  0.0032470226287841797
local_output_nid generation:  9.608268737792969e-05
local_in_edges_tensor generation:  0.00025200843811035156
mini_batch_src_global generation:  0.0003139972686767578
r_  generation:  0.003074169158935547
local_output_nid generation:  0.0001742839813232422
local_in_edges_tensor generation:  0.00037932395935058594
mini_batch_src_global generation:  0.0005171298980712891
r_  generation:  0.005944728851318359
local_output_nid generation:  0.00019311904907226562
local_in_edges_tensor generation:  0.00044155120849609375
mini_batch_src_global generation:  0.0006215572357177734
r_  generation:  0.005942106246948242
----------------------check_connections_block total spend ----------------------------- 0.060393333435058594
generate_one_block  0.005788564682006836
generate_one_block  0.01018214225769043
generate_one_block  0.011959552764892578
generate_one_block  0.005053281784057617
generate_one_block  0.005715608596801758
generate_one_block  0.0050792694091796875
generate_one_block  0.008619546890258789
generate_one_block  0.009642601013183594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019488334655761719  GigaBytes
Max Memory Allocated: 0.0019488334655761719  GigaBytes

connection checking time:  0.07895779609680176
block generation total time  0.09187674522399902
average batch blocks generation time:  0.011484593152999878
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.011873245239257812  GigaBytes
Max Memory Allocated: 0.011873245239257812  GigaBytes

torch.Size([5274, 500])
torch.Size([911, 256])
torch.Size([225, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01583719253540039  GigaBytes
Max Memory Allocated: 0.019601821899414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022371768951416016  GigaBytes
Max Memory Allocated: 0.03196907043457031  GigaBytes

torch.Size([9799, 500])
torch.Size([2333, 256])
torch.Size([524, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.032187461853027344  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.02032947540283203  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

torch.Size([8681, 500])
torch.Size([2937, 256])
torch.Size([528, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.03265810012817383  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.014661788940429688  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

torch.Size([5730, 500])
torch.Size([1052, 256])
torch.Size([289, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.019357681274414062  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.014255046844482422  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

torch.Size([5506, 500])
torch.Size([1318, 256])
torch.Size([310, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.020161151885986328  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.013519287109375  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

torch.Size([5115, 500])
torch.Size([1042, 256])
torch.Size([185, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017734527587890625  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016746997833251953  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

torch.Size([6785, 500])
torch.Size([2153, 256])
torch.Size([520, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026097774505615234  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017613887786865234  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

torch.Size([7261, 500])
torch.Size([2282, 256])
torch.Size([350, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026512622833251953  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006703883409500122 |0.045736104249954224 |0.10322758555412292 |0.0001703500747680664 |0.0036068856716156006 |0.002565622329711914 |
----------------------------------------------------------pseudo_mini_loss sum 2.2888779640197754
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  71467
Number of first layer input nodes during this epoch:  54151
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.021938323974609375  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004878044128417969
range selection method range initialization spend 5.2928924560546875e-05
time for parepare:  4.76837158203125e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0003001689910888672
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.6689300537109375e-05
----------------------check_connections_block total spend ----------------------------- 0.0019347667694091797
generate_one_block  0.001245737075805664
generate_one_block  0.0010530948638916016
generate_one_block  0.0010709762573242188
generate_one_block  0.0010471343994140625
generate_one_block  0.001043081283569336
generate_one_block  0.0010428428649902344
generate_one_block  0.0010573863983154297
generate_one_block  0.0010344982147216797
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005347728729248047
gen group dst list time:  5.14984130859375e-05
time for parepare:  0.0002541542053222656
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001232624053955078
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00012803077697753906
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00037980079650878906
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.00026535987854003906
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00011372566223144531
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0001289844512939453
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00018787384033203125
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  7.915496826171875e-05
----------------------check_connections_block total spend ----------------------------- 0.0034999847412109375
generate_one_block  0.0012001991271972656
generate_one_block  0.0012433528900146484
generate_one_block  0.0015251636505126953
generate_one_block  0.0013840198516845703
generate_one_block  0.0011768341064453125
generate_one_block  0.0011954307556152344
generate_one_block  0.0012583732604980469
generate_one_block  0.0011210441589355469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011827945709228516
gen group dst list time:  0.00010085105895996094
time for parepare:  0.0007870197296142578
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0002560615539550781
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.0008141994476318359
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0006697177886962891
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  0.00025153160095214844
r_  generation:  0.0025243759155273438
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  0.0002377033233642578
r_  generation:  0.0019440650939941406
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  0.00011372566223144531
r_  generation:  0.0006811618804931641
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0008893013000488281
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.0009253025054931641
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0005662441253662109
----------------------check_connections_block total spend ----------------------------- 0.014924287796020508
generate_one_block  0.0020759105682373047
generate_one_block  0.0016853809356689453
generate_one_block  0.003879070281982422
generate_one_block  0.003239154815673828
generate_one_block  0.0016949176788330078
generate_one_block  0.0019330978393554688
generate_one_block  0.0020635128021240234
generate_one_block  0.0015883445739746094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019974708557128906
gen group dst list time:  0.0002758502960205078
time for parepare:  0.0015344619750976562
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.0006325244903564453
mini_batch_src_global generation:  0.0005421638488769531
r_  generation:  0.004611968994140625
local_output_nid generation:  0.000102996826171875
local_in_edges_tensor generation:  0.0002903938293457031
mini_batch_src_global generation:  0.0004487037658691406
r_  generation:  0.0034134387969970703
local_output_nid generation:  0.0002353191375732422
local_in_edges_tensor generation:  0.0005428791046142578
mini_batch_src_global generation:  0.0009026527404785156
r_  generation:  0.008346080780029297
local_output_nid generation:  0.0002219676971435547
local_in_edges_tensor generation:  0.000499725341796875
mini_batch_src_global generation:  0.0008838176727294922
r_  generation:  0.0074596405029296875
local_output_nid generation:  0.00011038780212402344
local_in_edges_tensor generation:  0.0002884864807128906
mini_batch_src_global generation:  0.0004775524139404297
r_  generation:  0.003373384475708008
local_output_nid generation:  0.00014090538024902344
local_in_edges_tensor generation:  0.00034165382385253906
mini_batch_src_global generation:  0.000438690185546875
r_  generation:  0.004738569259643555
local_output_nid generation:  0.00013446807861328125
local_in_edges_tensor generation:  0.00030612945556640625
mini_batch_src_global generation:  0.0003876686096191406
r_  generation:  0.003780841827392578
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  0.00035762786865234375
r_  generation:  0.002913236618041992
----------------------check_connections_block total spend ----------------------------- 0.05856156349182129
generate_one_block  0.006994009017944336
generate_one_block  0.005202531814575195
generate_one_block  0.011489152908325195
generate_one_block  0.01127934455871582
generate_one_block  0.005465507507324219
generate_one_block  0.0072116851806640625
generate_one_block  0.00574946403503418
generate_one_block  0.004723310470581055
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.021938323974609375  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

connection checking time:  0.07698583602905273
block generation total time  0.08637881278991699
average batch blocks generation time: Using backend: pytorch
 0.010797351598739624
block dataloader generation time/epoch 0.1950664520263672
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.020229816436767578  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

torch.Size([6615, 500])
torch.Size([1741, 256])
torch.Size([257, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026959896087646484  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.01736164093017578  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

torch.Size([5092, 500])
torch.Size([1206, 256])
torch.Size([249, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.022416114807128906  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02585887908935547  GigaBytes
Max Memory Allocated: 0.03874540328979492  GigaBytes

torch.Size([9552, 500])
torch.Size([3010, 256])
torch.Size([731, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03879499435424805  GigaBytes
Max Memory Allocated: 0.043822288513183594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.02639293670654297  GigaBytes
Max Memory Allocated: 0.04391765594482422  GigaBytes

torch.Size([9851, 500])
torch.Size([2642, 256])
torch.Size([614, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.037586212158203125  GigaBytes
Max Memory Allocated: 0.04391765594482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.019602298736572266  GigaBytes
Max Memory Allocated: 0.04391765594482422  GigaBytes

torch.Size([6026, 500])
torch.Size([1090, 256])
torch.Size([274, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.024303913116455078  GigaBytes
Max Memory Allocated: 0.04391765594482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.019685745239257812  GigaBytes
Max Memory Allocated: 0.04391765594482422  GigaBytes

torch.Size([6311, 500])
torch.Size([1626, 256])
torch.Size([274, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.026151657104492188  GigaBytes
Max Memory Allocated: 0.04391765594482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.01855611801147461  GigaBytes
Max Memory Allocated: 0.04391765594482422  GigaBytes

torch.Size([5722, 500])
torch.Size([1568, 256])
torch.Size([333, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.025223731994628906  GigaBytes
Max Memory Allocated: 0.04391765594482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.014013290405273438  GigaBytes
Max Memory Allocated: 0.04391765594482422  GigaBytes

torch.Size([3296, 500])
torch.Size([855, 256])
torch.Size([154, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.017459392547607422  GigaBytes
Max Memory Allocated: 0.04391765594482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0035246610641479492 |0.0006555914878845215 |0.004530757665634155 |0.00013044476509094238 |0.003116041421890259 |0.002004384994506836 |
----------------------------------------------------------pseudo_mini_loss sum 1.4501020908355713
Total (block generation + training)time/epoch 0.30309510231018066
Training time/epoch 0.1077885627746582
Training time without block to device /epoch 0.10254383087158203
Training time without total dataloading part /epoch 0.06422233581542969
load block tensor time/epoch 0.028197288513183594
block to device time/epoch 0.005244731903076172
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  69445
Number of first layer input nodes during this epoch:  52465
