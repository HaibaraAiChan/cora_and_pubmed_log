main start at this time 1648530805.8395824
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003085136413574219  GigaBytes
Max Memory Allocated: 0.0003085136413574219  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001735687255859375
range selection method range initialization spend 8.511543273925781e-05
time for parepare:  4.553794860839844e-05
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.0011830329895019531
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.384185791015625e-05
----------------------check_connections_block total spend ----------------------------- 0.002888917922973633
generate_one_block  0.0012929439544677734
generate_one_block  0.00106048583984375
generate_one_block  0.0010602474212646484
generate_one_block  0.0010521411895751953
generate_one_block  0.0010547637939453125
generate_one_block  0.0010497570037841797
generate_one_block  0.0010521411895751953
generate_one_block  0.0010309219360351562
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008103847503662109
gen group dst list time:  5.316734313964844e-05
time for parepare:  0.00023651123046875
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00023508071899414062
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00021076202392578125
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0001456737518310547
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0001232624053955078
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0002598762512207031
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002033710479736328
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00019359588623046875
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00012254714965820312
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00013208389282226562
----------------------check_connections_block total spend ----------------------------- 0.0035271644592285156
generate_one_block  0.0013420581817626953
generate_one_block  0.001215219497680664
generate_one_block  0.0011892318725585938
generate_one_block  0.0013887882232666016
generate_one_block  0.0012655258178710938
generate_one_block  0.001308441162109375
generate_one_block  0.001234292984008789
generate_one_block  0.0011975765228271484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011076927185058594
gen group dst list time:  9.34600830078125e-05
time for parepare:  0.0007734298706054688
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0002906322479248047
mini_batch_src_global generation:  0.00013756752014160156
r_  generation:  0.0014262199401855469
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  0.0001270771026611328
r_  generation:  0.0009188652038574219
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0006771087646484375
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.00018024444580078125
r_  generation:  0.0018892288208007812
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  0.00014281272888183594
r_  generation:  0.0010890960693359375
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0011487007141113281
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  0.00011348724365234375
r_  generation:  0.0009613037109375
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0008130073547363281
----------------------check_connections_block total spend ----------------------------- 0.01484227180480957
generate_one_block  0.002948760986328125
generate_one_block  0.002029895782470703
generate_one_block  0.0017423629760742188
generate_one_block  0.003268003463745117
generate_one_block  0.0022399425506591797
generate_one_block  0.002416849136352539
generate_one_block  0.002187967300415039
generate_one_block  0.0018846988677978516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020678043365478516
gen group dst list time:  0.0002701282501220703
time for parepare:  0.0015139579772949219
local_output_nid generation:  0.0001475811004638672
local_in_edges_tensor generation:  0.0006277561187744141
mini_batch_src_global generation:  0.0007014274597167969
r_  generation:  0.005850315093994141
local_output_nid generation:  0.0001304149627685547
local_in_edges_tensor generation:  0.0003437995910644531
mini_batch_src_global generation:  0.0006561279296875
r_  generation:  0.00486445426940918
local_output_nid generation:  9.942054748535156e-05
local_in_edges_tensor generation:  0.0002968311309814453
mini_batch_src_global generation:  0.0004100799560546875
r_  generation:  0.003710508346557617
local_output_nid generation:  0.0001735687255859375
local_in_edges_tensor generation:  0.00044345855712890625
mini_batch_src_global generation:  0.0006608963012695312
r_  generation:  0.006367683410644531
local_output_nid generation:  0.00015664100646972656
local_in_edges_tensor generation:  0.00035071372985839844
mini_batch_src_global generation:  0.0004973411560058594
r_  generation:  0.004643440246582031
local_output_nid generation:  0.0001571178436279297
local_in_edges_tensor generation:  0.0003936290740966797
mini_batch_src_global generation:  0.0005168914794921875
r_  generation:  0.005182504653930664
local_output_nid generation:  0.00017118453979492188
local_in_edges_tensor generation:  0.0004017353057861328
mini_batch_src_global generation:  0.0005526542663574219
r_  generation:  0.0053558349609375
local_output_nid generation:  0.0001342296600341797
local_in_edges_tensor generation:  0.00029778480529785156
mini_batch_src_global generation:  0.00042724609375
r_  generation:  0.003918170928955078
----------------------check_connections_block total spend ----------------------------- 0.060549259185791016
generate_one_block  0.008723974227905273
generate_one_block  0.0070171356201171875
generate_one_block  0.005873441696166992
generate_one_block  0.010252237319946289
generate_one_block  0.007513999938964844
generate_one_block  0.008334875106811523
generate_one_block  0.008870363235473633
generate_one_block  0.006005764007568359
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003085136413574219  GigaBytes
Max Memory Allocated: 0.0003085136413574219  GigaBytes

connection checking time:  0.0789186954498291
block generation total time  0.09145140647888184
average batch blocks generation time:  0.01143142580986023
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.012559890747070312  GigaBytes
Max Memory Allocated: 0.012559890747070312  GigaBytes

torch.Size([6474, 500])
torch.Size([1894, 64])
torch.Size([427, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.014725685119628906  GigaBytes
Max Memory Allocated: 0.015691280364990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012481212615966797  GigaBytes
Max Memory Allocated: 0.024393081665039062  GigaBytes

torch.Size([6143, 500])
torch.Size([1476, 64])
torch.Size([275, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014109134674072266  GigaBytes
Max Memory Allocated: 0.024393081665039062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011406898498535156  GigaBytes
Max Memory Allocated: 0.024393081665039062  GigaBytes

torch.Size([5731, 500])
torch.Size([1113, 64])
torch.Size([273, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012721061706542969  GigaBytes
Max Memory Allocated: 0.024393081665039062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014722347259521484  GigaBytes
Max Memory Allocated: 0.02516317367553711  GigaBytes

torch.Size([7448, 500])
torch.Size([2232, 64])
torch.Size([495, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01726818084716797  GigaBytes
Max Memory Allocated: 0.02516317367553711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014440059661865234  GigaBytes
Max Memory Allocated: 0.02816009521484375  GigaBytes

torch.Size([7131, 500])
torch.Size([1932, 64])
torch.Size([382, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01657867431640625  GigaBytes
Max Memory Allocated: 0.02816009521484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.017058849334716797  GigaBytes
Max Memory Allocated: 0.03055572509765625  GigaBytes

torch.Size([8734, 500])
torch.Size([1898, 64])
torch.Size([479, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.019259929656982422  GigaBytes
Max Memory Allocated: 0.03055572509765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.014811515808105469  GigaBytes
Max Memory Allocated: 0.03090810775756836  GigaBytes

torch.Size([7529, 500])
torch.Size([2001, 64])
torch.Size([302, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.016895771026611328  GigaBytes
Max Memory Allocated: 0.03090810775756836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.010472297668457031  GigaBytes
Max Memory Allocated: 0.03090810775756836  GigaBytes

torch.Size([5224, 500])
torch.Size([1525, 64])
torch.Size([257, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.01210165023803711  GigaBytes
Max Memory Allocated: 0.03090810775756836  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004783749580383301 |0.04356232285499573 |0.10012853145599365 |0.0001531541347503662 |0.0034423768520355225 |0.002719402313232422 |
----------------------------------------------------------pseudo_mini_loss sum 2.641977071762085
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  71732
Number of first layer input nodes during this epoch:  54414
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.01136922836303711  GigaBytes
Max Memory Allocated: 0.03090810775756836  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004582405090332031
range selection method range initialization spend 5.1975250244140625e-05
time for parepare:  4.76837158203125e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0002810955047607422
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.0018477439880371094
generate_one_block  0.0011491775512695312
generate_one_block  0.0010035037994384766
generate_one_block  0.0010366439819335938
generate_one_block  0.0010218620300292969
generate_one_block  0.001027822494506836
generate_one_block  0.0010366439819335938
generate_one_block  0.0010097026824951172
generate_one_block  0.0009751319885253906
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005085468292236328
gen group dst list time:  4.887580871582031e-05
time for parepare:  0.00025343894958496094
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00012540817260742188
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0002562999725341797
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0003674030303955078
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00014925003051757812
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00016546249389648438
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00012803077697753906
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00010061264038085938
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  8.0108642578125e-05
----------------------check_connections_block total spend ----------------------------- 0.003426074981689453
generate_one_block  0.0011508464813232422
generate_one_block  0.0014150142669677734
generate_one_block  0.0014302730560302734
generate_one_block  0.0011508464813232422
generate_one_block  0.0012154579162597656
generate_one_block  0.0011544227600097656
generate_one_block  0.0010941028594970703
generate_one_block  0.0010769367218017578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011370182037353516
gen group dst list time:  9.918212890625e-05
time for parepare:  0.0008206367492675781
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0002899169921875
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.0005428791046142578
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.001934051513671875
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  0.00026226043701171875
r_  generation:  0.0023136138916015625
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  0.0001442432403564453
r_  generation:  0.0009372234344482422
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  9.465217590332031e-05
r_  generation:  0.0008673667907714844
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.0008435249328613281
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0006396770477294922
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0007507801055908203
----------------------check_connections_block total spend ----------------------------- 0.014856815338134766
generate_one_block  0.0016949176788330078
generate_one_block  0.00335693359375
generate_one_block  0.0038483142852783203
generate_one_block  0.0020797252655029297
generate_one_block  0.0019414424896240234
generate_one_block  0.0019500255584716797
generate_one_block  0.0018324851989746094
generate_one_block  0.001880645751953125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019407272338867188
gen group dst list time:  0.00027489662170410156
time for parepare:  0.001432657241821289
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.0005044937133789062
mini_batch_src_global generation:  0.00028824806213378906
r_  generation:  0.0023212432861328125
local_output_nid generation:  0.00020122528076171875
local_in_edges_tensor generation:  0.0004935264587402344
mini_batch_src_global generation:  0.0010149478912353516
r_  generation:  0.008134126663208008
local_output_nid generation:  0.00024247169494628906
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.0010528564453125
r_  generation:  0.008194684982299805
local_output_nid generation:  0.00016260147094726562
local_in_edges_tensor generation:  0.0003762245178222656
mini_batch_src_global generation:  0.0005476474761962891
r_  generation:  0.0048198699951171875
local_output_nid generation:  0.00012230873107910156
local_in_edges_tensor generation:  0.0002887248992919922
mini_batch_src_global generation:  0.00033974647521972656
r_  generation:  0.0031082630157470703
local_output_nid generation:  0.0001366138458251953
local_in_edges_tensor generation:  0.00032973289489746094
mini_batch_src_global generation:  0.00041222572326660156
r_  generation:  0.004454374313354492
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.0002796649932861328
mini_batch_src_global generation:  0.00040149688720703125
r_  generation:  0.003710508346557617
local_output_nid generation:  0.0001590251922607422
local_in_edges_tensor generation:  0.00035190582275390625
mini_batch_src_global generation:  0.00045752525329589844
r_  generation:  0.004750967025756836
----------------------check_connections_block total spend ----------------------------- 0.05992770195007324
generate_one_block  0.004529476165771484
generate_one_block  0.011857748031616211
generate_one_block  0.012079000473022461
generate_one_block  0.00722503662109375
generate_one_block  0.004940986633300781
generate_one_block  0.0070154666900634766
generate_one_block  0.005872249603271484
generate_one_block  0.00732874870300293
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.01136922836303711  GigaBytes
Max Memory Allocated: 0.03090810775756836  GigaBytes

connection checking time:  0.07821059226989746
block generation total time  0.08912110328674316
average batch blocks generation time:  0.011140137910842896
block dataloader generation time/epoch 0.1982729434967041Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.009310722351074219  GigaBytes
Max Memory Allocated: 0.03090810775756836  GigaBytes

torch.Size([4303, 500])
torch.Size([865, 64])
torch.Size([267, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.01037454605102539  GigaBytes
Max Memory Allocated: 0.03090810775756836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.02103281021118164  GigaBytes
Max Memory Allocated: 0.03090810775756836  GigaBytes

torch.Size([10231, 500])
torch.Size([2794, 64])
torch.Size([622, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.024194717407226562  GigaBytes
Max Memory Allocated: 0.03090810775756836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.01964712142944336  GigaBytes
Max Memory Allocated: 0.038886070251464844  GigaBytes

torch.Size([9734, 500])
torch.Size([2994, 64])
torch.Size([713, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.023095130920410156  GigaBytes
Max Memory Allocated: 0.038886070251464844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.01318216323852539  GigaBytes
Max Memory Allocated: 0.038886070251464844  GigaBytes

torch.Size([6336, 500])
torch.Size([1811, 64])
torch.Size([297, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.015117168426513672  GigaBytes
Max Memory Allocated: 0.038886070251464844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.01008462905883789  GigaBytes
Max Memory Allocated: 0.038886070251464844  GigaBytes

torch.Size([4701, 500])
torch.Size([1409, 64])
torch.Size([317, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.011687278747558594  GigaBytes
Max Memory Allocated: 0.038886070251464844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.013642311096191406  GigaBytes
Max Memory Allocated: 0.038886070251464844  GigaBytes

torch.Size([6588, 500])
torch.Size([1501, 64])
torch.Size([314, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.01532888412475586  GigaBytes
Max Memory Allocated: 0.038886070251464844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.011535167694091797  GigaBytes
Max Memory Allocated: 0.038886070251464844  GigaBytes

torch.Size([5471, 500])
torch.Size([1182, 64])
torch.Size([216, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.012836456298828125  GigaBytes
Max Memory Allocated: 0.038886070251464844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.015047550201416016  GigaBytes
Max Memory Allocated: 0.038886070251464844  GigaBytes

torch.Size([6821, 500])
torch.Size([1724, 64])
torch.Size([181, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.01676177978515625  GigaBytes
Max Memory Allocated: 0.038886070251464844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0036930739879608154 |0.0007633566856384277 |0.0052193403244018555 |0.00014707446098327637 |0.002783358097076416 |0.0020639896392822266 |
----------------------------------------------------------pseudo_mini_loss sum 2.176337718963623
Total (block generation + training)time/epoch 0.3129136562347412
Training time/epoch 0.11430859565734863
Training time without block to device /epoch 0.10820174217224121
Training time without total dataloading part /epoch 0.06726217269897461
load block tensor time/epoch 0.029544591903686523
block to device time/epoch 0.006106853485107422
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  71749
Number of first layer input nodes during this epoch:  54185
