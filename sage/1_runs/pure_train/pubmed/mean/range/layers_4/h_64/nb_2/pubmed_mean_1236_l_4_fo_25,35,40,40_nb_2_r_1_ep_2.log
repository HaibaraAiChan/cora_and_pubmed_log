main start at this time 1648530774.4530368
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003085136413574219  GigaBytes
Max Memory Allocated: 0.0003085136413574219  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0023789405822753906
range selection method range initialization spend 7.677078247070312e-05
time for parepare:  4.220008850097656e-05
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0011501312255859375
----------------------check_connections_block total spend ----------------------------- 0.0015230178833007812
generate_one_block  0.0020225048065185547
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0015103816986083984
gen group dst list time:  1.8358230590820312e-05
time for parepare:  0.00023627281188964844
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.0001499652862548828
r_  generation:  0.0011687278747558594
----------------------check_connections_block total spend ----------------------------- 0.0021257400512695312
generate_one_block  0.0026903152465820312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010025501251220703
gen group dst list time:  4.744529724121094e-05
time for parepare:  0.0006968975067138672
local_output_nid generation:  0.00016307830810546875
local_in_edges_tensor generation:  0.0005183219909667969
mini_batch_src_global generation:  0.0006225109100341797
r_  generation:  0.006222963333129883
----------------------check_connections_block total spend ----------------------------- 0.010141611099243164
generate_one_block  0.009638309478759766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019364356994628906
gen group dst list time:  0.00013399124145507812
time for parepare:  0.0013785362243652344
local_output_nid generation:  0.0004787445068359375
local_in_edges_tensor generation:  0.0012412071228027344
mini_batch_src_global generation:  0.0015621185302734375
r_  generation:  0.016148805618286133
----------------------check_connections_block total spend ----------------------------- 0.02538585662841797
generate_one_block  0.021944522857666016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003085136413574219  GigaBytes
Max Memory Allocated: 0.0003085136413574219  GigaBytes

connection checking time:  0.037653207778930664
block generation total time  0.03427314758300781
average batch blocks generation time:  0.03427314758300781
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.0306243896484375  GigaBytes
Max Memory Allocated: 0.0306243896484375  GigaBytes

torch.Size([15939, 500])
torch.Size([8003, 64])
torch.Size([2576, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.040511131286621094  GigaBytes
Max Memory Allocated: 0.040728092193603516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012079238891601562 |0.35231828689575195 |0.7622363567352295 |0.00028133392333984375 |0.009849786758422852 |0.0054090023040771484 |
----------------------------------------------------------pseudo_mini_loss sum 2.3571693897247314
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  26872
Number of first layer input nodes during this epoch:  15939
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.03293466567993164  GigaBytes
Max Memory Allocated: 0.04165315628051758  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007007122039794922
range selection method range initialization spend 7.653236389160156e-05
time for parepare:  6.604194641113281e-05
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00023818016052246094
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0001575946807861328
----------------------check_connections_block total spend ----------------------------- 0.0006718635559082031
generate_one_block  0.0014545917510986328
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005095005035400391
gen group dst list time:  1.8835067749023438e-05
time for parepare:  0.00024008750915527344
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  0.00014829635620117188
r_  generation:  0.001161813735961914
----------------------check_connections_block total spend ----------------------------- 0.002105712890625
generate_one_block  0.0027556419372558594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009899139404296875
gen group dst list time:  5.6743621826171875e-05
time for parepare:  0.0006957054138183594
local_output_nid generation:  0.00017499923706054688
local_in_edges_tensor generation:  0.0005428791046142578
mini_batch_src_global generation:  0.0005903244018554688
r_  generation:  0.006381988525390625
----------------------check_connections_block total spend ----------------------------- 0.010306596755981445
generate_one_block  0.009740591049194336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017366409301757812
gen group dst list time:  0.0001304149627685547
time for parepare:  0.0012280941009521484
local_output_nid generation:  0.00051116943359375
local_in_edges_tensor generation:  0.0013155937194824219
mini_batch_src_global generation:  0.0016040802001953125
r_  generation:  0.016202449798583984
----------------------check_connections_block total spend ----------------------------- 0.025572776794433594
generate_one_block  0.02190709114074707
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.03293466567993164  GigaBytes
Max Memory Allocated: 0.04165315628051758  GigaBytes

connection checking time:  0.03798508644104004
block generation total time  0.034403324127197266
average batch blocks generation time:  0.034403324127197266
block dataloader generation time/epoch 0.10305023193359375
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.03146553039550781  GigaBytes
Max Memory Allocated: 0.06052827835083008  GigaBytes

torch.Size([15900, 500])
torch.Size([7995, 64])
torch.Size([2579, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.04134941101074219  GigaBytes
Max Memory Allocated: 0.06052827835083008  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010265588760375977 |0.0009093284606933594 |0.004403829574584961 |0.0001533031463623047 |0.0038526058197021484 |0.0018224716186523438 |
----------------------------------------------------------pseudo_mini_loss sum 1.397268533706665
Total (block generation + training)time/epoch 0.12633609771728516
Training time/epoch 0.02283763885498047
Training time without block to device /epoch 0.02192831039428711Using backend: pytorch

Training time without total dataloading part /epoch 0.010232210159301758
load block tensor time/epoch 0.010265588760375977
block to device time/epoch 0.0009093284606933594
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  26828
Number of first layer input nodes during this epoch:  15900
