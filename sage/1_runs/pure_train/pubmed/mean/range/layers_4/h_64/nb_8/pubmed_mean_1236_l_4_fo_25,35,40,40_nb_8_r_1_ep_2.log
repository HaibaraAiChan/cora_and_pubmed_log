main start at this time 1648530795.299278
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003085136413574219  GigaBytes
Max Memory Allocated: 0.0003085136413574219  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0019996166229248047
range selection method range initialization spend 8.845329284667969e-05
time for parepare:  4.458427429199219e-05
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0011904239654541016
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  5.626678466796875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.552436828613281e-05
----------------------check_connections_block total spend ----------------------------- 0.0022258758544921875
generate_one_block  0.0017762184143066406
generate_one_block  0.0011587142944335938
generate_one_block  0.0010564327239990234
generate_one_block  0.0010743141174316406
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011150836944580078
gen group dst list time:  3.504753112792969e-05
time for parepare:  0.0002334117889404297
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00029277801513671875
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0002486705780029297
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00041794776916503906
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.00032901763916015625
----------------------check_connections_block total spend ----------------------------- 0.002759218215942383
generate_one_block  0.00146484375
generate_one_block  0.0013241767883300781
generate_one_block  0.0016024112701416016
generate_one_block  0.0014677047729492188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010297298431396484
gen group dst list time:  9.560585021972656e-05
time for parepare:  0.0007710456848144531
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.00031256675720214844
mini_batch_src_global generation:  0.0001785755157470703
r_  generation:  0.0020194053649902344
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0014369487762451172
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.00023508071899414062
mini_batch_src_global generation:  0.0002455711364746094
r_  generation:  0.002727031707763672
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  0.0002493858337402344
r_  generation:  0.002356290817260742
----------------------check_connections_block total spend ----------------------------- 0.013612985610961914
generate_one_block  0.0037567615509033203
generate_one_block  0.002660036087036133
generate_one_block  0.004389762878417969
generate_one_block  0.0038781166076660156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018475055694580078
gen group dst list time:  0.0002334117889404297
time for parepare:  0.0013649463653564453
local_output_nid generation:  0.00019669532775878906
local_in_edges_tensor generation:  0.0007548332214355469
mini_batch_src_global generation:  0.0009534358978271484
r_  generation:  0.007969141006469727
local_output_nid generation:  0.00018215179443359375
local_in_edges_tensor generation:  0.0004513263702392578
mini_batch_src_global generation:  0.0008282661437988281
r_  generation:  0.006499767303466797
local_output_nid generation:  0.00028586387634277344
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.0009164810180664062
r_  generation:  0.00966024398803711
local_output_nid generation:  0.0003368854522705078
local_in_edges_tensor generation:  0.0006604194641113281
mini_batch_src_global generation:  0.0008900165557861328
r_  generation:  0.010306596755981445
----------------------check_connections_block total spend ----------------------------- 0.0514225959777832
generate_one_block  0.011919736862182617
generate_one_block  0.009340047836303711
generate_one_block  0.014401674270629883
generate_one_block  0.014750242233276367
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003085136413574219  GigaBytes
Max Memory Allocated: 0.0003085136413574219  GigaBytes

connection checking time:  0.0677947998046875
block generation total time  0.07095551490783691
average batch blocks generation time:  0.01773887872695923
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.01816272735595703  GigaBytes
Max Memory Allocated: 0.01816272735595703  GigaBytes

torch.Size([9068, 500])
torch.Size([2796, 64])
torch.Size([671, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021393775939941406  GigaBytes
Max Memory Allocated: 0.022559165954589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.017242908477783203  GigaBytes
Max Memory Allocated: 0.034610748291015625  GigaBytes

torch.Size([8814, 500])
torch.Size([2336, 64])
torch.Size([535, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.019912242889404297  GigaBytes
Max Memory Allocated: 0.034610748291015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02121877670288086  GigaBytes
Max Memory Allocated: 0.03730201721191406  GigaBytes

torch.Size([10882, 500])
torch.Size([3609, 64])
torch.Size([857, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02537822723388672  GigaBytes
Max Memory Allocated: 0.03730201721191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.02290058135986328  GigaBytes
Max Memory Allocated: 0.04284524917602539  GigaBytes

torch.Size([11790, 500])
torch.Size([4087, 64])
torch.Size([831, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.027372360229492188  GigaBytes
Max Memory Allocated: 0.04284524917602539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007680058479309082 |0.0857495665550232 |0.19680023193359375 |0.00018793344497680664 |0.004314541816711426 |0.002562999725341797 |
----------------------------------------------------------pseudo_mini_loss sum 2.7053768634796143
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  56633
Number of first layer input nodes during this epoch:  40554
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.024241924285888672  GigaBytes
Max Memory Allocated: 0.04284524917602539  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005993843078613281
range selection method range initialization spend 7.724761962890625e-05
time for parepare:  6.914138793945312e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.888938903808594e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.3855438232421875e-05
----------------------check_connections_block total spend ----------------------------- 0.001230001449584961
generate_one_block  0.0015919208526611328
generate_one_block  0.0013213157653808594
generate_one_block  0.001293182373046875
generate_one_block  0.0012447834014892578
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006208419799804688
gen group dst list time:  4.410743713378906e-05
time for parepare:  0.00033783912658691406
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00022840499877929688
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0003566741943359375
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0006246566772460938
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00041294097900390625
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0005359649658203125
----------------------check_connections_block total spend ----------------------------- 0.004069805145263672
generate_one_block  0.0035712718963623047
generate_one_block  0.0035703182220458984
generate_one_block  0.002964019775390625
generate_one_block  0.0025789737701416016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00165557861328125
gen group dst list time:  0.0001220703125
time for parepare:  0.0011029243469238281
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.000957489013671875
mini_batch_src_global generation:  0.0002503395080566406
r_  generation:  0.002685546875
local_output_nid generation:  0.00012087821960449219
local_in_edges_tensor generation:  0.0003809928894042969
mini_batch_src_global generation:  0.0005028247833251953
r_  generation:  0.0033202171325683594
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  0.00022292137145996094
r_  generation:  0.001821756362915039
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  0.00015592575073242188
r_  generation:  0.0013942718505859375
----------------------check_connections_block total spend ----------------------------- 0.015905380249023438
generate_one_block  0.0036246776580810547
generate_one_block  0.005083799362182617
generate_one_block  0.003114461898803711
generate_one_block  0.0027039051055908203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001965761184692383
gen group dst list time:  0.00023889541625976562
time for parepare:  0.0013651847839355469
local_output_nid generation:  0.00017762184143066406
local_in_edges_tensor generation:  0.0007045269012451172
mini_batch_src_global generation:  0.0008096694946289062
r_  generation:  0.006968259811401367
local_output_nid generation:  0.00033402442932128906
local_in_edges_tensor generation:  0.0007445812225341797
mini_batch_src_global generation:  0.0012366771697998047
r_  generation:  0.011445045471191406
local_output_nid generation:  0.00024318695068359375
local_in_edges_tensor generation:  0.0005359649658203125
mini_batch_src_global generation:  0.0007715225219726562
r_  generation:  0.007275581359863281
local_output_nid generation:  0.0002384185791015625
local_in_edges_tensor generation:  0.0005207061767578125
mini_batch_src_global generation:  0.0007426738739013672
r_  generation:  0.007394075393676758
----------------------check_connections_block total spend ----------------------------- 0.049803733825683594
generate_one_block  0.01080775260925293
generate_one_block  0.016110897064208984
generate_one_block  0.010892152786254883
generate_one_block  0.011144638061523438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.024241924285888672  GigaBytes
Max Memory Allocated: 0.04284524917602539  GigaBytes

connection checking time:  0.0697789192199707
block generation total time  0.07616686820983887
average batch blocks generation time:  0.019041717052459717
block dataloader generation time/epoch 0.19425129890441895
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.017279624938964844  GigaBytes
Max Memory Allocated: 0.04284524917602539  GigaBytes

torch.Size([8490, 500])
torch.Size([2494, 64])
torch.Size([631, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.020195960998535156  GigaBytes
Max Memory Allocated: 0.04284524917602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.02555990219116211  GigaBytes
Max Memory Allocated: 0.04284524917602539  GigaBytes

torch.Size([12847, 500])
torch.Size([4603, 64])
torch.Size([1096, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.031186580657958984  GigaBytes
Max Memory Allocated: 0.04284524917602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.01912832260131836  GigaBytes
Max Memory Allocated: 0.04284524917602539  GigaBytes

torch.Size([9482, 500])
torch.Size([2916, 64])
torch.Size([689, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.02247142791748047  GigaBytes
Max Memory Allocated: 0.04284524917602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.019516468048095703  GigaBytes
Max Memory Allocated: 0.04284524917602539  GigaBytes

torch.Size([9688, 500])
torch.Size([2752, 64])
torch.Size([447, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.022435665130615234  GigaBytes
Max Memory Allocated: 0.04284524917602539  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006362855434417725 |0.0008679032325744629 |0.004936277866363525 |0.00013846158981323242 |0.0028107166290283203 |0.0018999576568603516 |
----------------------------------------------------------pseudo_mini_loss sum 1.7151180505752563
Total (block generation + training)time/epoch 0.26290225982666016
Training time/epoch 0.06837177276611328
Training time without block to device /epoch 0.06490015983581543
Training time without total dataloading part /epoch 0.033441781997680664
load block tensor time/epoch 0.0254514217376709
block to device time/epoch 0.0034716129302978516
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  56491
Number of first layer input nodes during this epoch:  40507
