main start at this time 1648527803.3552778
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018184185028076172
range selection method range initialization spend 9.989738464355469e-05
time for parepare:  4.38690185546875e-05
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.001453399658203125
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.09808349609375e-05
----------------------check_connections_block total spend ----------------------------- 0.004124641418457031
generate_one_block  0.0013017654418945312
generate_one_block  0.0010440349578857422
generate_one_block  0.0010547637939453125
generate_one_block  0.0010263919830322266
generate_one_block  0.0010175704956054688
generate_one_block  0.0010302066802978516
generate_one_block  0.0010743141174316406
generate_one_block  0.0010213851928710938
generate_one_block  0.0010535717010498047
generate_one_block  0.0010235309600830078
generate_one_block  0.0010273456573486328
generate_one_block  0.0010190010070800781
generate_one_block  0.0010190010070800781
generate_one_block  0.0010294914245605469
generate_one_block  0.000989675521850586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010213851928710938
gen group dst list time:  7.724761962890625e-05
time for parepare:  0.00025177001953125
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00013208389282226562
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00016760826110839844
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00027561187744140625
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00023174285888671875
local_output_nid generation:  1.430511474609375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  0.00010609626770019531
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.772445678710938e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  6.151199340820312e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.079673767089844e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  8.440017700195312e-05
----------------------check_connections_block total spend ----------------------------- 0.004640817642211914
generate_one_block  0.00115966796875
generate_one_block  0.0012562274932861328
generate_one_block  0.0014340877532958984
generate_one_block  0.0013616085052490234
generate_one_block  0.0010688304901123047
generate_one_block  0.001178741455078125
generate_one_block  0.0011229515075683594
generate_one_block  0.0010998249053955078
generate_one_block  0.0010073184967041016
generate_one_block  0.001111745834350586
generate_one_block  0.0011258125305175781
generate_one_block  0.0010612010955810547
generate_one_block  0.001071929931640625
generate_one_block  0.0010399818420410156
generate_one_block  0.0010492801666259766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001110076904296875
gen group dst list time:  0.00012183189392089844
time for parepare:  0.0007314682006835938
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00028252601623535156
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0007429122924804688
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  0.00014781951904296875
r_  generation:  0.0011811256408691406
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.0001747608184814453
r_  generation:  0.0017201900482177734
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  0.00017833709716796875
r_  generation:  0.001512765884399414
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00030303001403808594
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0002186298370361328
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0005373954772949219
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004127025604248047
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004134178161621094
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00011396408081054688
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003979206085205078
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0003447532653808594
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0003108978271484375
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00016570091247558594
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00021696090698242188
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00026679039001464844
----------------------check_connections_block total spend ----------------------------- 0.015532255172729492
generate_one_block  0.0021295547485351562
generate_one_block  0.002382516860961914
generate_one_block  0.003256559371948242
generate_one_block  0.002953052520751953
generate_one_block  0.0011868476867675781
generate_one_block  0.0015723705291748047
generate_one_block  0.0014712810516357422
generate_one_block  0.0014472007751464844
generate_one_block  0.0010483264923095703
generate_one_block  0.0014171600341796875
generate_one_block  0.0013356208801269531
generate_one_block  0.0013070106506347656
generate_one_block  0.0011243820190429688
generate_one_block  0.0011889934539794922
generate_one_block  0.0015256404876708984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

connection checking time:  0.020173072814941406
block generation total time  0.0424957275390625
average batch blocks generation time:  0.0028330485026041665
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.004208564758300781  GigaBytes
Max Memory Allocated: 0.004208564758300781  GigaBytes

torch.Size([1465, 500])
torch.Size([178, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004901409149169922  GigaBytes
Max Memory Allocated: 0.006136894226074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005798816680908203  GigaBytes
Max Memory Allocated: 0.008491039276123047  GigaBytes

torch.Size([1531, 500])
torch.Size([330, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0070056915283203125  GigaBytes
Max Memory Allocated: 0.008491039276123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009004592895507812  GigaBytes
Max Memory Allocated: 0.011806488037109375  GigaBytes

torch.Size([3245, 500])
torch.Size([681, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011437416076660156  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.006169795989990234  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

torch.Size([1725, 500])
torch.Size([489, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007863998413085938  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0036058425903320312  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

torch.Size([370, 500])
torch.Size([86, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.003926753997802734  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.004498004913330078  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

torch.Size([844, 500])
torch.Size([266, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.005436897277832031  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.004126548767089844  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

torch.Size([646, 500])
torch.Size([159, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.004702091217041016  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.004541873931884766  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

torch.Size([869, 500])
torch.Size([115, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.004996299743652344  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.003222942352294922  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

torch.Size([166, 500])
torch.Size([63, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0034780502319335938  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.004217624664306641  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

torch.Size([695, 500])
torch.Size([125, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0046787261962890625  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00403594970703125  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

torch.Size([599, 500])
torch.Size([167, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.004677772521972656  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0038499832153320312  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

torch.Size([499, 500])
torch.Size([133, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.004374504089355469  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.003383159637451172  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

torch.Size([251, 500])
torch.Size([82, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.003711223602294922  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0036783218383789062  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

torch.Size([409, 500])
torch.Size([92, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.004022121429443359  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0038766860961914062  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

torch.Size([514, 500])
torch.Size([125, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0044269561767578125  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0014709790547688803 |0.02359042167663574 |0.05469152132670085 |0.00013820330301920572 |0.002483828862508138 |0.0021865367889404297 |
----------------------------------------------------------pseudo_mini_loss sum 2.4861879348754883
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17276
Number of first layer input nodes during this epoch:  13828
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006803035736083984  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000499725341796875
range selection method range initialization spend 5.412101745605469e-05
time for parepare:  4.124641418457031e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.0265579223632812e-05
----------------------check_connections_block total spend ----------------------------- 0.0025992393493652344
generate_one_block  0.0010819435119628906
generate_one_block  0.0009968280792236328
generate_one_block  0.000985860824584961
generate_one_block  0.000982522964477539
generate_one_block  0.0010025501251220703
generate_one_block  0.0012238025665283203
generate_one_block  0.0010161399841308594
generate_one_block  0.0010001659393310547
generate_one_block  0.0010046958923339844
generate_one_block  0.0009732246398925781
generate_one_block  0.0009500980377197266
generate_one_block  0.0009696483612060547
generate_one_block  0.0009799003601074219
generate_one_block  0.0009362697601318359
generate_one_block  0.0009348392486572266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006422996520996094
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.0002541542053222656
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  8.106231689453125e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00025153160095214844
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  9.679794311523438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00020074844360351562
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00016570091247558594
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.772445678710938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00011324882507324219
----------------------check_connections_block total spend ----------------------------- 0.004587411880493164
generate_one_block  0.0010879039764404297
generate_one_block  0.0013365745544433594
generate_one_block  0.0011811256408691406
generate_one_block  0.0010721683502197266
generate_one_block  0.0010945796966552734
generate_one_block  0.0010755062103271484
generate_one_block  0.0012385845184326172
generate_one_block  0.0010590553283691406
generate_one_block  0.0010421276092529297
generate_one_block  0.00107574462890625
generate_one_block  0.0010485649108886719
generate_one_block  0.0009872913360595703
generate_one_block  0.0011951923370361328
generate_one_block  0.0010251998901367188
generate_one_block  0.0010707378387451172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011534690856933594
gen group dst list time:  0.00012612342834472656
time for parepare:  0.0008175373077392578
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00023937225341796875
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0003402233123779297
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.00022745132446289062
r_  generation:  0.0017237663269042969
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0005280971527099609
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0003972053527832031
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.00044465065002441406
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00023603439331054688
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  0.00011706352233886719
r_  generation:  0.0012569427490234375
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.0006496906280517578
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00017762184143066406
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00033283233642578125
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.0002410411834716797
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0004105567932128906
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0009002685546875
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.00036406517028808594
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0007123947143554688
----------------------check_connections_block total spend ----------------------------- 0.015865564346313477
generate_one_block  0.0016829967498779297
generate_one_block  0.0030558109283447266
generate_one_block  0.001628875732421875
generate_one_block  0.0013916492462158203
generate_one_block  0.0014200210571289062
generate_one_block  0.001194000244140625
generate_one_block  0.0024323463439941406
generate_one_block  0.0018010139465332031
generate_one_block  0.0011379718780517578
generate_one_block  0.0013110637664794922
generate_one_block  0.001210927963256836
generate_one_block  0.0014524459838867188
generate_one_block  0.002755403518676758
generate_one_block  0.0014164447784423828
generate_one_block  0.0017876625061035156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006803035736083984  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

connection checking time:  0.02045297622680664
block generation total time  0.042268991470336914
average batch blocks generation time:  0.0028179327646891275
block dataloader generation time/epoch 0.09553718566894531
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006883144378662109  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

torch.Size([569, 500])
torch.Size([173, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0074920654296875  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.010528564453125  GigaBytes
Max Memory Allocated: 0.014096260070800781  GigaBytes

torch.Size([2504, 500])
torch.Size([595, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012618064880371094  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007679462432861328  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

torch.Size([994, 500])
torch.Size([172, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.00836181640625  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007134914398193359  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

torch.Size([703, 500])
torch.Size([125, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007643699645996094  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007167339324951172  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

torch.Size([720, 500])
torch.Size([177, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007794380187988281  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006592750549316406  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

torch.Size([415, 500])
torch.Size([105, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007005214691162109  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008547306060791016  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

torch.Size([1447, 500])
torch.Size([342, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.009870529174804688  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008702278137207031  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

torch.Size([1541, 500])
torch.Size([169, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.009334564208984375  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006461143493652344  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

torch.Size([345, 500])
torch.Size([101, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006827831268310547  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006721973419189453  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

torch.Size([482, 500])
torch.Size([133, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007215023040771484  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006577491760253906  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

torch.Size([406, 500])
torch.Size([127, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007027626037597656  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007106781005859375  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

torch.Size([687, 500])
torch.Size([115, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007537841796875  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008739948272705078  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

torch.Size([1557, 500])
torch.Size([364, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01007843017578125  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007103919982910156  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

torch.Size([678, 500])
torch.Size([149, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.00768280029296875  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008394241333007812  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes
Using backend: pytorch

torch.Size([1374, 500])
torch.Size([260, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.00932455062866211  GigaBytes
Max Memory Allocated: 0.014667510986328125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0007377783457438151 |0.0004013697306315104 |0.003187131881713867 |0.00011771519978841146 |0.0030330022176106772 |0.0016150474548339844 |
----------------------------------------------------------pseudo_mini_loss sum 0.94826340675354
Total (block generation + training)time/epoch 0.22688007354736328
Training time/epoch 0.13107800483703613
Training time without block to device /epoch 0.12505745887756348
Training time without total dataloading part /epoch 0.09668278694152832
load block tensor time/epoch 0.011066675186157227
block to device time/epoch 0.006020545959472656
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17886
Number of first layer input nodes during this epoch:  14422
