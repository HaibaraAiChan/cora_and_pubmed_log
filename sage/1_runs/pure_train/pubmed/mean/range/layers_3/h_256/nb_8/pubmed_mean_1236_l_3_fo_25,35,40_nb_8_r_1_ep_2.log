main start at this time 1648527683.4510305
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019769668579101562
range selection method range initialization spend 8.058547973632812e-05
time for parepare:  4.315376281738281e-05
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.002581357955932617
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.3855438232421875e-05
----------------------check_connections_block total spend ----------------------------- 0.003558635711669922
generate_one_block  0.0013141632080078125
generate_one_block  0.0011315345764160156
generate_one_block  0.0011453628540039062
generate_one_block  0.0010716915130615234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009779930114746094
gen group dst list time:  3.4332275390625e-05
time for parepare:  0.00024127960205078125
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0005266666412353516
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0003523826599121094
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001964569091796875
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00019431114196777344
----------------------check_connections_block total spend ----------------------------- 0.002716064453125
generate_one_block  0.0018172264099121094
generate_one_block  0.0015110969543457031
generate_one_block  0.0013265609741210938
generate_one_block  0.0013074874877929688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009865760803222656
gen group dst list time:  6.914138793945312e-05
time for parepare:  0.0007338523864746094
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.00035858154296875
mini_batch_src_global generation:  0.0002968311309814453
r_  generation:  0.0032989978790283203
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  0.0003154277801513672
r_  generation:  0.0021011829376220703
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  0.00013446807861328125
r_  generation:  0.0011432170867919922
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  9.584426879882812e-05
r_  generation:  0.0008556842803955078
----------------------check_connections_block total spend ----------------------------- 0.012009620666503906
generate_one_block  0.005722522735595703
generate_one_block  0.0036246776580810547
generate_one_block  0.002269744873046875
generate_one_block  0.0019423961639404297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

connection checking time:  0.014725685119628906
block generation total time  0.019521713256835938
average batch blocks generation time:  0.004880428314208984
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.011150836944580078  GigaBytes
Max Memory Allocated: 0.011150836944580078  GigaBytes

torch.Size([5151, 500])
torch.Size([1202, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.015982627868652344  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007809162139892578  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

torch.Size([2596, 500])
torch.Size([754, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010518074035644531  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006556987762451172  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

torch.Size([1941, 500])
torch.Size([437, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.00821685791015625  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.005680084228515625  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

torch.Size([1474, 500])
torch.Size([402, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.007293224334716797  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01454836130142212 |0.08521753549575806 |0.19245922565460205 |0.0001774430274963379 |0.0034852027893066406 |0.0024023056030273438 |
----------------------------------------------------------pseudo_mini_loss sum 2.5749351978302
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14313
Number of first layer input nodes during this epoch:  11162
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.008643150329589844  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00043010711669921875
range selection method range initialization spend 4.982948303222656e-05
time for parepare:  4.172325134277344e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation: Using backend: pytorch
 9.632110595703125e-05
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.57763671875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.790855407714844e-05
----------------------check_connections_block total spend ----------------------------- 0.0009708404541015625
generate_one_block  0.0011260509490966797
generate_one_block  0.0009846687316894531
generate_one_block  0.0011377334594726562
generate_one_block  0.0009732246398925781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004734992980957031
gen group dst list time:  3.0517578125e-05
time for parepare:  0.0002167224884033203
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00036072731018066406
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0003864765167236328
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0001621246337890625
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0003304481506347656
----------------------check_connections_block total spend ----------------------------- 0.0025787353515625
generate_one_block  0.00145721435546875
generate_one_block  0.00141143798828125
generate_one_block  0.0011708736419677734
generate_one_block  0.0013496875762939453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008749961853027344
gen group dst list time:  7.104873657226562e-05
time for parepare:  0.0006282329559326172
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.00030922889709472656
mini_batch_src_global generation:  0.00024247169494628906
r_  generation:  0.0022745132446289062
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00021457672119140625
mini_batch_src_global generation:  0.00030159950256347656
r_  generation:  0.002083301544189453
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  0.00010895729064941406
r_  generation:  0.0006928443908691406
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.00016498565673828125
r_  generation:  0.0019462108612060547
----------------------check_connections_block total spend ----------------------------- 0.011487245559692383
generate_one_block  0.004120349884033203
generate_one_block  0.0037698745727539062
generate_one_block  0.0017833709716796875
generate_one_block  0.003667116165161133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.008643150329589844  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

connection checking time:  0.014065980911254883
block generation total time  0.01872992515563965
average batch blocks generation time:  0.004682481288909912
block dataloader generation time/epoch 0.04842209815979004
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.012909412384033203  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

torch.Size([3772, 500])
torch.Size([908, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.016254901885986328  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.011779308319091797  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

torch.Size([3168, 500])
torch.Size([749, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01459646224975586  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.008028984069824219  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

torch.Size([1178, 500])
torch.Size([357, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.009341239929199219  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.012569904327392578  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

torch.Size([3595, 500])
torch.Size([804, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015545368194580078  GigaBytes
Max Memory Allocated: 0.019597530364990234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0018755197525024414 |0.00039458274841308594 |0.0031118392944335938 |0.00010979175567626953 |0.0026062726974487305 |0.0014395713806152344 |
----------------------------------------------------------pseudo_mini_loss sum 0.7936580777168274
Total (block generation + training)time/epoch 0.08680248260498047
Training time/epoch 0.03818869590759277
Training time without block to device /epoch 0.03661036491394043
Training time without total dataloading part /epoch 0.02475118637084961
load block tensor time/epoch 0.007502079010009766
block to device time/epoch 0.0015783309936523438
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14888
Number of first layer input nodes during this epoch:  11713
