main start at this time 1648527753.4184966
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0026254653930664062
range selection method range initialization spend 8.463859558105469e-05
time for parepare:  4.57763671875e-05
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.001444101333618164
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.193450927734375e-05
----------------------check_connections_block total spend ----------------------------- 0.004282712936401367
generate_one_block  0.0013308525085449219
generate_one_block  0.0011067390441894531
generate_one_block  0.001127004623413086
generate_one_block  0.0011053085327148438
generate_one_block  0.0010921955108642578
generate_one_block  0.0010950565338134766
generate_one_block  0.0011034011840820312
generate_one_block  0.0010921955108642578
generate_one_block  0.0011258125305175781
generate_one_block  0.0011005401611328125
generate_one_block  0.0011026859283447266
generate_one_block  0.0010936260223388672
generate_one_block  0.001031637191772461
generate_one_block  0.0009911060333251953
generate_one_block  0.0010025501251220703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007812976837158203
gen group dst list time:  8.225440979003906e-05
time for parepare:  0.0002357959747314453
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00010061264038085938
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001575946807861328
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002560615539550781
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00022792816162109375
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010228157043457031
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  8.177757263183594e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.389617919921875e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.869171142578125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.462501525878906e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  7.891654968261719e-05
----------------------check_connections_block total spend ----------------------------- 0.004723787307739258
generate_one_block  0.0012311935424804688
generate_one_block  0.0013203620910644531
generate_one_block  0.00146484375
generate_one_block  0.001394510269165039
generate_one_block  0.0011403560638427734
generate_one_block  0.0012485980987548828
generate_one_block  0.0011944770812988281
generate_one_block  0.00121307373046875
generate_one_block  0.001051187515258789
generate_one_block  0.0010569095611572266
generate_one_block  0.001199960708618164
generate_one_block  0.0011067390441894531
generate_one_block  0.0010747909545898438
generate_one_block  0.0010304450988769531
generate_one_block  0.0010645389556884766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001081705093383789
gen group dst list time:  0.0001246929168701172
time for parepare:  0.0007572174072265625
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00025463104248046875
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0006358623504638672
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.0010907649993896484
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.00018787384033203125
r_  generation:  0.00160980224609375
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0014870166778564453
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0003063678741455078
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.00022745132446289062
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0005216598510742188
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0004334449768066406
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0004305839538574219
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00011968612670898438
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0004200935363769531
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0003628730773925781
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.00032639503479003906
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0001742839813232422
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00022864341735839844
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00027179718017578125
----------------------check_connections_block total spend ----------------------------- 0.01540064811706543
generate_one_block  0.002814769744873047
generate_one_block  0.0022318363189697266
generate_one_block  0.002866029739379883
generate_one_block  0.002680063247680664
generate_one_block  0.0011920928955078125
generate_one_block  0.0015201568603515625
generate_one_block  0.0014827251434326172
generate_one_block  0.001435995101928711
generate_one_block  0.0010533332824707031
generate_one_block  0.0014221668243408203
generate_one_block  0.0013325214385986328
generate_one_block  0.0013053417205810547
generate_one_block  0.0011255741119384766
generate_one_block  0.0011844635009765625
generate_one_block  0.0015115737915039062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

connection checking time:  0.020124435424804688
block generation total time  0.04295063018798828
average batch blocks generation time:  0.0028633753458658854
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.003966331481933594  GigaBytes
Max Memory Allocated: 0.003966331481933594  GigaBytes

torch.Size([1337, 500])
torch.Size([142, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004543781280517578  GigaBytes
Max Memory Allocated: 0.005665779113769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005623340606689453  GigaBytes
Max Memory Allocated: 0.008082866668701172  GigaBytes

torch.Size([1440, 500])
torch.Size([296, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006719112396240234  GigaBytes
Max Memory Allocated: 0.008082866668701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008277416229248047  GigaBytes
Max Memory Allocated: 0.01091623306274414  GigaBytes

torch.Size([2858, 500])
torch.Size([595, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010436058044433594  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006088733673095703  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

torch.Size([1683, 500])
torch.Size([448, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007652759552001953  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0036001205444335938  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

torch.Size([367, 500])
torch.Size([86, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003921031951904297  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0044078826904296875  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

torch.Size([796, 500])
torch.Size([242, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005270481109619141  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004130363464355469  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

torch.Size([648, 500])
torch.Size([159, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004705905914306641  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004530906677246094  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

torch.Size([863, 500])
torch.Size([115, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004985332489013672  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003222942352294922  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

torch.Size([166, 500])
torch.Size([63, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0034780502319335938  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004210472106933594  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

torch.Size([691, 500])
torch.Size([125, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004671573638916016  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004026889801025391  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

torch.Size([594, 500])
torch.Size([167, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004668712615966797  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003864765167236328  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

torch.Size([507, 500])
torch.Size([132, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004385948181152344  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003379344940185547  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

torch.Size([249, 500])
torch.Size([82, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003707408905029297  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0036725997924804688  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

torch.Size([406, 500])
torch.Size([92, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004016399383544922  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003857135772705078  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

torch.Size([504, 500])
torch.Size([119, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004387855529785156  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003987884521484375 |0.023444509506225585 |0.05362631479899089 |0.00012486775716145834 |0.0033715089162190755 |0.002718210220336914 |
----------------------------------------------------------pseudo_mini_loss sum 2.513089179992676
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16329
Number of first layer input nodes during this epoch:  13109
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006781101226806641  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005040168762207031
range selection method range initialization spend 5.4836273193359375e-05
time for parepare:  4.3392181396484375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6927719116210938e-05
----------------------check_connections_block total spend ----------------------------- 0.0027267932891845703
generate_one_block  0.0011944770812988281
generate_one_block  0.0010552406311035156
generate_one_block  0.001026153564453125
generate_one_block  0.001031637191772461
generate_one_block  0.0010132789611816406
generate_one_block  0.0012221336364746094
generate_one_block  0.0010876655578613281
generate_one_block  0.0010530948638916016
generate_one_block  0.0010144710540771484
generate_one_block  0.0010280609130859375
generate_one_block  0.0009725093841552734
generate_one_block  0.0009510517120361328
generate_one_block  0.0009663105010986328
generate_one_block  0.0009548664093017578
generate_one_block  0.0009675025939941406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006229877471923828
gen group dst list time:  8.130073547363281e-05
time for parepare:  0.0002541542053222656
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0002353191375732422
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  9.870529174804688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0001990795135498047
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  6.771087646484375e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.319450378417969e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.482269287109375e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00016498565673828125
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  7.605552673339844e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.00010251998901367188
----------------------check_connections_block total spend ----------------------------- 0.004667758941650391
generate_one_block  0.0011527538299560547
generate_one_block  0.0013346672058105469
generate_one_block  0.0011911392211914062
generate_one_block  0.0011212825775146484
generate_one_block  0.0011494159698486328
generate_one_block  0.0010867118835449219
generate_one_block  0.0012619495391845703
generate_one_block  0.0011260509490966797
generate_one_block  0.001065969467163086
generate_one_block  0.0010819435119628906
generate_one_block  0.0011250972747802734
generate_one_block  0.0010237693786621094
generate_one_block  0.0011496543884277344
generate_one_block  0.0010340213775634766
generate_one_block  0.0011260509490966797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011463165283203125
gen group dst list time:  0.00012564659118652344
time for parepare:  0.0007741451263427734
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0002455711364746094
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.00032258033752441406
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  0.0002129077911376953
r_  generation:  0.0015828609466552734
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  9.369850158691406e-05
r_  generation:  0.0005390644073486328
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004215240478515625
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00045680999755859375
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.0002307891845703125
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.0012078285217285156
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  8.225440979003906e-05
r_  generation:  0.0005099773406982422
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00014781951904296875
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00035572052001953125
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00023674964904785156
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002529621124267578
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.0009136199951171875
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0003826618194580078
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0006783008575439453
----------------------check_connections_block total spend ----------------------------- 0.015201330184936523
generate_one_block  0.0015933513641357422
generate_one_block  0.002989530563354492
generate_one_block  0.001584768295288086
generate_one_block  0.001407623291015625
generate_one_block  0.001508951187133789
generate_one_block  0.0012149810791015625
generate_one_block  0.0023620128631591797
generate_one_block  0.0016548633575439453
generate_one_block  0.001104593276977539
generate_one_block  0.0013396739959716797
generate_one_block  0.001291513442993164
generate_one_block  0.0012657642364501953
generate_one_block  0.002032756805419922
generate_one_block  0.0014269351959228516
generate_one_block  0.0017728805541992188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006781101226806641  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

connection checking time:  0.019869089126586914
block generation total time  0.0415806770324707
average batch blocks generation time:  0.0027720451354980467
block dataloader generation time/epoch 0.09607577323913574
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006799221038818359  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

torch.Size([525, 500])
torch.Size([147, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.007325649261474609  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01030588150024414  GigaBytes
Max Memory Allocated: 0.01274728775024414  GigaBytes

torch.Size([2387, 500])
torch.Size([542, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.012226104736328125  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.007683277130126953  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

torch.Size([996, 500])
torch.Size([172, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.008365631103515625  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.007129192352294922  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

torch.Size([700, 500])
torch.Size([125, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.007637977600097656  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.007198810577392578  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

torch.Size([737, 500])
torch.Size([177, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.007825851440429688  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006574153900146484  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

torch.Size([405, 500])
torch.Size([104, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006983280181884766  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.008449554443359375  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

torch.Size([1395, 500])
torch.Size([322, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.009709835052490234  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.007957935333251953  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

torch.Size([1144, 500])
torch.Size([133, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.008473873138427734  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.00630950927734375  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

torch.Size([264, 500])
torch.Size([76, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.0065975189208984375  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006720066070556641  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

torch.Size([481, 500])
torch.Size([133, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.007213115692138672  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006533145904541016  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

torch.Size([382, 500])
torch.Size([121, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006964683532714844  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.006722927093505859  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

torch.Size([484, 500])
torch.Size([80, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.007039546966552734  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.008736133575439453  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

torch.Size([1555, 500])
torch.Size([363, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.010071754455566406  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.007083415985107422  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

torch.Size([676, 500])
torch.Size([148, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.007658958435058594  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.00872945785522461  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes
Using backend: pytorch

torch.Size([1299, 500])
torch.Size([234, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.00957632064819336  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0005603631337483724 |0.0004180908203125 |0.003338750203450521 |0.00011992454528808594 |0.0031068007151285808 |0.0030477046966552734 |
----------------------------------------------------------pseudo_mini_loss sum 0.9417580962181091
Total (block generation + training)time/epoch 0.23061776161193848
Training time/epoch 0.13427448272705078
Training time without block to device /epoch 0.12800312042236328
Training time without total dataloading part /epoch 0.10152983665466309
load block tensor time/epoch 0.008405447006225586
block to device time/epoch 0.0062713623046875
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16664
Number of first layer input nodes during this epoch:  13430
