main start at this time 1648527833.3262749
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019409656524658203
range selection method range initialization spend 9.036064147949219e-05
time for parepare:  4.076957702636719e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0014264583587646484
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  3.170967102050781e-05
----------------------check_connections_block total spend ----------------------------- 0.002357959747314453
generate_one_block  0.0012750625610351562
generate_one_block  0.0010745525360107422
generate_one_block  0.001081228256225586
generate_one_block  0.0010783672332763672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009937286376953125
gen group dst list time:  3.075599670410156e-05
time for parepare:  0.0002307891845703125
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0005486011505126953
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0003485679626464844
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00018715858459472656
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001881122589111328
----------------------check_connections_block total spend ----------------------------- 0.0026357173919677734
generate_one_block  0.001756429672241211
generate_one_block  0.0014989376068115234
generate_one_block  0.0012667179107666016
generate_one_block  0.0012063980102539062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010178089141845703
gen group dst list time:  7.176399230957031e-05
time for parepare:  0.0007302761077880859
local_output_nid generation:  8.630752563476562e-05
local_in_edges_tensor generation:  0.00037026405334472656
mini_batch_src_global generation:  0.00031948089599609375
r_  generation:  0.004191875457763672
local_output_nid generation:  6.866455078125e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  0.00034880638122558594
r_  generation:  0.0024175643920898438
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  0.00015115737915039062
r_  generation:  0.0011992454528808594
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  0.00010323524475097656
r_  generation:  0.0009052753448486328
----------------------check_connections_block total spend ----------------------------- 0.013730287551879883
generate_one_block  0.006903409957885742
generate_one_block  0.00400543212890625
generate_one_block  0.0023856163024902344
generate_one_block  0.0020585060119628906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

connection checking time:  0.016366004943847656
block generation total time  0.02108144760131836
average batch blocks generation time:  0.00527036190032959
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.013305187225341797  GigaBytes
Max Memory Allocated: 0.013305187225341797  GigaBytes

torch.Size([6132, 500])
torch.Size([1367, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018241405487060547  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008327484130859375  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

torch.Size([2867, 500])
torch.Size([801, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011196613311767578  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.006948947906494141  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

torch.Size([2150, 500])
torch.Size([437, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.008611679077148438  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.005970954895019531  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

torch.Size([1629, 500])
torch.Size([409, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.007607936859130859  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00593191385269165 |0.08431529998779297 |0.19395148754119873 |0.00020962953567504883 |0.0033850669860839844 |0.0023152828216552734 |
----------------------------------------------------------pseudo_mini_loss sum 2.5420825481414795
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16148
Number of first layer input nodes during this epoch:  12778
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.008938312530517578  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005705356597900391
range selection method range initialization spend 7.176399230957031e-05
time for parepare:  6.270408630371094e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  6.318092346191406e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00012612342834472656
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.76837158203125e-05
----------------------check_connections_block total spend ----------------------------- 0.0012769699096679688
generate_one_block  0.0013298988342285156
generate_one_block  0.0012662410736083984
generate_one_block  0.0013959407806396484
generate_one_block  0.0012636184692382812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006184577941894531
gen group dst list time:  4.220008850097656e-05
time for parepare:  0.000331878662109375
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0005366802215576172
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  8.511543273925781e-05
r_  generation:  0.0004830360412597656
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0002148151397705078
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0004379749298095703
----------------------check_connections_block total spend ----------------------------- 0.0034852027893066406
generate_one_block  0.001909494400024414
generate_one_block  0.001810312271118164
generate_one_block  0.0014722347259521484
generate_one_block  0.0015110969543457031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011456012725830078
gen group dst list time:  9.036064147949219e-05
time for parepare:  0.0008270740509033203
local_output_nid generation:  8.511543273925781e-05
local_in_edges_tensor generation:  0.00033783912658691406
mini_batch_src_global generation:  0.0003180503845214844
r_  generation:  0.0032362937927246094
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.00023293495178222656
mini_batch_src_global generation:  0.0004017353057861328
r_  generation:  0.0029420852661132812
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.0008764266967773438
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  0.00021409988403320312
r_  generation:  0.002543926239013672
----------------------check_connections_block total spend ----------------------------- 0.015346527099609375
generate_one_block  0.005161762237548828
generate_one_block  0.0045812129974365234
generate_one_block  0.0018856525421142578
generate_one_block  0.003968000411987305
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.008938312530517578  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

connection checking time:  0.018831729888916016
block generation total time  0.022299766540527344
average batch blocks generation time:  0.005574941635131836
block dataloader generation time/epoch 0.05977678298950195
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.014096260070800781  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

torch.Size([4398, 500])
torch.Size([995, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.017732620239257812  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.013092041015625  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

torch.Size([3863, 500])
torch.Size([800, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.016086101531982422  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008280277252197266  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

torch.Size([1312, 500])
torch.Size([388, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.009691238403320312  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.013315200805664062  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

torch.Size([3990, 500])
torch.Size([864, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.016486167907714844  GigaBytes
Max Memory Allocated: 0.023189067840576172  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0011755824089050293 |0.0004343390464782715 |0.003403961658477783 |0.00012427568435668945 |0.0017009973526000977 |0.0015561580657958984 |
----------------------------------------------------------pseudo_mini_loss sum 0.8351147770881653
Total (block generation + training)time/epoch 0.09362053871154785
Training time/epoch 0.033679962158203125
Training time without block to device /epoch 0.03194260597229004
Training time without total dataloading part /epoch 0.02247309684753418
load block tensor time/epoch 0.004702329635620117
block to device time/epoch 0.001737356185913086
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16967
Number of first layer input nodes during this epoch:  13563
