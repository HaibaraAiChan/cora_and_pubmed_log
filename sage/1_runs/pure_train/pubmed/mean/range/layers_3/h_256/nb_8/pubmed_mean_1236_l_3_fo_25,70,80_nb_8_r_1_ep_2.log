main start at this time 1648527783.430494
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0017533302307128906
range selection method range initialization spend 8.630752563476562e-05
time for parepare:  5.7220458984375e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.001607656478881836
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.933906555175781e-05
----------------------check_connections_block total spend ----------------------------- 0.0027904510498046875
generate_one_block  0.001554250717163086
generate_one_block  0.001363515853881836
generate_one_block  0.0013992786407470703
generate_one_block  0.0013649463653564453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011472702026367188
gen group dst list time:  4.4345855712890625e-05
time for parepare:  0.0003154277801513672
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.000743865966796875
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0004582405090332031
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0002484321594238281
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0002453327178955078
----------------------check_connections_block total spend ----------------------------- 0.003530740737915039
generate_one_block  0.002325773239135742
generate_one_block  0.0019083023071289062
generate_one_block  0.0016155242919921875
generate_one_block  0.0015883445739746094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012254714965820312
gen group dst list time:  0.00011086463928222656
time for parepare:  0.0009486675262451172
local_output_nid generation:  0.0001232624053955078
local_in_edges_tensor generation:  0.0004601478576660156
mini_batch_src_global generation:  0.000400543212890625
r_  generation:  0.004699230194091797
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.0002803802490234375
mini_batch_src_global generation:  0.0004248619079589844
r_  generation:  0.0028221607208251953
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  0.00018334388732910156
r_  generation:  0.0013370513916015625
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0009517669677734375
----------------------check_connections_block total spend ----------------------------- 0.016047954559326172
generate_one_block  0.006329774856567383
generate_one_block  0.0037689208984375
generate_one_block  0.0022618770599365234
generate_one_block  0.0019676685333251953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

connection checking time:  0.01957869529724121
block generation total time  0.021766185760498047
average batch blocks generation time:  0.005441546440124512
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.011967658996582031  GigaBytes
Max Memory Allocated: 0.011967658996582031  GigaBytes

torch.Size([5582, 500])
torch.Size([1367, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01690530776977539  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007937908172607422  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

torch.Size([2663, 500])
torch.Size([801, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010797500610351562  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.006558418273925781  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

torch.Size([1942, 500])
torch.Size([437, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.00821828842163086  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.0056858062744140625  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

torch.Size([1477, 500])
torch.Size([409, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.007320880889892578  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010094821453094482 |0.08574014902114868 |0.19349461793899536 |0.00019878149032592773 |0.004066109657287598 |0.002157926559448242 |
----------------------------------------------------------pseudo_mini_loss sum 2.573916435241699
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15034
Number of first layer input nodes during this epoch:  11664
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.008648872375488281  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005023479461669922
range selection method range initialization spend 6.008148193359375e-05
time for parepare:  5.054473876953125e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00011157989501953125
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.2438507080078125e-05
----------------------check_connections_block total spend ----------------------------- 0.0011467933654785156
generate_one_block  0.001165628433227539
generate_one_block  0.0010569095611572266
generate_one_block  0.0011456012725830078
generate_one_block  0.0010371208190917969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005433559417724609
gen group dst list time:  3.361701965332031e-05
time for parepare:  0.00027108192443847656
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0004227161407470703
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0004031658172607422
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00017786026000976562
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0003638267517089844
----------------------check_connections_block total spend ----------------------------- 0.0029211044311523438
generate_one_block  0.0015869140625
generate_one_block  0.0014963150024414062
generate_one_block  0.0012209415435791016
generate_one_block  0.0014870166778564453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009887218475341797
gen group dst list time:  8.511543273925781e-05
time for parepare:  0.0006995201110839844
local_output_nid generation:  7.05718994140625e-05
local_in_edges_tensor generation:  0.00033664703369140625
mini_batch_src_global generation:  0.00026535987854003906
r_  generation:  0.0027170181274414062
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  0.00034999847412109375
r_  generation:  0.002484560012817383
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  0.0001266002655029297
r_  generation:  0.0008270740509033203
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.00022721290588378906
mini_batch_src_global generation:  0.00018835067749023438
r_  generation:  0.002252817153930664
----------------------check_connections_block total spend ----------------------------- 0.013301610946655273
generate_one_block  0.005382061004638672
generate_one_block  0.0041124820709228516
generate_one_block  0.0018444061279296875
generate_one_block  0.003738880157470703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.008648872375488281  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

connection checking time:  0.016222715377807617
block generation total time  0.020869016647338867
average batch blocks generation time:  0.005217254161834717
block dataloader generation time/epoch 0.05354905128479004
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01334238052368164  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

torch.Size([4000, 500])
torch.Size([995, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01696634292602539  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.012532234191894531  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

torch.Size([3568, 500])
torch.Size([800, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015515804290771484  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0081939697265625  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

torch.Size([1266, 500])
torch.Size([388, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.00960397720336914  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.012745380401611328  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

torch.Size([3687, 500])
torch.Size([864, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015910625457763672  GigaBytes
Max Memory Allocated: 0.021328449249267578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003932297229766846 |0.0005306005477905273 |0.00388413667678833 |0.00013625621795654297 |0.003380000591278076 |0.0016937255859375 |
----------------------------------------------------------pseudo_mini_loss sum 0.8420007228851318
Total (block generation + training)time/epoch 0.10883975028991699
Training time/epoch 0.05488300323486328
Training time without block to device /epoch 0.05276060104370117
Training time without total dataloading part /epoch 0.0312952995300293
load block tensor time/epoch 0.015729188919067383
block to device time/epoch 0.0021224021911621094
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15925
Number of first layer input nodes during this epoch:  12521
