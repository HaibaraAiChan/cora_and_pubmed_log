main start at this time 1648527703.4425936
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0022628307342529297
range selection method range initialization spend 0.00011181831359863281
time for parepare:  6.341934204101562e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0002334117889404297
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0035970211029052734
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.5299530029296875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1219253540039062e-05
----------------------check_connections_block total spend ----------------------------- 0.007086992263793945
generate_one_block  0.0013535022735595703
generate_one_block  0.0010368824005126953
generate_one_block  0.0010371208190917969
generate_one_block  0.0010247230529785156
generate_one_block  0.001012563705444336
generate_one_block  0.0010116100311279297
generate_one_block  0.001001119613647461
generate_one_block  0.0009875297546386719
generate_one_block  0.0009758472442626953
generate_one_block  0.0009393692016601562
generate_one_block  0.0009560585021972656
generate_one_block  0.0009453296661376953
generate_one_block  0.0009462833404541016
generate_one_block  0.0009462833404541016
generate_one_block  0.0009570121765136719
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009756088256835938
gen group dst list time:  8.082389831542969e-05
time for parepare:  0.00023055076599121094
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0001227855682373047
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00015354156494140625
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00024580955505371094
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00021958351135253906
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  5.340576171875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010180473327636719
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.246566772460938e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  8.821487426757812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.982948303222656e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  7.653236389160156e-05
----------------------check_connections_block total spend ----------------------------- 0.004610300064086914
generate_one_block  0.0011494159698486328
generate_one_block  0.0012328624725341797
generate_one_block  0.0013549327850341797
generate_one_block  0.0012898445129394531
generate_one_block  0.0010612010955810547
generate_one_block  0.0011420249938964844
generate_one_block  0.001100301742553711
generate_one_block  0.001132965087890625
generate_one_block  0.001035451889038086
generate_one_block  0.0010805130004882812
generate_one_block  0.0011241436004638672
generate_one_block  0.0010285377502441406
generate_one_block  0.0009911060333251953
generate_one_block  0.0009846687316894531
generate_one_block  0.0010313987731933594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010759830474853516
gen group dst list time:  0.0001251697540283203
time for parepare:  0.0007419586181640625
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.000244140625
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0006220340728759766
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.001043081283569336
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  0.00015783309936523438
r_  generation:  0.0015704631805419922
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.0001697540283203125
r_  generation:  0.0014414787292480469
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00029540061950683594
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0002224445343017578
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004992485046386719
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0004189014434814453
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004146099090576172
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001163482666015625
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0004074573516845703
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.00035190582275390625
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00031685829162597656
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00016951560974121094
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00022101402282714844
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002586841583251953
----------------------check_connections_block total spend ----------------------------- 0.014816522598266602
generate_one_block  0.001859903335571289
generate_one_block  0.0021851062774658203
generate_one_block  0.0028524398803710938
generate_one_block  0.0026726722717285156
generate_one_block  0.0011806488037109375
generate_one_block  0.0015056133270263672
generate_one_block  0.0014562606811523438
generate_one_block  0.001430511474609375
generate_one_block  0.0010406970977783203
generate_one_block  0.0014073848724365234
generate_one_block  0.0013375282287597656
generate_one_block  0.0012946128845214844
generate_one_block  0.0011110305786132812
generate_one_block  0.0011806488037109375
generate_one_block  0.0014996528625488281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

connection checking time:  0.019426822662353516
block generation total time  0.040754079818725586
average batch blocks generation time:  0.0027169386545817056
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.003968238830566406  GigaBytes
Max Memory Allocated: 0.003968238830566406  GigaBytes

torch.Size([1338, 500])
torch.Size([143, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0045490264892578125  GigaBytes
Max Memory Allocated: 0.005671501159667969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0056591033935546875  GigaBytes
Max Memory Allocated: 0.008120536804199219  GigaBytes

torch.Size([1459, 500])
torch.Size([296, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006754875183105469  GigaBytes
Max Memory Allocated: 0.008120536804199219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008272647857666016  GigaBytes
Max Memory Allocated: 0.010946273803710938  GigaBytes

torch.Size([2855, 500])
torch.Size([596, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010435104370117188  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006114482879638672  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

torch.Size([1697, 500])
torch.Size([444, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007666110992431641  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0035943984985351562  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

torch.Size([364, 500])
torch.Size([86, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003915309906005859  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004383563995361328  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

torch.Size([783, 500])
torch.Size([240, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.005239963531494141  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004120826721191406  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

torch.Size([643, 500])
torch.Size([159, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004696369171142578  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004506587982177734  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

torch.Size([850, 500])
torch.Size([115, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0049610137939453125  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003222942352294922  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

torch.Size([166, 500])
torch.Size([63, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0034780502319335938  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004229068756103516  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

torch.Size([701, 500])
torch.Size([125, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0046901702880859375  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.00403594970703125  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

torch.Size([599, 500])
torch.Size([167, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004677772521972656  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0038537979125976562  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

torch.Size([501, 500])
torch.Size([132, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004374980926513672  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003379344940185547  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

torch.Size([249, 500])
torch.Size([82, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003707408905029297  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0036783218383789062  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

torch.Size([409, 500])
torch.Size([92, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004022121429443359  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0038161277770996094  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

torch.Size([482, 500])
torch.Size([119, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0043468475341796875  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002944342295328776 |0.023939085006713868 |0.055289570490519205 |0.00016279220581054686 |0.0022452195485432942 |0.002878427505493164 |
----------------------------------------------------------pseudo_mini_loss sum 2.5053818225860596
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16312
Number of first layer input nodes during this epoch:  13096
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006740093231201172  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00047588348388671875
range selection method range initialization spend 5.698204040527344e-05
time for parepare:  4.3392181396484375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  2.002716064453125e-05
----------------------check_connections_block total spend ----------------------------- 0.0026769638061523438
generate_one_block  0.0011372566223144531
generate_one_block  0.0010216236114501953
generate_one_block  0.0009980201721191406
generate_one_block  0.0010046958923339844
generate_one_block  0.0009851455688476562
generate_one_block  0.0011985301971435547
generate_one_block  0.0010111331939697266
generate_one_block  0.0009927749633789062
generate_one_block  0.0009844303131103516
generate_one_block  0.0009853839874267578
generate_one_block  0.0009679794311523438
generate_one_block  0.0009250640869140625
generate_one_block  0.0009396076202392578
generate_one_block  0.0009312629699707031
generate_one_block  0.0009429454803466797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006165504455566406
gen group dst list time:  8.082389831542969e-05
time for parepare:  0.0002434253692626953
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  6.985664367675781e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00023627281188964844
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  9.703636169433594e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.915496826171875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00019168853759765625
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  6.628036499023438e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0001652240753173828
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  7.772445678710938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.00010251998901367188
----------------------check_connections_block total spend ----------------------------- 0.004498720169067383
generate_one_block  0.0011060237884521484
generate_one_block  0.0013034343719482422
generate_one_block  0.0011615753173828125
generate_one_block  0.0010759830474853516
generate_one_block  0.001085042953491211
generate_one_block  0.001058816909790039
generate_one_block  0.0012362003326416016
generate_one_block  0.0010631084442138672
generate_one_block  0.0010309219360351562
generate_one_block  0.0010752677917480469
generate_one_block  0.0010771751403808594
generate_one_block  0.0009729862213134766
generate_one_block  0.0011224746704101562
generate_one_block  0.0010061264038085938
generate_one_block  0.0010445117950439453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011038780212402344
gen group dst list time:  0.00012683868408203125
time for parepare:  0.0007584095001220703
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00027489662170410156
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0003097057342529297
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.0015718936920166016
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.0005352497100830078
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004019737243652344
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0004439353942871094
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002334117889404297
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  0.00010848045349121094
r_  generation:  0.0012211799621582031
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.0004665851593017578
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00013947486877441406
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00033926963806152344
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00023937225341796875
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0002923011779785156
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  8.559226989746094e-05
r_  generation:  0.0009126663208007812
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0003714561462402344
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0006649494171142578
----------------------check_connections_block total spend ----------------------------- 0.014940261840820312
generate_one_block  0.0015647411346435547
generate_one_block  0.0029518604278564453
generate_one_block  0.0015377998352050781
generate_one_block  0.0013802051544189453
generate_one_block  0.0014240741729736328
generate_one_block  0.0011856555938720703
generate_one_block  0.002368450164794922
generate_one_block  0.0015451908111572266
generate_one_block  0.001079559326171875
generate_one_block  0.0013089179992675781
generate_one_block  0.0011801719665527344
generate_one_block  0.0013070106506347656
generate_one_block  0.0019893646240234375
generate_one_block  0.0013921260833740234
generate_one_block  0.0017459392547607422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006740093231201172  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

connection checking time:  0.019438982009887695
block generation total time  0.04038071632385254
average batch blocks generation time:  0.0026920477549235025
block dataloader generation time/epoch 0.09301900863647461
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006855964660644531  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

torch.Size([555, 500])
torch.Size([147, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0073833465576171875  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010337352752685547  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

torch.Size([2404, 500])
torch.Size([543, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012260913848876953  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007685184478759766  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

torch.Size([997, 500])
torch.Size([172, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008367538452148438  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007133007049560547  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

torch.Size([702, 500])
torch.Size([125, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007641792297363281  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007189750671386719  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

torch.Size([732, 500])
torch.Size([177, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007816791534423828  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006590843200683594  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

torch.Size([414, 500])
torch.Size([104, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006999969482421875  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008473396301269531  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

torch.Size([1408, 500])
torch.Size([328, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009752273559570312  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007948875427246094  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

torch.Size([1139, 500])
torch.Size([132, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008461475372314453  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006289005279541016  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

torch.Size([253, 500])
torch.Size([76, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006577014923095703  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006714820861816406  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

torch.Size([478, 500])
torch.Size([133, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0072078704833984375  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0065364837646484375  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

torch.Size([384, 500])
torch.Size([121, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006968021392822266  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006843090057373047  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

torch.Size([548, 500])
torch.Size([81, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00716400146484375  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008754730224609375  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

torch.Size([1565, 500])
torch.Size([363, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010090351104736328  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007089138031005859  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

torch.Size([679, 500])
torch.Size([148, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007664680480957031  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008273124694824219  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes
Using backend: pytorch

torch.Size([1310, 500])
torch.Size([232, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009113788604736328  GigaBytes
Max Memory Allocated: 0.014228343963623047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0006998697916666667 |0.00040219624837239585 |0.0031683286031087238 |0.00011259714762369791 |0.0030176957448323567 |0.0016994476318359375 |
----------------------------------------------------------pseudo_mini_loss sum 0.9545160531997681
Total (block generation + training)time/epoch 0.22338056564331055
Training time/epoch 0.13005614280700684
Training time without block to device /epoch 0.1240231990814209
Training time without total dataloading part /epoch 0.09617877006530762
load block tensor time/epoch 0.010498046875
block to device time/epoch 0.0060329437255859375
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16807
Number of first layer input nodes during this epoch:  13568
