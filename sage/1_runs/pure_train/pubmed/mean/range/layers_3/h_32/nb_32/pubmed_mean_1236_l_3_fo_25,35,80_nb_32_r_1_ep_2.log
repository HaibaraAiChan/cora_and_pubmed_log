main start at this time 1648527153.3293378
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018951892852783203
range selection method range initialization spend 9.679794311523438e-05
time for parepare:  4.458427429199219e-05
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.0014600753784179688
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.6941299438476562e-05
----------------------check_connections_block total spend ----------------------------- 0.004243612289428711
generate_one_block  0.001336812973022461
generate_one_block  0.0011129379272460938
generate_one_block  0.001108407974243164
generate_one_block  0.0010967254638671875
generate_one_block  0.0011522769927978516
generate_one_block  0.0011172294616699219
generate_one_block  0.0011093616485595703
generate_one_block  0.0010983943939208984
generate_one_block  0.00113677978515625
generate_one_block  0.0011055469512939453
generate_one_block  0.001102447509765625
generate_one_block  0.001108407974243164
generate_one_block  0.001110076904296875
generate_one_block  0.0011203289031982422
generate_one_block  0.0010051727294921875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009565353393554688
gen group dst list time:  8.034706115722656e-05
time for parepare:  0.00023317337036132812
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  7.390975952148438e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  1.430511474609375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00024175643920898438
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0001583099365234375
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  9.298324584960938e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.390975952148438e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.246566772460938e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  9.512901306152344e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.7738037109375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001976490020751953
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00012350082397460938
----------------------check_connections_block total spend ----------------------------- 0.0046536922454833984
generate_one_block  0.00116729736328125
generate_one_block  0.0012021064758300781
generate_one_block  0.001157999038696289
generate_one_block  0.001146554946899414
generate_one_block  0.0014393329620361328
generate_one_block  0.0013222694396972656
generate_one_block  0.0012090206146240234
generate_one_block  0.0012035369873046875
generate_one_block  0.0011262893676757812
generate_one_block  0.001043081283569336
generate_one_block  0.0010645389556884766
generate_one_block  0.001154184341430664
generate_one_block  0.0011456012725830078
generate_one_block  0.0012269020080566406
generate_one_block  0.001171112060546875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011320114135742188
gen group dst list time:  0.0001220703125
time for parepare:  0.0007455348968505859
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0002567768096923828
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.0002753734588623047
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0004248619079589844
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0002789497375488281
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00023818016052246094
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.00029206275939941406
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.0014653205871582031
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  0.0001437664031982422
r_  generation:  0.001127004623413086
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0004394054412841797
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0003333091735839844
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00020074844360351562
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0003712177276611328
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0003085136413574219
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0005643367767333984
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0005927085876464844
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  0.00012183189392089844
r_  generation:  0.0012743473052978516
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0004646778106689453
----------------------check_connections_block total spend ----------------------------- 0.015192031860351562
generate_one_block  0.002254009246826172
generate_one_block  0.001573801040649414
generate_one_block  0.0014019012451171875
generate_one_block  0.001222848892211914
generate_one_block  0.0027229785919189453
generate_one_block  0.002200603485107422
generate_one_block  0.0014476776123046875
generate_one_block  0.0013072490692138672
generate_one_block  0.0011401176452636719
generate_one_block  0.0013556480407714844
generate_one_block  0.0012676715850830078
generate_one_block  0.001646280288696289
generate_one_block  0.0016696453094482422
generate_one_block  0.0024945735931396484
generate_one_block  0.0017004013061523438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

connection checking time:  0.01984572410583496
block generation total time  0.04318523406982422
average batch blocks generation time:  0.002879015604654948
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0009951591491699219  GigaBytes
Max Memory Allocated: 0.0009951591491699219  GigaBytes

torch.Size([458, 500])
torch.Size([106, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.0010576248168945312  GigaBytes
Max Memory Allocated: 0.0010962486267089844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0016679763793945312  GigaBytes
Max Memory Allocated: 0.002509593963623047  GigaBytes

torch.Size([747, 500])
torch.Size([149, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0017561912536621094  GigaBytes
Max Memory Allocated: 0.002509593963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011873245239257812  GigaBytes
Max Memory Allocated: 0.002570629119873047  GigaBytes

torch.Size([491, 500])
torch.Size([94, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012445449829101562  GigaBytes
Max Memory Allocated: 0.002570629119873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010504722595214844  GigaBytes
Max Memory Allocated: 0.002570629119873047  GigaBytes

torch.Size([418, 500])
torch.Size([92, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011053085327148438  GigaBytes
Max Memory Allocated: 0.002570629119873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005032062530517578  GigaBytes
Max Memory Allocated: 0.005769252777099609  GigaBytes

torch.Size([2537, 500])
torch.Size([569, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005335330963134766  GigaBytes
Max Memory Allocated: 0.005769252777099609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002395153045654297  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([1126, 500])
torch.Size([271, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002555370330810547  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0017724037170410156  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([803, 500])
torch.Size([197, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018830299377441406  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011653900146484375  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([478, 500])
torch.Size([116, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012369155883789062  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0008950233459472656  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([335, 500])
torch.Size([92, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0009489059448242188  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015854835510253906  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([703, 500])
torch.Size([94, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016498565673828125  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011830329895019531  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([488, 500])
torch.Size([126, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012555122375488281  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0026869773864746094  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([1292, 500])
torch.Size([193, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0028018951416015625  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0024423599243164062  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([1160, 500])
torch.Size([198, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0025539398193359375  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0035576820373535156  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([1748, 500])
torch.Size([394, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0037789344787597656  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015473365783691406  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([681, 500])
torch.Size([186, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016651153564453125  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0027976195017496747 |0.02385700543721517 |0.05315968195597331 |0.00012804667154947918 |0.002532323201497396 |0.0021355152130126953 |
----------------------------------------------------------pseudo_mini_loss sum 2.483910322189331
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16699
Number of first layer input nodes during this epoch:  13465
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018410682678222656  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004723072052001953
range selection method range initialization spend 5.245208740234375e-05
time for parepare:  4.57763671875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.1948089599609375e-05
----------------------check_connections_block total spend ----------------------------- 0.002766132354736328
generate_one_block  0.0011463165283203125
generate_one_block  0.0010323524475097656
generate_one_block  0.001039266586303711
generate_one_block  0.0010364055633544922
generate_one_block  0.0010149478912353516
generate_one_block  0.0012345314025878906
generate_one_block  0.0010328292846679688
generate_one_block  0.0010216236114501953
generate_one_block  0.0010209083557128906
generate_one_block  0.0010340213775634766
generate_one_block  0.0010089874267578125
generate_one_block  0.0009784698486328125
generate_one_block  0.0009453296661376953
generate_one_block  0.0009512901306152344
generate_one_block  0.0009543895721435547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006148815155029297
gen group dst list time:  8.082389831542969e-05
time for parepare:  0.0002579689025878906
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00016450881958007812
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001323223114013672
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00015163421630859375
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00010466575622558594
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.153915405273438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00021600723266601562
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  7.605552673339844e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.937980651855469e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00017023086547851562
----------------------check_connections_block total spend ----------------------------- 0.004640340805053711
generate_one_block  0.0010859966278076172
generate_one_block  0.0010998249053955078
generate_one_block  0.0013060569763183594
generate_one_block  0.0011849403381347656
generate_one_block  0.0010380744934082031
generate_one_block  0.0010824203491210938
generate_one_block  0.0012187957763671875
generate_one_block  0.0011408329010009766
generate_one_block  0.0010454654693603516
generate_one_block  0.0011949539184570312
generate_one_block  0.0010457038879394531
generate_one_block  0.0010154247283935547
generate_one_block  0.0011229515075683594
generate_one_block  0.0009818077087402344
generate_one_block  0.0011229515075683594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009593963623046875
gen group dst list time:  0.00012946128845214844
time for parepare:  0.0007765293121337891
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.000255584716796875
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00017309188842773438
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0003383159637451172
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  0.00014925003051757812
r_  generation:  0.0011394023895263672
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  0.00010228157043457031
r_  generation:  0.0006875991821289062
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00012564659118652344
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0003533363342285156
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0009405612945556641
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  8.511543273925781e-05
r_  generation:  0.0005578994750976562
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0005731582641601562
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  0.00016188621520996094
r_  generation:  0.001481771469116211
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.00021457672119140625
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0003254413604736328
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.00030231475830078125
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.0001964569091796875
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0009291172027587891
----------------------check_connections_block total spend ----------------------------- 0.015521526336669922
generate_one_block  0.0022535324096679688
generate_one_block  0.0014183521270751953
generate_one_block  0.002222776412963867
generate_one_block  0.0017080307006835938
generate_one_block  0.0010297298431396484
generate_one_block  0.001374959945678711
generate_one_block  0.002053499221801758
generate_one_block  0.001560211181640625
generate_one_block  0.0016427040100097656
generate_one_block  0.002635955810546875
generate_one_block  0.0011563301086425781
generate_one_block  0.0013039112091064453
generate_one_block  0.0012598037719726562
generate_one_block  0.0011949539184570312
generate_one_block  0.0019807815551757812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018410682678222656  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

connection checking time:  0.020161867141723633
block generation total time  0.041481733322143555
average batch blocks generation time:  0.0027654488881429036
block dataloader generation time/epoch 0.09534192085266113
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010633468627929688  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([287, 500])
torch.Size([72, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011086463928222656  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015716552734375  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([557, 500])
torch.Size([138, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016508102416992188  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00327301025390625  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([1458, 500])
torch.Size([329, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0034584999084472656  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002682209014892578  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([1148, 500])
torch.Size([251, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0028285980224609375  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0008068084716796875  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([150, 500])
torch.Size([43, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0008392333984375  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016770362854003906  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([613, 500])
torch.Size([123, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0017480850219726562  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004031658172607422  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([1869, 500])
torch.Size([353, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004224300384521484  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002247333526611328  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([916, 500])
torch.Size([175, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002353191375732422  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0028944015502929688  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([1264, 500])
torch.Size([175, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0029973983764648438  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0038843154907226562  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([1780, 500])
torch.Size([404, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004114627838134766  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012259483337402344  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([374, 500])
torch.Size([95, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012803077697753906  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015587806701660156  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([550, 500])
torch.Size([129, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016393661499023438  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0013585090637207031  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([443, 500])
torch.Size([144, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.001438140869140625  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012021064758300781  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

torch.Size([361, 500])
torch.Size([78, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012545585632324219  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0035996437072753906  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes
Using backend: pytorch

torch.Size([1637, 500])
torch.Size([355, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0038003921508789062  GigaBytes
Max Memory Allocated: 0.007088184356689453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0006769021352132161 |0.0004043102264404297 |0.0032479286193847655 |0.0001178900400797526 |0.003078285853068034 |0.0017077922821044922 |
----------------------------------------------------------pseudo_mini_loss sum 1.6563079357147217
Total (block generation + training)time/epoch 0.22773075103759766
Training time/epoch 0.13209199905395508
Training time without block to device /epoch 0.12602734565734863
Training time without total dataloading part /epoch 0.09836935997009277
load block tensor time/epoch 0.010153532028198242
block to device time/epoch 0.006064653396606445
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16628
Number of first layer input nodes during this epoch:  13407
