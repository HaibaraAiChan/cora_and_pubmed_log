main start at this time 1648527183.3805625
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014235973358154297
range selection method range initialization spend 8.320808410644531e-05
time for parepare:  4.458427429199219e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.0010647773742675781
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  5.078315734863281e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  5.0067901611328125e-05
----------------------check_connections_block total spend ----------------------------- 0.0020842552185058594
generate_one_block  0.00124359130859375
generate_one_block  0.0011608600616455078
generate_one_block  0.0011594295501708984
generate_one_block  0.0011296272277832031
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000797271728515625
gen group dst list time:  3.552436828613281e-05
time for parepare:  0.0002465248107910156
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00017833709716796875
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0005288124084472656
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00021696090698242188
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.0004405975341796875
----------------------check_connections_block total spend ----------------------------- 0.0028238296508789062
generate_one_block  0.0013370513916015625
generate_one_block  0.0017933845520019531
generate_one_block  0.0013515949249267578
generate_one_block  0.0016887187957763672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009884834289550781
gen group dst list time:  7.700920104980469e-05
time for parepare:  0.0007557868957519531
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.0011055469512939453
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.00025844573974609375
mini_batch_src_global generation:  0.0003151893615722656
r_  generation:  0.0031299591064453125
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0013709068298339844
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  0.0002243518829345703
r_  generation:  0.0026252269744873047
----------------------check_connections_block total spend ----------------------------- 0.013189315795898438
generate_one_block  0.0034151077270507812
generate_one_block  0.004773139953613281
generate_one_block  0.002681255340576172
generate_one_block  0.00425267219543457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

connection checking time:  0.016013145446777344
block generation total time  0.021292924880981445
average batch blocks generation time:  0.005323231220245361
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0035266876220703125  GigaBytes
Max Memory Allocated: 0.0035266876220703125  GigaBytes

torch.Size([1805, 500])
torch.Size([440, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0037598609924316406  GigaBytes
Max Memory Allocated: 0.003930091857910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008008480072021484  GigaBytes
Max Memory Allocated: 0.01128244400024414  GigaBytes

torch.Size([4110, 500])
torch.Size([1124, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008608818054199219  GigaBytes
Max Memory Allocated: 0.01128244400024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004868030548095703  GigaBytes
Max Memory Allocated: 0.012485980987548828  GigaBytes

torch.Size([2451, 500])
torch.Size([462, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005126476287841797  GigaBytes
Max Memory Allocated: 0.012485980987548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007063865661621094  GigaBytes
Max Memory Allocated: 0.012485980987548828  GigaBytes

torch.Size([3610, 500])
torch.Size([951, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007588386535644531  GigaBytes
Max Memory Allocated: 0.012485980987548828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011965513229370117 |0.08644843101501465 |0.19677233695983887 |0.00017911195755004883 |0.003072023391723633 |0.002280712127685547 |
----------------------------------------------------------pseudo_mini_loss sum 2.1502304077148438
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15308
Number of first layer input nodes during this epoch:  11976
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007497310638427734  GigaBytes
Max Memory Allocated: 0.012485980987548828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005500316619873047
range selection method range initialization spend 6.222724914550781e-05
time for parepare:  5.936622619628906e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00012421607971191406
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.76837158203125e-05
----------------------check_connections_block total spend ----------------------------- 0.0012235641479492188
generate_one_block  0.0013272762298583984
generate_one_block  0.0012612342834472656
generate_one_block  0.001415252685546875
generate_one_block  0.00127410888671875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006306171417236328
gen group dst list time:  4.291534423828125e-05
time for parepare:  0.0003256797790527344
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00023555755615234375
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0004024505615234375
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0003533363342285156
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0005183219909667969
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0003554821014404297
----------------------check_connections_block total spend ----------------------------- 0.0034210681915283203
generate_one_block  0.0017590522766113281
generate_one_block  0.0016698837280273438
generate_one_block  0.0019249916076660156
generate_one_block  0.0016705989837646484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012173652648925781
gen group dst list time:  0.00010704994201660156
time for parepare:  0.0009293556213378906
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.0003490447998046875
mini_batch_src_global generation:  0.0002570152282714844
r_  generation:  0.0026192665100097656
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  0.0003039836883544922
r_  generation:  0.002187967300415039
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.000293731689453125
mini_batch_src_global generation:  0.0003612041473388672
r_  generation:  0.0033872127532958984
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.00025177001953125
mini_batch_src_global generation:  0.00022983551025390625
r_  generation:  0.0016779899597167969
----------------------check_connections_block total spend ----------------------------- 0.016329050064086914
generate_one_block  0.0038480758666992188
generate_one_block  0.003208637237548828
generate_one_block  0.004405975341796875
generate_one_block  0.0027353763580322266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007497310638427734  GigaBytes
Max Memory Allocated: 0.012485980987548828  GigaBytes

connection checking time:  0.019750118255615234
block generation total time  0.021222591400146484
average batch blocks generation time:  0.005305647850036621
block dataloader generation time/epoch 0.059449195861816406
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005934238433837891  GigaBytes
Max Memory Allocated: 0.012597084045410156  GigaBytes

torch.Size([2872, 500])
torch.Size([714, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0063304901123046875  GigaBytes
Max Memory Allocated: 0.012597084045410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006002902984619141  GigaBytes
Max Memory Allocated: 0.012597084045410156  GigaBytes

torch.Size([2915, 500])
torch.Size([727, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006381511688232422  GigaBytes
Max Memory Allocated: 0.012597084045410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007884025573730469  GigaBytes
Max Memory Allocated: 0.013233184814453125  GigaBytes

torch.Size([3908, 500])
torch.Size([906, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008377552032470703  GigaBytes
Max Memory Allocated: 0.013233184814453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005996227264404297  GigaBytes
Max Memory Allocated: 0.013233184814453125  GigaBytes

torch.Size([2568, 500])
torch.Size([665, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0063610076904296875  GigaBytes
Max Memory Allocated: 0.013233184814453125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0032691359519958496 |0.0004366636276245117 |0.0032753944396972656 |0.0001221299171447754 |0.0020751953125 |0.0014491081237792969 |
----------------------------------------------------------pseudo_mini_loss sum 1.6550748348236084
Total (block generation + training)time/epoch 0.10253071784973145
Training time/epoch 0.04285883903503418
Training time without block to device /epoch 0.04111218452453613
Training time without total dataloading part /epoch 0.02333998680114746
load block tensor time/epoch 0.013076543807983398
block to device time/epoch 0.0017466545104980469
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15631
Number of first layer input nodes during this epoch:  12263
