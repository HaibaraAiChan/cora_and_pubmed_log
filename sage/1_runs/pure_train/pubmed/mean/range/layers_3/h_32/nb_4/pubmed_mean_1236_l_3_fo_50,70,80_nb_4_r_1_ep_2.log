main start at this time 1648527223.4544957
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020983219146728516
range selection method range initialization spend 8.058547973632812e-05
time for parepare:  4.410743713378906e-05
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.002596616744995117
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  6.604194641113281e-05
----------------------check_connections_block total spend ----------------------------- 0.003264904022216797
generate_one_block  0.0013952255249023438
generate_one_block  0.0010941028594970703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009670257568359375
gen group dst list time:  2.4318695068359375e-05
time for parepare:  0.00023555755615234375
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0006499290466308594
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0005848407745361328
----------------------check_connections_block total spend ----------------------------- 0.002310037612915039
generate_one_block  0.002003192901611328
generate_one_block  0.0017883777618408203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001085042953491211
gen group dst list time:  6.4849853515625e-05
time for parepare:  0.0007419586181640625
local_output_nid generation:  0.00010585784912109375
local_in_edges_tensor generation:  0.0003914833068847656
mini_batch_src_global generation:  0.0003147125244140625
r_  generation:  0.004210233688354492
local_output_nid generation:  9.775161743164062e-05
local_in_edges_tensor generation:  0.0002942085266113281
mini_batch_src_global generation:  0.00051116943359375
r_  generation:  0.004054069519042969
----------------------check_connections_block total spend ----------------------------- 0.012971162796020508
generate_one_block  0.006612062454223633
generate_one_block  0.006367206573486328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

connection checking time:  0.015281200408935547
block generation total time  0.01677083969116211
average batch blocks generation time:  0.008385419845581055
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.010437488555908203  GigaBytes
Max Memory Allocated: 0.010437488555908203  GigaBytes

torch.Size([5462, 500])
torch.Size([1523, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.01125955581665039  GigaBytes
Max Memory Allocated: 0.011757850646972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012106895446777344  GigaBytes
Max Memory Allocated: 0.02215719223022461  GigaBytes

torch.Size([5774, 500])
torch.Size([1377, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012878894805908203  GigaBytes
Max Memory Allocated: 0.02215719223022461  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009223461151123047 |0.17182135581970215 |0.38222968578338623 |0.0002187490463256836 |0.004664063453674316 |0.002259969711303711 |
----------------------------------------------------------pseudo_mini_loss sum 2.2672195434570312
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14490
Number of first layer input nodes during this epoch:  11236
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012648582458496094  GigaBytes
Max Memory Allocated: 0.02215719223022461  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005860328674316406
range selection method range initialization spend 7.367134094238281e-05
time for parepare:  5.602836608886719e-05
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  7.534027099609375e-05
----------------------check_connections_block total spend ----------------------------- 0.0007653236389160156
generate_one_block  0.001405954360961914
generate_one_block  0.0013399124145507812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006146430969238281
gen group dst list time:  3.075599670410156e-05
time for parepare:  0.0003821849822998047
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.0007715225219726562
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  0.00012946128845214844
r_  generation:  0.0008819103240966797
----------------------check_connections_block total spend ----------------------------- 0.0031244754791259766
generate_one_block  0.002171039581298828
generate_one_block  0.0023238658905029297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012390613555908203
gen group dst list time:  9.083747863769531e-05
time for parepare:  0.0010063648223876953
local_output_nid generation:  0.00014328956604003906
local_in_edges_tensor generation:  0.0004398822784423828
mini_batch_src_global generation:  0.0004994869232177734
r_  generation:  0.005303144454956055
local_output_nid generation:  0.00017690658569335938
local_in_edges_tensor generation:  0.0003936290740966797
mini_batch_src_global generation:  0.0007295608520507812
r_  generation:  0.0052030086517333984
----------------------check_connections_block total spend ----------------------------- 0.016908884048461914
generate_one_block  0.00626826286315918
generate_one_block  0.00671076774597168
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012648582458496094  GigaBytes
Max Memory Allocated: 0.02215719223022461  GigaBytes

connection checking time:  0.02003335952758789
block generation total time  0.017473936080932617
average batch blocks generation time:  0.008736968040466309
block dataloader generation time/epoch 0.05244851112365723
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.010367870330810547  GigaBytes
Max Memory Allocated: 0.02215719223022461  GigaBytes
Using backend: pytorch

torch.Size([5220, 500])
torch.Size([1405, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011132240295410156  GigaBytes
Max Memory Allocated: 0.02215719223022461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0123748779296875  GigaBytes
Max Memory Allocated: 0.02215719223022461  GigaBytes

torch.Size([6050, 500])
torch.Size([1522, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013214588165283203  GigaBytes
Max Memory Allocated: 0.02215719223022461  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002476334571838379 |0.0008002519607543945 |0.005409836769104004 |0.00020813941955566406 |0.002719879150390625 |0.002503633499145508 |
----------------------------------------------------------pseudo_mini_loss sum 1.715099811553955
Total (block generation + training)time/epoch 0.08257651329040527
Training time/epoch 0.02996230125427246
Training time without block to device /epoch 0.028361797332763672
Training time without total dataloading part /epoch 0.019179344177246094
load block tensor time/epoch 0.004952669143676758
block to device time/epoch 0.001600503921508789
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14552
Number of first layer input nodes during this epoch:  11270
