main start at this time 1648527103.3455818
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013892650604248047
range selection method range initialization spend 9.679794311523438e-05
time for parepare:  4.172325134277344e-05
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  0.0011096000671386719
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.1682510375976562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.5987625122070312e-05
----------------------check_connections_block total spend ----------------------------- 0.0037317276000976562
generate_one_block  0.0012564659118652344
generate_one_block  0.0009937286376953125
generate_one_block  0.0009701251983642578
generate_one_block  0.0009732246398925781
generate_one_block  0.0010101795196533203
generate_one_block  0.0009832382202148438
generate_one_block  0.0009839534759521484
generate_one_block  0.0009706020355224609
generate_one_block  0.0010170936584472656
generate_one_block  0.0009732246398925781
generate_one_block  0.0009720325469970703
generate_one_block  0.00099945068359375
generate_one_block  0.0010018348693847656
generate_one_block  0.000986337661743164
generate_one_block  0.0009856224060058594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008919239044189453
gen group dst list time:  8.058547973632812e-05
time for parepare:  0.00022649765014648438
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  7.915496826171875e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.482269287109375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00022721290588378906
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0001513957977294922
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  8.749961853027344e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.961822509765625e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.57763671875e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  8.893013000488281e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  8.416175842285156e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00018358230590820312
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0001163482666015625
----------------------check_connections_block total spend ----------------------------- 0.004416465759277344
generate_one_block  0.0010762214660644531
generate_one_block  0.0011019706726074219
generate_one_block  0.0010573863983154297
generate_one_block  0.0010461807250976562
generate_one_block  0.0013244152069091797
generate_one_block  0.0012156963348388672
generate_one_block  0.0011053085327148438
generate_one_block  0.0011212825775146484
generate_one_block  0.0010025501251220703
generate_one_block  0.0010609626770019531
generate_one_block  0.0010745525360107422
generate_one_block  0.0010602474212646484
generate_one_block  0.0011162757873535156
generate_one_block  0.0012142658233642578
generate_one_block  0.0010809898376464844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009758472442626953
gen group dst list time:  0.0001201629638671875
time for parepare:  0.000698089599609375
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00023174285888671875
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002620220184326172
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.000396728515625
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0002658367156982422
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00022602081298828125
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.0002815723419189453
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.0013926029205322266
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  0.000141143798828125
r_  generation:  0.0010542869567871094
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0004253387451171875
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0003132820129394531
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0001919269561767578
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0003521442413330078
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0002846717834472656
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.0005230903625488281
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0005633831024169922
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  0.00011754035949707031
r_  generation:  0.0012295246124267578
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0004410743713378906
----------------------check_connections_block total spend ----------------------------- 0.014417409896850586
generate_one_block  0.0013706684112548828
generate_one_block  0.0015053749084472656
generate_one_block  0.0012860298156738281
generate_one_block  0.0012316703796386719
generate_one_block  0.0027077198028564453
generate_one_block  0.002241849899291992
generate_one_block  0.0014755725860595703
generate_one_block  0.0013353824615478516
generate_one_block  0.001161336898803711
generate_one_block  0.0013811588287353516
generate_one_block  0.0012927055358886719
generate_one_block  0.0016849040985107422
generate_one_block  0.0016989707946777344
generate_one_block  0.0032546520233154297
generate_one_block  0.0017101764678955078
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

connection checking time:  0.01883387565612793
block generation total time  0.04199647903442383
average batch blocks generation time:  0.0027997652689615887
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.000972747802734375  GigaBytes
Max Memory Allocated: 0.000972747802734375  GigaBytes

torch.Size([446, 500])
torch.Size([106, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.0010352134704589844  GigaBytes
Max Memory Allocated: 0.0010724067687988281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0017070770263671875  GigaBytes
Max Memory Allocated: 0.0025262832641601562  GigaBytes

torch.Size([768, 500])
torch.Size([148, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0017938613891601562  GigaBytes
Max Memory Allocated: 0.0025262832641601562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011858940124511719  GigaBytes
Max Memory Allocated: 0.0026082992553710938  GigaBytes

torch.Size([490, 500])
torch.Size([94, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012431144714355469  GigaBytes
Max Memory Allocated: 0.0026082992553710938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010504722595214844  GigaBytes
Max Memory Allocated: 0.0026082992553710938  GigaBytes

torch.Size([418, 500])
torch.Size([92, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011053085327148438  GigaBytes
Max Memory Allocated: 0.0026082992553710938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005063533782958984  GigaBytes
Max Memory Allocated: 0.005800724029541016  GigaBytes

torch.Size([2554, 500])
torch.Size([570, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005366802215576172  GigaBytes
Max Memory Allocated: 0.005800724029541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002383708953857422  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([1120, 500])
torch.Size([270, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002543926239013672  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([798, 500])
torch.Size([197, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018739700317382812  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011539459228515625  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([472, 500])
torch.Size([116, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012254714965820312  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0008950233459472656  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([335, 500])
torch.Size([92, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0009489059448242188  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016002655029296875  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([711, 500])
torch.Size([94, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016646385192871094  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011773109436035156  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([485, 500])
torch.Size([126, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012497901916503906  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0026612281799316406  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([1278, 500])
torch.Size([192, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0027742385864257812  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0024290084838867188  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([1153, 500])
torch.Size([198, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00254058837890625  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0035462379455566406  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([1742, 500])
torch.Size([393, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0037674903869628906  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.001560211181640625  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([688, 500])
torch.Size([186, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016779899597167969  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0015240192413330078 |0.02325716018676758 |0.054319111506144206 |0.00014297167460123697 |0.0020900408426920572 |0.002140522003173828 |
----------------------------------------------------------pseudo_mini_loss sum 2.4690239429473877
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16689
Number of first layer input nodes during this epoch:  13458
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00185394287109375  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004553794860839844
range selection method range initialization spend 5.221366882324219e-05
time for parepare:  4.315376281738281e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  3.0994415283203125e-05
----------------------check_connections_block total spend ----------------------------- 0.0026111602783203125
generate_one_block  0.001066446304321289
generate_one_block  0.0009937286376953125
generate_one_block  0.0009951591491699219
generate_one_block  0.0010535717010498047
generate_one_block  0.0009765625
generate_one_block  0.0011892318725585938
generate_one_block  0.0010030269622802734
generate_one_block  0.0009882450103759766
generate_one_block  0.0009868144989013672
generate_one_block  0.000997781753540039
generate_one_block  0.0009565353393554688
generate_one_block  0.0009453296661376953
generate_one_block  0.0009377002716064453
generate_one_block  0.0009458065032958984
generate_one_block  0.0009646415710449219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006186962127685547
gen group dst list time:  7.939338684082031e-05
time for parepare:  0.00023937225341796875
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00015544891357421875
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001232624053955078
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00016808509826660156
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.965896606445312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.772445678710938e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0002071857452392578
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  5.078315734863281e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  7.390975952148438e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00016188621520996094
----------------------check_connections_block total spend ----------------------------- 0.004401683807373047
generate_one_block  0.001041412353515625
generate_one_block  0.0010921955108642578
generate_one_block  0.0012629032135009766
generate_one_block  0.0011334419250488281
generate_one_block  0.0010085105895996094
generate_one_block  0.0010409355163574219
generate_one_block  0.0011625289916992188
generate_one_block  0.001096487045288086
generate_one_block  0.0010905265808105469
generate_one_block  0.00119781494140625
generate_one_block  0.0009856224060058594
generate_one_block  0.0010266304016113281
generate_one_block  0.0010738372802734375
generate_one_block  0.0009815692901611328
generate_one_block  0.0011417865753173828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001100301742553711
gen group dst list time:  0.00012230873107910156
time for parepare:  0.0007472038269042969
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0002582073211669922
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00016450881958007812
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0003197193145751953
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  0.00014495849609375
r_  generation:  0.0010983943939208984
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  0.00010037422180175781
r_  generation:  0.0006546974182128906
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00012493133544921875
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0003333091735839844
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0008904933929443359
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0005271434783935547
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.0005233287811279297
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  0.00014925003051757812
r_  generation:  0.0014281272888183594
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.00020432472229003906
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0003032684326171875
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00027751922607421875
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00018405914306640625
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0008847713470458984
----------------------check_connections_block total spend ----------------------------- 0.014783143997192383
generate_one_block  0.0014290809631347656
generate_one_block  0.001392364501953125
generate_one_block  0.0022711753845214844
generate_one_block  0.0017285346984863281
generate_one_block  0.0010464191436767578
generate_one_block  0.0013651847839355469
generate_one_block  0.0020453929901123047
generate_one_block  0.0015537738800048828
generate_one_block  0.0016489028930664062
generate_one_block  0.0033872127532958984
generate_one_block  0.0011823177337646484
generate_one_block  0.0012993812561035156
generate_one_block  0.0012543201446533203
generate_one_block  0.0012083053588867188
generate_one_block  0.001978158950805664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00185394287109375  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

connection checking time:  0.01918482780456543
block generation total time  0.04112672805786133
average batch blocks generation time:  0.0027417818705240886
block dataloader generation time/epoch 0.09339380264282227
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010576248168945312  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([284, 500])
torch.Size([72, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011029243469238281  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015606880187988281  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([551, 500])
torch.Size([139, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016398429870605469  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0033445358276367188  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([1496, 500])
torch.Size([334, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00353240966796875  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0026764869689941406  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([1145, 500])
torch.Size([253, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0028243064880371094  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0008068084716796875  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([150, 500])
torch.Size([43, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0008392333984375  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016660690307617188  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([607, 500])
torch.Size([121, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0017371177673339844  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00402069091796875  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([1863, 500])
torch.Size([354, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0042133331298828125  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0022525787353515625  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([919, 500])
torch.Size([175, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0023584365844726562  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00286102294921875  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([1246, 500])
torch.Size([175, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002964019775390625  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0039000511169433594  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([1789, 500])
torch.Size([402, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0041294097900390625  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012345314025878906  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([378, 500])
torch.Size([95, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012898445129394531  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015439987182617188  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([542, 500])
torch.Size([129, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016245841979980469  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0013232231140136719  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([424, 500])
torch.Size([146, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0014047622680664062  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012054443359375  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

torch.Size([363, 500])
torch.Size([78, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012578964233398438  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0035886764526367188  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes
Using backend: pytorch

torch.Size([1631, 500])
torch.Size([355, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0037894248962402344  GigaBytes
Max Memory Allocated: 0.007108211517333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0006978829701741536 |0.0003814061482747396 |0.003034162521362305 |0.00011154810587565104 |0.0022731939951578777 |0.001392364501953125 |
----------------------------------------------------------pseudo_mini_loss sum 1.6489006280899048
Total (block generation + training)time/epoch 0.2088909149169922
Training time/epoch 0.11518669128417969
Training time without block to device /epoch 0.1094655990600586
Training time without total dataloading part /epoch 0.08267593383789062
load block tensor time/epoch 0.010468244552612305
block to device time/epoch 0.005721092224121094
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16616
Number of first layer input nodes during this epoch:  13388
