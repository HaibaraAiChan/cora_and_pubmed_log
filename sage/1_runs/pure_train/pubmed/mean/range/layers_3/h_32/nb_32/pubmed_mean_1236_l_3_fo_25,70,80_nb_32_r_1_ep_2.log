main start at this time 1648527203.4088297
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006899833679199219
range selection method range initialization spend 0.0001068115234375
time for parepare:  5.1975250244140625e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.002004861831665039
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.956390380859375e-05
----------------------check_connections_block total spend ----------------------------- 0.00521087646484375
generate_one_block  0.001461029052734375
generate_one_block  0.0012178421020507812
generate_one_block  0.0012001991271972656
generate_one_block  0.001207113265991211
generate_one_block  0.0012273788452148438
generate_one_block  0.0012097358703613281
generate_one_block  0.0011532306671142578
generate_one_block  0.0010251998901367188
generate_one_block  0.0010492801666259766
generate_one_block  0.0010271072387695312
generate_one_block  0.0010182857513427734
generate_one_block  0.0010242462158203125
generate_one_block  0.0010333061218261719
generate_one_block  0.0010635852813720703
generate_one_block  0.0009548664093017578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006077289581298828
gen group dst list time:  0.00010418891906738281
time for parepare:  0.0003025531768798828
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  6.890296936035156e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.846687316894531e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.626678466796875e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00029206275939941406
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00019669532775878906
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00010967254638671875
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  8.535385131835938e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0001277923583984375
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00011205673217773438
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00024509429931640625
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00014543533325195312
----------------------check_connections_block total spend ----------------------------- 0.005530118942260742
generate_one_block  0.0012912750244140625
generate_one_block  0.0013267993927001953
generate_one_block  0.0012936592102050781
generate_one_block  0.001260519027709961
generate_one_block  0.0015797615051269531
generate_one_block  0.0014498233795166016
generate_one_block  0.0011012554168701172
generate_one_block  0.001055002212524414
generate_one_block  0.0009870529174804688
generate_one_block  0.0009884834289550781
generate_one_block  0.0010023117065429688
generate_one_block  0.0010669231414794922
generate_one_block  0.0011165142059326172
generate_one_block  0.0011851787567138672
generate_one_block  0.0010614395141601562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011169910430908203
gen group dst list time:  0.0001609325408935547
time for parepare:  0.0009181499481201172
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00026988983154296875
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00032258033752441406
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0005459785461425781
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0004513263702392578
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0002868175506591797
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.00036406517028808594
mini_batch_src_global generation:  0.0001671314239501953
r_  generation:  0.0017952919006347656
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.00021004676818847656
r_  generation:  0.0013606548309326172
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0005235671997070312
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.00040030479431152344
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00023698806762695312
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.00043463706970214844
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0003542900085449219
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.0008800029754638672
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  0.00010514259338378906
r_  generation:  0.0006740093231201172
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0014252662658691406
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  8.726119995117188e-05
r_  generation:  0.0004668235778808594
----------------------check_connections_block total spend ----------------------------- 0.018653154373168945
generate_one_block  0.0022249221801757812
generate_one_block  0.0015785694122314453
generate_one_block  0.0014393329620361328
generate_one_block  0.0011925697326660156
generate_one_block  0.002698659896850586
generate_one_block  0.002243518829345703
generate_one_block  0.0014693737030029297
generate_one_block  0.0012969970703125
generate_one_block  0.0011529922485351562
generate_one_block  0.0013589859008789062
generate_one_block  0.0012612342834472656
generate_one_block  0.001909494400024414
generate_one_block  0.0016782283782958984
generate_one_block  0.0026483535766601562
generate_one_block  0.0017037391662597656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

connection checking time:  0.024183273315429688
block generation total time  0.04362297058105469
average batch blocks generation time:  0.002908198038736979
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0009875297546386719  GigaBytes
Max Memory Allocated: 0.0009875297546386719  GigaBytes

torch.Size([454, 500])
torch.Size([106, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.0010499954223632812  GigaBytes
Max Memory Allocated: 0.0010881423950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0017342567443847656  GigaBytes
Max Memory Allocated: 0.002567291259765625  GigaBytes

torch.Size([782, 500])
torch.Size([174, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0018324851989746094  GigaBytes
Max Memory Allocated: 0.002567291259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0014519691467285156  GigaBytes
Max Memory Allocated: 0.0028967857360839844  GigaBytes

torch.Size([631, 500])
torch.Size([129, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0015282630920410156  GigaBytes
Max Memory Allocated: 0.0028967857360839844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0010433197021484375  GigaBytes
Max Memory Allocated: 0.0028967857360839844  GigaBytes

torch.Size([414, 500])
torch.Size([92, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0010981559753417969  GigaBytes
Max Memory Allocated: 0.0028967857360839844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005168914794921875  GigaBytes
Max Memory Allocated: 0.005897998809814453  GigaBytes

torch.Size([2610, 500])
torch.Size([595, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005482673645019531  GigaBytes
Max Memory Allocated: 0.005897998809814453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0024538040161132812  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([1156, 500])
torch.Size([287, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0026230812072753906  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0017871856689453125  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([811, 500])
torch.Size([203, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0018992424011230469  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011501312255859375  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([470, 500])
torch.Size([116, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012216567993164062  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0008950233459472656  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([335, 500])
torch.Size([92, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0009489059448242188  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015888214111328125  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([705, 500])
torch.Size([94, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016531944274902344  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011849403381347656  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([489, 500])
torch.Size([126, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012574195861816406  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003486156463623047  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([1718, 500])
torch.Size([255, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0036296844482421875  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0025725364685058594  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([1229, 500])
torch.Size([224, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0026950836181640625  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0037178993225097656  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([1831, 500])
torch.Size([428, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003957271575927734  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015506744384765625  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([683, 500])
torch.Size([186, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016684532165527344  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0008280118306477865 |0.02359484036763509 |0.05401182174682617 |0.00013100306193033855 |0.0021071592966715497 |0.002292633056640625 |
----------------------------------------------------------pseudo_mini_loss sum 2.44431209564209
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17782
Number of first layer input nodes during this epoch:  14318
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018444061279296875  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011475086212158203
range selection method range initialization spend 6.0558319091796875e-05
time for parepare:  5.054473876953125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.409385681152344e-05
----------------------check_connections_block total spend ----------------------------- 0.0027947425842285156
generate_one_block  0.001149892807006836
generate_one_block  0.0010628700256347656
generate_one_block  0.0010509490966796875
generate_one_block  0.0010492801666259766
generate_one_block  0.0010399818420410156
generate_one_block  0.0013055801391601562
generate_one_block  0.0010561943054199219
generate_one_block  0.0010383129119873047
generate_one_block  0.0010421276092529297
generate_one_block  0.0010569095611572266
generate_one_block  0.0009610652923583984
generate_one_block  0.0009613037109375
generate_one_block  0.0009567737579345703
generate_one_block  0.0009565353393554688
generate_one_block  0.0009667873382568359
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010242462158203125
gen group dst list time:  8.654594421386719e-05
time for parepare:  0.0002887248992919922
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.367134094238281e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00018286705017089844
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00014209747314453125
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00015974044799804688
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00010466575622558594
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  9.1552734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00023508071899414062
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.724761962890625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.987022399902344e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  5.2928924560546875e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00016999244689941406
----------------------check_connections_block total spend ----------------------------- 0.004778385162353516
generate_one_block  0.0010983943939208984
generate_one_block  0.0011150836944580078
generate_one_block  0.0013616085052490234
generate_one_block  0.0012209415435791016
generate_one_block  0.0010592937469482422
generate_one_block  0.0011134147644042969
generate_one_block  0.001260519027709961
generate_one_block  0.001163482666015625
generate_one_block  0.0010991096496582031
generate_one_block  0.001409292221069336
generate_one_block  0.000997781753540039
generate_one_block  0.0010306835174560547
generate_one_block  0.0010306835174560547
generate_one_block  0.0009829998016357422
generate_one_block  0.0011448860168457031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011234283447265625
gen group dst list time:  0.00015163421630859375
time for parepare:  0.0009207725524902344
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00023674964904785156
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00017261505126953125
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00034618377685546875
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  0.000179290771484375
r_  generation:  0.0012784004211425781
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.0007510185241699219
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00012922286987304688
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0004754066467285156
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  0.00011229515075683594
r_  generation:  0.0009768009185791016
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0005590915679931641
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.000728607177734375
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0015377998352050781
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0002455711364746094
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003376007080078125
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0003407001495361328
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00019669532775878906
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  8.559226989746094e-05
r_  generation:  0.0009281635284423828
----------------------check_connections_block total spend ----------------------------- 0.016617774963378906
generate_one_block  0.0023148059844970703
generate_one_block  0.0014848709106445312
generate_one_block  0.002527952194213867
generate_one_block  0.0018229484558105469
generate_one_block  0.0010533332824707031
generate_one_block  0.001499176025390625
generate_one_block  0.002140522003173828
generate_one_block  0.0015828609466552734
generate_one_block  0.0018842220306396484
generate_one_block  0.0028853416442871094
generate_one_block  0.0020363330841064453
generate_one_block  0.0013270378112792969
generate_one_block  0.0013289451599121094
generate_one_block  0.0012047290802001953
generate_one_block  0.0020384788513183594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018444061279296875  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

connection checking time:  0.021396160125732422
block generation total time  0.0442197322845459
average batch blocks generation time:  0.00294798215230306
block dataloader generation time/epoch 0.1198728084564209
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010538101196289062  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([282, 500])
torch.Size([72, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010991096496582031  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015625953674316406  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([552, 500])
torch.Size([139, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016417503356933594  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0034193992614746094  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([1534, 500])
torch.Size([364, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0036220550537109375  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0028433799743652344  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([1234, 500])
torch.Size([279, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003002643585205078  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0008034706115722656  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([148, 500])
torch.Size([43, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0008358955383300781  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.001895904541015625  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([729, 500])
torch.Size([152, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0019817352294921875  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004107475280761719  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([1909, 500])
torch.Size([379, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004310131072998047  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0022454261779785156  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([915, 500])
torch.Size([175, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0023512840270996094  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003548145294189453  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([1613, 500])
torch.Size([210, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003669261932373047  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003948211669921875  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([1814, 500])
torch.Size([419, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004185676574707031  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0013713836669921875  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([451, 500])
torch.Size([121, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0014386177062988281  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015811920166015625  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([562, 500])
torch.Size([135, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016632080078125  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0014061927795410156  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([468, 500])
torch.Size([171, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0014977455139160156  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011944770812988281  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

torch.Size([357, 500])
torch.Size([78, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012469291687011719  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0035829544067382812  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes
Using backend: pytorch

torch.Size([1628, 500])
torch.Size([355, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003783702850341797  GigaBytes
Max Memory Allocated: 0.007279872894287109  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0006822586059570312 |0.0005072752634684244 |0.003756554921468099 |0.0001300493876139323 |0.003018538157145182 |0.0018756389617919922 |
----------------------------------------------------------pseudo_mini_loss sum 1.656715750694275
Total (block generation + training)time/epoch 0.2646453380584717
Training time/epoch 0.14448261260986328
Training time without block to device /epoch 0.13687348365783691
Training time without total dataloading part /epoch 0.1054527759552002
load block tensor time/epoch 0.010233879089355469
block to device time/epoch 0.007609128952026367
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17645
Number of first layer input nodes during this epoch:  14196
