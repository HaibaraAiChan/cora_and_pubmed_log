Using backend: pytorch
main start at this time 1648527213.3875637
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0035054683685302734
range selection method range initialization spend 9.369850158691406e-05
time for parepare:  4.0531158447265625e-05
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0015070438385009766
----------------------check_connections_block total spend ----------------------------- 0.0018956661224365234
generate_one_block  0.0014119148254394531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0014598369598388672
gen group dst list time:  1.8596649169921875e-05
time for parepare:  0.00023674964904785156
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  0.00013256072998046875
r_  generation:  0.0011332035064697266
----------------------check_connections_block total spend ----------------------------- 0.0020873546600341797
generate_one_block  0.002832651138305664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010340213775634766
gen group dst list time:  5.221366882324219e-05
time for parepare:  0.0007045269012451172
local_output_nid generation:  0.00016379356384277344
local_in_edges_tensor generation:  0.0005781650543212891
mini_batch_src_global generation:  0.00060272216796875
r_  generation:  0.006904125213623047
----------------------check_connections_block total spend ----------------------------- 0.010938882827758789
generate_one_block  0.010344266891479492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

connection checking time:  0.013026237487792969
block generation total time  0.013176918029785156
average batch blocks generation time:  0.013176918029785156
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.01615142822265625  GigaBytes
Max Memory Allocated: 0.01615142822265625  GigaBytes

torch.Size([8481, 500])
torch.Size([2705, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.01763153076171875  GigaBytes
Max Memory Allocated: 0.019109725952148438  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005857944488525391 |0.34670472145080566 |0.7579450607299805 |0.00026154518127441406 |0.007863998413085938 |0.005370140075683594 |
----------------------------------------------------------pseudo_mini_loss sum 2.2107670307159424
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  11540
Number of first layer input nodes during this epoch:  8481
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.017040729522705078  GigaBytes
Max Memory Allocated: 0.019263744354248047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009686946868896484
range selection method range initialization spend 9.965896606445312e-05
time for parepare:  9.489059448242188e-05
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.0003552436828613281
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0002334117889404297
----------------------check_connections_block total spend ----------------------------- 0.0009810924530029297
generate_one_block  0.0024721622467041016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007622241973876953
gen group dst list time:  2.5987625122070312e-05
time for parepare:  0.00037384033203125
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0003037452697753906
mini_batch_src_global generation:  0.00018358230590820312
r_  generation:  0.0017881393432617188
----------------------check_connections_block total spend ----------------------------- 0.003160238265991211
generate_one_block  0.003797769546508789
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0014793872833251953
gen group dst list time:  8.344650268554688e-05
time for parepare:  0.0007214546203613281
local_output_nid generation:  0.00018358230590820312
local_in_edges_tensor generation:  0.0005807876586914062
mini_batch_src_global generation:  0.000705718994140625
r_  generation:  0.007258176803588867
----------------------check_connections_block total spend ----------------------------- 0.011626243591308594
generate_one_block  0.009995698928833008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.017040729522705078  GigaBytes
Max Memory Allocated: 0.019263744354248047  GigaBytes

connection checking time:  0.014786481857299805
block generation total time  0.013793468475341797
average batch blocks generation time:  0.013793468475341797
block dataloader generation time/epoch 0.052840232849121094
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01647186279296875  GigaBytes
Max Memory Allocated: 0.03204917907714844  GigaBytes

torch.Size([8444, 500])
torch.Size([2699, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.017946720123291016  GigaBytes
Max Memory Allocated: 0.03204917907714844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005521535873413086 |0.0004801750183105469 |0.0032799243927001953 |0.0001323223114013672 |0.0035407543182373047 |0.0013837814331054688 |
----------------------------------------------------------pseudo_mini_loss sum 1.6346672773361206
Total (block generation + training)time/epoch 0.06873130798339844
Training time/epoch 0.015679359436035156
Training time without block to device /epoch 0.01519918441772461
Training time without total dataloading part /epoch 0.008336782455444336
load block tensor time/epoch 0.005521535873413086
block to device time/epoch 0.0004801750183105469
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  11497
Number of first layer input nodes during this epoch:  8444
