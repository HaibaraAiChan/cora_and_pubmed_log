main start at this time 1648527133.341775
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002242565155029297
range selection method range initialization spend 9.202957153320312e-05
time for parepare:  3.981590270996094e-05
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  0.0011432170867919922
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  4.5299530029296875e-05
----------------------check_connections_block total spend ----------------------------- 0.002126932144165039
generate_one_block  0.0011320114135742188
generate_one_block  0.0010151863098144531
generate_one_block  0.0010945796966552734
generate_one_block  0.001020669937133789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011785030364990234
gen group dst list time:  3.0517578125e-05
time for parepare:  0.000209808349609375
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0001742839813232422
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0004763603210449219
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.00018548965454101562
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.00038695335388183594
----------------------check_connections_block total spend ----------------------------- 0.002562284469604492
generate_one_block  0.0012366771697998047
generate_one_block  0.0016734600067138672
generate_one_block  0.0011930465698242188
generate_one_block  0.0014996528625488281
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009927749633789062
gen group dst list time:  6.341934204101562e-05
time for parepare:  0.0006849765777587891
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0008537769317626953
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.00023651123046875
r_  generation:  0.002744436264038086
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  0.00017213821411132812
r_  generation:  0.0011982917785644531
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  0.00018525123596191406
r_  generation:  0.002203226089477539
----------------------check_connections_block total spend ----------------------------- 0.011258125305175781
generate_one_block  0.003208160400390625
generate_one_block  0.004725217819213867
generate_one_block  0.0024247169494628906
generate_one_block  0.003981351852416992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

connection checking time:  0.013820409774780273
block generation total time  0.019942283630371094
average batch blocks generation time:  0.0049855709075927734
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0032286643981933594  GigaBytes
Max Memory Allocated: 0.0032286643981933594  GigaBytes

torch.Size([1647, 500])
torch.Size([386, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0034379959106445312  GigaBytes
Max Memory Allocated: 0.0035905838012695312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007893085479736328  GigaBytes
Max Memory Allocated: 0.010874748229980469  GigaBytes

torch.Size([4049, 500])
torch.Size([1085, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008477210998535156  GigaBytes
Max Memory Allocated: 0.010874748229980469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004441261291503906  GigaBytes
Max Memory Allocated: 0.011949539184570312  GigaBytes

torch.Size([2224, 500])
torch.Size([429, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004683494567871094  GigaBytes
Max Memory Allocated: 0.011949539184570312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006699562072753906  GigaBytes
Max Memory Allocated: 0.011949539184570312  GigaBytes

torch.Size([3418, 500])
torch.Size([868, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007184028625488281  GigaBytes
Max Memory Allocated: 0.011949539184570312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0063294172286987305 |0.0874103307723999 |0.19372111558914185 |0.00022685527801513672 |0.004239857196807861 |0.0023288726806640625 |
----------------------------------------------------------pseudo_mini_loss sum 2.1487841606140137
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14461
Number of first layer input nodes during this epoch:  11338
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007117748260498047  GigaBytes
Max Memory Allocated: 0.011949539184570312  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004622936248779297
range selection method range initialization spend 5.078315734863281e-05
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.649162292480469e-05
local_output_nid generation:  7.152557373046875e-06
Using backend: pytorch
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.076957702636719e-05
----------------------check_connections_block total spend ----------------------------- 0.0010409355163574219
generate_one_block  0.001146078109741211
generate_one_block  0.0011026859283447266
generate_one_block  0.0012195110321044922
generate_one_block  0.0010976791381835938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000499725341796875
gen group dst list time:  3.266334533691406e-05
time for parepare:  0.0002396106719970703
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.0003495216369628906
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00026226043701171875
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00040793418884277344
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0002803802490234375
----------------------check_connections_block total spend ----------------------------- 0.002711057662963867
generate_one_block  0.0014722347259521484
generate_one_block  0.0013880729675292969
generate_one_block  0.0015645027160644531
generate_one_block  0.0014595985412597656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009403228759765625
gen group dst list time:  7.796287536621094e-05
time for parepare:  0.0006687641143798828
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.0003075599670410156
mini_batch_src_global generation:  0.00018978118896484375
r_  generation:  0.0019991397857666016
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.0002200603485107422
r_  generation:  0.00153350830078125
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.0002238750457763672
mini_batch_src_global generation:  0.0002796649932861328
r_  generation:  0.0024454593658447266
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.0002532005310058594
r_  generation:  0.0014300346374511719
----------------------check_connections_block total spend ----------------------------- 0.012122869491577148
generate_one_block  0.003697633743286133
generate_one_block  0.0029909610748291016
generate_one_block  0.004366397857666016
generate_one_block  0.0026917457580566406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007117748260498047  GigaBytes
Max Memory Allocated: 0.011949539184570312  GigaBytes

connection checking time:  0.014833927154541016
block generation total time  0.019631147384643555
average batch blocks generation time:  0.004907786846160889
block dataloader generation time/epoch 0.05079984664916992
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005875587463378906  GigaBytes
Max Memory Allocated: 0.012183666229248047  GigaBytes

torch.Size([2842, 500])
torch.Size([685, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0062580108642578125  GigaBytes
Max Memory Allocated: 0.012183666229248047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005665779113769531  GigaBytes
Max Memory Allocated: 0.012183666229248047  GigaBytes

torch.Size([2737, 500])
torch.Size([643, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0060062408447265625  GigaBytes
Max Memory Allocated: 0.012183666229248047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007119178771972656  GigaBytes
Max Memory Allocated: 0.012183666229248047  GigaBytes

torch.Size([3501, 500])
torch.Size([832, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007575511932373047  GigaBytes
Max Memory Allocated: 0.012183666229248047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0056629180908203125  GigaBytes
Max Memory Allocated: 0.012183666229248047  GigaBytes

torch.Size([2528, 500])
torch.Size([633, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006012439727783203  GigaBytes
Max Memory Allocated: 0.012183666229248047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0016853809356689453 |0.0004004240036010742 |0.0031148195266723633 |0.00011438131332397461 |0.002580404281616211 |0.0013837814331054688 |
----------------------------------------------------------pseudo_mini_loss sum 1.739760160446167
Total (block generation + training)time/epoch 0.08847332000732422
Training time/epoch 0.037380218505859375
Training time without block to device /epoch 0.03577852249145508
Training time without total dataloading part /epoch 0.024622201919555664
load block tensor time/epoch 0.006741523742675781
block to device time/epoch 0.0016016960144042969
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14757
Number of first layer input nodes during this epoch:  11608
