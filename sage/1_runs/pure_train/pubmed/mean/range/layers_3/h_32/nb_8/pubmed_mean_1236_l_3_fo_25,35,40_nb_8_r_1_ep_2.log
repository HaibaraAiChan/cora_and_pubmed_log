main start at this time 1648527083.420243
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012714862823486328
range selection method range initialization spend 0.00010704994201660156
time for parepare:  5.245208740234375e-05
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.0016818046569824219
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.340576171875e-05
----------------------check_connections_block total spend ----------------------------- 0.0028963088989257812
generate_one_block  0.0015015602111816406
generate_one_block  0.0013179779052734375
generate_one_block  0.0013277530670166016
generate_one_block  0.0013163089752197266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008587837219238281
gen group dst list time:  4.267692565917969e-05
time for parepare:  0.0002846717834472656
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001914501190185547
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0005950927734375
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0002503395080566406
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00047898292541503906
----------------------check_connections_block total spend ----------------------------- 0.0031981468200683594
generate_one_block  0.0015375614166259766
generate_one_block  0.002088308334350586
generate_one_block  0.0015549659729003906
generate_one_block  0.0018982887268066406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011053085327148438
gen group dst list time:  9.083747863769531e-05
time for parepare:  0.0009164810180664062
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.00029277801513671875
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.0011453628540039062
local_output_nid generation:  0.00010037422180175781
local_in_edges_tensor generation:  0.00030303001403808594
mini_batch_src_global generation:  0.0003376007080078125
r_  generation:  0.0036554336547851562
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  0.0002124309539794922
r_  generation:  0.001554250717163086
local_output_nid generation:  9.083747863769531e-05
local_in_edges_tensor generation:  0.0002760887145996094
mini_batch_src_global generation:  0.0002646446228027344
r_  generation:  0.0029516220092773438
----------------------check_connections_block total spend ----------------------------- 0.014954805374145508
generate_one_block  0.0031507015228271484
generate_one_block  0.004651069641113281
generate_one_block  0.0024442672729492188
generate_one_block  0.003921985626220703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

connection checking time:  0.018152952194213867
block generation total time  0.021247148513793945
average batch blocks generation time:  0.005311787128448486
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.00324249267578125  GigaBytes
Max Memory Allocated: 0.00324249267578125  GigaBytes

torch.Size([1655, 500])
torch.Size([383, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003448009490966797  GigaBytes
Max Memory Allocated: 0.0036020278930664062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007874488830566406  GigaBytes
Max Memory Allocated: 0.010870933532714844  GigaBytes

torch.Size([4039, 500])
torch.Size([1082, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008457183837890625  GigaBytes
Max Memory Allocated: 0.010870933532714844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004611492156982422  GigaBytes
Max Memory Allocated: 0.0121002197265625  GigaBytes

torch.Size([2315, 500])
torch.Size([430, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004854679107666016  GigaBytes
Max Memory Allocated: 0.0121002197265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006639957427978516  GigaBytes
Max Memory Allocated: 0.0121002197265625  GigaBytes

torch.Size([3386, 500])
torch.Size([866, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007124423980712891  GigaBytes
Max Memory Allocated: 0.0121002197265625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013438940048217773 |0.0875425934791565 |0.19297724962234497 |0.00016802549362182617 |0.003170490264892578 |0.0019383430480957031 |
----------------------------------------------------------pseudo_mini_loss sum 2.1269707679748535
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14511
Number of first layer input nodes during this epoch:  11395
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007058143615722656  GigaBytes
Max Memory Allocated: 0.0121002197265625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005037784576416016
range selection method range initialization spend 6.771087646484375e-05
time for parepare:  5.221366882324219e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.887580871582031e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00010943412780761719
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.6253204345703125e-05
----------------------check_connections_block total spend ----------------------------- 0.001135110855102539
generate_one_block  0.0011298656463623047
generate_one_block  0.0010654926300048828
generate_one_block  0.0012350082397460938
generate_one_block  0.0010828971862792969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005671977996826172
gen group dst list time:  3.6716461181640625e-05
time for parepare:  0.0002770423889160156
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0003390312194824219
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0002727508544921875
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00042700767517089844
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0002970695495605469
----------------------check_connections_block total spend ----------------------------- 0.002859354019165039
generate_one_block  0.0014760494232177734
generate_one_block  0.0013878345489501953
generate_one_block  0.0015790462493896484
generate_one_block  0.0014064311981201172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011034011840820312
gen group dst list time:  8.96453857421875e-05
time for parepare:  0.0007586479187011719
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.0003075599670410156
mini_batch_src_global generation:  0.00024271011352539062
r_  generation:  0.0020728111267089844
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.0002474784851074219
r_  generation:  0.0016314983367919922
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.0002865791320800781
r_  generation:  0.0025773048400878906
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  0.0001900196075439453
r_  generation:  0.0014967918395996094
----------------------check_connections_block total spend ----------------------------- 0.012829303741455078
generate_one_block  0.003964662551879883
generate_one_block  0.0043697357177734375
generate_one_block  0.0047037601470947266
generate_one_block  0.003081798553466797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007058143615722656  GigaBytes
Max Memory Allocated: 0.0121002197265625  GigaBytes

connection checking time:  0.015688657760620117
block generation total time  0.021969318389892578
average batch blocks generation time:  0.0054923295974731445
block dataloader generation time/epoch 0.05424904823303223
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005825996398925781  GigaBytes
Max Memory Allocated: 0.0121002197265625  GigaBytes

torch.Size([2816, 500])
torch.Size([681, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006206035614013672  GigaBytes
Max Memory Allocated: 0.0121002197265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005705833435058594  GigaBytes
Max Memory Allocated: 0.0121002197265625  GigaBytes

torch.Size([2758, 500])
torch.Size([649, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00605010986328125  GigaBytes
Max Memory Allocated: 0.0121002197265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007098674774169922  GigaBytes
Max Memory Allocated: 0.012162208557128906  GigaBytes

torch.Size([3490, 500])
torch.Size([830, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0075550079345703125  GigaBytes
Max Memory Allocated: 0.012162208557128906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005702018737792969  GigaBytes
Max Memory Allocated: 0.012162208557128906  GigaBytes

torch.Size([2520, 500])
torch.Size([632, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00605010986328125  GigaBytes
Max Memory Allocated: 0.012162208557128906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0013517141342163086 |0.0006447434425354004 |0.00479811429977417 |0.00017005205154418945 |0.0022455453872680664 |0.0016286373138427734 |
----------------------------------------------------------pseudo_mini_loss sum 1.7514867782592773
Total (block generation + training)time/epoch 0.10015869140625
Training time/epoch 0.04558110237121582
Training time without block to device /epoch 0.04300212860107422
Training time without total dataloading part /epoch 0.030483484268188477
load block tensor time/epoch 0.005406856536865234
block to device time/epoch 0.0025789737701416016
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14732
Number of first layer input nodes during this epoch:  11584
