main start at this time 1648527233.3324828
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0022764205932617188
range selection method range initialization spend 9.012222290039062e-05
time for parepare:  4.029273986816406e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  0.0013806819915771484
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.410743713378906e-05
----------------------check_connections_block total spend ----------------------------- 0.0024013519287109375
generate_one_block  0.0012276172637939453
generate_one_block  0.0010302066802978516
generate_one_block  0.0010492801666259766
generate_one_block  0.001012563705444336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011327266693115234
gen group dst list time:  3.24249267578125e-05
time for parepare:  0.00022268295288085938
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00016379356384277344
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0005028247833251953
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00020813941955566406
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00041866302490234375
----------------------check_connections_block total spend ----------------------------- 0.0026667118072509766
generate_one_block  0.0012199878692626953
generate_one_block  0.0016608238220214844
generate_one_block  0.0012524127960205078
generate_one_block  0.0015113353729248047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010440349578857422
gen group dst list time:  6.890296936035156e-05
time for parepare:  0.0007448196411132812
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00026869773864746094
mini_batch_src_global generation:  0.00010967254638671875
r_  generation:  0.0011298656463623047
local_output_nid generation:  7.534027099609375e-05
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  0.0002856254577636719
r_  generation:  0.0031957626342773438
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.0002071857452392578
r_  generation:  0.0014498233795166016
local_output_nid generation:  7.367134094238281e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  0.00023674964904785156
r_  generation:  0.002746105194091797
----------------------check_connections_block total spend ----------------------------- 0.013560056686401367
generate_one_block  0.0026068687438964844
generate_one_block  0.00516057014465332
generate_one_block  0.002870798110961914
generate_one_block  0.004560947418212891
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

connection checking time:  0.016226768493652344
block generation total time  0.0208437442779541
average batch blocks generation time:  0.005210936069488525
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0038509368896484375  GigaBytes
Max Memory Allocated: 0.0038509368896484375  GigaBytes

torch.Size([1977, 500])
torch.Size([445, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004090785980224609  GigaBytes
Max Memory Allocated: 0.004281520843505859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008714675903320312  GigaBytes
Max Memory Allocated: 0.012295722961425781  GigaBytes

torch.Size([4482, 500])
torch.Size([1124, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009328365325927734  GigaBytes
Max Memory Allocated: 0.012295722961425781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005715370178222656  GigaBytes
Max Memory Allocated: 0.014020442962646484  GigaBytes

torch.Size([2903, 500])
torch.Size([465, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0059814453125  GigaBytes
Max Memory Allocated: 0.014020442962646484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007672309875488281  GigaBytes
Max Memory Allocated: 0.014020442962646484  GigaBytes

torch.Size([3931, 500])
torch.Size([951, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008207321166992188  GigaBytes
Max Memory Allocated: 0.014020442962646484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0034822821617126465 |0.08709162473678589 |0.1953643560409546 |0.00021207332611083984 |0.0034941434860229492 |0.0028603076934814453 |
----------------------------------------------------------pseudo_mini_loss sum 2.183725595474243
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16633
Number of first layer input nodes during this epoch:  13293
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008127689361572266  GigaBytes
Max Memory Allocated: 0.014020442962646484  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005335807800292969
range selection method range initialization spend 5.698204040527344e-05
time for parepare:  5.1975250244140625e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00012230873107910156
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.0067901611328125e-05
----------------------check_connections_block total spend ----------------------------- 0.0012166500091552734
generate_one_block  0.0012784004211425781
generate_one_block  0.001069784164428711
generate_one_block  0.0011398792266845703
generate_one_block  0.0009992122650146484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004870891571044922
gen group dst list time:  3.314018249511719e-05
time for parepare:  0.00025010108947753906
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00032782554626464844
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.00030159950256347656
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0004267692565917969
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00028896331787109375
----------------------check_connections_block total spend ----------------------------- 0.0027704238891601562
generate_one_block  0.001375436782836914
generate_one_block  0.0013439655303955078
generate_one_block  0.0015113353729248047
generate_one_block  0.0012769699096679688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010807514190673828
gen group dst list time:  7.939338684082031e-05
time for parepare:  0.0007297992706298828
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.00030350685119628906
mini_batch_src_global generation:  0.00022459030151367188
r_  generation:  0.0023415088653564453
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.0002262592315673828
mini_batch_src_global generation:  0.0002765655517578125
r_  generation:  0.0018694400787353516
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.0002512931823730469
mini_batch_src_global generation:  0.0003228187561035156
r_  generation:  0.002891063690185547
local_output_nid generation:  7.152557373046875e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.00019311904907226562
r_  generation:  0.0015981197357177734
----------------------check_connections_block total spend ----------------------------- 0.01405191421508789
generate_one_block  0.0040378570556640625
generate_one_block  0.0035614967346191406
generate_one_block  0.0052263736724853516
generate_one_block  0.0028591156005859375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008127689361572266  GigaBytes
Max Memory Allocated: 0.014020442962646484  GigaBytes

connection checking time:  0.016822338104248047
block generation total time  0.021192550659179688
average batch blocks generation time:  0.005298137664794922
block dataloader generation time/epoch 0.05528450012207031
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006465435028076172  GigaBytes
Max Memory Allocated: 0.014020442962646484  GigaBytes

torch.Size([3152, 500])
torch.Size([714, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006871223449707031  GigaBytes
Max Memory Allocated: 0.014020442962646484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006918430328369141  GigaBytes
Max Memory Allocated: 0.014020442962646484  GigaBytes

torch.Size([3240, 500])
torch.Size([727, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007304668426513672  GigaBytes
Max Memory Allocated: 0.014020442962646484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008619308471679688  GigaBytes
Max Memory Allocated: 0.014863967895507812  GigaBytes

torch.Size([4296, 500])
torch.Size([907, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009125232696533203  GigaBytes
Max Memory Allocated: 0.014863967895507812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005829811096191406  GigaBytes
Max Memory Allocated: 0.014863967895507812  GigaBytes

torch.Size([2824, 500])
torch.Size([665, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006197452545166016  GigaBytes
Max Memory Allocated: 0.014863967895507812  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002101719379425049 |0.00048285722732543945 |0.004066526889801025 |0.00014209747314453125 |0.006285965442657471 |0.0015082359313964844 |
----------------------------------------------------------pseudo_mini_loss sum 1.6539961099624634
Total (block generation + training)time/epoch 0.11510944366455078
Training time/epoch 0.059508323669433594
Training time without block to device /epoch 0.057576894760131836
Training time without total dataloading part /epoch 0.043486595153808594
load block tensor time/epoch 0.008406877517700195
block to device time/epoch 0.0019314289093017578
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16881
Number of first layer input nodes during this epoch:  13512
