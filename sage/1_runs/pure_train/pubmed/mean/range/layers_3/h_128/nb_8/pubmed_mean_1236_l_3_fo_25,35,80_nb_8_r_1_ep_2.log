main start at this time 1648527533.362269
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008571147918701172
range selection method range initialization spend 0.0001323223114013672
time for parepare:  4.601478576660156e-05
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.0022988319396972656
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.673004150390625e-05
----------------------check_connections_block total spend ----------------------------- 0.0033698081970214844
generate_one_block  0.0012600421905517578
generate_one_block  0.0010554790496826172
generate_one_block  0.0010938644409179688
generate_one_block  0.0010666847229003906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000518798828125
gen group dst list time:  3.647804260253906e-05
time for parepare:  0.00023031234741210938
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0003681182861328125
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0002071857452392578
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00034928321838378906
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.000392913818359375
----------------------check_connections_block total spend ----------------------------- 0.002844572067260742
generate_one_block  0.0014615058898925781
generate_one_block  0.0012395381927490234
generate_one_block  0.00147247314453125
generate_one_block  0.0015180110931396484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009815692901611328
gen group dst list time:  7.081031799316406e-05
time for parepare:  0.0007393360137939453
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.0003108978271484375
mini_batch_src_global generation:  0.00015234947204589844
r_  generation:  0.0018126964569091797
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.00014591217041015625
r_  generation:  0.001085042953491211
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00021648406982421875
mini_batch_src_global generation:  0.000202178955078125
r_  generation:  0.0021352767944335938
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.00023818016052246094
mini_batch_src_global generation:  0.0002834796905517578
r_  generation:  0.0024955272674560547
----------------------check_connections_block total spend ----------------------------- 0.012337923049926758
generate_one_block  0.004232645034790039
generate_one_block  0.0022492408752441406
generate_one_block  0.003528118133544922
generate_one_block  0.004071950912475586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

connection checking time:  0.0151824951171875
block generation total time  0.019773483276367188
average batch blocks generation time:  0.004943370819091797
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.006241321563720703  GigaBytes
Max Memory Allocated: 0.006241321563720703  GigaBytes

torch.Size([2997, 500])
torch.Size([795, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007730960845947266  GigaBytes
Max Memory Allocated: 0.008857250213623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005163669586181641  GigaBytes
Max Memory Allocated: 0.010716438293457031  GigaBytes

torch.Size([2105, 500])
torch.Size([397, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005986213684082031  GigaBytes
Max Memory Allocated: 0.010716438293457031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006859779357910156  GigaBytes
Max Memory Allocated: 0.010716438293457031  GigaBytes

torch.Size([2569, 500])
torch.Size([725, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008196353912353516  GigaBytes
Max Memory Allocated: 0.010716438293457031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008692741394042969  GigaBytes
Max Memory Allocated: 0.014203548431396484  GigaBytes

torch.Size([3977, 500])
torch.Size([890, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010378837585449219  GigaBytes
Max Memory Allocated: 0.014203548431396484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014317691326141357 |0.08788949251174927 |0.19438332319259644 |0.00018209218978881836 |0.0034638643264770508 |0.001856088638305664 |
----------------------------------------------------------pseudo_mini_loss sum 2.1687750816345215
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14812
Number of first layer input nodes during this epoch:  11648
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010067939758300781  GigaBytes
Max Memory Allocated: 0.014203548431396484  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020592212677001953
range selection method range initialization spend 5.245208740234375e-05
time for parepare:  4.506111145019531e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00010848045349121094
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.982948303222656e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.743171691894531e-05
----------------------check_connections_block total spend ----------------------------- 0.0010783672332763672
generate_one_block  0.0011372566223144531
generate_one_block  0.0010602474212646484
generate_one_block  0.0012156963348388672
generate_one_block  0.0010559558868408203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0013773441314697266
gen group dst list time:  3.337860107421875e-05
time for parepare:  0.00024008750915527344
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00037407875061035156
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00022530555725097656
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.000396728515625
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0003466606140136719
----------------------check_connections_block total spend ----------------------------- 0.002786397933959961
generate_one_block  0.0015332698822021484
generate_one_block  0.0013201236724853516
generate_one_block  0.001516103744506836
generate_one_block  0.0015194416046142578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009706020355224609
gen group dst list time:  8.130073547363281e-05
time for parepare:  0.0006930828094482422
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.000308990478515625
mini_batch_src_global generation:  0.00025582313537597656
r_  generation:  0.002232789993286133
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  0.0001881122589111328
r_  generation:  0.0013453960418701172
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.0002522468566894531
mini_batch_src_global generation:  0.00017595291137695312
r_  generation:  0.0019435882568359375
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  0.00021314620971679688
r_  generation:  0.002178192138671875
----------------------check_connections_block total spend ----------------------------- 0.012583255767822266
generate_one_block  0.004172086715698242
generate_one_block  0.0027358531951904297
generate_one_block  0.003259420394897461
generate_one_block  0.0039713382720947266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010067939758300781  GigaBytes
Max Memory Allocated: 0.014203548431396484  GigaBytes

connection checking time:  0.015369653701782227
block generation total time  0.020027637481689453
average batch blocks generation time:  0.005006909370422363
block dataloader generation time/epoch 0.06440448760986328
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008068084716796875  GigaBytes
Max Memory Allocated: 0.01540994644165039  GigaBytes

torch.Size([2869, 500])
torch.Size([739, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009440422058105469  GigaBytes
Max Memory Allocated: 0.01540994644165039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007338047027587891  GigaBytes
Max Memory Allocated: 0.01540994644165039  GigaBytes

torch.Size([2620, 500])
torch.Size([473, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008257865905761719  GigaBytes
Max Memory Allocated: 0.01540994644165039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008172035217285156  GigaBytes
Max Memory Allocated: 0.01540994644165039  GigaBytes

torch.Size([3059, 500])
torch.Size([829, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009776115417480469  GigaBytes
Max Memory Allocated: 0.01540994644165039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008485794067382812  GigaBytes
Max Memory Allocated: 0.01540994644165039  GigaBytes

torch.Size([3223, 500])
torch.Size([786, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009958744049072266  GigaBytes
Max Memory Allocated: 0.01540994644165039  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0019016265869140625 |0.00042426586151123047 |0.0032600760459899902 |0.00011831521987915039 |0.0031585693359375 |0.0014615058898925781 |
----------------------------------------------------------pseudo_mini_loss sum 1.1744924783706665
Total (block generation + training)time/epoch 0.10605120658874512
Training time/epoch 0.04149127006530762
Training time without block to device /epoch 0.039794206619262695
Training time without total dataloading part /epoch 0.02760934829711914
load block tensor time/epoch 0.00760650634765625
block to device time/epoch 0.0016970634460449219
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14955
Number of first layer input nodes during this epoch:  11771
