main start at this time 1648527583.4419065
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009970664978027344
range selection method range initialization spend 9.5367431640625e-05
time for parepare:  4.38690185546875e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.0011875629425048828
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.482269287109375e-05
----------------------check_connections_block total spend ----------------------------- 0.0022106170654296875
generate_one_block  0.0013458728790283203
generate_one_block  0.0011491775512695312
generate_one_block  0.0011823177337646484
generate_one_block  0.0011510848999023438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007584095001220703
gen group dst list time:  3.337860107421875e-05
time for parepare:  0.00025463104248046875
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0003936290740966797
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00021338462829589844
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.00039005279541015625
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0004363059997558594
----------------------check_connections_block total spend ----------------------------- 0.0029578208923339844
generate_one_block  0.0016245841979980469
generate_one_block  0.0013451576232910156
generate_one_block  0.0016243457794189453
generate_one_block  0.0016665458679199219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010554790496826172
gen group dst list time:  7.891654968261719e-05
time for parepare:  0.0007648468017578125
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.000316619873046875
mini_batch_src_global generation:  0.00016236305236816406
r_  generation:  0.0019345283508300781
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  0.0001513957977294922
r_  generation:  0.0011148452758789062
local_output_nid generation:  6.151199340820312e-05
local_in_edges_tensor generation:  0.0002257823944091797
mini_batch_src_global generation:  0.0002415180206298828
r_  generation:  0.0024099349975585938
local_output_nid generation:  7.891654968261719e-05
local_in_edges_tensor generation:  0.00024819374084472656
mini_batch_src_global generation:  0.00029087066650390625
r_  generation:  0.0028972625732421875
----------------------check_connections_block total spend ----------------------------- 0.01343989372253418
generate_one_block  0.003746509552001953
generate_one_block  0.002263784408569336
generate_one_block  0.003876924514770508
generate_one_block  0.005322694778442383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

connection checking time:  0.016397714614868164
block generation total time  0.02147054672241211
average batch blocks generation time:  0.005367636680603027
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.006344318389892578  GigaBytes
Max Memory Allocated: 0.006344318389892578  GigaBytes

torch.Size([3051, 500])
torch.Size([841, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007908344268798828  GigaBytes
Max Memory Allocated: 0.009053707122802734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0051860809326171875  GigaBytes
Max Memory Allocated: 0.010838985443115234  GigaBytes

torch.Size([2117, 500])
torch.Size([397, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006008625030517578  GigaBytes
Max Memory Allocated: 0.010838985443115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00696563720703125  GigaBytes
Max Memory Allocated: 0.010838985443115234  GigaBytes

torch.Size([2690, 500])
torch.Size([806, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008434295654296875  GigaBytes
Max Memory Allocated: 0.010838985443115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009405136108398438  GigaBytes
Max Memory Allocated: 0.015007495880126953  GigaBytes

torch.Size([4355, 500])
torch.Size([962, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011212348937988281  GigaBytes
Max Memory Allocated: 0.015007495880126953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012255489826202393 |0.08880144357681274 |0.19173604249954224 |0.00018852949142456055 |0.0032024383544921875 |0.0027985572814941406 |
----------------------------------------------------------pseudo_mini_loss sum 2.2116997241973877
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15576
Number of first layer input nodes during this epoch:  12213
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010799884796142578  GigaBytes
Max Memory Allocated: 0.015007495880126953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004742145538330078
range selection method range initialization spend 5.14984130859375e-05
time for parepare:  4.7206878662109375e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00010204315185546875
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.3392181396484375e-05
----------------------check_connections_block total spend ----------------------------- 0.0010662078857421875
generate_one_block  0.0011129379272460938
generate_one_block  0.0010352134704589844
generate_one_block  0.0012309551239013672
generate_one_block  0.0010535717010498047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005197525024414062
gen group dst list time:  3.4332275390625e-05
time for parepare:  0.0002574920654296875
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0003654956817626953
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00023436546325683594
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00039267539978027344
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0003724098205566406
----------------------check_connections_block total spend ----------------------------- 0.002828836441040039
generate_one_block  0.0015134811401367188
generate_one_block  0.0013012886047363281
generate_one_block  0.0014982223510742188
generate_one_block  0.0014841556549072266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009613037109375
gen group dst list time:  8.392333984375e-05
time for parepare:  0.00072479248046875
local_output_nid generation:  6.222724914550781e-05
local_in_edges_tensor generation:  0.00032329559326171875
mini_batch_src_global generation:  0.0002760887145996094
r_  generation:  0.0023605823516845703
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  0.0002238750457763672
r_  generation:  0.0015840530395507812
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  0.00019216537475585938
r_  generation:  0.002081155776977539
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.0002276897430419922
mini_batch_src_global generation:  0.0002186298370361328
r_  generation:  0.0023374557495117188
----------------------check_connections_block total spend ----------------------------- 0.013561010360717773
generate_one_block  0.0041468143463134766
generate_one_block  0.002981424331665039
generate_one_block  0.003406047821044922
generate_one_block  0.004030942916870117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010799884796142578  GigaBytes
Max Memory Allocated: 0.015007495880126953  GigaBytes

connection checking time:  0.016389846801757812
block generation total time  0.020362377166748047
average batch blocks generation time:  0.005090594291687012
block dataloader generation time/epoch 0.05296802520751953
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008172035217285156  GigaBytes
Max Memory Allocated: 0.01621389389038086  GigaBytes

torch.Size([3049, 500])
torch.Size([805, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009651660919189453  GigaBytes
Max Memory Allocated: 0.01621389389038086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008111953735351562  GigaBytes
Max Memory Allocated: 0.01621389389038086  GigaBytes

torch.Size([3032, 500])
torch.Size([541, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009144783020019531  GigaBytes
Max Memory Allocated: 0.01621389389038086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0085296630859375  GigaBytes
Max Memory Allocated: 0.01621389389038086  GigaBytes

torch.Size([3249, 500])
torch.Size([865, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010193347930908203  GigaBytes
Max Memory Allocated: 0.01621389389038086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008715152740478516  GigaBytes
Max Memory Allocated: 0.01621389389038086  GigaBytes

torch.Size([3344, 500])
torch.Size([846, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010284900665283203  GigaBytes
Max Memory Allocated: 0.01621389389038086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0019555091857910156 |0.00041878223419189453 |0.0032868385314941406 |0.00012153387069702148 |0.002559959888458252 |0.0015246868133544922 |
----------------------------------------------------------pseudo_mini_loss sum 1.1921056509017944
Total (block generation + training)time/epoch 0.09281134605407715
Training time/epoch 0.03952503204345703
Training time without block to device /epoch 0.03784990310668945
Training time without total dataloading part /epoch 0.02539801597595215
load block tensor time/epoch 0.007822036743164062
block to device time/epoch 0.0016751289367675781
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16088
Number of first layer input nodes during this epoch:  12674
