main start at this time 1648527553.4246113
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012485980987548828
range selection method range initialization spend 9.608268737792969e-05
time for parepare:  5.269050598144531e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00021457672119140625
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0013461112976074219
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.1948089599609375e-05
----------------------check_connections_block total spend ----------------------------- 0.004551887512207031
generate_one_block  0.001470327377319336
generate_one_block  0.0012695789337158203
generate_one_block  0.0012388229370117188
generate_one_block  0.001252889633178711
generate_one_block  0.0012450218200683594
generate_one_block  0.0012502670288085938
generate_one_block  0.0012302398681640625
generate_one_block  0.0010557174682617188
generate_one_block  0.0010955333709716797
generate_one_block  0.001049041748046875
generate_one_block  0.0010564327239990234
generate_one_block  0.0010530948638916016
generate_one_block  0.0010528564453125
generate_one_block  0.0010237693786621094
generate_one_block  0.0010752677917480469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007081031799316406
gen group dst list time:  0.00010561943054199219
time for parepare:  0.0002808570861816406
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00021648406982421875
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001266002655029297
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00017404556274414062
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.749961853027344e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  9.72747802734375e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  0.00010180473327636719
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  8.034706115722656e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.343292236328125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00021696090698242188
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  9.632110595703125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00010824203491210938
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00010585784912109375
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0002853870391845703
----------------------check_connections_block total spend ----------------------------- 0.005441188812255859
generate_one_block  0.0014276504516601562
generate_one_block  0.001483917236328125
generate_one_block  0.0013608932495117188
generate_one_block  0.0013546943664550781
generate_one_block  0.0012590885162353516
generate_one_block  0.0013513565063476562
generate_one_block  0.0011341571807861328
generate_one_block  0.0011298656463623047
generate_one_block  0.0011899471282958984
generate_one_block  0.0010476112365722656
generate_one_block  0.001058816909790039
generate_one_block  0.0010275840759277344
generate_one_block  0.001064300537109375
generate_one_block  0.0011060237884521484
generate_one_block  0.001271963119506836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010950565338134766
gen group dst list time:  0.0001621246337890625
time for parepare:  0.0008978843688964844
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00028252601623535156
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0005290508270263672
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  0.00011467933654785156
r_  generation:  0.001055002212524414
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0004200935363769531
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004229545593261719
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0002880096435546875
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00012254714965820312
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00033783912658691406
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0005013942718505859
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.00058746337890625
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.00017118453979492188
r_  generation:  0.0015842914581298828
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.0005688667297363281
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0005917549133300781
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00023221969604492188
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0006821155548095703
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.00027823448181152344
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  0.00014448165893554688
r_  generation:  0.0016772747039794922
----------------------check_connections_block total spend ----------------------------- 0.017720937728881836
generate_one_block  0.00250244140625
generate_one_block  0.0020380020141601562
generate_one_block  0.0013458728790283203
generate_one_block  0.0013370513916015625
generate_one_block  0.0010340213775634766
generate_one_block  0.0012590885162353516
generate_one_block  0.0014646053314208984
generate_one_block  0.001566171646118164
generate_one_block  0.0024871826171875
generate_one_block  0.0014870166778564453
generate_one_block  0.0014946460723876953
generate_one_block  0.0011479854583740234
generate_one_block  0.0016922950744628906
generate_one_block  0.001199960708618164
generate_one_block  0.003233671188354492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

connection checking time:  0.023162126541137695
block generation total time  0.04355788230895996
average batch blocks generation time:  0.0029038588205973306
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0018739700317382812  GigaBytes
Max Memory Allocated: 0.0018739700317382812  GigaBytes

torch.Size([673, 500])
torch.Size([193, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0022382736206054688  GigaBytes
Max Memory Allocated: 0.002483367919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004164218902587891  GigaBytes
Max Memory Allocated: 0.005392551422119141  GigaBytes

torch.Size([1571, 500])
torch.Size([347, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004791736602783203  GigaBytes
Max Memory Allocated: 0.005433559417724609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.002476215362548828  GigaBytes
Max Memory Allocated: 0.005433559417724609  GigaBytes

torch.Size([588, 500])
torch.Size([144, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.002750873565673828  GigaBytes
Max Memory Allocated: 0.005433559417724609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0024781227111816406  GigaBytes
Max Memory Allocated: 0.005433559417724609  GigaBytes

torch.Size([674, 500])
torch.Size([151, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.002791881561279297  GigaBytes
Max Memory Allocated: 0.005433559417724609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0014491081237792969  GigaBytes
Max Memory Allocated: 0.005433559417724609  GigaBytes

torch.Size([125, 500])
torch.Size([49, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0015530586242675781  GigaBytes
Max Memory Allocated: 0.005433559417724609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0020971298217773438  GigaBytes
Max Memory Allocated: 0.005433559417724609  GigaBytes

torch.Size([470, 500])
torch.Size([123, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0023860931396484375  GigaBytes
Max Memory Allocated: 0.005433559417724609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.002681255340576172  GigaBytes
Max Memory Allocated: 0.005433559417724609  GigaBytes

torch.Size([782, 500])
torch.Size([134, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.002948284149169922  GigaBytes
Max Memory Allocated: 0.005433559417724609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.003086566925048828  GigaBytes
Max Memory Allocated: 0.005433559417724609  GigaBytes

torch.Size([998, 500])
torch.Size([134, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0033464431762695312  GigaBytes
Max Memory Allocated: 0.005433559417724609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004147052764892578  GigaBytes
Max Memory Allocated: 0.005966663360595703  GigaBytes

torch.Size([1554, 500])
torch.Size([330, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004770755767822266  GigaBytes
Max Memory Allocated: 0.005966663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0027213096618652344  GigaBytes
Max Memory Allocated: 0.005966663360595703  GigaBytes

torch.Size([803, 500])
torch.Size([183, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.003051280975341797  GigaBytes
Max Memory Allocated: 0.005966663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.002666473388671875  GigaBytes
Max Memory Allocated: 0.005966663360595703  GigaBytes

torch.Size([773, 500])
torch.Size([178, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.002997875213623047  GigaBytes
Max Memory Allocated: 0.005966663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0017342567443847656  GigaBytes
Max Memory Allocated: 0.005966663360595703  GigaBytes

torch.Size([277, 500])
torch.Size([92, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0019202232360839844  GigaBytes
Max Memory Allocated: 0.005966663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0037126541137695312  GigaBytes
Max Memory Allocated: 0.005966663360595703  GigaBytes

torch.Size([1333, 500])
torch.Size([196, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004094600677490234  GigaBytes
Max Memory Allocated: 0.005966663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0019903182983398438  GigaBytes
Max Memory Allocated: 0.005966663360595703  GigaBytes

torch.Size([414, 500])
torch.Size([97, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0021734237670898438  GigaBytes
Max Memory Allocated: 0.005966663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00583648681640625  GigaBytes
Max Memory Allocated: 0.006560802459716797  GigaBytes

torch.Size([2457, 500])
torch.Size([523, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006823539733886719  GigaBytes
Max Memory Allocated: 0.007802009582519531  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00605004628499349 |0.02334726651509603 |0.054361820220947266 |0.0001339435577392578 |0.002997239430745443 |0.001985311508178711 |
----------------------------------------------------------pseudo_mini_loss sum 2.0554072856903076
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16723
Number of first layer input nodes during this epoch:  13492
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0071544647216796875  GigaBytes
Max Memory Allocated: 0.00810861587524414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004634857177734375
range selection method range initialization spend 5.316734313964844e-05
time for parepare:  4.124641418457031e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.7404556274414062e-05
----------------------check_connections_block total spend ----------------------------- 0.002687215805053711
generate_one_block  0.0011370182037353516
generate_one_block  0.0010874271392822266
generate_one_block  0.0010819435119628906
generate_one_block  0.0010752677917480469
generate_one_block  0.0010716915130615234
generate_one_block  0.0012807846069335938
generate_one_block  0.001085519790649414
generate_one_block  0.0010805130004882812
generate_one_block  0.0010936260223388672
generate_one_block  0.0010743141174316406
generate_one_block  0.001102447509765625
generate_one_block  0.001001119613647461
generate_one_block  0.0010025501251220703
generate_one_block  0.001004934310913086
generate_one_block  0.000995635986328125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006184577941894531
gen group dst list time:  8.034706115722656e-05
time for parepare:  0.0002460479736328125
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  6.580352783203125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00024008750915527344
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.079673767089844e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.00010728836059570312
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  7.128715515136719e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00017118453979492188
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  9.012222290039062e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00010180473327636719
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00012540817260742188
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00014662742614746094
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.031990051269531e-05
----------------------check_connections_block total spend ----------------------------- 0.0045545101165771484
generate_one_block  0.0011734962463378906
generate_one_block  0.0013489723205566406
generate_one_block  0.0012254714965820312
generate_one_block  0.0011630058288574219
generate_one_block  0.0011317729949951172
generate_one_block  0.001210927963256836
generate_one_block  0.0011126995086669922
generate_one_block  0.0011546611785888672
generate_one_block  0.0013074874877929688
generate_one_block  0.0011131763458251953
generate_one_block  0.0011050701141357422
generate_one_block  0.0011518001556396484
generate_one_block  0.001056671142578125
generate_one_block  0.0011768341064453125
generate_one_block  0.001115560531616211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011191368103027344
gen group dst list time:  0.0001270771026611328
time for parepare:  0.0007572174072265625
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00024509429931640625
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0004343986511230469
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  0.0001914501190185547
r_  generation:  0.00141143798828125
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.00036835670471191406
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0003523826599121094
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.000396728515625
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0007534027099609375
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00017023086547851562
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002777576446533203
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0009291172027587891
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0005443096160888672
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.00039267539978027344
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0007138252258300781
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.00018072128295898438
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0010657310485839844
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0003058910369873047
----------------------check_connections_block total spend ----------------------------- 0.015257596969604492
generate_one_block  0.0018019676208496094
generate_one_block  0.0027081966400146484
generate_one_block  0.0014071464538574219
generate_one_block  0.00141143798828125
generate_one_block  0.0015728473663330078
generate_one_block  0.0019185543060302734
generate_one_block  0.001150369644165039
generate_one_block  0.0013022422790527344
generate_one_block  0.0020568370819091797
generate_one_block  0.0016627311706542969
generate_one_block  0.001405954360961914
generate_one_block  0.001832723617553711
generate_one_block  0.0011882781982421875
generate_one_block  0.0023179054260253906
generate_one_block  0.0013570785522460938
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0071544647216796875  GigaBytes
Max Memory Allocated: 0.00810861587524414  GigaBytes

connection checking time:  0.01981210708618164
block generation total time  0.04264187812805176
average batch blocks generation time:  0.0028427918752034504
block dataloader generation time/epoch 0.09582257270812988
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.003912925720214844  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

torch.Size([795, 500])
torch.Size([128, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004152774810791016  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0054988861083984375  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

torch.Size([1630, 500])
torch.Size([424, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006269931793212891  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0037126541137695312  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

torch.Size([688, 500])
torch.Size([116, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003955841064453125  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0036268234252929688  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

torch.Size([642, 500])
torch.Size([145, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0038938522338867188  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004230499267578125  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

torch.Size([966, 500])
torch.Size([110, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004452705383300781  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005229949951171875  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

torch.Size([1497, 500])
torch.Size([222, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0056552886962890625  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0028400421142578125  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

torch.Size([223, 500])
torch.Size([57, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.002967357635498047  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003402233123779297  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

torch.Size([523, 500])
torch.Size([132, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003680706024169922  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0053577423095703125  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

torch.Size([1563, 500])
torch.Size([373, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0060672760009765625  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004237174987792969  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

torch.Size([967, 500])
torch.Size([204, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004604339599609375  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0034966468811035156  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

torch.Size([572, 500])
torch.Size([170, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0038614273071289062  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004841804504394531  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

torch.Size([1289, 500])
torch.Size([311, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005404949188232422  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0029153823852539062  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

torch.Size([263, 500])
torch.Size([91, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0031080245971679688  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005093574523925781  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

torch.Size([1418, 500])
torch.Size([302, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005662441253662109  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0035200119018554688  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes
Using backend: pytorch

torch.Size([585, 500])
torch.Size([95, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0037136077880859375  GigaBytes
Max Memory Allocated: 0.008476734161376953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.000712442398071289 |0.0003993988037109375 |0.0031681060791015625 |0.0001156012217203776 |0.003062899907430013 |0.002986431121826172 |
----------------------------------------------------------pseudo_mini_loss sum 1.0611528158187866
Total (block generation + training)time/epoch 0.22843289375305176
Training time/epoch 0.13232970237731934
Training time without block to device /epoch 0.12633872032165527
Training time without total dataloading part /epoch 0.09818553924560547
load block tensor time/epoch 0.010686635971069336
block to device time/epoch 0.0059909820556640625
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16858
Number of first layer input nodes during this epoch:  13621
