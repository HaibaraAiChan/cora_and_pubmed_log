main start at this time 1648527483.4044473
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002290964126586914
range selection method range initialization spend 7.867813110351562e-05
time for parepare:  4.2438507080078125e-05
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.0015411376953125
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.981590270996094e-05
----------------------check_connections_block total spend ----------------------------- 0.002492189407348633
generate_one_block  0.0012841224670410156
generate_one_block  0.001096963882446289
generate_one_block  0.0010781288146972656
generate_one_block  0.001071929931640625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012562274932861328
gen group dst list time:  3.2901763916015625e-05
time for parepare:  0.0002193450927734375
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.00031828880310058594
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00019168853759765625
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0003256797790527344
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0003829002380371094
----------------------check_connections_block total spend ----------------------------- 0.002618074417114258
generate_one_block  0.0014870166778564453
generate_one_block  0.0012176036834716797
generate_one_block  0.001482248306274414
generate_one_block  0.0014705657958984375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008747577667236328
gen group dst list time:  6.771087646484375e-05
time for parepare:  0.0007390975952148438
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00030541419982910156
mini_batch_src_global generation:  0.00014281272888183594
r_  generation:  0.0016741752624511719
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  0.000133514404296875
r_  generation:  0.001050710678100586
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.00019097328186035156
r_  generation:  0.0020284652709960938
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  0.00029397010803222656
r_  generation:  0.0023908615112304688
----------------------check_connections_block total spend ----------------------------- 0.01171422004699707
generate_one_block  0.003438234329223633
generate_one_block  0.002285003662109375
generate_one_block  0.003560781478881836
generate_one_block  0.004212379455566406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

connection checking time:  0.014332294464111328
block generation total time  0.019153833389282227
average batch blocks generation time:  0.004788458347320557
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.006186962127685547  GigaBytes
Max Memory Allocated: 0.006186962127685547  GigaBytes

torch.Size([2968, 500])
torch.Size([793, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007673740386962891  GigaBytes
Max Memory Allocated: 0.008786201477050781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005175113677978516  GigaBytes
Max Memory Allocated: 0.01067352294921875  GigaBytes

torch.Size([2111, 500])
torch.Size([397, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005997657775878906  GigaBytes
Max Memory Allocated: 0.01067352294921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006805419921875  GigaBytes
Max Memory Allocated: 0.01067352294921875  GigaBytes

torch.Size([2557, 500])
torch.Size([732, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008152484893798828  GigaBytes
Max Memory Allocated: 0.01067352294921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008612632751464844  GigaBytes
Max Memory Allocated: 0.014069080352783203  GigaBytes

torch.Size([3934, 500])
torch.Size([889, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010297298431396484  GigaBytes
Max Memory Allocated: 0.014069080352783203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002354264259338379 |0.08530926704406738 |0.19323766231536865 |0.00020611286163330078 |0.004109323024749756 |0.0030617713928222656 |
----------------------------------------------------------pseudo_mini_loss sum 2.2043302059173584
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14738
Number of first layer input nodes during this epoch:  11570
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009987354278564453  GigaBytes
Max Memory Allocated: 0.014069080352783203  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005321502685546875
range selection method range initialization spend 5.817413330078125e-05
time for parepare:  5.269050598144531e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  4.5299530029296875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.0001232624053955078
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.221366882324219e-05
----------------------check_connections_block total spend ----------------------------- 0.0012369155883789062
generate_one_block  0.0013051033020019531
generate_one_block  0.0012269020080566406
generate_one_block  0.0014047622680664062
generate_one_block  0.0012378692626953125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006048679351806641
gen group dst list time:  3.910064697265625e-05
time for parepare:  0.0002803802490234375
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00022363662719726562
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00031638145446777344
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00020003318786621094
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0003719329833984375
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0003452301025390625
----------------------check_connections_block total spend ----------------------------- 0.0027227401733398438
generate_one_block  0.001425027847290039
generate_one_block  0.0012097358703613281
generate_one_block  0.001432657241821289
generate_one_block  0.0013523101806640625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009114742279052734
gen group dst list time:  7.939338684082031e-05
time for parepare:  0.0006814002990722656
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.00031113624572753906
mini_batch_src_global generation:  0.00020051002502441406
r_  generation:  0.0021219253540039062
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.0002014636993408203
r_  generation:  0.0012972354888916016
local_output_nid generation:  6.532669067382812e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  0.0001678466796875
r_  generation:  0.0018780231475830078
local_output_nid generation:  6.628036499023438e-05
local_in_edges_tensor generation:  0.00022125244140625
mini_batch_src_global generation:  0.000202178955078125
r_  generation:  0.0020189285278320312
----------------------check_connections_block total spend ----------------------------- 0.011996030807495117
generate_one_block  0.003831624984741211
generate_one_block  0.002707242965698242
generate_one_block  0.003197193145751953
generate_one_block  0.003538846969604492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009987354278564453  GigaBytes
Max Memory Allocated: 0.014069080352783203  GigaBytes

connection checking time:  0.014718770980834961
block generation total time  0.018694639205932617
average batch blocks generation time:  0.004673659801483154
block dataloader generation time/epoch 0.052313804626464844
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008014678955078125  GigaBytes
Max Memory Allocated: 0.01527547836303711  GigaBytes

torch.Size([2914, 500])
torch.Size([738, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009386539459228516  GigaBytes
Max Memory Allocated: 0.01527547836303711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007404327392578125  GigaBytes
Max Memory Allocated: 0.01527547836303711  GigaBytes

torch.Size([2655, 500])
torch.Size([473, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00832509994506836  GigaBytes
Max Memory Allocated: 0.01527547836303711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008209228515625  GigaBytes
Max Memory Allocated: 0.01527547836303711  GigaBytes

torch.Size([3079, 500])
torch.Size([830, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009814739227294922  GigaBytes
Max Memory Allocated: 0.01527547836303711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008464336395263672  GigaBytes
Max Memory Allocated: 0.01527547836303711  GigaBytes

torch.Size([3212, 500])
torch.Size([789, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00994110107421875  GigaBytes
Max Memory Allocated: 0.01527547836303711  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0017547607421875 |0.00038045644760131836 |0.003032386302947998 |0.00010901689529418945 |0.0031183362007141113 |0.0013744831085205078 |
----------------------------------------------------------pseudo_mini_loss sum 1.2076287269592285
Total (block generation + training)time/epoch 0.09179258346557617
Training time/epoch 0.039240360260009766
Training time without block to device /epoch 0.03771853446960449
Training time without total dataloading part /epoch 0.026413440704345703
load block tensor time/epoch 0.00701904296875
block to device time/epoch 0.0015218257904052734
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15047
Number of first layer input nodes during this epoch:  11860
