main start at this time 1648527623.4590805
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005853176116943359
range selection method range initialization spend 9.584426879882812e-05
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.001363992691040039
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.4849853515625e-05
----------------------check_connections_block total spend ----------------------------- 0.0020325183868408203
generate_one_block  0.00136566162109375
generate_one_block  0.0011091232299804688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005345344543457031
gen group dst list time:  2.47955322265625e-05
time for parepare:  0.0002422332763671875
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0005176067352294922
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  0.00011706352233886719
r_  generation:  0.0007741451263427734
----------------------check_connections_block total spend ----------------------------- 0.002445697784423828
generate_one_block  0.001825571060180664
generate_one_block  0.002016782760620117
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010726451873779297
gen group dst list time:  6.222724914550781e-05
time for parepare:  0.0007460117340087891
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.00038051605224609375
mini_batch_src_global generation:  0.0002460479736328125
r_  generation:  0.003155231475830078
local_output_nid generation:  0.00011539459228515625
local_in_edges_tensor generation:  0.0003333091735839844
mini_batch_src_global generation:  0.0006444454193115234
r_  generation:  0.0050389766693115234
----------------------check_connections_block total spend ----------------------------- 0.013028860092163086
generate_one_block  0.005140781402587891
generate_one_block  0.007347583770751953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

connection checking time:  0.015474557876586914
block generation total time  0.016330718994140625
average batch blocks generation time:  0.008165359497070312
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.010062217712402344  GigaBytes
Max Memory Allocated: 0.010062217712402344  GigaBytes

torch.Size([5027, 500])
torch.Size([1217, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.012416362762451172  GigaBytes
Max Memory Allocated: 0.014286994934082031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013082504272460938  GigaBytes
Max Memory Allocated: 0.022294998168945312  GigaBytes

torch.Size([5965, 500])
torch.Size([1665, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01619434356689453  GigaBytes
Max Memory Allocated: 0.022294998168945312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015479207038879395 |0.17172956466674805 |0.3840513229370117 |0.00021278858184814453 |0.005209803581237793 |0.00231170654296875 |
----------------------------------------------------------pseudo_mini_loss sum 2.041466236114502
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14230
Number of first layer input nodes during this epoch:  10992
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.014630794525146484  GigaBytes
Max Memory Allocated: 0.022294998168945312  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0017547607421875
range selection method range initialization spend 7.62939453125e-05
time for parepare:  5.53131103515625e-05
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  8.58306884765625e-05
----------------------check_connections_block total spend ----------------------------- 0.00080108642578125
generate_one_block  0.0014524459838867188
generate_one_block  0.0013794898986816406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001070261001586914
gen group dst list time:  3.170967102050781e-05
time for parepare:  0.0003631114959716797
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  9.34600830078125e-05
r_  generation:  0.0006978511810302734
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  0.00011229515075683594
r_  generation:  0.0009019374847412109
----------------------check_connections_block total spend ----------------------------- 0.0030782222747802734
generate_one_block  0.002228260040283203
generate_one_block  0.002422332763671875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012993812561035156
gen group dst list time:  0.0001049041748046875
time for parepare:  0.0009517669677734375
local_output_nid generation:  0.0001251697540283203
local_in_edges_tensor generation:  0.0004456043243408203
mini_batch_src_global generation:  0.000598907470703125
r_  generation:  0.005272626876831055
local_output_nid generation:  0.00016951560974121094
local_in_edges_tensor generation:  0.000396728515625
mini_batch_src_global generation:  0.0007016658782958984
r_  generation:  0.0052335262298583984
----------------------check_connections_block total spend ----------------------------- 0.01688861846923828
generate_one_block  0.006497859954833984
generate_one_block  0.006743907928466797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.014630794525146484  GigaBytes
Max Memory Allocated: 0.022294998168945312  GigaBytes

connection checking time:  0.019966840744018555
block generation total time  0.01789236068725586
average batch blocks generation time:  0.00894618034362793
block dataloader generation time/epoch 0.05696845054626465
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.012996673583984375  GigaBytes
Max Memory Allocated: 0.024589061737060547  GigaBytes
Using backend: pytorch

torch.Size([5611, 500])
torch.Size([1293, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.015433311462402344  GigaBytes
Max Memory Allocated: 0.024589061737060547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.014269828796386719  GigaBytes
Max Memory Allocated: 0.024590015411376953  GigaBytes

torch.Size([5828, 500])
torch.Size([1661, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.017425537109375  GigaBytes
Max Memory Allocated: 0.024590015411376953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002318859100341797 |0.00048351287841796875 |0.0034551620483398438 |0.00014841556549072266 |0.002197265625 |0.0015630722045898438 |
----------------------------------------------------------pseudo_mini_loss sum 1.0230374336242676
Total (block generation + training)time/epoch 0.07866239547729492
Training time/epoch 0.021521806716918945
Training time without block to device /epoch 0.020554780960083008
Training time without total dataloading part /epoch 0.013164758682250977
load block tensor time/epoch 0.004637718200683594
block to device time/epoch 0.0009670257568359375
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14749
Number of first layer input nodes during this epoch:  11439
