main start at this time 1648527633.4232118
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002362489700317383
range selection method range initialization spend 0.00010085105895996094
time for parepare:  4.1484832763671875e-05
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00020956993103027344
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0014870166778564453
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  4.124641418457031e-05
----------------------check_connections_block total spend ----------------------------- 0.0025064945220947266
generate_one_block  0.0012516975402832031
generate_one_block  0.0010614395141601562
generate_one_block  0.0010731220245361328
generate_one_block  0.001013040542602539
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001279592514038086
gen group dst list time:  3.218650817871094e-05
time for parepare:  0.00023674964904785156
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0003459453582763672
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00020885467529296875
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.00034880638122558594
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0003814697265625
----------------------check_connections_block total spend ----------------------------- 0.002685546875
generate_one_block  0.0015075206756591797
generate_one_block  0.001210927963256836
generate_one_block  0.0014469623565673828
generate_one_block  0.0016176700592041016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010237693786621094
gen group dst list time:  7.700920104980469e-05
time for parepare:  0.0007843971252441406
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0003185272216796875
mini_batch_src_global generation:  0.00020885467529296875
r_  generation:  0.002056598663330078
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  0.00016021728515625
r_  generation:  0.0011970996856689453
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.000225067138671875
mini_batch_src_global generation:  0.00023674964904785156
r_  generation:  0.0024895668029785156
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.0002429485321044922
mini_batch_src_global generation:  0.0003440380096435547
r_  generation:  0.0029821395874023438
----------------------check_connections_block total spend ----------------------------- 0.014018535614013672
generate_one_block  0.00376129150390625
generate_one_block  0.0024271011352539062
generate_one_block  0.004347324371337891
generate_one_block  0.004895687103271484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

connection checking time:  0.016704082489013672
block generation total time  0.02121448516845703
average batch blocks generation time:  0.005303621292114258
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.006941795349121094  GigaBytes
Max Memory Allocated: 0.006941795349121094  GigaBytes

torch.Size([3368, 500])
torch.Size([841, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008512496948242188  GigaBytes
Max Memory Allocated: 0.009809017181396484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005638599395751953  GigaBytes
Max Memory Allocated: 0.011878490447998047  GigaBytes

torch.Size([2358, 500])
torch.Size([397, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006464958190917969  GigaBytes
Max Memory Allocated: 0.011878490447998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007566928863525391  GigaBytes
Max Memory Allocated: 0.011878490447998047  GigaBytes

torch.Size([2870, 500])
torch.Size([804, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009042739868164062  GigaBytes
Max Memory Allocated: 0.011878490447998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01025390625  GigaBytes
Max Memory Allocated: 0.01643657684326172  GigaBytes

torch.Size([4805, 500])
torch.Size([963, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012073040008544922  GigaBytes
Max Memory Allocated: 0.01643657684326172  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014141082763671875 |0.08632653951644897 |0.1957927942276001 |0.00017565488815307617 |0.0032155513763427734 |0.0022525787353515625 |
----------------------------------------------------------pseudo_mini_loss sum 2.19220232963562
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16763
Number of first layer input nodes during this epoch:  13401
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011671066284179688  GigaBytes
Max Memory Allocated: 0.01643657684326172  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005772113800048828
range selection method range initialization spend 7.534027099609375e-05
time for parepare:  6.365776062011719e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  5.14984130859375e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  Using backend: pytorch
0.0001266002655029297
mini_batch_src_global generation:  0.00013756752014160156
r_  generation:  0.00014901161193847656
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0003790855407714844
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.000110626220703125
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00022721290588378906
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  8.034706115722656e-05
----------------------check_connections_block total spend ----------------------------- 0.0023665428161621094
generate_one_block  0.0027053356170654297
generate_one_block  0.002177000045776367
generate_one_block  0.002544879913330078
generate_one_block  0.0021414756774902344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012044906616210938
gen group dst list time:  7.152557373046875e-05
time for parepare:  0.0005381107330322266
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0003387928009033203
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0007300376892089844
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0003571510314941406
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0005800724029541016
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0005414485931396484
----------------------check_connections_block total spend ----------------------------- 0.004626274108886719
generate_one_block  0.0021393299102783203
generate_one_block  0.0018198490142822266
generate_one_block  0.002125978469848633
generate_one_block  0.0016429424285888672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001024007797241211
gen group dst list time:  9.036064147949219e-05
time for parepare:  0.0007824897766113281
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0003325939178466797
mini_batch_src_global generation:  0.00025582313537597656
r_  generation:  0.0027446746826171875
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.0002377033233642578
r_  generation:  0.0017061233520507812
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  0.0001990795135498047
r_  generation:  0.0020933151245117188
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.00023627281188964844
mini_batch_src_global generation:  0.0002377033233642578
r_  generation:  0.002573251724243164
----------------------check_connections_block total spend ----------------------------- 0.014535903930664062
generate_one_block  0.004589557647705078
generate_one_block  0.003376483917236328
generate_one_block  0.0036773681640625
generate_one_block  0.004483699798583984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011671066284179688  GigaBytes
Max Memory Allocated: 0.01643657684326172  GigaBytes

connection checking time:  0.01916217803955078
block generation total time  0.023855209350585938
average batch blocks generation time:  0.005963802337646484
block dataloader generation time/epoch 0.06781435012817383
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008826255798339844  GigaBytes
Max Memory Allocated: 0.017694950103759766  GigaBytes

torch.Size([3396, 500])
torch.Size([805, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.010317325592041016  GigaBytes
Max Memory Allocated: 0.017694950103759766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008673667907714844  GigaBytes
Max Memory Allocated: 0.017694950103759766  GigaBytes

torch.Size([3331, 500])
torch.Size([540, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.009709358215332031  GigaBytes
Max Memory Allocated: 0.017694950103759766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.009482383728027344  GigaBytes
Max Memory Allocated: 0.017694950103759766  GigaBytes

torch.Size([3456, 500])
torch.Size([865, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011149883270263672  GigaBytes
Max Memory Allocated: 0.017694950103759766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.00927877426147461  GigaBytes
Max Memory Allocated: 0.017694950103759766  GigaBytes

torch.Size([3641, 500])
torch.Size([846, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.010859012603759766  GigaBytes
Max Memory Allocated: 0.017694950103759766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0022401809692382812 |0.0003960132598876953 |0.0031642913818359375 |0.0001316070556640625 |0.0025787353515625 |0.001491546630859375 |
----------------------------------------------------------pseudo_mini_loss sum 1.2212543487548828
Total (block generation + training)time/epoch 0.1084296703338623
Training time/epoch 0.04025387763977051
Training time without block to device /epoch 0.03866982460021973
Training time without total dataloading part /epoch 0.024990081787109375
load block tensor time/epoch 0.008960723876953125
block to device time/epoch 0.0015840530395507812
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17237
Number of first layer input nodes during this epoch:  13824
