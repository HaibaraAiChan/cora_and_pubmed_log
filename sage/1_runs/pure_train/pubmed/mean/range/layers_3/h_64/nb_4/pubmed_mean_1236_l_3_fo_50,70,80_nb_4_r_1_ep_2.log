main start at this time 1648527423.4253204
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013508796691894531
range selection method range initialization spend 8.96453857421875e-05
time for parepare:  4.291534423828125e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0010852813720703125
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  5.269050598144531e-05
----------------------check_connections_block total spend ----------------------------- 0.001714468002319336
generate_one_block  0.00131988525390625
generate_one_block  0.0011441707611083984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009026527404785156
gen group dst list time:  2.4080276489257812e-05
time for parepare:  0.00023674964904785156
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0007500648498535156
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0005099773406982422
----------------------check_connections_block total spend ----------------------------- 0.002371549606323242
generate_one_block  0.0021762847900390625
generate_one_block  0.0017151832580566406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010955333709716797
gen group dst list time:  6.461143493652344e-05
time for parepare:  0.0007405281066894531
local_output_nid generation:  0.00011157989501953125
local_in_edges_tensor generation:  0.0004329681396484375
mini_batch_src_global generation:  0.00036072731018066406
r_  generation:  0.004747867584228516
local_output_nid generation:  9.608268737792969e-05
local_in_edges_tensor generation:  0.0002951622009277344
mini_batch_src_global generation:  0.0005102157592773438
r_  generation:  0.0037539005279541016
----------------------check_connections_block total spend ----------------------------- 0.01332855224609375
generate_one_block  0.0072214603424072266
generate_one_block  0.005658864974975586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

connection checking time:  0.015700101852416992
block generation total time  0.016771793365478516
average batch blocks generation time:  0.008385896682739258
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.01248931884765625  GigaBytes
Max Memory Allocated: 0.01248931884765625  GigaBytes

torch.Size([6480, 500])
torch.Size([1694, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.014185428619384766  GigaBytes
Max Memory Allocated: 0.015439033508300781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.009614944458007812  GigaBytes
Max Memory Allocated: 0.02157306671142578  GigaBytes

torch.Size([4806, 500])
torch.Size([1264, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.010861873626708984  GigaBytes
Max Memory Allocated: 0.02157306671142578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00982809066772461 |0.17073404788970947 |0.39749181270599365 |0.0002491474151611328 |0.004924893379211426 |0.00389862060546875 |
----------------------------------------------------------pseudo_mini_loss sum 2.8969454765319824
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14600
Number of first layer input nodes during this epoch:  11286
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.010415077209472656  GigaBytes
Max Memory Allocated: 0.02157306671142578  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005865097045898438
range selection method range initialization spend 6.198883056640625e-05
time for parepare:  5.340576171875e-05
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00022482872009277344
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  9.1552734375e-05
----------------------check_connections_block total spend ----------------------------- 0.0008237361907958984
generate_one_block  0.0014913082122802734
generate_one_block  0.0014035701751708984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006582736968994141
gen group dst list time:  3.075599670410156e-05
time for parepare:  0.00033593177795410156
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0006580352783203125
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  0.00011229515075683594
r_  generation:  0.0009360313415527344
----------------------check_connections_block total spend ----------------------------- 0.0030095577239990234
generate_one_block  0.0017004013061523438
generate_one_block  0.0020020008087158203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001085519790649414
gen group dst list time:  6.794929504394531e-05
time for parepare:  0.0007312297821044922
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.00038909912109375
mini_batch_src_global generation:  0.00026679039001464844
r_  generation:  0.0030927658081054688
local_output_nid generation:  0.00012350082397460938
local_in_edges_tensor generation:  0.0003559589385986328
mini_batch_src_global generation:  0.0007195472717285156
r_  generation:  0.005173683166503906
----------------------check_connections_block total spend ----------------------------- 0.013358354568481445
generate_one_block  0.004979133605957031
generate_one_block  0.007680416107177734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.010415077209472656  GigaBytes
Max Memory Allocated: 0.02157306671142578  GigaBytes

connection checking time:  0.01636791229248047
block generation total time  0.01636195182800293
average batch blocks generation time:  0.008180975914001465
block dataloader generation time/epoch 0.04997992515563965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.009982109069824219  GigaBytes
Max Memory Allocated: 0.02157306671142578  GigaBytes
Using backend: pytorch

torch.Size([4723, 500])
torch.Size([1247, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.011191368103027344  GigaBytes
Max Memory Allocated: 0.02157306671142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.013303756713867188  GigaBytes
Max Memory Allocated: 0.021945476531982422  GigaBytes

torch.Size([6470, 500])
torch.Size([1654, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01498270034790039  GigaBytes
Max Memory Allocated: 0.021945476531982422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0035200119018554688 |0.0004532337188720703 |0.0033582448959350586 |0.00012290477752685547 |0.0030094385147094727 |0.0014433860778808594 |
----------------------------------------------------------pseudo_mini_loss sum 1.6729379892349243
Total (block generation + training)time/epoch 0.07508325576782227
Training time/epoch 0.02481245994567871
Training time without block to device /epoch 0.02390599250793457
Training time without total dataloading part /epoch 0.014424562454223633
load block tensor time/epoch 0.0070400238037109375
block to device time/epoch 0.0009064674377441406
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14450
Number of first layer input nodes during this epoch:  11193
