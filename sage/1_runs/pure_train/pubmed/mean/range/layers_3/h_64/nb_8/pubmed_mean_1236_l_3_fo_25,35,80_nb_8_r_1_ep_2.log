main start at this time 1648527333.3652813
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0026514530181884766
range selection method range initialization spend 8.797645568847656e-05
time for parepare:  5.602836608886719e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0015997886657714844
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.9325485229492188e-05
----------------------check_connections_block total spend ----------------------------- 0.0028052330017089844
generate_one_block  0.0015347003936767578
generate_one_block  0.0013132095336914062
generate_one_block  0.0013728141784667969
generate_one_block  0.001275777816772461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0013697147369384766
gen group dst list time:  4.3392181396484375e-05
time for parepare:  0.00030541419982910156
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005376338958740234
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00039315223693847656
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003943443298339844
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00023555755615234375
----------------------check_connections_block total spend ----------------------------- 0.0033097267150878906
generate_one_block  0.0020351409912109375
generate_one_block  0.0017480850219726562
generate_one_block  0.0017862319946289062
generate_one_block  0.0015544891357421875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011301040649414062
gen group dst list time:  0.00010800361633300781
time for parepare:  0.0009341239929199219
local_output_nid generation:  8.702278137207031e-05
local_in_edges_tensor generation:  0.00037670135498046875
mini_batch_src_global generation:  0.0002989768981933594
r_  generation:  0.0032041072845458984
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.0002541542053222656
mini_batch_src_global generation:  0.000301361083984375
r_  generation:  0.0021729469299316406
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.00025177001953125
r_  generation:  0.0025262832641601562
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.0002276897430419922
mini_batch_src_global generation:  0.00019979476928710938
r_  generation:  0.0015597343444824219
----------------------check_connections_block total spend ----------------------------- 0.015260457992553711
generate_one_block  0.005542278289794922
generate_one_block  0.0030977725982666016
generate_one_block  0.0034508705139160156
generate_one_block  0.002458810806274414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

connection checking time:  0.0185701847076416
block generation total time  0.02167367935180664
average batch blocks generation time:  0.00541841983795166
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0074920654296875  GigaBytes
Max Memory Allocated: 0.0074920654296875  GigaBytes

torch.Size([3832, 500])
torch.Size([931, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008426666259765625  GigaBytes
Max Memory Allocated: 0.009146690368652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006026744842529297  GigaBytes
Max Memory Allocated: 0.01311635971069336  GigaBytes

torch.Size([2914, 500])
torch.Size([684, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006715297698974609  GigaBytes
Max Memory Allocated: 0.01311635971069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0062160491943359375  GigaBytes
Max Memory Allocated: 0.01311635971069336  GigaBytes

torch.Size([3010, 500])
torch.Size([707, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006923198699951172  GigaBytes
Max Memory Allocated: 0.01311635971069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004433155059814453  GigaBytes
Max Memory Allocated: 0.01311635971069336  GigaBytes

torch.Size([2065, 500])
torch.Size([485, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004905223846435547  GigaBytes
Max Memory Allocated: 0.01311635971069336  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002810239791870117 |0.0870935320854187 |0.19472962617874146 |0.0001901388168334961 |0.0034667253494262695 |0.002488374710083008 |
----------------------------------------------------------pseudo_mini_loss sum 2.561363458633423
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14984
Number of first layer input nodes during this epoch:  11821
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0050640106201171875  GigaBytes
Max Memory Allocated: 0.01311635971069336  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005218982696533203
range selection method range initialization spend 6.341934204101562e-05
time for parepare:  4.982948303222656e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00011038780212402344
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.078315734863281e-05
----------------------check_connections_block total spend ----------------------------- 0.0011487007141113281
generate_one_block  0.0011751651763916016
generate_one_block  0.0011136531829833984
generate_one_block  0.0012030601501464844
generate_one_block  0.0010921955108642578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005426406860351562
gen group dst list time:  3.552436828613281e-05
time for parepare:  0.0002617835998535156
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0002377033233642578
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00022101402282714844
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00032520294189453125
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.00038361549377441406
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.00040721893310546875
----------------------check_connections_block total spend ----------------------------- 0.0028858184814453125
generate_one_block  0.001355886459350586
generate_one_block  0.0014548301696777344
generate_one_block  0.0015249252319335938
generate_one_block  0.0015401840209960938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009655952453613281
gen group dst list time:  8.606910705566406e-05
time for parepare:  0.0007245540618896484
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.00027060508728027344
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.001129150390625
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.0002052783966064453
r_  generation:  0.0018451213836669922
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  0.0002875328063964844
r_  generation:  0.002460956573486328
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  0.0002486705780029297
r_  generation:  0.0024423599243164062
----------------------check_connections_block total spend ----------------------------- 0.012784242630004883
generate_one_block  0.0025703907012939453
generate_one_block  0.003278493881225586
generate_one_block  0.004014492034912109
generate_one_block  0.004618167877197266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0050640106201171875  GigaBytes
Max Memory Allocated: 0.01311635971069336  GigaBytes

connection checking time:  0.015670061111450195
block generation total time  0.020357370376586914
average batch blocks generation time:  0.0050893425941467285
block dataloader generation time/epoch 0.05223536491394043
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004469871520996094  GigaBytes
Max Memory Allocated: 0.01311635971069336  GigaBytes

torch.Size([1795, 500])
torch.Size([509, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00495147705078125  GigaBytes
Max Memory Allocated: 0.01311635971069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006906032562255859  GigaBytes
Max Memory Allocated: 0.01311635971069336  GigaBytes

torch.Size([3092, 500])
torch.Size([691, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007594585418701172  GigaBytes
Max Memory Allocated: 0.01311635971069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00835561752319336  GigaBytes
Max Memory Allocated: 0.014046192169189453  GigaBytes

torch.Size([3556, 500])
torch.Size([849, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009190559387207031  GigaBytes
Max Memory Allocated: 0.014046192169189453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007546901702880859  GigaBytes
Max Memory Allocated: 0.014667987823486328  GigaBytes

torch.Size([3426, 500])
torch.Size([760, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00834512710571289  GigaBytes
Max Memory Allocated: 0.014667987823486328  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0017213821411132812 |0.00042641162872314453 |0.0032640695571899414 |0.00012755393981933594 |0.002146303653717041 |0.001516580581665039 |
----------------------------------------------------------pseudo_mini_loss sum 1.9296547174453735
Total (block generation + training)time/epoch 0.08957409858703613
Training time/epoch 0.03703045845031738
Training time without block to device /epoch 0.035324811935424805
Training time without total dataloading part /epoch 0.023668289184570312
load block tensor time/epoch 0.006885528564453125
block to device time/epoch 0.0017056465148925781
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15034
Number of first layer input nodes during this epoch:  11869
