main start at this time 1648527283.3667543
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014662742614746094
range selection method range initialization spend 9.322166442871094e-05
time for parepare:  5.340576171875e-05
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0014281272888183594
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.765655517578125e-05
----------------------check_connections_block total spend ----------------------------- 0.0025916099548339844
generate_one_block  0.0015292167663574219
generate_one_block  0.001367330551147461
generate_one_block  0.0013997554779052734
generate_one_block  0.0013108253479003906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008034706115722656
gen group dst list time:  4.1484832763671875e-05
time for parepare:  0.0002880096435546875
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0005297660827636719
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00038933753967285156
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.000396728515625
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.000232696533203125
----------------------check_connections_block total spend ----------------------------- 0.003256082534790039
generate_one_block  0.0020482540130615234
generate_one_block  0.0017766952514648438
generate_one_block  0.0018143653869628906
generate_one_block  0.0015892982482910156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001155853271484375
gen group dst list time:  9.34600830078125e-05
time for parepare:  0.0009260177612304688
local_output_nid generation:  8.702278137207031e-05
local_in_edges_tensor generation:  0.0003809928894042969
mini_batch_src_global generation:  0.0002713203430175781
r_  generation:  0.003154754638671875
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  0.0002963542938232422
r_  generation:  0.0021212100982666016
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.00026106834411621094
mini_batch_src_global generation:  0.0002465248107910156
r_  generation:  0.0025610923767089844
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00022673606872558594
mini_batch_src_global generation:  0.00019240379333496094
r_  generation:  0.0015628337860107422
----------------------check_connections_block total spend ----------------------------- 0.015235424041748047
generate_one_block  0.004653215408325195
generate_one_block  0.003040313720703125
generate_one_block  0.004397392272949219
generate_one_block  0.002495288848876953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

connection checking time:  0.018491506576538086
block generation total time  0.021814823150634766
average batch blocks generation time:  0.005453705787658691
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.007274150848388672  GigaBytes
Max Memory Allocated: 0.007274150848388672  GigaBytes

torch.Size([3716, 500])
torch.Size([931, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008206844329833984  GigaBytes
Max Memory Allocated: 0.008899211883544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006026744842529297  GigaBytes
Max Memory Allocated: 0.012900352478027344  GigaBytes

torch.Size([2914, 500])
torch.Size([685, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006716728210449219  GigaBytes
Max Memory Allocated: 0.012900352478027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006235599517822266  GigaBytes
Max Memory Allocated: 0.012900352478027344  GigaBytes

torch.Size([3020, 500])
torch.Size([707, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006943702697753906  GigaBytes
Max Memory Allocated: 0.012900352478027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004401206970214844  GigaBytes
Max Memory Allocated: 0.012900352478027344  GigaBytes

torch.Size([2048, 500])
torch.Size([486, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0048732757568359375  GigaBytes
Max Memory Allocated: 0.012900352478027344  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013701081275939941 |0.08630728721618652 |0.1940707564353943 |0.00016683340072631836 |0.0034624338150024414 |0.002151012420654297 |
----------------------------------------------------------pseudo_mini_loss sum 2.6045491695404053
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14863
Number of first layer input nodes during this epoch:  11698
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005032062530517578  GigaBytes
Max Memory Allocated: 0.012900352478027344  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005190372467041016
range selection method range initialization spend 5.888938903808594e-05
time for parepare:  5.173683166503906e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00012183189392089844
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.100799560546875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.2928924560546875e-05
----------------------check_connections_block total spend ----------------------------- 0.0011897087097167969
generate_one_block  0.0012745857238769531
generate_one_block  0.0012378692626953125
generate_one_block  0.0013747215270996094
generate_one_block  0.0012745857238769531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005862712860107422
gen group dst list time:  4.410743713378906e-05
time for parepare:  0.0002796649932861328
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.00025177001953125
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0003788471221923828
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004417896270751953
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0004858970642089844
----------------------check_connections_block total spend ----------------------------- 0.0032393932342529297
generate_one_block  0.0015592575073242188
generate_one_block  0.0016286373138427734
generate_one_block  0.0017597675323486328
generate_one_block  0.0017845630645751953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011315345764160156
gen group dst list time:  9.632110595703125e-05
time for parepare:  0.0008592605590820312
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00033092498779296875
mini_batch_src_global generation:  0.00013756752014160156
r_  generation:  0.0013020038604736328
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.0002486705780029297
mini_batch_src_global generation:  0.0002760887145996094
r_  generation:  0.002099752426147461
local_output_nid generation:  9.226799011230469e-05
local_in_edges_tensor generation:  0.0002727508544921875
mini_batch_src_global generation:  0.00034618377685546875
r_  generation:  0.0028421878814697266
local_output_nid generation:  8.559226989746094e-05
local_in_edges_tensor generation:  0.0002646446228027344
mini_batch_src_global generation:  0.0003025531768798828
r_  generation:  0.0027942657470703125
----------------------check_connections_block total spend ----------------------------- 0.014991998672485352
generate_one_block  0.0031332969665527344
generate_one_block  0.003257274627685547
generate_one_block  0.0040743350982666016
generate_one_block  0.0038156509399414062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005032062530517578  GigaBytes
Max Memory Allocated: 0.012900352478027344  GigaBytes

connection checking time:  0.01823139190673828
block generation total time  0.02101278305053711
average batch blocks generation time:  0.005253195762634277
block dataloader generation time/epoch 0.056819915771484375
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004380702972412109  GigaBytes
Max Memory Allocated: 0.012900352478027344  GigaBytes

torch.Size([1747, 500])
torch.Size([509, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004862308502197266  GigaBytes
Max Memory Allocated: 0.012900352478027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006852626800537109  GigaBytes
Max Memory Allocated: 0.012900352478027344  GigaBytes

torch.Size([3064, 500])
torch.Size([690, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007538795471191406  GigaBytes
Max Memory Allocated: 0.012900352478027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007848739624023438  GigaBytes
Max Memory Allocated: 0.013486862182617188  GigaBytes

torch.Size([3588, 500])
torch.Size([851, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008685111999511719  GigaBytes
Max Memory Allocated: 0.013486862182617188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007655143737792969  GigaBytes
Max Memory Allocated: 0.014269351959228516  GigaBytes

torch.Size([3484, 500])
torch.Size([758, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00845193862915039  GigaBytes
Max Memory Allocated: 0.014269351959228516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001863718032836914 |0.0005716681480407715 |0.003765106201171875 |0.00013327598571777344 |0.0022327303886413574 |0.0015320777893066406 |
----------------------------------------------------------pseudo_mini_loss sum 1.921523094177246
Total (block generation + training)time/epoch 0.09837508201599121
Training time/epoch 0.041393280029296875
Training time without block to device /epoch 0.03910660743713379
Training time without total dataloading part /epoch 0.026056528091430664
load block tensor time/epoch 0.007454872131347656
block to device time/epoch 0.002286672592163086
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15047
Number of first layer input nodes during this epoch:  11883
