Using backend: pytorch
main start at this time 1648527263.4409542
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013132095336914062
range selection method range initialization spend 0.00011396408081054688
time for parepare:  7.867813110351562e-05
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.0002951622009277344
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0022704601287841797
----------------------check_connections_block total spend ----------------------------- 0.002916574478149414
generate_one_block  0.0023374557495117188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007688999176025391
gen group dst list time:  2.956390380859375e-05
time for parepare:  0.0002868175506591797
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.0002574920654296875
mini_batch_src_global generation:  0.0001392364501953125
r_  generation:  0.001463174819946289
----------------------check_connections_block total spend ----------------------------- 0.002589702606201172
generate_one_block  0.003336191177368164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011150836944580078
gen group dst list time:  6.222724914550781e-05
time for parepare:  0.0008780956268310547
local_output_nid generation:  0.00020647048950195312
local_in_edges_tensor generation:  0.000553131103515625
mini_batch_src_global generation:  0.0005674362182617188
r_  generation:  0.005988597869873047
----------------------check_connections_block total spend ----------------------------- 0.009977340698242188
generate_one_block  0.009751319885253906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

connection checking time:  0.01256704330444336
block generation total time  0.01308751106262207
average batch blocks generation time:  0.01308751106262207
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.014739513397216797  GigaBytes
Max Memory Allocated: 0.014739513397216797  GigaBytes

torch.Size([7665, 500])
torch.Size([2542, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.017281055450439453  GigaBytes
Max Memory Allocated: 0.018558979034423828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0037147998809814453 |0.35014772415161133 |0.7763745784759521 |0.00024247169494628906 |0.00840449333190918 |0.004105329513549805 |
----------------------------------------------------------pseudo_mini_loss sum 2.869467258453369
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10561
Number of first layer input nodes during this epoch:  7665
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01598215103149414  GigaBytes
Max Memory Allocated: 0.018558979034423828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006625652313232422
range selection method range initialization spend 7.319450378417969e-05
time for parepare:  7.200241088867188e-05
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00023245811462402344
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00014901161193847656
----------------------check_connections_block total spend ----------------------------- 0.0006542205810546875
generate_one_block  0.0016796588897705078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006613731384277344
gen group dst list time:  2.5033950805664062e-05
time for parepare:  0.0003418922424316406
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.0002765655517578125
mini_batch_src_global generation:  0.00018978118896484375
r_  generation:  0.0015528202056884766
----------------------check_connections_block total spend ----------------------------- 0.0028192996978759766
generate_one_block  0.004079103469848633
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009360313415527344
gen group dst list time:  6.961822509765625e-05
time for parepare:  0.000701904296875
local_output_nid generation:  0.0001728534698486328
local_in_edges_tensor generation:  0.0005216598510742188
mini_batch_src_global generation:  0.0006392002105712891
r_  generation:  0.006033897399902344
----------------------check_connections_block total spend ----------------------------- 0.009939432144165039
generate_one_block  0.008971929550170898
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01598215103149414  GigaBytes
Max Memory Allocated: 0.018558979034423828  GigaBytes

connection checking time:  0.012758731842041016
block generation total time  0.013051033020019531
average batch blocks generation time:  0.013051033020019531
block dataloader generation time/epoch 0.045929908752441406
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015406131744384766  GigaBytes
Max Memory Allocated: 0.02949810028076172  GigaBytes

torch.Size([7583, 500])
torch.Size([2535, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017941951751708984  GigaBytes
Max Memory Allocated: 0.02949810028076172  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0036923885345458984 |0.000514984130859375 |0.0035119056701660156 |0.0001494884490966797 |0.003483295440673828 |0.0015130043029785156 |
----------------------------------------------------------pseudo_mini_loss sum 1.3123868703842163
Total (block generation + training)time/epoch 0.06043410301208496
Training time/epoch 0.014317750930786133
Training time without block to device /epoch 0.013802766799926758
Training time without total dataloading part /epoch 0.008657693862915039
load block tensor time/epoch 0.0036923885345458984
block to device time/epoch 0.000514984130859375
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10472
Number of first layer input nodes during this epoch:  7583
