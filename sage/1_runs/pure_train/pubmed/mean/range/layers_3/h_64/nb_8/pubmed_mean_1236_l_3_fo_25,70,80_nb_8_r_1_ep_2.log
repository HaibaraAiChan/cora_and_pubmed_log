main start at this time 1648527383.4277308
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005905628204345703
range selection method range initialization spend 9.322166442871094e-05
time for parepare:  4.363059997558594e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.0013382434844970703
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5510787963867188e-05
----------------------check_connections_block total spend ----------------------------- 0.002348661422729492
generate_one_block  0.0012974739074707031
generate_one_block  0.001115560531616211
generate_one_block  0.0011491775512695312
generate_one_block  0.0010905265808105469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005364418029785156
gen group dst list time:  3.361701965332031e-05
time for parepare:  0.0002455711364746094
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0005054473876953125
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.0003299713134765625
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0003476142883300781
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.0002243518829345703
----------------------check_connections_block total spend ----------------------------- 0.0029180049896240234
generate_one_block  0.001699209213256836
generate_one_block  0.0014469623565673828
generate_one_block  0.001508474349975586
generate_one_block  0.0013339519500732422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001064300537109375
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.0007956027984619141
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.0003476142883300781
mini_batch_src_global generation:  0.0002372264862060547
r_  generation:  0.002933979034423828
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  0.00023174285888671875
r_  generation:  0.001804351806640625
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.0022759437561035156
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  0.00017523765563964844
r_  generation:  0.001482248306274414
----------------------check_connections_block total spend ----------------------------- 0.013422250747680664
generate_one_block  0.005016803741455078
generate_one_block  0.0030717849731445312
generate_one_block  0.004358053207397461
generate_one_block  0.0026340484619140625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

connection checking time:  0.016340255737304688
block generation total time  0.02106928825378418
average batch blocks generation time:  0.005267322063446045
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.007990360260009766  GigaBytes
Max Memory Allocated: 0.007990360260009766  GigaBytes

torch.Size([4096, 500])
torch.Size([1053, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00902700424194336  GigaBytes
Max Memory Allocated: 0.009801864624023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006030559539794922  GigaBytes
Max Memory Allocated: 0.013611793518066406  GigaBytes

torch.Size([2916, 500])
torch.Size([686, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006720542907714844  GigaBytes
Max Memory Allocated: 0.013611793518066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007084369659423828  GigaBytes
Max Memory Allocated: 0.013611793518066406  GigaBytes

torch.Size([3088, 500])
torch.Size([738, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007819652557373047  GigaBytes
Max Memory Allocated: 0.013611793518066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004698753356933594  GigaBytes
Max Memory Allocated: 0.013611793518066406  GigaBytes

torch.Size([2205, 500])
torch.Size([547, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005224704742431641  GigaBytes
Max Memory Allocated: 0.013611793518066406  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002871215343475342 |0.08631891012191772 |0.19449543952941895 |0.00017535686492919922 |0.0033350586891174316 |0.001970529556274414 |
----------------------------------------------------------pseudo_mini_loss sum 2.6015865802764893
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15685
Number of first layer input nodes during this epoch:  12305
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005340576171875  GigaBytes
Max Memory Allocated: 0.013611793518066406  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002722501754760742
range selection method range initialization spend 4.8160552978515625e-05
time for parepare:  4.267692565917969e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00010371208190917969
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.601478576660156e-05
----------------------check_connections_block total spend ----------------------------- 0.0010256767272949219
generate_one_block  0.001190185546875
generate_one_block  0.0010800361633300781
generate_one_block  0.0011649131774902344
generate_one_block  0.0011210441589355469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0015528202056884766
gen group dst list time:  3.1948089599609375e-05
time for parepare:  0.00024890899658203125
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00022840499877929688
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.00030684471130371094
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0003914833068847656
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00041604042053222656
----------------------check_connections_block total spend ----------------------------- 0.002825498580932617
generate_one_block  0.0013756752014160156
generate_one_block  0.0014190673828125
generate_one_block  0.0016090869903564453
generate_one_block  0.0015399456024169922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010437965393066406
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.0007340908050537109
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.0002856254577636719
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.001142740249633789
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00019788742065429688
r_  generation:  0.0017514228820800781
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.00023603439331054688
mini_batch_src_global generation:  0.00032782554626464844
r_  generation:  0.002664327621459961
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.00023436546325683594
mini_batch_src_global generation:  0.0002772808074951172
r_  generation:  0.002474546432495117
----------------------check_connections_block total spend ----------------------------- 0.013150930404663086
generate_one_block  0.0032215118408203125
generate_one_block  0.003203153610229492
generate_one_block  0.0043103694915771484
generate_one_block  0.00410008430480957
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005340576171875  GigaBytes
Max Memory Allocated: 0.013611793518066406  GigaBytes

connection checking time:  0.015976428985595703
block generation total time  0.020778894424438477
average batch blocks generation time:  0.005194723606109619
block dataloader generation time/epoch 0.0582275390625
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004685401916503906  GigaBytes
Max Memory Allocated: 0.013611793518066406  GigaBytes

torch.Size([1909, 500])
torch.Size([573, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0052204132080078125  GigaBytes
Max Memory Allocated: 0.013611793518066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006906032562255859  GigaBytes
Max Memory Allocated: 0.013611793518066406  GigaBytes

torch.Size([3092, 500])
torch.Size([698, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007599353790283203  GigaBytes
Max Memory Allocated: 0.013611793518066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008837699890136719  GigaBytes
Max Memory Allocated: 0.014519691467285156  GigaBytes

torch.Size([3736, 500])
torch.Size([939, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00975179672241211  GigaBytes
Max Memory Allocated: 0.014519691467285156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008304119110107422  GigaBytes
Max Memory Allocated: 0.015893936157226562  GigaBytes

torch.Size([3830, 500])
torch.Size([808, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009145259857177734  GigaBytes
Max Memory Allocated: 0.015893936157226562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001992940902709961 |0.0004127621650695801 |0.0031824111938476562 |0.0001157522201538086 |0.0030152201652526855 |0.0014145374298095703 |
----------------------------------------------------------pseudo_mini_loss sum 1.9613044261932373
Total (block generation + training)time/epoch 0.09934163093566895
Training time/epoch 0.04077768325805664
Training time without block to device /epoch 0.03912663459777832
Training time without total dataloading part /epoch 0.026668071746826172
load block tensor time/epoch 0.007971763610839844
block to device time/epoch 0.0016510486602783203
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15941
Number of first layer input nodes during this epoch:  12567
