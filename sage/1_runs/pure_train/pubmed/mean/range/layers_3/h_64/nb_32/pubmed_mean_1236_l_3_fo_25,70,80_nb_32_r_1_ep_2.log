main start at this time 1648527403.4229393
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002262115478515625
range selection method range initialization spend 0.00010013580322265625
time for parepare:  4.172325134277344e-05
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.0014302730560302734
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  1.5020370483398438e-05
----------------------check_connections_block total spend ----------------------------- 0.00406646728515625
generate_one_block  0.0012776851654052734
generate_one_block  0.0010116100311279297
generate_one_block  0.0009920597076416016
generate_one_block  0.0010094642639160156
generate_one_block  0.0009911060333251953
generate_one_block  0.0009946823120117188
generate_one_block  0.0010423660278320312
generate_one_block  0.001012563705444336
generate_one_block  0.0010204315185546875
generate_one_block  0.000990152359008789
generate_one_block  0.0010066032409667969
generate_one_block  0.0009875297546386719
generate_one_block  0.0009899139404296875
generate_one_block  0.0009529590606689453
generate_one_block  0.0009634494781494141
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00152587890625
gen group dst list time:  7.724761962890625e-05
time for parepare:  0.0002422332763671875
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0001220703125
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00014543533325195312
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  6.175041198730469e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00020503997802734375
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.818771362304688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00017786026000976562
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.839897155761719e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  9.965896606445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00018143653869628906
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.91278076171875e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  0.00010347366333007812
----------------------check_connections_block total spend ----------------------------- 0.004548072814941406
generate_one_block  0.0011532306671142578
generate_one_block  0.0012059211730957031
generate_one_block  0.0010614395141601562
generate_one_block  0.0013098716735839844
generate_one_block  0.0011034011840820312
generate_one_block  0.0011191368103027344
generate_one_block  0.0012798309326171875
generate_one_block  0.0010638236999511719
generate_one_block  0.0009758472442626953
generate_one_block  0.0011281967163085938
generate_one_block  0.0012044906616210938
generate_one_block  0.0010077953338623047
generate_one_block  0.001020193099975586
generate_one_block  0.0010089874267578125
generate_one_block  0.001087188720703125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011630058288574219
gen group dst list time:  0.00012540817260742188
time for parepare:  0.0007219314575195312
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0002815723419189453
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00041365623474121094
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0007436275482177734
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0002334117889404297
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  0.00014710426330566406
r_  generation:  0.0016183853149414062
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00033664703369140625
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.00028061866760253906
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0004227161407470703
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.0010221004486083984
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0001590251922607422
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0001366138458251953
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0005171298980712891
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  0.00012826919555664062
r_  generation:  0.0013422966003417969
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.00022673606872558594
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.0004544258117675781
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0003485679626464844
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0005540847778320312
----------------------check_connections_block total spend ----------------------------- 0.01554107666015625
generate_one_block  0.0023946762084960938
generate_one_block  0.0018842220306396484
generate_one_block  0.0012073516845703125
generate_one_block  0.0030069351196289062
generate_one_block  0.0012514591217041016
generate_one_block  0.0014646053314208984
generate_one_block  0.002241373062133789
generate_one_block  0.0011012554168701172
generate_one_block  0.0010957717895507812
generate_one_block  0.00156402587890625
generate_one_block  0.002623319625854492
generate_one_block  0.0011835098266601562
generate_one_block  0.001493215560913086
generate_one_block  0.0013751983642578125
generate_one_block  0.0018634796142578125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

connection checking time:  0.020089149475097656
block generation total time  0.042479753494262695
average batch blocks generation time:  0.00283198356628418
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0015201568603515625  GigaBytes
Max Memory Allocated: 0.0015201568603515625  GigaBytes

torch.Size([660, 500])
torch.Size([164, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0017170906066894531  GigaBytes
Max Memory Allocated: 0.0018072128295898438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0031995773315429688  GigaBytes
Max Memory Allocated: 0.004406929016113281  GigaBytes

torch.Size([1410, 500])
torch.Size([379, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0035529136657714844  GigaBytes
Max Memory Allocated: 0.004406929016113281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0010929107666015625  GigaBytes
Max Memory Allocated: 0.004406929016113281  GigaBytes

torch.Size([287, 500])
torch.Size([129, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0012221336364746094  GigaBytes
Max Memory Allocated: 0.004406929016113281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005209445953369141  GigaBytes
Max Memory Allocated: 0.005694389343261719  GigaBytes

torch.Size([2474, 500])
torch.Size([411, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005624294281005859  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0013337135314941406  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([416, 500])
torch.Size([120, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.001461029052734375  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([880, 500])
torch.Size([152, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0023589134216308594  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003936767578125  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([1801, 500])
torch.Size([400, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004337310791015625  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0010042190551757812  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([241, 500])
torch.Size([65, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0010819435119628906  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0010471343994140625  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([264, 500])
torch.Size([62, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0011196136474609375  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0024480819702148438  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([1010, 500])
torch.Size([220, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002669811248779297  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003991603851318359  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([1825, 500])
torch.Size([380, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004374027252197266  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0011754035949707031  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([332, 500])
torch.Size([93, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0012745857238769531  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.001991748809814453  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([766, 500])
torch.Size([141, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002136707305908203  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0016889572143554688  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([605, 500])
torch.Size([99, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0017957687377929688  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002208709716796875  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([881, 500])
torch.Size([273, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0024619102478027344  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0016600131988525391 |0.023814614613850912 |0.0548767884572347 |0.00014657974243164061 |0.002283477783203125 |0.00202178955078125 |
----------------------------------------------------------pseudo_mini_loss sum 2.7230324745178223
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17297
Number of first layer input nodes during this epoch:  13852
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002795696258544922  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004532337188720703
range selection method range initialization spend 5.1021575927734375e-05
time for parepare:  4.553794860839844e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.09808349609375e-05
----------------------check_connections_block total spend ----------------------------- 0.0026540756225585938
generate_one_block  0.0010762214660644531
generate_one_block  0.0010216236114501953
generate_one_block  0.0010080337524414062
generate_one_block  0.0010170936584472656
generate_one_block  0.0010046958923339844
generate_one_block  0.001268148422241211
generate_one_block  0.0010025501251220703
generate_one_block  0.0010106563568115234
generate_one_block  0.0010149478912353516
generate_one_block  0.001068115234375
generate_one_block  0.0009734630584716797
generate_one_block  0.0009424686431884766
generate_one_block  0.0009410381317138672
generate_one_block  0.0009648799896240234
generate_one_block  0.0009450912475585938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006101131439208984
gen group dst list time:  7.891654968261719e-05
time for parepare:  0.00027370452880859375
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010013580322265625
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.961822509765625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00014472007751464844
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.605552673339844e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.175041198730469e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.000125885009765625
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.91278076171875e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  6.651878356933594e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00018978118896484375
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00019168853759765625
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00014400482177734375
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.225440979003906e-05
----------------------check_connections_block total spend ----------------------------- 0.004599571228027344
generate_one_block  0.0011067390441894531
generate_one_block  0.0011262893676757812
generate_one_block  0.0011622905731201172
generate_one_block  0.0011904239654541016
generate_one_block  0.0010890960693359375
generate_one_block  0.0010716915130615234
generate_one_block  0.0011241436004638672
generate_one_block  0.001172780990600586
generate_one_block  0.00102996826171875
generate_one_block  0.0010669231414794922
generate_one_block  0.0012056827545166016
generate_one_block  0.0011744499206542969
generate_one_block  0.0009949207305908203
generate_one_block  0.0010979175567626953
generate_one_block  0.00102996826171875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011572837829589844
gen group dst list time:  0.0001285076141357422
time for parepare:  0.0008108615875244141
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0002758502960205078
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0003542900085449219
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.00045108795166015625
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0003707408905029297
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  9.131431579589844e-05
r_  generation:  0.0008287429809570312
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0005652904510498047
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0002529621124267578
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0003745555877685547
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0006995201110839844
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0003330707550048828
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.0005207061767578125
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.001323699951171875
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  0.00015974044799804688
r_  generation:  0.0013360977172851562
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0002200603485107422
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.0005891323089599609
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0006349086761474609
----------------------check_connections_block total spend ----------------------------- 0.016100645065307617
generate_one_block  0.001653909683227539
generate_one_block  0.0014765262603759766
generate_one_block  0.0013852119445800781
generate_one_block  0.0018475055694580078
generate_one_block  0.001615762710571289
generate_one_block  0.0012199878692626953
generate_one_block  0.0013670921325683594
generate_one_block  0.0017502307891845703
generate_one_block  0.0013196468353271484
generate_one_block  0.001596212387084961
generate_one_block  0.0025136470794677734
generate_one_block  0.0032362937927246094
generate_one_block  0.0012159347534179688
generate_one_block  0.0017125606536865234
generate_one_block  0.0017685890197753906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002795696258544922  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

connection checking time:  0.02070021629333496
block generation total time  0.042322397232055664
average batch blocks generation time:  0.002821493148803711
block dataloader generation time/epoch 0.09591412544250488
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0022912025451660156  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([636, 500])
torch.Size([177, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0024576187133789062  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0024347305297851562  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([711, 500])
torch.Size([220, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002640247344970703  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0022950172424316406  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([637, 500])
torch.Size([142, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002438068389892578  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0037255287170410156  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([1399, 500])
torch.Size([315, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004046440124511719  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003154754638671875  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([1096, 500])
torch.Size([138, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003307819366455078  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.001911163330078125  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([433, 500])
torch.Size([122, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002040386199951172  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002193450927734375  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([583, 500])
torch.Size([180, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0023651123046875  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0034646987915039062  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([1261, 500])
torch.Size([313, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0037660598754882812  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002323627471923828  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([654, 500])
torch.Size([102, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00243377685546875  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002814769744873047  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([914, 500])
torch.Size([135, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0029587745666503906  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004283905029296875  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

torch.Size([1690, 500])
torch.Size([420, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004692554473876953  GigaBytes
Max Memory Allocated: 0.00614166259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0037980079650878906  GigaBytes
Max Memory Allocated: 0.0069065093994140625  GigaBytes

torch.Size([1429, 500])
torch.Size([362, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004154682159423828  GigaBytes
Max Memory Allocated: 0.0069065093994140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0017900466918945312  GigaBytes
Max Memory Allocated: 0.0069065093994140625  GigaBytes

torch.Size([369, 500])
torch.Size([81, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018801689147949219  GigaBytes
Max Memory Allocated: 0.0069065093994140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0030231475830078125  GigaBytes
Max Memory Allocated: 0.0069065093994140625  GigaBytes

torch.Size([1025, 500])
torch.Size([224, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0032858848571777344  GigaBytes
Max Memory Allocated: 0.0069065093994140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003902435302734375  GigaBytes
Max Memory Allocated: 0.0069065093994140625  GigaBytes
Using backend: pytorch

torch.Size([1497, 500])
torch.Size([172, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004086971282958984  GigaBytes
Max Memory Allocated: 0.0069065093994140625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0007668654123942057 |0.00046097437540690105 |0.0036814212799072266 |0.00012734731038411458 |0.00312345822652181 |0.0014903545379638672 |
----------------------------------------------------------pseudo_mini_loss sum 2.1166417598724365
Total (block generation + training)time/epoch 0.23975133895874023
Training time/epoch 0.1435248851776123
Training time without block to device /epoch 0.1366102695465088
Training time without total dataloading part /epoch 0.10547375679016113
load block tensor time/epoch 0.011502981185913086
block to device time/epoch 0.006914615631103516
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17794
Number of first layer input nodes during this epoch:  14334
