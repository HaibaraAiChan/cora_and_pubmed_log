main start at this time 1648527033.3270752
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002270221710205078
range selection method range initialization spend 7.891654968261719e-05
time for parepare:  4.1961669921875e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.0012066364288330078
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.124641418457031e-05
----------------------check_connections_block total spend ----------------------------- 0.002169370651245117
generate_one_block  0.0011410713195800781
generate_one_block  0.001035928726196289
generate_one_block  0.0010831356048583984
generate_one_block  0.0010101795196533203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011930465698242188
gen group dst list time:  3.1948089599609375e-05
time for parepare:  0.00024890899658203125
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002810955047607422
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0003056526184082031
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00027298927307128906
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004608631134033203
----------------------check_connections_block total spend ----------------------------- 0.0027794837951660156
generate_one_block  0.0013523101806640625
generate_one_block  0.0013909339904785156
generate_one_block  0.0013010501861572266
generate_one_block  0.0016162395477294922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010132789611816406
gen group dst list time:  6.842613220214844e-05
time for parepare:  0.0007138252258300781
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.0002918243408203125
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.0018551349639892578
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  0.00019288063049316406
r_  generation:  0.0018315315246582031
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.0016596317291259766
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.00023436546325683594
mini_batch_src_global generation:  0.0002999305725097656
r_  generation:  0.0032622814178466797
----------------------check_connections_block total spend ----------------------------- 0.013534784317016602
generate_one_block  0.003684520721435547
generate_one_block  0.0032906532287597656
generate_one_block  0.0030968189239501953
generate_one_block  0.00493621826171875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

connection checking time:  0.016314268112182617
block generation total time  0.020668745040893555
average batch blocks generation time:  0.005167186260223389
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.006279945373535156  GigaBytes
Max Memory Allocated: 0.006279945373535156  GigaBytes

torch.Size([3305, 500])
torch.Size([684, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006497859954833984  GigaBytes
Max Memory Allocated: 0.0066852569580078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0060825347900390625  GigaBytes
Max Memory Allocated: 0.012185096740722656  GigaBytes

torch.Size([3164, 500])
torch.Size([711, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00630950927734375  GigaBytes
Max Memory Allocated: 0.012185096740722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006340503692626953  GigaBytes
Max Memory Allocated: 0.012185096740722656  GigaBytes

torch.Size([2896, 500])
torch.Size([632, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0065441131591796875  GigaBytes
Max Memory Allocated: 0.012185096740722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007513999938964844  GigaBytes
Max Memory Allocated: 0.013570785522460938  GigaBytes

torch.Size([3908, 500])
torch.Size([968, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00784444808959961  GigaBytes
Max Memory Allocated: 0.013570785522460938  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0050449371337890625 |0.08626788854598999 |0.19438815116882324 |0.00020873546600341797 |0.003327310085296631 |0.004131793975830078 |
----------------------------------------------------------pseudo_mini_loss sum 2.099994659423828
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16624
Number of first layer input nodes during this epoch:  13273
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00786733627319336  GigaBytes
Max Memory Allocated: 0.013570785522460938  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006918907165527344
range selection method range initialization spend 7.343292236328125e-05
time for parepare:  7.224082946777344e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0002396106719970703
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00017189979553222656
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  6.508827209472656e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.794929504394531e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  4.887580871582031e-05
----------------------check_connections_block total spend ----------------------------- 0.0015883445739746094
generate_one_block  0.001684427261352539
generate_one_block  0.0015316009521484375
generate_one_block  0.0012578964233398438
generate_one_block  0.001093149185180664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005557537078857422
gen group dst list time:  3.457069396972656e-05
time for parepare:  0.0002682209014892578
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0004112720489501953
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.00038242340087890625
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0002911090850830078
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.000335693359375
----------------------check_connections_block total spend ----------------------------- 0.0029935836791992188
generate_one_block  0.001636505126953125
generate_one_block  0.0015616416931152344
generate_one_block  0.0012993812561035156
generate_one_block  0.0013532638549804688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009884834289550781
gen group dst list time:  7.271766662597656e-05
time for parepare:  0.0007047653198242188
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0003437995910644531
mini_batch_src_global generation:  0.00025153160095214844
r_  generation:  0.002797842025756836
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  0.00030541419982910156
r_  generation:  0.002310037612915039
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  0.00016355514526367188
r_  generation:  0.0014524459838867188
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  0.00019931793212890625
r_  generation:  0.0020427703857421875
----------------------check_connections_block total spend ----------------------------- 0.013704776763916016
generate_one_block  0.004807710647583008
generate_one_block  0.004116058349609375
generate_one_block  0.0027151107788085938
generate_one_block  0.0035216808319091797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00786733627319336  GigaBytes
Max Memory Allocated: 0.013570785522460938  GigaBytes

connection checking time:  0.016698360443115234
block generation total time  0.0210113525390625
average batch blocks generation time:  0.005252838134765625
block dataloader generation time/epoch 0.059206485748291016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007916450500488281  GigaBytes
Max Memory Allocated: 0.01510763168334961  GigaBytes

torch.Size([4061, 500])
torch.Size([923, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008219242095947266  GigaBytes
Max Memory Allocated: 0.01510763168334961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008243560791015625  GigaBytes
Max Memory Allocated: 0.01573801040649414  GigaBytes

torch.Size([4246, 500])
torch.Size([841, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008516311645507812  GigaBytes
Max Memory Allocated: 0.01573801040649414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.005394935607910156  GigaBytes
Max Memory Allocated: 0.01573801040649414  GigaBytes

torch.Size([2732, 500])
torch.Size([572, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.005586147308349609  GigaBytes
Max Memory Allocated: 0.01573801040649414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004630088806152344  GigaBytes
Max Memory Allocated: 0.01573801040649414  GigaBytes

torch.Size([2308, 500])
torch.Size([658, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0048542022705078125  GigaBytes
Max Memory Allocated: 0.01573801040649414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0022174715995788574 |0.0003928542137145996 |0.0030405521392822266 |0.00011324882507324219 |0.0026549696922302246 |0.0013833045959472656 |
----------------------------------------------------------pseudo_mini_loss sum 1.4067219495773315
Total (block generation + training)time/epoch 0.09911584854125977
Training time/epoch 0.039546966552734375
Training time without block to device /epoch 0.03797554969787598
Training time without total dataloading part /epoch 0.02461838722229004
load block tensor time/epoch 0.00886988639831543
block to device time/epoch 0.0015714168548583984
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16697
Number of first layer input nodes during this epoch:  13347
