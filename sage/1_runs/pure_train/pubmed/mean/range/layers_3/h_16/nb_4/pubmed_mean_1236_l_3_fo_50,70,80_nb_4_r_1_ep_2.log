main start at this time 1648527023.3420374
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0037078857421875
range selection method range initialization spend 0.00010728836059570312
time for parepare:  4.124641418457031e-05
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0019240379333496094
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  7.081031799316406e-05
----------------------check_connections_block total spend ----------------------------- 0.002593517303466797
generate_one_block  0.0012595653533935547
generate_one_block  0.0011219978332519531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017554759979248047
gen group dst list time:  2.288818359375e-05
time for parepare:  0.00022721290588378906
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0005066394805908203
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  0.00011610984802246094
r_  generation:  0.00069427490234375
----------------------check_connections_block total spend ----------------------------- 0.002302408218383789
generate_one_block  0.001886129379272461
generate_one_block  0.0018820762634277344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001043081283569336
gen group dst list time:  6.318092346191406e-05
time for parepare:  0.0007328987121582031
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.00037550926208496094
mini_batch_src_global generation:  0.00024962425231933594
r_  generation:  0.0034151077270507812
local_output_nid generation:  0.00010418891906738281
local_in_edges_tensor generation:  0.0003120899200439453
mini_batch_src_global generation:  0.0005741119384765625
r_  generation:  0.0046193599700927734
----------------------check_connections_block total spend ----------------------------- 0.012731313705444336
generate_one_block  0.0057141780853271484
generate_one_block  0.006857156753540039
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

connection checking time:  0.015033721923828125
block generation total time  0.016339540481567383
average batch blocks generation time:  0.008169770240783691
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.010381698608398438  GigaBytes
Max Memory Allocated: 0.010381698608398438  GigaBytes

torch.Size([5481, 500])
torch.Size([1361, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.010807514190673828  GigaBytes
Max Memory Allocated: 0.011103153228759766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010815620422363281  GigaBytes
Max Memory Allocated: 0.020883560180664062  GigaBytes

torch.Size([5658, 500])
torch.Size([1554, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011328697204589844  GigaBytes
Max Memory Allocated: 0.020883560180664062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004465341567993164 |0.17297446727752686 |0.3963397741317749 |0.0002524852752685547 |0.004866957664489746 |0.0035076141357421875 |
----------------------------------------------------------pseudo_mini_loss sum 2.1486763954162598
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14410
Number of first layer input nodes during this epoch:  11139
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011265277862548828  GigaBytes
Max Memory Allocated: 0.020883560180664062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00047469139099121094
range selection method range initialization spend 4.9591064453125e-05
time for parepare:  3.9577484130859375e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.246566772460938e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.507469177246094e-05
----------------------check_connections_block total spend ----------------------------- 0.0006215572357177734
generate_one_block  0.0011942386627197266
generate_one_block  0.0010614395141601562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005056858062744141
gen group dst list time:  2.3603439331054688e-05
time for parepare:  0.0002617835998535156
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0006802082061767578
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0005538463592529297
----------------------check_connections_block total spend ----------------------------- 0.0023736953735351562
generate_one_block  0.0018818378448486328
generate_one_block  0.0016894340515136719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009968280792236328
gen group dst list time:  6.556510925292969e-05
time for parepare:  0.0006818771362304688
local_output_nid generation:  0.00011515617370605469
local_in_edges_tensor generation:  0.00041961669921875
mini_batch_src_global generation:  0.0004525184631347656
r_  generation:  0.004771232604980469
local_output_nid generation:  0.00010013580322265625
local_in_edges_tensor generation:  0.0002713203430175781
mini_batch_src_global generation:  0.0004696846008300781
r_  generation:  0.0033905506134033203
----------------------check_connections_block total spend ----------------------------- 0.012898921966552734
generate_one_block  0.007439851760864258
generate_one_block  0.005524873733520508
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011265277862548828  GigaBytes
Max Memory Allocated: 0.020883560180664062  GigaBytes

connection checking time:  0.01527261734008789
block generation total time  0.01653599739074707
average batch blocks generation time:  0.008267998695373535
block dataloader generation time/epoch 0.05196642875671387
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013088703155517578  GigaBytes
Max Memory Allocated: 0.02347850799560547  GigaBytes
Using backend: pytorch

torch.Size([6805, 500])
torch.Size([1724, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013638496398925781  GigaBytes
Max Memory Allocated: 0.02347850799560547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008851051330566406  GigaBytes
Max Memory Allocated: 0.02347850799560547  GigaBytes

torch.Size([4552, 500])
torch.Size([1222, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00925588607788086  GigaBytes
Max Memory Allocated: 0.02347850799560547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0038521289825439453 |0.0006976127624511719 |0.004458785057067871 |0.00016045570373535156 |0.003146648406982422 |0.00283050537109375 |
----------------------------------------------------------pseudo_mini_loss sum 1.5958893299102783
Total (block generation + training)time/epoch 0.0834498405456543
Training time/epoch 0.031141281127929688
Training time without block to device /epoch 0.029746055603027344
Training time without total dataloading part /epoch 0.01836228370666504
load block tensor time/epoch 0.007704257965087891
block to device time/epoch 0.0013952255249023438
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14659
Number of first layer input nodes during this epoch:  11357
