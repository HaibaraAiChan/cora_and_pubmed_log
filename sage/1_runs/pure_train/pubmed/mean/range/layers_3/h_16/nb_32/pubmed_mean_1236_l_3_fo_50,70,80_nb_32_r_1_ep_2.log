main start at this time 1648527053.449446
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019063949584960938
range selection method range initialization spend 9.369850158691406e-05
time for parepare:  4.315376281738281e-05
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  0.0025806427001953125
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9550323486328125e-05
----------------------check_connections_block total spend ----------------------------- 0.005261421203613281
generate_one_block  0.0012416839599609375
generate_one_block  0.0010056495666503906
generate_one_block  0.0009753704071044922
generate_one_block  0.0009889602661132812
generate_one_block  0.0010006427764892578
generate_one_block  0.0010135173797607422
generate_one_block  0.0009751319885253906
generate_one_block  0.0009756088256835938
generate_one_block  0.0010294914245605469
generate_one_block  0.0009996891021728516
generate_one_block  0.000990152359008789
generate_one_block  0.0010309219360351562
generate_one_block  0.0010144710540771484
generate_one_block  0.0009627342224121094
generate_one_block  0.0009887218475341797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011668205261230469
gen group dst list time:  8.058547973632812e-05
time for parepare:  0.00025725364685058594
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.82012939453125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  9.322166442871094e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  9.012222290039062e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00019168853759765625
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00010919570922851562
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  5.340576171875e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  5.125999450683594e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.318092346191406e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00012183189392089844
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00022292137145996094
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001842975616455078
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  7.605552673339844e-05
----------------------check_connections_block total spend ----------------------------- 0.004640340805053711
generate_one_block  0.0010399818420410156
generate_one_block  0.0010974407196044922
generate_one_block  0.0011327266693115234
generate_one_block  0.0012660026550292969
generate_one_block  0.0011043548583984375
generate_one_block  0.0010371208190917969
generate_one_block  0.0010423660278320312
generate_one_block  0.0010762214660644531
generate_one_block  0.0010340213775634766
generate_one_block  0.0010561943054199219
generate_one_block  0.001140594482421875
generate_one_block  0.0012242794036865234
generate_one_block  0.0012555122375488281
generate_one_block  0.0010328292846679688
generate_one_block  0.0010256767272949219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011548995971679688
gen group dst list time:  0.00012755393981933594
time for parepare:  0.0007750988006591797
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00023174285888671875
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001361370086669922
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00045561790466308594
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.0005290508270263672
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  0.00018167495727539062
r_  generation:  0.0015783309936523438
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0003337860107421875
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.0007870197296142578
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00021886825561523438
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00025010108947753906
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0004258155822753906
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0001811981201171875
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00032019615173339844
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  7.390975952148438e-05
r_  generation:  0.0007336139678955078
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  0.0001678466796875
r_  generation:  0.001735687255859375
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  0.0001780986785888672
r_  generation:  0.0014636516571044922
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0005908012390136719
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00039458274841308594
----------------------check_connections_block total spend ----------------------------- 0.017378568649291992
generate_one_block  0.0012631416320800781
generate_one_block  0.0015716552734375
generate_one_block  0.0015499591827392578
generate_one_block  0.0029082298278808594
generate_one_block  0.0019123554229736328
generate_one_block  0.0011606216430664062
generate_one_block  0.0012700557708740234
generate_one_block  0.0014548301696777344
generate_one_block  0.0011289119720458984
generate_one_block  0.0012955665588378906
generate_one_block  0.0018000602722167969
generate_one_block  0.003090381622314453
generate_one_block  0.0026721954345703125
generate_one_block  0.001575469970703125
generate_one_block  0.0016524791717529297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

connection checking time:  0.022018909454345703
block generation total time  0.04287123680114746
average batch blocks generation time:  0.0028580824534098306
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0005240440368652344  GigaBytes
Max Memory Allocated: 0.0005240440368652344  GigaBytes

torch.Size([242, 500])
torch.Size([53, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.0005478858947753906  GigaBytes
Max Memory Allocated: 0.0005526542663574219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0016202926635742188  GigaBytes
Max Memory Allocated: 0.0020575523376464844  GigaBytes

torch.Size([790, 500])
torch.Size([204, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0016875267028808594  GigaBytes
Max Memory Allocated: 0.0020575523376464844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0017781257629394531  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

torch.Size([874, 500])
torch.Size([217, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0018472671508789062  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005619525909423828  GigaBytes
Max Memory Allocated: 0.007202625274658203  GigaBytes

torch.Size([2920, 500])
torch.Size([480, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005778789520263672  GigaBytes
Max Memory Allocated: 0.007202625274658203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003257274627685547  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([1418, 500])
torch.Size([185, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0033359527587890625  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.000713348388671875  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([307, 500])
torch.Size([96, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0007481575012207031  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010056495666503906  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([463, 500])
torch.Size([132, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010514259338378906  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015430450439453125  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([749, 500])
torch.Size([110, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015878677368164062  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0007176399230957031  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([310, 500])
torch.Size([80, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0007505416870117188  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011396408081054688  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([534, 500])
torch.Size([134, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011873245239257812  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0027680397033691406  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([1402, 500])
torch.Size([261, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0028591156005859375  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003883838653564453  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([1983, 500])
torch.Size([425, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0040416717529296875  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0037865638732910156  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([1733, 500])
torch.Size([396, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003928661346435547  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002158641815185547  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([1078, 500])
torch.Size([163, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00222015380859375  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015196800231933594  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([737, 500])
torch.Size([160, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015773773193359375  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0034354050954182942 |0.023605807622273763 |0.05655779838562012 |0.00015314420064290365 |0.0023064295450846354 |0.0024733543395996094 |
----------------------------------------------------------pseudo_mini_loss sum 2.0219359397888184
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  18993
Number of first layer input nodes during this epoch:  15540
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016798973083496094  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004868507385253906
range selection method range initialization spend 5.435943603515625e-05
time for parepare:  4.506111145019531e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.7738037109375e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.6927719116210938e-05
----------------------check_connections_block total spend ----------------------------- 0.0026929378509521484
generate_one_block  0.0011212825775146484
generate_one_block  0.0009891986846923828
generate_one_block  0.0010182857513427734
generate_one_block  0.0009968280792236328
generate_one_block  0.0009777545928955078
generate_one_block  0.0012023448944091797
generate_one_block  0.000986337661743164
generate_one_block  0.0009868144989013672
generate_one_block  0.000985860824584961
generate_one_block  0.0009794235229492188
generate_one_block  0.0009419918060302734
generate_one_block  0.0009381771087646484
generate_one_block  0.0009822845458984375
generate_one_block  0.0009405612945556641
generate_one_block  0.0009410381317138672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006513595581054688
gen group dst list time:  7.700920104980469e-05
time for parepare:  0.00025963783264160156
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.2479248046875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00020837783813476562
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00022363662719726562
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  8.630752563476562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010085105895996094
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  8.273124694824219e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  9.226799011230469e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  9.369850158691406e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  9.107589721679688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0001590251922607422
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.507469177246094e-05
----------------------check_connections_block total spend ----------------------------- 0.00452733039855957
generate_one_block  0.0010445117950439453
generate_one_block  0.001056671142578125
generate_one_block  0.0013244152069091797
generate_one_block  0.0013034343719482422
generate_one_block  0.0010704994201660156
generate_one_block  0.0010828971862792969
generate_one_block  0.0011386871337890625
generate_one_block  0.0010945796966552734
generate_one_block  0.0010814666748046875
generate_one_block  0.00101470947265625
generate_one_block  0.0010538101196289062
generate_one_block  0.001092672348022461
generate_one_block  0.001134634017944336
generate_one_block  0.0010325908660888672
generate_one_block  0.0010101795196533203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012099742889404297
gen group dst list time:  0.00012993812561035156
time for parepare:  0.0009627342224121094
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0002644062042236328
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0001823902130126953
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  9.417533874511719e-05
r_  generation:  0.0006616115570068359
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  0.0002269744873046875
r_  generation:  0.0016107559204101562
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.0001544952392578125
r_  generation:  0.0013461112976074219
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0005209445953369141
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005552768707275391
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.0007870197296142578
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0003063678741455078
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0005240440368652344
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00024271011352539062
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  8.20159912109375e-05
r_  generation:  0.0005524158477783203
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0005209445953369141
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  0.00013566017150878906
r_  generation:  0.0013625621795654297
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.00030875205993652344
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00025773048400878906
----------------------check_connections_block total spend ----------------------------- 0.017537832260131836
generate_one_block  0.001468658447265625
generate_one_block  0.00173187255859375
generate_one_block  0.0029439926147460938
generate_one_block  0.002622842788696289
generate_one_block  0.0015418529510498047
generate_one_block  0.0015707015991210938
generate_one_block  0.0019903182983398438
generate_one_block  0.0014927387237548828
generate_one_block  0.0015647411346435547
generate_one_block  0.0012345314025878906
generate_one_block  0.0015552043914794922
generate_one_block  0.0015265941619873047
generate_one_block  0.002533435821533203
generate_one_block  0.0013225078582763672
generate_one_block  0.001238107681274414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0016798973083496094  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

connection checking time:  0.022065162658691406
block generation total time  0.04287385940551758
average batch blocks generation time:  0.002858257293701172
block dataloader generation time/epoch 0.09889888763427734
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0009245872497558594  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([352, 500])
torch.Size([68, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0009541511535644531  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0026650428771972656  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([1278, 500])
torch.Size([137, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0027256011962890625  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00406646728515625  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([2014, 500])
torch.Size([472, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004227161407470703  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004659175872802734  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([2338, 500])
torch.Size([536, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004826545715332031  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0017485618591308594  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([788, 500])
torch.Size([130, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018019676208496094  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002124786376953125  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([990, 500])
torch.Size([171, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00218963623046875  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0036911964416503906  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([1827, 500])
torch.Size([241, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0037755966186523438  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012927055358886719  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([547, 500])
torch.Size([141, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0013470649719238281  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0023632049560546875  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([1118, 500])
torch.Size([188, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002433300018310547  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012183189392089844  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([508, 500])
torch.Size([61, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012478828430175781  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002060413360595703  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([955, 500])
torch.Size([220, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0021333694458007812  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0019421577453613281  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([892, 500])
torch.Size([183, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00200653076171875  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0027866363525390625  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([1330, 500])
torch.Size([306, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002907276153564453  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011548995971679688  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

torch.Size([473, 500])
torch.Size([119, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011973381042480469  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010266304016113281  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes
Using backend: pytorch

torch.Size([404, 500])
torch.Size([123, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010704994201660156  GigaBytes
Max Memory Allocated: 0.008674144744873047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0007961273193359375 |0.0003933906555175781 |0.0031351884206136066 |0.00011375745137532552 |0.003075249989827474 |0.0017511844635009766 |
----------------------------------------------------------pseudo_mini_loss sum 1.7222145795822144
Total (block generation + training)time/epoch 0.23041296005249023
Training time/epoch 0.13129353523254395
Training time without block to device /epoch 0.12539267539978027
Training time without total dataloading part /epoch 0.09661412239074707
load block tensor time/epoch 0.011941909790039062
block to device time/epoch 0.005900859832763672
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  19267
Number of first layer input nodes during this epoch:  15814
