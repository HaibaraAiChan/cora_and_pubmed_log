Using backend: pytorch
main start at this time 1648526863.3577244
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018537044525146484
range selection method range initialization spend 8.177757263183594e-05
time for parepare:  3.8623809814453125e-05
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0015325546264648438
----------------------check_connections_block total spend ----------------------------- 0.0019271373748779297
generate_one_block  0.0014660358428955078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009531974792480469
gen group dst list time:  1.811981201171875e-05
time for parepare:  0.00020933151245117188
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.0011396408081054688
----------------------check_connections_block total spend ----------------------------- 0.002014636993408203
generate_one_block  0.0025327205657958984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009701251983642578
gen group dst list time:  4.9591064453125e-05
time for parepare:  0.0006718635559082031
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.0005183219909667969
mini_batch_src_global generation:  0.0004298686981201172
r_  generation:  0.005735635757446289
----------------------check_connections_block total spend ----------------------------- 0.009147167205810547
generate_one_block  0.008886337280273438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

connection checking time:  0.01116180419921875
block generation total time  0.011419057846069336
average batch blocks generation time:  0.011419057846069336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.014363765716552734  GigaBytes
Max Memory Allocated: 0.014363765716552734  GigaBytes

torch.Size([7575, 500])
torch.Size([2527, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.015157699584960938  GigaBytes
Max Memory Allocated: 0.015505790710449219  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0047609806060791016 |0.33618831634521484 |0.7606253623962402 |0.0002288818359375 |0.007965326309204102 |0.004125118255615234 |
----------------------------------------------------------pseudo_mini_loss sum 2.1871368885040283
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10456
Number of first layer input nodes during this epoch:  7575
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.01498270034790039  GigaBytes
Max Memory Allocated: 0.01578235626220703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008306503295898438
range selection method range initialization spend 9.34600830078125e-05
time for parepare:  8.487701416015625e-05
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00030303001403808594
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0001404285430908203
----------------------check_connections_block total spend ----------------------------- 0.0007278919219970703
generate_one_block  0.0015871524810791016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006587505340576172
gen group dst list time:  2.4318695068359375e-05
time for parepare:  0.0003459453582763672
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00026917457580566406
mini_batch_src_global generation:  0.00017595291137695312
r_  generation:  0.001421213150024414
----------------------check_connections_block total spend ----------------------------- 0.0026738643646240234
generate_one_block  0.003228425979614258
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011739730834960938
gen group dst list time:  7.843971252441406e-05
time for parepare:  0.0008709430694580078
local_output_nid generation:  0.00023055076599121094
local_in_edges_tensor generation:  0.0006186962127685547
mini_batch_src_global generation:  0.0007457733154296875
r_  generation:  0.007682085037231445
----------------------check_connections_block total spend ----------------------------- 0.012518882751464844
generate_one_block  0.010289192199707031
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.01498270034790039  GigaBytes
Max Memory Allocated: 0.01578235626220703  GigaBytes

connection checking time:  0.015192747116088867
block generation total time  0.013517618179321289
average batch blocks generation time:  0.013517618179321289
block dataloader generation time/epoch 0.049263715744018555
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014589309692382812  GigaBytes
Max Memory Allocated: 0.028513431549072266  GigaBytes

torch.Size([7591, 500])
torch.Size([2531, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015384197235107422  GigaBytes
Max Memory Allocated: 0.028513431549072266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007234811782836914 |0.0012061595916748047 |0.005631446838378906 |0.00018858909606933594 |0.004062652587890625 |0.002095937728881836 |
----------------------------------------------------------pseudo_mini_loss sum 1.1865030527114868
Total (block generation + training)time/epoch 0.07288336753845215
Training time/epoch 0.023070812225341797
Training time without block to device /epoch 0.021864652633666992
Training time without total dataloading part /epoch 0.011978626251220703
load block tensor time/epoch 0.007234811782836914
block to device time/epoch 0.0012061595916748047
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10476
Number of first layer input nodes during this epoch:  7591
