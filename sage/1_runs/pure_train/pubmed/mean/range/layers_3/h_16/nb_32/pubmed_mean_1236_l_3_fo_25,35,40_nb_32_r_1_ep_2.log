main start at this time 1648526903.359629
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001994609832763672
range selection method range initialization spend 8.320808410644531e-05
time for parepare:  4.1484832763671875e-05
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  0.0011353492736816406
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.9311904907226562e-05
----------------------check_connections_block total spend ----------------------------- 0.0038423538208007812
generate_one_block  0.0011739730834960938
generate_one_block  0.0010058879852294922
generate_one_block  0.000997304916381836
generate_one_block  0.0010089874267578125
generate_one_block  0.001005411148071289
generate_one_block  0.0010161399841308594
generate_one_block  0.0010135173797607422
generate_one_block  0.0009810924530029297
generate_one_block  0.0010268688201904297
generate_one_block  0.0010218620300292969
generate_one_block  0.0010118484497070312
generate_one_block  0.0010035037994384766
generate_one_block  0.0010063648223876953
generate_one_block  0.000993490219116211
generate_one_block  0.0010063648223876953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012166500091552734
gen group dst list time:  7.82012939453125e-05
time for parepare:  0.0002541542053222656
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  9.202957153320312e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.465217590332031e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00017523765563964844
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  9.512901306152344e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.103515625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00011897087097167969
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.000213623046875
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00016069412231445312
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.557868957519531e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  7.700920104980469e-05
----------------------check_connections_block total spend ----------------------------- 0.004539966583251953
generate_one_block  0.0010263919830322266
generate_one_block  0.0011157989501953125
generate_one_block  0.0011014938354492188
generate_one_block  0.0012772083282470703
generate_one_block  0.00110626220703125
generate_one_block  0.0010437965393066406
generate_one_block  0.0010480880737304688
generate_one_block  0.0010976791381835938
generate_one_block  0.0009915828704833984
generate_one_block  0.0010306835174560547
generate_one_block  0.0010967254638671875
generate_one_block  0.0012192726135253906
generate_one_block  0.0011620521545410156
generate_one_block  0.0010418891906738281
generate_one_block  0.0010366439819335938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010867118835449219
gen group dst list time:  0.00011992454528808594
time for parepare:  0.0007390975952148438
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0001232624053955078
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0003993511199951172
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004258155822753906
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  0.00011301040649414062
r_  generation:  0.0011172294616699219
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  8.726119995117188e-05
r_  generation:  0.0005674362182617188
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0001971721649169922
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00020647048950195312
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0003528594970703125
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00017690658569335938
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00029087066650390625
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0007007122039794922
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  0.00014853477478027344
r_  generation:  0.0014400482177734375
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  0.00014734268188476562
r_  generation:  0.0011467933654785156
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.0004904270172119141
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0003643035888671875
----------------------check_connections_block total spend ----------------------------- 0.014793157577514648
generate_one_block  0.0012295246124267578
generate_one_block  0.0015609264373779297
generate_one_block  0.0014634132385253906
generate_one_block  0.0024785995483398438
generate_one_block  0.0016312599182128906
generate_one_block  0.001168966293334961
generate_one_block  0.0012307167053222656
generate_one_block  0.0013747215270996094
generate_one_block  0.0011434555053710938
generate_one_block  0.0012881755828857422
generate_one_block  0.001800537109375
generate_one_block  0.0035097599029541016
generate_one_block  0.0022535324096679688
generate_one_block  0.0015175342559814453
generate_one_block  0.001619100570678711
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

connection checking time:  0.0193331241607666
block generation total time  0.04166579246520996
average batch blocks generation time:  0.002777719497680664
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.00045871734619140625  GigaBytes
Max Memory Allocated: 0.00045871734619140625  GigaBytes

torch.Size([207, 500])
torch.Size([53, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.0004825592041015625  GigaBytes
Max Memory Allocated: 0.0004849433898925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0014414787292480469  GigaBytes
Max Memory Allocated: 0.0018153190612792969  GigaBytes

torch.Size([695, 500])
torch.Size([202, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.001506805419921875  GigaBytes
Max Memory Allocated: 0.0018153190612792969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0015377998352050781  GigaBytes
Max Memory Allocated: 0.002819538116455078  GigaBytes

torch.Size([746, 500])
torch.Size([193, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0016007423400878906  GigaBytes
Max Memory Allocated: 0.002819538116455078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004171848297119141  GigaBytes
Max Memory Allocated: 0.005527973175048828  GigaBytes

torch.Size([2149, 500])
torch.Size([420, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004309177398681641  GigaBytes
Max Memory Allocated: 0.005527973175048828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0028352737426757812  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

torch.Size([1116, 500])
torch.Size([150, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002899646759033203  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0006947517395019531  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

torch.Size([297, 500])
torch.Size([96, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0007295608520507812  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0008473396301269531  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

torch.Size([379, 500])
torch.Size([107, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0008854866027832031  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0013289451599121094  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

torch.Size([635, 500])
torch.Size([110, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0013718605041503906  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0006990432739257812  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

torch.Size([300, 500])
torch.Size([80, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0007319450378417969  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010485649108886719  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

torch.Size([485, 500])
torch.Size([129, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010962486267089844  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0025415420532226562  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

torch.Size([1281, 500])
torch.Size([261, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002631664276123047  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0034503936767578125  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

torch.Size([1756, 500])
torch.Size([408, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003592967987060547  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0029287338256835938  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

torch.Size([1482, 500])
torch.Size([337, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0030465126037597656  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0019335746765136719  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

torch.Size([958, 500])
torch.Size([163, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0019931793212890625  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.001384735107421875  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

torch.Size([665, 500])
torch.Size([160, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0014414787292480469  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002028020222981771 |0.023493210474650066 |0.054791196187337236 |0.0001438140869140625 |0.002302185694376628 |0.0028531551361083984 |
----------------------------------------------------------pseudo_mini_loss sum 2.0477383136749268
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16377
Number of first layer input nodes during this epoch:  13151
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015430450439453125  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006234645843505859
range selection method range initialization spend 5.173683166503906e-05
time for parepare:  4.38690185546875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  1.6689300537109375e-05
----------------------check_connections_block total spend ----------------------------- 0.0026459693908691406
generate_one_block  0.001051187515258789
generate_one_block  0.00099945068359375
generate_one_block  0.0009942054748535156
generate_one_block  0.0010178089141845703
generate_one_block  0.0009849071502685547
generate_one_block  0.0011980533599853516
generate_one_block  0.0010020732879638672
generate_one_block  0.0009913444519042969
generate_one_block  0.0009949207305908203
generate_one_block  0.0009822845458984375
generate_one_block  0.0009565353393554688
generate_one_block  0.0009450912475585938
generate_one_block  0.0009479522705078125
generate_one_block  0.0009398460388183594
generate_one_block  0.0009458065032958984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005967617034912109
gen group dst list time:  7.724761962890625e-05
time for parepare:  0.00024437904357910156
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.343292236328125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00018644332885742188
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00021791458129882812
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.654594421386719e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  9.72747802734375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  9.417533874511719e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  9.465217590332031e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  9.107589721679688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001494884490966797
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  5.0067901611328125e-05
----------------------check_connections_block total spend ----------------------------- 0.0045166015625
generate_one_block  0.0010271072387695312
generate_one_block  0.0010933876037597656
generate_one_block  0.0013093948364257812
generate_one_block  0.0012619495391845703
generate_one_block  0.0010402202606201172
generate_one_block  0.001093149185180664
generate_one_block  0.0010955333709716797
generate_one_block  0.0010683536529541016
generate_one_block  0.0010869503021240234
generate_one_block  0.0010230541229248047
generate_one_block  0.001058816909790039
generate_one_block  0.0011110305786132812
generate_one_block  0.0011353492736816406
generate_one_block  0.0010120868682861328
generate_one_block  0.0009984970092773438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011336803436279297
gen group dst list time:  0.00012302398681640625
time for parepare:  0.0007543563842773438
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00025916099548339844
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00013637542724609375
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0005269050598144531
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  0.00017333030700683594
r_  generation:  0.0012280941009521484
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  0.00012826919555664062
r_  generation:  0.0011875629425048828
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.00029158592224121094
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0004589557647705078
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0005443096160888672
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0002658367156982422
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0004985332489013672
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00021219253540039062
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0004913806915283203
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.0004839897155761719
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.0010845661163330078
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0003025531768798828
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00020194053649902344
----------------------check_connections_block total spend ----------------------------- 0.01472330093383789
generate_one_block  0.0013430118560791016
generate_one_block  0.001596212387084961
generate_one_block  0.0025429725646972656
generate_one_block  0.0024290084838867188
generate_one_block  0.001310110092163086
generate_one_block  0.0015015602111816406
generate_one_block  0.0016751289367675781
generate_one_block  0.0012278556823730469
generate_one_block  0.001558542251586914
generate_one_block  0.001954793930053711
generate_one_block  0.0015277862548828125
generate_one_block  0.0014922618865966797
generate_one_block  0.002252340316772461
generate_one_block  0.0013213157653808594
generate_one_block  0.0011794567108154297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015430450439453125  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

connection checking time:  0.01923990249633789
block generation total time  0.04132723808288574
average batch blocks generation time:  0.002755149205525716
block dataloader generation time/epoch 0.09555220603942871
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0008044242858886719  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

torch.Size([288, 500])
torch.Size([62, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0008311271667480469  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0022978782653808594  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

torch.Size([1083, 500])
torch.Size([137, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0023546218872070312  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003520965576171875  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

torch.Size([1728, 500])
torch.Size([407, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0036568641662597656  GigaBytes
Max Memory Allocated: 0.0068225860595703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0042324066162109375  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

torch.Size([2112, 500])
torch.Size([512, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0043888092041015625  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012526512145996094  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

torch.Size([526, 500])
torch.Size([96, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00128936767578125  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018506050109863281  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

torch.Size([844, 500])
torch.Size([171, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0019135475158691406  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0026264190673828125  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

torch.Size([1259, 500])
torch.Size([205, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002696514129638672  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011296272277832031  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

torch.Size([460, 500])
torch.Size([115, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011773109436035156  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0022187232971191406  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

torch.Size([1041, 500])
torch.Size([188, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0022878646850585938  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010328292846679688  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

torch.Size([409, 500])
torch.Size([61, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010614395141601562  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.001842498779296875  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

torch.Size([839, 500])
torch.Size([219, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0019135475158691406  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018396377563476562  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

torch.Size([838, 500])
torch.Size([183, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0019021034240722656  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002506732940673828  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

torch.Size([1185, 500])
torch.Size([288, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002613067626953125  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011363029479980469  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

torch.Size([463, 500])
torch.Size([119, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.001178741455078125  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0008931159973144531  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes
Using backend: pytorch

torch.Size([334, 500])
torch.Size([98, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0009298324584960938  GigaBytes
Max Memory Allocated: 0.007417201995849609  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0007331689198811849 |0.0004420757293701172 |0.003474156061808268 |0.00012555122375488282 |0.0030905564626057943 |0.0020051002502441406 |
----------------------------------------------------------pseudo_mini_loss sum 1.7274953126907349
Total (block generation + training)time/epoch 0.2349257469177246
Training time/epoch 0.13909912109375
Training time without block to device /epoch 0.13246798515319824
Training time without total dataloading part /epoch 0.10235905647277832
load block tensor time/epoch 0.010997533798217773
block to device time/epoch 0.006631135940551758
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16627
Number of first layer input nodes during this epoch:  13409
