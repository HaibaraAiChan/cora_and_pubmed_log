main start at this time 1648526953.3809795
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020401477813720703
range selection method range initialization spend 0.00010323524475097656
time for parepare:  4.1484832763671875e-05
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  0.0011754035949707031
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0265579223632812e-05
----------------------check_connections_block total spend ----------------------------- 0.003983736038208008
generate_one_block  0.0013146400451660156
generate_one_block  0.0010654926300048828
generate_one_block  0.0010190010070800781
generate_one_block  0.0010330677032470703
generate_one_block  0.0010781288146972656
generate_one_block  0.0010364055633544922
generate_one_block  0.001024007797241211
generate_one_block  0.0010516643524169922
generate_one_block  0.0011055469512939453
generate_one_block  0.0010440349578857422
generate_one_block  0.001027822494506836
generate_one_block  0.0010766983032226562
generate_one_block  0.00098419189453125
generate_one_block  0.0009601116180419922
generate_one_block  0.0010766983032226562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009465217590332031
gen group dst list time:  8.082389831542969e-05
time for parepare:  0.0002238750457763672
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  9.489059448242188e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.463859558105469e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00017881393432617188
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  9.894371032714844e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.340576171875e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  5.888938903808594e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0001232624053955078
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00021958351135253906
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0001652240753173828
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.891654968261719e-05
----------------------check_connections_block total spend ----------------------------- 0.004701375961303711
generate_one_block  0.0019190311431884766
generate_one_block  0.0011749267578125
generate_one_block  0.0011546611785888672
generate_one_block  0.0013451576232910156
generate_one_block  0.0011658668518066406
generate_one_block  0.0011138916015625
generate_one_block  0.0010845661163330078
generate_one_block  0.0011260509490966797
generate_one_block  0.0009970664978027344
generate_one_block  0.00102996826171875
generate_one_block  0.0011491775512695312
generate_one_block  0.0012373924255371094
generate_one_block  0.0011610984802246094
generate_one_block  0.0011034011840820312
generate_one_block  0.00106048583984375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010581016540527344
gen group dst list time:  0.00012135505676269531
time for parepare:  0.0007154941558837891
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00023698806762695312
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001285076141357422
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0004107952117919922
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.00043964385986328125
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  0.0001163482666015625
r_  generation:  0.001161336898803711
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00031876564025878906
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0005536079406738281
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0002067089080810547
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00020432472229003906
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.00037384033203125
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00018739700317382812
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00031065940856933594
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0006990432739257812
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.00014543533325195312
r_  generation:  0.0014586448669433594
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.0011606216430664062
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.0005056858062744141
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00036907196044921875
----------------------check_connections_block total spend ----------------------------- 0.015006065368652344
generate_one_block  0.0012717247009277344
generate_one_block  0.00164794921875
generate_one_block  0.0015637874603271484
generate_one_block  0.0024566650390625
generate_one_block  0.0016736984252929688
generate_one_block  0.001207113265991211
generate_one_block  0.0013110637664794922
generate_one_block  0.0015118122100830078
generate_one_block  0.0012280941009521484
generate_one_block  0.0013248920440673828
generate_one_block  0.001817941665649414
generate_one_block  0.0027184486389160156
generate_one_block  0.002291440963745117
generate_one_block  0.0015192031860351562
generate_one_block  0.0016388893127441406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

connection checking time:  0.019707441329956055
block generation total time  0.04300546646118164
average batch blocks generation time:  0.0028670310974121095
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.00045680999755859375  GigaBytes
Max Memory Allocated: 0.00045680999755859375  GigaBytes

torch.Size([206, 500])
torch.Size([53, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.00048065185546875  GigaBytes
Max Memory Allocated: 0.0004830360412597656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0014395713806152344  GigaBytes
Max Memory Allocated: 0.0018115043640136719  GigaBytes

torch.Size([694, 500])
torch.Size([202, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0015048980712890625  GigaBytes
Max Memory Allocated: 0.0018115043640136719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0015358924865722656  GigaBytes
Max Memory Allocated: 0.002815723419189453  GigaBytes

torch.Size([745, 500])
torch.Size([189, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0015969276428222656  GigaBytes
Max Memory Allocated: 0.002815723419189453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004246234893798828  GigaBytes
Max Memory Allocated: 0.005600452423095703  GigaBytes

torch.Size([2189, 500])
torch.Size([421, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004383563995361328  GigaBytes
Max Memory Allocated: 0.005600452423095703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0028314590454101562  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

torch.Size([1123, 500])
torch.Size([152, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002895832061767578  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0006909370422363281  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

torch.Size([295, 500])
torch.Size([96, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0007257461547851562  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0008192062377929688  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

torch.Size([364, 500])
torch.Size([107, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0008573532104492188  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0013418197631835938  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

torch.Size([642, 500])
torch.Size([110, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.001384735107421875  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0006990432739257812  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

torch.Size([300, 500])
torch.Size([80, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0007319450378417969  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010514259338378906  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

torch.Size([487, 500])
torch.Size([128, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010957717895507812  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0025343894958496094  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

torch.Size([1277, 500])
torch.Size([261, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00262451171875  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0034942626953125  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

torch.Size([1779, 500])
torch.Size([410, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00363922119140625  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0028705596923828125  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

torch.Size([1451, 500])
torch.Size([335, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002986907958984375  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0019259452819824219  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

torch.Size([954, 500])
torch.Size([163, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0019855499267578125  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0013775825500488281  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

torch.Size([661, 500])
torch.Size([160, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.001434326171875  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003926912943522136 |0.023413578669230144 |0.05511039098103841 |0.0001540978749593099 |0.003007205327351888 |0.0019986629486083984 |
----------------------------------------------------------pseudo_mini_loss sum 2.0604491233825684
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16391
Number of first layer input nodes during this epoch:  13167
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015358924865722656  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00046825408935546875
range selection method range initialization spend 5.1975250244140625e-05
time for parepare:  4.506111145019531e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.6927719116210938e-05
----------------------check_connections_block total spend ----------------------------- 0.0026726722717285156
generate_one_block  0.001087188720703125
generate_one_block  0.0010573863983154297
generate_one_block  0.0010886192321777344
generate_one_block  0.0010695457458496094
generate_one_block  0.0010187625885009766
generate_one_block  0.0011980533599853516
generate_one_block  0.0010328292846679688
generate_one_block  0.0010335445404052734
generate_one_block  0.0010082721710205078
generate_one_block  0.0010051727294921875
generate_one_block  0.0009741783142089844
generate_one_block  0.0009608268737792969
generate_one_block  0.0009572505950927734
generate_one_block  0.0009577274322509766
generate_one_block  0.0009713172912597656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006406307220458984
gen group dst list time:  7.677078247070312e-05
time for parepare:  0.00024366378784179688
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  7.390975952148438e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00018787384033203125
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002186298370361328
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  6.175041198730469e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.821487426757812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  9.5367431640625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  9.226799011230469e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  9.465217590332031e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  9.107589721679688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00015163421630859375
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.173683166503906e-05
----------------------check_connections_block total spend ----------------------------- 0.0045740604400634766
generate_one_block  0.0010666847229003906
generate_one_block  0.0011134147644042969
generate_one_block  0.0013365745544433594
generate_one_block  0.0012774467468261719
generate_one_block  0.001081228256225586
generate_one_block  0.0011324882507324219
generate_one_block  0.0011107921600341797
generate_one_block  0.0011081695556640625
generate_one_block  0.0011315345764160156
generate_one_block  0.0010111331939697266
generate_one_block  0.001081705093383789
generate_one_block  0.0011706352233886719
generate_one_block  0.0011582374572753906
generate_one_block  0.0010271072387695312
generate_one_block  0.0010151863098144531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009937286376953125
gen group dst list time:  0.00012183189392089844
time for parepare:  0.0007894039154052734
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00024890899658203125
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00014829635620117188
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0005497932434082031
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  0.00016808509826660156
r_  generation:  0.0012390613555908203
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  0.0001289844512939453
r_  generation:  0.0012295246124267578
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.00031757354736328125
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0004870891571044922
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0005319118499755859
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0002410411834716797
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0004954338073730469
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00021409988403320312
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0004992485046386719
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.00048351287841796875
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  0.00011205673217773438
r_  generation:  0.0010805130004882812
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0003077983856201172
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.000217437744140625
----------------------check_connections_block total spend ----------------------------- 0.015057802200317383
generate_one_block  0.001354217529296875
generate_one_block  0.001678466796875
generate_one_block  0.0024976730346679688
generate_one_block  0.0024559497833251953
generate_one_block  0.0013167858123779297
generate_one_block  0.0015120506286621094
generate_one_block  0.0016727447509765625
generate_one_block  0.001249074935913086
generate_one_block  0.0015606880187988281
generate_one_block  0.0011942386627197266
generate_one_block  0.0015397071838378906
generate_one_block  0.0015711784362792969
generate_one_block  0.0022764205932617188
generate_one_block  0.0013473033905029297
generate_one_block  0.0012068748474121094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015358924865722656  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

connection checking time:  0.01963186264038086
block generation total time  0.04125571250915527
average batch blocks generation time:  0.0027503808339436847
block dataloader generation time/epoch 0.09360384941101074
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0008244514465332031  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

torch.Size([298, 500])
torch.Size([63, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0008521080017089844  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002262592315673828  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

torch.Size([1064, 500])
torch.Size([137, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0023193359375  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003528594970703125  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

torch.Size([1732, 500])
torch.Size([412, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003665924072265625  GigaBytes
Max Memory Allocated: 0.006893157958984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004221439361572266  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

torch.Size([2106, 500])
torch.Size([511, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0043773651123046875  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012750625610351562  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

torch.Size([538, 500])
torch.Size([96, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0013117790222167969  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018358230590820312  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

torch.Size([836, 500])
torch.Size([171, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018987655639648438  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002513885498046875  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

torch.Size([1199, 500])
torch.Size([206, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002583026885986328  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011296272277832031  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

torch.Size([460, 500])
torch.Size([115, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011773109436035156  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002220630645751953  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

torch.Size([1042, 500])
torch.Size([188, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0022897720336914062  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010199546813964844  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

torch.Size([402, 500])
torch.Size([61, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010485649108886719  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018367767333984375  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

torch.Size([836, 500])
torch.Size([220, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0019078254699707031  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018153190612792969  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

torch.Size([825, 500])
torch.Size([183, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018777847290039062  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002480030059814453  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

torch.Size([1171, 500])
torch.Size([290, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0025873184204101562  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00112152099609375  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

torch.Size([455, 500])
torch.Size([119, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011639595031738281  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0009264945983886719  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes
Using backend: pytorch

torch.Size([352, 500])
torch.Size([97, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0009632110595703125  GigaBytes
Max Memory Allocated: 0.0074138641357421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0005488872528076171 |0.0004031658172607422 |0.0032198429107666016 |0.00011615753173828125 |0.003030856450398763 |0.001607656478881836 |
----------------------------------------------------------pseudo_mini_loss sum 1.7962961196899414
Total (block generation + training)time/epoch 0.2225818634033203
Training time/epoch 0.1287212371826172
Training time without block to device /epoch 0.12267374992370605
Training time without total dataloading part /epoch 0.09711050987243652
load block tensor time/epoch 0.008233308792114258
block to device time/epoch 0.006047487258911133
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16542
Number of first layer input nodes during this epoch:  13316
