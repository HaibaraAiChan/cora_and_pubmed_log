main start at this time 1648526883.2908382
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005984306335449219
range selection method range initialization spend 7.271766662597656e-05
time for parepare:  5.2928924560546875e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  0.0009756088256835938
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.363059997558594e-05
----------------------check_connections_block total spend ----------------------------- 0.001951456069946289
generate_one_block  0.0011687278747558594
generate_one_block  0.0010371208190917969
generate_one_block  0.0010833740234375
generate_one_block  0.001027822494506836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005245208740234375
gen group dst list time:  3.24249267578125e-05
time for parepare:  0.00022172927856445312
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0002803802490234375
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.0002608299255371094
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.0002696514129638672
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0004336833953857422
----------------------check_connections_block total spend ----------------------------- 0.002647876739501953
generate_one_block  0.0013339519500732422
generate_one_block  0.001312255859375
generate_one_block  0.0013346672058105469
generate_one_block  0.0015649795532226562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010008811950683594
gen group dst list time:  6.985664367675781e-05
time for parepare:  0.0007157325744628906
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.00029468536376953125
mini_batch_src_global generation:  0.00012540817260742188
r_  generation:  0.0014591217041015625
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  0.00016546249389648438
r_  generation:  0.00142669677734375
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.00016546249389648438
r_  generation:  0.0015685558319091797
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  0.0002963542938232422
r_  generation:  0.0026688575744628906
----------------------check_connections_block total spend ----------------------------- 0.011737823486328125
generate_one_block  0.003087759017944336
generate_one_block  0.002727985382080078
generate_one_block  0.0028352737426757812
generate_one_block  0.007962703704833984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

connection checking time:  0.014385700225830078
block generation total time  0.022159576416015625
average batch blocks generation time:  0.005539894104003906
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005000591278076172  GigaBytes
Max Memory Allocated: 0.005000591278076172  GigaBytes

torch.Size([2625, 500])
torch.Size([620, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005192756652832031  GigaBytes
Max Memory Allocated: 0.005321502685546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005135059356689453  GigaBytes
Max Memory Allocated: 0.009983062744140625  GigaBytes

torch.Size([2662, 500])
torch.Size([627, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00533294677734375  GigaBytes
Max Memory Allocated: 0.009983062744140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005069732666015625  GigaBytes
Max Memory Allocated: 0.009983062744140625  GigaBytes

torch.Size([2589, 500])
torch.Size([625, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005269527435302734  GigaBytes
Max Memory Allocated: 0.009983062744140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006795406341552734  GigaBytes
Max Memory Allocated: 0.011601448059082031  GigaBytes

torch.Size([3531, 500])
torch.Size([908, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007098674774169922  GigaBytes
Max Memory Allocated: 0.011601448059082031  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005753576755523682 |0.08588099479675293 |0.1931248903274536 |0.0002021193504333496 |0.003727257251739502 |0.002758026123046875 |
----------------------------------------------------------pseudo_mini_loss sum 2.12974214553833
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14543
Number of first layer input nodes during this epoch:  11407
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007114887237548828  GigaBytes
Max Memory Allocated: 0.011601448059082031  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002752065658569336
range selection method range initialization spend 5.269050598144531e-05
time for parepare:  4.696846008300781e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00010824203491210938
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.0279159545898438e-05
----------------------check_connections_block total spend ----------------------------- 0.0010731220245361328
generate_one_block  0.0011715888977050781
generate_one_block  0.0010759830474853516
generate_one_block  0.0011792182922363281
generate_one_block  0.0010733604431152344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0015268325805664062
gen group dst list time:  3.266334533691406e-05
time for parepare:  0.00024247169494628906
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0003516674041748047
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0003256797790527344
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.0002906322479248047
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0003018379211425781
----------------------check_connections_block total spend ----------------------------- 0.0026998519897460938
generate_one_block  0.0015666484832763672
generate_one_block  0.001439809799194336
generate_one_block  0.0013804435729980469
generate_one_block  0.0013942718505859375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009717941284179688
gen group dst list time:  7.557868957519531e-05
time for parepare:  0.0006945133209228516
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.00033211708068847656
mini_batch_src_global generation:  0.0002219676971435547
r_  generation:  0.0023763179779052734
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  0.00026726722717285156
r_  generation:  0.0019092559814453125
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.00015282630920410156
r_  generation:  0.001373291015625
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.0001800060272216797
r_  generation:  0.0018525123596191406
----------------------check_connections_block total spend ----------------------------- 0.012255430221557617
generate_one_block  0.0049402713775634766
generate_one_block  0.003365039825439453
generate_one_block  0.0026116371154785156
generate_one_block  0.0031709671020507812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007114887237548828  GigaBytes
Max Memory Allocated: 0.011601448059082031  GigaBytes

connection checking time:  0.014955282211303711
block generation total time  0.019869089126586914
average batch blocks generation time:  0.0049672722816467285
block dataloader generation time/epoch 0.058542728424072266
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006901741027832031  GigaBytes
Max Memory Allocated: 0.013408660888671875  GigaBytes

torch.Size([3526, 500])
torch.Size([844, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007170200347900391  GigaBytes
Max Memory Allocated: 0.013408660888671875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00652313232421875  GigaBytes
Max Memory Allocated: 0.013408660888671875  GigaBytes

torch.Size([3331, 500])
torch.Size([749, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006760120391845703  GigaBytes
Max Memory Allocated: 0.013408660888671875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004912376403808594  GigaBytes
Max Memory Allocated: 0.013408660888671875  GigaBytes

torch.Size([2475, 500])
torch.Size([570, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005099773406982422  GigaBytes
Max Memory Allocated: 0.013408660888671875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0042285919189453125  GigaBytes
Max Memory Allocated: 0.013408660888671875  GigaBytes

torch.Size([2098, 500])
torch.Size([617, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004433631896972656  GigaBytes
Max Memory Allocated: 0.013408660888671875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0017911791801452637 |0.00042062997817993164 |0.0033214688301086426 |0.00012040138244628906 |0.003054022789001465 |0.0015172958374023438 |
----------------------------------------------------------pseudo_mini_loss sum 1.3540652990341187
Total (block generation + training)time/epoch 0.09978175163269043
Training time/epoch 0.04096794128417969
Training time without block to device /epoch 0.03928542137145996
Training time without total dataloading part /epoch 0.02750086784362793
load block tensor time/epoch 0.007164716720581055
block to device time/epoch 0.0016825199127197266
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14566
Number of first layer input nodes during this epoch:  11430
