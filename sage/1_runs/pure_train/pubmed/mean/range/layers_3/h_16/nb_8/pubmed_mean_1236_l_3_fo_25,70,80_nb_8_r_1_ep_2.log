main start at this time 1648526983.3466525
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002068042755126953
range selection method range initialization spend 0.00011086463928222656
time for parepare:  4.482269287109375e-05
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0013556480407714844
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.364418029785156e-05
----------------------check_connections_block total spend ----------------------------- 0.0024306774139404297
generate_one_block  0.0013060569763183594
generate_one_block  0.001100778579711914
generate_one_block  0.0011391639709472656
generate_one_block  0.0011067390441894531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010366439819335938
gen group dst list time:  3.409385681152344e-05
time for parepare:  0.00026535987854003906
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0002949237823486328
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0003306865692138672
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0002906322479248047
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004858970642089844
----------------------check_connections_block total spend ----------------------------- 0.0029497146606445312
generate_one_block  0.0014646053314208984
generate_one_block  0.0014750957489013672
generate_one_block  0.0014312267303466797
generate_one_block  0.0017206668853759766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009992122650146484
gen group dst list time:  7.748603820800781e-05
time for parepare:  0.0007662773132324219
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.00030732154846191406
mini_batch_src_global generation:  0.0001537799835205078
r_  generation:  0.0017752647399902344
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  0.00022149085998535156
r_  generation:  0.001760721206665039
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.00017023086547851562
r_  generation:  0.0016505718231201172
local_output_nid generation:  7.534027099609375e-05
local_in_edges_tensor generation:  0.00024962425231933594
mini_batch_src_global generation:  0.000301361083984375
r_  generation:  0.0029745101928710938
----------------------check_connections_block total spend ----------------------------- 0.013240814208984375
generate_one_block  0.00433659553527832
generate_one_block  0.003060579299926758
generate_one_block  0.002851247787475586
generate_one_block  0.00452876091003418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

connection checking time:  0.016190528869628906
block generation total time  0.020868778228759766
average batch blocks generation time:  0.005217194557189941
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005713462829589844  GigaBytes
Max Memory Allocated: 0.005713462829589844  GigaBytes

torch.Size([3004, 500])
torch.Size([686, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005925655364990234  GigaBytes
Max Memory Allocated: 0.006079673767089844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005578517913818359  GigaBytes
Max Memory Allocated: 0.011126995086669922  GigaBytes

torch.Size([2897, 500])
torch.Size([712, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005798816680908203  GigaBytes
Max Memory Allocated: 0.011126995086669922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005775928497314453  GigaBytes
Max Memory Allocated: 0.011126995086669922  GigaBytes

torch.Size([2621, 500])
torch.Size([632, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0059757232666015625  GigaBytes
Max Memory Allocated: 0.011126995086669922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006939888000488281  GigaBytes
Max Memory Allocated: 0.012447357177734375  GigaBytes

torch.Size([3606, 500])
torch.Size([968, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007258892059326172  GigaBytes
Max Memory Allocated: 0.012447357177734375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005122780799865723 |0.08739620447158813 |0.19464731216430664 |0.00020712614059448242 |0.0032451748847961426 |0.0026445388793945312 |
----------------------------------------------------------pseudo_mini_loss sum 2.0750510692596436
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15482
Number of first layer input nodes during this epoch:  12128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007269382476806641  GigaBytes
Max Memory Allocated: 0.012447357177734375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004787445068359375
range selection method range initialization spend 5.316734313964844e-05
time for parepare:  4.6253204345703125e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00011134147644042969
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.266334533691406e-05
----------------------check_connections_block total spend ----------------------------- 0.0011005401611328125
generate_one_block  0.0011794567108154297
generate_one_block  0.0011205673217773438
generate_one_block  0.0012047290802001953
generate_one_block  0.0010302066802978516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005345344543457031
gen group dst list time:  3.1948089599609375e-05
time for parepare:  0.00025391578674316406
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0003864765167236328
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0003604888916015625
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0002727508544921875
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00031876564025878906
----------------------check_connections_block total spend ----------------------------- 0.0028200149536132812
generate_one_block  0.0015411376953125
generate_one_block  0.001461029052734375
generate_one_block  0.0013432502746582031
generate_one_block  0.0014238357543945312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00099945068359375
gen group dst list time:  8.0108642578125e-05
time for parepare:  0.0007493495941162109
local_output_nid generation:  6.866455078125e-05
local_in_edges_tensor generation:  0.0003476142883300781
mini_batch_src_global generation:  0.00030922889709472656
r_  generation:  0.0025429725646972656
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  0.0002961158752441406
r_  generation:  0.0021669864654541016
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.00015878677368164062
r_  generation:  0.0013933181762695312
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.00018286705017089844
r_  generation:  0.0019245147705078125
----------------------check_connections_block total spend ----------------------------- 0.013150215148925781
generate_one_block  0.004597663879394531
generate_one_block  0.0038139820098876953
generate_one_block  0.0029392242431640625
generate_one_block  0.003331422805786133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007269382476806641  GigaBytes
Max Memory Allocated: 0.012447357177734375  GigaBytes

connection checking time:  0.015970230102539062
block generation total time  0.02045154571533203
average batch blocks generation time:  0.005112886428833008
block dataloader generation time/epoch 0.05275917053222656
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007557392120361328  GigaBytes
Max Memory Allocated: 0.014199256896972656  GigaBytes

torch.Size([3674, 500])
torch.Size([923, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007846832275390625  GigaBytes
Max Memory Allocated: 0.014199256896972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007328033447265625  GigaBytes
Max Memory Allocated: 0.014485359191894531  GigaBytes

torch.Size([3759, 500])
torch.Size([837, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007590770721435547  GigaBytes
Max Memory Allocated: 0.014485359191894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004893779754638672  GigaBytes
Max Memory Allocated: 0.014485359191894531  GigaBytes

torch.Size([2465, 500])
torch.Size([572, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0050811767578125  GigaBytes
Max Memory Allocated: 0.014485359191894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004333019256591797  GigaBytes
Max Memory Allocated: 0.014485359191894531  GigaBytes

torch.Size([2153, 500])
torch.Size([658, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004548549652099609  GigaBytes
Max Memory Allocated: 0.014485359191894531  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0018808245658874512 |0.00041550397872924805 |0.0032824277877807617 |0.00012063980102539062 |0.002478361129760742 |0.0015101432800292969 |
----------------------------------------------------------pseudo_mini_loss sum 1.398974895477295
Total (block generation + training)time/epoch 0.0917813777923584
Training time/epoch 0.038802146911621094
Training time without block to device /epoch 0.0371401309967041
Training time without total dataloading part /epoch 0.025035858154296875
load block tensor time/epoch 0.007523298263549805
block to device time/epoch 0.0016620159149169922
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15397
Number of first layer input nodes during this epoch:  12051
