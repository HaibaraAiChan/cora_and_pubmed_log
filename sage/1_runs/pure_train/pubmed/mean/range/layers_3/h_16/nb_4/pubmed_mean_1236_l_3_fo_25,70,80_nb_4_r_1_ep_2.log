main start at this time 1648526973.4432356
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.003597736358642578
range selection method range initialization spend 9.012222290039062e-05
time for parepare:  3.981590270996094e-05
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0014166831970214844
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  6.318092346191406e-05
----------------------check_connections_block total spend ----------------------------- 0.0020554065704345703
generate_one_block  0.0012679100036621094
generate_one_block  0.0011425018310546875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016510486602783203
gen group dst list time:  2.3603439331054688e-05
time for parepare:  0.00022149085998535156
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0005035400390625
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  0.00010752677917480469
r_  generation:  0.0006945133209228516
----------------------check_connections_block total spend ----------------------------- 0.0022864341735839844
generate_one_block  0.0017824172973632812
generate_one_block  0.0019567012786865234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009448528289794922
gen group dst list time:  6.0558319091796875e-05
time for parepare:  0.0006647109985351562
local_output_nid generation:  8.559226989746094e-05
local_in_edges_tensor generation:  0.0003590583801269531
mini_batch_src_global generation:  0.00022983551025390625
r_  generation:  0.0029230117797851562
local_output_nid generation:  0.00010561943054199219
local_in_edges_tensor generation:  0.0002944469451904297
mini_batch_src_global generation:  0.0005283355712890625
r_  generation:  0.003924846649169922
----------------------check_connections_block total spend ----------------------------- 0.01115274429321289
generate_one_block  0.005898714065551758
generate_one_block  0.006121397018432617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

connection checking time:  0.013439178466796875
block generation total time  0.01575922966003418
average batch blocks generation time:  0.00787961483001709
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009519577026367188  GigaBytes
Max Memory Allocated: 0.009519577026367188  GigaBytes

torch.Size([5025, 500])
torch.Size([1357, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009931564331054688  GigaBytes
Max Memory Allocated: 0.010170936584472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.010432720184326172  GigaBytes
Max Memory Allocated: 0.019666194915771484  GigaBytes

torch.Size([5244, 500])
torch.Size([1554, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.010930538177490234  GigaBytes
Max Memory Allocated: 0.019666194915771484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0035027265548706055 |0.17161178588867188 |0.387057900428772 |0.00023186206817626953 |0.004755854606628418 |0.00312042236328125 |
----------------------------------------------------------pseudo_mini_loss sum 2.120621919631958
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13536
Number of first layer input nodes during this epoch:  10269
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010849952697753906  GigaBytes
Max Memory Allocated: 0.019666194915771484  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005834102630615234
range selection method range initialization spend 7.557868957519531e-05
time for parepare:  5.841255187988281e-05
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  8.249282836914062e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.604194641113281e-05
----------------------check_connections_block total spend ----------------------------- 0.0007810592651367188
generate_one_block  0.0013976097106933594
generate_one_block  0.0013320446014404297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006358623504638672
gen group dst list time:  3.266334533691406e-05
time for parepare:  0.0003707408905029297
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00022363662719726562
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0008635520935058594
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  0.00011539459228515625
r_  generation:  0.0007007122039794922
----------------------check_connections_block total spend ----------------------------- 0.003035306930541992
generate_one_block  0.0024118423461914062
generate_one_block  0.002131223678588867
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011684894561767578
gen group dst list time:  9.489059448242188e-05
time for parepare:  0.0009458065032958984
local_output_nid generation:  0.00017070770263671875
local_in_edges_tensor generation:  0.0004885196685791016
mini_batch_src_global generation:  0.0006213188171386719
r_  generation:  0.005640745162963867
local_output_nid generation:  0.00013971328735351562
local_in_edges_tensor generation:  0.00033855438232421875
mini_batch_src_global generation:  0.0005536079406738281
r_  generation:  0.0039768218994140625
----------------------check_connections_block total spend ----------------------------- 0.015624284744262695
generate_one_block  0.006908416748046875
generate_one_block  0.005079746246337891
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010849952697753906  GigaBytes
Max Memory Allocated: 0.019666194915771484  GigaBytes

connection checking time:  0.018659591674804688
block generation total time  0.01653122901916504
average batch blocks generation time:  0.00826561450958252
block dataloader generation time/epoch 0.051358938217163086
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01222372055053711  GigaBytes
Max Memory Allocated: 0.022263050079345703  GigaBytes
Using backend: pytorch

torch.Size([6350, 500])
torch.Size([1729, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.012758255004882812  GigaBytes
Max Memory Allocated: 0.022263050079345703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.008240699768066406  GigaBytes
Max Memory Allocated: 0.022263050079345703  GigaBytes

torch.Size([4231, 500])
torch.Size([1222, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.008633136749267578  GigaBytes
Max Memory Allocated: 0.022263050079345703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0039185285568237305 |0.0008158683776855469 |0.005033016204833984 |0.0001913309097290039 |0.0028427839279174805 |0.0017006397247314453 |
----------------------------------------------------------pseudo_mini_loss sum 1.605985403060913
Total (block generation + training)time/epoch 0.08324289321899414
Training time/epoch 0.03143811225891113
Training time without block to device /epoch 0.02980637550354004
Training time without total dataloading part /epoch 0.017834901809692383
load block tensor time/epoch 0.007837057113647461
block to device time/epoch 0.0016317367553710938
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13888
Number of first layer input nodes during this epoch:  10581
