main start at this time 1648533416.1967933
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0016295909881591797
range selection method range initialization spend 9.107589721679688e-05
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0010600090026855469
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.7404556274414062e-05
----------------------check_connections_block total spend ----------------------------- 0.0027899742126464844
generate_one_block  0.00128936767578125
generate_one_block  0.0010952949523925781
generate_one_block  0.0010912418365478516
generate_one_block  0.001077413558959961
generate_one_block  0.001077890396118164
generate_one_block  0.001119852066040039
generate_one_block  0.0010793209075927734
generate_one_block  0.001066446304321289
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009722709655761719
gen group dst list time:  5.221366882324219e-05
time for parepare:  0.0002510547637939453
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00010752677917480469
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00020003318786621094
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00031566619873046875
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00010514259338378906
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0002219676971435547
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0001900196075439453
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0002048015594482422
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  9.465217590332031e-05
----------------------check_connections_block total spend ----------------------------- 0.003533601760864258
generate_one_block  0.0012030601501464844
generate_one_block  0.0013191699981689453
generate_one_block  0.001489877700805664
generate_one_block  0.0012137889862060547
generate_one_block  0.0013647079467773438
generate_one_block  0.001294851303100586
generate_one_block  0.0013463497161865234
generate_one_block  0.0011801719665527344
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011453628540039062
gen group dst list time:  9.751319885253906e-05
time for parepare:  0.00078582763671875
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00024199485778808594
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00044155120849609375
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0013065338134765625
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  0.0002529621124267578
r_  generation:  0.002632617950439453
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  0.00011205673217773438
r_  generation:  0.0004470348358154297
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.00015997886657714844
r_  generation:  0.0017681121826171875
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  0.00011873245239257812
r_  generation:  0.0008547306060791016
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0013041496276855469
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  7.796287536621094e-05
r_  generation:  0.0004239082336425781
----------------------check_connections_block total spend ----------------------------- 0.015253543853759766
generate_one_block  0.0016505718231201172
generate_one_block  0.0025398731231689453
generate_one_block  0.004335641860961914
generate_one_block  0.0013949871063232422
generate_one_block  0.002979278564453125
generate_one_block  0.0019369125366210938
generate_one_block  0.002576589584350586
generate_one_block  0.0013680458068847656
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019049644470214844
gen group dst list time:  0.0002720355987548828
time for parepare:  0.0015377998352050781
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.0004892349243164062
mini_batch_src_global generation:  0.00032210350036621094
r_  generation:  0.0026082992553710938
local_output_nid generation:  0.00018835067749023438
local_in_edges_tensor generation:  0.0004639625549316406
mini_batch_src_global generation:  0.0009388923645019531
r_  generation:  0.00751948356628418
local_output_nid generation:  0.00029277801513671875
local_in_edges_tensor generation:  0.0006377696990966797
mini_batch_src_global generation:  0.0011165142059326172
r_  generation:  0.01084446907043457
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.00022530555725097656
mini_batch_src_global generation:  0.0004119873046875
r_  generation:  0.002330303192138672
local_output_nid generation:  0.0001628398895263672
local_in_edges_tensor generation:  0.0004107952117919922
mini_batch_src_global generation:  0.0005524158477783203
r_  generation:  0.005980968475341797
local_output_nid generation:  0.00011610984802246094
local_in_edges_tensor generation:  0.00031757354736328125
mini_batch_src_global generation:  0.0004508495330810547
r_  generation:  0.0036618709564208984
local_output_nid generation:  0.00019598007202148438
local_in_edges_tensor generation:  0.0004112720489501953
mini_batch_src_global generation:  0.0005660057067871094
r_  generation:  0.0065898895263671875
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  0.0003190040588378906
r_  generation:  0.0020258426666259766
----------------------check_connections_block total spend ----------------------------- 0.06259799003601074
generate_one_block  0.005470752716064453
generate_one_block  0.010598421096801758
generate_one_block  0.014238119125366211
generate_one_block  0.004069089889526367
generate_one_block  0.009720087051391602
generate_one_block  0.006223917007446289
generate_one_block  0.010701656341552734
generate_one_block  0.0034639835357666016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022132396697998047
gen group dst list time:  0.0012145042419433594
time for parepare:  0.0018875598907470703
local_output_nid generation:  0.0004477500915527344
local_in_edges_tensor generation:  0.0012149810791015625
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.011216163635253906
local_output_nid generation:  0.0007586479187011719
local_in_edges_tensor generation:  0.0017850399017333984
mini_batch_src_global generation:  0.0021545886993408203
r_  generation:  0.018817424774169922
local_output_nid generation:  0.0009660720825195312
local_in_edges_tensor generation:  0.0014920234680175781
mini_batch_src_global generation:  0.0020215511322021484
r_  generation:  0.02055811882019043
local_output_nid generation:  0.000431060791015625
local_in_edges_tensor generation:  0.0006353855133056641
mini_batch_src_global generation:  0.0008695125579833984
r_  generation:  0.007668495178222656
local_output_nid generation:  0.0005929470062255859
local_in_edges_tensor generation:  0.0008883476257324219
mini_batch_src_global generation:  0.0011374950408935547
r_  generation:  0.014235734939575195
local_output_nid generation:  0.0006520748138427734
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.00095367431640625
r_  generation:  0.012845277786254883
local_output_nid generation:  0.0009207725524902344
local_in_edges_tensor generation:  0.0015976428985595703
mini_batch_src_global generation:  0.001631021499633789
r_  generation:  0.019184112548828125
local_output_nid generation:  0.0003631114959716797
local_in_edges_tensor generation:  0.0005695819854736328
mini_batch_src_global generation:  0.000926971435546875
r_  generation:  0.0073089599609375
----------------------check_connections_block total spend ----------------------------- 0.1651134490966797
generate_one_block  0.015468835830688477
generate_one_block  0.026534557342529297
generate_one_block  0.026533842086791992
generate_one_block  0.011564493179321289
generate_one_block  0.01717662811279297
generate_one_block  0.01679849624633789
generate_one_block  0.025228500366210938
generate_one_block  0.011137723922729492
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017981529235839844
gen group dst list time:  0.002578258514404297
time for parepare:  0.0017092227935791016
local_output_nid generation:  0.0011243820190429688
local_in_edges_tensor generation:  0.002037525177001953
mini_batch_src_global generation:  0.0019016265869140625
r_  generation:  0.021126508712768555
local_output_nid generation:  0.001439809799194336
local_in_edges_tensor generation:  0.002641439437866211
mini_batch_src_global generation:  0.0026874542236328125
r_  generation:  0.025331974029541016
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.002756834030151367
mini_batch_src_global generation:  0.0023355484008789062
r_  generation:  0.025592565536499023
local_output_nid generation:  0.0010328292846679688
local_in_edges_tensor generation:  0.003590106964111328
mini_batch_src_global generation:  0.0017066001892089844
r_  generation:  0.019138336181640625
local_output_nid generation:  0.0012581348419189453
local_in_edges_tensor generation:  0.0015325546264648438
mini_batch_src_global generation:  0.0016131401062011719
r_  generation:  0.02111983299255371
local_output_nid generation:  0.00135040283203125
local_in_edges_tensor generation:  0.0019540786743164062
mini_batch_src_global generation:  0.0017158985137939453
r_  generation:  0.02241969108581543
local_output_nid generation:  0.0014996528625488281
local_in_edges_tensor generation:  0.002593517303466797
mini_batch_src_global generation:  0.0019257068634033203
r_  generation:  0.02522110939025879
local_output_nid generation:  0.0009911060333251953
local_in_edges_tensor generation:  0.0012557506561279297
mini_batch_src_global generation:  0.0015175342559814453
r_  generation:  0.01777029037475586
----------------------check_connections_block total spend ----------------------------- 0.26097726821899414
generate_one_block  0.026871919631958008
generate_one_block  0.03212094306945801
generate_one_block  0.03166937828063965
generate_one_block  0.02425980567932129
generate_one_block  0.026606082916259766
generate_one_block  0.028426408767700195
generate_one_block  0.031061649322509766
generate_one_block  0.022871017456054688
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

connection checking time:  0.5074758529663086
block generation total time  0.46801018714904785
average batch blocks generation time:  0.05850127339363098
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03413963317871094  GigaBytes
Max Memory Allocated: 0.03413963317871094  GigaBytes

torch.Size([17490, 500])
torch.Size([11525, 16])
torch.Size([4514, 16])
torch.Size([769, 16])
torch.Size([184, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.03876543045043945  GigaBytes
Max Memory Allocated: 0.03876638412475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.036570072174072266  GigaBytes
Max Memory Allocated: 0.06851577758789062  GigaBytes

torch.Size([18751, 500])
torch.Size([15748, 16])
torch.Size([8934, 16])
torch.Size([2484, 16])
torch.Size([404, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.04410696029663086  GigaBytes
Max Memory Allocated: 0.06851577758789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03673696517944336  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([18712, 500])
torch.Size([16255, 16])
torch.Size([10404, 16])
torch.Size([3729, 16])
torch.Size([685, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.04532575607299805  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.03198957443237305  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([16711, 500])
torch.Size([9187, 16])
torch.Size([3881, 16])
torch.Size([654, 16])
torch.Size([202, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.03580284118652344  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.0326690673828125  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([16889, 500])
torch.Size([11122, 16])
torch.Size([6281, 16])
torch.Size([1803, 16])
torch.Size([424, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.038207054138183594  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.0349879264831543  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([18200, 500])
torch.Size([12423, 16])
torch.Size([6180, 16])
torch.Size([1274, 16])
torch.Size([368, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.040485382080078125  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.036649227142333984  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([18925, 500])
torch.Size([15775, 16])
torch.Size([9999, 16])
torch.Size([2324, 16])
torch.Size([478, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.04443168640136719  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.030787944793701172  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([16091, 500])
torch.Size([8889, 16])
torch.Size([3565, 16])
torch.Size([615, 16])
torch.Size([184, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.03439188003540039  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017192363739013672 |0.04429522156715393 |0.10229897499084473 |0.00015178322792053223 |0.005452275276184082 |0.0036253929138183594 |
----------------------------------------------------------pseudo_mini_loss sum 3.2245969772338867
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  313389
Number of first layer input nodes during this epoch:  141769
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.03241586685180664  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0004839897155761719
range selection method range initialization spend 5.2928924560546875e-05
time for parepare:  4.9591064453125e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.239776611328125e-05
----------------------check_connections_block total spend ----------------------------- 0.0015811920166015625
generate_one_block  0.0011186599731445312
generate_one_block  0.0010523796081542969
generate_one_block  0.001024484634399414
generate_one_block  0.0010144710540771484
generate_one_block  0.0010156631469726562
generate_one_block  0.0011932849884033203
generate_one_block  0.0010535717010498047
generate_one_block  0.0009951591491699219
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005209445953369141
gen group dst list time:  5.2928924560546875e-05
time for parepare:  0.00027251243591308594
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  9.560585021972656e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0001494884490966797
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00027632713317871094
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.000110626220703125
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.0001583099365234375
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00021386146545410156
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00037860870361328125
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  6.079673767089844e-05
----------------------check_connections_block total spend ----------------------------- 0.0035986900329589844
generate_one_block  0.0011301040649414062
generate_one_block  0.0011641979217529297
generate_one_block  0.001355886459350586
generate_one_block  0.0011217594146728516
generate_one_block  0.0011696815490722656
generate_one_block  0.0012934207916259766
generate_one_block  0.0014872550964355469
generate_one_block  0.0010573863983154297
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011279582977294922
gen group dst list time:  0.00010633468627929688
time for parepare:  0.0007646083831787109
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0005583763122558594
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0006301403045654297
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.0022122859954833984
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0006554126739501953
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0009353160858154297
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  0.0001227855682373047
r_  generation:  0.0012047290802001953
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00022363662719726562
mini_batch_src_global generation:  0.0002410411834716797
r_  generation:  0.0025603771209716797
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.00040721893310546875
----------------------check_connections_block total spend ----------------------------- 0.015285730361938477
generate_one_block  0.0019736289978027344
generate_one_block  0.001734018325805664
generate_one_block  0.003546476364135742
generate_one_block  0.0017178058624267578
generate_one_block  0.002074003219604492
generate_one_block  0.0024673938751220703
generate_one_block  0.0039250850677490234
generate_one_block  0.0014083385467529297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018286705017089844
gen group dst list time:  0.0002994537353515625
time for parepare:  0.0013926029205322266
local_output_nid generation:  8.416175842285156e-05
local_in_edges_tensor generation:  0.0005362033843994141
mini_batch_src_global generation:  0.0003783702850341797
r_  generation:  0.0038063526153564453
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.000263214111328125
mini_batch_src_global generation:  0.0003364086151123047
r_  generation:  0.0028045177459716797
local_output_nid generation:  0.0002512931823730469
local_in_edges_tensor generation:  0.0005660057067871094
mini_batch_src_global generation:  0.0008602142333984375
r_  generation:  0.010571956634521484
local_output_nid generation:  0.00011444091796875
local_in_edges_tensor generation:  0.0002779960632324219
mini_batch_src_global generation:  0.000537872314453125
r_  generation:  0.0037469863891601562
local_output_nid generation:  0.00017380714416503906
local_in_edges_tensor generation:  0.00038170814514160156
mini_batch_src_global generation:  0.0005326271057128906
r_  generation:  0.005802154541015625
local_output_nid generation:  0.00019359588623046875
local_in_edges_tensor generation:  0.0003902912139892578
mini_batch_src_global generation:  0.0005629062652587891
r_  generation:  0.005606651306152344
local_output_nid generation:  0.000270843505859375
local_in_edges_tensor generation:  0.0005385875701904297
mini_batch_src_global generation:  0.0009603500366210938
r_  generation:  0.010013818740844727
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.00024080276489257812
mini_batch_src_global generation:  0.0005156993865966797
r_  generation:  0.003216981887817383
----------------------check_connections_block total spend ----------------------------- 0.06676888465881348
generate_one_block  0.006829977035522461
generate_one_block  0.004382133483886719
generate_one_block  0.01397705078125
generate_one_block  0.005996227264404297
generate_one_block  0.009419441223144531
generate_one_block  0.008693218231201172
generate_one_block  0.01362466812133789
generate_one_block  0.005178689956665039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019872188568115234
gen group dst list time:  0.0011970996856689453
time for parepare:  0.0017426013946533203
local_output_nid generation:  0.0004596710205078125
local_in_edges_tensor generation:  0.0011396408081054688
mini_batch_src_global generation:  0.0008797645568847656
r_  generation:  0.0110626220703125
local_output_nid generation:  0.00039005279541015625
local_in_edges_tensor generation:  0.0007047653198242188
mini_batch_src_global generation:  0.0010974407196044922
r_  generation:  0.008399009704589844
local_output_nid generation:  0.0009191036224365234
local_in_edges_tensor generation:  0.0014765262603759766
mini_batch_src_global generation:  0.0018873214721679688
r_  generation:  0.020831823348999023
local_output_nid generation:  0.0005066394805908203
local_in_edges_tensor generation:  0.0007991790771484375
mini_batch_src_global generation:  0.0011906623840332031
r_  generation:  0.012367486953735352
local_output_nid generation:  0.0008330345153808594
local_in_edges_tensor generation:  0.0012469291687011719
mini_batch_src_global generation:  0.0015397071838378906
r_  generation:  0.017017364501953125
local_output_nid generation:  0.0008199214935302734
local_in_edges_tensor generation:  0.0011887550354003906
mini_batch_src_global generation:  0.0014643669128417969
r_  generation:  0.016572237014770508
local_output_nid generation:  0.001129150390625
local_in_edges_tensor generation:  0.0014803409576416016
mini_batch_src_global generation:  0.0016181468963623047
r_  generation:  0.020926952362060547
local_output_nid generation:  0.0005328655242919922
local_in_edges_tensor generation:  0.0007696151733398438
mini_batch_src_global generation:  0.0011990070343017578
r_  generation:  0.011666059494018555
----------------------check_connections_block total spend ----------------------------- 0.1733553409576416
generate_one_block  0.01490330696105957
generate_one_block  0.01317739486694336
generate_one_block  0.025951862335205078
generate_one_block  0.017474889755249023
generate_one_block  0.02207207679748535
generate_one_block  0.02213740348815918
generate_one_block  0.026647090911865234
generate_one_block  0.015847444534301758
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0016808509826660156
gen group dst list time:  0.00272369384765625
time for parepare:  0.0019636154174804688
local_output_nid generation:  0.0009582042694091797
local_in_edges_tensor generation:  0.001744985580444336
mini_batch_src_global generation:  0.0016639232635498047
r_  generation:  0.018726587295532227
local_output_nid generation:  0.0011208057403564453
local_in_edges_tensor generation:  0.0018458366394042969
mini_batch_src_global generation:  0.0021715164184570312
r_  generation:  0.01994609832763672
local_output_nid generation:  0.0014967918395996094
local_in_edges_tensor generation:  0.0023729801177978516
mini_batch_src_global generation:  0.002074718475341797
r_  generation:  0.02538585662841797
local_output_nid generation:  0.0013802051544189453
local_in_edges_tensor generation:  0.0018062591552734375
mini_batch_src_global generation:  0.001641988754272461
r_  generation:  0.020715951919555664
local_output_nid generation:  0.0016493797302246094
local_in_edges_tensor generation:  0.0022122859954833984
mini_batch_src_global generation:  0.001956939697265625
r_  generation:  0.023838281631469727
local_output_nid generation:  0.0017271041870117188
local_in_edges_tensor generation:  0.0027425289154052734
mini_batch_src_global generation:  0.001972675323486328
r_  generation:  0.02488398551940918
local_output_nid generation:  0.0017147064208984375
local_in_edges_tensor generation:  0.002130270004272461
mini_batch_src_global generation: Using backend: pytorch
 0.0020999908447265625
r_  generation:  0.02581954002380371
local_output_nid generation:  0.0011620521545410156
local_in_edges_tensor generation:  0.0015010833740234375
mini_batch_src_global generation:  0.001813650131225586
r_  generation:  0.02030014991760254
----------------------check_connections_block total spend ----------------------------- 0.26309776306152344
generate_one_block  0.023233413696289062
generate_one_block  0.02623915672302246
generate_one_block  0.034491539001464844
generate_one_block  0.025879621505737305
generate_one_block  0.029396772384643555
generate_one_block  0.03003239631652832
generate_one_block  0.031187057495117188
generate_one_block  0.02546381950378418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.03241586685180664  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

connection checking time:  0.522106409072876
block generation total time  0.480863094329834
average batch blocks generation time:  0.06010788679122925
block dataloader generation time/epoch 1.061859130859375
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.03012561798095703  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([15565, 500])
torch.Size([9501, 16])
torch.Size([4625, 16])
torch.Size([956, 16])
torch.Size([184, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.03439140319824219  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.03305816650390625  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([17171, 500])
torch.Size([10784, 16])
torch.Size([4104, 16])
torch.Size([1035, 16])
torch.Size([259, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.037435054779052734  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.03699636459350586  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([18947, 500])
torch.Size([16001, 16])
torch.Size([11324, 16])
torch.Size([3076, 16])
torch.Size([620, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.045565128326416016  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.031115055084228516  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([16065, 500])
torch.Size([11051, 16])
torch.Size([4958, 16])
torch.Size([1049, 16])
torch.Size([228, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.03587484359741211  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.035103797912597656  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([18065, 500])
torch.Size([14318, 16])
torch.Size([7769, 16])
torch.Size([1948, 16])
torch.Size([299, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.04177427291870117  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.0365910530090332  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([18628, 500])
torch.Size([15072, 16])
torch.Size([7917, 16])
torch.Size([2252, 16])
torch.Size([439, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.043550968170166016  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.036847591400146484  GigaBytes
Max Memory Allocated: 0.07061576843261719  GigaBytes

torch.Size([18840, 500])
torch.Size([15834, 16])
torch.Size([10702, 16])
torch.Size([3153, 16])
torch.Size([779, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.0452723503112793  GigaBytes
Max Memory Allocated: 0.07061576843261719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.03205060958862305  GigaBytes
Max Memory Allocated: 0.07061576843261719  GigaBytes

torch.Size([16585, 500])
torch.Size([10640, 16])
torch.Size([4512, 16])
torch.Size([736, 16])
torch.Size([112, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.03645610809326172  GigaBytes
Max Memory Allocated: 0.07061576843261719  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011754870414733887 |0.0016367733478546143 |0.0067588090896606445 |0.00013965368270874023 |0.005323559045791626 |0.002877950668334961 |
----------------------------------------------------------pseudo_mini_loss sum 2.075160503387451
Total (block generation + training)time/epoch 1.2828638553619385
Training time/epoch 0.22047901153564453
Training time without block to device /epoch 0.20738482475280762
Training time without total dataloading part /epoch 0.10065412521362305
load block tensor time/epoch 0.0940389633178711
block to device time/epoch 0.013094186782836914
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  316460
Number of first layer input nodes during this epoch:  139866
