main start at this time 1648533428.633228
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0016560554504394531
range selection method range initialization spend 0.00010752677917480469
time for parepare:  5.316734313964844e-05
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.002435445785522461
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.811981201171875e-05
----------------------check_connections_block total spend ----------------------------- 0.005773067474365234
generate_one_block  0.001865386962890625
generate_one_block  0.0012574195861816406
generate_one_block  0.001264810562133789
generate_one_block  0.0012784004211425781
generate_one_block  0.001241922378540039
generate_one_block  0.0012030601501464844
generate_one_block  0.0010571479797363281
generate_one_block  0.0009610652923583984
generate_one_block  0.0009531974792480469
generate_one_block  0.0009646415710449219
generate_one_block  0.001028299331665039
generate_one_block  0.0009942054748535156
generate_one_block  0.0009613037109375
generate_one_block  0.0009722709655761719
generate_one_block  0.0009639263153076172
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0010876655578613281
gen group dst list time:  0.00010418891906738281
time for parepare:  0.00033545494079589844
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  9.036064147949219e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00019216537475585938
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.7206878662109375e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0002155303955078125
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00015425682067871094
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0002269744873046875
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.202957153320312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0001404285430908203
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  8.749961853027344e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0001697540283203125
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00010919570922851562
----------------------check_connections_block total spend ----------------------------- 0.0054891109466552734
generate_one_block  0.0013170242309570312
generate_one_block  0.0013244152069091797
generate_one_block  0.0015578269958496094
generate_one_block  0.0012710094451904297
generate_one_block  0.0015404224395751953
generate_one_block  0.0013988018035888672
generate_one_block  0.0010721683502197266
generate_one_block  0.0011248588562011719
generate_one_block  0.0010919570922851562
generate_one_block  0.001196146011352539
generate_one_block  0.001157522201538086
generate_one_block  0.0011250972747802734
generate_one_block  0.0010421276092529297
generate_one_block  0.0011780261993408203
generate_one_block  0.001071929931640625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001119375228881836
gen group dst list time:  0.0001609325408935547
time for parepare:  0.0009360313415527344
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0002808570861816406
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002028942108154297
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0003414154052734375
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.0001232624053955078
r_  generation:  0.0012590885162353516
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.00036144256591796875
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0018024444580078125
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.00018143653869628906
r_  generation:  0.001363515853881836
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0002028942108154297
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003483295440673828
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0003731250762939453
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.0018584728240966797
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0002779960632324219
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0006740093231201172
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.00036072731018066406
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.001020669937133789
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0004181861877441406
----------------------check_connections_block total spend ----------------------------- 0.019283294677734375
generate_one_block  0.0016634464263916016
generate_one_block  0.0013587474822998047
generate_one_block  0.0022270679473876953
generate_one_block  0.0013194084167480469
generate_one_block  0.0028824806213378906
generate_one_block  0.0024123191833496094
generate_one_block  0.0011012554168701172
generate_one_block  0.0012736320495605469
generate_one_block  0.001310586929321289
generate_one_block  0.0030281543731689453
generate_one_block  0.0011861324310302734
generate_one_block  0.0016965866088867188
generate_one_block  0.0013413429260253906
generate_one_block  0.002116680145263672
generate_one_block  0.0013782978057861328
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00196075439453125
gen group dst list time:  0.00041937828063964844
time for parepare:  0.001978635787963867
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00041866302490234375
mini_batch_src_global generation:  0.00020766258239746094
r_  generation:  0.0014772415161132812
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.0002334117889404297
mini_batch_src_global generation:  0.0002300739288330078
r_  generation:  0.001739501953125
local_output_nid generation:  0.0002319812774658203
local_in_edges_tensor generation:  0.0005085468292236328
mini_batch_src_global generation:  0.0007464885711669922
r_  generation:  0.006455421447753906
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  0.00034546852111816406
r_  generation:  0.002451658248901367
local_output_nid generation:  0.00016760826110839844
local_in_edges_tensor generation:  0.0004100799560546875
mini_batch_src_global generation:  0.0007038116455078125
r_  generation:  0.006297111511230469
local_output_nid generation:  0.00018095970153808594
local_in_edges_tensor generation:  0.0004150867462158203
mini_batch_src_global generation:  0.0007920265197753906
r_  generation:  0.006350517272949219
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  0.0002281665802001953
r_  generation:  0.0009093284606933594
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  0.0001437664031982422
r_  generation:  0.0014355182647705078
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.0002353191375732422
r_  generation:  0.0023331642150878906
local_output_nid generation:  0.00013399124145507812
local_in_edges_tensor generation:  0.0003223419189453125
mini_batch_src_global generation:  0.0005457401275634766
r_  generation:  0.005445003509521484
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  0.00019741058349609375
r_  generation:  0.0007104873657226562
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  0.0002651214599609375
r_  generation:  0.0030531883239746094
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  0.00027441978454589844
r_  generation:  0.0019240379333496094
local_output_nid generation:  0.00015807151794433594
local_in_edges_tensor generation:  0.0003421306610107422
mini_batch_src_global generation:  0.0005543231964111328
r_  generation:  0.005550384521484375
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  0.0002980232238769531
r_  generation:  0.002010345458984375
----------------------check_connections_block total spend ----------------------------- 0.07418036460876465
generate_one_block  0.002837657928466797
generate_one_block  0.0027818679809570312
generate_one_block  0.00874638557434082
generate_one_block  0.003694295883178711
generate_one_block  0.009252786636352539
generate_one_block  0.009916305541992188
generate_one_block  0.0018489360809326172
generate_one_block  0.002902984619140625
generate_one_block  0.003956317901611328
generate_one_block  0.008330821990966797
generate_one_block  0.0017595291137695312
generate_one_block  0.005104780197143555
generate_one_block  0.003562450408935547
generate_one_block  0.009240865707397461
generate_one_block  0.00347137451171875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002032041549682617
gen group dst list time:  0.0017018318176269531
time for parepare:  0.0018987655639648438
local_output_nid generation:  0.00022292137145996094
local_in_edges_tensor generation:  0.000904083251953125
mini_batch_src_global generation:  0.0008068084716796875
r_  generation:  0.006620168685913086
local_output_nid generation:  0.0002472400665283203
local_in_edges_tensor generation:  0.0004935264587402344
mini_batch_src_global generation:  0.0007479190826416016
r_  generation:  0.0061261653900146484
local_output_nid generation:  0.0006616115570068359
local_in_edges_tensor generation:  0.0013523101806640625
mini_batch_src_global generation:  0.0016756057739257812
r_  generation:  0.018172502517700195
local_output_nid generation:  0.00026798248291015625
local_in_edges_tensor generation:  0.0005002021789550781
mini_batch_src_global generation:  0.0009198188781738281
r_  generation:  0.007552146911621094
local_output_nid generation:  0.0006682872772216797
local_in_edges_tensor generation:  0.0009551048278808594
mini_batch_src_global generation:  0.00138092041015625
r_  generation:  0.01565694808959961
local_output_nid generation:  0.0008227825164794922
local_in_edges_tensor generation:  0.001415252685546875
mini_batch_src_global generation:  0.0018229484558105469
r_  generation:  0.018623828887939453
local_output_nid generation:  0.00018310546875
local_in_edges_tensor generation:  0.00034308433532714844
mini_batch_src_global generation:  0.0006265640258789062
r_  generation:  0.0036106109619140625
local_output_nid generation:  0.0003573894500732422
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.0005176067352294922
r_  generation:  0.0060443878173828125
local_output_nid generation:  0.00029730796813964844
local_in_edges_tensor generation:  0.0004801750183105469
mini_batch_src_global generation:  0.0006937980651855469
r_  generation:  0.007293224334716797
local_output_nid generation:  0.0005452632904052734
local_in_edges_tensor generation:  0.0008258819580078125
mini_batch_src_global generation:  0.0011487007141113281
r_  generation:  0.013601541519165039
local_output_nid generation:  0.0001316070556640625
local_in_edges_tensor generation:  0.0002887248992919922
mini_batch_src_global generation:  0.0004928112030029297
r_  generation:  0.002819538116455078
local_output_nid generation:  0.0005810260772705078
local_in_edges_tensor generation:  0.0008282661437988281
mini_batch_src_global generation:  0.0007176399230957031
r_  generation:  0.011856555938720703
local_output_nid generation:  0.00040030479431152344
local_in_edges_tensor generation:  0.0006656646728515625
mini_batch_src_global generation:  0.0008711814880371094
r_  generation:  0.0073451995849609375
local_output_nid generation:  0.0007815361022949219
local_in_edges_tensor generation:  0.0012009143829345703
mini_batch_src_global generation:  0.001621246337890625
r_  generation:  0.018376588821411133
local_output_nid generation:  0.00037407875061035156
local_in_edges_tensor generation:  0.0005524158477783203
mini_batch_src_global generation:  0.0009233951568603516
r_  generation:  0.007146596908569336
----------------------check_connections_block total spend ----------------------------- 0.22255277633666992
generate_one_block  0.009638786315917969
generate_one_block  0.009197711944580078
generate_one_block  0.022997379302978516
generate_one_block  0.011814117431640625
generate_one_block  0.020913124084472656
generate_one_block  0.0247957706451416
generate_one_block  0.005867481231689453
generate_one_block  0.009531021118164062
generate_one_block  0.010124444961547852
generate_one_block  0.016582489013671875
generate_one_block  0.004482746124267578
generate_one_block  0.015257835388183594
generate_one_block  0.011340141296386719
generate_one_block  0.02265334129333496
generate_one_block  0.011223793029785156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019385814666748047
gen group dst list time:  0.003972768783569336
time for parepare:  0.0017447471618652344
local_output_nid generation:  0.000766754150390625
local_in_edges_tensor generation:  0.001550436019897461
mini_batch_src_global generation:  0.0015330314636230469
r_  generation:  0.015891075134277344
local_output_nid generation:  0.0008387565612792969
local_in_edges_tensor generation:  0.001271963119506836
mini_batch_src_global generation:  0.0016565322875976562
r_  generation:  0.014734268188476562
local_output_nid generation:  0.001600503921508789
local_in_edges_tensor generation:  0.0023577213287353516
mini_batch_src_global generation:  0.0020592212677001953
r_  generation:  0.024437904357910156
local_output_nid generation:  0.0008671283721923828
local_in_edges_tensor generation:  0.0011255741119384766
mini_batch_src_global generation:  0.001483917236328125
r_  generation:  0.016329050064086914
local_output_nid generation:  0.0015070438385009766
local_in_edges_tensor generation:  0.0019497871398925781
mini_batch_src_global generation:  0.002080202102661133
r_  generation:  0.022603988647460938
local_output_nid generation:  0.0015347003936767578
local_in_edges_tensor generation:  0.002442598342895508
mini_batch_src_global generation:  0.002179861068725586
r_  generation:  0.025019168853759766
local_output_nid generation:  0.0005977153778076172
local_in_edges_tensor generation:  0.0008244514465332031
mini_batch_src_global generation:  0.001295328140258789
r_  generation:  0.012079954147338867
local_output_nid generation:  0.0008580684661865234
local_in_edges_tensor generation:  0.0011832714080810547
mini_batch_src_global generation:  0.0012652873992919922
r_  generation:  0.017102718353271484
local_output_nid generation:  0.0006654262542724609
local_in_edges_tensor generation:  0.0009539127349853516
mini_batch_src_global generation:  0.0013289451599121094
r_  generation:  0.014564990997314453
local_output_nid generation:  0.0011119842529296875
local_in_edges_tensor generation:  0.0015745162963867188
mini_batch_src_global generation:  0.0017375946044921875
r_  generation:  0.02041769027709961
local_output_nid generation:  0.0004353523254394531
local_in_edges_tensor generation:  0.0006625652313232422
mini_batch_src_global generation:  0.0009548664093017578
r_  generation:  0.007573843002319336
local_output_nid generation:  0.0011878013610839844
local_in_edges_tensor generation:  0.0015110969543457031
mini_batch_src_global generation:  0.0015494823455810547
r_  generation:  0.02195596694946289
local_output_nid generation:  0.0009877681732177734
local_in_edges_tensor generation:  0.0015740394592285156
mini_batch_src_global generation:  0.0016710758209228516
r_  generation:  0.01824665069580078
local_output_nid generation:  0.0014722347259521484
local_in_edges_tensor generation:  0.002268075942993164
mini_batch_src_global generation:  0.002028226852416992
r_  generation:  0.024462461471557617
local_output_nid generation:  0.0009014606475830078
local_in_edges_tensor generation:  0.0013730525970458984
mini_batch_src_global generation:  0.0017023086547851562
r_  generation:  0.017670154571533203
----------------------check_connections_block total spend ----------------------------- 0.3993041515350342
generate_one_block  0.02038264274597168
generate_one_block  0.019767284393310547
generate_one_block  0.031232118606567383
generate_one_block  0.020879268646240234
generate_one_block  0.02824854850769043
generate_one_block  0.031054973602294922
generate_one_block  0.01603078842163086
generate_one_block  0.022734880447387695
generate_one_block  0.018904924392700195
generate_one_block  0.025553464889526367
generate_one_block  0.011674165725708008
generate_one_block  0.030072450637817383
generate_one_block  0.023526906967163086
generate_one_block  0.03037285804748535
generate_one_block  0.022673845291137695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

connection checking time:  0.7208096981048584
block generation total time  0.6817021369934082
average batch blocks generation time:  0.04544680913289388
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1092529296875 GB
    Memory Allocated: 0.028006553649902344  GigaBytes
Max Memory Allocated: 0.028006553649902344  GigaBytes

torch.Size([14672, 500])
torch.Size([7165, 16])
torch.Size([2278, 16])
torch.Size([330, 16])
torch.Size([67, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.030746936798095703  GigaBytes
Max Memory Allocated: 0.03074789047241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.028020381927490234  GigaBytes
Max Memory Allocated: 0.054843902587890625  GigaBytes

torch.Size([14493, 500])
torch.Size([7591, 16])
torch.Size([2630, 16])
torch.Size([461, 16])
torch.Size([117, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.030920982360839844  GigaBytes
Max Memory Allocated: 0.054843902587890625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.0364985466003418  GigaBytes
Max Memory Allocated: 0.06265640258789062  GigaBytes

torch.Size([18502, 500])
torch.Size([15097, 16])
torch.Size([8006, 16])
torch.Size([2147, 16])
torch.Size([335, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.04348182678222656  GigaBytes
Max Memory Allocated: 0.06265640258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.025609493255615234  GigaBytes
Max Memory Allocated: 0.06265640258789062  GigaBytes

torch.Size([13312, 500])
torch.Size([7796, 16])
torch.Size([2702, 16])
torch.Size([524, 16])
torch.Size([69, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.02871084213256836  GigaBytes
Max Memory Allocated: 0.06265640258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.03395509719848633  GigaBytes
Max Memory Allocated: 0.06265640258789062  GigaBytes

torch.Size([17540, 500])
torch.Size([13295, 16])
torch.Size([6722, 16])
torch.Size([2059, 16])
torch.Size([383, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.04017066955566406  GigaBytes
Max Memory Allocated: 0.06265640258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03551816940307617  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([18330, 500])
torch.Size([15100, 16])
torch.Size([8378, 16])
torch.Size([2182, 16])
torch.Size([301, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.042629241943359375  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.023999691009521484  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([12590, 500])
torch.Size([5029, 16])
torch.Size([1398, 16])
torch.Size([232, 16])
torch.Size([64, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.02586078643798828  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03052520751953125  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([15976, 500])
torch.Size([7590, 16])
torch.Size([3082, 16])
torch.Size([452, 16])
torch.Size([139, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03364086151123047  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.023678302764892578  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([12296, 500])
torch.Size([6382, 16])
torch.Size([2826, 16])
torch.Size([544, 16])
torch.Size([79, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.02649688720703125  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03211784362792969  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([16616, 500])
torch.Size([10657, 16])
torch.Size([5902, 16])
torch.Size([1595, 16])
torch.Size([352, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03734397888183594  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.019289016723632812  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([10125, 500])
torch.Size([3931, 16])
torch.Size([1133, 16])
torch.Size([346, 16])
torch.Size([104, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.02078866958618164  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03441667556762695  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([17922, 500])
torch.Size([11459, 16])
torch.Size([5534, 16])
torch.Size([988, 16])
torch.Size([265, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03939056396484375  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03136444091796875  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([16398, 500])
torch.Size([9485, 16])
torch.Size([3883, 16])
torch.Size([697, 16])
torch.Size([154, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.035193443298339844  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.036481380462646484  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([18690, 500])
torch.Size([14805, 16])
torch.Size([8872, 16])
torch.Size([1818, 16])
torch.Size([326, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.043524742126464844  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.030784130096435547  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([16093, 500])
torch.Size([8713, 16])
torch.Size([3542, 16])
torch.Size([618, 16])
torch.Size([184, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03434133529663086  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014296134312947592 |0.024808788299560548 |0.05871971448262533 |0.00014737447102864583 |0.005220158894856771 |0.003977298736572266 |
----------------------------------------------------------pseudo_mini_loss sum 2.6917929649353027
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  462827
Number of first layer input nodes during this epoch:  233555
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03239583969116211  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005469322204589844
range selection method range initialization spend 6.508827209472656e-05
time for parepare:  5.269050598144531e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.1920928955078125e-05
----------------------check_connections_block total spend ----------------------------- 0.002802610397338867
generate_one_block  0.0016050338745117188
generate_one_block  0.001054525375366211
generate_one_block  0.0010404586791992188
generate_one_block  0.0010371208190917969
generate_one_block  0.0010423660278320312
generate_one_block  0.0010492801666259766
generate_one_block  0.0010292530059814453
generate_one_block  0.0010378360748291016
generate_one_block  0.001033782958984375
generate_one_block  0.0010356903076171875
generate_one_block  0.0009443759918212891
generate_one_block  0.0009801387786865234
generate_one_block  0.0009529590606689453
generate_one_block  0.00107574462890625
generate_one_block  0.0010035037994384766
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006585121154785156
gen group dst list time:  8.654594421386719e-05
time for parepare:  0.0003154277801513672
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00020265579223632812
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  6.818771362304688e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  7.510185241699219e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.58306884765625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.00023818016052246094
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.225440979003906e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.2479248046875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.535385131835938e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00014853477478027344
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00020575523376464844
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00018095970153808594
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  5.555152893066406e-05
----------------------check_connections_block total spend ----------------------------- 0.004925727844238281
generate_one_block  0.0011153221130371094
generate_one_block  0.0010831356048583984
generate_one_block  0.0011148452758789062
generate_one_block  0.001130819320678711
generate_one_block  0.0010938644409179688
generate_one_block  0.001348733901977539
generate_one_block  0.0010843276977539062
generate_one_block  0.0011205673217773438
generate_one_block  0.0011396408081054688
generate_one_block  0.0010874271392822266
generate_one_block  0.0010352134704589844
generate_one_block  0.0015871524810791016
generate_one_block  0.001195669174194336
generate_one_block  0.001155853271484375
generate_one_block  0.0010068416595458984
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012583732604980469
gen group dst list time:  0.00013899803161621094
time for parepare:  0.0009543895721435547
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0004093647003173828
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0002605915069580078
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0003380775451660156
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00031304359436035156
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00033926963806152344
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00039649009704589844
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.0002665519714355469
r_  generation:  0.0018527507781982422
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.00022482872009277344
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0004773139953613281
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0006761550903320312
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.00035643577575683594
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0004532337188720703
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0008270740509033203
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  0.00017023086547851562
r_  generation:  0.0016448497772216797
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  0.0001304149627685547
r_  generation:  0.0009965896606445312
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.00041031837463378906
----------------------check_connections_block total spend ----------------------------- 0.017588138580322266
generate_one_block  0.0014235973358154297
generate_one_block  0.0013546943664550781
generate_one_block  0.0013315677642822266
generate_one_block  0.0013387203216552734
generate_one_block  0.0013952255249023438
generate_one_block  0.0031104087829589844
generate_one_block  0.0011587142944335938
generate_one_block  0.0014965534210205078
generate_one_block  0.0018050670623779297
generate_one_block  0.0013189315795898438
generate_one_block  0.001415252685546875
generate_one_block  0.001971721649169922
generate_one_block  0.002811908721923828
generate_one_block  0.0020554065704345703
generate_one_block  0.0013997554779052734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018558502197265625
gen group dst list time:  0.00038242340087890625
time for parepare:  0.0017135143280029297
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.0007708072662353516
mini_batch_src_global generation:  0.00023555755615234375
r_  generation:  0.001581430435180664
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.00023603439331054688
mini_batch_src_global generation:  0.00042438507080078125
r_  generation:  0.002835988998413086
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  0.0001983642578125
r_  generation:  0.0015306472778320312
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  0.00015497207641601562
r_  generation:  0.0013647079467773438
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.0002818107604980469
r_  generation:  0.003037691116333008
local_output_nid generation:  0.00021266937255859375
local_in_edges_tensor generation:  0.0004980564117431641
mini_batch_src_global generation:  0.0011317729949951172
r_  generation:  0.00810384750366211
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  0.00028514862060546875
r_  generation:  0.0009016990661621094
local_output_nid generation:  8.320808410644531e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  0.0002646446228027344
r_  generation:  0.0029723644256591797
local_output_nid generation:  0.00013327598571777344
local_in_edges_tensor generation:  0.00031495094299316406
mini_batch_src_global generation:  0.0004298686981201172
r_  generation:  0.004464387893676758
local_output_nid generation:  6.151199340820312e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  0.00025773048400878906
r_  generation:  0.0017232894897460938
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.0002522468566894531
r_  generation:  0.0024864673614501953
local_output_nid generation:  0.0001633167266845703
local_in_edges_tensor generation:  0.00033664703369140625
mini_batch_src_global generation:  0.0003821849822998047
r_  generation:  0.004206657409667969
local_output_nid generation:  0.000156402587890625
local_in_edges_tensor generation:  0.00037670135498046875
mini_batch_src_global generation:  0.0006148815155029297
r_  generation:  0.005979299545288086
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  0.00043702125549316406
r_  generation:  0.0037615299224853516
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.0002346038818359375
mini_batch_src_global generation:  0.0003402233123779297
r_  generation:  0.0028259754180908203
----------------------check_connections_block total spend ----------------------------- 0.07362008094787598
generate_one_block  0.0032949447631835938
generate_one_block  0.00438690185546875
generate_one_block  0.002694845199584961
generate_one_block  0.002522706985473633
generate_one_block  0.004760265350341797
generate_one_block  0.011732339859008789
generate_one_block  0.002296924591064453
generate_one_block  0.005170345306396484
generate_one_block  0.00670313835144043
generate_one_block  0.0031871795654296875
generate_one_block  0.00446319580078125
generate_one_block  0.0065152645111083984
generate_one_block  0.009104251861572266
generate_one_block  0.0056095123291015625
generate_one_block  0.004718303680419922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020630359649658203
gen group dst list time:  0.001531839370727539
time for parepare:  0.0017724037170410156
local_output_nid generation:  0.00027441978454589844
local_in_edges_tensor generation:  0.001516103744506836
mini_batch_src_global generation:  0.0007295608520507812
r_  generation:  0.006726503372192383
local_output_nid generation:  0.0003178119659423828
local_in_edges_tensor generation:  0.0006465911865234375
mini_batch_src_global generation:  0.0011200904846191406
r_  generation:  0.008327484130859375
local_output_nid generation:  0.0002734661102294922
local_in_edges_tensor generation:  0.00048089027404785156
mini_batch_src_global generation:  0.0005850791931152344
r_  generation:  0.005607128143310547
local_output_nid generation:  0.00020194053649902344
local_in_edges_tensor generation:  0.0003943443298339844
mini_batch_src_global generation:  0.00046372413635253906
r_  generation:  0.004611968994140625
local_output_nid generation:  0.0004439353942871094
local_in_edges_tensor generation:  0.0007367134094238281
mini_batch_src_global generation:  0.0010142326354980469
r_  generation:  0.011813879013061523
local_output_nid generation:  0.0009388923645019531
local_in_edges_tensor generation:  0.005323648452758789
mini_batch_src_global generation:  0.0018794536590576172
r_  generation:  0.01938629150390625
local_output_nid generation:  0.0001900196075439453
local_in_edges_tensor generation:  0.00033926963806152344
mini_batch_src_global generation:  0.0007648468017578125
r_  generation:  0.00392603874206543
local_output_nid generation:  0.0005095005035400391
local_in_edges_tensor generation:  0.0007383823394775391
mini_batch_src_global generation:  0.0010590553283691406
r_  generation:  0.011742115020751953
local_output_nid generation:  0.0006122589111328125
local_in_edges_tensor generation:  0.002804279327392578
mini_batch_src_global generation:  0.002172231674194336
r_  generation:  0.014323711395263672
local_output_nid generation:  0.0003383159637451172
local_in_edges_tensor generation:  0.0004978179931640625
mini_batch_src_global generation:  0.0007081031799316406
r_  generation:  0.006261110305786133
local_output_nid generation:  0.000537872314453125
local_in_edges_tensor generation:  0.0007524490356445312
mini_batch_src_global generation:  0.0009486675262451172
r_  generation:  0.01090860366821289
local_output_nid generation:  0.0006551742553710938
local_in_edges_tensor generation:  0.0011374950408935547
mini_batch_src_global generation:  0.00116729736328125
r_  generation:  0.013852834701538086
local_output_nid generation:  0.0007605552673339844
local_in_edges_tensor generation:  0.0009756088256835938
mini_batch_src_global generation:  0.0013356208801269531
r_  generation:  0.01524662971496582
local_output_nid generation:  0.0006175041198730469
local_in_edges_tensor generation:  0.0008120536804199219
mini_batch_src_global generation:  0.0010993480682373047
r_  generation:  0.012012004852294922
local_output_nid generation:  0.0004930496215820312
local_in_edges_tensor generation:  0.0007190704345703125
mini_batch_src_global generation:  0.0009608268737792969
r_  generation:  0.011342048645019531
----------------------check_connections_block total spend ----------------------------- 0.23662209510803223
generate_one_block  0.009348392486572266
generate_one_block  0.011151313781738281
generate_one_block  0.008330106735229492
generate_one_block  0.008183479309082031
generate_one_block  0.015051603317260742
generate_one_block  0.02519679069519043
generate_one_block  0.0065937042236328125
generate_one_block  0.015552282333374023
generate_one_block  0.018902301788330078
generate_one_block  0.00941920280456543
generate_one_block  0.013742208480834961
generate_one_block  0.018320083618164062
generate_one_block  0.019312620162963867
generate_one_block  0.015524864196777344
generate_one_block  0.015529155731201172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001657247543334961
gen group dst list time:  0.0043184757232666016
time for parepare:  0.001960277557373047
local_output_nid generation:  0.0007135868072509766
local_in_edges_tensor generation:  0.0015850067138671875
mini_batch_src_global generation:  0.0013692378997802734
r_  generation:  0.015325546264648438
local_output_nid generation:  0.0007455348968505859
local_in_edges_tensor generation:  0.0011682510375976562
mini_batch_src_global generation:  0.0018286705017089844
r_  generation:  0.015612602233886719
local_output_nid generation:  0.0009264945983886719
local_in_edges_tensor generation:  0.0012454986572265625
mini_batch_src_global generation:  0.0013785362243652344
r_  generation:  0.016562223434448242
local_output_nid generation:  0.0007417201995849609
local_in_edges_tensor generation:  0.0009565353393554688
mini_batch_src_global generation:  0.0012946128845214844
r_  generation:  0.014552593231201172
local_output_nid generation:  0.0010933876037597656
local_in_edges_tensor generation:  0.001461029052734375
mini_batch_src_global generation:  0.0017757415771484375
r_  generation:  0.020708799362182617
local_output_nid generation:  0.001506805419921875
local_in_edges_tensor generation:  0.001871347427368164
mini_batch_src_global generation:  0.0021822452545166016
r_  generation:  0.024830102920532227
local_output_nid generation:  0.00067901611328125
local_in_edges_tensor generation:  0.0008983612060546875
mini_batch_src_global generation:  0.0014393329620361328
r_  generation:  0.013339996337890625
local_output_nid generation:  0.0012767314910888672
local_in_edges_tensor generation:  0.0016126632690429688
mini_batch_src_global generation:  0.0014472007751464844
r_  generation:  0.020155668258666992
local_output_nid generation:  0.0013573169708251953
local_in_edges_tensor generation:  0.00173187255859375
mini_batch_src_global generation:  0.0018939971923828125
r_  generation:  0.02194809913635254
local_output_nid generation:  0.0007984638214111328
local_in_edges_tensor generation:  0.0010988712310791016
mini_batch_src_global generation:  0.0013988018035888672
r_  generation:  0.01446986198425293
local_output_nid generation:  0.0011777877807617188
local_in_edges_tensor generation:  0.0016090869903564453
mini_batch_src_global generation:  0.0016112327575683594
r_  generation:  0.0206449031829834
local_output_nid generation:  0.001356363296508789
local_in_edges_tensor generation:  0.0018451213836669922
mini_batch_src_global generation:  0.0021033287048339844
r_  generation:  0.023470401763916016
local_output_nid generation:  0.00119781494140625
local_in_edges_tensor generation:  0.0016639232635498047
mini_batch_src_global generation:  0.0018575191497802734
r_  generation:  0.021778106689453125
local_output_nid generation:  0.0012502670288085938
local_in_edges_tensor generation:  0.0015981197357177734
mini_batch_src_global generation:  0.0019257068634033203
r_  generation:  0.021516799926757812
local_output_nid generation:  0.00103759765625
local_in_edges_tensor generation:  0.0014638900756835938
mini_batch_src_global generation:  0.0017099380493164062
r_  generation:  0.020218372344970703
----------------------check_connections_block total spend ----------------------------- 0.4134547710418701
generate_one_block  0.01862049102783203
generate_one_block  0.02437424659729004
generate_one_block  0.021911144256591797
generate_one_block  0.018932819366455078
generate_one_block  0.026532888412475586
generate_one_block  0.03127455711364746
generate_one_block  0.017912626266479492
generate_one_block  0.02567744255065918
generate_one_block  0.027637720108032227
generate_one_block  0.018514633178710938
generate_one_block  0.026129484176635742
generate_one_block  0.029510021209716797
generate_one_block  0.027083635330200195
generate_one_block  0.02676868438720703
generate_one_block  0.026284456253051758
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03239583969116211  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

connection checking time:  0.7462108135223389
block generation total time  0.6971700191497803
average batch blocks generation time:  0.04647800127665202
block dataloader generation time/epoch 1.5266990661621094
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.025938034057617188  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([13458, 500])
torch.Size([6650, 16])
torch.Size([2471, 16])
torch.Size([422, 16])
torch.Size([102, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.028641700744628906  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.025825977325439453  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([13343, 500])
torch.Size([7267, 16])
torch.Size([3182, 16])
torch.Size([605, 16])
torch.Size([83, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.028983116149902344  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.030006885528564453  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([15641, 500])
torch.Size([8411, 16])
torch.Size([2559, 16])
torch.Size([569, 16])
torch.Size([135, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03313875198364258  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.02620077133178711  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([13634, 500])
torch.Size([6402, 16])
torch.Size([2002, 16])
torch.Size([479, 16])
torch.Size([124, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.028691768646240234  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03215980529785156  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([16637, 500])
torch.Size([11044, 16])
torch.Size([4555, 16])
torch.Size([784, 16])
torch.Size([88, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.036681175231933594  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.036763668060302734  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([18731, 500])
torch.Size([15159, 16])
torch.Size([10157, 16])
torch.Size([2493, 16])
torch.Size([530, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.04458045959472656  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.024047374725341797  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([12507, 500])
torch.Size([5236, 16])
torch.Size([1575, 16])
torch.Size([257, 16])
torch.Size([92, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.026068687438964844  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03187370300292969  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([16484, 500])
torch.Size([10876, 16])
torch.Size([4763, 16])
torch.Size([873, 16])
torch.Size([136, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03645133972167969  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03265714645385742  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([16835, 500])
torch.Size([12553, 16])
torch.Size([5620, 16])
torch.Size([1408, 16])
torch.Size([156, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.038071632385253906  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.028179645538330078  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([14334, 500])
torch.Size([7387, 16])
torch.Size([3067, 16])
torch.Size([570, 16])
torch.Size([143, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.031203746795654297  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03324270248413086  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([17238, 500])
torch.Size([10894, 16])
torch.Size([4648, 16])
torch.Size([714, 16])
torch.Size([188, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03773069381713867  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03488969802856445  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([18037, 500])
torch.Size([13901, 16])
torch.Size([6043, 16])
torch.Size([1776, 16])
torch.Size([255, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.040808677673339844  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.033617496490478516  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([17305, 500])
torch.Size([11809, 16])
torch.Size([6958, 16])
torch.Size([1677, 16])
torch.Size([400, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.039452552795410156  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.034236907958984375  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([17743, 500])
torch.Size([11983, 16])
torch.Size([5598, 16])
torch.Size([1536, 16])
torch.Size([374, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03951263427734375  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.031490325927734375  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

torch.Size([16291, 500])
torch.Size([10460, 16])
torch.Size([4383, 16])
torch.Size([738, 16])
torch.Size([111, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.035816192626953125  GigaBytes
Max Memory Allocated: 0.0669698715209961  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009968773523966471 |0.0016470114390055338 |0.007319434483846029 |0.00014141400655110677 |0.004591751098632813 |0.004223346710205078 |
----------------------------------------------------------pseudo_mini_loss sum 2.282949447631836
Total (block generation + training)time/epoch 1.9099488258361816
Training time/epoch 0.38261985778808594
Training time without block to device /epoch 0.35791468620300293
Training time without total dataloading part /epoch 0.1850123405456543
load block tensor time/epoch 0.14953160285949707
block to device time/epoch 0.024705171585083008
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  474006
Number of first layer input nodes during this epoch:  238218
