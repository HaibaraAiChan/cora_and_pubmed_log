main start at this time 1648533393.4212558
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0010178089141845703
range selection method range initialization spend 0.00010371208190917969
time for parepare:  4.6253204345703125e-05
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0033075809478759766
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  7.033348083496094e-05
----------------------check_connections_block total spend ----------------------------- 0.004061222076416016
generate_one_block  0.0013659000396728516
generate_one_block  0.0011124610900878906
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005488395690917969
gen group dst list time:  2.5033950805664062e-05
time for parepare:  0.00024080276489257812
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0006036758422851562
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.0006847381591796875
----------------------check_connections_block total spend ----------------------------- 0.0024232864379882812
generate_one_block  0.0017826557159423828
generate_one_block  0.0018754005432128906
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010726451873779297
gen group dst list time:  6.461143493652344e-05
time for parepare:  0.0007264614105224609
local_output_nid generation:  9.131431579589844e-05
local_in_edges_tensor generation:  0.0003960132598876953
mini_batch_src_global generation:  0.0003783702850341797
r_  generation:  0.004111289978027344
local_output_nid generation:  0.00010704994201660156
local_in_edges_tensor generation:  0.0003104209899902344
mini_batch_src_global generation:  0.0005245208740234375
r_  generation:  0.006144285202026367
----------------------check_connections_block total spend ----------------------------- 0.01501774787902832
generate_one_block  0.006881237030029297
generate_one_block  0.0058515071868896484
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.004225492477416992
gen group dst list time:  0.00019788742065429688
time for parepare:  0.0013878345489501953
local_output_nid generation:  0.0003948211669921875
local_in_edges_tensor generation:  0.0011284351348876953
mini_batch_src_global generation:  0.00146484375
r_  generation:  0.014754295349121094
local_output_nid generation:  0.00037980079650878906
local_in_edges_tensor generation:  0.0009112358093261719
mini_batch_src_global generation:  0.0015573501586914062
r_  generation:  0.013546943664550781
----------------------check_connections_block total spend ----------------------------- 0.04242897033691406
generate_one_block  0.019681453704833984
generate_one_block  0.019012928009033203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019083023071289062
gen group dst list time:  0.0005307197570800781
time for parepare:  0.001596212387084961
local_output_nid generation:  0.0009300708770751953
local_in_edges_tensor generation:  0.0022492408752441406
mini_batch_src_global generation:  0.0023932456970214844
r_  generation:  0.02322697639465332
local_output_nid generation:  0.0010902881622314453
local_in_edges_tensor generation:  0.0022652149200439453
mini_batch_src_global generation:  0.0025691986083984375
r_  generation:  0.02392435073852539
----------------------check_connections_block total spend ----------------------------- 0.07096123695373535
generate_one_block  0.02915048599243164
generate_one_block  0.029827356338500977
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001787424087524414
gen group dst list time:  0.0007467269897460938
time for parepare:  0.0015606880187988281
local_output_nid generation:  0.001262664794921875
local_in_edges_tensor generation:  0.0025184154510498047
mini_batch_src_global generation:  0.0021381378173828125
r_  generation:  0.025782346725463867
local_output_nid generation:  0.0014224052429199219
local_in_edges_tensor generation:  0.002369403839111328
mini_batch_src_global generation:  0.0026998519897460938
r_  generation:  0.025940895080566406
----------------------check_connections_block total spend ----------------------------- 0.07693004608154297
generate_one_block  0.03059840202331543
generate_one_block  0.03372621536254883
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

connection checking time:  0.20776128768920898
block generation total time  0.17838764190673828
average batch blocks generation time:  0.08919382095336914
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03753805160522461  GigaBytes
Max Memory Allocated: 0.03753805160522461  GigaBytes

torch.Size([19220, 500])
torch.Size([17936, 16])
torch.Size([13771, 16])
torch.Size([5972, 16])
torch.Size([1334, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.04859590530395508  GigaBytes
Max Memory Allocated: 0.04861259460449219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.037862300872802734  GigaBytes
Max Memory Allocated: 0.07203817367553711  GigaBytes

torch.Size([19371, 500])
torch.Size([17805, 16])
torch.Size([14123, 16])
torch.Size([4982, 16])
torch.Size([1446, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.0485844612121582  GigaBytes
Max Memory Allocated: 0.07203817367553711  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.020789146423339844 |0.17581701278686523 |0.39262914657592773 |0.00023365020751953125 |0.009471654891967773 |0.003366708755493164 |
----------------------------------------------------------pseudo_mini_loss sum 2.807703733444214
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  116315
Number of first layer input nodes during this epoch:  38591
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.04162168502807617  GigaBytes
Max Memory Allocated: 0.07203817367553711  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005235671997070312
range selection method range initialization spend 6.0558319091796875e-05
time for parepare:  5.4836273193359375e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  6.699562072753906e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00010991096496582031
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  7.43865966796875e-05
----------------------check_connections_block total spend ----------------------------- 0.0007708072662353516
generate_one_block  0.0011448860168457031
generate_one_block  0.0011096000671386719
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005342960357666016
gen group dst list time:  2.765655517578125e-05
time for parepare:  0.00026988983154296875
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0005221366882324219
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  9.942054748535156e-05
r_  generation:  0.0007312297821044922
----------------------check_connections_block total spend ----------------------------- 0.0024123191833496094
generate_one_block  0.0017919540405273438
generate_one_block  0.0019419193267822266
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010020732879638672
gen group dst list time:  7.200241088867188e-05
time for parepare:  0.000766754150390625
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.000370025634765625
mini_batch_src_global generation:  0.00032138824462890625
r_  generation:  0.003470897674560547
local_output_nid generation:  0.00013303756713867188
local_in_edges_tensor generation:  0.00032973289489746094
mini_batch_src_global generation:  0.0005171298980712891
r_  generation:  0.004882097244262695
----------------------check_connections_block total spend ----------------------------- 0.012972354888916016
generate_one_block  0.005838871002197266
generate_one_block  0.006733894348144531
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002082347869873047
gen group dst list time:  0.00020956993103027344
time for parepare:  0.001337289810180664
local_output_nid generation:  0.00032401084899902344
local_in_edges_tensor generation:  0.0009922981262207031
mini_batch_src_global generation:  0.0010652542114257812
r_  generation:  0.013344526290893555
local_output_nid generation:  0.0004584789276123047
local_in_edges_tensor generation:  0.0014462471008300781
mini_batch_src_global generation:  0.0020017623901367188
r_  generation:  0.015552282333374023
----------------------check_connections_block total spend ----------------------------- 0.043712615966796875
generate_one_block  0.017883777618408203
generate_one_block  0.021703243255615234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017926692962646484
gen group dst list time:  0.0005447864532470703
time for parepare:  0.0015141963958740234
local_output_nid generation:  0.0009675025939941406
local_in_edges_tensor generation:  0.0019998550415039062
mini_batch_src_global generation:  0.0017802715301513672
r_  generation:  0.02292323112487793
local_output_nid generation:  0.0011284351348876953
local_in_edges_tensor generation:  0.002514362335205078
mini_batch_src_global generation:  0.0026102066040039062
r_  generation:  0.02433919906616211
----------------------check_connections_block total spend ----------------------------- 0.07054471969604492
generate_one_block  0.028245925903320312
generate_one_block  0.0321958065032959
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021648406982421875
gen group dst list time:  0.0007674694061279297
time for parepare:  0.0015597343444824219
local_output_nid generation:  0.001275777816772461
local_in_edges_tensor generation:  0.0026726722717285156
mini_batch_src_global generation:  0.0018851757049560547
r_  generation:  0.025663137435913086
local_output_nid generation:  0.0014328956604003906
local_in_edges_tensor generation:  0.002482175827026367
mini_batch_src_global generation:  0.002663135528564453
r_  generation:  0.02641010284423828
----------------------check_connections_block total spend ----------------------------- 0.07754874229431152
generate_one_block  0.029834270477294922
generate_one_block  0.032347679138183594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.04162168502807617  GigaBytes
Max Memory Allocated: 0.07203817367553711  GigaBytes

connection checking time:  0.20719075202941895
block generation total time  0.17851734161376953
average batch blocks generation time:  0.08925867080688477
block dataloader generation time/epoch 0.44144463539123535
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.037761688232421875  GigaBytes
Max Memory Allocated: 0.07225847244262695  GigaBytes

torch.Size([19260, 500])
torch.Size([17469, 16])
torch.Size([13638, 16])
torch.Size([4691, 16])
torch.Size([1176, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.048193931579589844  GigaBytes
Max Memory Allocated: 0.07225847244262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03804302215576172  GigaBytes
Max Memory Allocated: 0.07225847244262695  GigaBytes

torch.Size([19343, 500])
torch.Size([18221, 16])
torch.Size([14836, 16])
torch.Size([6335, 16])
torch.Size([1658, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.04950523376464844  GigaBytes
Max Memory Allocated: 0.07225847244262695  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0136260986328125 |0.0018845796585083008 |0.006800413131713867 |0.00014519691467285156 |0.004862308502197266 |0.0028159618377685547 |
----------------------------------------------------------pseudo_mini_loss sum 2.712222099304199
Total (block generation + training)time/epoch 0.5022988319396973
Training time/epoch 0.06032538414001465
Training time without block to device /epoch 0.05655622482299805
Training time without total dataloading part /epoch 0.026431798934936523
load block tensor time/epoch 0.027252197265625
block to device time/epoch 0.0037691593170166016
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  116984
Number of first layer input nodes during this epoch:  38603
