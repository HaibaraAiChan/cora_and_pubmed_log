main start at this time 1648533404.4778256
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0017702579498291016
range selection method range initialization spend 0.00010585784912109375
time for parepare:  4.506111145019531e-05
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00159454345703125
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.1961669921875e-05
----------------------check_connections_block total spend ----------------------------- 0.0027153491973876953
generate_one_block  0.001394510269165039
generate_one_block  0.0011446475982666016
generate_one_block  0.00112152099609375
generate_one_block  0.0011281967163085938
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011620521545410156
gen group dst list time:  3.337860107421875e-05
time for parepare:  0.0002422332763671875
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0002593994140625
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0003695487976074219
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0003266334533691406
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0003867149353027344
----------------------check_connections_block total spend ----------------------------- 0.002814054489135742
generate_one_block  0.0014338493347167969
generate_one_block  0.001645803451538086
generate_one_block  0.0014905929565429688
generate_one_block  0.0016045570373535156
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010561943054199219
gen group dst list time:  7.677078247070312e-05
time for parepare:  0.0007870197296142578
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00028204917907714844
mini_batch_src_global generation:  0.00013017654418945312
r_  generation:  0.0014061927795410156
local_output_nid generation:  6.222724914550781e-05
local_in_edges_tensor generation:  0.0002498626708984375
mini_batch_src_global generation:  0.0003840923309326172
r_  generation:  0.003083467483520508
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  0.0002720355987548828
r_  generation:  0.0021479129791259766
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.00023698806762695312
mini_batch_src_global generation:  0.00022721290588378906
r_  generation:  0.0021982192993164062
----------------------check_connections_block total spend ----------------------------- 0.014158487319946289
generate_one_block  0.0029191970825195312
generate_one_block  0.004664182662963867
generate_one_block  0.0035037994384765625
generate_one_block  0.003451824188232422
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002206087112426758
gen group dst list time:  0.00023555755615234375
time for parepare:  0.0016074180603027344
local_output_nid generation:  0.00020170211791992188
local_in_edges_tensor generation:  0.0007498264312744141
mini_batch_src_global generation:  0.000926971435546875
r_  generation:  0.0077779293060302734
local_output_nid generation:  0.0003223419189453125
local_in_edges_tensor generation:  0.0012028217315673828
mini_batch_src_global generation:  0.001329660415649414
r_  generation:  0.012191534042358398
local_output_nid generation:  0.00020074844360351562
local_in_edges_tensor generation:  0.00046372413635253906
mini_batch_src_global generation:  0.0008409023284912109
r_  generation:  0.007058858871459961
local_output_nid generation:  0.0002880096435546875
local_in_edges_tensor generation:  0.0005784034729003906
mini_batch_src_global generation:  0.0007455348968505859
r_  generation:  0.008355379104614258
----------------------check_connections_block total spend ----------------------------- 0.05370616912841797
generate_one_block  0.010900020599365234
generate_one_block  0.01586151123046875
generate_one_block  0.011378288269042969
generate_one_block  0.01326298713684082
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001814126968383789
gen group dst list time:  0.0008611679077148438
time for parepare:  0.0018148422241210938
local_output_nid generation:  0.0008213520050048828
local_in_edges_tensor generation:  0.0022716522216796875
mini_batch_src_global generation:  0.0020966529846191406
r_  generation:  0.01967787742614746
local_output_nid generation:  0.0009932518005371094
local_in_edges_tensor generation:  0.0018339157104492188
mini_batch_src_global generation:  0.002656221389770508
r_  generation:  0.02190685272216797
local_output_nid generation:  0.0008251667022705078
local_in_edges_tensor generation:  0.0011508464813232422
mini_batch_src_global generation:  0.0014951229095458984
r_  generation:  0.016968488693237305
local_output_nid generation:  0.0011281967163085938
local_in_edges_tensor generation:  0.0014989376068115234
mini_batch_src_global generation:  0.0015997886657714844
r_  generation:  0.02091240882873535
----------------------check_connections_block total spend ----------------------------- 0.11801314353942871
generate_one_block  0.024473905563354492
generate_one_block  0.02875208854675293
generate_one_block  0.021475791931152344
generate_one_block  0.027495145797729492
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017294883728027344
gen group dst list time:  0.0013964176177978516
time for parepare:  0.0017240047454833984
local_output_nid generation:  0.0013778209686279297
local_in_edges_tensor generation:  0.0024824142456054688
mini_batch_src_global generation:  0.0021936893463134766
r_  generation:  0.025272607803344727
local_output_nid generation:  0.001416921615600586
local_in_edges_tensor generation:  0.0025186538696289062
mini_batch_src_global generation:  0.0026438236236572266
r_  generation:  0.025946855545043945
local_output_nid generation:  0.0013048648834228516
local_in_edges_tensor generation:  0.0018415451049804688
mini_batch_src_global generation:  0.001926422119140625
r_  generation:  0.022863388061523438
local_output_nid generation:  0.0015785694122314453
local_in_edges_tensor generation:  0.0026586055755615234
mini_batch_src_global generation:  0.002269744873046875
r_  generation:  0.025783300399780273
----------------------check_connections_block total spend ----------------------------- 0.14687538146972656
generate_one_block  0.029941320419311523
generate_one_block  0.032366275787353516
generate_one_block  0.028562545776367188
generate_one_block  0.031955718994140625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

connection checking time:  0.3355672359466553
block generation total time  0.29713940620422363
average batch blocks generation time:  0.07428485155105591
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03654766082763672  GigaBytes
Max Memory Allocated: 0.03654766082763672  GigaBytes

torch.Size([18884, 500])
torch.Size([16244, 16])
torch.Size([9598, 16])
torch.Size([2686, 16])
torch.Size([515, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.0444798469543457  GigaBytes
Max Memory Allocated: 0.04448223114013672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.03685951232910156  GigaBytes
Max Memory Allocated: 0.07053709030151367  GigaBytes

torch.Size([18901, 500])
torch.Size([16892, 16])
torch.Size([11553, 16])
torch.Size([4246, 16])
torch.Size([840, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.047025203704833984  GigaBytes
Max Memory Allocated: 0.07053709030151367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.034929752349853516  GigaBytes
Max Memory Allocated: 0.07053709030151367  GigaBytes

torch.Size([18030, 500])
torch.Size([13165, 16])
torch.Size([7893, 16])
torch.Size([2321, 16])
torch.Size([611, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.04162740707397461  GigaBytes
Max Memory Allocated: 0.07053709030151367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.03723430633544922  GigaBytes
Max Memory Allocated: 0.07053709030151367  GigaBytes

torch.Size([19172, 500])
torch.Size([16665, 16])
torch.Size([11735, 16])
torch.Size([3271, 16])
torch.Size([879, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.0465397834777832  GigaBytes
Max Memory Allocated: 0.07053709030151367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01341855525970459 |0.08960223197937012 |0.19858914613723755 |0.00018727779388427734 |0.00711512565612793 |0.00794529914855957 |
----------------------------------------------------------pseudo_mini_loss sum 2.434926986694336
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  194456
Number of first layer input nodes during this epoch:  74987
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.04043292999267578  GigaBytes
Max Memory Allocated: 0.07053709030151367  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0004870891571044922
range selection method range initialization spend 5.507469177246094e-05
time for parepare:  4.744529724121094e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.14984130859375e-05
----------------------check_connections_block total spend ----------------------------- 0.0009942054748535156
generate_one_block  0.0011372566223144531
generate_one_block  0.001062631607055664
generate_one_block  0.0011157989501953125
generate_one_block  0.0010766983032226562
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005209445953369141
gen group dst list time:  3.528594970703125e-05
time for parepare:  0.000278472900390625
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00017690658569335938
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0003657341003417969
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0002532005310058594
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0004687309265136719
----------------------check_connections_block total spend ----------------------------- 0.002735137939453125
generate_one_block  0.001264810562133789
generate_one_block  0.001512765884399414
generate_one_block  0.0012984275817871094
generate_one_block  0.001627206802368164
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0009779930114746094
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.0007688999176025391
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0002853870391845703
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0009238719940185547
local_output_nid generation:  6.532669067382812e-05
local_in_edges_tensor generation:  0.00022673606872558594
mini_batch_src_global generation:  0.0002925395965576172
r_  generation:  0.0027964115142822266
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  0.0002033710479736328
r_  generation:  0.0015895366668701172
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.0002837181091308594
mini_batch_src_global generation:  0.0003020763397216797
r_  generation:  0.0033881664276123047
----------------------check_connections_block total spend ----------------------------- 0.013981342315673828
generate_one_block  0.002901315689086914
generate_one_block  0.004599809646606445
generate_one_block  0.0027985572814941406
generate_one_block  0.005281209945678711
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002028942108154297
gen group dst list time:  0.00024127960205078125
time for parepare:  0.0013911724090576172
local_output_nid generation:  0.0001239776611328125
local_in_edges_tensor generation:  0.0006315708160400391
mini_batch_src_global generation:  0.0004658699035644531
r_  generation:  0.0052454471588134766
local_output_nid generation:  0.00027108192443847656
local_in_edges_tensor generation:  0.0006203651428222656
mini_batch_src_global generation:  0.0010993480682373047
r_  generation:  0.011597394943237305
local_output_nid generation:  0.00022840499877929688
local_in_edges_tensor generation:  0.000507354736328125
mini_batch_src_global generation:  0.0009725093841552734
r_  generation:  0.0076520442962646484
local_output_nid generation: Using backend: pytorch
 0.00036406517028808594
local_in_edges_tensor generation:  0.0007128715515136719
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.012808799743652344
----------------------check_connections_block total spend ----------------------------- 0.056844234466552734
generate_one_block  0.009061098098754883
generate_one_block  0.014800310134887695
generate_one_block  0.011983156204223633
generate_one_block  0.017307281494140625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017919540405273438
gen group dst list time:  0.0007731914520263672
time for parepare:  0.001504659652709961
local_output_nid generation:  0.0005567073822021484
local_in_edges_tensor generation:  0.001485586166381836
mini_batch_src_global generation:  0.0012166500091552734
r_  generation:  0.015341520309448242
local_output_nid generation:  0.0009810924530029297
local_in_edges_tensor generation:  0.0018551349639892578
mini_batch_src_global generation:  0.0024874210357666016
r_  generation:  0.021453857421875
local_output_nid generation:  0.0010273456573486328
local_in_edges_tensor generation:  0.0016255378723144531
mini_batch_src_global generation:  0.0018887519836425781
r_  generation:  0.02021169662475586
local_output_nid generation:  0.0012934207916259766
local_in_edges_tensor generation:  0.0019156932830810547
mini_batch_src_global generation:  0.002000093460083008
r_  generation:  0.02258157730102539
----------------------check_connections_block total spend ----------------------------- 0.11927175521850586
generate_one_block  0.018920421600341797
generate_one_block  0.0295107364654541
generate_one_block  0.025809288024902344
generate_one_block  0.03025364875793457
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002111196517944336
gen group dst list time:  0.0013332366943359375
time for parepare:  0.0016467571258544922
local_output_nid generation:  0.0011775493621826172
local_in_edges_tensor generation:  0.0025434494018554688
mini_batch_src_global generation:  0.00180816650390625
r_  generation:  0.02291393280029297
local_output_nid generation:  0.0014164447784423828
local_in_edges_tensor generation:  0.002290964126586914
mini_batch_src_global generation:  0.0026502609252929688
r_  generation:  0.025766611099243164
local_output_nid generation:  0.0016417503356933594
local_in_edges_tensor generation:  0.002685546875
mini_batch_src_global generation:  0.001955270767211914
r_  generation:  0.025438308715820312
local_output_nid generation:  0.002214193344116211
local_in_edges_tensor generation:  0.0027604103088378906
mini_batch_src_global generation:  0.0025539398193359375
r_  generation:  0.027376413345336914
----------------------check_connections_block total spend ----------------------------- 0.15156888961791992
generate_one_block  0.029234886169433594
generate_one_block  0.03287935256958008
generate_one_block  0.03177905082702637
generate_one_block  0.03136086463928223
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.04043292999267578  GigaBytes
Max Memory Allocated: 0.07053709030151367  GigaBytes

connection checking time:  0.34440135955810547
block generation total time  0.3041841983795166
average batch blocks generation time:  0.07604604959487915
block dataloader generation time/epoch 0.7009778022766113
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.03480100631713867  GigaBytes
Max Memory Allocated: 0.07053709030151367  GigaBytes

torch.Size([17948, 500])
torch.Size([13539, 16])
torch.Size([6870, 16])
torch.Size([1637, 16])
torch.Size([368, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.040936946868896484  GigaBytes
Max Memory Allocated: 0.07053709030151367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.0373988151550293  GigaBytes
Max Memory Allocated: 0.07053709030151367  GigaBytes

torch.Size([19122, 500])
torch.Size([16564, 16])
torch.Size([12034, 16])
torch.Size([3766, 16])
torch.Size([834, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.04709005355834961  GigaBytes
Max Memory Allocated: 0.07053709030151367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.03661918640136719  GigaBytes
Max Memory Allocated: 0.07092046737670898  GigaBytes

torch.Size([18790, 500])
torch.Size([16100, 16])
torch.Size([10212, 16])
torch.Size([2795, 16])
torch.Size([611, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.04475831985473633  GigaBytes
Max Memory Allocated: 0.07092046737670898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.03757953643798828  GigaBytes
Max Memory Allocated: 0.07101917266845703  GigaBytes

torch.Size([19175, 500])
torch.Size([17544, 16])
torch.Size([12801, 16])
torch.Size([4689, 16])
torch.Size([1080, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.047908782958984375  GigaBytes
Max Memory Allocated: 0.07101917266845703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014019966125488281 |0.0018162131309509277 |0.007021784782409668 |0.00013595819473266602 |0.005127370357513428 |0.006185054779052734 |
----------------------------------------------------------pseudo_mini_loss sum 1.9310295581817627
Total (block generation + training)time/epoch 0.8266744613647461
Training time/epoch 0.12509703636169434
Training time without block to device /epoch 0.11783218383789062
Training time without total dataloading part /epoch 0.05532550811767578
load block tensor time/epoch 0.056079864501953125
block to device time/epoch 0.007264852523803711
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  196836
Number of first layer input nodes during this epoch:  75035
