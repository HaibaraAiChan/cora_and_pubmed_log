main start at this time 1648533621.16505
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002933979034423828  GigaBytes
Max Memory Allocated: 0.002933979034423828  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0010480880737304688
range selection method range initialization spend 9.489059448242188e-05
time for parepare:  5.650520324707031e-05
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.001399993896484375
----------------------check_connections_block total spend ----------------------------- 0.0019371509552001953
generate_one_block  0.002249479293823242
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007839202880859375
gen group dst list time:  2.5510787963867188e-05
time for parepare:  0.0002968311309814453
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.0001709461212158203
r_  generation:  0.0014464855194091797
----------------------check_connections_block total spend ----------------------------- 0.0026259422302246094
generate_one_block  0.0033409595489501953
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012276172637939453
gen group dst list time:  7.033348083496094e-05
time for parepare:  0.0008955001831054688
local_output_nid generation:  0.0002300739288330078
local_in_edges_tensor generation:  0.0006327629089355469
mini_batch_src_global generation:  0.0008528232574462891
r_  generation:  0.008407354354858398
----------------------check_connections_block total spend ----------------------------- 0.01355123519897461
generate_one_block  0.01020956039428711
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018875598907470703
gen group dst list time:  0.0001900196075439453
time for parepare:  0.0017828941345214844
local_output_nid generation:  0.0007152557373046875
local_in_edges_tensor generation:  0.0015053749084472656
mini_batch_src_global generation:  0.0021991729736328125
r_  generation:  0.018496274948120117
----------------------check_connections_block total spend ----------------------------- 0.030058622360229492
generate_one_block  0.023124217987060547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001901865005493164
gen group dst list time:  0.00030422210693359375
time for parepare:  0.001699209213256836
local_output_nid generation:  0.001081705093383789
local_in_edges_tensor generation:  0.0023145675659179688
mini_batch_src_global generation:  0.002217531204223633
r_  generation:  0.02630901336669922
----------------------check_connections_block total spend ----------------------------- 0.04016733169555664
generate_one_block  0.03126668930053711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002064228057861328
gen group dst list time:  0.00038886070251464844
time for parepare:  0.0015780925750732422
local_output_nid generation:  0.0012438297271728516
local_in_edges_tensor generation:  0.0025758743286132812
mini_batch_src_global generation:  0.0022628307342529297
r_  generation:  0.027132511138916016
----------------------check_connections_block total spend ----------------------------- 0.0416412353515625
generate_one_block  0.031212806701660156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002933979034423828  GigaBytes
Max Memory Allocated: 0.002933979034423828  GigaBytes

connection checking time:  0.12804436683654785
block generation total time  0.09915423393249512
average batch blocks generation time:  0.09915423393249512
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1229248046875 GB
    Memory Allocated: 0.04191017150878906  GigaBytes
Max Memory Allocated: 0.04191017150878906  GigaBytes

torch.Size([19486, 500])
torch.Size([18596, 256])
torch.Size([16315, 256])
torch.Size([8135, 256])
torch.Size([2584, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.2135319709777832  GigaBytes
Max Memory Allocated: 0.2145223617553711  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013745784759521484 |0.34300947189331055 |0.7694387435913086 |0.00031685829162597656 |0.01836562156677246 |0.009360551834106445 |
----------------------------------------------------------pseudo_mini_loss sum 2.973912239074707
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  65470
Number of first layer input nodes during this epoch:  19486
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5526123046875 GB
    Memory Allocated: 0.05482912063598633  GigaBytes
Max Memory Allocated: 0.21799421310424805  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005331039428710938
range selection method range initialization spend 5.841255187988281e-05
time for parepare:  5.14984130859375e-05
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00011801719665527344
----------------------check_connections_block total spend ----------------------------- 0.0005085468292236328
generate_one_block  0.0014984607696533203
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005512237548828125
gen group dst list time:  2.2172927856445312e-05
time for parepare:  0.0002760887145996094
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  0.00015234947204589844
r_  generation:  0.0012083053588867188
----------------------check_connections_block total spend ----------------------------- 0.002259492874145508
generate_one_block  0.0027627944946289062
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010416507720947266
gen group dst list time:  6.341934204101562e-05
time for parepare:  0.0007810592651367188
local_output_nid generation:  0.0001842975616455078
local_in_edges_tensor generation:  0.000537872314453125
mini_batch_src_global generation:  0.0006647109985351562
r_  generation:  0.0071561336517333984
----------------------check_connections_block total spend ----------------------------- 0.011205434799194336
generate_one_block  0.009935140609741211
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0015857219696044922
gen group dst list time:  0.0001518726348876953
time for parepare:  0.0013570785522460938
local_output_nid generation:  0.0005464553833007812
local_in_edges_tensor generation:  0.0012516975402832031
mini_batch_src_global generation:  0.001676797866821289
r_  generation:  0.018917560577392578
----------------------check_connections_block total spend ----------------------------- 0.02902817726135254
generate_one_block  0.023409605026245117
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001903533935546875
gen group dst list time:  0.0003185272216796875
time for parepare:  0.0015316009521484375
local_output_nid generation:  0.0011103153228759766
local_in_edges_tensor generation:  0.002313852310180664
mini_batch_src_global generation:  0.002179861068725586
r_  generation: Using backend: pytorch
 0.026143312454223633
----------------------check_connections_block total spend ----------------------------- 0.040192604064941406
generate_one_block  0.03052997589111328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021462440490722656
gen group dst list time:  0.00041604042053222656
time for parepare:  0.0015723705291748047
local_output_nid generation:  0.0012726783752441406
local_in_edges_tensor generation:  0.0026006698608398438
mini_batch_src_global generation:  0.002032756805419922
r_  generation:  0.027163982391357422
----------------------check_connections_block total spend ----------------------------- 0.04159212112426758
generate_one_block  0.0309603214263916
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5526123046875 GB
    Memory Allocated: 0.05482912063598633  GigaBytes
Max Memory Allocated: 0.21799421310424805  GigaBytes

connection checking time:  0.12427783012390137
block generation total time  0.09759783744812012
average batch blocks generation time:  0.09759783744812012
block dataloader generation time/epoch 0.2675015926361084
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.05067729949951172  GigaBytes
Max Memory Allocated: 0.21799421310424805  GigaBytes

torch.Size([19525, 500])
torch.Size([18754, 256])
torch.Size([16378, 256])
torch.Size([8103, 256])
torch.Size([2589, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.22236967086791992  GigaBytes
Max Memory Allocated: 0.22368621826171875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014383316040039062 |0.001992940902709961 |0.007868766784667969 |0.00014090538024902344 |0.013367891311645508 |0.006135225296020508 |
----------------------------------------------------------pseudo_mini_loss sum 1.6671576499938965
Total (block generation + training)time/epoch 0.3138613700866699
Training time/epoch 0.04586911201477051
Training time without block to device /epoch 0.04387617111206055
Training time without total dataloading part /epoch 0.027512788772583008
load block tensor time/epoch 0.014383316040039062
block to device time/epoch 0.001992940902709961
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.1920928955078125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  65703
Number of first layer input nodes during this epoch:  19525
