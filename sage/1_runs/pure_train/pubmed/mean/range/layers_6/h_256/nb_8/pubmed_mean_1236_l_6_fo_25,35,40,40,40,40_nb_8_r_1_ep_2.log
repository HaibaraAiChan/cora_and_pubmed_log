main start at this time 1648533642.7234643
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002933979034423828  GigaBytes
Max Memory Allocated: 0.002933979034423828  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005280971527099609
range selection method range initialization spend 7.224082946777344e-05
time for parepare:  4.458427429199219e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.0009024143218994141
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6702880859375e-05
----------------------check_connections_block total spend ----------------------------- 0.0019369125366210938
generate_one_block  0.0016710758209228516
generate_one_block  0.0010492801666259766
generate_one_block  0.0010409355163574219
generate_one_block  0.0010223388671875
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005266666412353516
gen group dst list time:  3.314018249511719e-05
time for parepare:  0.00023555755615234375
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0003635883331298828
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.00042700767517089844
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00028252601623535156
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0002071857452392578
----------------------check_connections_block total spend ----------------------------- 0.002701997756958008
generate_one_block  0.0014379024505615234
generate_one_block  0.0016026496887207031
generate_one_block  0.0013649463653564453
generate_one_block  0.0012545585632324219
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010898113250732422
gen group dst list time:  6.937980651855469e-05
time for parepare:  0.000732421875
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.00031256675720214844
mini_batch_src_global generation:  0.00016927719116210938
r_  generation:  0.001997232437133789
local_output_nid generation:  6.532669067382812e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.0004086494445800781
r_  generation:  0.0029680728912353516
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  0.0002040863037109375
r_  generation:  0.0016236305236816406
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00014495849609375
r_  generation:  0.0013098716735839844
----------------------check_connections_block total spend ----------------------------- 0.012781620025634766
generate_one_block  0.003710031509399414
generate_one_block  0.007979154586791992
generate_one_block  0.003150463104248047
generate_one_block  0.002690553665161133
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0049016475677490234
gen group dst list time:  0.00022339820861816406
time for parepare:  0.001722097396850586
local_output_nid generation:  0.0002524852752685547
local_in_edges_tensor generation:  0.0008707046508789062
mini_batch_src_global generation:  0.0010945796966552734
r_  generation:  0.009516716003417969
local_output_nid generation:  0.0002560615539550781
local_in_edges_tensor generation:  0.0011525154113769531
mini_batch_src_global generation:  0.0010929107666015625
r_  generation:  0.009656906127929688
local_output_nid generation:  0.00021529197692871094
local_in_edges_tensor generation:  0.0005030632019042969
mini_batch_src_global generation:  0.0008144378662109375
r_  generation:  0.007991313934326172
local_output_nid generation:  0.0001780986785888672
local_in_edges_tensor generation:  0.0004315376281738281
mini_batch_src_global generation:  0.0006787776947021484
r_  generation:  0.00655817985534668
----------------------check_connections_block total spend ----------------------------- 0.051393985748291016
generate_one_block  0.012795448303222656
generate_one_block  0.012948751449584961
generate_one_block  0.01168513298034668
generate_one_block  0.010022401809692383
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002331972122192383
gen group dst list time:  0.0007548332214355469
time for parepare:  0.0016434192657470703
local_output_nid generation:  0.0008182525634765625
local_in_edges_tensor generation:  0.0021076202392578125
mini_batch_src_global generation:  0.002088308334350586
r_  generation:  0.020534753799438477
local_output_nid generation:  0.0007870197296142578
local_in_edges_tensor generation:  0.0018286705017089844
mini_batch_src_global generation:  0.002165079116821289
r_  generation:  0.018614768981933594
local_output_nid generation:  0.0010275840759277344
local_in_edges_tensor generation:  0.0015249252319335938
mini_batch_src_global generation:  0.0016112327575683594
r_  generation:  0.01995229721069336
local_output_nid generation:  0.0008213520050048828
local_in_edges_tensor generation:  0.0013403892517089844
mini_batch_src_global generation:  0.0016307830810546875
r_  generation:  0.018018245697021484
----------------------check_connections_block total spend ----------------------------- 0.11407351493835449
generate_one_block  0.02679300308227539
generate_one_block  0.024965524673461914
generate_one_block  0.025935888290405273
generate_one_block  0.024509668350219727
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002124786376953125
gen group dst list time:  0.001377105712890625
time for parepare:  0.0016217231750488281
local_output_nid generation:  0.0013003349304199219
local_in_edges_tensor generation:  0.0026259422302246094
mini_batch_src_global generation:  0.002140045166015625
r_  generation:  0.025396347045898438
local_output_nid generation:  0.0012967586517333984
local_in_edges_tensor generation:  0.0026547908782958984
mini_batch_src_global generation:  0.0025649070739746094
r_  generation:  0.023865461349487305
local_output_nid generation:  0.001554250717163086
local_in_edges_tensor generation:  0.0023469924926757812
mini_batch_src_global generation:  0.0020580291748046875
r_  generation:  0.02531909942626953
local_output_nid generation:  0.0014269351959228516
local_in_edges_tensor generation:  0.002047300338745117
mini_batch_src_global generation:  0.002113819122314453
r_  generation:  0.023787498474121094
----------------------check_connections_block total spend ----------------------------- 0.14477920532226562
generate_one_block  0.03013467788696289
generate_one_block  0.03059244155883789
generate_one_block  0.0305783748626709
generate_one_block  0.02993941307067871
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002933979034423828  GigaBytes
Max Memory Allocated: 0.002933979034423828  GigaBytes

connection checking time:  0.3257303237915039
block generation total time  0.29409098625183105
average batch blocks generation time:  0.07352274656295776
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1229248046875 GB
    Memory Allocated: 0.04002857208251953  GigaBytes
Max Memory Allocated: 0.04002857208251953  GigaBytes

torch.Size([19162, 500])
torch.Size([17333, 256])
torch.Size([11378, 256])
torch.Size([3726, 256])
torch.Size([764, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.16316556930541992  GigaBytes
Max Memory Allocated: 0.16333675384521484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5115966796875 GB
    Memory Allocated: 0.042394161224365234  GigaBytes
Max Memory Allocated: 0.1679401397705078  GigaBytes

torch.Size([18596, 500])
torch.Size([15427, 256])
torch.Size([9879, 256])
torch.Size([3400, 256])
torch.Size([889, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.15051031112670898  GigaBytes
Max Memory Allocated: 0.1679401397705078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.042687416076660156  GigaBytes
Max Memory Allocated: 0.1679401397705078  GigaBytes

torch.Size([19063, 500])
torch.Size([16287, 256])
torch.Size([11233, 256])
torch.Size([2641, 256])
torch.Size([701, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.15422821044921875  GigaBytes
Max Memory Allocated: 0.1679401397705078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.042253971099853516  GigaBytes
Max Memory Allocated: 0.1679401397705078  GigaBytes

torch.Size([18633, 500])
torch.Size([15279, 256])
torch.Size([8919, 256])
torch.Size([2183, 256])
torch.Size([455, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.14051008224487305  GigaBytes
Max Memory Allocated: 0.1679401397705078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016038119792938232 |0.08622747659683228 |0.19694578647613525 |0.00015592575073242188 |0.008277833461761475 |0.0037767887115478516 |
----------------------------------------------------------pseudo_mini_loss sum 3.105128526687622
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  196305
Number of first layer input nodes during this epoch:  75454
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.05085039138793945  GigaBytes
Max Memory Allocated: 0.1679401397705078  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0004756450653076172
range selection method range initialization spend 5.2928924560546875e-05
time for parepare:  4.482269287109375e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.719329833984375e-05
----------------------check_connections_block total spend ----------------------------- 0.0009644031524658203
generate_one_block  0.0011186599731445312
generate_one_block  0.0010366439819335938
generate_one_block  0.0011484622955322266
generate_one_block  0.0010590553283691406
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005235671997070312
gen group dst list time:  3.1948089599609375e-05
time for parepare:  0.00027108192443847656
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0003757476806640625
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00018167495727539062
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.00033736228942871094
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00036597251892089844
----------------------check_connections_block total spend ----------------------------- 0.002751588821411133
generate_one_block  0.0015325546264648438
generate_one_block  0.0012116432189941406
generate_one_block  0.0014183521270751953
generate_one_block  0.001524209976196289
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0009884834289550781
gen group dst list time:  7.963180541992188e-05
time for parepare:  0.0007715225219726562
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.0003457069396972656
mini_batch_src_global generation:  0.00022649765014648438
r_  generation:  0.0021393299102783203
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.00017261505126953125
r_  generation:  0.0012445449829101562
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.00022602081298828125
mini_batch_src_global generation:  0.00022101402282714844
r_  generation:  0.0022864341735839844
local_output_nid generation:  7.653236389160156e-05
local_in_edges_tensor generation:  0.0002396106719970703
mini_batch_src_global generation:  0.000286102294921875
r_  generation:  0.002648591995239258
----------------------check_connections_block total spend ----------------------------- 0.013412952423095703
generate_one_block  0.0045053958892822266
generate_one_block  0.002427816390991211
generate_one_block  0.0037424564361572266
generate_one_block  0.0042264461517333984
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001821279525756836
gen group dst list time:  0.0002269744873046875
time for parepare:  0.0013155937194824219
local_output_nid generation:  0.00024819374084472656
local_in_edges_tensor generation:  0.0008809566497802734
mini_batch_src_global generation:  0.0008385181427001953
r_  generation:  0.009243965148925781
local_output_nid generation:  0.0001735687255859375
local_in_edges_tensor generation:  0.0005803108215332031
mini_batch_src_global generation:  0.0007150173187255859
r_  generation:  0.006495952606201172
local_output_nid generation:  0.00020384788513183594
local_in_edges_tensor generation:  0.0004591941833496094
mini_batch_src_global generation:  0.0008533000946044922
r_  generation:  0.0077288150787353516Using backend: pytorch

local_output_nid generation:  0.0003039836883544922
local_in_edges_tensor generation:  0.0008466243743896484
mini_batch_src_global generation:  0.0012121200561523438
r_  generation:  0.01177072525024414
----------------------check_connections_block total spend ----------------------------- 0.052639007568359375
generate_one_block  0.013676881790161133
generate_one_block  0.009356498718261719
generate_one_block  0.011156082153320312
generate_one_block  0.01587510108947754
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002054452896118164
gen group dst list time:  0.0007650852203369141
time for parepare:  0.0014719963073730469
local_output_nid generation:  0.0008864402770996094
local_in_edges_tensor generation:  0.002064228057861328
mini_batch_src_global generation:  0.001750946044921875
r_  generation:  0.02055835723876953
local_output_nid generation:  0.0007429122924804688
local_in_edges_tensor generation:  0.0015861988067626953
mini_batch_src_global generation:  0.0020287036895751953
r_  generation:  0.01708221435546875
local_output_nid generation:  0.0007948875427246094
local_in_edges_tensor generation:  0.001300811767578125
mini_batch_src_global generation:  0.001363992691040039
r_  generation:  0.01707315444946289
local_output_nid generation:  0.0011920928955078125
local_in_edges_tensor generation:  0.0018761157989501953
mini_batch_src_global generation:  0.002132415771484375
r_  generation:  0.021495819091796875
----------------------check_connections_block total spend ----------------------------- 0.11415410041809082
generate_one_block  0.02577376365661621
generate_one_block  0.023363828659057617
generate_one_block  0.022243976593017578
generate_one_block  0.029279232025146484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.003919363021850586
gen group dst list time:  0.0012831687927246094
time for parepare:  0.001644134521484375
local_output_nid generation:  0.0013401508331298828
local_in_edges_tensor generation:  0.0026454925537109375
mini_batch_src_global generation:  0.0019958019256591797
r_  generation:  0.02554464340209961
local_output_nid generation:  0.001336812973022461
local_in_edges_tensor generation:  0.002528667449951172
mini_batch_src_global generation:  0.0025904178619384766
r_  generation:  0.02382683753967285
local_output_nid generation:  0.0014255046844482422
local_in_edges_tensor generation:  0.002241849899291992
mini_batch_src_global generation:  0.0018172264099121094
r_  generation:  0.023801565170288086
local_output_nid generation:  0.0016505718231201172
local_in_edges_tensor generation:  0.0024547576904296875
mini_batch_src_global generation:  0.002005338668823242
r_  generation:  0.025568246841430664
----------------------check_connections_block total spend ----------------------------- 0.14576172828674316
generate_one_block  0.03029036521911621
generate_one_block  0.03040599822998047
generate_one_block  0.029248476028442383
generate_one_block  0.03098583221435547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.05085039138793945  GigaBytes
Max Memory Allocated: 0.1679401397705078  GigaBytes

connection checking time:  0.3287193775177002
block generation total time  0.29224491119384766
average batch blocks generation time:  0.07306122779846191
block dataloader generation time/epoch 0.6718337535858154
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.04874610900878906  GigaBytes
Max Memory Allocated: 0.1679401397705078  GigaBytes

torch.Size([19149, 500])
torch.Size([17099, 256])
torch.Size([11116, 256])
torch.Size([3605, 256])
torch.Size([813, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.16811704635620117  GigaBytes
Max Memory Allocated: 0.1684408187866211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.04804563522338867  GigaBytes
Max Memory Allocated: 0.17133188247680664  GigaBytes

torch.Size([18612, 500])
torch.Size([14673, 256])
torch.Size([8284, 256])
torch.Size([2059, 256])
torch.Size([425, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.13887691497802734  GigaBytes
Max Memory Allocated: 0.17133188247680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.04716825485229492  GigaBytes
Max Memory Allocated: 0.17133188247680664  GigaBytes

torch.Size([18369, 500])
torch.Size([14481, 256])
torch.Size([8554, 256])
torch.Size([2717, 256])
torch.Size([704, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.1451263427734375  GigaBytes
Max Memory Allocated: 0.17133188247680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.048750877380371094  GigaBytes
Max Memory Allocated: 0.17133188247680664  GigaBytes

torch.Size([19092, 500])
torch.Size([16651, 256])
torch.Size([12353, 256])
torch.Size([3888, 256])
torch.Size([913, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.17306089401245117  GigaBytes
Max Memory Allocated: 0.17353582382202148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014371156692504883 |0.0019066333770751953 |0.007074177265167236 |0.00014024972915649414 |0.005305826663970947 |0.0062410831451416016 |
----------------------------------------------------------pseudo_mini_loss sum 1.9550050497055054
Total (block generation + training)time/epoch 0.8001368045806885
Training time/epoch 0.12792444229125977
Training time without block to device /epoch 0.12029790878295898
Training time without total dataloading part /epoch 0.05632209777832031
load block tensor time/epoch 0.05748462677001953
block to device time/epoch 0.007626533508300781
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  193914
Number of first layer input nodes during this epoch:  75222
