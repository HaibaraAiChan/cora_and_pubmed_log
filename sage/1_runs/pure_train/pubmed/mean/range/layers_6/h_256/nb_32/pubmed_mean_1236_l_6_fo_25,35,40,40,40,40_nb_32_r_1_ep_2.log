main start at this time 1648533665.8695943
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002933979034423828  GigaBytes
Max Memory Allocated: 0.002933979034423828  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0012810230255126953
range selection method range initialization spend 8.726119995117188e-05
time for parepare:  4.863739013671875e-05
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0012161731719970703
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.3828277587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.004096508026123047
generate_one_block  0.0017440319061279297
generate_one_block  0.001085519790649414
generate_one_block  0.001058340072631836
generate_one_block  0.0010843276977539062
generate_one_block  0.00102996826171875
generate_one_block  0.0010311603546142578
generate_one_block  0.001054525375366211
generate_one_block  0.0010495185852050781
generate_one_block  0.001035928726196289
generate_one_block  0.0009832382202148438
generate_one_block  0.0009760856628417969
generate_one_block  0.00098419189453125
generate_one_block  0.0009374618530273438
generate_one_block  0.0009577274322509766
generate_one_block  0.0009517669677734375
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0008959770202636719
gen group dst list time:  8.296966552734375e-05
time for parepare:  0.00027871131896972656
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00013256072998046875
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001571178436279297
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  8.7738037109375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00020360946655273438
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0002601146697998047
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00012564659118652344
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.724761962890625e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.604194641113281e-05
----------------------check_connections_block total spend ----------------------------- 0.004728794097900391
generate_one_block  0.001207590103149414
generate_one_block  0.001245260238647461
generate_one_block  0.0011904239654541016
generate_one_block  0.001127004623413086
generate_one_block  0.0010907649993896484
generate_one_block  0.0011167526245117188
generate_one_block  0.0013275146484375
generate_one_block  0.0013899803161621094
generate_one_block  0.0011928081512451172
generate_one_block  0.0010685920715332031
generate_one_block  0.0010280609130859375
generate_one_block  0.0011377334594726562
generate_one_block  0.0009922981262207031
generate_one_block  0.0010454654693603516
generate_one_block  0.001024007797241211
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001209259033203125
gen group dst list time:  0.00012612342834472656
time for parepare:  0.000762939453125
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00024890899658203125
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.000476837158203125
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.0009584426879882812
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  8.463859558105469e-05
r_  generation:  0.0006110668182373047
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0003559589385986328
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.0002536773681640625
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0003185272216796875
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.00015854835510253906
r_  generation:  0.0016982555389404297
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.0002655982971191406
r_  generation:  0.0020151138305664062
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.0007202625274658203
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0001614093780517578
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00030732154846191406
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0003838539123535156
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00017499923706054688
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0004591941833496094
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0005438327789306641
----------------------check_connections_block total spend ----------------------------- 0.016767263412475586
generate_one_block  0.0017676353454589844
generate_one_block  0.002175569534301758
generate_one_block  0.0016875267028808594
generate_one_block  0.0013442039489746094
generate_one_block  0.0012161731719970703
generate_one_block  0.0012860298156738281
generate_one_block  0.0031397342681884766
generate_one_block  0.0033288002014160156
generate_one_block  0.0016939640045166016
generate_one_block  0.0014052391052246094
generate_one_block  0.0012960433959960938
generate_one_block  0.0013742446899414062
generate_one_block  0.001138448715209961
generate_one_block  0.0014545917510986328
generate_one_block  0.0015921592712402344
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018181800842285156
gen group dst list time:  0.0003161430358886719
time for parepare:  0.001680135726928711
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.0004944801330566406
mini_batch_src_global generation:  0.0002694129943847656
r_  generation:  0.0022230148315429688
local_output_nid generation:  0.00013589859008789062
local_in_edges_tensor generation:  0.0003688335418701172
mini_batch_src_global generation:  0.0006744861602783203
r_  generation:  0.0054590702056884766
local_output_nid generation:  0.00012111663818359375
local_in_edges_tensor generation:  0.0003237724304199219
mini_batch_src_global generation:  0.00042176246643066406
r_  generation:  0.003950834274291992
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  0.0002589225769042969
r_  generation:  0.0022754669189453125
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.00016999244689941406
r_  generation:  0.0012629032135009766
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.00019121170043945312
r_  generation:  0.0018472671508789062
local_output_nid generation:  0.0001773834228515625
local_in_edges_tensor generation:  0.0004246234893798828
mini_batch_src_global generation:  0.000637054443359375
r_  generation:  0.007033348083496094
local_output_nid generation:  0.0001983642578125
local_in_edges_tensor generation:  0.0005028247833251953
mini_batch_src_global generation:  0.0010678768157958984
r_  generation:  0.008097171783447266
local_output_nid generation:  0.00010013580322265625
local_in_edges_tensor generation:  0.0002715587615966797
mini_batch_src_global generation:  0.0004868507385253906
r_  generation:  0.003873586654663086
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  0.0001499652862548828
r_  generation:  0.0005686283111572266
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.0001685619354248047
r_  generation:  0.0019121170043945312
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  0.00019121170043945312
r_  generation:  0.0017719268798828125
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.001256704330444336
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.00024890899658203125
mini_batch_src_global generation:  0.00025081634521484375
r_  generation:  0.0026099681854248047
local_output_nid generation:  7.700920104980469e-05
local_in_edges_tensor generation:  0.0002391338348388672
mini_batch_src_global generation:  0.00033283233642578125
r_  generation:  0.003199338912963867
----------------------check_connections_block total spend ----------------------------- 0.07201910018920898
generate_one_block  0.003988742828369141
generate_one_block  0.0078887939453125
generate_one_block  0.005656003952026367
generate_one_block  0.0035851001739501953
generate_one_block  0.0029060840606689453
generate_one_block  0.003528118133544922
generate_one_block  0.010053873062133789
generate_one_block  0.012397289276123047
generate_one_block  0.00611114501953125
generate_one_block  0.0015423297882080078
generate_one_block  0.003415822982788086
generate_one_block  0.003196239471435547
generate_one_block  0.0026133060455322266
generate_one_block  0.004445791244506836
generate_one_block  0.005087614059448242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002195596694946289
gen group dst list time:  0.0017118453979492188
time for parepare:  0.0018334388732910156
local_output_nid generation:  0.0003743171691894531
local_in_edges_tensor generation:  0.0011496543884277344
mini_batch_src_global generation:  0.0010540485382080078
r_  generation:  0.009222030639648438
local_output_nid generation:  0.0006515979766845703
local_in_edges_tensor generation:  0.001613616943359375
mini_batch_src_global generation:  0.0018203258514404297
r_  generation:  0.01632976531982422
local_output_nid generation:  0.0004878044128417969
local_in_edges_tensor generation:  0.0008912086486816406
mini_batch_src_global generation:  0.0012025833129882812
r_  generation:  0.012758970260620117
local_output_nid generation:  0.0003781318664550781
local_in_edges_tensor generation:  0.0006108283996582031
mini_batch_src_global generation:  0.0009944438934326172
r_  generation:  0.008735179901123047
local_output_nid generation:  0.00025343894958496094
local_in_edges_tensor generation:  0.00041413307189941406
mini_batch_src_global generation:  0.0005648136138916016
r_  generation:  0.005075216293334961
local_output_nid generation:  0.00037479400634765625
local_in_edges_tensor generation:  0.0005984306335449219
mini_batch_src_global generation:  0.0007226467132568359
r_  generation:  0.008692264556884766
local_output_nid generation:  0.0006613731384277344
local_in_edges_tensor generation:  0.0011510848999023438
mini_batch_src_global generation:  0.0013644695281982422
r_  generation:  0.016495466232299805
local_output_nid generation:  0.0009758472442626953
local_in_edges_tensor generation:  0.0017535686492919922
mini_batch_src_global generation:  0.0017523765563964844
r_  generation:  0.019405364990234375
local_output_nid generation:  0.0006551742553710938
local_in_edges_tensor generation:  0.0009093284606933594
mini_batch_src_global generation:  0.0012841224670410156
r_  generation:  0.014434099197387695
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.00027060508728027344
mini_batch_src_global generation:  0.00055694580078125
r_  generation:  0.002584218978881836
local_output_nid generation:  0.0003154277801513672
local_in_edges_tensor generation:  0.0005815029144287109
mini_batch_src_global generation:  0.0006468296051025391
r_  generation:  0.007889986038208008
local_output_nid generation:  0.00029087066650390625
local_in_edges_tensor generation:  0.00047469139099121094
mini_batch_src_global generation:  0.0006356239318847656
r_  generation:  0.006285190582275391
local_output_nid generation:  0.00029468536376953125
local_in_edges_tensor generation:  0.0004994869232177734
mini_batch_src_global generation:  0.0005702972412109375
r_  generation:  0.005484342575073242
local_output_nid generation:  0.0004343986511230469
local_in_edges_tensor generation:  0.0006651878356933594
mini_batch_src_global generation:  0.0009531974792480469
r_  generation:  0.012086629867553711
local_output_nid generation:  0.00033545494079589844
local_in_edges_tensor generation:  0.0006475448608398438
mini_batch_src_global generation:  0.0010709762573242188
r_  generation:  0.008674860000610352
----------------------check_connections_block total spend ----------------------------- 0.22711730003356934
generate_one_block  0.012722253799438477
generate_one_block  0.02271866798400879
generate_one_block  0.017525911331176758
generate_one_block  0.01383352279663086
generate_one_block  0.007581949234008789
generate_one_block  0.011717796325683594
generate_one_block  0.020648956298828125
generate_one_block  0.025943994522094727
generate_one_block  0.0184171199798584
generate_one_block  0.004433631896972656
generate_one_block  0.01228022575378418
generate_one_block  0.00855565071105957
generate_one_block  0.007889986038208008
generate_one_block  0.015380382537841797
generate_one_block  0.01302027702331543
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018978118896484375
gen group dst list time:  0.004372835159301758
time for parepare:  0.0018341541290283203
local_output_nid generation:  0.001041412353515625
local_in_edges_tensor generation:  0.0019817352294921875
mini_batch_src_global generation:  0.0018932819366455078
r_  generation:  0.02026200294494629
local_output_nid generation:  0.0012998580932617188
local_in_edges_tensor generation:  0.0025441646575927734
mini_batch_src_global generation:  0.0027952194213867188
r_  generation:  0.023941516876220703
local_output_nid generation:  0.0013813972473144531
local_in_edges_tensor generation:  0.0021305084228515625
mini_batch_src_global generation:  0.0019505023956298828
r_  generation:  0.022688627243041992
local_output_nid generation:  0.0011255741119384766
local_in_edges_tensor generation:  0.001360177993774414
mini_batch_src_global generation:  0.001589059829711914
r_  generation:  0.019971847534179688
local_output_nid generation:  0.000782012939453125
local_in_edges_tensor generation:  0.0009713172912597656
mini_batch_src_global generation:  0.0013353824615478516
r_  generation:  0.015086889266967773
local_output_nid generation:  0.000911712646484375
local_in_edges_tensor generation:  0.0011849403381347656
mini_batch_src_global generation:  0.0014352798461914062
r_  generation:  0.018815279006958008
local_output_nid generation:  0.0011963844299316406
local_in_edges_tensor generation:  0.002053499221801758
mini_batch_src_global generation:  0.0020728111267089844
r_  generation:  0.023154020309448242
local_output_nid generation:  0.0013966560363769531
local_in_edges_tensor generation:  0.002640962600708008
mini_batch_src_global generation:  0.0019729137420654297
r_  generation:  0.024724483489990234
local_output_nid generation:  0.0013594627380371094
local_in_edges_tensor generation:  0.0016295909881591797
mini_batch_src_global generation:  0.0018286705017089844
r_  generation:  0.022553443908691406
local_output_nid generation:  0.0004448890686035156
local_in_edges_tensor generation:  0.0006821155548095703
mini_batch_src_global generation:  0.000978231430053711
r_  generation:  0.008153915405273438
local_output_nid generation:  0.0008978843688964844
local_in_edges_tensor generation:  0.0012221336364746094
mini_batch_src_global generation:  0.0012814998626708984
r_  generation:  0.018572330474853516
local_output_nid generation:  0.0008072853088378906
local_in_edges_tensor generation:  0.0011196136474609375
mini_batch_src_global generation:  0.0013320446014404297
r_  generation:  0.0157320499420166
local_output_nid generation:  0.0006914138793945312
local_in_edges_tensor generation:  0.0009930133819580078
mini_batch_src_global generation:  0.0012481212615966797
r_  generation:  0.01510930061340332
local_output_nid generation:  0.0010738372802734375
local_in_edges_tensor generation:  0.0015769004821777344
mini_batch_src_global generation:  0.0016834735870361328
r_  generation:  0.021460533142089844
local_output_nid generation:  0.0006742477416992188
local_in_edges_tensor generation:  0.001155853271484375
mini_batch_src_global generation:  0.001352071762084961
r_  generation:  0.015289545059204102
----------------------check_connections_block total spend ----------------------------- 0.41300487518310547
generate_one_block  0.026070833206176758
generate_one_block  0.03128552436828613
generate_one_block  0.027622222900390625
generate_one_block  0.02547740936279297
generate_one_block  0.019836902618408203
generate_one_block  0.024353504180908203
generate_one_block  0.028989315032958984
generate_one_block  0.031057119369506836
generate_one_block  0.028180360794067383
generate_one_block  0.012401342391967773
generate_one_block  0.022160053253173828
generate_one_block  0.023724079132080078
generate_one_block  0.020135879516601562
generate_one_block  0.02843928337097168
generate_one_block  0.01959848403930664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002933979034423828  GigaBytes
Max Memory Allocated: 0.002933979034423828  GigaBytes

connection checking time:  0.7336373329162598
block generation total time  0.7015035152435303
average batch blocks generation time:  0.04676690101623535
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.035742759704589844  GigaBytes
Max Memory Allocated: 0.035742759704589844  GigaBytes

torch.Size([17200, 500])
torch.Size([10790, 256])
torch.Size([4003, 256])
torch.Size([885, 256])
torch.Size([193, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.09116029739379883  GigaBytes
Max Memory Allocated: 0.09121131896972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.042127132415771484  GigaBytes
Max Memory Allocated: 0.0966653823852539  GigaBytes

torch.Size([18464, 500])
torch.Size([14364, 256])
torch.Size([7397, 256])
torch.Size([1688, 256])
torch.Size([326, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.126708984375  GigaBytes
Max Memory Allocated: 0.12685251235961914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.0399928092956543  GigaBytes
Max Memory Allocated: 0.13268280029296875  GigaBytes

torch.Size([17471, 500])
torch.Size([12862, 256])
torch.Size([5233, 256])
torch.Size([1377, 256])
torch.Size([170, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.10999059677124023  GigaBytes
Max Memory Allocated: 0.13268280029296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.036937713623046875  GigaBytes
Max Memory Allocated: 0.13268280029296875  GigaBytes

torch.Size([16270, 500])
torch.Size([10160, 256])
torch.Size([3410, 256])
torch.Size([601, 256])
torch.Size([115, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.08611869812011719  GigaBytes
Max Memory Allocated: 0.13268280029296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.03380441665649414  GigaBytes
Max Memory Allocated: 0.13268280029296875  GigaBytes

torch.Size([14724, 500])
torch.Size([7217, 256])
torch.Size([2478, 256])
torch.Size([375, 256])
torch.Size([107, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.06893539428710938  GigaBytes
Max Memory Allocated: 0.13268280029296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.037138938903808594  GigaBytes
Max Memory Allocated: 0.13268280029296875  GigaBytes

torch.Size([16397, 500])
torch.Size([9222, 256])
torch.Size([3654, 256])
torch.Size([506, 256])
torch.Size([144, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.08479881286621094  GigaBytes
Max Memory Allocated: 0.13268280029296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.0402379035949707  GigaBytes
Max Memory Allocated: 0.13268280029296875  GigaBytes

torch.Size([17670, 500])
torch.Size([13740, 256])
torch.Size([7098, 256])
torch.Size([2439, 256])
torch.Size([404, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.12496042251586914  GigaBytes
Max Memory Allocated: 0.13268280029296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.04233217239379883  GigaBytes
Max Memory Allocated: 0.13268280029296875  GigaBytes

torch.Size([18751, 500])
torch.Size([15052, 256])
torch.Size([10282, 256])
torch.Size([2427, 256])
torch.Size([540, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.14664268493652344  GigaBytes
Max Memory Allocated: 0.14695501327514648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.040607452392578125  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([18129, 500])
torch.Size([12531, 256])
torch.Size([6668, 256])
torch.Size([1061, 256])
torch.Size([290, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.1134185791015625  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.025668621063232422  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([10072, 500])
torch.Size([4243, 256])
torch.Size([935, 256])
torch.Size([211, 256])
torch.Size([66, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.044119834899902344  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.03509330749511719  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([15315, 500])
torch.Size([9154, 256])
torch.Size([3049, 256])
torch.Size([574, 256])
torch.Size([95, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.0803828239440918  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.03429365158081055  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([14956, 500])
torch.Size([7635, 256])
torch.Size([2952, 256])
torch.Size([572, 256])
torch.Size([127, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.07352209091186523  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.03444337844848633  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([15063, 500])
torch.Size([7242, 256])
torch.Size([2828, 256])
torch.Size([346, 256])
torch.Size([75, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.07110786437988281  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.03844785690307617  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([17024, 500])
torch.Size([11703, 256])
torch.Size([4447, 256])
torch.Size([823, 256])
torch.Size([140, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.10007333755493164  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.030010223388671875  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([12598, 500])
torch.Size([7205, 256])
torch.Size([3378, 256])
torch.Size([876, 256])
torch.Size([135, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.07097530364990234  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012704229354858399 |0.024090003967285157 |0.05924526850382487 |0.0001453399658203125 |0.006308523813883463 |0.008223533630371094 |
----------------------------------------------------------pseudo_mini_loss sum 3.0314531326293945
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  479081
Number of first layer input nodes during this epoch:  240104
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5115966796875 GB
    Memory Allocated: 0.03736448287963867  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0004892349243164062
range selection method range initialization spend 5.221366882324219e-05
time for parepare:  4.982948303222656e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4543533325195312e-05
----------------------check_connections_block total spend ----------------------------- 0.0027010440826416016
generate_one_block  0.0013968944549560547
generate_one_block  0.0009984970092773438
generate_one_block  0.0009915828704833984
generate_one_block  0.0009932518005371094
generate_one_block  0.0009875297546386719
generate_one_block  0.0009839534759521484
generate_one_block  0.0010204315185546875
generate_one_block  0.0010025501251220703
generate_one_block  0.0009915828704833984
generate_one_block  0.0009949207305908203
generate_one_block  0.0009517669677734375
generate_one_block  0.0009601116180419922
generate_one_block  0.0009438991546630859
generate_one_block  0.0009539127349853516
generate_one_block  0.0010037422180175781
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006206035614013672
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.0002689361572265625
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00023865699768066406
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  6.890296936035156e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  9.5367431640625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.1975250244140625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00019407272338867188
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.319450378417969e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0002276897430419922
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.341934204101562e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  6.985664367675781e-05
----------------------check_connections_block total spend ----------------------------- 0.004679441452026367
generate_one_block  0.0012814998626708984
generate_one_block  0.001056671142578125
generate_one_block  0.0010828971862792969
generate_one_block  0.0010459423065185547
generate_one_block  0.0010876655578613281
generate_one_block  0.0010752677917480469
generate_one_block  0.0010409355163574219
generate_one_block  0.0010578632354736328
generate_one_block  0.0010557174682617188
generate_one_block  0.0011758804321289062
generate_one_block  0.0010216236114501953
generate_one_block  0.0016837120056152344
generate_one_block  0.0009984970092773438
generate_one_block  0.0010886192321777344
generate_one_block  0.0010685920715332031
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011706352233886719
gen group dst list time:  0.00012922286987304688
time for parepare:  0.0008182525634765625
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.0003330707550048828
mini_batch_src_global generation:  0.0001881122589111328
r_  generation:  0.001390695571899414
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0003108978271484375
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00045108795166015625
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00024271011352539062
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.000560760498046875
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0003387928009033203
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00026607513427734375
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00033736228942871094
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00020623207092285156
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.0014996528625488281
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0005459785461425781
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  0.0001671314239501953
r_  generation:  0.001836538314819336
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  9.274482727050781e-05
r_  generation:  0.00039076805114746094
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00035572052001953125
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0003566741943359375
----------------------check_connections_block total spend ----------------------------- 0.016503572463989258
generate_one_block  0.0029189586639404297
generate_one_block  0.0012624263763427734
generate_one_block  0.0015099048614501953
generate_one_block  0.0012242794036865234
generate_one_block  0.0016529560089111328
generate_one_block  0.001325368881225586
generate_one_block  0.0012700557708740234
generate_one_block  0.002462148666381836
generate_one_block  0.0012853145599365234
generate_one_block  0.002698183059692383
generate_one_block  0.0015807151794433594
generate_one_block  0.0034317970275878906
generate_one_block  0.0014178752899169922
generate_one_block  0.0013437271118164062
generate_one_block  0.0013539791107177734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020160675048828125
gen group dst list time:  0.00033473968505859375
time for parepare:  0.0015404224395751953
local_output_nid generation:  0.00020742416381835938
local_in_edges_tensor generation:  0.0007076263427734375
mini_batch_src_global generation:  0.0006213188171386719
r_  generation:  0.006319522857666016
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.0002911090850830078
r_  generation:  0.0017039775848388672
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  0.00025343894958496094
r_  generation:  0.002603769302368164
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  0.0001804828643798828
r_  generation:  0.0013043880462646484
local_output_nid generation:  0.00010728836059570312
local_in_edges_tensor generation:  0.00030684471130371094
mini_batch_src_global generation:  0.0003724098205566406
r_  generation:  0.004094362258911133
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  0.00024771690368652344
r_  generation:  0.0016014575958251953
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.00021028518676757812
r_  generation:  0.0018985271453857422
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.0002181529998779297
r_  generation:  0.0019240379333496094
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.0007970333099365234
local_output_nid generation:  0.00013828277587890625
local_in_edges_tensor generation:  0.000335693359375
mini_batch_src_global generation:  0.0004508495330810547
r_  generation:  0.005484342575073242
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  0.0004062652587890625
r_  generation:  0.003379344940185547
local_output_nid generation:  0.00022721290588378906
local_in_edges_tensor generation:  0.0004904270172119141
mini_batch_src_global generation:  0.0007691383361816406
r_  generation:  0.008148193359375
local_output_nid generation:  8.7738037109375e-05
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  0.00045013427734375
r_  generation:  0.00302886962890625
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.0019314289093017578
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.00023436546325683594
r_  generation:  0.0021681785583496094
----------------------check_connections_block total spend ----------------------------- 0.07029604911804199
generate_one_block  0.009246349334716797
generate_one_block  0.0032088756561279297
generate_one_block  0.00439763069152832
generate_one_block  0.0036983489990234375
generate_one_block  0.006464719772338867
generate_one_block  0.0030336380004882812
generate_one_block  0.0038297176361083984
generate_one_block  0.0035400390625
generate_one_block  0.0019381046295166016
generate_one_block  0.008433818817138672
generate_one_block  0.0054743289947509766
generate_one_block  0.012116193771362305
generate_one_block  0.004765987396240234
generate_one_block  0.003631114959716797
generate_one_block  0.003923177719116211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022912025451660156
gen group dst list time:  0.0014104843139648438
time for parepare:  0.0015881061553955078
local_output_nid generation:  0.0007097721099853516
local_in_edges_tensor generation:  0.0016703605651855469
mini_batch_src_global generation:  0.0014715194702148438
r_  generation:  0.016951322555541992
local_output_nid generation:  0.0003249645233154297
local_in_edges_tensor generation:  0.0006685256958007812
mini_batch_src_global generation:  0.0010366439819335938
r_  generation:  0.0073394775390625
local_output_nid generation:  0.000492095947265625
local_in_edges_tensor generation:  0.0008435249328613281
mini_batch_src_global generation:  0.000926971435546875
r_  generation:  0.010110855102539062
local_output_nid generation:  0.0002605915069580078
local_in_edges_tensor generation:  0.0005259513854980469
mini_batch_src_global generation:  0.0006787776947021484
r_  generation:  0.0063021183013916016
local_output_nid generation:  0.0006308555603027344
local_in_edges_tensor generation:  0.0010242462158203125
mini_batch_src_global generation:  0.001009225845336914
r_  generation:  0.014327526092529297
local_output_nid generation:  0.0002815723419189453
local_in_edges_tensor generation:  0.0004994869232177734
mini_batch_src_global generation:  0.0008065700531005859
r_  generation:  0.006943225860595703
local_output_nid generation:  0.0002257823944091797
local_in_edges_tensor generation:  0.00042510032653808594
mini_batch_src_global generation:  0.0006070137023925781
r_  generation:  0.005860328674316406
local_output_nid generation:  0.0003333091735839844
local_in_edges_tensor generation:  0.0005640983581542969
mini_batch_src_global generation:  0.0007283687591552734
r_  generation:  0.007912158966064453
local_output_nid generation:  0.00016927719116210938
local_in_edges_tensor generation:  0.0003368854522705078
mini_batch_src_global generation:  0.0005278587341308594
r_  generation:  0.004317045211791992
local_output_nid generation:  0.0005452632904052734
local_in_edges_tensor generation:  0.0008213520050048828
mini_batch_src_global generation:  0.0009965896606445312
r_  generation:  0.012921810150146484
local_output_nid generation:  0.00044655799865722656
local_in_edges_tensor generation:  0.0007541179656982422
mini_batch_src_global generation:  0.0009706020355224609
r_  generation:  0.011753559112548828
local_output_nid generation:  0.001070261001586914
local_in_edges_tensor generation:  0.0014252662658691406
mini_batch_src_global generation:  0.0015408992767333984
r_  generation:  0.01915764808654785
local_output_nid generation:  0.0003783702850341797
local_in_edges_tensor generation:  0.0006077289581298828
mini_batch_src_global generation:  0.0011837482452392578
r_  generation:  0.009637117385864258
local_output_nid generation:  0.000431060791015625
local_in_edges_tensor generation:  0.0006182193756103516
mini_batch_src_global generation:  0.0007271766662597656
r_  generation:  0.007044315338134766
local_output_nid generation:  0.0004949569702148438
local_in_edges_tensor generation:  0.0006878376007080078
mini_batch_src_global generation:  0.0007538795471191406
r_  generation:  0.008455038070678711
----------------------check_connections_block total spend ----------------------------- 0.21947336196899414
generate_one_block  0.022109270095825195
generate_one_block  0.011199474334716797
generate_one_block  0.015125036239624023
generate_one_block  0.011066913604736328
generate_one_block  0.018787622451782227
generate_one_block  0.010883092880249023
generate_one_block  0.008734703063964844
generate_one_block  0.011580467224121094
generate_one_block  0.006522417068481445
generate_one_block  0.016646146774291992
generate_one_block  0.015695571899414062
generate_one_block  0.0250551700592041
generate_one_block  0.01340627670288086
generate_one_block  0.009812355041503906
generate_one_block  0.012077569961547852
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021784305572509766
gen group dst list time:  0.004013776779174805
time for parepare:  0.0018253326416015625
local_output_nid generation:  0.001451730728149414
local_in_edges_tensor generation:  0.002820253372192383
mini_batch_src_global generation:  0.0023186206817626953
r_  generation:  0.026543855667114258
local_output_nid generation:  0.0009212493896484375
local_in_edges_tensor generation:  0.0020084381103515625
mini_batch_src_global generation:  0.0022690296173095703
r_  generation:  0.018531322479248047
local_output_nid generation:  0.00116729736328125
local_in_edges_tensor generation:  0.002033710479736328
mini_batch_src_global generation:  0.0016617774963378906
r_  generation:  0.019770145416259766
local_output_nid generation:  0.000993967056274414
local_in_edges_tensor generation:  0.0012760162353515625
mini_batch_src_global generation:  0.0016188621520996094
r_  generation:  0.017311811447143555
local_output_nid generation:  0.0013434886932373047
local_in_edges_tensor generation:  0.0018148422241210938
mini_batch_src_global generation:  0.0018694400787353516
r_  generation:  0.026227474212646484
local_output_nid generation:  0.0011873245239257812
local_in_edges_tensor generation:  0.001710653305053711
mini_batch_src_global generation:  0.002519845962524414
r_  generation:  0.016856670379638672
local_output_nid generation:  0.0006814002990722656
local_in_edges_tensor generation:  0.000885009765625
mini_batch_src_global generation:  0.0010433197021484375
r_  generation:  0.01082754135131836
local_output_nid generation:  0.001196146011352539
local_in_edges_tensor generation:  0.0012359619140625
mini_batch_src_global generation:  0.0012350082397460938
r_  generation:  0.017336606979370117
local_output_nid generation:  0.0007300376892089844
local_in_edges_tensor generation:  0.00103759765625
mini_batch_src_global generation:  0.0013120174407958984
r_  generation:  0.014455556869506836
local_output_nid generation:  0.0015459060668945312
local_in_edges_tensor generation:  0.0021033287048339844
mini_batch_src_global generation:  0.0015974044799804688
r_  generation:  0.02071690559387207
local_output_nid generation:  0.0011289119720458984
local_in_edges_tensor generation:  0.001529693603515625
mini_batch_src_global generation:  0.0016851425170898438
r_  generation:  0.018400192260742188
local_output_nid generation:  0.0018916130065917969
local_in_edges_tensor generation:  0.002513885498046875
mini_batch_src_global generation:  0.002163410186767578
r_  generation:  0.025019168853759766
local_output_nid generation:  0.0009791851043701172
local_in_edges_tensor generation:  0.0012853145599365234
mini_batch_src_global generation:  0.0015342235565185547
r_  generation:  0.016390085220336914
local_output_nid generation:  0.0008671283721923828
local_in_edges_tensor generation:  0.0011420249938964844
mini_batch_src_global generation:  0.0011889934539794922
r_  generation:  0.014453411102294922
local_output_nid generation:  0.0012750625610351562
local_in_edges_tensor generation:  0.0015139579772949219
mini_batch_src_global generation:  0.0015878677368164062
r_  generation:  0.019527196884155273
----------------------check_connections_block total spend ----------------------------- 0.417677640914917
generate_one_block  0.03116893768310547
generate_one_block  0.027228116989135742
generate_one_block  0.0259549617767334
generate_one_block  0.023549318313598633
generate_one_block  0.028725624084472656
generate_one_block  0.022828340530395508
generate_one_block  0.014895915985107422
generate_one_block  0.023421764373779297
generate_one_block  0.019144296646118164
generate_one_block  0.02784252166748047
generate_one_block  0.025035381317138672
generate_one_block  0.030623197555541992
generate_one_block  0.021399736404418945
generate_one_block  0.019191741943359375
generate_one_block  0.025601863861083984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5115966796875 GB
    Memory Allocated: 0.03736448287963867  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

connection checking time:  0.7286300659179688
block generation total time  0.6965749263763428
average batch blocks generation time:  0.04643832842508952
block dataloader generation time/epoch 1.5567114353179932
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5115966796875 GB
    Memory Allocated: 0.04803323745727539  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([18602, 500])
torch.Size([15676, 256])
torch.Size([7985, 256])
torch.Size([2594, 256])
torch.Size([432, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.14445781707763672  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.041758060455322266  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([15773, 500])
torch.Size([8591, 256])
torch.Size([3129, 256])
torch.Size([451, 256])
torch.Size([119, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.08529233932495117  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.04378652572631836  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([16790, 500])
torch.Size([10305, 256])
torch.Size([4561, 256])
torch.Size([729, 256])
torch.Size([189, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.09926223754882812  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.041568756103515625  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([15701, 500])
torch.Size([8527, 256])
torch.Size([2503, 256])
torch.Size([467, 256])
torch.Size([97, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.0812678337097168  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.046011924743652344  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([17875, 500])
torch.Size([12916, 256])
torch.Size([6516, 256])
torch.Size([1160, 256])
torch.Size([189, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.11949014663696289  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.039685726165771484  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([14679, 500])
torch.Size([7653, 256])
torch.Size([2656, 256])
torch.Size([472, 256])
torch.Size([122, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.07742977142333984  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.029840946197509766  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([9476, 500])
torch.Size([4972, 256])
torch.Size([2165, 256])
torch.Size([497, 256])
torch.Size([78, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.05844259262084961  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.04127168655395508  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([15492, 500])
torch.Size([8491, 256])
torch.Size([3247, 256])
torch.Size([545, 256])
torch.Size([129, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.08539676666259766  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.03624296188354492  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([12916, 500])
torch.Size([5956, 256])
torch.Size([1529, 256])
torch.Size([345, 256])
torch.Size([89, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.06336069107055664  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.044316768646240234  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([16964, 500])
torch.Size([11704, 256])
torch.Size([5773, 256])
torch.Size([1663, 256])
torch.Size([363, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.11750459671020508  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.04185152053833008  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([15745, 500])
torch.Size([9552, 256])
torch.Size([4455, 256])
torch.Size([946, 256])
torch.Size([160, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.09585189819335938  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.04818391799926758  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

torch.Size([18742, 500])
torch.Size([15344, 256])
torch.Size([10413, 256])
torch.Size([2642, 256])
torch.Size([555, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.1533832550048828  GigaBytes
Max Memory Allocated: 0.15381717681884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.03664350509643555  GigaBytes
Max Memory Allocated: 0.16042852401733398  GigaBytes
Using backend: pytorch

torch.Size([12999, 500])
torch.Size([8462, 256])
torch.Size([3382, 256])
torch.Size([879, 256])
torch.Size([93, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.08277320861816406  GigaBytes
Max Memory Allocated: 0.16042852401733398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.039119720458984375  GigaBytes
Max Memory Allocated: 0.16042852401733398  GigaBytes

torch.Size([14416, 500])
torch.Size([7580, 256])
torch.Size([3668, 256])
torch.Size([607, 256])
torch.Size([142, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.0814828872680664  GigaBytes
Max Memory Allocated: 0.16042852401733398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.04379844665527344  GigaBytes
Max Memory Allocated: 0.16042852401733398  GigaBytes

torch.Size([16830, 500])
torch.Size([9776, 256])
torch.Size([4323, 256])
torch.Size([601, 256])
torch.Size([161, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.09653902053833008  GigaBytes
Max Memory Allocated: 0.16042852401733398  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010898892084757488 |0.003081528345743815 |0.007581154505411784 |0.00014479955037434897 |0.005311663945515951 |0.0063059329986572266 |
----------------------------------------------------------pseudo_mini_loss sum 2.033585786819458
Total (block generation + training)time/epoch 1.9954783916473389
Training time/epoch 0.4383857250213623
Training time without block to device /epoch 0.3921627998352051
Training time without total dataloading part /epoch 0.20187020301818848
load block tensor time/epoch 0.1634833812713623
block to device time/epoch 0.04622292518615723
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  462683
Number of first layer input nodes during this epoch:  233000
