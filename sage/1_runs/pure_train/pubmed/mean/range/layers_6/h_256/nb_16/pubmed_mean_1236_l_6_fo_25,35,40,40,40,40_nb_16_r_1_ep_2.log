main start at this time 1648533653.3739514
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002933979034423828  GigaBytes
Max Memory Allocated: 0.002933979034423828  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001959085464477539
range selection method range initialization spend 8.0108642578125e-05
time for parepare:  4.220008850097656e-05
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.0013661384582519531
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  8.7738037109375e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.535385131835938e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.440017700195312e-05
mini_batch_src_global generation:  1.239776611328125e-05
r_  generation:  1.2159347534179688e-05
----------------------check_connections_block total spend ----------------------------- 0.002962827682495117
generate_one_block  0.0016629695892333984
generate_one_block  0.000997304916381836
generate_one_block  0.0009660720825195312
generate_one_block  0.0009870529174804688
generate_one_block  0.0009515285491943359
generate_one_block  0.0010204315185546875
generate_one_block  0.0010006427764892578
generate_one_block  0.0009434223175048828
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011470317840576172
gen group dst list time:  4.673004150390625e-05
time for parepare:  0.0002224445343017578
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.0002372264862060547
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00012683868408203125
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  9.369850158691406e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.0003991127014160156
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00014638900756835938
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00010776519775390625
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  9.632110595703125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.91278076171875e-05
----------------------check_connections_block total spend ----------------------------- 0.0031735897064208984
generate_one_block  0.0012717247009277344
generate_one_block  0.0011131763458251953
generate_one_block  0.0010728836059570312
generate_one_block  0.001575469970703125
generate_one_block  0.0011320114135742188
generate_one_block  0.001073598861694336
generate_one_block  0.0010645389556884766
generate_one_block  0.0010247230529785156
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011038780212402344
gen group dst list time:  8.320808410644531e-05
time for parepare:  0.0007228851318359375
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.00028252601623535156
mini_batch_src_global generation:  0.00011277198791503906
r_  generation:  0.0013184547424316406
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  0.00011467933654785156
r_  generation:  0.0008671283721923828
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0004897117614746094
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.00022530555725097656
mini_batch_src_global generation:  0.0002472400665283203
r_  generation:  0.0029380321502685547
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  0.00014352798461914062
r_  generation:  0.0008018016815185547
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0006108283996582031
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0005364418029785156
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0004942417144775391
----------------------check_connections_block total spend ----------------------------- 0.013525962829589844
generate_one_block  0.003030061721801758
generate_one_block  0.0021338462829589844
generate_one_block  0.0015635490417480469
generate_one_block  0.005035400390625
generate_one_block  0.0018312931060791016
generate_one_block  0.0016896724700927734
generate_one_block  0.0016169548034667969
generate_one_block  0.0015659332275390625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019183158874511719
gen group dst list time:  0.00022864341735839844
time for parepare:  0.001407623291015625
local_output_nid generation:  0.00016355514526367188
local_in_edges_tensor generation:  0.0006861686706542969
mini_batch_src_global generation:  0.0007407665252685547
r_  generation:  0.0060770511627197266
local_output_nid generation:  0.00014543533325195312
local_in_edges_tensor generation:  0.0003654956817626953
mini_batch_src_global generation:  0.0006480216979980469
r_  generation:  0.0050542354583740234
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.0002257823944091797
mini_batch_src_global generation:  0.0003383159637451172
r_  generation:  0.0025551319122314453
local_output_nid generation:  0.00026988983154296875
local_in_edges_tensor generation:  0.0005686283111572266
mini_batch_src_global generation:  0.0008175373077392578
r_  generation:  0.01077580451965332
local_output_nid generation:  0.00010633468627929688
local_in_edges_tensor generation:  0.00028824806213378906
mini_batch_src_global generation:  0.0005745887756347656
r_  generation:  0.0042378902435302734
local_output_nid generation:  9.751319885253906e-05
local_in_edges_tensor generation:  0.0002644062042236328
mini_batch_src_global generation:  0.0003726482391357422
r_  generation:  0.003696918487548828
local_output_nid generation:  9.560585021972656e-05
local_in_edges_tensor generation:  0.0002627372741699219
mini_batch_src_global generation:  0.0003638267517089844
r_  generation:  0.0036253929138183594
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.00023603439331054688
mini_batch_src_global generation:  0.00035262107849121094
r_  generation:  0.0031042098999023438
----------------------check_connections_block total spend ----------------------------- 0.05863833427429199
generate_one_block  0.009584188461303711
generate_one_block  0.008309125900268555
generate_one_block  0.004500627517700195
generate_one_block  0.014783620834350586
generate_one_block  0.006608486175537109
generate_one_block  0.0056765079498291016
generate_one_block  0.005836963653564453
generate_one_block  0.004894733428955078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017893314361572266
gen group dst list time:  0.0010533332824707031
time for parepare:  0.0015783309936523438
local_output_nid generation:  0.0006456375122070312
local_in_edges_tensor generation:  0.0018379688262939453
mini_batch_src_global generation:  0.0016140937805175781
r_  generation:  0.016850948333740234
local_output_nid generation:  0.0005848407745361328
local_in_edges_tensor generation:  0.0014884471893310547
mini_batch_src_global generation:  0.0017938613891601562
r_  generation:  0.01495671272277832
local_output_nid generation:  0.0004253387451171875
local_in_edges_tensor generation:  0.0007205009460449219
mini_batch_src_global generation:  0.0008370876312255859
r_  generation:  0.010065793991088867
local_output_nid generation:  0.0008859634399414062
local_in_edges_tensor generation:  0.0014705657958984375
mini_batch_src_global generation:  0.0015783309936523438
r_  generation:  0.019904613494873047
local_output_nid generation:  0.0006277561187744141
local_in_edges_tensor generation:  0.001245260238647461
mini_batch_src_global generation:  0.0013647079467773438
r_  generation:  0.013710498809814453
local_output_nid generation:  0.0004889965057373047
local_in_edges_tensor generation:  0.0007982254028320312
mini_batch_src_global generation:  0.0010364055633544922
r_  generation:  0.012789487838745117
local_output_nid generation:  0.0005886554718017578
local_in_edges_tensor generation:  0.0009834766387939453
mini_batch_src_global generation:  0.0010883808135986328
r_  generation:  0.013958215713500977
local_output_nid generation:  0.00029087066650390625
local_in_edges_tensor generation:  0.00055694580078125
mini_batch_src_global generation:  0.0009255409240722656
r_  generation:  0.008044719696044922
----------------------check_connections_block total spend ----------------------------- 0.16136622428894043
generate_one_block  0.024212121963500977
generate_one_block  0.021448850631713867
generate_one_block  0.013937950134277344
generate_one_block  0.026311874389648438
generate_one_block  0.018634796142578125
generate_one_block  0.017261266708374023
generate_one_block  0.01960468292236328
generate_one_block  0.011743783950805664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001859903335571289
gen group dst list time:  0.0025904178619384766
time for parepare:  0.0016968250274658203
local_output_nid generation:  0.0013451576232910156
local_in_edges_tensor generation:  0.002492189407348633
mini_batch_src_global generation:  0.002153158187866211
r_  generation:  0.024232149124145508
local_output_nid generation:  0.0013117790222167969
local_in_edges_tensor generation:  0.0024976730346679688
mini_batch_src_global generation:  0.0025675296783447266
r_  generation:  0.023283004760742188
local_output_nid generation:  0.001089334487915039
local_in_edges_tensor generation:  0.001638650894165039
mini_batch_src_global generation:  0.0016739368438720703
r_  generation:  0.019675493240356445
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.004908323287963867
mini_batch_src_global generation:  0.002029895782470703
r_  generation:  0.024877071380615234
local_output_nid generation:  0.0012853145599365234
local_in_edges_tensor generation:  0.0017266273498535156
mini_batch_src_global generation:  0.00179290771484375
r_  generation:  0.022658348083496094
local_output_nid generation:  0.0011742115020751953
local_in_edges_tensor generation:  0.0016393661499023438
mini_batch_src_global generation:  0.0018231868743896484
r_  generation:  0.021718978881835938
local_output_nid generation:  0.001405477523803711
local_in_edges_tensor generation:  0.0021047592163085938
mini_batch_src_global generation:  0.0018422603607177734
r_  generation:  0.023013830184936523
local_output_nid generation:  0.0007016658782958984
local_in_edges_tensor generation:  0.0010395050048828125
mini_batch_src_global generation:  0.001466989517211914
r_  generation:  0.014811992645263672
----------------------check_connections_block total spend ----------------------------- 0.2557644844055176
generate_one_block  0.02954697608947754
generate_one_block  0.029489517211914062
generate_one_block  0.02595996856689453
generate_one_block  0.030180692672729492
generate_one_block  0.028658628463745117
generate_one_block  0.027600765228271484
generate_one_block  0.028403282165527344
generate_one_block  0.019563913345336914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002933979034423828  GigaBytes
Max Memory Allocated: 0.002933979034423828  GigaBytes

connection checking time:  0.49246859550476074
block generation total time  0.46054816246032715
average batch blocks generation time:  0.057568520307540894
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.03930950164794922  GigaBytes
Max Memory Allocated: 0.03930950164794922  GigaBytes

torch.Size([18780, 500])
torch.Size([15650, 256])
torch.Size([8970, 256])
torch.Size([2390, 256])
torch.Size([513, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.1403055191040039  GigaBytes
Max Memory Allocated: 0.14041423797607422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.04100847244262695  GigaBytes
Max Memory Allocated: 0.14699125289916992  GigaBytes

torch.Size([18270, 500])
torch.Size([14600, 256])
torch.Size([7264, 256])
torch.Size([1947, 256])
torch.Size([283, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.12638139724731445  GigaBytes
Max Memory Allocated: 0.14699125289916992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.038617610931396484  GigaBytes
Max Memory Allocated: 0.14699125289916992  GigaBytes

torch.Size([17135, 500])
torch.Size([10706, 256])
torch.Size([4822, 256])
torch.Size([792, 256])
torch.Size([248, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.09826421737670898  GigaBytes
Max Memory Allocated: 0.14699125289916992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.04261207580566406  GigaBytes
Max Memory Allocated: 0.14699125289916992  GigaBytes

torch.Size([18939, 500])
torch.Size([16332, 256])
torch.Size([11695, 256])
torch.Size([3799, 256])
torch.Size([896, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.1619281768798828  GigaBytes
Max Memory Allocated: 0.1623978614807129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.04203939437866211  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

torch.Size([18405, 500])
torch.Size([13304, 256])
torch.Size([7200, 256])
torch.Size([1266, 256])
torch.Size([356, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.12158060073852539  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.04002523422241211  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

torch.Size([17822, 500])
torch.Size([12504, 256])
torch.Size([5694, 256])
torch.Size([1149, 256])
torch.Size([222, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.11041402816772461  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.04076194763183594  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

torch.Size([18188, 500])
torch.Size([13619, 256])
torch.Size([6473, 256])
torch.Size([1122, 256])
torch.Size([214, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.11664247512817383  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.02985668182373047  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

torch.Size([12519, 500])
torch.Size([7207, 256])
torch.Size([3235, 256])
torch.Size([885, 256])
torch.Size([136, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.07114458084106445  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01841336488723755 |0.04406505823135376 |0.10219377279281616 |0.0001455843448638916 |0.007232338190078735 |0.007862567901611328 |
----------------------------------------------------------pseudo_mini_loss sum 2.6857268810272217
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  315908
Number of first layer input nodes during this epoch:  140058
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.03719615936279297  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00047397613525390625
range selection method range initialization spend 5.245208740234375e-05
time for parepare:  4.553794860839844e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3828277587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0015552043914794922
generate_one_block  0.001064300537109375
generate_one_block  0.000990152359008789
generate_one_block  0.0009818077087402344
generate_one_block  0.000982522964477539
generate_one_block  0.001007080078125
generate_one_block  0.0011241436004638672
generate_one_block  0.0010199546813964844
generate_one_block  0.0009779930114746094
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005156993865966797
gen group dst list time:  5.030632019042969e-05
time for parepare:  0.00025582313537597656
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0002620220184326172
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.0001316070556640625
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00012612342834472656
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  8.726119995117188e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0002548694610595703
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0002961158752441406
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00011348724365234375
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.176399230957031e-05
----------------------check_connections_block total spend ----------------------------- 0.003378152847290039
generate_one_block  0.001325845718383789
generate_one_block  0.0011377334594726562
generate_one_block  0.0011620521545410156
generate_one_block  0.0010714530944824219
generate_one_block  0.0012738704681396484
generate_one_block  0.0013632774353027344
generate_one_block  0.0011017322540283203
generate_one_block  0.0010509490966796875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011451244354248047
gen group dst list time:  0.0001010894775390625
time for parepare:  0.0008096694946289062
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00028824806213378906
mini_batch_src_global generation:  0.0001900196075439453
r_  generation:  0.0017025470733642578
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  0.00010967254638671875
r_  generation:  0.0006692409515380859
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.000835418701171875
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0006015300750732422
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  0.0001595020294189453
r_  generation:  0.0016028881072998047
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.0002551078796386719
r_  generation:  0.002324819564819336
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  0.0001342296600341797
r_  generation:  0.0007421970367431641
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0003628730773925781
----------------------check_connections_block total spend ----------------------------- 0.014799833297729492
generate_one_block  0.0033969879150390625
generate_one_block  0.0018167495727539062
generate_one_block  0.0019228458404541016
generate_one_block  0.0016682147979736328
generate_one_block  0.002948760986328125
generate_one_block  0.0037391185760498047
generate_one_block  0.0017664432525634766
generate_one_block  0.0013418197631835938
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019774436950683594
gen group dst list time:  0.00028014183044433594
time for parepare:  0.0014247894287109375
local_output_nid generation:  0.00020885467529296875
local_in_edges_tensor generation:  0.0007739067077636719
mini_batch_src_global generation:  0.0007226467132568359
r_  generation:  0.007562160491943359
local_output_nid generation:  0.00021505355834960938
local_in_edges_tensor generation:  0.00029397010803222656
mini_batch_src_global generation:  0.0009043216705322266
r_  generation:  0.003682374954223633
local_output_nid generation:  0.00014090538024902344
local_in_edges_tensor generation:  0.0003521442413330078
mini_batch_src_global generation:  0.0004942417144775391
r_  generation:  0.005200386047363281
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.00027108192443847656
mini_batch_src_global generation:  0.00043702125549316406
r_  generation:  0.003547191619873047
local_output_nid generation:  0.0001590251922607422
local_in_edges_tensor generation:  0.00037384033203125
mini_batch_src_global generation:  0.0005435943603515625
r_  generation:  0.005912303924560547
local_output_nid generation:  0.00027108192443847656
local_in_edges_tensor generation:  0.0005941390991210938
mini_batch_src_global generation:  0.001077413558959961
r_  generation:  0.010767221450805664
local_output_nid generation:  0.00014352798461914062
local_in_edges_tensor generation:  0.0003426074981689453
mini_batch_src_global generation:  0.0006833076477050781
r_  generation:  0.005114555358886719
local_output_nid generation:  6.532669067382812e-05
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  0.0003170967102050781
r_  generation:  0.0022215843200683594
----------------------check_connections_block total spend ----------------------------- 0.06711292266845703
generate_one_block  0.010857105255126953
generate_one_block  0.0056226253509521484
generate_one_block  0.00803828239440918
generate_one_block  0.005640745162963867
generate_one_block  0.008632659912109375
generate_one_block  0.01412820816040039
generate_one_block  0.008222818374633789
generate_one_block  0.005247592926025391
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017936229705810547
gen group dst list time:  0.0011048316955566406
time for parepare:  0.00165557861328125
local_output_nid generation:  0.0007953643798828125
local_in_edges_tensor generation:  0.0016753673553466797
mini_batch_src_global generation:  0.0016908645629882812
r_  generation:  0.01900768280029297
local_output_nid generation:  0.0005397796630859375
local_in_edges_tensor generation:  0.0010454654693603516
mini_batch_src_global generation:  0.0015583038330078125
r_  generation:  0.012791872024536133
local_output_nid generation:  0.0007684230804443359
local_in_edges_tensor generation:  0.0012366771697998047
mini_batch_src_global generation:  0.001168966293334961
r_  generation:  0.01631760597229004
local_output_nid generation:  0.0004401206970214844
local_in_edges_tensor generation:  0.0007405281066894531
mini_batch_src_global generation:  0.0010943412780761719
r_  generation:  0.01076197624206543
local_output_nid generation:  0.0006537437438964844
local_in_edges_tensor generation:  0.0009679794311523438
mini_batch_src_global generation:  0.0009632110595703125
r_  generation:  0.015250205993652344
local_output_nid generation:  0.0010569095611572266
local_in_edges_tensor generation:  0.002180337905883789
mini_batch_src_global generation:  0.00182342529296875
r_  generation:  0.020826101303100586
local_output_nid generation:  0.0006704330444335938
local_in_edges_tensor generation:  0.0010080337524414062
mini_batch_src_global generation:  0.0013875961303710938
r_  generation:  0.015021324157714844
local_output_nid generation:  0.0004723072052001953
local_in_edges_tensor generation:  0.0007014274597167969
mini_batch_src_global generation:  0.0009009838104248047
r_  generation:  0.008372306823730469
----------------------check_connections_block total spend ----------------------------- 0.17331218719482422
generate_one_block  0.024152517318725586
generate_one_block  0.018588542938232422
generate_one_block  0.021256208419799805
generate_one_block  0.014807462692260742
generate_one_block  0.01824021339416504
generate_one_block  0.02696537971496582
generate_one_block  0.02068018913269043
generate_one_block  0.012394189834594727
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017614364624023438
gen group dst list time:  0.0026001930236816406
time for parepare:  0.0018706321716308594
local_output_nid generation:  0.0013909339904785156
local_in_edges_tensor generation:  0.0025932788848876953
mini_batch_src_global generation:  0.0021817684173583984
r_  generation:  0.025072574615478516
local_output_nid generation:  0.0012307167053222656
local_in_edges_tensor generation:  0.0022721290588378906
mini_batch_src_global generation:  0.0024480819702148438
r_  generation:  0.021902084350585938
local_output_nid generation:  0.0014696121215820312
local_in_edges_tensor generation:  0.002473115921020508
mini_batch_src_global generation:  0.001791238784790039
r_  generation:  0.02496051788330078
local_output_nid generation:  0.0012476444244384766
local_in_edges_tensor generation:  0.0014498233795166016
mini_batch_src_global generation:  0.0016856193542480469
r_  generation:  0.019324541091918945
local_output_nid generation:  0.0014462471008300781
local_in_edges_tensor generation:  0.001962900161743164
mini_batch_src_global generation:  0.0019028186798095703
r_  generation:  0.021785974502563477
local_output_nid generation:  0.0016582012176513672
local_in_edges_tensor generation:  0.002447366714477539
mini_batch_src_global generation:  0.002258777618408203
r_  generation:  0.02631354331970215
local_output_nid generation:  0.0013575553894042969
local_in_edges_tensor generation:  0.0017981529235839844
Using backend: pytorch
mini_batch_src_global generation:  0.0017807483673095703
r_  generation:  0.022152185440063477
local_output_nid generation:  0.0010268688201904297
local_in_edges_tensor generation:  0.0013380050659179688
mini_batch_src_global generation:  0.0016307830810546875
r_  generation:  0.019223690032958984
----------------------check_connections_block total spend ----------------------------- 0.2632162570953369
generate_one_block  0.030460357666015625
generate_one_block  0.02965378761291504
generate_one_block  0.0320127010345459
generate_one_block  0.025235652923583984
generate_one_block  0.026933670043945312
generate_one_block  0.03079676628112793
generate_one_block  0.027222633361816406
generate_one_block  0.024223804473876953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.03719615936279297  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

connection checking time:  0.5218193531036377
block generation total time  0.4781019687652588
average batch blocks generation time:  0.05976274609565735
block dataloader generation time/epoch 1.0670673847198486
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.04824018478393555  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

torch.Size([18924, 500])
torch.Size([16568, 256])
torch.Size([9597, 256])
torch.Size([2990, 256])
torch.Size([551, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5311279296875 GB
    Memory Allocated: 0.15742969512939453  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.046027183532714844  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

torch.Size([17916, 500])
torch.Size([12690, 256])
torch.Size([5851, 256])
torch.Size([1117, 256])
torch.Size([285, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.11725378036499023  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.04798269271850586  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

torch.Size([18459, 500])
torch.Size([14212, 256])
torch.Size([7815, 256])
torch.Size([1576, 256])
torch.Size([310, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.1342940330505371  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.0426945686340332  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

torch.Size([16178, 500])
torch.Size([10046, 256])
torch.Size([4535, 256])
torch.Size([1000, 256])
torch.Size([203, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.09917974472045898  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.045163631439208984  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

torch.Size([17388, 500])
torch.Size([12546, 256])
torch.Size([6374, 256])
torch.Size([1948, 256])
torch.Size([449, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.12182760238647461  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.0484929084777832  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

torch.Size([18990, 500])
torch.Size([16147, 256])
torch.Size([11546, 256])
torch.Size([3237, 256])
torch.Size([710, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.16397809982299805  GigaBytes
Max Memory Allocated: 0.16527938842773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5350341796875 GB
    Memory Allocated: 0.044989585876464844  GigaBytes
Max Memory Allocated: 0.17014455795288086  GigaBytes

torch.Size([17314, 500])
torch.Size([12674, 256])
torch.Size([6660, 256])
torch.Size([1473, 256])
torch.Size([235, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5350341796875 GB
    Memory Allocated: 0.12078046798706055  GigaBytes
Max Memory Allocated: 0.17014455795288086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5350341796875 GB
    Memory Allocated: 0.04389047622680664  GigaBytes
Max Memory Allocated: 0.17014455795288086  GigaBytes

torch.Size([16881, 500])
torch.Size([9892, 256])
torch.Size([4280, 256])
torch.Size([589, 256])
torch.Size([161, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5350341796875 GB
    Memory Allocated: 0.09621095657348633  GigaBytes
Max Memory Allocated: 0.17014455795288086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013259172439575195 |0.0024614930152893066 |0.007220357656478882 |0.00013700127601623535 |0.005113005638122559 |0.002864360809326172 |
----------------------------------------------------------pseudo_mini_loss sum 1.5851187705993652
Total (block generation + training)time/epoch 1.308647871017456
Training time/epoch 0.24132871627807617
Training time without block to device /epoch 0.22163677215576172
Training time without total dataloading part /epoch 0.10262727737426758
load block tensor time/epoch 0.10607337951660156
block to device time/epoch 0.019691944122314453
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  320674
Number of first layer input nodes during this epoch:  142050
