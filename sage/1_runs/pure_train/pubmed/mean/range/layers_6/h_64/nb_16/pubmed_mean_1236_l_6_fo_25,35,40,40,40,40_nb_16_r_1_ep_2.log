main start at this time 1648533535.172957
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003743171691894531  GigaBytes
Max Memory Allocated: 0.0003743171691894531  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0017778873443603516
range selection method range initialization spend 8.487701416015625e-05
time for parepare:  4.696846008300781e-05
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0011680126190185547
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.430511474609375e-05
----------------------check_connections_block total spend ----------------------------- 0.0029535293579101562
generate_one_block  0.0012090206146240234
generate_one_block  0.0010809898376464844
generate_one_block  0.0010666847229003906
generate_one_block  0.0010552406311035156
generate_one_block  0.0010573863983154297
generate_one_block  0.0011341571807861328
generate_one_block  0.0010657310485839844
generate_one_block  0.0010292530059814453
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0010960102081298828
gen group dst list time:  5.1975250244140625e-05
time for parepare:  0.00023984909057617188
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00022530555725097656
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00010824203491210938
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00013780593872070312
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00023984909057617188
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001010894775390625
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00016617774963378906
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00036215782165527344
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00023555755615234375
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  6.628036499023438e-05
----------------------check_connections_block total spend ----------------------------- 0.0035545825958251953
generate_one_block  0.0011973381042480469
generate_one_block  0.0012211799621582031
generate_one_block  0.0013766288757324219
generate_one_block  0.0012102127075195312
generate_one_block  0.0012583732604980469
generate_one_block  0.0015039443969726562
generate_one_block  0.001367330551147461
generate_one_block  0.0011134147644042969
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011949539184570312
gen group dst list time:  9.441375732421875e-05
time for parepare:  0.0007612705230712891
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.0002789497375488281
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0005211830139160156
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0008349418640136719
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  0.0002269744873046875
r_  generation:  0.0017855167388916016
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0006844997406005859
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  0.00011515617370605469
r_  generation:  0.0010597705841064453
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  0.0002129077911376953
r_  generation:  0.002315044403076172
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.00019025802612304688
r_  generation:  0.0015759468078613281
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  9.465217590332031e-05
r_  generation:  0.0005230903625488281
----------------------check_connections_block total spend ----------------------------- 0.015475749969482422
generate_one_block  0.0016872882843017578
generate_one_block  0.001905679702758789
generate_one_block  0.003061056137084961
generate_one_block  0.001739501953125
generate_one_block  0.0022242069244384766
generate_one_block  0.0038137435913085938
generate_one_block  0.002782106399536133
generate_one_block  0.0015017986297607422
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019435882568359375
gen group dst list time:  0.0002689361572265625
time for parepare:  0.0016765594482421875
local_output_nid generation:  7.796287536621094e-05
local_in_edges_tensor generation:  0.0004475116729736328
mini_batch_src_global generation:  0.00039887428283691406
r_  generation:  0.003280162811279297
local_output_nid generation:  0.0001227855682373047
local_in_edges_tensor generation:  0.0003447532653808594
mini_batch_src_global generation:  0.0006704330444335938
r_  generation:  0.005189180374145508
local_output_nid generation:  0.00016689300537109375
local_in_edges_tensor generation:  0.0004165172576904297
mini_batch_src_global generation:  0.0008480548858642578
r_  generation:  0.006941795349121094
local_output_nid generation:  0.0001049041748046875
local_in_edges_tensor generation:  0.0002894401550292969
mini_batch_src_global generation:  0.00046944618225097656
r_  generation:  0.0038983821868896484
local_output_nid generation:  0.0001544952392578125
local_in_edges_tensor generation:  0.0003478527069091797
mini_batch_src_global generation:  0.00045490264892578125
r_  generation:  0.005041599273681641
local_output_nid generation:  0.0002562999725341797
local_in_edges_tensor generation:  0.0005269050598144531
mini_batch_src_global generation:  0.0007724761962890625
r_  generation:  0.008112430572509766
local_output_nid generation:  0.000244140625
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.0009157657623291016
r_  generation:  0.008088827133178711
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.00024890899658203125
mini_batch_src_global generation:  0.00044798851013183594
r_  generation:  0.0030684471130371094
----------------------check_connections_block total spend ----------------------------- 0.0659337043762207
generate_one_block  0.005598783493041992
generate_one_block  0.007985353469848633
generate_one_block  0.010639190673828125
generate_one_block  0.006120443344116211
generate_one_block  0.00745081901550293
generate_one_block  0.011726856231689453
generate_one_block  0.012535810470581055
generate_one_block  0.004953145980834961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002136707305908203
gen group dst list time:  0.0013318061828613281
time for parepare:  0.0018475055694580078
local_output_nid generation:  0.0005240440368652344
local_in_edges_tensor generation:  0.0013048648834228516
mini_batch_src_global generation:  0.0012793540954589844
r_  generation:  0.012749671936035156
local_output_nid generation:  0.0006651878356933594
local_in_edges_tensor generation:  0.0013470649719238281
mini_batch_src_global generation:  0.0018126964569091797
r_  generation:  0.016169071197509766
local_output_nid generation:  0.0007734298706054688
local_in_edges_tensor generation:  0.0011179447174072266
mini_batch_src_global generation:  0.0014905929565429688
r_  generation:  0.017164945602416992
local_output_nid generation:  0.0005147457122802734
local_in_edges_tensor generation:  0.0008146762847900391
mini_batch_src_global generation:  0.0011658668518066406
r_  generation:  0.012893199920654297
local_output_nid generation:  0.0006694793701171875
local_in_edges_tensor generation:  0.0011281967163085938
mini_batch_src_global generation:  0.0014023780822753906
r_  generation:  0.01517939567565918
local_output_nid generation:  0.0007996559143066406
local_in_edges_tensor generation:  0.0012729167938232422
mini_batch_src_global generation:  0.0018544197082519531
r_  generation:  0.018566131591796875
local_output_nid generation:  0.0009109973907470703
local_in_edges_tensor generation:  0.0015461444854736328
mini_batch_src_global generation:  0.0017728805541992188
r_  generation:  0.020992279052734375
local_output_nid generation:  0.0004017353057861328
local_in_edges_tensor generation:  0.0006766319274902344
mini_batch_src_global generation:  0.0011010169982910156
r_  generation:  0.010567426681518555
----------------------check_connections_block total spend ----------------------------- 0.18110156059265137
generate_one_block  0.01781606674194336
generate_one_block  0.0223543643951416
generate_one_block  0.02248859405517578
generate_one_block  0.017836332321166992
generate_one_block  0.01947784423828125
generate_one_block  0.024825572967529297
generate_one_block  0.026915788650512695
generate_one_block  0.014781951904296875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017642974853515625
gen group dst list time:  0.0025980472564697266
time for parepare:  0.0018012523651123047
local_output_nid generation:  0.0010986328125
local_in_edges_tensor generation:  0.002112150192260742
mini_batch_src_global generation:  0.001999378204345703
r_  generation:  0.021131038665771484
local_output_nid generation:  0.001322031021118164
local_in_edges_tensor generation:  0.0025026798248291016
mini_batch_src_global generation:  0.002592325210571289
r_  generation:  0.02382826805114746
local_output_nid generation:  0.0013613700866699219
local_in_edges_tensor generation:  0.0022797584533691406
mini_batch_src_global generation:  0.0018930435180664062
r_  generation:  0.023416757583618164
local_output_nid generation:  0.0011975765228271484
local_in_edges_tensor generation:  0.003793478012084961
mini_batch_src_global generation:  0.0019032955169677734
r_  generation:  0.02139449119567871
local_output_nid generation:  0.0013179779052734375
local_in_edges_tensor generation:  0.0018754005432128906
mini_batch_src_global generation:  0.0020232200622558594
r_  generation:  0.023787260055541992
local_output_nid generation:  0.0014395713806152344
local_in_edges_tensor generation:  0.002588510513305664
mini_batch_src_global generation:  0.0020160675048828125
r_  generation:  0.02519822120666504
local_output_nid generation:  0.0014803409576416016
local_in_edges_tensor generation:  0.002699136734008789
mini_batch_src_global generation:  0.001943349838256836
r_  generation:  0.025678157806396484
local_output_nid generation:  0.0010712146759033203
local_in_edges_tensor generation:  0.0014085769653320312
mini_batch_src_global generation:  0.0016608238220214844
r_  generation:  0.019100427627563477
----------------------check_connections_block total spend ----------------------------- 0.26967692375183105
generate_one_block  0.02663135528564453
generate_one_block  0.03040933609008789
generate_one_block  0.029047250747680664
generate_one_block  0.027026891708374023
generate_one_block  0.029063701629638672
generate_one_block  0.031200647354125977
generate_one_block  0.03112173080444336
generate_one_block  0.024692535400390625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003743171691894531  GigaBytes
Max Memory Allocated: 0.0003743171691894531  GigaBytes

connection checking time:  0.5357425212860107
block generation total time  0.49166417121887207
average batch blocks generation time:  0.06145802140235901
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.034485816955566406  GigaBytes
Max Memory Allocated: 0.034485816955566406  GigaBytes

torch.Size([17616, 500])
torch.Size([11536, 64])
torch.Size([5587, 64])
torch.Size([882, 64])
torch.Size([252, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.051310062408447266  GigaBytes
Max Memory Allocated: 0.051694393157958984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.036997318267822266  GigaBytes
Max Memory Allocated: 0.06910324096679688  GigaBytes

torch.Size([18377, 500])
torch.Size([14176, 64])
torch.Size([7321, 64])
torch.Size([1485, 64])
torch.Size([285, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.05940437316894531  GigaBytes
Max Memory Allocated: 0.06910324096679688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.03534650802612305  GigaBytes
Max Memory Allocated: 0.0693197250366211  GigaBytes

torch.Size([17942, 500])
torch.Size([13506, 64])
torch.Size([8000, 64])
torch.Size([1978, 64])
torch.Size([476, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.05827808380126953  GigaBytes
Max Memory Allocated: 0.0693197250366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.03371477127075195  GigaBytes
Max Memory Allocated: 0.0693197250366211  GigaBytes

torch.Size([17198, 500])
torch.Size([11272, 64])
torch.Size([5194, 64])
torch.Size([1080, 64])
torch.Size([199, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.050115108489990234  GigaBytes
Max Memory Allocated: 0.0693197250366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.0356287956237793  GigaBytes
Max Memory Allocated: 0.0693197250366211  GigaBytes

torch.Size([18159, 500])
torch.Size([13842, 64])
torch.Size([7040, 64])
torch.Size([1914, 64])
torch.Size([369, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.058063507080078125  GigaBytes
Max Memory Allocated: 0.0693197250366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.03720426559448242  GigaBytes
Max Memory Allocated: 0.06972408294677734  GigaBytes

torch.Size([18524, 500])
torch.Size([15531, 64])
torch.Size([8942, 64])
torch.Size([3133, 64])
torch.Size([675, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.0642542839050293  GigaBytes
Max Memory Allocated: 0.06972408294677734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.03745317459106445  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

torch.Size([18987, 500])
torch.Size([16376, 64])
torch.Size([10823, 64])
torch.Size([2869, 64])
torch.Size([514, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.06681585311889648  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.030266761779785156  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

torch.Size([15416, 500])
torch.Size([9944, 64])
torch.Size([3940, 64])
torch.Size([832, 64])
torch.Size([125, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.04387521743774414  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.019075453281402588 |0.04440087080001831 |0.10338073968887329 |0.00014454126358032227 |0.004939436912536621 |0.003587007522583008 |
----------------------------------------------------------pseudo_mini_loss sum 2.8779101371765137
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  322673
Number of first layer input nodes during this epoch:  142219
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.032788753509521484  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005855560302734375
range selection method range initialization spend 6.890296936035156e-05
time for parepare:  6.079673767089844e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.5974044799804688e-05
----------------------check_connections_block total spend ----------------------------- 0.001888275146484375
generate_one_block  0.0017480850219726562
generate_one_block  0.0012753009796142578
generate_one_block  0.0012805461883544922
generate_one_block  0.0012454986572265625
generate_one_block  0.0012416839599609375
generate_one_block  0.0014176368713378906
generate_one_block  0.0012352466583251953
generate_one_block  0.0012176036834716797
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006690025329589844
gen group dst list time:  6.771087646484375e-05
time for parepare:  0.0003483295440673828
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00015544891357421875
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00018095970153808594
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0005290508270263672
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00015115737915039062
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00017881393432617188
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00022363662719726562
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.0001361370086669922
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  9.632110595703125e-05
----------------------check_connections_block total spend ----------------------------- 0.0041980743408203125
generate_one_block  0.0014345645904541016
generate_one_block  0.001430511474609375
generate_one_block  0.0019032955169677734
generate_one_block  0.001386404037475586
generate_one_block  0.0014472007751464844
generate_one_block  0.0015139579772949219
generate_one_block  0.0012066364288330078
generate_one_block  0.0010266304016113281
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011293888092041016
gen group dst list time:  0.00013637542724609375
time for parepare:  0.0010006427764892578
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0002987384796142578
mini_batch_src_global generation:  0.00013518333435058594
r_  generation:  0.0010485649108886719
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.00016188621520996094
r_  generation:  0.0011174678802490234
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.0002894401550292969
mini_batch_src_global generation:  0.0004229545593261719
r_  generation:  0.0036721229553222656
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  0.00016617774963378906
r_  generation:  0.0007038116455078125
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0011548995971679688
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  0.00015473365783691406
r_  generation:  0.0013530254364013672
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  0.00010466575622558594
r_  generation:  0.0007681846618652344
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00034809112548828125
----------------------check_connections_block total spend ----------------------------- 0.017311811447143555
generate_one_block  0.0021932125091552734
generate_one_block  0.0021195411682128906
generate_one_block  0.004601478576660156
generate_one_block  0.0015540122985839844
generate_one_block  0.002126932144165039
generate_one_block  0.0022804737091064453
generate_one_block  0.0018527507781982422
generate_one_block  0.001336812973022461
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001790761947631836
gen group dst list time:  0.0002720355987548828
time for parepare:  0.0014543533325195312
local_output_nid generation:  0.00011897087097167969
local_in_edges_tensor generation:  0.0005850791931152344
mini_batch_src_global generation:  0.00058746337890625
r_  generation:  0.0054988861083984375
local_output_nid generation:  0.00013875961303710938
local_in_edges_tensor generation:  0.0003533363342285156
mini_batch_src_global generation:  0.0005645751953125
r_  generation:  0.0050945281982421875
local_output_nid generation:  0.0002665519714355469
local_in_edges_tensor generation:  0.0005600452423095703
mini_batch_src_global generation:  0.00083160400390625
r_  generation:  0.010057210922241211
local_output_nid generation:  9.369850158691406e-05
local_in_edges_tensor generation:  0.0002593994140625
mini_batch_src_global generation:  0.0004639625549316406
r_  generation:  0.0030388832092285156
local_output_nid generation:  0.00016307830810546875
local_in_edges_tensor generation:  0.0003509521484375
mini_batch_src_global generation:  0.0004353523254394531
r_  generation:  0.004896640777587891
local_output_nid generation:  0.0001735687255859375
local_in_edges_tensor generation:  0.0003635883331298828
mini_batch_src_global generation:  0.0005810260772705078
r_  generation:  0.005826711654663086
local_output_nid generation:  0.00015091896057128906
local_in_edges_tensor generation:  0.0003223419189453125
mini_batch_src_global generation:  0.0005486011505126953
r_  generation:  0.0050048828125
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  0.0002415180206298828
r_  generation:  0.0013689994812011719
----------------------check_connections_block total spend ----------------------------- 0.06051969528198242
generate_one_block  0.008712291717529297
generate_one_block  0.007134675979614258
generate_one_block  0.013472557067871094
generate_one_block  0.004926204681396484
generate_one_block  0.008345603942871094
generate_one_block  0.010556936264038086
generate_one_block  0.008205890655517578
generate_one_block  0.002651214599609375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021009445190429688
gen group dst list time:  0.0011069774627685547
time for parepare:  0.0017445087432861328
local_output_nid generation:  0.0006113052368164062
local_in_edges_tensor generation:  0.0014219284057617188
mini_batch_src_global generation:  0.0012476444244384766
r_  generation:  0.01564955711364746
local_output_nid generation:  0.0005991458892822266
local_in_edges_tensor generation:  0.0012476444244384766
mini_batch_src_global generation:  0.0017681121826171875
r_  generation:  0.015002965927124023
local_output_nid generation:  0.0009021759033203125
local_in_edges_tensor generation:  0.0013501644134521484
mini_batch_src_global generation:  0.0016055107116699219
r_  generation:  0.020012617111206055
local_output_nid generation:  0.0005261898040771484
local_in_edges_tensor generation:  0.0007572174072265625
mini_batch_src_global generation:  0.000986337661743164
r_  generation:  0.00913238525390625
local_output_nid generation:  0.0007483959197998047
local_in_edges_tensor generation:  0.001066446304321289
mini_batch_src_global generation:  0.00124359130859375
r_  generation:  0.01677250862121582
local_output_nid generation:  0.0010082721710205078
local_in_edges_tensor generation:  0.0013267993927001953
mini_batch_src_global generation:  0.0015780925750732422
r_  generation:  0.01835322380065918
local_output_nid generation:  0.0007355213165283203
local_in_edges_tensor generation:  0.0009737014770507812
mini_batch_src_global generation:  0.0013151168823242188
r_  generation:  0.015450477600097656
local_output_nid generation:  0.0002841949462890625
local_in_edges_tensor generation:  0.0004646778106689453
mini_batch_src_global generation:  0.0006670951843261719
r_  generation:  0.005023956298828125
----------------------check_connections_block total spend ----------------------------- 0.16828322410583496
generate_one_block  0.019050121307373047
generate_one_block  0.02025294303894043
generate_one_block  0.025991439819335938
generate_one_block  0.013462066650390625
generate_one_block  0.02138376235961914
generate_one_block  0.024049997329711914
generate_one_block  0.019859790802001953
generate_one_block  0.00818490982055664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018541812896728516
gen group dst list time:  0.0025527477264404297
time for parepare:  0.0018239021301269531
local_output_nid generation:  0.001210927963256836
local_in_edges_tensor generation:  0.0020830631256103516
mini_batch_src_global generation:  0.0020821094512939453
r_  generation:  0.021845102310180664
local_output_nid generation:  0.0012607574462890625
local_in_edges_tensor generation:  0.0022628307342529297
mini_batch_src_global generation:  0.002441883087158203
r_  generation:  0.021842002868652344
local_output_nid generation:  0.0015096664428710938
local_in_edges_tensor generation:  0.0025768280029296875
mini_batch_src_global generation:  0.0018248558044433594
r_  generation:  0.02509617805480957
local_output_nid generation:  0.0013058185577392578
local_in_edges_tensor generation:  0.001657724380493164
mini_batch_src_global generation:  0.001764059066772461
r_  generation:  0.020201921463012695
local_output_nid generation:  0.0016355514526367188
local_in_edges_tensor generation:  0.002312183380126953
mini_batch_src_global generation:  0.001886606216430664
r_  generation:  0.024338722229003906
local_output_nid generation:  0.0017004013061523438
local_in_edges_tensor generation:  0.0025179386138916016
mini_batch_src_global generation:  0.002379894256591797
r_  generation:  0.02475142478942871
local_output_nid generation:  0.0015249252319335938
local_in_edges_tensor generation:  0.001688241958618164
mini_batch_src_global generation: Using backend: pytorch
 0.0018892288208007812
r_  generation:  0.023401260375976562
local_output_nid generation:  0.0008184909820556641
local_in_edges_tensor generation:  0.0010344982147216797
mini_batch_src_global generation:  0.0013418197631835938
r_  generation:  0.01487588882446289
----------------------check_connections_block total spend ----------------------------- 0.2586936950683594
generate_one_block  0.026853084564208984
generate_one_block  0.028173208236694336
generate_one_block  0.033800601959228516
generate_one_block  0.0259091854095459
generate_one_block  0.030373573303222656
generate_one_block  0.030745983123779297
generate_one_block  0.028258323669433594
generate_one_block  0.01937556266784668
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.032788753509521484  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

connection checking time:  0.5090065002441406
block generation total time  0.469144344329834
average batch blocks generation time:  0.05864304304122925
block dataloader generation time/epoch 1.0475597381591797
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.034664154052734375  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

torch.Size([17255, 500])
torch.Size([12567, 64])
torch.Size([6521, 64])
torch.Size([1438, 64])
torch.Size([269, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.05400228500366211  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.034271240234375  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

torch.Size([17059, 500])
torch.Size([12692, 64])
torch.Size([6384, 64])
torch.Size([1635, 64])
torch.Size([291, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.05408525466918945  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.0380244255065918  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

torch.Size([18780, 500])
torch.Size([15825, 64])
torch.Size([10212, 64])
torch.Size([3279, 64])
torch.Size([863, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.06725406646728516  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.03401899337768555  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

torch.Size([17055, 500])
torch.Size([10873, 64])
torch.Size([4795, 64])
torch.Size([1004, 64])
torch.Size([240, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.05004072189331055  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.03664970397949219  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

torch.Size([18282, 500])
torch.Size([14782, 64])
torch.Size([7291, 64])
torch.Size([1868, 64])
torch.Size([303, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.05997943878173828  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.03783082962036133  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

torch.Size([18880, 500])
torch.Size([15026, 64])
torch.Size([9538, 64])
torch.Size([1914, 64])
torch.Size([477, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.06370401382446289  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.03574323654174805  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

torch.Size([17716, 500])
torch.Size([13244, 64])
torch.Size([6473, 64])
torch.Size([1536, 64])
torch.Size([242, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.055704593658447266  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.028892040252685547  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

torch.Size([14446, 500])
torch.Size([7267, 64])
torch.Size([2294, 64])
torch.Size([525, 64])
torch.Size([162, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.03815412521362305  GigaBytes
Max Memory Allocated: 0.07126617431640625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011662572622299194 |0.0015643537044525146 |0.006793290376663208 |0.0001347661018371582 |0.0033455491065979004 |0.002749919891357422 |
----------------------------------------------------------pseudo_mini_loss sum 2.3519182205200195
Total (block generation + training)time/epoch 1.250431776046753
Training time/epoch 0.2026231288909912
Training time without block to device /epoch 0.1901082992553711
Training time without total dataloading part /epoch 0.08493876457214355
load block tensor time/epoch 0.09330058097839355
block to device time/epoch 0.012514829635620117
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  311660
Number of first layer input nodes during this epoch:  139473
