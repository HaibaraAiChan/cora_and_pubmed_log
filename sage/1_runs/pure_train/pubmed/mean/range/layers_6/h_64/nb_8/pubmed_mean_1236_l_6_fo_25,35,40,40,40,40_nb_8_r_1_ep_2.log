main start at this time 1648533523.4311554
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003743171691894531  GigaBytes
Max Memory Allocated: 0.0003743171691894531  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0014984607696533203
range selection method range initialization spend 0.00011014938354492188
time for parepare:  5.412101745605469e-05
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0028967857360839844
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  6.341934204101562e-05
----------------------check_connections_block total spend ----------------------------- 0.004210472106933594
generate_one_block  0.0015459060668945312
generate_one_block  0.0012958049774169922
generate_one_block  0.001298666000366211
generate_one_block  0.0013377666473388672
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009539127349853516
gen group dst list time:  4.1961669921875e-05
time for parepare:  0.00029730796813964844
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.0002741813659667969
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0003643035888671875
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00043129920959472656
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0005495548248291016
----------------------check_connections_block total spend ----------------------------- 0.003363370895385742
generate_one_block  0.0016121864318847656
generate_one_block  0.0017871856689453125
generate_one_block  0.0018010139465332031
generate_one_block  0.001961231231689453
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012214183807373047
gen group dst list time:  0.00010395050048828125
time for parepare:  0.0009195804595947266
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.00032830238342285156
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.0013310909271240234
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  0.00032138824462890625
r_  generation:  0.002707958221435547
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.0002722740173339844
mini_batch_src_global generation:  0.00032782554626464844
r_  generation:  0.0029706954956054688
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.0003018379211425781
mini_batch_src_global generation:  0.00036597251892089844
r_  generation:  0.0030994415283203125
----------------------check_connections_block total spend ----------------------------- 0.0165252685546875
generate_one_block  0.0028917789459228516
generate_one_block  0.0035636425018310547
generate_one_block  0.003954410552978516
generate_one_block  0.004305839538574219
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002340078353881836
gen group dst list time:  0.00030159950256347656
time for parepare:  0.0019643306732177734
local_output_nid generation:  0.00020360946655273438
local_in_edges_tensor generation:  0.0007505416870117188
mini_batch_src_global generation:  0.0008733272552490234
r_  generation:  0.006055593490600586
local_output_nid generation:  0.0001995563507080078
local_in_edges_tensor generation:  0.0009274482727050781
mini_batch_src_global generation:  0.001148223876953125
r_  generation:  0.008372306823730469
local_output_nid generation:  0.00026679039001464844
local_in_edges_tensor generation:  0.0007135868072509766
mini_batch_src_global generation:  0.001094818115234375
r_  generation:  0.010488033294677734
local_output_nid generation:  0.00037479400634765625
local_in_edges_tensor generation:  0.0007660388946533203
mini_batch_src_global generation:  0.0010988712310791016
r_  generation:  0.012737751007080078
----------------------check_connections_block total spend ----------------------------- 0.05764484405517578
generate_one_block  0.009558677673339844
generate_one_block  0.011258840560913086
generate_one_block  0.013397455215454102
generate_one_block  0.018314123153686523
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018510818481445312
gen group dst list time:  0.0007879734039306641
time for parepare:  0.0017936229705810547
local_output_nid generation:  0.0007412433624267578
local_in_edges_tensor generation:  0.0015912055969238281
mini_batch_src_global generation:  0.0017240047454833984
r_  generation:  0.01798701286315918
local_output_nid generation:  0.0008211135864257812
local_in_edges_tensor generation:  0.001615762710571289
mini_batch_src_global generation:  0.0020911693572998047
r_  generation:  0.01858663558959961
local_output_nid generation:  0.000997304916381836
local_in_edges_tensor generation:  0.0015330314636230469
mini_batch_src_global generation:  0.001968860626220703
r_  generation:  0.020442724227905273
local_output_nid generation:  0.0013194084167480469
local_in_edges_tensor generation:  0.0018610954284667969
mini_batch_src_global generation:  0.0022253990173339844
r_  generation:  0.023591041564941406
----------------------check_connections_block total spend ----------------------------- 0.11896681785583496
generate_one_block  0.022623300552368164
generate_one_block  0.0247189998626709
generate_one_block  0.02609395980834961
generate_one_block  0.03061652183532715
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020151138305664062
gen group dst list time:  0.0014674663543701172
time for parepare:  0.00162506103515625
local_output_nid generation:  0.0013401508331298828
local_in_edges_tensor generation:  0.0025360584259033203
mini_batch_src_global generation:  0.0021228790283203125
r_  generation:  0.024748563766479492
local_output_nid generation:  0.0013508796691894531
local_in_edges_tensor generation:  0.002192974090576172
mini_batch_src_global generation:  0.002572774887084961
r_  generation:  0.02401113510131836
local_output_nid generation:  0.0015451908111572266
local_in_edges_tensor generation:  0.0025720596313476562
mini_batch_src_global generation:  0.00218963623046875
r_  generation:  0.025528907775878906
local_output_nid generation:  0.0016140937805175781
local_in_edges_tensor generation:  0.0023267269134521484
mini_batch_src_global generation:  0.002239704132080078
r_  generation:  0.02665853500366211
----------------------check_connections_block total spend ----------------------------- 0.14844322204589844
generate_one_block  0.029766321182250977
generate_one_block  0.03151559829711914
generate_one_block  0.030658245086669922
generate_one_block  0.03217172622680664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003743171691894531  GigaBytes
Max Memory Allocated: 0.0003743171691894531  GigaBytes

connection checking time:  0.3449435234069824
block generation total time  0.30257105827331543
average batch blocks generation time:  0.07564276456832886
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03671455383300781  GigaBytes
Max Memory Allocated: 0.03671455383300781  GigaBytes

torch.Size([18753, 500])
torch.Size([15305, 64])
torch.Size([8953, 64])
torch.Size([1955, 64])
torch.Size([499, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.06224632263183594  GigaBytes
Max Memory Allocated: 0.06230306625366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.03718996047973633  GigaBytes
Max Memory Allocated: 0.07105636596679688  GigaBytes

torch.Size([18487, 500])
torch.Size([14577, 64])
torch.Size([9256, 64])
torch.Size([2446, 64])
torch.Size([621, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.06253290176391602  GigaBytes
Max Memory Allocated: 0.07105636596679688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.0372920036315918  GigaBytes
Max Memory Allocated: 0.07105636596679688  GigaBytes

torch.Size([18745, 500])
torch.Size([16047, 64])
torch.Size([10312, 64])
torch.Size([3535, 64])
torch.Size([762, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.06689929962158203  GigaBytes
Max Memory Allocated: 0.07105636596679688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.038204193115234375  GigaBytes
Max Memory Allocated: 0.07181978225708008  GigaBytes

torch.Size([19284, 500])
torch.Size([17690, 64])
torch.Size([13492, 64])
torch.Size([4586, 64])
torch.Size([972, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.07474327087402344  GigaBytes
Max Memory Allocated: 0.07480192184448242  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01937687397003174 |0.08721506595611572 |0.1998884081840515 |0.00017845630645751953 |0.007532298564910889 |0.004293203353881836 |
----------------------------------------------------------pseudo_mini_loss sum 2.1462912559509277
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  196634
Number of first layer input nodes during this epoch:  75269
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.04237031936645508  GigaBytes
Max Memory Allocated: 0.07588338851928711  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00047516822814941406
range selection method range initialization spend 5.340576171875e-05
time for parepare:  4.4345855712890625e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.7206878662109375e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.075599670410156e-05
----------------------check_connections_block total spend ----------------------------- 0.0009350776672363281
generate_one_block  0.0010678768157958984
generate_one_block  0.001043081283569336
generate_one_block  0.0010685920715332031
generate_one_block  0.0010242462158203125
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005464553833007812
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.0002758502960205078
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00023746490478515625
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0004725456237792969
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00022459030151367188
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00026535987854003906
----------------------check_connections_block total spend ----------------------------- 0.0026366710662841797
generate_one_block  0.0013115406036376953
generate_one_block  0.0015730857849121094
generate_one_block  0.0012240409851074219
generate_one_block  0.001363515853881836
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0009722709655761719
gen group dst list time:  7.605552673339844e-05
time for parepare:  0.0007457733154296875
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.0002865791320800781
mini_batch_src_global generation:  0.0001723766326904297
r_  generation:  0.0016100406646728516
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  0.00033211708068847656
r_  generation:  0.0031893253326416016
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  0.00020503997802734375
r_  generation:  0.0014605522155761719
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  0.00017404556274414062
r_  generation:  0.0016949176788330078
----------------------check_connections_block total spend ----------------------------- 0.012845754623413086
generate_one_block  0.003491640090942383
generate_one_block  0.004914999008178711
generate_one_block  0.0026807785034179688
generate_one_block  0.003121614456176758
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0063207149505615234
gen group dst list time:  0.00020885467529296875
time for parepare:  0.0012857913970947266
local_output_nid generation:  0.0001862049102783203
local_in_edges_tensor generation:  0.0007550716400146484
mini_batch_src_global generation:  0.0008037090301513672
r_  generation:  0.007945775985717773
local_output_nid generation:  0.0002713203430175781
local_in_edges_tensor generation:  0.0005853176116943359
mini_batch_src_global generation:  0.0009319782257080078
r_  generation:  0.01046133041381836
local_output_nid generation:  0.00021719932556152344
local_in_edges_tensor generation:  0.0004761219024658203
mini_batch_src_global generation:  0.000782012939453125
r_  generation:  0.006944894790649414Using backend: pytorch

local_output_nid generation:  0.00025391578674316406
local_in_edges_tensor generation:  0.0005259513854980469
mini_batch_src_global generation:  0.0008795261383056641
r_  generation:  0.009381294250488281
----------------------check_connections_block total spend ----------------------------- 0.051085710525512695
generate_one_block  0.011954545974731445
generate_one_block  0.014759302139282227
generate_one_block  0.010229110717773438
generate_one_block  0.014685869216918945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001802206039428711
gen group dst list time:  0.0007507801055908203
time for parepare:  0.0015347003936767578
local_output_nid generation:  0.0007472038269042969
local_in_edges_tensor generation:  0.0017266273498535156
mini_batch_src_global generation:  0.0014691352844238281
r_  generation:  0.01735210418701172
local_output_nid generation:  0.0009336471557617188
local_in_edges_tensor generation:  0.002142667770385742
mini_batch_src_global generation:  0.002415895462036133
r_  generation:  0.02013564109802246
local_output_nid generation:  0.0008945465087890625
local_in_edges_tensor generation:  0.0015139579772949219
mini_batch_src_global generation:  0.0017812252044677734
r_  generation:  0.01853156089782715
local_output_nid generation:  0.0011317729949951172
local_in_edges_tensor generation:  0.0016810894012451172
mini_batch_src_global generation:  0.002019166946411133
r_  generation:  0.0225069522857666
----------------------check_connections_block total spend ----------------------------- 0.11608695983886719
generate_one_block  0.022485017776489258
generate_one_block  0.026342391967773438
generate_one_block  0.02439594268798828
generate_one_block  0.029581785202026367
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022046566009521484
gen group dst list time:  0.0014510154724121094
time for parepare:  0.0021462440490722656
local_output_nid generation:  0.0013027191162109375
local_in_edges_tensor generation:  0.0025005340576171875
mini_batch_src_global generation:  0.0018825531005859375
r_  generation:  0.02332758903503418
local_output_nid generation:  0.00152587890625
local_in_edges_tensor generation:  0.0024607181549072266
mini_batch_src_global generation:  0.002614736557006836
r_  generation:  0.025768756866455078
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0023851394653320312
mini_batch_src_global generation:  0.0019910335540771484
r_  generation:  0.024746417999267578
local_output_nid generation:  0.0017256736755371094
local_in_edges_tensor generation:  0.0023365020751953125
mini_batch_src_global generation:  0.002182483673095703
r_  generation:  0.025284290313720703
----------------------check_connections_block total spend ----------------------------- 0.14734888076782227
generate_one_block  0.028822898864746094
generate_one_block  0.03288149833679199
generate_one_block  0.030324935913085938
generate_one_block  0.031162023544311523
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.04237031936645508  GigaBytes
Max Memory Allocated: 0.07588338851928711  GigaBytes

connection checking time:  0.3300039768218994
block generation total time  0.29730653762817383
average batch blocks generation time:  0.07432663440704346
block dataloader generation time/epoch 0.6822493076324463
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.03667306900024414  GigaBytes
Max Memory Allocated: 0.07588338851928711  GigaBytes

torch.Size([18224, 500])
torch.Size([14815, 64])
torch.Size([8810, 64])
torch.Size([2756, 64])
torch.Size([541, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.06211090087890625  GigaBytes
Max Memory Allocated: 0.07588338851928711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03825855255126953  GigaBytes
Max Memory Allocated: 0.07588338851928711  GigaBytes

torch.Size([18963, 500])
torch.Size([16586, 64])
torch.Size([11178, 64])
torch.Size([3786, 64])
torch.Size([1032, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07052469253540039  GigaBytes
Max Memory Allocated: 0.07588338851928711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0379023551940918  GigaBytes
Max Memory Allocated: 0.07588338851928711  GigaBytes

torch.Size([18732, 500])
torch.Size([15895, 64])
torch.Size([9659, 64])
torch.Size([2539, 64])
torch.Size([532, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06536149978637695  GigaBytes
Max Memory Allocated: 0.07588338851928711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03852224349975586  GigaBytes
Max Memory Allocated: 0.07588338851928711  GigaBytes

torch.Size([19137, 500])
torch.Size([16761, 64])
torch.Size([11782, 64])
torch.Size([3121, 64])
torch.Size([709, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07009029388427734  GigaBytes
Max Memory Allocated: 0.07588338851928711  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01320028305053711 |0.0017436742782592773 |0.006592154502868652 |0.0001361370086669922 |0.004633128643035889 |0.0028836727142333984 |
----------------------------------------------------------pseudo_mini_loss sum 2.016157627105713
Total (block generation + training)time/epoch 0.797095537185669
Training time/epoch 0.11423063278198242
Training time without block to device /epoch 0.10725593566894531
Training time without total dataloading part /epoch 0.04832935333251953
load block tensor time/epoch 0.05280113220214844
block to device time/epoch 0.006974697113037109
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  195914
Number of first layer input nodes during this epoch:  75056
