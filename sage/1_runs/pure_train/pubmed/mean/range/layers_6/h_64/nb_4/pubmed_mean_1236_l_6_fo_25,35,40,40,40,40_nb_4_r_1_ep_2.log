main start at this time 1648533513.1579254
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003743171691894531  GigaBytes
Max Memory Allocated: 0.0003743171691894531  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0016710758209228516
range selection method range initialization spend 0.00010418891906738281
time for parepare:  4.649162292480469e-05
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0015130043029785156
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  8.487701416015625e-05
----------------------check_connections_block total spend ----------------------------- 0.002282381057739258
generate_one_block  0.0013408660888671875
generate_one_block  0.0012166500091552734
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000982046127319336
gen group dst list time:  2.4557113647460938e-05
time for parepare:  0.0002391338348388672
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0005016326904296875
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0008158683776855469
----------------------check_connections_block total spend ----------------------------- 0.0024645328521728516
generate_one_block  0.0017480850219726562
generate_one_block  0.0021293163299560547
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010673999786376953
gen group dst list time:  6.580352783203125e-05
time for parepare:  0.0007562637329101562
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.0003635883331298828
mini_batch_src_global generation:  0.00029158592224121094
r_  generation:  0.003289461135864258
local_output_nid generation:  0.0001239776611328125
local_in_edges_tensor generation:  0.0003502368927001953
mini_batch_src_global generation:  0.0006046295166015625
r_  generation:  0.004937171936035156
----------------------check_connections_block total spend ----------------------------- 0.012971878051757812
generate_one_block  0.005760908126831055
generate_one_block  0.007168769836425781
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0022537708282470703
gen group dst list time:  0.0001876354217529297
time for parepare:  0.0014538764953613281
local_output_nid generation:  0.0002830028533935547
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.001220703125
r_  generation:  0.011816024780273438
local_output_nid generation:  0.0004737377166748047
local_in_edges_tensor generation:  0.0015406608581542969
mini_batch_src_global generation:  0.0020105838775634766
r_  generation:  0.016330718994140625
----------------------check_connections_block total spend ----------------------------- 0.04321455955505371
generate_one_block  0.016228914260864258
generate_one_block  0.023308992385864258
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018689632415771484
gen group dst list time:  0.0005156993865966797
time for parepare:  0.001634359359741211
local_output_nid generation:  0.0009553432464599609
local_in_edges_tensor generation:  0.0019068717956542969
mini_batch_src_global generation:  0.002029895782470703
r_  generation:  0.02207636833190918
local_output_nid generation:  0.0010986328125
local_in_edges_tensor generation:  0.0021202564239501953
mini_batch_src_global generation:  0.002768993377685547
r_  generation:  0.025137901306152344
----------------------check_connections_block total spend ----------------------------- 0.0705420970916748
generate_one_block  0.027167320251464844
generate_one_block  0.03159379959106445
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021772384643554688
gen group dst list time:  0.0007719993591308594
time for parepare:  0.0016827583312988281
local_output_nid generation:  0.0012907981872558594
local_in_edges_tensor generation:  0.00274658203125
mini_batch_src_global generation:  0.0021507740020751953
r_  generation:  0.02562427520751953
local_output_nid generation:  0.0013890266418457031
local_in_edges_tensor generation:  0.0023589134216308594
mini_batch_src_global generation:  0.0027692317962646484
r_  generation:  0.026640653610229492
----------------------check_connections_block total spend ----------------------------- 0.07808637619018555
generate_one_block  0.030501604080200195
generate_one_block  0.03432965278625488
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003743171691894531  GigaBytes
Max Memory Allocated: 0.0003743171691894531  GigaBytes

connection checking time:  0.20727944374084473
block generation total time  0.17993736267089844
average batch blocks generation time:  0.08996868133544922
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03756380081176758  GigaBytes
Max Memory Allocated: 0.03756380081176758  GigaBytes

torch.Size([19152, 500])
torch.Size([16963, 64])
torch.Size([12590, 64])
torch.Size([3931, 64])
torch.Size([1109, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.07141542434692383  GigaBytes
Max Memory Allocated: 0.07155227661132812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.038596153259277344  GigaBytes
Max Memory Allocated: 0.07273721694946289  GigaBytes

torch.Size([19391, 500])
torch.Size([18276, 64])
torch.Size([15230, 64])
torch.Size([6664, 64])
torch.Size([1689, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.0802149772644043  GigaBytes
Max Memory Allocated: 0.08034229278564453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.020968079566955566 |0.17227673530578613 |0.3915501832962036 |0.00021600723266601562 |0.01037907600402832 |0.00693058967590332 |
----------------------------------------------------------pseudo_mini_loss sum 2.8240509033203125
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  115352
Number of first layer input nodes during this epoch:  38543
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.043186187744140625  GigaBytes
Max Memory Allocated: 0.08159255981445312  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005090236663818359
range selection method range initialization spend 5.555152893066406e-05
time for parepare:  4.887580871582031e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00010752677917480469Using backend: pytorch

mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  5.793571472167969e-05
----------------------check_connections_block total spend ----------------------------- 0.0007476806640625
generate_one_block  0.001573324203491211
generate_one_block  0.0011112689971923828
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005376338958740234
gen group dst list time:  2.5033950805664062e-05
time for parepare:  0.00026154518127441406
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0007295608520507812
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  7.677078247070312e-05
r_  generation:  0.0004870891571044922
----------------------check_connections_block total spend ----------------------------- 0.002359628677368164
generate_one_block  0.002074718475341797
generate_one_block  0.0016269683837890625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010542869567871094
gen group dst list time:  7.104873657226562e-05
time for parepare:  0.0007424354553222656
local_output_nid generation:  0.00010848045349121094
local_in_edges_tensor generation:  0.00040221214294433594
mini_batch_src_global generation:  0.00039124488830566406
r_  generation:  0.004621982574462891
local_output_nid generation:  0.00010061264038085938
local_in_edges_tensor generation:  0.00026798248291015625
mini_batch_src_global generation:  0.00038361549377441406
r_  generation:  0.0029757022857666016
----------------------check_connections_block total spend ----------------------------- 0.011934518814086914
generate_one_block  0.007386445999145508
generate_one_block  0.004553318023681641
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020456314086914062
gen group dst list time:  0.00018525123596191406
time for parepare:  0.001323699951171875
local_output_nid generation:  0.0003840923309326172
local_in_edges_tensor generation:  0.0011065006256103516
mini_batch_src_global generation:  0.0010972023010253906
r_  generation:  0.014225959777832031
local_output_nid generation:  0.00038170814514160156
local_in_edges_tensor generation:  0.0007750988006591797
mini_batch_src_global generation:  0.0014510154724121094
r_  generation:  0.012524604797363281
----------------------check_connections_block total spend ----------------------------- 0.039984941482543945
generate_one_block  0.018053531646728516
generate_one_block  0.0176239013671875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017764568328857422
gen group dst list time:  0.0005016326904296875
time for parepare:  0.0014801025390625
local_output_nid generation:  0.0009725093841552734
local_in_edges_tensor generation:  0.001916646957397461
mini_batch_src_global generation:  0.0018308162689208984
r_  generation:  0.022936105728149414
local_output_nid generation:  0.0012388229370117188
local_in_edges_tensor generation:  0.0024521350860595703
mini_batch_src_global generation:  0.002633810043334961
r_  generation:  0.023214101791381836
----------------------check_connections_block total spend ----------------------------- 0.06942224502563477
generate_one_block  0.02857065200805664
generate_one_block  0.031446218490600586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017962455749511719
gen group dst list time:  0.0007922649383544922
time for parepare:  0.0016391277313232422
local_output_nid generation:  0.001298666000366211
local_in_edges_tensor generation:  0.0024559497833251953
mini_batch_src_global generation:  0.0018727779388427734
r_  generation:  0.02580738067626953
local_output_nid generation:  0.0015468597412109375
local_in_edges_tensor generation:  0.002476215362548828
mini_batch_src_global generation:  0.002704143524169922
r_  generation:  0.027330636978149414
----------------------check_connections_block total spend ----------------------------- 0.0785212516784668
generate_one_block  0.03089427947998047
generate_one_block  0.03308916091918945
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.043186187744140625  GigaBytes
Max Memory Allocated: 0.08159255981445312  GigaBytes

connection checking time:  0.20222258567810059
block generation total time  0.17531919479370117
average batch blocks generation time:  0.08765959739685059
block dataloader generation time/epoch 0.446331262588501
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.03897809982299805  GigaBytes
Max Memory Allocated: 0.08159255981445312  GigaBytes

torch.Size([19246, 500])
torch.Size([17842, 64])
torch.Size([13586, 64])
torch.Size([5597, 64])
torch.Size([1541, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.07674837112426758  GigaBytes
Max Memory Allocated: 0.08159255981445312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.03903961181640625  GigaBytes
Max Memory Allocated: 0.08159255981445312  GigaBytes

torch.Size([19323, 500])
torch.Size([17825, 64])
torch.Size([13954, 64])
torch.Size([4759, 64])
torch.Size([1154, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.07625246047973633  GigaBytes
Max Memory Allocated: 0.08159255981445312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013817191123962402 |0.0024782419204711914 |0.006590723991394043 |0.00013399124145507812 |0.0067397356033325195 |0.0060977935791015625 |
----------------------------------------------------------pseudo_mini_loss sum 2.5821666717529297
Total (block generation + training)time/epoch 0.5156326293945312
Training time/epoch 0.0688009262084961
Training time without block to device /epoch 0.06384444236755371
Training time without total dataloading part /epoch 0.033026695251464844
load block tensor time/epoch 0.027634382247924805
block to device time/epoch 0.004956483840942383
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  115181
Number of first layer input nodes during this epoch:  38569
