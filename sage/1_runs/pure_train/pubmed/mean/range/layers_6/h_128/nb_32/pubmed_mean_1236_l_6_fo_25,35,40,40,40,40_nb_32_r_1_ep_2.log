main start at this time 1648533607.2908208
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006093978881835938
range selection method range initialization spend 0.000102996826171875
time for parepare:  5.245208740234375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0065500736236572266
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0002465248107910156
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.2901763916015625e-05
----------------------check_connections_block total spend ----------------------------- 0.009990215301513672
generate_one_block  0.0019466876983642578
generate_one_block  0.0012760162353515625
generate_one_block  0.001153707504272461
generate_one_block  0.0010035037994384766
generate_one_block  0.0010640621185302734
generate_one_block  0.000957489013671875
generate_one_block  0.0009553432464599609
generate_one_block  0.0009610652923583984
generate_one_block  0.0009610652923583984
generate_one_block  0.0009455680847167969
generate_one_block  0.0009546279907226562
generate_one_block  0.000988006591796875
generate_one_block  0.0009629726409912109
generate_one_block  0.0009474754333496094
generate_one_block  0.0009679794311523438
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0023691654205322266
gen group dst list time:  0.00010204315185546875
time for parepare:  0.0003292560577392578
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0001666545867919922
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  6.699562072753906e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0001366138458251953
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00019359588623046875
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  9.584426879882812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.605552673339844e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0001914501190185547
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00011324882507324219
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.343292236328125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.987022399902344e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00022649765014648438
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0001308917999267578
----------------------check_connections_block total spend ----------------------------- 0.0055124759674072266
generate_one_block  0.0014925003051757812
generate_one_block  0.0012936592102050781
generate_one_block  0.00139617919921875
generate_one_block  0.0015001296997070312
generate_one_block  0.0012679100036621094
generate_one_block  0.0012950897216796875
generate_one_block  0.0011115074157714844
generate_one_block  0.0012238025665283203
generate_one_block  0.0011110305786132812
generate_one_block  0.0011250972747802734
generate_one_block  0.0010600090026855469
generate_one_block  0.0010225772857666016
generate_one_block  0.001184701919555664
generate_one_block  0.0010213851928710938
generate_one_block  0.0010685920715332031
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013942718505859375
gen group dst list time:  0.00026345252990722656
time for parepare:  0.0016591548919677734
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.00044417381286621094
mini_batch_src_global generation:  0.0001480579376220703
r_  generation:  0.0016109943389892578
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0002753734588623047
mini_batch_src_global generation:  0.00010466575622558594
r_  generation:  0.0005495548248291016
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.00029015541076660156
mini_batch_src_global generation:  0.00011920928955078125
r_  generation:  0.0012273788452148438
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00031638145446777344
mini_batch_src_global generation:  0.0003495216369628906
r_  generation:  0.002660989761352539
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0002532005310058594
mini_batch_src_global generation:  0.00012159347534179688
r_  generation:  0.0004677772521972656
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0002722740173339844
mini_batch_src_global generation:  0.00011181831359863281
r_  generation:  0.0010416507720947266
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00025010108947753906
mini_batch_src_global generation:  0.00011491775512695312
r_  generation:  0.0008709430694580078
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.0003247261047363281
mini_batch_src_global generation:  0.0002143383026123047
r_  generation:  0.0014903545379638672
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  0.00012540817260742188
r_  generation:  0.0010495185852050781
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.0007927417755126953
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.000514984130859375
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.00044345855712890625
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.0019466876983642578
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.00045180320739746094
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0005171298980712891
----------------------check_connections_block total spend ----------------------------- 0.028110027313232422
generate_one_block  0.002171039581298828
generate_one_block  0.0012774467468261719
generate_one_block  0.0015726089477539062
generate_one_block  0.002521991729736328
generate_one_block  0.001130819320678711
generate_one_block  0.0014960765838623047
generate_one_block  0.0014278888702392578
generate_one_block  0.0021016597747802734
generate_one_block  0.0019698143005371094
generate_one_block  0.001991748809814453
generate_one_block  0.001355886459350586
generate_one_block  0.0012729167938232422
generate_one_block  0.0026459693908691406
generate_one_block  0.0013213157653808594
generate_one_block  0.0015337467193603516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021212100982666016
gen group dst list time:  0.0003142356872558594
time for parepare:  0.001756906509399414
local_output_nid generation:  0.00010037422180175781
local_in_edges_tensor generation:  0.0005431175231933594
mini_batch_src_global generation:  0.0003972053527832031
r_  generation:  0.0033380985260009766
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.00024700164794921875
r_  generation:  0.001556396484375
local_output_nid generation:  8.821487426757812e-05
local_in_edges_tensor generation:  0.00026798248291015625
mini_batch_src_global generation:  0.0002815723419189453
r_  generation:  0.003187894821166992
local_output_nid generation:  0.00012373924255371094
local_in_edges_tensor generation:  0.0003578662872314453
mini_batch_src_global generation:  0.000652313232421875
r_  generation:  0.005484819412231445
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.0011150836944580078
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  0.000286102294921875
r_  generation:  0.0029103755950927734
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.0002503395080566406
mini_batch_src_global generation:  0.0003159046173095703
r_  generation:  0.003072500228881836
local_output_nid generation:  0.00013184547424316406
local_in_edges_tensor generation:  0.0003426074981689453
mini_batch_src_global generation:  0.0005578994750976562
r_  generation:  0.0053348541259765625
local_output_nid generation:  0.0001418590545654297
local_in_edges_tensor generation:  0.00035953521728515625
mini_batch_src_global generation:  0.0006334781646728516
r_  generation:  0.004906415939331055
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.0002541542053222656
mini_batch_src_global generation:  0.000408172607421875
r_  generation:  0.003497600555419922
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.0002415180206298828
r_  generation:  0.001901865005493164
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  0.00019097328186035156
r_  generation:  0.0016794204711914062
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.0003108978271484375
mini_batch_src_global generation:  0.00043964385986328125
r_  generation:  0.004952430725097656
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.0002930164337158203
r_  generation:  0.0020294189453125
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.00023603439331054688
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.002215147018432617
----------------------check_connections_block total spend ----------------------------- 0.0720663070678711
generate_one_block  0.005238771438598633
generate_one_block  0.0029413700103759766
generate_one_block  0.0048656463623046875
generate_one_block  0.007486820220947266
generate_one_block  0.0024755001068115234
generate_one_block  0.004938364028930664
generate_one_block  0.0051097869873046875
generate_one_block  0.008687019348144531
generate_one_block  0.007687568664550781
generate_one_block  0.005544900894165039
generate_one_block  0.0033676624298095703
generate_one_block  0.003208160400390625
generate_one_block  0.008224725723266602
generate_one_block  0.0037529468536376953
generate_one_block  0.003722667694091797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023589134216308594
gen group dst list time:  0.0017352104187011719
time for parepare:  0.0018863677978515625
local_output_nid generation:  0.00040984153747558594
local_in_edges_tensor generation:  0.0011949539184570312
mini_batch_src_global generation:  0.0011017322540283203
r_  generation:  0.010243892669677734
local_output_nid generation:  0.0003001689910888672
local_in_edges_tensor generation:  0.0006592273712158203
mini_batch_src_global generation:  0.0008885860443115234
r_  generation:  0.006743907928466797
local_output_nid generation:  0.0004811286926269531
local_in_edges_tensor generation:  0.0007443428039550781
mini_batch_src_global generation:  0.0009543895721435547
r_  generation:  0.011224031448364258
local_output_nid generation:  0.0004646778106689453
local_in_edges_tensor generation:  0.0009598731994628906
mini_batch_src_global generation:  0.0011260509490966797
r_  generation:  0.01213693618774414
local_output_nid generation:  0.00019884109497070312
local_in_edges_tensor generation:  0.0003917217254638672
mini_batch_src_global generation:  0.0005717277526855469
r_  generation:  0.0043544769287109375
local_output_nid generation:  0.00040411949157714844
local_in_edges_tensor generation:  0.0007216930389404297
mini_batch_src_global generation:  0.0008995532989501953
r_  generation:  0.011094093322753906
local_output_nid generation:  0.00040793418884277344
local_in_edges_tensor generation:  0.0009341239929199219
mini_batch_src_global generation:  0.0010519027709960938
r_  generation:  0.011209964752197266
local_output_nid generation:  0.0007832050323486328
local_in_edges_tensor generation:  0.0014421939849853516
mini_batch_src_global generation:  0.0014300346374511719
r_  generation:  0.01743912696838379
local_output_nid generation:  0.0005965232849121094
local_in_edges_tensor generation:  0.0013568401336669922
mini_batch_src_global generation:  0.0015137195587158203
r_  generation:  0.0163877010345459
local_output_nid generation:  0.0003657341003417969
local_in_edges_tensor generation:  0.000637054443359375
mini_batch_src_global generation:  0.0009329319000244141
r_  generation:  0.008618831634521484
local_output_nid generation:  0.0003120899200439453
local_in_edges_tensor generation:  0.0005049705505371094
mini_batch_src_global generation:  0.0006792545318603516
r_  generation:  0.0069370269775390625
local_output_nid generation:  0.0003273487091064453
local_in_edges_tensor generation:  0.0005295276641845703
mini_batch_src_global generation:  0.0006897449493408203
r_  generation:  0.007324934005737305
local_output_nid generation:  0.00042819976806640625
local_in_edges_tensor generation:  0.0006990432739257812
mini_batch_src_global generation:  0.0010349750518798828
r_  generation:  0.011658430099487305
local_output_nid generation:  0.0003814697265625
local_in_edges_tensor generation:  0.0006346702575683594
mini_batch_src_global generation:  0.0009560585021972656
r_  generation:  0.009194612503051758
local_output_nid generation:  0.000324249267578125
local_in_edges_tensor generation:  0.0005440711975097656
mini_batch_src_global generation:  0.0008223056793212891
r_  generation:  0.008692026138305664
----------------------check_connections_block total spend ----------------------------- 0.22420907020568848
generate_one_block  0.013486623764038086
generate_one_block  0.010471343994140625
generate_one_block  0.013692855834960938
generate_one_block  0.01733088493347168
generate_one_block  0.006805419921875
generate_one_block  0.014922857284545898
generate_one_block  0.016257524490356445
generate_one_block  0.023029804229736328
generate_one_block  0.02228546142578125
generate_one_block  0.012865304946899414
generate_one_block  0.010186195373535156
generate_one_block  0.010304450988769531
generate_one_block  0.01469874382019043
generate_one_block  0.013396501541137695
generate_one_block  0.013215303421020508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019745826721191406
gen group dst list time:  0.004353523254394531
time for parepare:  0.001760721206665039
local_output_nid generation:  0.0010762214660644531
local_in_edges_tensor generation:  0.001995563507080078
mini_batch_src_global generation:  0.0019311904907226562
r_  generation:  0.019301652908325195
local_output_nid generation:  0.0008578300476074219
local_in_edges_tensor generation:  0.0016934871673583984
mini_batch_src_global generation:  0.002042531967163086
r_  generation:  0.01757359504699707
local_output_nid generation:  0.0011150836944580078
local_in_edges_tensor generation:  0.0018930435180664062
mini_batch_src_global generation:  0.0016665458679199219
r_  generation:  0.02061772346496582
local_output_nid generation:  0.001055002212524414
local_in_edges_tensor generation:  0.0014464855194091797
mini_batch_src_global generation:  0.001645803451538086
r_  generation:  0.01932549476623535
local_output_nid generation:  0.0006108283996582031
local_in_edges_tensor generation:  0.0009551048278808594
mini_batch_src_global generation:  0.0012273788452148438
r_  generation:  0.012947797775268555
local_output_nid generation:  0.0010173320770263672
local_in_edges_tensor generation:  0.0014681816101074219
mini_batch_src_global generation:  0.0016438961029052734
r_  generation:  0.019402742385864258
local_output_nid generation:  0.0009670257568359375
local_in_edges_tensor generation:  0.0015044212341308594
mini_batch_src_global generation:  0.0017194747924804688
r_  generation:  0.01960468292236328
local_output_nid generation:  0.0013058185577392578
local_in_edges_tensor generation:  0.002345561981201172
mini_batch_src_global generation:  0.0018668174743652344
r_  generation:  0.024105548858642578
local_output_nid generation:  0.0014193058013916016
local_in_edges_tensor generation:  0.001997709274291992
mini_batch_src_global generation:  0.002046346664428711
r_  generation:  0.02397894859313965
local_output_nid generation:  0.0008244514465332031
local_in_edges_tensor generation:  0.0012052059173583984
mini_batch_src_global generation:  0.0015163421630859375
r_  generation:  0.016221046447753906
local_output_nid generation:  0.000978708267211914
local_in_edges_tensor generation:  0.001354217529296875
mini_batch_src_global generation:  0.0013060569763183594
r_  generation:  0.01681804656982422
local_output_nid generation:  0.0009083747863769531
local_in_edges_tensor generation:  0.0012946128845214844
mini_batch_src_global generation:  0.0015687942504882812
r_  generation:  0.01839303970336914
local_output_nid generation:  0.0008983612060546875
local_in_edges_tensor generation:  0.0014996528625488281
mini_batch_src_global generation:  0.0015702247619628906
r_  generation:  0.018177270889282227
local_output_nid generation:  0.0009362697601318359
local_in_edges_tensor generation:  0.001522064208984375
mini_batch_src_global generation:  0.0014925003051757812
r_  generation:  0.019367694854736328
local_output_nid generation:  0.0010561943054199219
local_in_edges_tensor generation:  0.0016608238220214844
mini_batch_src_global generation:  0.001657724380493164
r_  generation:  0.02044367790222168
----------------------check_connections_block total spend ----------------------------- 0.41752052307128906
generate_one_block  0.023731708526611328
generate_one_block  0.02361893653869629
generate_one_block  0.026770353317260742
generate_one_block  0.025114059448242188
generate_one_block  0.017256975173950195
generate_one_block  0.024818897247314453
generate_one_block  0.025400876998901367
generate_one_block  0.030632972717285156
generate_one_block  0.030075550079345703
generate_one_block  0.02054286003112793
generate_one_block  0.02106332778930664
generate_one_block  0.026653051376342773
generate_one_block  0.02408599853515625
generate_one_block  0.024880409240722656
generate_one_block  0.026049137115478516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

connection checking time:  0.7474184036254883
block generation total time  0.7048614025115967
average batch blocks generation time:  0.04699076016743978
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03333902359008789  GigaBytes
Max Memory Allocated: 0.03333902359008789  GigaBytes

torch.Size([16952, 500])
torch.Size([11099, 128])
torch.Size([4798, 128])
torch.Size([1287, 128])
torch.Size([277, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.06474590301513672  GigaBytes
Max Memory Allocated: 0.06478500366210938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.03278160095214844  GigaBytes
Max Memory Allocated: 0.06655454635620117  GigaBytes

torch.Size([16212, 500])
torch.Size([8521, 128])
torch.Size([3224, 128])
torch.Size([442, 128])
torch.Size([124, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.05465888977050781  GigaBytes
Max Memory Allocated: 0.06655454635620117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.035990238189697266  GigaBytes
Max Memory Allocated: 0.06655454635620117  GigaBytes

torch.Size([17464, 500])
torch.Size([11288, 128])
torch.Size([5335, 128])
torch.Size([999, 128])
torch.Size([218, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.0680856704711914  GigaBytes
Max Memory Allocated: 0.06812858581542969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.03165245056152344  GigaBytes
Max Memory Allocated: 0.07076215744018555  GigaBytes

torch.Size([15444, 500])
torch.Size([10117, 128])
torch.Size([5066, 128])
torch.Size([1559, 128])
torch.Size([323, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.06277942657470703  GigaBytes
Max Memory Allocated: 0.07076215744018555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.028166770935058594  GigaBytes
Max Memory Allocated: 0.07076215744018555  GigaBytes

torch.Size([13836, 500])
torch.Size([5711, 128])
torch.Size([1986, 128])
torch.Size([321, 128])
torch.Size([86, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.04240989685058594  GigaBytes
Max Memory Allocated: 0.07076215744018555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.033007144927978516  GigaBytes
Max Memory Allocated: 0.07076215744018555  GigaBytes

torch.Size([16219, 500])
torch.Size([9906, 128])
torch.Size([4312, 128])
torch.Size([799, 128])
torch.Size([156, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.06128263473510742  GigaBytes
Max Memory Allocated: 0.07076215744018555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.032792091369628906  GigaBytes
Max Memory Allocated: 0.07076215744018555  GigaBytes

torch.Size([16103, 500])
torch.Size([10224, 128])
torch.Size([4127, 128])
torch.Size([954, 128])
torch.Size([100, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.06020021438598633  GigaBytes
Max Memory Allocated: 0.07076215744018555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.03826093673706055  GigaBytes
Max Memory Allocated: 0.07076215744018555  GigaBytes

torch.Size([18648, 500])
torch.Size([14552, 128])
torch.Size([8984, 128])
torch.Size([1632, 128])
torch.Size([389, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.08482027053833008  GigaBytes
Max Memory Allocated: 0.08494091033935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.037012577056884766  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([18229, 500])
torch.Size([14585, 128])
torch.Size([6987, 128])
torch.Size([1768, 128])
torch.Size([194, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.07937049865722656  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.02826690673828125  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([13734, 500])
torch.Size([7772, 128])
torch.Size([3726, 128])
torch.Size([943, 128])
torch.Size([141, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.05125617980957031  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.030228137969970703  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([14836, 500])
torch.Size([8833, 128])
torch.Size([3190, 128])
torch.Size([716, 128])
torch.Size([128, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.05319070816040039  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.032527923583984375  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([16042, 500])
torch.Size([9016, 128])
torch.Size([3450, 128])
torch.Size([507, 128])
torch.Size([147, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.05662679672241211  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03125476837158203  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([15244, 500])
torch.Size([9000, 128])
torch.Size([5092, 128])
torch.Size([1444, 128])
torch.Size([351, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.060769081115722656  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03397226333618164  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([16707, 500])
torch.Size([9723, 128])
torch.Size([3908, 128])
torch.Size([583, 128])
torch.Size([133, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.06023120880126953  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.0335392951965332  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([16537, 500])
torch.Size([10933, 128])
torch.Size([3518, 128])
torch.Size([949, 128])
torch.Size([163, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.06159257888793945  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010349909464518229 |0.024050235748291016 |0.05859365463256836 |0.0001491705576578776 |0.004786348342895508 |0.00795745849609375 |
----------------------------------------------------------pseudo_mini_loss sum 2.387556314468384
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  479380
Number of first layer input nodes during this epoch:  242207
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03723001480102539  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005118846893310547
range selection method range initialization spend 5.555152893066406e-05
time for parepare:  5.2928924560546875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.3589859008789062e-05
----------------------check_connections_block total spend ----------------------------- 0.0027954578399658203
generate_one_block  0.0013763904571533203
generate_one_block  0.0010335445404052734
generate_one_block  0.0010328292846679688
generate_one_block  0.0010383129119873047
generate_one_block  0.0010161399841308594
generate_one_block  0.001009225845336914
generate_one_block  0.0010247230529785156
generate_one_block  0.0010132789611816406
generate_one_block  0.001024484634399414
generate_one_block  0.0010221004486083984
generate_one_block  0.0009961128234863281
generate_one_block  0.0009415149688720703
generate_one_block  0.0009455680847167969
generate_one_block  0.0009391307830810547
generate_one_block  0.000982046127319336
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006420612335205078
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.0002849102020263672
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  8.058547973632812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  8.082389831542969e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00029969215393066406
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  6.151199340820312e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.364418029785156e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0001571178436279297
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  5.745887756347656e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0001347064971923828
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00014162063598632812
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00010204315185546875
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.700920104980469e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.198883056640625e-05
----------------------check_connections_block total spend ----------------------------- 0.004832267761230469
generate_one_block  0.0011301040649414062
generate_one_block  0.001100778579711914
generate_one_block  0.0011055469512939453
generate_one_block  0.001416921615600586
generate_one_block  0.0010762214660644531
generate_one_block  0.0010905265808105469
generate_one_block  0.0010941028594970703
generate_one_block  0.0010747909545898438
generate_one_block  0.0011255741119384766
generate_one_block  0.0009903907775878906
generate_one_block  0.0011038780212402344
generate_one_block  0.0015499591827392578
generate_one_block  0.0010366439819335938
generate_one_block  0.0010294914245605469
generate_one_block  0.0010008811950683594
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010962486267089844
gen group dst list time:  0.00012922286987304688
time for parepare:  0.0008299350738525391
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0002510547637939453
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.00044226646423339844
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0005803108215332031
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0003428459167480469
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00023603439331054688
r_  generation:  0.0020635128021240234
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  9.584426879882812e-05
r_  generation:  0.00026226043701171875
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0003216266632080078
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0006017684936523438
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0002262592315673828
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0008471012115478516
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.00042819976806640625
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  9.512901306152344e-05
r_  generation:  0.0009553432464599609
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.0008497238159179688
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0004930496215820312
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0003955364227294922
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.00029015541076660156
----------------------check_connections_block total spend ----------------------------- 0.016433000564575195
generate_one_block  0.0019469261169433594
generate_one_block  0.001697540283203125
generate_one_block  0.0013020038604736328
generate_one_block  0.003231525421142578
generate_one_block  0.0012001991271972656
generate_one_block  0.0012729167938232422
generate_one_block  0.0016698837280273438
generate_one_block  0.001165628433227539
generate_one_block  0.0019617080688476562
generate_one_block  0.0014085769653320312
generate_one_block  0.002018451690673828
generate_one_block  0.0018630027770996094
generate_one_block  0.0014889240264892578
generate_one_block  0.001371145248413086
generate_one_block  0.001245737075805664
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019445419311523438
gen group dst list time:  0.0003352165222167969
time for parepare:  0.0016243457794189453
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.00044846534729003906
mini_batch_src_global generation:  0.0003380775451660156
r_  generation:  0.0029735565185546875
local_output_nid generation:  0.000118255615234375
local_in_edges_tensor generation:  0.0003287792205810547
mini_batch_src_global generation:  0.0004820823669433594
r_  generation:  0.004545688629150391
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00022602081298828125
r_  generation:  0.0013537406921386719
local_output_nid generation:  0.00015211105346679688
local_in_edges_tensor generation:  0.0003674030303955078
mini_batch_src_global generation:  0.0004944801330566406
r_  generation:  0.00563502311706543
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  0.0002543926239013672
r_  generation:  0.0014889240264892578
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  0.0001652240753173828
r_  generation:  0.0015609264373779297
local_output_nid generation:  0.00010013580322265625
local_in_edges_tensor generation:  0.00026798248291015625
mini_batch_src_global generation:  0.0003387928009033203
r_  generation:  0.003700733184814453
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  0.00019550323486328125
r_  generation:  0.0011699199676513672
local_output_nid generation:  0.000118255615234375
local_in_edges_tensor generation:  0.0002968311309814453
mini_batch_src_global generation:  0.00034236907958984375
r_  generation:  0.004123687744140625
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  0.0003204345703125
r_  generation:  0.004069089889526367
local_output_nid generation:  0.00014543533325195312
local_in_edges_tensor generation:  0.0003447532653808594
mini_batch_src_global generation:  0.0004630088806152344
r_  generation:  0.00500941276550293
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.00029397010803222656
mini_batch_src_global generation:  0.000400543212890625
r_  generation:  0.0037288665771484375
local_output_nid generation:  9.298324584960938e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  0.00028896331787109375
r_  generation:  0.0025436878204345703
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.00023865699768066406
r_  generation:  0.002084970474243164
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  0.00019598007202148438
r_  generation:  0.0016779899597167969
----------------------check_connections_block total spend ----------------------------- 0.06839919090270996
generate_one_block  0.005040884017944336
generate_one_block  0.006478071212768555
generate_one_block  0.0024099349975585938
generate_one_block  0.008039712905883789
generate_one_block  0.0028662681579589844
generate_one_block  0.0030100345611572266
generate_one_block  0.00617218017578125
generate_one_block  0.002457141876220703
generate_one_block  0.006632804870605469
generate_one_block  0.004309177398681641
generate_one_block  0.008119583129882812
generate_one_block  0.005550384521484375
generate_one_block  0.0041675567626953125
generate_one_block  0.0037550926208496094
generate_one_block  0.0032045841217041016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022230148315429688
gen group dst list time:  0.0014679431915283203
time for parepare:  0.001735687255859375
local_output_nid generation:  0.00039887428283691406
local_in_edges_tensor generation:  0.0011284351348876953
mini_batch_src_global generation:  0.0009045600891113281
r_  generation:  0.010044336318969727
local_output_nid generation:  0.0005846023559570312
local_in_edges_tensor generation:  0.001116037368774414
mini_batch_src_global generation:  0.0016155242919921875
r_  generation:  0.015317440032958984
local_output_nid generation:  0.00018262863159179688
local_in_edges_tensor generation:  0.0003578662872314453
mini_batch_src_global generation:  0.0005774497985839844
r_  generation:  0.0042455196380615234
local_output_nid generation:  0.00047469139099121094
local_in_edges_tensor generation:  0.0008008480072021484
mini_batch_src_global generation:  0.0009140968322753906
r_  generation:  0.011697769165039062
local_output_nid generation:  0.0003142356872558594
local_in_edges_tensor generation:  0.0005483627319335938
mini_batch_src_global generation:  0.0008687973022460938
r_  generation:  0.007493734359741211
local_output_nid generation:  0.0003108978271484375
local_in_edges_tensor generation:  0.0005145072937011719
mini_batch_src_global generation:  0.0006568431854248047
r_  generation:  0.00678563117980957
local_output_nid generation:  0.00036454200744628906
local_in_edges_tensor generation:  0.0006036758422851562
mini_batch_src_global generation:  0.0009374618530273438
r_  generation:  0.010384082794189453
local_output_nid generation:  0.0002727508544921875
local_in_edges_tensor generation:  0.0004515647888183594
mini_batch_src_global generation:  0.0006494522094726562
r_  generation:  0.006925106048583984
local_output_nid generation:  0.0006716251373291016
local_in_edges_tensor generation:  0.0009205341339111328
mini_batch_src_global generation:  0.0009746551513671875
r_  generation:  0.01463627815246582
local_output_nid generation:  0.00032210350036621094
local_in_edges_tensor generation:  0.0005006790161132812
mini_batch_src_global generation:  0.0009019374847412109
r_  generation:  0.007750749588012695
local_output_nid generation:  0.0008397102355957031
local_in_edges_tensor generation:  0.0010602474212646484
mini_batch_src_global generation:  0.0012471675872802734
r_  generation:  0.016604900360107422
local_output_nid generation:  0.0005774497985839844
local_in_edges_tensor generation:  0.0008177757263183594
mini_batch_src_global generation:  0.0011398792266845703
r_  generation:  0.011928558349609375
local_output_nid generation:  0.0004558563232421875
local_in_edges_tensor generation:  0.0006718635559082031
mini_batch_src_global generation:  0.0009114742279052734
r_  generation:  0.011034250259399414
local_output_nid generation:  0.00044536590576171875
local_in_edges_tensor generation:  0.0006463527679443359
mini_batch_src_global generation:  0.0008749961853027344
r_  generation:  0.00809025764465332
local_output_nid generation:  0.00038170814514160156
local_in_edges_tensor generation:  0.0005390644073486328
mini_batch_src_global generation:  0.0006682872772216797
r_  generation:  0.008375406265258789
----------------------check_connections_block total spend ----------------------------- 0.21999502182006836
generate_one_block  0.012971878051757812
generate_one_block  0.021297216415405273
generate_one_block  0.0073812007904052734
generate_one_block  0.016451597213745117
generate_one_block  0.011662721633911133
generate_one_block  0.010275840759277344
generate_one_block  0.01342320442199707
generate_one_block  0.009562492370605469
generate_one_block  0.01919865608215332
generate_one_block  0.011881589889526367
generate_one_block  0.020618915557861328
generate_one_block  0.015834569931030273
generate_one_block  0.015239715576171875
generate_one_block  0.012190580368041992
generate_one_block  0.011293411254882812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00229644775390625
gen group dst list time:  0.004209756851196289
time for parepare:  0.0019254684448242188
local_output_nid generation:  0.0009267330169677734
local_in_edges_tensor generation:  0.0018320083618164062
mini_batch_src_global generation:  0.001712799072265625
r_  generation:  0.01817917823791504
local_output_nid generation:  0.001306772232055664
local_in_edges_tensor generation:  0.002335071563720703
mini_batch_src_global generation:  0.002799510955810547
r_  generation:  0.02388787269592285
local_output_nid generation:  0.00067138671875
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.0013461112976074219
r_  generation:  0.013094902038574219
local_output_nid generation:  0.001085042953491211
local_in_edges_tensor generation:  0.0014462471008300781
mini_batch_src_global generation:  0.0013670921325683594
r_  generation:  0.019407272338867188
local_output_nid generation:  0.001016855239868164
local_in_edges_tensor generation:  0.0015158653259277344
mini_batch_src_global generation:  0.0015306472778320312
r_  generation:  0.018302440643310547
local_output_nid generation:  0.0009593963623046875
local_in_edges_tensor generation:  0.0011868476867675781
mini_batch_src_global generation:  0.0015559196472167969
r_  generation:  0.018193960189819336
local_output_nid generation:  0.0010209083557128906
local_in_edges_tensor generation:  0.0013437271118164062
mini_batch_src_global generation:  0.0014765262603759766
r_  generation:  0.017221927642822266
local_output_nid generation:  0.0007925033569335938
local_in_edges_tensor generation:  0.001010894775390625
mini_batch_src_global generation:  0.0011942386627197266
r_  generation:  0.014568090438842773
local_output_nid generation:  0.0013895034790039062
local_in_edges_tensor generation:  0.0019183158874511719
mini_batch_src_global generation:  0.0019266605377197266
r_  generation:  0.02285456657409668
local_output_nid generation:  0.0007314682006835938
local_in_edges_tensor generation:  0.0009794235229492188
mini_batch_src_global generation:  0.0014243125915527344
r_  generation:  0.014301061630249023
local_output_nid generation:  0.0015020370483398438
local_in_edges_tensor generation:  0.002124786376953125
mini_batch_src_global generation:  0.0018322467803955078
r_  generation:  0.0238645076751709
local_output_nid generation:  0.0011854171752929688
local_in_edges_tensor generation:  0.0028221607208251953
mini_batch_src_global generation:  0.001800537109375
r_  generation:  0.020731210708618164
local_output_nid generation:  0.001165151596069336
local_in_edges_tensor generation:  0.0016291141510009766
mini_batch_src_global generation:  0.0016601085662841797
r_  generation:  0.020522117614746094
local_output_nid generation:  0.0009846687316894531
local_in_edges_tensor generation:  0.0016350746154785156
mini_batch_src_global generation:  0.0016145706176757812
r_  generation:  0.019224166870117188
local_output_nid generation:  0.0008456707000732422
local_in_edges_tensor generation:  0.001516103744506836
mini_batch_src_global generation:  0.0014395713806152344
r_  generation:  0.019312381744384766
----------------------check_connections_block total spend ----------------------------- 0.41302037239074707
generate_one_block  0.02278900146484375
generate_one_block  0.032746076583862305
generate_one_block  0.01773834228515625
generate_one_block  0.024010419845581055
generate_one_block  0.02676868438720703
generate_one_block  0.02402663230895996
generate_one_block  0.02187323570251465
generate_one_block  0.019440650939941406
generate_one_block  0.031627655029296875
generate_one_block  0.01919698715209961
generate_one_block  0.02994060516357422
generate_one_block  0.02592945098876953
generate_one_block  0.031111717224121094
generate_one_block  0.02487802505493164
generate_one_block  0.02408766746520996
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03723001480102539  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

connection checking time:  0.722679853439331
block generation total time  0.6994321346282959
average batch blocks generation time:  0.046628808975219725
block dataloader generation time/epoch 1.5178132057189941
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.032965660095214844  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([15189, 500])
torch.Size([8859, 128])
torch.Size([3742, 128])
torch.Size([695, 128])
torch.Size([141, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.05754566192626953  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03841543197631836  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([17968, 500])
torch.Size([14272, 128])
torch.Size([6435, 128])
torch.Size([1387, 128])
torch.Size([160, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.07863855361938477  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.029284000396728516  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([13386, 500])
torch.Size([5588, 128])
torch.Size([1845, 128])
torch.Size([453, 128])
torch.Size([125, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.04341840744018555  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.033016204833984375  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([15125, 500])
torch.Size([9608, 128])
torch.Size([5030, 128])
torch.Size([1789, 128])
torch.Size([491, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.06435108184814453  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.03384256362915039  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([15708, 500])
torch.Size([8554, 128])
torch.Size([2865, 128])
torch.Size([414, 128])
torch.Size([98, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.056218624114990234  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.034143924713134766  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([15880, 500])
torch.Size([8561, 128])
torch.Size([3192, 128])
torch.Size([495, 128])
torch.Size([152, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.05655527114868164  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.030689716339111328  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([13960, 500])
torch.Size([8635, 128])
torch.Size([3902, 128])
torch.Size([1125, 128])
torch.Size([122, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.05645418167114258  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.03145122528076172  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([14518, 500])
torch.Size([6999, 128])
torch.Size([2423, 128])
torch.Size([368, 128])
torch.Size([114, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.04908418655395508  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.03885793685913086  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([18226, 500])
torch.Size([13387, 128])
torch.Size([6917, 128])
torch.Size([1391, 128])
torch.Size([342, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.07855558395385742  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.0259857177734375  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([11519, 500])
torch.Size([6741, 128])
torch.Size([3035, 128])
torch.Size([705, 128])
torch.Size([96, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.04574108123779297  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.04015779495239258  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([18531, 500])
torch.Size([14201, 128])
torch.Size([8253, 128])
torch.Size([1676, 128])
torch.Size([320, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.08465147018432617  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.03675031661987305  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([17182, 500])
torch.Size([11932, 128])
torch.Size([5615, 128])
torch.Size([1447, 128])
torch.Size([293, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.07155847549438477  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.035974979400634766  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes
Using backend: pytorch

torch.Size([16431, 500])
torch.Size([11121, 128])
torch.Size([4010, 128])
torch.Size([953, 128])
torch.Size([145, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.06499528884887695  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.035999298095703125  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([16844, 500])
torch.Size([9663, 128])
torch.Size([3987, 128])
torch.Size([660, 128])
torch.Size([159, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.0630793571472168  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.03580617904663086  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

torch.Size([16466, 500])
torch.Size([8810, 128])
torch.Size([3617, 128])
torch.Size([505, 128])
torch.Size([117, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.05958843231201172  GigaBytes
Max Memory Allocated: 0.089447021484375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010707823435465495 |0.003137048085530599 |0.007633129755655925 |0.00014170010884602865 |0.005277474721272786 |0.004139900207519531 |
----------------------------------------------------------pseudo_mini_loss sum 2.1831214427948
Total (block generation + training)time/epoch 1.9512784481048584
Training time/epoch 0.43296289443969727
Training time without block to device /epoch 0.3859071731567383
Training time without total dataloading part /epoch 0.19992446899414062
load block tensor time/epoch 0.16061735153198242
block to device time/epoch 0.047055721282958984
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  466027
Number of first layer input nodes during this epoch:  236933
