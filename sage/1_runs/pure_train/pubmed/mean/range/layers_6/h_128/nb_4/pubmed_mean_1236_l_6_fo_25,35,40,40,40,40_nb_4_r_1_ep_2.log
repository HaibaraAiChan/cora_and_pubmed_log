main start at this time 1648533572.1647453
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001855611801147461
range selection method range initialization spend 8.082389831542969e-05
time for parepare:  4.6253204345703125e-05
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0011897087097167969
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  6.461143493652344e-05
----------------------check_connections_block total spend ----------------------------- 0.0019326210021972656
generate_one_block  0.001783609390258789
generate_one_block  0.0011470317840576172
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001092672348022461
gen group dst list time:  2.6464462280273438e-05
time for parepare:  0.0002455711364746094
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0005688667297363281
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  0.00011181831359863281
r_  generation:  0.0007007122039794922
----------------------check_connections_block total spend ----------------------------- 0.0024182796478271484
generate_one_block  0.0018434524536132812
generate_one_block  0.0019621849060058594
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010387897491455078
gen group dst list time:  6.198883056640625e-05
time for parepare:  0.0007154941558837891
local_output_nid generation:  8.749961853027344e-05
local_in_edges_tensor generation:  0.0003795623779296875
mini_batch_src_global generation:  0.0002923011779785156
r_  generation:  0.0034911632537841797
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.00032329559326171875
mini_batch_src_global generation:  0.0005743503570556641
r_  generation:  0.004578828811645508
----------------------check_connections_block total spend ----------------------------- 0.012776613235473633
generate_one_block  0.005562782287597656
generate_one_block  0.00678706169128418
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0023233890533447266
gen group dst list time:  0.00018858909606933594
time for parepare:  0.0013883113861083984
local_output_nid generation:  0.0003294944763183594
local_in_edges_tensor generation:  0.0010175704956054688
mini_batch_src_global generation:  0.0013408660888671875
r_  generation:  0.013005733489990234
local_output_nid generation:  0.00042700767517089844
local_in_edges_tensor generation:  0.0009071826934814453
mini_batch_src_global generation:  0.0016014575958251953
r_  generation:  0.014954090118408203
----------------------check_connections_block total spend ----------------------------- 0.04196929931640625
generate_one_block  0.01744365692138672
generate_one_block  0.02140498161315918
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018744468688964844
gen group dst list time:  0.0005023479461669922
time for parepare:  0.0016994476318359375
local_output_nid generation:  0.0009436607360839844
local_in_edges_tensor generation:  0.0019648075103759766
mini_batch_src_global generation:  0.0019845962524414062
r_  generation:  0.02278280258178711
local_output_nid generation:  0.0011267662048339844
local_in_edges_tensor generation:  0.0024635791778564453
mini_batch_src_global generation:  0.0026733875274658203
r_  generation:  0.02393031120300293
----------------------check_connections_block total spend ----------------------------- 0.0700082778930664
generate_one_block  0.0281829833984375
generate_one_block  0.030269384384155273
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018436908721923828
gen group dst list time:  0.0007274150848388672
time for parepare:  0.0016503334045410156
local_output_nid generation:  0.001264333724975586
local_in_edges_tensor generation:  0.002558469772338867
mini_batch_src_global generation:  0.002102375030517578
r_  generation:  0.02563786506652832
local_output_nid generation:  0.0013537406921386719
local_in_edges_tensor generation:  0.002411365509033203
mini_batch_src_global generation:  0.002716541290283203
r_  generation:  0.026349306106567383
----------------------check_connections_block total spend ----------------------------- 0.07719731330871582
generate_one_block  0.030484437942504883
generate_one_block  0.03311944007873535
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

connection checking time:  0.20436978340148926
block generation total time  0.17706036567687988
average batch blocks generation time:  0.08853018283843994
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.03838062286376953  GigaBytes
Max Memory Allocated: 0.03838062286376953  GigaBytes

torch.Size([19231, 500])
torch.Size([17493, 128])
torch.Size([13423, 128])
torch.Size([4884, 128])
torch.Size([1267, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.10932302474975586  GigaBytes
Max Memory Allocated: 0.10956048965454102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4237060546875 GB
    Memory Allocated: 0.039580345153808594  GigaBytes
Max Memory Allocated: 0.1114349365234375  GigaBytes

torch.Size([19297, 500])
torch.Size([17933, 128])
torch.Size([14469, 128])
torch.Size([5780, 128])
torch.Size([1538, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.11510515213012695  GigaBytes
Max Memory Allocated: 0.11544084548950195  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01854681968688965 |0.17283105850219727 |0.38309431076049805 |0.00019156932830810547 |0.010151147842407227 |0.005236625671386719 |
----------------------------------------------------------pseudo_mini_loss sum 2.3567519187927246
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  115671
Number of first layer input nodes during this epoch:  38528
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.04526376724243164  GigaBytes
Max Memory Allocated: 0.117279052734375  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005021095275878906
range selection method range initialization spend 5.602836608886719e-05
time for parepare:  4.9591064453125e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.341934204101562e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00011110305786132812
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  7.033348083496094e-05
----------------------check_connections_block total spend ----------------------------- 0.0007638931274414062
generate_one_block  0.00157928466796875
generate_one_block  0.0011286735534667969
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005362033843994141
gen group dst list time:  2.6702880859375e-05
time for parepare:  0.0002701282501220703
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0006072521209716797
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  8.726119995117188e-05
r_  generation:  0.0006551742553710938
----------------------check_connections_block total spend ----------------------------- 0.0024170875549316406
generate_one_block  0.0019142627716064453
generate_one_block  0.001810312271118164
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010082721710205078
gen group dst list time:  7.271766662597656e-05
time for parepare:  0.0007672309875488281
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.00038695335388183594
mini_batch_src_global generation:  0.00039577484130859375
r_  generation:  0.0040013790130615234
local_output_nid generation:  0.00011491775512695312
local_in_edges_tensor generation:  0.0003025531768798828
mini_batch_src_global generation:  0.0004069805145263672
r_  generation:  0.0036411285400390625
----------------------check_connections_block total spend ----------------------------- 0.012050390243530273
generate_one_block  0.0064923763275146484
generate_one_block  0.00537562370300293
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021092891693115234
gen group dst list time:  0.00018405914306640625
time for parepare:  0.0013301372528076172
local_output_nid generation:  0.0003306865692138672
local_in_edges_tensor generation:  0.0009768009185791016
mini_batch_src_global generation:  0.0009274482727050781
r_  generation:  0.012597322463989258
local_output_nid generation:  0.00039696693420410156
local_in_edges_tensor generation:  0.0008461475372314453
mini_batch_src_global generation:  0.0014629364013671875
r_  generation:  0.01335597038269043
----------------------check_connections_block total spend ----------------------------- 0.03863883018493652
generate_one_block  0.01588726043701172
generate_one_block  0.018918275833129883
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017359256744384766
gen group dst list time:  0.0004944801330566406
time for parepare:  0.0014772415161132812
local_output_nid generation:  0.0008378028869628906
local_in_edges_tensor generation:  0.0018444061279296875
mini_batch_src_global generation:  0.0018107891082763672
r_  generation:  0.021131038665771484
local_output_nid generation:  0.0011544227600097656
local_in_edges_tensor generation:  0.002355337142944336
mini_batch_src_global generation:  0.002894878387451172
r_  generation:  0.023845672607421875
----------------------check_connections_block total spend ----------------------------- 0.06786680221557617
generate_one_block  0.026653051376342773
generate_one_block  0.03261065483093262
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021352767944335938
gen group dst list time:  0.0007264614105224609
time for parepare:  0.0015797615051269531
local_output_nid generation:  0.0012848377227783203
local_in_edges_tensor generation:  0.0027036666870117188
mini_batch_src_global generation:  0.0019297599792480469
r_  generation:  0.0251617431640625
local_output_nid generation:  0.0014674663543701172
local_in_edges_tensor generation:  0.0024712085723876953
mini_batch_src_global generation:  0.0027010440826416016
r_  generation:  0.026551008224487305
----------------------check_connections_block total spend ----------------------------- 0.07731080055236816
generate_one_block  0.029840707778930664
generate_one_block  0.03433680534362793
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.04526376724243164  GigaBytes
Max Memory Allocated: 0.117279052734375  GigaBytes

connection checking time:  0.19828391075134277
block generation total time  0.17383933067321777
average batch blocks generation time:  0.08691966533660889
block dataloader generation time/epoch 0.4149763584136963
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.040802955627441406  GigaBytes
Max Memory Allocated: 0.117279052734375  GigaBytes

torch.Size([18986, 500])
torch.Size([16952, 128])
torch.Size([11687, 128])
torch.Size([4633, 128])
torch.Size([1259, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.10517597198486328  GigaBytes
Max Memory Allocated: 0.117279052734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.041605472564697266  GigaBytes
Max Memory Allocated: 0.117279052734375  GigaBytes

torch.Size([19379, 500])
torch.Size([18221, 128])
torch.Size([14431, 128])
torch.Size([5370, 128])
torch.Size([1452, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.11596250534057617  GigaBytes
Max Memory Allocated: 0.117279052734375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013787031173706055 |0.0018470287322998047 |0.007034778594970703 |0.00014019012451171875 |0.007068514823913574 |0.006254673004150391 |
----------------------------------------------------------pseudo_mini_loss sum 2.1721179485321045
Total (block generation + training)time/epoch 0.4846529960632324
Training time/epoch 0.06929397583007812
Training time without block to device /epoch 0.06559991836547852
Training time without total dataloading part /epoch 0.03474164009094238
load block tensor time/epoch 0.02757406234741211
block to device time/epoch 0.0036940574645996094
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  112725
Number of first layer input nodes during this epoch:  38365
