main start at this time 1648533594.663725
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.002860546112060547
range selection method range initialization spend 0.00010442733764648438
time for parepare:  4.410743713378906e-05
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0015294551849365234
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.7179718017578125e-05
----------------------check_connections_block total spend ----------------------------- 0.003275632858276367
generate_one_block  0.001577138900756836
generate_one_block  0.0010929107666015625
generate_one_block  0.0010426044464111328
generate_one_block  0.001024484634399414
generate_one_block  0.0010445117950439453
generate_one_block  0.001117706298828125
generate_one_block  0.0010180473327636719
generate_one_block  0.0010151863098144531
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0016124248504638672
gen group dst list time:  4.8160552978515625e-05
time for parepare:  0.00023126602172851562
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.0001876354217529297
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0002503395080566406
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001220703125
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001933574676513672
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00013017654418945312
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00011730194091796875
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0002319812774658203
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00011658668518066406
----------------------check_connections_block total spend ----------------------------- 0.0034275054931640625
generate_one_block  0.0013051033020019531
generate_one_block  0.00133514404296875
generate_one_block  0.0011899471282958984
generate_one_block  0.0013511180877685547
generate_one_block  0.0011758804321289062
generate_one_block  0.0012166500091552734
generate_one_block  0.001302957534790039
generate_one_block  0.0011360645294189453
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011644363403320312
gen group dst list time:  8.726119995117188e-05
time for parepare:  0.0007390975952148438
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00030231475830078125
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0009090900421142578
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  0.0002124309539794922
r_  generation:  0.0017168521881103516
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0006401538848876953
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  0.0001246929168701172
r_  generation:  0.0013058185577392578
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  0.0001494884490966797
r_  generation:  0.0012888908386230469
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.000698089599609375
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.00016307830810546875
r_  generation:  0.0016605854034423828
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  9.679794311523438e-05
r_  generation:  0.0005204677581787109
----------------------check_connections_block total spend ----------------------------- 0.014613151550292969
generate_one_block  0.002115488052368164
generate_one_block  0.0031464099884033203
generate_one_block  0.0017497539520263672
generate_one_block  0.0025696754455566406
generate_one_block  0.002897500991821289
generate_one_block  0.001706838607788086
generate_one_block  0.003047943115234375
generate_one_block  0.001547098159790039
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00214385986328125
gen group dst list time:  0.0002541542053222656
time for parepare:  0.0015702247619628906
local_output_nid generation:  0.00012302398681640625
local_in_edges_tensor generation:  0.0006337165832519531
mini_batch_src_global generation:  0.0004980564117431641
r_  generation:  0.004166603088378906
local_output_nid generation:  0.00018906593322753906
local_in_edges_tensor generation:  0.0004634857177734375
mini_batch_src_global generation:  0.0010209083557128906
r_  generation:  0.007779598236083984
local_output_nid generation:  0.00010180473327636719
local_in_edges_tensor generation:  0.0002827644348144531
mini_batch_src_global generation:  0.0004703998565673828
r_  generation:  0.003939390182495117
local_output_nid generation:  0.000225067138671875
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.0007405281066894531
r_  generation:  0.00762629508972168
local_output_nid generation:  0.0002205371856689453
local_in_edges_tensor generation:  0.00046253204345703125
mini_batch_src_global generation:  0.0009031295776367188
r_  generation:  0.007554054260253906
local_output_nid generation:  0.000102996826171875
local_in_edges_tensor generation:  0.00026702880859375
mini_batch_src_global generation:  0.00043392181396484375
r_  generation:  0.0033969879150390625
local_output_nid generation:  0.00015592575073242188
local_in_edges_tensor generation:  0.00036144256591796875
mini_batch_src_global generation:  0.0005767345428466797
r_  generation:  0.006234645843505859
local_output_nid generation:  8.726119995117188e-05
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  0.00034165382385253906
r_  generation:  0.002312898635864258
----------------------check_connections_block total spend ----------------------------- 0.0649418830871582
generate_one_block  0.0066220760345458984
generate_one_block  0.011887311935424805
generate_one_block  0.006113767623901367
generate_one_block  0.012265920639038086
generate_one_block  0.011156797409057617
generate_one_block  0.005262851715087891
generate_one_block  0.0094146728515625
generate_one_block  0.0037674903869628906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002346038818359375
gen group dst list time:  0.001316070556640625
time for parepare:  0.0017457008361816406
local_output_nid generation:  0.0005609989166259766
local_in_edges_tensor generation:  0.0015196800231933594
mini_batch_src_global generation:  0.0012314319610595703
r_  generation:  0.012638568878173828
local_output_nid generation:  0.0007877349853515625
local_in_edges_tensor generation:  0.0013167858123779297
mini_batch_src_global generation:  0.0018372535705566406
r_  generation:  0.017667055130004883
local_output_nid generation:  0.0005352497100830078
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0011982917785644531
r_  generation:  0.01289820671081543
local_output_nid generation:  0.0009946823120117188
local_in_edges_tensor generation:  0.001489877700805664
mini_batch_src_global generation:  0.0015869140625
r_  generation:  0.019581317901611328
local_output_nid generation:  0.0007922649383544922
local_in_edges_tensor generation:  0.0016632080078125
mini_batch_src_global generation:  0.0017940998077392578
r_  generation:  0.018685102462768555
local_output_nid generation:  0.0006082057952880859
local_in_edges_tensor generation:  0.0008265972137451172
mini_batch_src_global generation:  0.0011639595031738281
r_  generation:  0.011804819107055664
local_output_nid generation:  0.0007176399230957031
local_in_edges_tensor generation:  0.001046895980834961
mini_batch_src_global generation:  0.0011768341064453125
r_  generation:  0.015040874481201172
local_output_nid generation:  0.0003535747528076172
local_in_edges_tensor generation:  0.0005476474761962891
mini_batch_src_global generation:  0.0009479522705078125
r_  generation:  0.008691549301147461
----------------------check_connections_block total spend ----------------------------- 0.17138934135437012
generate_one_block  0.017678022384643555
generate_one_block  0.024204015731811523
generate_one_block  0.016997575759887695
generate_one_block  0.025833606719970703
generate_one_block  0.024512052536010742
generate_one_block  0.015611648559570312
generate_one_block  0.01966691017150879
generate_one_block  0.01306915283203125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020711421966552734
gen group dst list time:  0.002692699432373047
time for parepare:  0.0017330646514892578
local_output_nid generation:  0.0011341571807861328
local_in_edges_tensor generation:  0.002531766891479492
mini_batch_src_global generation:  0.0021753311157226562
r_  generation:  0.02191615104675293
local_output_nid generation:  0.0013163089752197266
local_in_edges_tensor generation:  0.002655506134033203
mini_batch_src_global generation:  0.0025548934936523438
r_  generation:  0.0235593318939209
local_output_nid generation:  0.0011680126190185547
local_in_edges_tensor generation:  0.0017020702362060547
mini_batch_src_global generation:  0.001917123794555664
r_  generation:  0.02099299430847168
local_output_nid generation:  0.0015192031860351562
local_in_edges_tensor generation:  0.005120038986206055
mini_batch_src_global generation:  0.0019655227661132812
r_  generation:  0.02484440803527832
local_output_nid generation:  0.0015308856964111328
local_in_edges_tensor generation:  0.0021686553955078125
mini_batch_src_global generation:  0.001986265182495117
r_  generation:  0.024953842163085938
local_output_nid generation:  0.0011227130889892578
local_in_edges_tensor generation:  0.0016074180603027344
mini_batch_src_global generation:  0.0017180442810058594
r_  generation:  0.020667314529418945
local_output_nid generation:  0.0011336803436279297
local_in_edges_tensor generation:  0.0018165111541748047
mini_batch_src_global generation:  0.0017979145050048828
r_  generation:  0.02207207679748535
local_output_nid generation:  0.001020669937133789
local_in_edges_tensor generation:  0.0014464855194091797
mini_batch_src_global generation:  0.0016918182373046875
r_  generation:  0.020200252532958984
----------------------check_connections_block total spend ----------------------------- 0.26328325271606445
generate_one_block  0.027328014373779297
generate_one_block  0.03047013282775879
generate_one_block  0.02729344367980957
generate_one_block  0.030321121215820312
generate_one_block  0.030377626419067383
generate_one_block  0.026376724243164062
generate_one_block  0.02725529670715332
generate_one_block  0.025917768478393555
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

connection checking time:  0.5176551342010498
block generation total time  0.4781975746154785
average batch blocks generation time:  0.059774696826934814
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03588390350341797  GigaBytes
Max Memory Allocated: 0.03588390350341797  GigaBytes

torch.Size([18229, 500])
torch.Size([13019, 128])
torch.Size([6549, 128])
torch.Size([1656, 128])
torch.Size([399, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.0755915641784668  GigaBytes
Max Memory Allocated: 0.0756678581237793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.03837156295776367  GigaBytes
Max Memory Allocated: 0.0780935287475586  GigaBytes

torch.Size([18465, 500])
torch.Size([14711, 128])
torch.Size([8981, 128])
torch.Size([2464, 128])
torch.Size([534, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.08778905868530273  GigaBytes
Max Memory Allocated: 0.08791399002075195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.035241127014160156  GigaBytes
Max Memory Allocated: 0.08984661102294922  GigaBytes

torch.Size([17362, 500])
torch.Size([11425, 128])
torch.Size([5652, 128])
torch.Size([1070, 128])
torch.Size([240, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.06821870803833008  GigaBytes
Max Memory Allocated: 0.08984661102294922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.03843069076538086  GigaBytes
Max Memory Allocated: 0.08984661102294922  GigaBytes

torch.Size([18811, 500])
torch.Size([15996, 128])
torch.Size([10690, 128])
torch.Size([2479, 128])
torch.Size([487, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.09254598617553711  GigaBytes
Max Memory Allocated: 0.09328603744506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.0384058952331543  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

torch.Size([18574, 500])
torch.Size([16010, 128])
torch.Size([8968, 128])
torch.Size([2624, 128])
torch.Size([335, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.08899974822998047  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.03501462936401367  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

torch.Size([17267, 500])
torch.Size([11957, 128])
torch.Size([5536, 128])
torch.Size([1178, 128])
torch.Size([275, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.06918859481811523  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.035851478576660156  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

torch.Size([17593, 500])
torch.Size([12504, 128])
torch.Size([7255, 128])
torch.Size([1881, 128])
torch.Size([473, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.07624053955078125  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.0338134765625  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

torch.Size([16680, 500])
torch.Size([10994, 128])
torch.Size([3520, 128])
torch.Size([946, 128])
torch.Size([163, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.06197929382324219  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013786226511001587 |0.04503849148750305 |0.10230591893196106 |0.00015085935592651367 |0.006111174821853638 |0.0038046836853027344 |
----------------------------------------------------------pseudo_mini_loss sum 2.24345064163208
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  324308
Number of first layer input nodes during this epoch:  142981
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03751993179321289  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00048661231994628906
range selection method range initialization spend 5.626678466796875e-05
time for parepare:  4.792213439941406e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.4066696166992188e-05
----------------------check_connections_block total spend ----------------------------- 0.0016100406646728516
generate_one_block  0.0010650157928466797
generate_one_block  0.0010390281677246094
generate_one_block  0.0010204315185546875
generate_one_block  0.0010194778442382812
generate_one_block  0.0010302066802978516
generate_one_block  0.0011887550354003906
generate_one_block  0.0010333061218261719
generate_one_block  0.0010075569152832031
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005230903625488281
gen group dst list time:  5.1975250244140625e-05
time for parepare:  0.000274658203125
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0001380443572998047
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.00035190582275390625
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00011086463928222656
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  9.989738464355469e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001900196075439453
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002579689025878906
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001595020294189453
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  6.461143493652344e-05
----------------------check_connections_block total spend ----------------------------- 0.003503084182739258
generate_one_block  0.0012102127075195312
generate_one_block  0.0014650821685791016
generate_one_block  0.0011420249938964844
generate_one_block  0.0011396408081054688
generate_one_block  0.0012469291687011719
generate_one_block  0.001340627670288086
generate_one_block  0.0012080669403076172
generate_one_block  0.0010750293731689453
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011801719665527344
gen group dst list time:  0.000102996826171875
time for parepare:  0.0007607936859130859
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0002865791320800781
mini_batch_src_global generation:  0.00012040138244628906
r_  generation:  0.0009474754333496094
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  0.00028252601623535156
r_  generation:  0.0023419857025146484
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.0005414485931396484
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0008075237274169922
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  0.0001266002655029297
r_  generation:  0.0012044906616210938
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  0.0001595020294189453
r_  generation:  0.001619577407836914
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  0.00011849403381347656
r_  generation:  0.0008652210235595703
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0002982616424560547
----------------------check_connections_block total spend ----------------------------- 0.014551639556884766
generate_one_block  0.0027654170989990234
generate_one_block  0.0039501190185546875
generate_one_block  0.0015439987182617188
generate_one_block  0.0019125938415527344
generate_one_block  0.0023620128631591797
generate_one_block  0.002889394760131836
generate_one_block  0.0019116401672363281
generate_one_block  0.001268625259399414
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019598007202148438
gen group dst list time:  0.00028586387634277344
time for parepare:  0.0014579296112060547
local_output_nid generation:  0.00015687942504882812
local_in_edges_tensor generation:  0.0006732940673828125
mini_batch_src_global generation:  0.0006222724914550781
r_  generation:  0.0061419010162353516
local_output_nid generation:  0.00018334388732910156
local_in_edges_tensor generation:  0.0004343986511230469
mini_batch_src_global generation:  0.0008306503295898438
r_  generation:  0.0071849822998046875
local_output_nid generation:  8.249282836914062e-05
local_in_edges_tensor generation:  0.0002315044403076172
mini_batch_src_global generation:  0.0003669261932373047
r_  generation:  0.002729177474975586
local_output_nid generation:  0.00014257431030273438
local_in_edges_tensor generation:  0.0003426074981689453
mini_batch_src_global generation:  0.0005013942718505859
r_  generation:  0.0049936771392822266
local_output_nid generation:  0.00018358230590820312
local_in_edges_tensor generation:  0.0004973411560058594
mini_batch_src_global generation:  0.0006272792816162109
r_  generation:  0.006318092346191406
local_output_nid generation:  0.00022864341735839844
local_in_edges_tensor generation:  0.0005979537963867188
mini_batch_src_global generation:  0.0006768703460693359
r_  generation:  0.0068857669830322266
local_output_nid generation:  0.00014781951904296875
local_in_edges_tensor generation:  0.0003647804260253906
mini_batch_src_global generation:  0.0005133152008056641
r_  generation:  0.004403114318847656
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.0002562999725341797
r_  generation:  0.001708984375
----------------------check_connections_block total spend ----------------------------- 0.06061673164367676
generate_one_block  0.010165929794311523
generate_one_block  0.009747028350830078
generate_one_block  0.0047338008880615234
generate_one_block  0.0077974796295166016
generate_one_block  0.009908437728881836
generate_one_block  0.010196447372436523
generate_one_block  0.007140636444091797
generate_one_block  0.003221750259399414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022547245025634766
gen group dst list time:  0.0011067390441894531
time for parepare:  0.0015940666198730469
local_output_nid generation:  0.000644683837890625
local_in_edges_tensor generation:  0.0017962455749511719
mini_batch_src_global generation:  0.0016334056854248047
r_  generation:  0.017414569854736328
local_output_nid generation:  0.0005450248718261719
local_in_edges_tensor generation:  0.0012309551239013672
mini_batch_src_global generation:  0.0017707347869873047
r_  generation:  0.014066696166992188
local_output_nid generation:  0.0005209445953369141
local_in_edges_tensor generation:  0.0007855892181396484
mini_batch_src_global generation:  0.0010478496551513672
r_  generation:  0.012008190155029297
local_output_nid generation:  0.0006535053253173828
local_in_edges_tensor generation:  0.0011563301086425781
mini_batch_src_global generation:  0.00124359130859375
r_  generation:  0.014893531799316406
local_output_nid generation:  0.000858306884765625
local_in_edges_tensor generation:  0.0013186931610107422
mini_batch_src_global generation:  0.0015194416046142578
r_  generation:  0.018465280532836914
local_output_nid generation:  0.0010161399841308594
local_in_edges_tensor generation:  0.0015573501586914062
mini_batch_src_global generation:  0.0015251636505126953
r_  generation:  0.018320560455322266
local_output_nid generation:  0.0007877349853515625
local_in_edges_tensor generation:  0.0010676383972167969
mini_batch_src_global generation:  0.0013780593872070312
r_  generation:  0.014850854873657227
local_output_nid generation:  0.0004100799560546875
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.0007739067077636719
r_  generation:  0.00672149658203125
----------------------check_connections_block total spend ----------------------------- 0.1712327003479004
generate_one_block  0.021959543228149414
generate_one_block  0.018817424774169922
generate_one_block  0.016315460205078125
generate_one_block  0.020115375518798828
generate_one_block  0.024477005004882812
generate_one_block  0.023035764694213867
generate_one_block  0.019237995147705078
generate_one_block  0.010023355484008789
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017650127410888672
gen group dst list time:  0.0025603771209716797
time for parepare:  0.0018377304077148438
local_output_nid generation:  0.0013325214385986328
local_in_edges_tensor generation:  0.0026519298553466797
mini_batch_src_global generation:  0.002257823944091797
r_  generation:  0.024027109146118164
local_output_nid generation:  0.001043081283569336
local_in_edges_tensor generation:  0.0019495487213134766
mini_batch_src_global generation:  0.002368927001953125
r_  generation:  0.02077174186706543
local_output_nid generation:  0.0012350082397460938
local_in_edges_tensor generation:  0.0017025470733642578
mini_batch_src_global generation:  0.0016524791717529297
r_  generation:  0.020758390426635742
local_output_nid generation:  0.001241922378540039
local_in_edges_tensor generation:  0.0022983551025390625
mini_batch_src_global generation:  0.0017850399017333984
r_  generation:  0.022205591201782227
local_output_nid generation:  0.0014934539794921875
local_in_edges_tensor generation:  0.002108335494995117
mini_batch_src_global generation:  0.002028942108154297
r_  generation:  0.024616003036499023
local_output_nid generation:  0.0015537738800048828
local_in_edges_tensor generation:  0.002111673355102539
mini_batch_src_global generation:  0.0019183158874511719
r_  generation:  0.024692058563232422
local_output_nid generation:  0.0013401508331298828
local_in_edges_tensor generation:  0.0017383098602294922Using backend: pytorch

mini_batch_src_global generation:  0.0018582344055175781
r_  generation:  0.023030757904052734
local_output_nid generation:  0.0007996559143066406
local_in_edges_tensor generation:  0.001230001449584961
mini_batch_src_global generation:  0.0015401840209960938
r_  generation:  0.017648935317993164
----------------------check_connections_block total spend ----------------------------- 0.2583746910095215
generate_one_block  0.02913951873779297
generate_one_block  0.026909351348876953
generate_one_block  0.03008580207824707
generate_one_block  0.029181957244873047
generate_one_block  0.030637264251708984
generate_one_block  0.030837297439575195
generate_one_block  0.028575897216796875
generate_one_block  0.02307891845703125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.03751993179321289  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

connection checking time:  0.5082788467407227
block generation total time  0.4737708568572998
average batch blocks generation time:  0.059221357107162476
block dataloader generation time/epoch 1.0434021949768066
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.038872718811035156  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

torch.Size([18153, 500])
torch.Size([14784, 128])
torch.Size([7506, 128])
torch.Size([1956, 128])
torch.Size([298, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.08307790756225586  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.0364680290222168  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

torch.Size([16896, 500])
torch.Size([11628, 128])
torch.Size([6432, 128])
torch.Size([2250, 128])
torch.Size([617, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.07507514953613281  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.037172794342041016  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

torch.Size([17387, 500])
torch.Size([11442, 128])
torch.Size([5138, 128])
torch.Size([861, 128])
torch.Size([250, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.06865406036376953  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03795576095581055  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

torch.Size([17712, 500])
torch.Size([12882, 128])
torch.Size([6461, 128])
torch.Size([1533, 128])
torch.Size([238, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.07651472091674805  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.04028654098510742  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

torch.Size([18609, 500])
torch.Size([15399, 128])
torch.Size([8930, 128])
torch.Size([2050, 128])
torch.Size([438, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.08897972106933594  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.040277957916259766  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

torch.Size([18860, 500])
torch.Size([15470, 128])
torch.Size([9927, 128])
torch.Size([2728, 128])
torch.Size([602, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.09286212921142578  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03859853744506836  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

torch.Size([18072, 500])
torch.Size([13751, 128])
torch.Size([6770, 128])
torch.Size([1577, 128])
torch.Size([304, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.0788884162902832  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03503847122192383  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

torch.Size([16373, 500])
torch.Size([8647, 128])
torch.Size([3506, 128])
torch.Size([505, 128])
torch.Size([117, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.05922985076904297  GigaBytes
Max Memory Allocated: 0.0969233512878418  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012892335653305054 |0.001748412847518921 |0.007043808698654175 |0.00014087557792663574 |0.004658490419387817 |0.006353855133056641 |
----------------------------------------------------------pseudo_mini_loss sum 1.8923176527023315
Total (block generation + training)time/epoch 1.2755153179168701
Training time/epoch 0.23152375221252441
Training time without block to device /epoch 0.21753644943237305
Training time without total dataloading part /epoch 0.10109925270080566
load block tensor time/epoch 0.10313868522644043
block to device time/epoch 0.013987302780151367
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  317416
Number of first layer input nodes during this epoch:  142062
