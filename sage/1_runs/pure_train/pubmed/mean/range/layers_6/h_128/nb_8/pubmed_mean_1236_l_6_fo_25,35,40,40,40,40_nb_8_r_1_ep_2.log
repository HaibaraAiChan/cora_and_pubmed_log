main start at this time 1648533583.1832294
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0014495849609375
range selection method range initialization spend 8.797645568847656e-05
time for parepare:  4.696846008300781e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0011887550354003906
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.2438507080078125e-05
----------------------check_connections_block total spend ----------------------------- 0.0023026466369628906
generate_one_block  0.0016546249389648438
generate_one_block  0.0011115074157714844
generate_one_block  0.0010712146759033203
generate_one_block  0.0010781288146972656
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0008726119995117188
gen group dst list time:  3.457069396972656e-05
time for parepare:  0.0002446174621582031
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00029850006103515625
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.00030922889709472656
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00033354759216308594
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00039505958557128906
----------------------check_connections_block total spend ----------------------------- 0.0028028488159179688
generate_one_block  0.0014605522155761719
generate_one_block  0.0015060901641845703
generate_one_block  0.0014927387237548828
generate_one_block  0.0015501976013183594
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010132789611816406
gen group dst list time:  0.00010633468627929688
time for parepare:  0.0007791519165039062
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00028896331787109375
mini_batch_src_global generation:  0.00013256072998046875
r_  generation:  0.001543283462524414
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.0002257823944091797
r_  generation:  0.0022203922271728516
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  0.0002582073211669922
r_  generation:  0.0024900436401367188
local_output_nid generation:  6.604194641113281e-05
local_in_edges_tensor generation:  0.0002276897430419922
mini_batch_src_global generation:  0.00028443336486816406
r_  generation:  0.0025517940521240234
----------------------check_connections_block total spend ----------------------------- 0.013937234878540039
generate_one_block  0.0032427310943603516
generate_one_block  0.0035698413848876953
generate_one_block  0.004059791564941406
generate_one_block  0.003886699676513672
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001813650131225586
gen group dst list time:  0.00022840499877929688
time for parepare:  0.0014808177947998047
local_output_nid generation:  0.00018262863159179688
local_in_edges_tensor generation:  0.0007021427154541016
mini_batch_src_global generation:  0.0007586479187011719
r_  generation:  0.0066988468170166016
local_output_nid generation:  0.0002193450927734375
local_in_edges_tensor generation:  0.0009741783142089844
mini_batch_src_global generation:  0.0011653900146484375
r_  generation:  0.008517742156982422
local_output_nid generation:  0.0002949237823486328
local_in_edges_tensor generation:  0.0006487369537353516
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.012011051177978516
local_output_nid generation:  0.0002562999725341797
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.000988006591796875
r_  generation:  0.008593320846557617
----------------------check_connections_block total spend ----------------------------- 0.05435037612915039
generate_one_block  0.009250879287719727
generate_one_block  0.011815786361694336
generate_one_block  0.01568150520324707
generate_one_block  0.013413667678833008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016851425170898438
gen group dst list time:  0.0007784366607666016
time for parepare:  0.0018432140350341797
local_output_nid generation:  0.0007355213165283203
local_in_edges_tensor generation:  0.0016188621520996094
mini_batch_src_global generation:  0.001512765884399414
r_  generation:  0.016644954681396484
local_output_nid generation:  0.0007414817810058594
local_in_edges_tensor generation:  0.0016970634460449219
mini_batch_src_global generation:  0.0021414756774902344
r_  generation:  0.01842498779296875
local_output_nid generation:  0.0011396408081054688
local_in_edges_tensor generation:  0.0017726421356201172
mini_batch_src_global generation:  0.001976490020751953
r_  generation:  0.0227813720703125
local_output_nid generation:  0.001013040542602539
local_in_edges_tensor generation:  0.0015826225280761719
mini_batch_src_global generation:  0.0016150474548339844
r_  generation:  0.019648313522338867
----------------------check_connections_block total spend ----------------------------- 0.11461973190307617
generate_one_block  0.020298242568969727
generate_one_block  0.024945497512817383
generate_one_block  0.028882741928100586
generate_one_block  0.02566361427307129
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001692056655883789
gen group dst list time:  0.0013308525085449219
time for parepare:  0.0016875267028808594
local_output_nid generation:  0.0012218952178955078
local_in_edges_tensor generation:  0.002378225326538086
mini_batch_src_global generation:  0.0020465850830078125
r_  generation:  0.024090051651000977
local_output_nid generation:  0.0013659000396728516
local_in_edges_tensor generation:  0.002679109573364258
mini_batch_src_global generation:  0.002550840377807617
r_  generation:  0.024589061737060547
local_output_nid generation:  0.0015397071838378906
local_in_edges_tensor generation:  0.0027472972869873047
mini_batch_src_global generation:  0.0022003650665283203
r_  generation:  0.0263063907623291
local_output_nid generation:  0.0014946460723876953
local_in_edges_tensor generation:  0.0023512840270996094
mini_batch_src_global generation:  0.002031087875366211
r_  generation:  0.025140762329101562
----------------------check_connections_block total spend ----------------------------- 0.14781975746154785
generate_one_block  0.029137372970581055
generate_one_block  0.03151702880859375
generate_one_block  0.03220772743225098
generate_one_block  0.030617237091064453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

connection checking time:  0.3335299491882324
block generation total time  0.29419994354248047
average batch blocks generation time:  0.07354998588562012
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.037270545959472656  GigaBytes
Max Memory Allocated: 0.037270545959472656  GigaBytes

torch.Size([18795, 500])
torch.Size([14753, 128])
torch.Size([9185, 128])
torch.Size([2521, 128])
torch.Size([664, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.0868234634399414  GigaBytes
Max Memory Allocated: 0.08695030212402344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.03840208053588867  GigaBytes
Max Memory Allocated: 0.0894627571105957  GigaBytes

torch.Size([18448, 500])
torch.Size([14787, 128])
torch.Size([8976, 128])
torch.Size([2847, 128])
torch.Size([621, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.0892949104309082  GigaBytes
Max Memory Allocated: 0.0894627571105957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.038918495178222656  GigaBytes
Max Memory Allocated: 0.09065437316894531  GigaBytes

torch.Size([19042, 500])
torch.Size([17183, 128])
torch.Size([12638, 128])
torch.Size([4042, 128])
torch.Size([813, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.10306406021118164  GigaBytes
Max Memory Allocated: 0.10357952117919922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.03845548629760742  GigaBytes
Max Memory Allocated: 0.1056680679321289  GigaBytes

torch.Size([18751, 500])
torch.Size([15613, 128])
torch.Size([9830, 128])
torch.Size([3025, 128])
torch.Size([765, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.0923457145690918  GigaBytes
Max Memory Allocated: 0.1056680679321289  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013451874256134033 |0.08705693483352661 |0.1996343731880188 |0.00017917156219482422 |0.007527530193328857 |0.0036482810974121094 |
----------------------------------------------------------pseudo_mini_loss sum 1.9647178649902344
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  193655
Number of first layer input nodes during this epoch:  75036
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.043379783630371094  GigaBytes
Max Memory Allocated: 0.1056680679321289  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005068778991699219
range selection method range initialization spend 5.8650970458984375e-05
time for parepare:  5.030632019042969e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.125999450683594e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.5299530029296875e-05
----------------------check_connections_block total spend ----------------------------- 0.001016855239868164
generate_one_block  0.001157522201538086
generate_one_block  0.0010547637939453125
generate_one_block  0.0011751651763916016
generate_one_block  0.0010755062103271484
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000537872314453125
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.00028014183044433594
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0004696846008300781
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0001933574676513672
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0003418922424316406
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00033736228942871094
----------------------check_connections_block total spend ----------------------------- 0.0028884410858154297
generate_one_block  0.001645803451538086
generate_one_block  0.0012674331665039062
generate_one_block  0.0014789104461669922
generate_one_block  0.0014383792877197266
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010211467742919922
gen group dst list time:  8.177757263183594e-05
time for parepare:  0.0008037090301513672
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.00033855438232421875
mini_batch_src_global generation:  0.0003197193145751953
r_  generation:  0.003116607666015625
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.0001990795135498047
r_  generation:  0.001287221908569336
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  0.00019407272338867188
r_  generation:  0.0021898746490478516
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  0.00020384788513183594
r_  generation:  0.0018780231475830078
----------------------check_connections_block total spend ----------------------------- 0.013533353805541992
generate_one_block  0.0051953792572021484
generate_one_block  0.002572298049926758
generate_one_block  0.0035867691040039062
generate_one_block  0.003158092498779297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020089149475097656
gen group dst list time:  0.00023126602172851562
time for parepare:  0.0014736652374267578
local_output_nid generation:  0.0002529621124267578
local_in_edges_tensor generation:  0.0008432865142822266
mini_batch_src_global generation:  0.0008335113525390625
r_  generation:  0.01026153564453125
local_output_nid generation:  0.0001895427703857422
local_in_edges_tensor generation:  0.0004360675811767578
mini_batch_src_global generation:  0.0007860660552978516
r_  generation:  0.006997108459472656
local_output_nid generation:  0.0002779960632324219
local_in_edges_tensor generation:  0.0005741119384765625
mini_batch_src_global generation:  0.0009169578552246094
r_  generation:  Using backend: pytorch
0.01045370101928711
local_output_nid generation:  0.000274658203125
local_in_edges_tensor generation:  0.0005357265472412109
mini_batch_src_global generation:  0.0008497238159179688
r_  generation:  0.0076482295989990234
----------------------check_connections_block total spend ----------------------------- 0.05405473709106445
generate_one_block  0.014230966567993164
generate_one_block  0.010596513748168945
generate_one_block  0.014783143997192383
generate_one_block  0.011993646621704102
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016510486602783203
gen group dst list time:  0.0007712841033935547
time for parepare:  0.0015904903411865234
local_output_nid generation:  0.0007724761962890625
local_in_edges_tensor generation:  0.0016398429870605469
mini_batch_src_global generation:  0.0016243457794189453
r_  generation:  0.019646167755126953
local_output_nid generation:  0.0007190704345703125
local_in_edges_tensor generation:  0.00139617919921875
mini_batch_src_global generation:  0.0020461082458496094
r_  generation:  0.017518997192382812
local_output_nid generation:  0.0011310577392578125
local_in_edges_tensor generation:  0.0019218921661376953
mini_batch_src_global generation:  0.0019254684448242188
r_  generation:  0.022467374801635742
local_output_nid generation:  0.0010869503021240234
local_in_edges_tensor generation:  0.0014386177062988281
mini_batch_src_global generation:  0.0018308162689208984
r_  generation:  0.019907236099243164
----------------------check_connections_block total spend ----------------------------- 0.11912798881530762
generate_one_block  0.025915861129760742
generate_one_block  0.023367881774902344
generate_one_block  0.028668880462646484
generate_one_block  0.026920318603515625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001743316650390625
gen group dst list time:  0.0013349056243896484
time for parepare:  0.0016605854034423828
local_output_nid generation:  0.0012593269348144531
local_in_edges_tensor generation:  0.002446413040161133
mini_batch_src_global generation:  0.0019669532775878906
r_  generation:  0.02665257453918457
local_output_nid generation:  0.0014524459838867188
local_in_edges_tensor generation:  0.002586841583251953
mini_batch_src_global generation:  0.002614736557006836
r_  generation:  0.02396869659423828
local_output_nid generation:  0.0017254352569580078
local_in_edges_tensor generation:  0.002505064010620117
mini_batch_src_global generation:  0.0022237300872802734
r_  generation:  0.02713155746459961
local_output_nid generation:  0.0018222332000732422
local_in_edges_tensor generation:  0.0021097660064697266
mini_batch_src_global generation:  0.0019845962524414062
r_  generation:  0.026777029037475586
----------------------check_connections_block total spend ----------------------------- 0.15241169929504395
generate_one_block  0.02954578399658203
generate_one_block  0.030331134796142578
generate_one_block  0.03279280662536621
generate_one_block  0.03183317184448242
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.043379783630371094  GigaBytes
Max Memory Allocated: 0.1056680679321289  GigaBytes

connection checking time:  0.34201622009277344
block generation total time  0.30132317543029785
average batch blocks generation time:  0.07533079385757446
block dataloader generation time/epoch 0.6926345825195312
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.04044294357299805  GigaBytes
Max Memory Allocated: 0.1056680679321289  GigaBytes

torch.Size([18519, 500])
torch.Size([15716, 128])
torch.Size([9521, 128])
torch.Size([3458, 128])
torch.Size([866, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.09467887878417969  GigaBytes
Max Memory Allocated: 0.1056680679321289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.038991451263427734  GigaBytes
Max Memory Allocated: 0.1056680679321289  GigaBytes

torch.Size([18205, 500])
torch.Size([14157, 128])
torch.Size([8099, 128])
torch.Size([2081, 128])
torch.Size([433, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.0845952033996582  GigaBytes
Max Memory Allocated: 0.1056680679321289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.040903568267822266  GigaBytes
Max Memory Allocated: 0.1056680679321289  GigaBytes

torch.Size([19100, 500])
torch.Size([16990, 128])
torch.Size([12119, 128])
torch.Size([3394, 128])
torch.Size([822, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.10237360000610352  GigaBytes
Max Memory Allocated: 0.1056680679321289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4744873046875 GB
    Memory Allocated: 0.04061126708984375  GigaBytes
Max Memory Allocated: 0.1056680679321289  GigaBytes

torch.Size([19020, 500])
torch.Size([16296, 128])
torch.Size([10334, 128])
torch.Size([3048, 128])
torch.Size([697, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4744873046875 GB
    Memory Allocated: 0.09719181060791016  GigaBytes
Max Memory Allocated: 0.1056680679321289  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01500624418258667 |0.0020307302474975586 |0.0076683759689331055 |0.00014209747314453125 |0.005998790264129639 |0.0028810501098632812 |
----------------------------------------------------------pseudo_mini_loss sum 1.7172527313232422
Total (block generation + training)time/epoch 0.8257811069488525
Training time/epoch 0.13275527954101562
Training time without block to device /epoch 0.12463235855102539
Training time without total dataloading part /epoch 0.05811810493469238
load block tensor time/epoch 0.06002497673034668
block to device time/epoch 0.008122920989990234
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  193232
Number of first layer input nodes during this epoch:  74844
