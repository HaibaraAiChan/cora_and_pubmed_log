main start at this time 1648533442.614739
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00016260147094726562  GigaBytes
Max Memory Allocated: 0.00016260147094726562  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0008814334869384766
range selection method range initialization spend 0.0001068115234375
time for parepare:  5.507469177246094e-05
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00021839141845703125
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0015096664428710938
----------------------check_connections_block total spend ----------------------------- 0.0020542144775390625
generate_one_block  0.0018200874328613281
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007479190826416016
gen group dst list time:  2.5033950805664062e-05
time for parepare:  0.0002942085266113281
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00026226043701171875
mini_batch_src_global generation:  0.0001697540283203125
r_  generation:  0.001416921615600586
----------------------check_connections_block total spend ----------------------------- 0.0025827884674072266
generate_one_block  0.0033414363861083984
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011839866638183594
gen group dst list time:  7.104873657226562e-05
time for parepare:  0.0008928775787353516
local_output_nid generation:  0.00022673606872558594
local_in_edges_tensor generation:  0.000614166259765625
mini_batch_src_global generation:  0.0008518695831298828
r_  generation:  0.008344173431396484
----------------------check_connections_block total spend ----------------------------- 0.013459920883178711
generate_one_block  0.00998830795288086
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018451213836669922
gen group dst list time:  0.00018930435180664062
time for parepare:  0.0017786026000976562
local_output_nid generation:  0.0007123947143554688
local_in_edges_tensor generation:  0.0014870166778564453
mini_batch_src_global generation:  0.0020775794982910156
r_  generation:  0.01841282844543457
----------------------check_connections_block total spend ----------------------------- 0.03042435646057129
generate_one_block  0.02343130111694336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018792152404785156
gen group dst list time:  0.00030350685119628906
time for parepare:  0.0016613006591796875
local_output_nid generation:  0.0010814666748046875
local_in_edges_tensor generation:  0.002354860305786133
mini_batch_src_global generation:  0.002526521682739258
r_  generation:  0.026075363159179688
----------------------check_connections_block total spend ----------------------------- 0.04034757614135742
generate_one_block  0.0313873291015625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022661685943603516
gen group dst list time:  0.0003902912139892578
time for parepare:  0.0015616416931152344
local_output_nid generation:  0.001241922378540039
local_in_edges_tensor generation:  0.0027408599853515625
mini_batch_src_global generation:  0.0022492408752441406
r_  generation:  0.02711200714111328
----------------------check_connections_block total spend ----------------------------- 0.04170870780944824
generate_one_block  0.0319063663482666
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00016260147094726562  GigaBytes
Max Memory Allocated: 0.00016260147094726562  GigaBytes

connection checking time:  0.1285233497619629
block generation total time  0.10005474090576172
average batch blocks generation time:  0.10005474090576172
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.0391387939453125  GigaBytes
Max Memory Allocated: 0.0391387939453125  GigaBytes

torch.Size([19504, 500])
torch.Size([18707, 32])
torch.Size([16293, 32])
torch.Size([8109, 32])
torch.Size([2582, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.06255865097045898  GigaBytes
Max Memory Allocated: 0.06264781951904297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013393163681030273 |0.34595823287963867 |0.7693665027618408 |0.00026726722717285156 |0.013662338256835938 |0.0077517032623291016 |
----------------------------------------------------------pseudo_mini_loss sum 2.59814453125
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  65549
Number of first layer input nodes during this epoch:  19504
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.04375886917114258  GigaBytes
Max Memory Allocated: 0.06325578689575195  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005507469177246094
range selection method range initialization spend 6.67572021484375e-05
time for parepare:  5.817413330078125e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00012040138244628906
----------------------check_connections_block total spend ----------------------------- 0.0005443096160888672
generate_one_block  0.0014717578887939453
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005288124084472656
gen group dst list time:  3.361701965332031e-05
time for parepare:  0.00025391578674316406
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  0.0001347064971923828
r_  generation:  0.0011467933654785156
----------------------check_connections_block total spend ----------------------------- 0.0021409988403320312
generate_one_block  0.0026068687438964844
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000985860824584961
gen group dst list time:  5.91278076171875e-05
time for parepare:  0.00077056884765625
local_output_nid generation:  0.00017762184143066406
local_in_edges_tensor generation:  0.0005278587341308594
mini_batch_src_global generation:  0.0007741451263427734
r_  generation:  0.006818056106567383
----------------------check_connections_block total spend ----------------------------- 0.010966300964355469
generate_one_block  0.010541439056396484
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019707679748535156
gen group dst list time:  0.0001399517059326172
time for parepare:  0.0012996196746826172
local_output_nid generation:  0.0005514621734619141
local_in_edges_tensor generation:  0.0013391971588134766
mini_batch_src_global generation:  0.0017261505126953125
r_  generation:  0.01776289939880371
----------------------check_connections_block total spend ----------------------------- 0.02776813507080078
generate_one_block  0.024001598358154297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002207517623901367
gen group dst list time:  0.0002982616424560547
time for parepare:  0.001435995101928711
local_output_nid generation:  0.0010883808135986328
local_in_edges_tensor generation:  0.0023620128631591797
mini_batch_src_global generation:  0.0022017955780029297
r_  generation: Using backend: pytorch
 0.024987220764160156
----------------------check_connections_block total spend ----------------------------- 0.038641929626464844
generate_one_block  0.03108501434326172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021076202392578125
gen group dst list time:  0.0004200935363769531
time for parepare:  0.001516103744506836
local_output_nid generation:  0.001251220703125
local_in_edges_tensor generation:  0.002591848373413086
mini_batch_src_global generation:  0.0020055770874023438
r_  generation:  0.026027441024780273
----------------------check_connections_block total spend ----------------------------- 0.04006195068359375
generate_one_block  0.03189253807067871
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.04375886917114258  GigaBytes
Max Memory Allocated: 0.06325578689575195  GigaBytes

connection checking time:  0.11957931518554688
block generation total time  0.1001274585723877
average batch blocks generation time:  0.1001274585723877
block dataloader generation time/epoch 0.26514768600463867
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.039603233337402344  GigaBytes
Max Memory Allocated: 0.07484960556030273  GigaBytes

torch.Size([19495, 500])
torch.Size([18681, 32])
torch.Size([16278, 32])
torch.Size([8089, 32])
torch.Size([2577, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.06299066543579102  GigaBytes
Max Memory Allocated: 0.07484960556030273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011064291000366211 |0.0019659996032714844 |0.007224559783935547 |0.000156402587890625 |0.0066492557525634766 |0.0027115345001220703 |
----------------------------------------------------------pseudo_mini_loss sum 2.0961639881134033
Total (block generation + training)time/epoch 0.2968778610229492
Training time/epoch 0.03152823448181152
Training time without block to device /epoch 0.02956223487854004
Training time without total dataloading part /epoch 0.01674175262451172
load block tensor time/epoch 0.011064291000366211
block to device time/epoch 0.0019659996032714844
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.1920928955078125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  65474
Number of first layer input nodes during this epoch:  19495
