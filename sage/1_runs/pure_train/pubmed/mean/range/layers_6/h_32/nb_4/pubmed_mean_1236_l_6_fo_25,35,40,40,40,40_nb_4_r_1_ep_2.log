main start at this time 1648533453.4476247
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00016260147094726562  GigaBytes
Max Memory Allocated: 0.00016260147094726562  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.002038240432739258
range selection method range initialization spend 8.487701416015625e-05
time for parepare:  4.291534423828125e-05
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0011668205261230469
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  5.4836273193359375e-05
----------------------check_connections_block total spend ----------------------------- 0.0018858909606933594
generate_one_block  0.0012977123260498047
generate_one_block  0.0011065006256103516
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001203775405883789
gen group dst list time:  2.47955322265625e-05
time for parepare:  0.00022220611572265625
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0007979869842529297
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0004360675811767578
----------------------check_connections_block total spend ----------------------------- 0.0023360252380371094
generate_one_block  0.0021514892578125
generate_one_block  0.0015821456909179688
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010411739349365234
gen group dst list time:  6.175041198730469e-05
time for parepare:  0.0007202625274658203
local_output_nid generation:  0.00011467933654785156
local_in_edges_tensor generation:  0.0004374980926513672
mini_batch_src_global generation:  0.00045299530029296875
r_  generation:  0.004807949066162109
local_output_nid generation:  7.653236389160156e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.0003693103790283203
r_  generation:  0.002641916275024414
----------------------check_connections_block total spend ----------------------------- 0.011881589889526367
generate_one_block  0.007845401763916016
generate_one_block  0.0044307708740234375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018770694732666016
gen group dst list time:  0.00017976760864257812
time for parepare:  0.001332998275756836
local_output_nid generation:  0.0003833770751953125
local_in_edges_tensor generation:  0.001291513442993164
mini_batch_src_global generation:  0.001566171646118164
r_  generation:  0.014690637588500977
local_output_nid generation:  0.0003204345703125
local_in_edges_tensor generation:  0.000698089599609375
mini_batch_src_global generation:  0.0013267993927001953
r_  generation:  0.011319160461425781
----------------------check_connections_block total spend ----------------------------- 0.03942584991455078
generate_one_block  0.020655155181884766
generate_one_block  0.016587018966674805
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020110607147216797
gen group dst list time:  0.0005178451538085938
time for parepare:  0.001569509506225586
local_output_nid generation:  0.0009565353393554688
local_in_edges_tensor generation:  0.002096414566040039
mini_batch_src_global generation:  0.002176523208618164
r_  generation:  0.02351999282836914
local_output_nid generation:  0.0010454654693603516
local_in_edges_tensor generation:  0.002151966094970703
mini_batch_src_global generation:  0.0024077892303466797
r_  generation:  0.02166891098022461
----------------------check_connections_block total spend ----------------------------- 0.06796860694885254
generate_one_block  0.029247283935546875
generate_one_block  0.02855825424194336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001882314682006836
gen group dst list time:  0.0007066726684570312
time for parepare:  0.00152587890625
local_output_nid generation:  0.0012476444244384766
local_in_edges_tensor generation:  0.0024595260620117188
mini_batch_src_global generation:  0.0021982192993164062
r_  generation:  0.025772809982299805
local_output_nid generation:  0.0014770030975341797
local_in_edges_tensor generation:  0.0026268959045410156
mini_batch_src_global generation:  0.0026264190673828125
r_  generation:  0.02584075927734375
----------------------check_connections_block total spend ----------------------------- 0.07705950736999512
generate_one_block  0.030488252639770508
generate_one_block  0.03335165977478027
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00016260147094726562  GigaBytes
Max Memory Allocated: 0.00016260147094726562  GigaBytes

connection checking time:  0.19867157936096191
block generation total time  0.1748974323272705
average batch blocks generation time:  0.08744871616363525
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.037935733795166016  GigaBytes
Max Memory Allocated: 0.037935733795166016  GigaBytes

torch.Size([19363, 500])
torch.Size([17986, 32])
torch.Size([14601, 32])
torch.Size([5980, 32])
torch.Size([1756, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.05851268768310547  GigaBytes
Max Memory Allocated: 0.058588504791259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.03769493103027344  GigaBytes
Max Memory Allocated: 0.07225799560546875  GigaBytes

torch.Size([19258, 500])
torch.Size([17629, 32])
torch.Size([12633, 32])
torch.Size([4394, 32])
torch.Size([981, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.05570030212402344  GigaBytes
Max Memory Allocated: 0.07225799560546875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015151143074035645 |0.1716831922531128 |0.38927173614501953 |0.00020134449005126953 |0.007968664169311523 |0.0038063526153564453 |
----------------------------------------------------------pseudo_mini_loss sum 2.777085304260254
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  114937
Number of first layer input nodes during this epoch:  38621
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.04135465621948242  GigaBytes
Max Memory Allocated: 0.07225799560546875  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006384849548339844
range selection method range initialization spend 7.677078247070312e-05
time for parepare:  7.271766662597656e-05
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  8.058547973632812e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00014019012451171875
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  9.655952453613281e-05
----------------------check_connections_block total spend ----------------------------- 0.0009624958038330078
generate_one_block  0.001415252685546875
generate_one_block  0.0013649463653564453
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006628036499023438
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.00035762786865234375
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  9.989738464355469e-05
r_  generation:  0.0007243156433105469
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.000274658203125
mini_batch_src_global generation:  0.0001552104949951172
r_  generation:  0.0008320808410644531
----------------------check_connections_block total spend ----------------------------- 0.003264188766479492
generate_one_block  0.0027251243591308594
generate_one_block  0.0022149085998535156
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001359701156616211
gen group dst list time:  8.58306884765625e-05
time for parepare:  0.0008819103240966797
local_output_nid generation:  0.00010609626770019531
local_in_edges_tensor generation:  0.0004165172576904297
mini_batch_src_global generation:  0.00044417381286621094
r_  generation:  0.0041446685791015625
local_output_nid generation:  0.00015544891357421875
local_in_edges_tensor generation:  0.0003643035888671875
mini_batch_src_global generation:  0.000518798828125
r_  generation:  0.005171060562133789
----------------------check_connections_block total spend ----------------------------- 0.014506340026855469
generate_one_block  0.005639314651489258
generate_one_block  0.006380558013916016
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002220630645751953
gen group dst list time:  0.0002396106719970703
time for parepare:  0.0015361309051513672
local_output_nid generation:  0.0004181861877441406
local_in_edges_tensor generation:  0.0011665821075439453
mini_batch_src_global generation:  0.0012173652648925781
r_  generation:  0.014624834060668945
local_output_nid generation:  0.0004012584686279297
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0018699169158935547
r_  generation:  0.025864839553833008
----------------------check_connections_block total spend ----------------------------- 0.05680060386657715
generate_one_block  0.01833820343017578
generate_one_block  0.020421266555786133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018429756164550781
gen group dst list time:  0.0005025863647460938
time for parepare:  0.0014760494232177734
local_output_nid generation:  0.0008654594421386719
local_in_edges_tensor generation:  0.00185394287109375
mini_batch_src_global generation:  0.0017094612121582031
r_  generation:  0.022182703018188477
local_output_nid generation:  0.0011060237884521484
local_in_edges_tensor generation:  0.0027854442596435547
mini_batch_src_global generation:  0.002676725387573242
r_  generation:  0.023974895477294922
----------------------check_connections_block total spend ----------------------------- 0.06914210319519043
generate_one_block  0.027239084243774414
generate_one_block  0.032199859619140625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018384456634521484
gen group dst list time:  0.0007452964782714844
time for parepare:  0.0016489028930664062
local_output_nid generation:  0.001310110092163086
local_in_edges_tensor generation:  0.002457857131958008
mini_batch_src_global generation:  0.0018198490142822266
r_  generation:  0.02573394775390625
local_output_nid generation:  0.0014715194702148438
local_in_edges_tensor generation:  0.002755880355834961
mini_batch_src_global generation:  0.0027985572814941406
r_  generation:  0.0260770320892334
----------------------check_connections_block total spend ----------------------------- 0.07745003700256348
generate_one_block  0.03094625473022461
generate_one_block  0.03234410285949707
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.04135465621948242  GigaBytes
Max Memory Allocated: 0.07225799560546875  GigaBytes

connection checking time:  0.22116327285766602
block generation total time  0.17844867706298828
average batch blocks generation time:  0.08922433853149414
block dataloader generation time/epoch 0.4462776184082031
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.037989139556884766  GigaBytes
Max Memory Allocated: 0.0722813606262207  GigaBytes

torch.Size([19209, 500])
torch.Size([17641, 32])
torch.Size([12826, 32])
torch.Size([4880, 32])
torch.Size([1158, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.05650472640991211  GigaBytes
Max Memory Allocated: 0.0722813606262207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.038374900817871094  GigaBytes
Max Memory Allocated: 0.07247400283813477  GigaBytes

torch.Size([19361, 500])
torch.Size([18134, 32])
torch.Size([14870, 32])
torch.Size([5826, 32])
torch.Size([1608, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.058953285217285156  GigaBytes
Max Memory Allocated: 0.07247400283813477  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01523125171661377 |0.0020688772201538086 |0.007370710372924805 |0.00013506412506103516 |0.007413387298583984 |0.006259918212890625 |
----------------------------------------------------------pseudo_mini_loss sum 2.7919301986694336
Total (block generation + training)time/epoch 0.5210564136505127
Training time/epoch 0.07416749000549316
Training time without block to device /epoch 0.07002973556518555
Training time without total dataloading part /epoch 0.03609824180603027
load block tensor time/epoch 0.03046250343322754
block to device time/epoch 0.004137754440307617
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  115868
Number of first layer input nodes during this epoch:  38570
