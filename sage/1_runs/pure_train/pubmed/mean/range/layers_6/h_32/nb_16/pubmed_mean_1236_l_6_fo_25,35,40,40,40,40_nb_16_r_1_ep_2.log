main start at this time 1648533476.1190624
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00016260147094726562  GigaBytes
Max Memory Allocated: 0.00016260147094726562  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.003108978271484375
range selection method range initialization spend 9.083747863769531e-05
time for parepare:  4.601478576660156e-05
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.0011487007141113281
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.2172927856445312e-05
----------------------check_connections_block total spend ----------------------------- 0.0028100013732910156
generate_one_block  0.0012149810791015625
generate_one_block  0.0010714530944824219
generate_one_block  0.0010077953338623047
generate_one_block  0.001007080078125
generate_one_block  0.0009992122650146484
generate_one_block  0.001046895980834961
generate_one_block  0.0009980201721191406
generate_one_block  0.0010094642639160156
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0016632080078125
gen group dst list time:  4.863739013671875e-05
time for parepare:  0.00022602081298828125
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00028514862060546875
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0003070831298828125
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0001518726348876953
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0001392364501953125
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0001575946807861328
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00011420249938964844
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0001239776611328125
----------------------check_connections_block total spend ----------------------------- 0.003345966339111328
generate_one_block  0.0014188289642333984
generate_one_block  0.001401662826538086
generate_one_block  0.0011513233184814453
generate_one_block  0.0012326240539550781
generate_one_block  0.0010683536529541016
generate_one_block  0.0012044906616210938
generate_one_block  0.0011403560638427734
generate_one_block  0.0011627674102783203
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011065006256103516
gen group dst list time:  8.726119995117188e-05
time for parepare:  0.0007402896881103516
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.0003018379211425781
mini_batch_src_global generation:  0.0001742839813232422
r_  generation:  0.0020322799682617188
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  0.0002486705780029297
r_  generation:  0.0020215511322021484
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  0.00013566017150878906
r_  generation:  0.0009484291076660156
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0008640289306640625
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0003387928009033203
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.0011742115020751953
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  9.632110595703125e-05
r_  generation:  0.0007250308990478516
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0007507801055908203
----------------------check_connections_block total spend ----------------------------- 0.014542579650878906
generate_one_block  0.0037856101989746094
generate_one_block  0.003348112106323242
generate_one_block  0.002222299575805664
generate_one_block  0.0019333362579345703
generate_one_block  0.0013768672943115234
generate_one_block  0.0025031566619873047
generate_one_block  0.0017707347869873047
generate_one_block  0.0017895698547363281
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002053499221801758
gen group dst list time:  0.0002548694610595703
time for parepare:  0.001573324203491211
local_output_nid generation:  0.00019240379333496094
local_in_edges_tensor generation:  0.0007810592651367188
mini_batch_src_global generation:  0.0009968280792236328
r_  generation:  0.009096860885620117
local_output_nid generation:  0.0002124309539794922
local_in_edges_tensor generation:  0.000499725341796875
mini_batch_src_global generation:  0.0010876655578613281
r_  generation:  0.008116722106933594
local_output_nid generation:  0.00014662742614746094
local_in_edges_tensor generation:  0.0003561973571777344
mini_batch_src_global generation:  0.0005609989166259766
r_  generation:  0.005616188049316406
local_output_nid generation:  0.00011920928955078125
local_in_edges_tensor generation:  0.00032138824462890625
mini_batch_src_global generation:  0.0004425048828125
r_  generation:  0.00402069091796875
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  0.0002925395965576172
r_  generation:  0.0022764205932617188
local_output_nid generation:  0.0001926422119140625
local_in_edges_tensor generation:  0.00042891502380371094
mini_batch_src_global generation:  0.0005247592926025391
r_  generation:  0.006423234939575195
local_output_nid generation:  0.000118255615234375
local_in_edges_tensor generation:  0.00031447410583496094
mini_batch_src_global generation:  0.0005211830139160156
r_  generation:  0.00455784797668457
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.00027942657470703125
mini_batch_src_global generation:  0.0003573894500732422
r_  generation:  0.003310680389404297
----------------------check_connections_block total spend ----------------------------- 0.06476449966430664
generate_one_block  0.013794898986816406
generate_one_block  0.013073444366455078
generate_one_block  0.008500099182128906
generate_one_block  0.006427288055419922
generate_one_block  0.0037872791290283203
generate_one_block  0.009819507598876953
generate_one_block  0.007968902587890625
generate_one_block  0.005155324935913086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023071765899658203
gen group dst list time:  0.0013692378997802734
time for parepare:  0.0017476081848144531
local_output_nid generation:  0.0008814334869384766
local_in_edges_tensor generation:  0.001977682113647461
mini_batch_src_global generation:  0.0019431114196777344
r_  generation:  0.019787311553955078
local_output_nid generation:  0.0007357597351074219
local_in_edges_tensor generation:  0.0015134811401367188
mini_batch_src_global generation:  0.002020597457885742
r_  generation:  0.01780104637145996
local_output_nid generation:  0.0005829334259033203
local_in_edges_tensor generation:  0.0009264945983886719
mini_batch_src_global generation:  0.0012764930725097656
r_  generation:  0.014059305191040039
local_output_nid generation:  0.0006265640258789062
local_in_edges_tensor generation:  0.0010251998901367188
mini_batch_src_global generation:  0.0010480880737304688
r_  generation:  0.013571977615356445
local_output_nid generation:  0.0003147125244140625
local_in_edges_tensor generation:  0.0005555152893066406
mini_batch_src_global generation:  0.0008990764617919922
r_  generation:  0.008466243743896484
local_output_nid generation:  0.0007224082946777344
local_in_edges_tensor generation:  0.0011653900146484375
mini_batch_src_global generation:  0.0014755725860595703
r_  generation:  0.018115997314453125
local_output_nid generation:  0.0005993843078613281
local_in_edges_tensor generation:  0.001027822494506836
mini_batch_src_global generation:  0.0014276504516601562
r_  generation:  0.015303611755371094
local_output_nid generation:  0.0004482269287109375
local_in_edges_tensor generation:  0.0007240772247314453
mini_batch_src_global generation:  0.0010395050048828125
r_  generation:  0.010584831237792969
----------------------check_connections_block total spend ----------------------------- 0.17232275009155273
generate_one_block  0.0264132022857666
generate_one_block  0.024504899978637695
generate_one_block  0.019414186477661133
generate_one_block  0.017688989639282227
generate_one_block  0.012824058532714844
generate_one_block  0.023780345916748047
generate_one_block  0.020457983016967773
generate_one_block  0.013985395431518555
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017557144165039062
gen group dst list time:  0.0026471614837646484
time for parepare:  0.001718759536743164
local_output_nid generation:  0.0013034343719482422
local_in_edges_tensor generation:  0.002458810806274414
mini_batch_src_global generation:  0.002415180206298828
r_  generation:  0.02423548698425293
local_output_nid generation:  0.001302957534790039
local_in_edges_tensor generation:  0.0025255680084228516
mini_batch_src_global generation:  0.002561330795288086
r_  generation:  0.023789405822753906
local_output_nid generation:  0.0011677742004394531
local_in_edges_tensor generation:  0.0016791820526123047
mini_batch_src_global generation:  0.0017728805541992188
r_  generation:  0.020999908447265625
local_output_nid generation:  0.0012965202331542969
local_in_edges_tensor generation:  0.0041294097900390625
mini_batch_src_global generation:  0.0020422935485839844
r_  generation:  0.02272629737854004
local_output_nid generation:  0.0009198188781738281
local_in_edges_tensor generation:  0.0014095306396484375
mini_batch_src_global generation:  0.001528024673461914
r_  generation:  0.017554044723510742
local_output_nid generation:  0.0014331340789794922
local_in_edges_tensor generation:  0.0021867752075195312
mini_batch_src_global generation:  0.0020210742950439453
r_  generation:  0.024508237838745117
local_output_nid generation:  0.00124359130859375
local_in_edges_tensor generation:  0.0020987987518310547
mini_batch_src_global generation:  0.0018229484558105469
r_  generation:  0.023140668869018555
local_output_nid generation:  0.0010409355163574219
local_in_edges_tensor generation:  0.0016057491302490234
mini_batch_src_global generation:  0.0016529560089111328
r_  generation:  0.019377470016479492
----------------------check_connections_block total spend ----------------------------- 0.2592332363128662
generate_one_block  0.029474258422851562
generate_one_block  0.031965017318725586
generate_one_block  0.028810501098632812
generate_one_block  0.029940366744995117
generate_one_block  0.023407459259033203
generate_one_block  0.031004905700683594
generate_one_block  0.029291152954101562
generate_one_block  0.02418661117553711
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00016260147094726562  GigaBytes
Max Memory Allocated: 0.00016260147094726562  GigaBytes

connection checking time:  0.5142090320587158
block generation total time  0.48418617248535156
average batch blocks generation time:  0.060523271560668945
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03669166564941406  GigaBytes
Max Memory Allocated: 0.03669166564941406  GigaBytes

torch.Size([18847, 500])
torch.Size([15827, 32])
torch.Size([11063, 32])
torch.Size([2685, 32])
torch.Size([644, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.05211210250854492  GigaBytes
Max Memory Allocated: 0.05214977264404297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.03675508499145508  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

torch.Size([18471, 500])
torch.Size([14958, 32])
torch.Size([8895, 32])
torch.Size([2748, 32])
torch.Size([644, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.0507354736328125  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.03336286544799805  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

torch.Size([17182, 500])
torch.Size([11899, 32])
torch.Size([6151, 32])
torch.Size([1737, 32])
torch.Size([265, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.04332590103149414  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.03498125076293945  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

torch.Size([18074, 500])
torch.Size([13154, 32])
torch.Size([6820, 32])
torch.Size([1420, 32])
torch.Size([340, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.04620027542114258  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.028638362884521484  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

torch.Size([14812, 500])
torch.Size([8851, 32])
torch.Size([3410, 32])
torch.Size([659, 32])
torch.Size([122, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.035044193267822266  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.036715030670166016  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

torch.Size([18624, 500])
torch.Size([15855, 32])
torch.Size([8650, 32])
torch.Size([2406, 32])
torch.Size([392, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.05046224594116211  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.03533172607421875  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

torch.Size([18218, 500])
torch.Size([13717, 32])
torch.Size([6997, 32])
torch.Size([1363, 32])
torch.Size([242, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.046814918518066406  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.0326390266418457  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

torch.Size([16920, 500])
torch.Size([11335, 32])
torch.Size([5148, 32])
torch.Size([1334, 32])
torch.Size([276, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.04236412048339844  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013711720705032349 |0.043647825717926025 |0.10179150104522705 |0.00014016032218933105 |0.005297333002090454 |0.0036787986755371094 |
----------------------------------------------------------pseudo_mini_loss sum 2.5205368995666504
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  321512
Number of first layer input nodes during this epoch:  141148
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03475761413574219  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0004956722259521484
range selection method range initialization spend 5.340576171875e-05
time for parepare:  4.839897155761719e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.09808349609375e-05
----------------------check_connections_block total spend ----------------------------- 0.001562356948852539
generate_one_block  0.0014791488647460938
generate_one_block  0.001058340072631836
generate_one_block  0.0010178089141845703
generate_one_block  0.001005411148071289
generate_one_block  0.001027822494506836
generate_one_block  0.0011546611785888672
generate_one_block  0.0010211467742919922
generate_one_block  0.0010223388671875
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00052642822265625
gen group dst list time:  5.245208740234375e-05
time for parepare:  0.0002903938293457031
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00013065338134765625
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00022101402282714844
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001201629638671875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0002002716064453125
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00012874603271484375
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00016069412231445312
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0002429485321044922
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0001647472381591797
----------------------check_connections_block total spend ----------------------------- 0.0034852027893066406
generate_one_block  0.0011963844299316406
generate_one_block  0.0012710094451904297
generate_one_block  0.0011646747589111328
generate_one_block  0.0012431144714355469
generate_one_block  0.0011410713195800781
generate_one_block  0.0012116432189941406
generate_one_block  0.0012898445129394531
generate_one_block  0.0012199878692626953
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011687278747558594
gen group dst list time:  0.00010132789611816406
time for parepare:  0.0007846355438232422
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00025773048400878906
mini_batch_src_global generation:  0.00010657310485839844
r_  generation:  0.0008885860443115234
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  0.00021696090698242188
r_  generation:  0.0017342567443847656
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  0.00012946128845214844
r_  generation:  0.0008187294006347656
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.0012111663818359375
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0007493495941162109
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.0008878707885742188
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.0001609325408935547
r_  generation:  0.0016582012176513672
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  0.00013136863708496094
r_  generation:  0.0009784698486328125
----------------------check_connections_block total spend ----------------------------- 0.014955282211303711
generate_one_block  0.002447366714477539
generate_one_block  0.003011465072631836
generate_one_block  0.001888275146484375
generate_one_block  0.0024607181549072266
generate_one_block  0.0018384456634521484
generate_one_block  0.0020651817321777344
generate_one_block  0.0030066967010498047
generate_one_block  0.0020630359649658203
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020601749420166016
gen group dst list time:  0.0002918243408203125
time for parepare:  0.0014348030090332031
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.0006289482116699219
mini_batch_src_global generation:  0.00045871734619140625
r_  generation:  0.004663228988647461
local_output_nid generation:  0.00016164779663085938
local_in_edges_tensor generation:  0.0003898143768310547
mini_batch_src_global generation:  0.0007786750793457031
r_  generation:  0.006601095199584961
local_output_nid generation:  0.00014352798461914062
local_in_edges_tensor generation:  0.00036406517028808594
mini_batch_src_global generation:  0.0006341934204101562
r_  generation:  0.005317211151123047
local_output_nid generation:  0.00018358230590820312
local_in_edges_tensor generation:  0.00040030479431152344
mini_batch_src_global generation:  0.0005879402160644531
r_  generation:  0.005947589874267578
local_output_nid generation:  0.000125885009765625
local_in_edges_tensor generation:  0.00030922889709472656
mini_batch_src_global generation:  0.0004963874816894531
r_  generation:  0.0044286251068115234
local_output_nid generation:  0.00013518333435058594
local_in_edges_tensor generation:  0.0003268718719482422
mini_batch_src_global generation:  0.000469207763671875
r_  generation:  0.004578113555908203
local_output_nid generation:  0.0002052783966064453
local_in_edges_tensor generation:  0.0004353523254394531
mini_batch_src_global generation:  0.0006601810455322266
r_  generation:  0.006683349609375
local_output_nid generation:  0.00014901161193847656
local_in_edges_tensor generation:  0.00033926963806152344
mini_batch_src_global generation:  0.0005629062652587891
r_  generation:  0.004981517791748047
----------------------check_connections_block total spend ----------------------------- 0.06595110893249512
generate_one_block  0.0069904327392578125
generate_one_block  0.009317159652709961
generate_one_block  0.008086681365966797
generate_one_block  0.008879661560058594
generate_one_block  0.0067806243896484375
generate_one_block  0.007481813430786133
generate_one_block  0.012543201446533203
generate_one_block  0.007789134979248047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002353668212890625
gen group dst list time:  0.001210927963256836
time for parepare:  0.0017693042755126953
local_output_nid generation:  0.0005984306335449219
local_in_edges_tensor generation:  0.001451730728149414
mini_batch_src_global generation:  0.0010809898376464844
r_  generation:  0.013979196548461914
local_output_nid generation:  0.0006265640258789062
local_in_edges_tensor generation:  0.0014066696166992188
mini_batch_src_global generation:  0.0017383098602294922
r_  generation:  0.015189170837402344
local_output_nid generation:  0.0006415843963623047
local_in_edges_tensor generation:  0.0009989738464355469
mini_batch_src_global generation:  0.0012881755828857422
r_  generation:  0.015438318252563477
local_output_nid generation:  0.0007846355438232422
local_in_edges_tensor generation:  0.001386404037475586
mini_batch_src_global generation:  0.0016927719116210938
r_  generation:  0.018416881561279297
local_output_nid generation:  0.0006659030914306641
local_in_edges_tensor generation:  0.0009126663208007812
mini_batch_src_global generation:  0.0012197494506835938
r_  generation:  0.01402139663696289
local_output_nid generation:  0.0008530616760253906
local_in_edges_tensor generation:  0.0010180473327636719
mini_batch_src_global generation:  0.0013670921325683594
r_  generation:  0.015677690505981445
local_output_nid generation:  0.0007681846618652344
local_in_edges_tensor generation:  0.0010063648223876953
mini_batch_src_global generation:  0.0014195442199707031
r_  generation:  0.016225337982177734
local_output_nid generation:  0.0009024143218994141
local_in_edges_tensor generation:  0.0011210441589355469
mini_batch_src_global generation:  0.0013761520385742188
r_  generation:  0.01608419418334961
----------------------check_connections_block total spend ----------------------------- 0.1831803321838379
generate_one_block  0.019217252731323242
generate_one_block  0.02068018913269043
generate_one_block  0.02002573013305664
generate_one_block  0.024139881134033203
generate_one_block  0.018718957901000977
generate_one_block  0.022005081176757812
generate_one_block  0.02175283432006836
generate_one_block  0.021056652069091797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019252300262451172
gen group dst list time:  0.002881765365600586
time for parepare:  0.001827239990234375
local_output_nid generation:  0.0012969970703125
local_in_edges_tensor generation:  0.002570629119873047
mini_batch_src_global generation:  0.002101898193359375
r_  generation:  0.023042678833007812
local_output_nid generation:  0.0011296272277832031
local_in_edges_tensor generation:  0.0022974014282226562
mini_batch_src_global generation:  0.0025091171264648438
r_  generation:  0.023463010787963867
local_output_nid generation:  0.0013303756713867188
local_in_edges_tensor generation:  0.0018458366394042969
mini_batch_src_global generation:  0.0017943382263183594
r_  generation:  0.02266073226928711
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.002499818801879883
mini_batch_src_global generation:  0.0020301342010498047
r_  generation:  0.024268150329589844
local_output_nid generation:  0.0013246536254882812
local_in_edges_tensor generation:  0.0016329288482666016
mini_batch_src_global generation:  0.0018031597137451172
r_  generation:  0.023694276809692383
local_output_nid generation:  0.0014767646789550781
local_in_edges_tensor generation:  0.0018661022186279297
mini_batch_src_global generation:  0.0018486976623535156
r_  generation:  0.02327704429626465
local_output_nid generation:  0.0013234615325927734
local_in_edges_tensor generation:  0.002149820327758789Using backend: pytorch

mini_batch_src_global generation:  0.0018224716186523438
r_  generation:  0.023508548736572266
local_output_nid generation:  0.0013005733489990234
local_in_edges_tensor generation:  0.0022232532501220703
mini_batch_src_global generation:  0.00179290771484375
r_  generation:  0.02460026741027832
----------------------check_connections_block total spend ----------------------------- 0.2730386257171631
generate_one_block  0.02805471420288086
generate_one_block  0.028794288635253906
generate_one_block  0.031054019927978516
generate_one_block  0.03207516670227051
generate_one_block  0.027740001678466797
generate_one_block  0.028956890106201172
generate_one_block  0.029842615127563477
generate_one_block  0.02913069725036621
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03475761413574219  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

connection checking time:  0.5406105518341064
block generation total time  0.4996325969696045
average batch blocks generation time:  0.06245407462120056
block dataloader generation time/epoch 1.1057300567626953
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03558158874511719  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

torch.Size([18216, 500])
torch.Size([14201, 32])
torch.Size([6191, 32])
torch.Size([1755, 32])
torch.Size([290, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.04695415496826172  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03511762619018555  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

torch.Size([17906, 500])
torch.Size([13335, 32])
torch.Size([7171, 32])
torch.Size([1936, 32])
torch.Size([434, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.047220706939697266  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03519010543823242  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

torch.Size([17971, 500])
torch.Size([13164, 32])
torch.Size([7061, 32])
torch.Size([1576, 32])
torch.Size([275, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.04677438735961914  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03698301315307617  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

torch.Size([18687, 500])
torch.Size([15241, 32])
torch.Size([8328, 32])
torch.Size([2110, 32])
torch.Size([432, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.05023527145385742  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.0346369743347168  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

torch.Size([17711, 500])
torch.Size([12691, 32])
torch.Size([6087, 32])
torch.Size([1306, 32])
torch.Size([260, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.04528236389160156  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.035866737365722656  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

torch.Size([18336, 500])
torch.Size([13911, 32])
torch.Size([7465, 32])
torch.Size([1444, 32])
torch.Size([355, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.047765254974365234  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03520536422729492  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

torch.Size([17926, 500])
torch.Size([14136, 32])
torch.Size([7368, 32])
torch.Size([2368, 32])
torch.Size([434, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.04778480529785156  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03688955307006836  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

torch.Size([18501, 500])
torch.Size([14034, 32])
torch.Size([8577, 32])
torch.Size([1579, 32])
torch.Size([409, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.049529075622558594  GigaBytes
Max Memory Allocated: 0.0706329345703125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013374537229537964 |0.0018179714679718018 |0.00661131739616394 |0.00013446807861328125 |0.005285203456878662 |0.0026617050170898438 |
----------------------------------------------------------pseudo_mini_loss sum 1.8705768585205078
Total (block generation + training)time/epoch 1.3392906188964844
Training time/epoch 0.23293399810791016
Training time without block to device /epoch 0.21839022636413574
Training time without total dataloading part /epoch 0.09890961647033691
load block tensor time/epoch 0.10699629783630371
block to device time/epoch 0.014543771743774414
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  331534
Number of first layer input nodes during this epoch:  145254
