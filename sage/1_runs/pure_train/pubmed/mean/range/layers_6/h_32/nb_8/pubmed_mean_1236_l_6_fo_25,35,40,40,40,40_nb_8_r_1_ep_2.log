main start at this time 1648533464.49131
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00016260147094726562  GigaBytes
Max Memory Allocated: 0.00016260147094726562  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0015742778778076172
range selection method range initialization spend 8.130073547363281e-05
time for parepare:  4.553794860839844e-05
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0022432804107666016
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.743171691894531e-05
----------------------check_connections_block total spend ----------------------------- 0.003353595733642578
generate_one_block  0.0013399124145507812
generate_one_block  0.0010960102081298828
generate_one_block  0.0010876655578613281
generate_one_block  0.0010669231414794922
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009374618530273438
gen group dst list time:  3.4809112548828125e-05
time for parepare:  0.0002415180206298828
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0005784034729003906
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.00030684471130371094
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00016498565673828125
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0003056526184082031
----------------------check_connections_block total spend ----------------------------- 0.0028395652770996094
generate_one_block  0.0018086433410644531
generate_one_block  0.0014960765838623047
generate_one_block  0.0012340545654296875
generate_one_block  0.0014541149139404297
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010533332824707031
gen group dst list time:  7.653236389160156e-05
time for parepare:  0.0007598400115966797
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.00035762786865234375
mini_batch_src_global generation:  0.00030875205993652344
r_  generation:  0.003408670425415039
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  0.00027561187744140625
r_  generation:  0.002039194107055664
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.00014662742614746094
r_  generation:  0.0011749267578125
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.0001628398895263672
r_  generation:  0.001806497573852539
----------------------check_connections_block total spend ----------------------------- 0.013515472412109375
generate_one_block  0.006043434143066406
generate_one_block  0.003319263458251953
generate_one_block  0.0023565292358398438
generate_one_block  0.003010272979736328
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002112150192260742
gen group dst list time:  0.0002307891845703125
time for parepare:  0.001573324203491211
local_output_nid generation:  0.00027251243591308594
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.0012633800506591797
r_  generation:  0.011863946914672852
local_output_nid generation:  0.0002601146697998047
local_in_edges_tensor generation:  0.0012753009796142578
mini_batch_src_global generation:  0.0011272430419921875
r_  generation:  0.009889602661132812
local_output_nid generation:  0.00020003318786621094
local_in_edges_tensor generation:  0.000453948974609375
mini_batch_src_global generation:  0.0007767677307128906
r_  generation:  0.006755352020263672
local_output_nid generation:  0.00024175643920898438
local_in_edges_tensor generation:  0.0004906654357910156
mini_batch_src_global generation:  0.0007545948028564453
r_  generation:  0.007359743118286133
----------------------check_connections_block total spend ----------------------------- 0.05399918556213379
generate_one_block  0.016331195831298828
generate_one_block  0.014133930206298828
generate_one_block  0.010794639587402344
generate_one_block  0.011521339416503906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021715164184570312
gen group dst list time:  0.0008170604705810547
time for parepare:  0.001779317855834961
local_output_nid generation:  0.0009312629699707031
local_in_edges_tensor generation:  0.002547025680541992
mini_batch_src_global generation:  0.0022406578063964844
r_  generation:  0.022156715393066406
local_output_nid generation:  0.0009329319000244141
local_in_edges_tensor generation:  0.0017158985137939453
mini_batch_src_global generation:  0.0023012161254882812
r_  generation:  0.020605087280273438
local_output_nid generation:  0.0008187294006347656
local_in_edges_tensor generation:  0.0013055801391601562
mini_batch_src_global generation:  0.0016605854034423828
r_  generation:  0.018840312957763672
local_output_nid generation:  0.0009541511535644531
local_in_edges_tensor generation:  0.00164794921875
mini_batch_src_global generation:  0.0020051002502441406
r_  generation:  0.02005600929260254
----------------------check_connections_block total spend ----------------------------- 0.12055540084838867
generate_one_block  0.026567935943603516
generate_one_block  0.026955366134643555
generate_one_block  0.024708986282348633
generate_one_block  0.02620697021484375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001924753189086914
gen group dst list time:  0.0014815330505371094
time for parepare:  0.0016264915466308594
local_output_nid generation:  0.0012943744659423828
local_in_edges_tensor generation:  0.00266265869140625
mini_batch_src_global generation:  0.0024077892303466797
r_  generation:  0.025988340377807617
local_output_nid generation:  0.0014209747314453125
local_in_edges_tensor generation:  0.0027709007263183594
mini_batch_src_global generation:  0.0026886463165283203
r_  generation:  0.025409936904907227
local_output_nid generation:  0.0015447139739990234
local_in_edges_tensor generation:  0.002319812774658203
mini_batch_src_global generation:  0.0024213790893554688
r_  generation:  0.025113821029663086
local_output_nid generation:  0.001436471939086914
local_in_edges_tensor generation:  0.0021424293518066406
mini_batch_src_global generation:  0.0021598339080810547
r_  generation:  0.025777339935302734
----------------------check_connections_block total spend ----------------------------- 0.15044069290161133
generate_one_block  0.030158519744873047
generate_one_block  0.03125643730163574
generate_one_block  0.030193090438842773
generate_one_block  0.03096938133239746
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00016260147094726562  GigaBytes
Max Memory Allocated: 0.00016260147094726562  GigaBytes

connection checking time:  0.3413503170013428
block generation total time  0.3005201816558838
average batch blocks generation time:  0.07513004541397095
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.037323951721191406  GigaBytes
Max Memory Allocated: 0.037323951721191406  GigaBytes

torch.Size([19137, 500])
torch.Size([16915, 32])
torch.Size([12573, 32])
torch.Size([4024, 32])
torch.Size([1127, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.05498075485229492  GigaBytes
Max Memory Allocated: 0.05502510070800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.036844730377197266  GigaBytes
Max Memory Allocated: 0.0711221694946289  GigaBytes

torch.Size([18634, 500])
torch.Size([16004, 32])
torch.Size([10623, 32])
torch.Size([3223, 32])
torch.Size([686, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.05236625671386719  GigaBytes
Max Memory Allocated: 0.0711221694946289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.036180973052978516  GigaBytes
Max Memory Allocated: 0.0711221694946289  GigaBytes

torch.Size([18586, 500])
torch.Size([15848, 32])
torch.Size([8430, 32])
torch.Size([2349, 32])
torch.Size([356, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.050047874450683594  GigaBytes
Max Memory Allocated: 0.0711221694946289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.0369257926940918  GigaBytes
Max Memory Allocated: 0.0711221694946289  GigaBytes

torch.Size([18951, 500])
torch.Size([16026, 32])
torch.Size([10448, 32])
torch.Size([2774, 32])
torch.Size([674, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.05277585983276367  GigaBytes
Max Memory Allocated: 0.0711221694946289  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0123215913772583 |0.08641797304153442 |0.19725936651229858 |0.0001996159553527832 |0.006353795528411865 |0.003989219665527344 |
----------------------------------------------------------pseudo_mini_loss sum 2.762878656387329
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  197745
Number of first layer input nodes during this epoch:  75308
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.040146827697753906  GigaBytes
Max Memory Allocated: 0.0711221694946289  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005245208740234375
range selection method range initialization spend 5.3882598876953125e-05
time for parepare:  5.0067901611328125e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.982948303222656e-05
----------------------check_connections_block total spend ----------------------------- 0.001026153564453125
generate_one_block  0.0011343955993652344
generate_one_block  0.0010695457458496094
generate_one_block  0.0011668205261230469
generate_one_block  0.0010905265808105469
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005254745483398438
gen group dst list time:  3.6716461181640625e-05
time for parepare:  0.000274658203125
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.00030732154846191406
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00023674964904785156
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0003561973571777344
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004303455352783203
----------------------check_connections_block total spend ----------------------------- 0.0028607845306396484
generate_one_block  0.0014483928680419922
generate_one_block  0.0013189315795898438
generate_one_block  0.0014812946319580078
generate_one_block  0.001577615737915039
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010249614715576172
gen group dst list time:  8.535385131835938e-05
time for parepare:  0.0007939338684082031
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  0.0002624988555908203
r_  generation:  0.002408742904663086
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  0.00021767616271972656
r_  generation:  0.0015823841094970703
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.0002002716064453125
r_  generation:  0.0020432472229003906
local_output_nid generation:  8.153915405273438e-05
local_in_edges_tensor generation:  0.00024628639221191406
mini_batch_src_global generation:  0.00028777122497558594
r_  generation:  0.0029458999633789062
----------------------check_connections_block total spend ----------------------------- 0.014296770095825195
generate_one_block  0.0041315555572509766
generate_one_block  0.0027430057525634766
generate_one_block  0.003239154815673828
generate_one_block  0.004413604736328125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020236968994140625
gen group dst list time:  0.00025916099548339844
time for parepare:  0.0014209747314453125
local_output_nid generation:  0.0002346038818359375
local_in_edges_tensor generation:  0.0008320808410644531
mini_batch_src_global generation:  0.0008094310760498047
r_  generation:  0.010031700134277344
local_output_nid generation:  0.00022840499877929688
local_in_edges_tensor generation:  0.0005142688751220703
mini_batch_src_global generation:  0.0009813308715820312
r_  generation:  0.008387088775634766
local_output_nid generation:  0.00024199485778808594
local_in_edges_tensor generation:  0.0004906654357910156
mini_batch_src_global generation:  0.0008347034454345703
r_  generation:  0.008441686630249023Using backend: pytorch

local_output_nid generation:  0.0003535747528076172
local_in_edges_tensor generation:  0.0006356239318847656
mini_batch_src_global generation:  0.0011947154998779297
r_  generation:  0.012420177459716797
----------------------check_connections_block total spend ----------------------------- 0.05778861045837402
generate_one_block  0.016321182250976562
generate_one_block  0.012754440307617188
generate_one_block  0.013013362884521484
generate_one_block  0.01584148406982422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020873546600341797
gen group dst list time:  0.0008482933044433594
time for parepare:  0.0015606880187988281
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0019834041595458984
mini_batch_src_global generation:  0.0019078254699707031
r_  generation:  0.020958662033081055
local_output_nid generation:  0.0009052753448486328
local_in_edges_tensor generation:  0.0016562938690185547
mini_batch_src_global generation:  0.002353191375732422
r_  generation:  0.021088361740112305
local_output_nid generation:  0.0010323524475097656
local_in_edges_tensor generation:  0.0017566680908203125
mini_batch_src_global generation:  0.0018894672393798828
r_  generation:  0.02139902114868164
local_output_nid generation:  0.0013470649719238281
local_in_edges_tensor generation:  0.0020253658294677734
mini_batch_src_global generation:  0.0023796558380126953
r_  generation:  0.022862911224365234
----------------------check_connections_block total spend ----------------------------- 0.12729549407958984
generate_one_block  0.024789094924926758
generate_one_block  0.02734684944152832
generate_one_block  0.02689194679260254
generate_one_block  0.03049492835998535
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002077817916870117
gen group dst list time:  0.0014200210571289062
time for parepare:  0.0016620159149169922
local_output_nid generation:  0.0013437271118164062
local_in_edges_tensor generation:  0.0026895999908447266
mini_batch_src_global generation:  0.0019936561584472656
r_  generation:  0.027106523513793945
local_output_nid generation:  0.0015268325805664062
local_in_edges_tensor generation:  0.00260162353515625
mini_batch_src_global generation:  0.0026502609252929688
r_  generation:  0.025686264038085938
local_output_nid generation:  0.001733541488647461
local_in_edges_tensor generation:  0.002454042434692383
mini_batch_src_global generation:  0.0022017955780029297
r_  generation:  0.026170730590820312
local_output_nid generation:  0.0018241405487060547
local_in_edges_tensor generation:  0.002438068389892578
mini_batch_src_global generation:  0.0022554397583007812
r_  generation:  0.028360843658447266
----------------------check_connections_block total spend ----------------------------- 0.15702438354492188
generate_one_block  0.03129768371582031
generate_one_block  0.03173398971557617
generate_one_block  0.033516883850097656
generate_one_block  0.03249621391296387
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.040146827697753906  GigaBytes
Max Memory Allocated: 0.0711221694946289  GigaBytes

connection checking time:  0.3592660427093506
block generation total time  0.3168516159057617
average batch blocks generation time:  0.07921290397644043
block dataloader generation time/epoch 0.7276508808135986
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.0371851921081543  GigaBytes
Max Memory Allocated: 0.0711221694946289  GigaBytes

torch.Size([18810, 500])
torch.Size([16475, 32])
torch.Size([10204, 32])
torch.Size([3169, 32])
torch.Size([642, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.052620887756347656  GigaBytes
Max Memory Allocated: 0.0711221694946289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.036759376525878906  GigaBytes
Max Memory Allocated: 0.0711221694946289  GigaBytes

torch.Size([18704, 500])
torch.Size([15474, 32])
torch.Size([9658, 32])
torch.Size([2675, 32])
torch.Size([543, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.05125284194946289  GigaBytes
Max Memory Allocated: 0.0711221694946289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.03750896453857422  GigaBytes
Max Memory Allocated: 0.0711221694946289  GigaBytes

torch.Size([19066, 500])
torch.Size([16458, 32])
torch.Size([11017, 32])
torch.Size([3015, 32])
torch.Size([774, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.05400276184082031  GigaBytes
Max Memory Allocated: 0.0711221694946289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.03787946701049805  GigaBytes
Max Memory Allocated: 0.0718836784362793  GigaBytes

torch.Size([19187, 500])
torch.Size([17067, 32])
torch.Size([12571, 32])
torch.Size([4165, 32])
torch.Size([924, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.055541038513183594  GigaBytes
Max Memory Allocated: 0.0718836784362793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013952672481536865 |0.0019223690032958984 |0.007202446460723877 |0.00014597177505493164 |0.005172848701477051 |0.0037899017333984375 |
----------------------------------------------------------pseudo_mini_loss sum 2.343479633331299
Total (block generation + training)time/epoch 0.8531765937805176
Training time/epoch 0.12510275840759277
Training time without block to device /epoch 0.11741328239440918
Training time without total dataloading part /epoch 0.053874969482421875
load block tensor time/epoch 0.05581068992614746
block to device time/epoch 0.007689476013183594
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  200954
Number of first layer input nodes during this epoch:  75767
