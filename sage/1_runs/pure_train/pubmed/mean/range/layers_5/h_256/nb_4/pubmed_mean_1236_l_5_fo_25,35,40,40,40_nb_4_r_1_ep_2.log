main start at this time 1648532162.317073
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0016946792602539062
range selection method range initialization spend 9.918212890625e-05
time for parepare:  4.553794860839844e-05
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0011982917785644531
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  6.771087646484375e-05
----------------------check_connections_block total spend ----------------------------- 0.0018601417541503906
generate_one_block  0.0022008419036865234
generate_one_block  0.0012025833129882812
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010886192321777344
gen group dst list time:  2.5272369384765625e-05
time for parepare:  0.0002384185791015625
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0005249977111816406
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  0.00010800361633300781
r_  generation:  0.0007379055023193359
----------------------check_connections_block total spend ----------------------------- 0.002386808395385742
generate_one_block  0.0017845630645751953
generate_one_block  0.001989126205444336
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010449886322021484
gen group dst list time:  6.29425048828125e-05
time for parepare:  0.0007381439208984375
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.00036025047302246094
mini_batch_src_global generation:  0.0002372264862060547
r_  generation:  0.003186941146850586
local_output_nid generation:  0.00011444091796875
local_in_edges_tensor generation:  0.0003216266632080078
mini_batch_src_global generation:  0.0006043910980224609
r_  generation:  0.004708766937255859
----------------------check_connections_block total spend ----------------------------- 0.012609481811523438
generate_one_block  0.005066871643066406
generate_one_block  0.006642818450927734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018596649169921875
gen group dst list time:  0.00018525123596191406
time for parepare:  0.0014107227325439453
local_output_nid generation:  0.00032520294189453125
local_in_edges_tensor generation:  0.0010061264038085938
mini_batch_src_global generation:  0.0012326240539550781
r_  generation:  0.012511968612670898
local_output_nid generation:  0.00041675567626953125
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.0016050338745117188
r_  generation:  0.01468038558959961
----------------------check_connections_block total spend ----------------------------- 0.04089713096618652
generate_one_block  0.01752448081970215
generate_one_block  0.020439863204956055
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017538070678710938
gen group dst list time:  0.0004782676696777344
time for parepare:  0.0015327930450439453
local_output_nid generation:  0.0009317398071289062
local_in_edges_tensor generation:  0.0019795894622802734
mini_batch_src_global generation:  0.002023458480834961
r_  generation:  0.021962642669677734
local_output_nid generation:  0.0011515617370605469
local_in_edges_tensor generation:  0.0022068023681640625
mini_batch_src_global generation:  0.0026979446411132812
r_  generation:  0.022996187210083008
----------------------check_connections_block total spend ----------------------------- 0.06766033172607422
generate_one_block  0.027434110641479492
generate_one_block  0.02940058708190918
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

connection checking time:  0.12355375289916992
block generation total time  0.11028242111206055
average batch blocks generation time:  0.05514121055603027
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03658914566040039  GigaBytes
Max Memory Allocated: 0.03658914566040039  GigaBytes

torch.Size([17628, 500])
torch.Size([13470, 256])
torch.Size([4863, 256])
torch.Size([1222, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.10675764083862305  GigaBytes
Max Memory Allocated: 0.10816287994384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.03927135467529297  GigaBytes
Max Memory Allocated: 0.11153078079223633  GigaBytes

torch.Size([17899, 500])
torch.Size([14291, 256])
torch.Size([5769, 256])
torch.Size([1556, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.11641502380371094  GigaBytes
Max Memory Allocated: 0.11707210540771484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01443791389465332 |0.1747760772705078 |0.3812602758407593 |0.00022280216217041016 |0.010077953338623047 |0.004184722900390625 |
----------------------------------------------------------pseudo_mini_loss sum 2.3375978469848633
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  77054
Number of first layer input nodes during this epoch:  35527
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.04648017883300781  GigaBytes
Max Memory Allocated: 0.1204080581665039  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00047087669372558594
range selection method range initialization spend 4.9114227294921875e-05
time for parepare:  4.315376281738281e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.53131103515625e-05
----------------------check_connections_block total spend ----------------------------- 0.0006084442138671875
generate_one_block  0.0011432170867919922
generate_one_block  0.0010688304901123047
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004923343658447266
gen group dst list time:  2.384185791015625e-05
time for parepare:  0.000278472900390625
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.0007200241088867188
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation: Using backend: pytorch
 8.034706115722656e-05
r_  generation:  0.0004813671112060547
----------------------check_connections_block total spend ----------------------------- 0.002390146255493164
generate_one_block  0.0018773078918457031
generate_one_block  0.0016696453094482422
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009307861328125
gen group dst list time:  6.890296936035156e-05
time for parepare:  0.0006949901580810547
local_output_nid generation:  0.0001087188720703125
local_in_edges_tensor generation:  0.00043487548828125
mini_batch_src_global generation:  0.0003974437713623047
r_  generation:  0.00417327880859375
local_output_nid generation:  9.393692016601562e-05
local_in_edges_tensor generation:  0.00025582313537597656
mini_batch_src_global generation:  0.00035881996154785156
r_  generation:  0.0031147003173828125
----------------------check_connections_block total spend ----------------------------- 0.011472225189208984
generate_one_block  0.006864070892333984
generate_one_block  0.004957914352416992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020139217376708984
gen group dst list time:  0.00019478797912597656
time for parepare:  0.0012271404266357422
local_output_nid generation:  0.00034165382385253906
local_in_edges_tensor generation:  0.0010120868682861328
mini_batch_src_global generation:  0.0012280941009521484
r_  generation:  0.013371706008911133
local_output_nid generation:  0.0003788471221923828
local_in_edges_tensor generation:  0.0007808208465576172
mini_batch_src_global generation:  0.001352548599243164
r_  generation:  0.0125732421875
----------------------check_connections_block total spend ----------------------------- 0.03860592842102051
generate_one_block  0.018252849578857422
generate_one_block  0.017569541931152344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019240379333496094
gen group dst list time:  0.0004925727844238281
time for parepare:  0.0013942718505859375
local_output_nid generation:  0.0008957386016845703
local_in_edges_tensor generation:  0.0020864009857177734
mini_batch_src_global generation:  0.002075672149658203
r_  generation:  0.02153754234313965
local_output_nid generation:  0.0010685920715332031
local_in_edges_tensor generation:  0.002372264862060547
mini_batch_src_global generation:  0.0023920536041259766
r_  generation:  0.021846294403076172
----------------------check_connections_block total spend ----------------------------- 0.06539011001586914
generate_one_block  0.02749919891357422
generate_one_block  0.02899026870727539
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.04648017883300781  GigaBytes
Max Memory Allocated: 0.1204080581665039  GigaBytes

connection checking time:  0.1178584098815918
block generation total time  0.1076807975769043
average batch blocks generation time:  0.05384039878845215
block dataloader generation time/epoch 0.2578084468841553
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.04397392272949219  GigaBytes
Max Memory Allocated: 0.1204080581665039  GigaBytes

torch.Size([17662, 500])
torch.Size([14142, 256])
torch.Size([5348, 256])
torch.Size([1522, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.11945295333862305  GigaBytes
Max Memory Allocated: 0.1204080581665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.043854713439941406  GigaBytes
Max Memory Allocated: 0.12235832214355469  GigaBytes

torch.Size([17794, 500])
torch.Size([13695, 256])
torch.Size([5168, 256])
torch.Size([1187, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.1155233383178711  GigaBytes
Max Memory Allocated: 0.12235832214355469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013184070587158203 |0.001608729362487793 |0.006130576133728027 |0.00013935565948486328 |0.005174517631530762 |0.0054018497467041016 |
----------------------------------------------------------pseudo_mini_loss sum 1.8340144157409668
Total (block generation + training)time/epoch 0.3198549747467041
Training time/epoch 0.061438798904418945
Training time without block to device /epoch 0.05822134017944336
Training time without total dataloading part /epoch 0.028290748596191406
load block tensor time/epoch 0.026368141174316406
block to device time/epoch 0.003217458724975586
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  76872
Number of first layer input nodes during this epoch:  35456
