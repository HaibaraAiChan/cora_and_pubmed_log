main start at this time 1648532183.3730605
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011887550354003906
range selection method range initialization spend 7.009506225585938e-05
time for parepare:  4.38690185546875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.0010142326354980469
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.075599670410156e-05
----------------------check_connections_block total spend ----------------------------- 0.002651691436767578
generate_one_block  0.0019505023956298828
generate_one_block  0.0010755062103271484
generate_one_block  0.0009975433349609375
generate_one_block  0.001009225845336914
generate_one_block  0.0009877681732177734
generate_one_block  0.0010013580322265625
generate_one_block  0.0010099411010742188
generate_one_block  0.0010492801666259766
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0008585453033447266
gen group dst list time:  5.054473876953125e-05
time for parepare:  0.00024819374084472656
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00015115737915039062
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.000225067138671875
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  8.96453857421875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0001277923583984375
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  9.274482727050781e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  0.00010538101196289062
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0002865791320800781
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0002396106719970703
----------------------check_connections_block total spend ----------------------------- 0.0033445358276367188
generate_one_block  0.0012691020965576172
generate_one_block  0.0013155937194824219
generate_one_block  0.0010852813720703125
generate_one_block  0.0012159347534179688
generate_one_block  0.0011017322540283203
generate_one_block  0.0011184215545654297
generate_one_block  0.0014417171478271484
generate_one_block  0.001306295394897461
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011892318725585938
gen group dst list time:  0.00010156631469726562
time for parepare:  0.0007326602935791016
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0002951622009277344
mini_batch_src_global generation:  8.225440979003906e-05
r_  generation:  0.0008237361907958984
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.00014019012451171875
r_  generation:  0.0013921260833740234
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  8.20159912109375e-05
r_  generation:  0.0004334449768066406
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0008120536804199219
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.0007627010345458984
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0005173683166503906
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  0.0002124309539794922
r_  generation:  0.002146005630493164
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.0018663406372070312
----------------------check_connections_block total spend ----------------------------- 0.014771699905395508
generate_one_block  0.0020761489868164062
generate_one_block  0.002702474594116211
generate_one_block  0.0014939308166503906
generate_one_block  0.001903533935546875
generate_one_block  0.0018646717071533203
generate_one_block  0.0015947818756103516
generate_one_block  0.003696441650390625
generate_one_block  0.0032949447631835938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002184152603149414
gen group dst list time:  0.00028705596923828125
time for parepare:  0.0015263557434082031
local_output_nid generation:  0.00010347366333007812
local_in_edges_tensor generation:  0.0005998611450195312
mini_batch_src_global generation:  0.0006403923034667969
r_  generation:  0.004982709884643555
local_output_nid generation:  0.00017905235290527344
local_in_edges_tensor generation:  0.00043702125549316406
mini_batch_src_global generation:  0.0008766651153564453
r_  generation:  0.0066263675689697266
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.00022721290588378906
mini_batch_src_global generation:  0.00031065940856933594
r_  generation:  0.0021147727966308594
local_output_nid generation:  0.00013184547424316406
local_in_edges_tensor generation:  0.000354766845703125
mini_batch_src_global generation:  0.0003924369812011719
r_  generation:  0.004416704177856445
local_output_nid generation:  0.00012135505676269531
local_in_edges_tensor generation:  0.0003070831298828125
mini_batch_src_global generation:  0.0005118846893310547
r_  generation:  0.004729032516479492
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.00023317337036132812
mini_batch_src_global generation:  0.0003178119659423828
r_  generation:  0.002668142318725586
local_output_nid generation:  0.00021219253540039062
local_in_edges_tensor generation:  0.0004584789276123047
mini_batch_src_global generation:  0.0007333755493164062
r_  generation:  0.00828409194946289
local_output_nid generation:  0.00024366378784179688
local_in_edges_tensor generation:  0.0005156993865966797
mini_batch_src_global generation:  0.0009756088256835938
r_  generation:  0.008018016815185547
----------------------check_connections_block total spend ----------------------------- 0.0637059211730957
generate_one_block  0.008020401000976562
generate_one_block  0.009598255157470703
generate_one_block  0.0036084651947021484
generate_one_block  0.006844997406005859
generate_one_block  0.00802469253540039
generate_one_block  0.004578351974487305
generate_one_block  0.01240229606628418
generate_one_block  0.011754512786865234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022430419921875
gen group dst list time:  0.001192331314086914
time for parepare:  0.0017209053039550781
local_output_nid generation:  0.0006074905395507812
local_in_edges_tensor generation:  0.0015883445739746094
mini_batch_src_global generation:  0.0014050006866455078
r_  generation:  0.014081001281738281
local_output_nid generation:  0.0007867813110351562
local_in_edges_tensor generation:  0.0015323162078857422
mini_batch_src_global generation:  0.002036571502685547
r_  generation:  0.017290353775024414
local_output_nid generation:  0.00032520294189453125
local_in_edges_tensor generation:  0.0005736351013183594
mini_batch_src_global generation:  0.0007965564727783203
r_  generation:  0.006928205490112305
local_output_nid generation:  0.0006005764007568359
local_in_edges_tensor generation:  0.000993967056274414
mini_batch_src_global generation:  0.0011165142059326172
r_  generation:  0.014162063598632812
local_output_nid generation:  0.0005393028259277344
local_in_edges_tensor generation:  0.0010380744934082031
mini_batch_src_global generation:  0.0010976791381835938
r_  generation:  0.012658357620239258
local_output_nid generation:  0.00049591064453125
local_in_edges_tensor generation:  0.0007534027099609375
mini_batch_src_global generation:  0.0008783340454101562
r_  generation:  0.010622262954711914
local_output_nid generation:  0.0009710788726806641
local_in_edges_tensor generation:  0.0014736652374267578
mini_batch_src_global generation:  0.0014829635620117188
r_  generation:  0.018424034118652344
local_output_nid generation:  0.0007739067077636719
local_in_edges_tensor generation:  0.0012516975402832031
mini_batch_src_global generation:  0.0016057491302490234
r_  generation:  0.017496347427368164
----------------------check_connections_block total spend ----------------------------- 0.1656637191772461
generate_one_block  0.018468141555786133
generate_one_block  0.024014711380004883
generate_one_block  0.01143026351928711
generate_one_block  0.018220901489257812
generate_one_block  0.017418622970581055
generate_one_block  0.014483928680419922
generate_one_block  0.024881601333618164
generate_one_block  0.023521900177001953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

connection checking time:  0.24748587608337402
block generation total time  0.24575304985046387
average batch blocks generation time:  0.030719131231307983
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.02639627456665039  GigaBytes
Max Memory Allocated: 0.02639627456665039  GigaBytes

torch.Size([12533, 500])
torch.Size([7057, 256])
torch.Size([1402, 256])
torch.Size([315, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.05616426467895508  GigaBytes
Max Memory Allocated: 0.05894804000854492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.03481483459472656  GigaBytes
Max Memory Allocated: 0.0641937255859375  GigaBytes

torch.Size([15286, 500])
torch.Size([9137, 256])
torch.Size([2404, 256])
torch.Size([519, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.07596588134765625  GigaBytes
Max Memory Allocated: 0.07635021209716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.022034168243408203  GigaBytes
Max Memory Allocated: 0.08155202865600586  GigaBytes

torch.Size([9082, 500])
torch.Size([3398, 256])
torch.Size([802, 256])
torch.Size([178, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.03693819046020508  GigaBytes
Max Memory Allocated: 0.08155202865600586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.0303497314453125  GigaBytes
Max Memory Allocated: 0.08155202865600586  GigaBytes

torch.Size([13405, 500])
torch.Size([6553, 256])
torch.Size([1575, 256])
torch.Size([286, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.05976581573486328  GigaBytes
Max Memory Allocated: 0.08155202865600586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.0274200439453125  GigaBytes
Max Memory Allocated: 0.08155202865600586  GigaBytes

torch.Size([11849, 500])
torch.Size([5632, 256])
torch.Size([1484, 256])
torch.Size([211, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.05300712585449219  GigaBytes
Max Memory Allocated: 0.08155202865600586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.026407241821289062  GigaBytes
Max Memory Allocated: 0.08155202865600586  GigaBytes

torch.Size([11376, 500])
torch.Size([5180, 256])
torch.Size([896, 256])
torch.Size([221, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.0475163459777832  GigaBytes
Max Memory Allocated: 0.08155202865600586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.034931182861328125  GigaBytes
Max Memory Allocated: 0.08155202865600586  GigaBytes

torch.Size([15430, 500])
torch.Size([10694, 256])
torch.Size([2736, 256])
torch.Size([676, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0835118293762207  GigaBytes
Max Memory Allocated: 0.08390426635742188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03489208221435547  GigaBytes
Max Memory Allocated: 0.09018135070800781  GigaBytes

torch.Size([15417, 500])
torch.Size([8923, 256])
torch.Size([3035, 256])
torch.Size([515, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07843828201293945  GigaBytes
Max Memory Allocated: 0.09018135070800781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0078051090240478516 |0.043139636516571045 |0.10052093863487244 |0.0001532435417175293 |0.0046120285987854 |0.003406524658203125 |
----------------------------------------------------------pseudo_mini_loss sum 2.6145212650299072
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  178564
Number of first layer input nodes during this epoch:  104378
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.041348934173583984  GigaBytes
Max Memory Allocated: 0.09018135070800781  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00047135353088378906
range selection method range initialization spend 5.2928924560546875e-05
time for parepare:  4.553794860839844e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.33514404296875e-05
----------------------check_connections_block total spend ----------------------------- 0.0015804767608642578
generate_one_block  0.0010898113250732422
generate_one_block  0.0010073184967041016
generate_one_block  0.0010461807250976562
generate_one_block  0.0010223388671875
generate_one_block  0.0010199546813964844
generate_one_block  0.001027822494506836
generate_one_block  0.0010218620300292969
generate_one_block  0.0011053085327148438
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005247592926025391
gen group dst list time:  4.982948303222656e-05
time for parepare:  0.00027060508728027344
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0003020763397216797
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00014257431030273438
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.000274658203125
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  9.632110595703125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00020766258239746094
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00011229515075683594
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00015163421630859375
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  6.151199340820312e-05
----------------------check_connections_block total spend ----------------------------- 0.0034503936767578125
generate_one_block  0.0014150142669677734
generate_one_block  0.0012049674987792969
generate_one_block  0.0013527870178222656
generate_one_block  0.0011310577392578125
generate_one_block  0.0012767314910888672
generate_one_block  0.0011029243469238281
generate_one_block  0.0012080669403076172
generate_one_block  0.0010614395141601562
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010721683502197266
gen group dst list time:  0.00010657310485839844
time for parepare:  0.0007786750793457031
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.0003058910369873047
mini_batch_src_global generation:  0.0002486705780029297
r_  generation:  0.0021820068359375
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  0.00014281272888183594
r_  generation:  0.0008625984191894531
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.00020313262939453125
r_  generation:  0.0018968582153320312
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  0.0001125335693359375
r_  generation:  0.0006270408630371094
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00013589859008789062
r_  generation:  0.0014581680297851562
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  8.845329284667969e-05
r_  generation:  0.0005207061767578125
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0011451244354248047
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0002162456512451172
----------------------check_connections_block total spend ----------------------------- 0.014928817749023438
generate_one_block  0.00396728515625
generate_one_block  0.0019292831420898438
generate_one_block  0.0033578872680664062
generate_one_block  0.0016994476318359375
generate_one_block  0.0027310848236083984
generate_one_block  0.0015728473663330078
generate_one_block  0.0023593902587890625
generate_one_block  0.0011539459228515625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020706653594970703
gen group dst list time:  0.00031113624572753906
time for parepare:  0.0013778209686279297
local_output_nid generation:  0.000209808349609375
local_in_edges_tensor generation:  0.00078582763671875
mini_batch_src_global generation:  0.0007088184356689453
r_  generation:  0.009446382522583008
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.000377655029296875
mini_batch_src_global generation:  0.0007433891296386719
r_  generation:  0.004849910736083984
local_output_nid generation:  0.00024962425231933594
local_in_edges_tensor generation:  0.0004973411560058594
mini_batch_src_global generation:  0.0006489753723144531
r_  generation:  0.007152557373046875
local_output_nid generation:  0.00010132789611816406
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  0.00044536590576171875
r_  generation:  0.003670930862426758
local_output_nid generation:  0.00023865699768066406
local_in_edges_tensor generation:  0.00048804283142089844
mini_batch_src_global generation:  0.0006480216979980469
r_  generation:  0.0073566436767578125
local_output_nid generation:  9.465217590332031e-05
local_in_edges_tensor generation:  0.0002486705780029297
mini_batch_src_global generation:  0.0004146099090576172
r_  generation:  0.0030777454376220703
local_output_nid generation:  0.00021386146545410156
local_in_edges_tensor generation:  0.00041866302490234375
mini_batch_src_global generation:  0.0005512237548828125
r_  generation:  0.006218433380126953
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  0.00024390220642089844
r_  generation:  0.0009162425994873047
----------------------check_connections_block total spend ----------------------------- 0.0635526180267334
generate_one_block  0.01328587532043457
generate_one_block  0.007798910140991211
generate_one_block  0.01104283332824707
generate_one_block  0.006005764007568359
generate_one_block  0.011169672012329102
generate_one_block  0.0050122737884521484
generate_one_block  0.009246826171875
generate_one_block  0.003739595413208008
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022110939025878906
gen group dst list time:  0.0012068748474121094
time for parepare:  0.0018482208251953125
local_output_nid generation:  0.0009677410125732422
local_in_edges_tensor generation:  0.001931905746459961
mini_batch_src_global generation:  0.001911163330078125
r_  generation:  0.01961064338684082
local_output_nid generation:  0.0006639957427978516
local_in_edges_tensor generation:  0.0012357234954833984
mini_batch_src_global generation:  0.0017364025115966797
r_  generation:  0.015653371810913086
local_output_nid generation:  0.0007801055908203125
local_in_edges_tensor generation:  0.0011162757873535156
mini_batch_src_global generation:  0.001344919204711914
r_  generation:  0.01567816734313965
local_output_nid generation:  0.0006184577941894531
local_in_edges_tensor generation:  0.0008876323699951172
mini_batch_src_global generation:  0.0011396408081054688
r_  generation:  0.012553930282592773
local_output_nid generation:  0.0010077953338623047
local_in_edges_tensor generation:  0.0014257431030273438
mini_batch_src_global generation:  0.0015137195587158203
r_  generation:  0.020319223403930664
local_output_nid generation:  0.0004930496215820312
local_in_edges_tensor generation:  0.002273082733154297
mini_batch_src_global generation:  0.0011181831359863281
r_  generation:  0.011030912399291992
local_output_nid generation:  0.0008270740509033203
local_in_edges_tensor generation:  0.0012662410736083984
mini_batch_src_global generation:  0.0012116432189941406
r_  generation:  0.017215967178344727
local_output_nid generation:  0.00019359588623046875
local_in_edges_tensor generation:  0.0003638267517089844
mini_batch_src_global generation:  0.0005884170532226562
r_  generation:  0.0036308765411376953
----------------------check_connections_block total spend ----------------------------- 0.17034101486206055
generate_one_block  0.024283409118652344
generate_one_block  0.021670818328857422
generate_one_block  0.02081608772277832
generate_one_block  0.016405105590820312
generate_one_block  0.025270700454711914
generate_one_block  0.015022516250610352
generate_one_block  0.024242639541625977
generate_one_block  0.005769968032836914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.041348934173583984  GigaBytes
Max Memory Allocated: 0.09018135070800781  GigaBytes

connection checking time:  0.2522728443145752
block generation total time  0.24930715560913086
average batch blocks generation time:  0.031163394451141357
block dataloader generation time/epoch 0.5456805229187012
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.04001331329345703  GigaBytes
Max Memory Allocated: 0.09018135070800781  GigaBytes

torch.Size([15830, 500])
torch.Size([11038, 256])
torch.Size([2900, 256])
torch.Size([614, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.09017419815063477  GigaBytes
Max Memory Allocated: 0.09079837799072266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.036368370056152344  GigaBytes
Max Memory Allocated: 0.09705638885498047  GigaBytes

torch.Size([14017, 500])
torch.Size([7569, 256])
torch.Size([1539, 256])
torch.Size([329, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.06816530227661133  GigaBytes
Max Memory Allocated: 0.09705638885498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.035601139068603516  GigaBytes
Max Memory Allocated: 0.09705638885498047  GigaBytes

torch.Size([13539, 500])
torch.Size([7583, 256])
torch.Size([2602, 256])
torch.Size([566, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.07305288314819336  GigaBytes
Max Memory Allocated: 0.09705638885498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.031435489654541016  GigaBytes
Max Memory Allocated: 0.09705638885498047  GigaBytes

torch.Size([11424, 500])
torch.Size([5956, 256])
torch.Size([1002, 256])
torch.Size([237, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.056227684020996094  GigaBytes
Max Memory Allocated: 0.09705638885498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.04031705856323242  GigaBytes
Max Memory Allocated: 0.09705638885498047  GigaBytes

torch.Size([16037, 500])
torch.Size([10022, 256])
torch.Size([2753, 256])
torch.Size([507, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.08566570281982422  GigaBytes
Max Memory Allocated: 0.09705638885498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.02964019775390625  GigaBytes
Max Memory Allocated: 0.09705638885498047  GigaBytes

torch.Size([10357, 500])
torch.Size([4877, 256])
torch.Size([945, 256])
torch.Size([209, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.050974369049072266  GigaBytes
Max Memory Allocated: 0.09705638885498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.03848457336425781  GigaBytes
Max Memory Allocated: 0.09705638885498047  GigaBytes

torch.Size([15093, 500])
torch.Size([8253, 256])
torch.Size([2250, 256])
torch.Size([358, 256])Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.07550525665283203  GigaBytes
Max Memory Allocated: 0.09705638885498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.019811153411865234  GigaBytes
Max Memory Allocated: 0.09705638885498047  GigaBytes

torch.Size([5346, 500])
torch.Size([1784, 256])
torch.Size([306, 256])
torch.Size([97, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.027172565460205078  GigaBytes
Max Memory Allocated: 0.09705638885498047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007962048053741455 |0.0011413097381591797 |0.005941033363342285 |0.00013270974159240723 |0.00493776798248291 |0.002336740493774414 |
----------------------------------------------------------pseudo_mini_loss sum 1.4720503091812134
Total (block generation + training)time/epoch 0.7204806804656982
Training time/epoch 0.1745617389678955
Training time without block to device /epoch 0.16543126106262207
Training time without total dataloading part /epoch 0.09042882919311523
load block tensor time/epoch 0.06369638442993164
block to device time/epoch 0.009130477905273438
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  176296
Number of first layer input nodes during this epoch:  101643
