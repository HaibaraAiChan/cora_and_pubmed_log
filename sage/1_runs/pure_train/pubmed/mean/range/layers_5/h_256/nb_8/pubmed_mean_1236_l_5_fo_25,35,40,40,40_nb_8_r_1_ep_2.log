main start at this time 1648532173.0115278
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001332998275756836
range selection method range initialization spend 8.96453857421875e-05
time for parepare:  4.673004150390625e-05
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0011858940124511719
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.9591064453125e-05
----------------------check_connections_block total spend ----------------------------- 0.0022430419921875
generate_one_block  0.0021979808807373047
generate_one_block  0.0011911392211914062
generate_one_block  0.0010750293731689453
generate_one_block  0.001123189926147461
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0008072853088378906
gen group dst list time:  3.528594970703125e-05
time for parepare:  0.0002562999725341797
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00034618377685546875
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.00023317337036132812
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00019812583923339844
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0005586147308349609
----------------------check_connections_block total spend ----------------------------- 0.0028533935546875
generate_one_block  0.0015478134155273438
generate_one_block  0.0013508796691894531
generate_one_block  0.001316070556640625
generate_one_block  0.0018661022186279297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010638236999511719
gen group dst list time:  7.534027099609375e-05
time for parepare:  0.0007736682891845703
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.0003116130828857422
mini_batch_src_global generation:  0.00017142295837402344
r_  generation:  0.0020399093627929688
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  0.0002009868621826172
r_  generation:  0.0014073848724365234
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0012989044189453125
local_output_nid generation:  8.821487426757812e-05
local_in_edges_tensor generation:  0.000278472900390625
mini_batch_src_global generation:  0.0003941059112548828
r_  generation:  0.0037648677825927734
----------------------check_connections_block total spend ----------------------------- 0.013903379440307617
generate_one_block  0.003694295883178711
generate_one_block  0.0025687217712402344
generate_one_block  0.0024743080139160156
generate_one_block  0.0054471492767333984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018596649169921875
gen group dst list time:  0.00023174285888671875
time for parepare:  0.0014972686767578125
local_output_nid generation:  0.0002238750457763672
local_in_edges_tensor generation:  0.0008027553558349609
mini_batch_src_global generation:  0.0011260509490966797
r_  generation:  0.009538650512695312
local_output_nid generation:  0.0002002716064453125
local_in_edges_tensor generation:  0.000476837158203125
mini_batch_src_global generation:  0.0008916854858398438
r_  generation:  0.006359577178955078
local_output_nid generation:  0.00019979476928710938
local_in_edges_tensor generation:  0.0004551410675048828
mini_batch_src_global generation:  0.0006585121154785156
r_  generation:  0.006642580032348633
local_output_nid generation:  0.0003409385681152344
local_in_edges_tensor generation:  0.0006871223449707031
mini_batch_src_global generation:  0.0012755393981933594
r_  generation:  0.013013124465942383
----------------------check_connections_block total spend ----------------------------- 0.053922414779663086
generate_one_block  0.01409149169921875
generate_one_block  0.009637832641601562
generate_one_block  0.010251045227050781
generate_one_block  0.0170896053314209
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020241737365722656
gen group dst list time:  0.0008780956268310547
time for parepare:  0.001766204833984375
local_output_nid generation:  0.0008683204650878906
local_in_edges_tensor generation:  0.0019872188568115234
mini_batch_src_global generation:  0.0019159317016601562
r_  generation:  0.020380020141601562
local_output_nid generation:  0.0007610321044921875
local_in_edges_tensor generation:  0.0014331340789794922
mini_batch_src_global generation:  0.001958608627319336
r_  generation:  0.01796555519104004
local_output_nid generation:  0.0008625984191894531
local_in_edges_tensor generation:  0.0012047290802001953
mini_batch_src_global generation:  0.0015139579772949219
r_  generation:  0.017720699310302734
local_output_nid generation:  0.0011379718780517578
local_in_edges_tensor generation:  0.0017559528350830078
mini_batch_src_global generation:  0.0020699501037597656
r_  generation:  0.02232670783996582
----------------------check_connections_block total spend ----------------------------- 0.11608290672302246
generate_one_block  0.024966001510620117
generate_one_block  0.023995637893676758
generate_one_block  0.023557186126708984
generate_one_block  0.028722286224365234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

connection checking time:  0.18676209449768066
block generation total time  0.1725764274597168
average batch blocks generation time:  0.0431441068649292
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.0344691276550293  GigaBytes
Max Memory Allocated: 0.0344691276550293  GigaBytes

torch.Size([16349, 500])
torch.Size([11309, 256])
torch.Size([3132, 256])
torch.Size([777, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.08846378326416016  GigaBytes
Max Memory Allocated: 0.08886289596557617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.03479957580566406  GigaBytes
Max Memory Allocated: 0.09660673141479492  GigaBytes

torch.Size([15346, 500])
torch.Size([8382, 256])
torch.Size([2489, 256])
torch.Size([472, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.0743265151977539  GigaBytes
Max Memory Allocated: 0.09660673141479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.03298664093017578  GigaBytes
Max Memory Allocated: 0.09660673141479492  GigaBytes

torch.Size([14743, 500])
torch.Size([8788, 256])
torch.Size([2240, 256])
torch.Size([435, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.0720372200012207  GigaBytes
Max Memory Allocated: 0.09660673141479492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.03801727294921875  GigaBytes
Max Memory Allocated: 0.09660673141479492  GigaBytes

torch.Size([17281, 500])
torch.Size([12945, 256])
torch.Size([4604, 256])
torch.Size([1144, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.10392141342163086  GigaBytes
Max Memory Allocated: 0.10516834259033203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014888525009155273 |0.08662503957748413 |0.19789952039718628 |0.00017905235290527344 |0.00666886568069458 |0.004338741302490234 |
----------------------------------------------------------pseudo_mini_loss sum 2.070415496826172
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  120792
Number of first layer input nodes during this epoch:  63719
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.04499530792236328  GigaBytes
Max Memory Allocated: 0.10721683502197266  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004856586456298828
range selection method range initialization spend 5.054473876953125e-05
time for parepare:  4.482269287109375e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.147125244140625e-05
----------------------check_connections_block total spend ----------------------------- 0.000926971435546875
generate_one_block  0.0012083053588867188
generate_one_block  0.0009944438934326172
generate_one_block  0.00133514404296875
generate_one_block  0.0009770393371582031
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00048828125
gen group dst list time:  3.0279159545898438e-05
time for parepare:  0.000255584716796875
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.00038743019104003906
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.00033092498779296875
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002722740173339844
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00023889541625976562
----------------------check_connections_block total spend ----------------------------- 0.0026848316192626953
generate_one_block  0.0015103816986083984
generate_one_block  0.0013833045959472656
generate_one_block  0.0013113021850585938
generate_one_block  0.0012242794036865234
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009996891021728516
gen group dst list time:  8.082389831542969e-05
time for parepare:  0.0007593631744384766
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.0003209114074707031
mini_batch_src_global generation:  0.0002894401550292969
r_  generation:  0.002802610397338867
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  0.00027251243591308594
r_  generation:  0.002295970916748047
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  0.0002028942108154297
r_  generation:  0.0017123222351074219
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  0.00016188621520996094
r_  generation:  0.0015807151794433594
----------------------check_connections_block total spend ----------------------------- 0.01331639289855957
generate_one_block  0.004906892776489258
generate_one_block  0.0039250850677490234
generate_one_block  0.0032510757446289062
generate_one_block  0.0028429031372070312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001995563507080078
gen group dst list time:  0.00022864341735839844
time for parepare:  0.001287221908569336
local_output_nid generation:  0.0002808570861816406
local_in_edges_tensor generation:  0.0009024143218994141
mini_batch_src_global generation:  0.0009150505065917969
r_  generation:  0.010732173919677734
local_output_nid generation:  0.00024008750915527344
local_in_edges_tensor generation:  0.0005807876586914062
mini_batch_src_global generation:  0.001149892807006836
r_  generation:  0.008437395095825195
local_output_nid generation:  0.0002620220184326172
local_in_edges_tensor generation:  0.0005474090576171875
mini_batch_src_global generation:  0.0008852481842041016
r_  generation:  0.00877690315246582
local_output_nid generation:  0.00024199485778808594
local_in_edges_tensor generation:  0.0005290508270263672
mini_batch_src_global generation:  0.0007812976837158203
r_  generation:  0.007760524749755859
----------------------check_connections_block total spend ----------------------------- 0.05306601524353027
generate_one_block  0.015403032302856445
generate_one_block  0.01276254653930664
generate_one_block  0.01285409927368164
generate_one_block  0.011389732360839844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022125244140625
gen group dst list time:  0.0007560253143310547
time for parepare:  0.0016205310821533203
local_output_nid generation:  0.0009124279022216797
local_in_edges_tensor generation:  0.0020656585693359375
mini_batch_src_global generation:  0.001912832260131836
r_  generation:  0.02023029327392578
local_output_nid generation:  0.0008161067962646484
local_in_edges_tensor generation:  0.0015041828155517578
mini_batch_src_global generation:  0.001957416534423828
r_  generation:  0.017667293548583984
local_output_nid generation:  0.001043081283569336
local_in_edges_tensor generation:  0.001550436019897461
mini_batch_src_global generation:  0.0016300678253173828
r_  generation:  0.019724607467651367
local_output_nid generation:  0.0010364055633544922
local_in_edges_tensor generation:  0.0014605522155761719
mini_batch_src_global generation:  0.0016291141510009766Using backend: pytorch

r_  generation:  0.01891183853149414
----------------------check_connections_block total spend ----------------------------- 0.1129007339477539
generate_one_block  0.02723979949951172
generate_one_block  0.02451491355895996
generate_one_block  0.025390625
generate_one_block  0.024922847747802734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.04499530792236328  GigaBytes
Max Memory Allocated: 0.10721683502197266  GigaBytes

connection checking time:  0.18196797370910645
block generation total time  0.17483282089233398
average batch blocks generation time:  0.043708205223083496
block dataloader generation time/epoch 0.3926815986633301
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.04199647903442383  GigaBytes
Max Memory Allocated: 0.10721683502197266  GigaBytes

torch.Size([16843, 500])
torch.Size([12498, 256])
torch.Size([3833, 256])
torch.Size([926, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.10250520706176758  GigaBytes
Max Memory Allocated: 0.10721683502197266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.039791107177734375  GigaBytes
Max Memory Allocated: 0.10721683502197266  GigaBytes

torch.Size([15582, 500])
torch.Size([9797, 256])
torch.Size([3086, 256])
torch.Size([720, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.08723115921020508  GigaBytes
Max Memory Allocated: 0.10721683502197266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.041764259338378906  GigaBytes
Max Memory Allocated: 0.10721683502197266  GigaBytes

torch.Size([16355, 500])
torch.Size([11054, 256])
torch.Size([3208, 256])
torch.Size([671, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.09297513961791992  GigaBytes
Max Memory Allocated: 0.10721683502197266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.04081392288208008  GigaBytes
Max Memory Allocated: 0.10721683502197266  GigaBytes

torch.Size([16290, 500])
torch.Size([10016, 256])
torch.Size([2920, 256])
torch.Size([539, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.08803892135620117  GigaBytes
Max Memory Allocated: 0.10721683502197266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011323153972625732 |0.0015586018562316895 |0.0070667266845703125 |0.00014400482177734375 |0.005407273769378662 |0.002712249755859375 |
----------------------------------------------------------pseudo_mini_loss sum 1.8079471588134766
Total (block generation + training)time/epoch 0.5046882629394531
Training time/epoch 0.1117548942565918
Training time without block to device /epoch 0.10552048683166504
Training time without total dataloading part /epoch 0.05318427085876465
load block tensor time/epoch 0.04529261589050293
block to device time/epoch 0.006234407424926758
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  124694
Number of first layer input nodes during this epoch:  65070
