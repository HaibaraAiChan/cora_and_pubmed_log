main start at this time 1648532194.752411
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0018534660339355469
range selection method range initialization spend 8.678436279296875e-05
time for parepare:  4.458427429199219e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.0010504722595214844
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.9802322387695312e-05
----------------------check_connections_block total spend ----------------------------- 0.0038237571716308594
generate_one_block  0.002002716064453125
generate_one_block  0.001081705093383789
generate_one_block  0.0010366439819335938
generate_one_block  0.0010225772857666016
generate_one_block  0.001016855239868164
generate_one_block  0.0010280609130859375
generate_one_block  0.0010561943054199219
generate_one_block  0.0010344982147216797
generate_one_block  0.0010342597961425781
generate_one_block  0.0009851455688476562
generate_one_block  0.0009553432464599609
generate_one_block  0.0009546279907226562
generate_one_block  0.000972747802734375
generate_one_block  0.0010411739349365234
generate_one_block  0.0010221004486083984
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012505054473876953
gen group dst list time:  8.082389831542969e-05
time for parepare:  0.0002562999725341797
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  7.915496826171875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0001842975616455078
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.937980651855469e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  9.131431579589844e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.14984130859375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00013637542724609375
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0001761913299560547
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00024700164794921875
----------------------check_connections_block total spend ----------------------------- 0.00457000732421875
generate_one_block  0.0011305809020996094
generate_one_block  0.0011303424835205078
generate_one_block  0.001280069351196289
generate_one_block  0.001088857650756836
generate_one_block  0.0010585784912109375
generate_one_block  0.0011324882507324219
generate_one_block  0.0010890960693359375
generate_one_block  0.001123666763305664
generate_one_block  0.001074075698852539
generate_one_block  0.0011022090911865234
generate_one_block  0.001085519790649414
generate_one_block  0.0010209083557128906
generate_one_block  0.001203775405883789
generate_one_block  0.0012192726135253906
generate_one_block  0.0012669563293457031
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010540485382080078
gen group dst list time:  0.00012183189392089844
time for parepare:  0.0007293224334716797
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00025177001953125
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0003502368927001953
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0005261898040771484
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.0010807514190673828
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0004253387451171875
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00016379356384277344
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002810955047607422
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.000457763671875
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.00041747093200683594
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0003528594970703125
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.00044989585876464844
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00023293495178222656
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0002987384796142578
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0008356571197509766
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  0.0001518726348876953
r_  generation:  0.0014255046844482422
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  0.0002090930938720703
r_  generation:  0.0019855499267578125
----------------------check_connections_block total spend ----------------------------- 0.01643538475036621
generate_one_block  0.0015254020690917969
generate_one_block  0.0016052722930908203
generate_one_block  0.0022106170654296875
generate_one_block  0.0014383792877197266
generate_one_block  0.0011906623840332031
generate_one_block  0.001277923583984375
generate_one_block  0.0015189647674560547
generate_one_block  0.001402139663696289
generate_one_block  0.0013828277587890625
generate_one_block  0.0014755725860595703
generate_one_block  0.0012149810791015625
generate_one_block  0.0012936592102050781
generate_one_block  0.0021677017211914062
generate_one_block  0.0026140213012695312
generate_one_block  0.003284454345703125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021555423736572266
gen group dst list time:  0.0003063678741455078
time for parepare:  0.001611471176147461
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00048351287841796875
mini_batch_src_global generation:  0.0002734661102294922
r_  generation:  0.0020427703857421875
local_output_nid generation:  8.20159912109375e-05
local_in_edges_tensor generation:  0.0002865791320800781
mini_batch_src_global generation:  0.0005092620849609375
r_  generation:  0.004077911376953125
local_output_nid generation:  0.000141143798828125
local_in_edges_tensor generation:  0.00036263465881347656
mini_batch_src_global generation:  0.0005171298980712891
r_  generation:  0.00495600700378418
local_output_nid generation:  6.771087646484375e-05
local_in_edges_tensor generation:  0.000225067138671875
mini_batch_src_global generation:  0.00030493736267089844
r_  generation:  0.0026025772094726562
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.00080108642578125
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  0.00013756752014160156
r_  generation:  0.0014367103576660156
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  0.0002491474151611328
r_  generation:  0.0027573108673095703
local_output_nid generation:  6.604194641113281e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  0.00023698806762695312
r_  generation:  0.0021390914916992188
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  0.0002701282501220703
r_  generation:  0.002712726593017578
local_output_nid generation:  6.604194641113281e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.0003066062927246094
r_  generation:  0.0028879642486572266
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  0.0002105236053466797
r_  generation:  0.0015361309051513672
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  0.00013971328735351562
r_  generation:  0.0011539459228515625
local_output_nid generation:  0.00011610984802246094
local_in_edges_tensor generation:  0.0002899169921875
mini_batch_src_global generation:  0.0003497600555419922
r_  generation:  0.0042035579681396484
local_output_nid generation:  0.00011777877807617188
local_in_edges_tensor generation:  0.00031375885009765625
mini_batch_src_global generation:  0.0005946159362792969
r_  generation:  0.004906177520751953
local_output_nid generation:  0.00023818016052246094
local_in_edges_tensor generation:  0.0005040168762207031
mini_batch_src_global generation:  0.0008189678192138672
r_  generation:  0.007978677749633789
----------------------check_connections_block total spend ----------------------------- 0.07044005393981934
generate_one_block  0.004209041595458984
generate_one_block  0.006053924560546875
generate_one_block  0.007199525833129883
generate_one_block  0.004263162612915039
generate_one_block  0.001806497573852539
generate_one_block  0.002697467803955078
generate_one_block  0.004701852798461914
generate_one_block  0.0038399696350097656
generate_one_block  0.00489354133605957
generate_one_block  0.005536556243896484
generate_one_block  0.0030710697174072266
generate_one_block  0.0023539066314697266
generate_one_block  0.006761312484741211
generate_one_block  0.007521629333496094
generate_one_block  0.012108087539672852
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022537708282470703
gen group dst list time:  0.001547098159790039
time for parepare:  0.0017366409301757812
local_output_nid generation:  0.0003509521484375
local_in_edges_tensor generation:  0.0011296272277832031
mini_batch_src_global generation:  0.0009810924530029297
r_  generation:  0.008359670639038086
local_output_nid generation:  0.0004889965057373047
local_in_edges_tensor generation:  0.0009758472442626953
mini_batch_src_global generation:  0.0013306140899658203
r_  generation:  0.012398958206176758
local_output_nid generation:  0.0006113052368164062
local_in_edges_tensor generation:  0.0010499954223632812
mini_batch_src_global generation:  0.0012335777282714844
r_  generation:  0.013395547866821289
local_output_nid generation:  0.0003311634063720703
local_in_edges_tensor generation:  0.0006456375122070312
mini_batch_src_global generation:  0.0008721351623535156
r_  generation:  0.008841991424560547
local_output_nid generation:  0.00014638900756835938
local_in_edges_tensor generation:  0.0003039836883544922
mini_batch_src_global generation:  0.0004317760467529297
r_  generation:  0.00325775146484375
local_output_nid generation:  0.0002372264862060547
local_in_edges_tensor generation:  0.00043654441833496094
mini_batch_src_global generation:  0.0004673004150390625
r_  generation:  0.0051403045654296875
local_output_nid generation:  0.00039768218994140625
local_in_edges_tensor generation:  0.0006537437438964844
mini_batch_src_global generation:  0.0010139942169189453
r_  generation:  0.010554790496826172
local_output_nid generation:  0.00038504600524902344
local_in_edges_tensor generation:  0.0008499622344970703
mini_batch_src_global generation:  0.0010907649993896484
r_  generation:  0.009341955184936523
local_output_nid generation:  0.00029850006103515625
local_in_edges_tensor generation:  0.0005364418029785156
mini_batch_src_global generation:  0.0008146762847900391
r_  generation:  0.008348703384399414
local_output_nid generation:  0.00037860870361328125
local_in_edges_tensor generation:  0.0007796287536621094
mini_batch_src_global generation:  0.0007925033569335938
r_  generation:  0.008475065231323242
local_output_nid generation:  0.0003521442413330078
local_in_edges_tensor generation:  0.0005571842193603516
mini_batch_src_global generation:  0.000667572021484375
r_  generation:  0.006386280059814453
local_output_nid generation:  0.00017118453979492188
local_in_edges_tensor generation:  0.0003418922424316406
mini_batch_src_global generation:  0.0004878044128417969
r_  generation:  0.004549741744995117
local_output_nid generation:  0.0006239414215087891
local_in_edges_tensor generation:  0.001434326171875
mini_batch_src_global generation:  0.0011439323425292969
r_  generation:  0.014341115951538086
local_output_nid generation:  0.0004546642303466797
local_in_edges_tensor generation:  0.0008060932159423828
mini_batch_src_global generation:  0.0010540485382080078
r_  generation:  0.010613679885864258
local_output_nid generation:  0.0007965564727783203
local_in_edges_tensor generation:  0.0015861988067626953
mini_batch_src_global generation:  0.0013344287872314453
r_  generation:  0.017909526824951172
----------------------check_connections_block total spend ----------------------------- 0.21051573753356934
generate_one_block  0.012085676193237305
generate_one_block  0.015874624252319336
generate_one_block  0.018183469772338867
generate_one_block  0.013317108154296875
generate_one_block  0.0050661563873291016
generate_one_block  0.00873422622680664
generate_one_block  0.014496326446533203
generate_one_block  0.013432979583740234
generate_one_block  0.012341499328613281
generate_one_block  0.01200103759765625
generate_one_block  0.009014606475830078
generate_one_block  0.006671905517578125
generate_one_block  0.017434120178222656
generate_one_block  0.014516115188598633
generate_one_block  0.024112462997436523
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

connection checking time:  0.30196118354797363
block generation total time  0.3169088363647461
average batch blocks generation time:  0.02112725575764974
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.020296573638916016  GigaBytes
Max Memory Allocated: 0.020296573638916016  GigaBytes

torch.Size([9198, 500])
torch.Size([3631, 256])
torch.Size([572, 256])
torch.Size([150, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03522634506225586  GigaBytes
Max Memory Allocated: 0.04006814956665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.025510787963867188  GigaBytes
Max Memory Allocated: 0.04265642166137695  GigaBytes

torch.Size([10846, 500])
torch.Size([5660, 256])
torch.Size([978, 256])
torch.Size([167, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.0482630729675293  GigaBytes
Max Memory Allocated: 0.052399635314941406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.02962970733642578  GigaBytes
Max Memory Allocated: 0.054483890533447266  GigaBytes

torch.Size([13041, 500])
torch.Size([7288, 256])
torch.Size([1807, 256])
torch.Size([427, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.06267642974853516  GigaBytes
Max Memory Allocated: 0.06328105926513672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.023047447204589844  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

torch.Size([9580, 500])
torch.Size([3516, 256])
torch.Size([770, 256])
torch.Size([99, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.037912845611572266  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.01416778564453125  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

torch.Size([4933, 500])
torch.Size([1436, 256])
torch.Size([248, 256])
torch.Size([88, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.020157337188720703  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.018520832061767578  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

torch.Size([7230, 500])
torch.Size([2402, 256])
torch.Size([566, 256])
torch.Size([92, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.028909683227539062  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.025002479553222656  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

torch.Size([10610, 500])
torch.Size([4204, 256])
torch.Size([847, 256])
torch.Size([120, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.04312944412231445  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.024909496307373047  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

torch.Size([10592, 500])
torch.Size([3926, 256])
torch.Size([788, 256])
torch.Size([166, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.04145193099975586  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.02073383331298828  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

torch.Size([8344, 500])
torch.Size([3298, 256])
torch.Size([839, 256])
torch.Size([76, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.03508472442626953  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.021575927734375  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

torch.Size([8792, 500])
torch.Size([3993, 256])
torch.Size([780, 256])
torch.Size([137, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.038091182708740234  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.02072286605834961  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

torch.Size([8396, 500])
torch.Size([3611, 256])
torch.Size([452, 256])
torch.Size([120, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.034525394439697266  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.016412734985351562  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

torch.Size([6109, 500])
torch.Size([1823, 256])
torch.Size([428, 256])
torch.Size([102, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.02448415756225586  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.030731201171875  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

torch.Size([13205, 500])
torch.Size([7661, 256])
torch.Size([1408, 256])
torch.Size([336, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.06237936019897461  GigaBytes
Max Memory Allocated: 0.0674738883972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.02159261703491211  GigaBytes
Max Memory Allocated: 0.06979894638061523  GigaBytes

torch.Size([8737, 500])
torch.Size([4996, 256])
torch.Size([1414, 256])
torch.Size([341, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.0456385612487793  GigaBytes
Max Memory Allocated: 0.06979894638061523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.034890174865722656  GigaBytes
Max Memory Allocated: 0.06979894638061523  GigaBytes

torch.Size([15395, 500])
torch.Size([8985, 256])
torch.Size([3015, 256])
torch.Size([510, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07858133316040039  GigaBytes
Max Memory Allocated: 0.07903146743774414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007524744669596354 |0.023798338572184243 |0.05628457069396973 |0.00013208389282226562 |0.004119157791137695 |0.003245115280151367 |
----------------------------------------------------------pseudo_mini_loss sum 2.369464874267578
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  229638
Number of first layer input nodes during this epoch:  145008
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4041748046875 GB
    Memory Allocated: 0.04134321212768555  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004913806915283203
range selection method range initialization spend 5.173683166503906e-05
time for parepare:  5.054473876953125e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.4066696166992188e-05
----------------------check_connections_block total spend ----------------------------- 0.0026810169219970703
generate_one_block  0.0011320114135742188
generate_one_block  0.0013020038604736328
generate_one_block  0.0010075569152832031
generate_one_block  0.001031637191772461
generate_one_block  0.001033782958984375
generate_one_block  0.0010232925415039062
generate_one_block  0.000990152359008789
generate_one_block  0.0010344982147216797
generate_one_block  0.0010313987731933594
generate_one_block  0.0010139942169189453
generate_one_block  0.0010197162628173828
generate_one_block  0.0010342597961425781
generate_one_block  0.0009572505950927734
generate_one_block  0.0009810924530029297
generate_one_block  0.0009975433349609375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006625652313232422
gen group dst list time:  7.963180541992188e-05
time for parepare:  0.00028204917907714844
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00014710426330566406
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00017952919006347656
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  8.392333984375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00020241737365722656
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  9.775161743164062e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00016927719116210938
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  6.794929504394531e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  7.224082946777344e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.535385131835938e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.772445678710938e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.793571472167969e-05
----------------------check_connections_block total spend ----------------------------- 0.0047686100006103516
generate_one_block  0.0012140274047851562
generate_one_block  0.002576112747192383
generate_one_block  0.0011096000671386719
generate_one_block  0.0011057853698730469
generate_one_block  0.0012729167938232422
generate_one_block  0.0011205673217773438
generate_one_block  0.0010662078857421875
generate_one_block  0.0010921955108642578
generate_one_block  0.0012340545654296875
generate_one_block  0.0010840892791748047
generate_one_block  0.0010700225830078125
generate_one_block  0.0010144710540771484
generate_one_block  0.0011022090911865234
generate_one_block  0.001096963882446289
generate_one_block  0.0010175704956054688
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001157522201538086
gen group dst list time:  0.00012612342834472656
time for parepare:  0.0008425712585449219
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0002682209014892578
mini_batch_src_global generation:  0.00010657310485839844
r_  generation:  0.0009059906005859375
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  0.0001823902130126953
r_  generation:  0.0013642311096191406
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0004761219024658203
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0003845691680908203
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  0.00015664100646972656
r_  generation:  0.0015673637390136719
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.0005483627319335938
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00020384788513183594
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0004069805145263672
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  9.489059448242188e-05
r_  generation:  0.0010075569152832031
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  7.677078247070312e-05
r_  generation:  0.0004940032958984375
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00026035308837890625
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00027823448181152344
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  8.511543273925781e-05
r_  generation:  0.0008335113525390625
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.00041222572326660156
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00020503997802734375
----------------------check_connections_block total spend ----------------------------- 0.016861915588378906
generate_one_block  0.0021033287048339844
generate_one_block  0.0025348663330078125
generate_one_block  0.001486063003540039
generate_one_block  0.0014164447784423828
generate_one_block  0.0029211044311523438
generate_one_block  0.0015850067138671875
generate_one_block  0.0011646747589111328
generate_one_block  0.0013959407806396484
generate_one_block  0.002123117446899414
generate_one_block  0.00164794921875
generate_one_block  0.0012362003326416016
generate_one_block  0.0012650489807128906
generate_one_block  0.002363920211791992
generate_one_block  0.0013794898986816406
generate_one_block  0.0011632442474365234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020515918731689453
gen group dst list time:  0.0003635883331298828
time for parepare:  0.0015125274658203125
local_output_nid generation:  0.00013685226440429688
local_in_edges_tensor generation:  0.0006148815155029297
mini_batch_src_global generation:  0.0004799365997314453
r_  generation:  0.005157947540283203
local_output_nid generation:  0.00011897087097167969
local_in_edges_tensor generation:  0.0003349781036376953
mini_batch_src_global generation:  0.0006659030914306641
r_  generation:  0.004947185516357422
local_output_nid generation:  9.083747863769531e-05
local_in_edges_tensor generation:  0.0002703666687011719
mini_batch_src_global generation:  0.00034546852111816406
r_  generation:  0.0029468536376953125
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00022673606872558594
mini_batch_src_global generation:  0.00028133392333984375
r_  generation:  0.0021834373474121094
local_output_nid generation:  0.00017452239990234375
local_in_edges_tensor generation:  0.0004138946533203125
mini_batch_src_global generation:  0.0005278587341308594
r_  generation:  0.0059413909912109375
local_output_nid generation:  0.00010585784912109375
local_in_edges_tensor generation:  0.00025343894958496094
mini_batch_src_global generation:  0.0003647804260253906
r_  generation:  0.0025048255920410156
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  0.0001735687255859375
r_  generation:  0.001041412353515625
local_output_nid generation:  0.00011086463928222656
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  0.00025391578674316406
r_  generation:  0.004202127456665039
local_output_nid generation:  0.00020813941955566406
local_in_edges_tensor generation:  0.00036907196044921875
mini_batch_src_global generation:  0.0004131793975830078
r_  generation:  0.00467681884765625
local_output_nid generation:  0.00015664100646972656
local_in_edges_tensor generation:  0.0003058910369873047
mini_batch_src_global generation:  0.0003986358642578125
r_  generation:  0.0036420822143554688
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.0013132095336914062
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.0001811981201171875
r_  generation:  0.0017049312591552734
local_output_nid generation:  0.00023794174194335938
local_in_edges_tensor generation:  0.0004000663757324219
mini_batch_src_global generation:  0.0004487037658691406
r_  generation:  0.0051915645599365234
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  0.0003159046173095703
r_  generation:  0.002273082733154297
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0008471012115478516
----------------------check_connections_block total spend ----------------------------- 0.07341289520263672
generate_one_block  0.008325338363647461
generate_one_block  0.007154703140258789
generate_one_block  0.0046520233154296875
generate_one_block  0.0038406848907470703
generate_one_block  0.00913238525390625
generate_one_block  0.004280567169189453
generate_one_block  0.0022776126861572266
generate_one_block  0.0062062740325927734
generate_one_block  0.0070209503173828125
generate_one_block  0.006165504455566406
generate_one_block  0.002687215805053711
generate_one_block  0.0032074451446533203
generate_one_block  0.009011030197143555
generate_one_block  0.0038874149322509766
generate_one_block  0.0020270347595214844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0023581981658935547
gen group dst list time:  0.001455068588256836
time for parepare:  0.0018553733825683594
local_output_nid generation:  0.0006775856018066406
local_in_edges_tensor generation:  0.0016553401947021484
mini_batch_src_global generation:  0.001497030258178711
r_  generation:  0.014921188354492188
local_output_nid generation:  0.0004038810729980469
local_in_edges_tensor generation:  0.0007901191711425781
mini_batch_src_global generation:  0.0012257099151611328
r_  generation:  0.009104251861572266
local_output_nid generation:  0.0004508495330810547
local_in_edges_tensor generation:  0.0008285045623779297
mini_batch_src_global generation:  0.0010585784912109375
r_  generation:  0.01060795783996582
local_output_nid generation:  0.000385284423828125
local_in_edges_tensor generation:  0.0006933212280273438
mini_batch_src_global generation:  0.0007650852203369141
r_  generation:  0.007473945617675781
local_output_nid generation:  0.0005509853363037109
local_in_edges_tensor generation:  0.0008418560028076172
mini_batch_src_global generation:  0.0009486675262451172
r_  generation:  0.011820316314697266
local_output_nid generation:  0.0004322528839111328
local_in_edges_tensor generation:  0.0006871223449707031
mini_batch_src_global generation:  0.0010058879852294922
r_  generation:  0.008827924728393555
local_output_nid generation:  0.0002257823944091797
local_in_edges_tensor generation:  0.00039696693420410156
mini_batch_src_global generation:  0.001729726791381836
r_  generation:  0.004442453384399414
local_output_nid generation:  0.00046062469482421875
local_in_edges_tensor generation:  0.0007109642028808594
mini_batch_src_global generation:  0.0008509159088134766
r_  generation:  0.010224580764770508
local_output_nid generation:  0.0006759166717529297
local_in_edges_tensor generation:  0.00115203857421875
mini_batch_src_global generation:  0.0009872913360595703
r_  generation:  0.01322317123413086
local_output_nid generation:  0.0005257129669189453
local_in_edges_tensor generation:  0.0010318756103515625
mini_batch_src_global generation:  0.001004934310913086
r_  generation:  0.011454105377197266
local_output_nid generation:  0.00026297569274902344
local_in_edges_tensor generation:  0.00044727325439453125
mini_batch_src_global generation:  0.0006020069122314453
r_  generation:  0.004765987396240234
local_output_nid generation:  0.0002799034118652344
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0005979537963867188
r_  generation:  0.006462812423706055
local_output_nid generation:  0.0006990432739257812
local_in_edges_tensor generation:  0.0010063648223876953
mini_batch_src_global generation:  0.0014007091522216797
r_  generation:  0.01629352569580078
local_output_nid generation:  0.00044274330139160156
local_in_edges_tensor generation:  0.0006833076477050781
mini_batch_src_global generation:  0.0011150836944580078
r_  generation:  0.009909629821777344
local_output_nid generation:  0.00021266937255859375
local_in_edges_tensor generation:  0.00036263465881347656
mini_batch_src_global generation:  0.00046753883361816406
r_  generation:  0.0035097599029541016
----------------------check_connections_block total spend ----------------------------- 0.21390771865844727
generate_one_block  0.01933431625366211
generate_one_block  0.013781070709228516
generate_one_block  0.01455545425415039
generate_one_block  0.010696172714233398
generate_one_block  0.017344951629638672
generate_one_block  0.013414859771728516
generate_one_block  0.008010625839233398
generate_one_block  0.013278007507324219
generate_one_block  0.01773524284362793
generate_one_block  0.015561580657958984
generate_one_block  0.0070683956146240234
generate_one_block  0.009720325469970703
generate_one_block  0.021343708038330078
generate_one_block  0.012854576110839844
generate_one_block  0.0067212581634521484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4041748046875 GB
    Memory Allocated: 0.04134321212768555  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

connection checking time:  0.30895113945007324
block generation total time  0.3252599239349365
average batch blocks generation time:  0.021683994928995767
block dataloader generation time/epoch 0.6960182189941406
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.03578472137451172  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

torch.Size([13706, 500])
torch.Size([7990, 256])
torch.Size([1629, 256])
torch.Size([317, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.06988334655761719  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.025277137756347656  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

torch.Size([8117, 500])
torch.Size([4439, 256])
torch.Size([1332, 256])
torch.Size([303, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.04669475555419922  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.03158092498779297  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

torch.Size([11066, 500])
torch.Size([4525, 256])
torch.Size([901, 256])
torch.Size([170, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.0504603385925293  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.026067256927490234  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

torch.Size([8632, 500])
torch.Size([3979, 256])
torch.Size([688, 256])
torch.Size([161, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.042200565338134766  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.028638362884521484  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

torch.Size([9876, 500])
torch.Size([5516, 256])
torch.Size([1927, 256])
torch.Size([416, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.056423187255859375  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.029944896697998047  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

torch.Size([10678, 500])
torch.Size([3983, 256])
torch.Size([938, 256])
torch.Size([162, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.04720878601074219  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.021997928619384766  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

torch.Size([6505, 500])
torch.Size([2094, 256])
torch.Size([303, 256])
torch.Size([90, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.030293941497802734  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.027985572814941406  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

torch.Size([9610, 500])
torch.Size([4635, 256])
torch.Size([734, 256])
torch.Size([147, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.04689598083496094  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.034366607666015625  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

torch.Size([12979, 500])
torch.Size([6904, 256])
torch.Size([1737, 256])
torch.Size([374, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.0651235580444336  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.029669761657714844  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

torch.Size([10176, 500])
torch.Size([4925, 256])
torch.Size([1076, 256])
torch.Size([136, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.05096578598022461  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.02058696746826172  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

torch.Size([5740, 500])
torch.Size([2417, 256])
torch.Size([399, 256])
torch.Size([112, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.030375957489013672  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.022641658782958984  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

torch.Size([6802, 500])
torch.Size([2553, 256])
torch.Size([544, 256])
torch.Size([96, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.03356647491455078  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.03795289993286133  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

torch.Size([14840, 500])
torch.Size([7085, 256])
torch.Size([1894, 256])
torch.Size([198, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.06987476348876953  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.027739524841308594  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

torch.Size([9503, 500])
torch.Size([3962, 256])
torch.Size([611, 256])
torch.Size([162, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.04355955123901367  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.019374370574951172  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

torch.Size([5113, 500])
torch.Size([1765, 256])
torch.Size([305, 256])
torch.Size([97, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.026670455932617188  GigaBytes
Max Memory Allocated: 0.08203649520874023  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005138889948527018 |0.00088653564453125 |0.005519723892211914 |0.00014406840006510416 |0.004822524388631185 |0.002208709716796875 |
----------------------------------------------------------pseudo_mini_loss sum 1.918227195739746
Total (block generation + training)time/epoch 0.965552806854248
Training time/epoch 0.2691013813018799
Training time without block to device /epoch 0.25580334663391113
Training time without total dataloading part /epoch 0.15950345993041992
load block tensor time/epoch 0.07708334922790527
block to device time/epoch 0.01329803466796875
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  228431
Number of first layer input nodes during this epoch:  143343
