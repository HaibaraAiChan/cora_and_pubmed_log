main start at this time 1648532128.4258747
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.002013683319091797
range selection method range initialization spend 8.559226989746094e-05
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0014688968658447266
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2172927856445312e-05
----------------------check_connections_block total spend ----------------------------- 0.0032041072845458984
generate_one_block  0.0012786388397216797
generate_one_block  0.001058340072631836
generate_one_block  0.0010333061218261719
generate_one_block  0.0010290145874023438
generate_one_block  0.0010290145874023438
generate_one_block  0.0010409355163574219
generate_one_block  0.0010275840759277344
generate_one_block  0.0010640621185302734
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010521411895751953
gen group dst list time:  5.030632019042969e-05
time for parepare:  0.00023317337036132812
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001423358917236328
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0001671314239501953
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00016236305236816406
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.000194549560546875
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00026679039001464844
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00016832351684570312
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00018525123596191406
----------------------check_connections_block total spend ----------------------------- 0.003430604934692383
generate_one_block  0.0012373924255371094
generate_one_block  0.0012328624725341797
generate_one_block  0.0010945796966552734
generate_one_block  0.0012576580047607422
generate_one_block  0.0012831687927246094
generate_one_block  0.0013685226440429688
generate_one_block  0.0012850761413574219
generate_one_block  0.0012531280517578125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012836456298828125
gen group dst list time:  9.107589721679688e-05
time for parepare:  0.0007596015930175781
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0002589225769042969
mini_batch_src_global generation:  8.225440979003906e-05
r_  generation:  0.0008032321929931641
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0009329319000244141
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.0002961158752441406
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  0.00012230873107910156
r_  generation:  0.0011668205261230469
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  0.0001747608184814453
r_  generation:  0.0012848377227783203
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.00022029876708984375
r_  generation:  0.0019207000732421875
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.0011398792266845703
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  0.0001518726348876953
r_  generation:  0.0014128684997558594
----------------------check_connections_block total spend ----------------------------- 0.015010356903076172
generate_one_block  0.0020394325256347656
generate_one_block  0.0021343231201171875
generate_one_block  0.0012290477752685547
generate_one_block  0.0023796558380126953
generate_one_block  0.002493143081665039
generate_one_block  0.0033452510833740234
generate_one_block  0.002294301986694336
generate_one_block  0.002613067626953125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002155780792236328
gen group dst list time:  0.00026917457580566406
time for parepare:  0.001543283462524414
local_output_nid generation:  0.00010251998901367188
local_in_edges_tensor generation:  0.0005884170532226562
mini_batch_src_global generation:  0.0005555152893066406
r_  generation:  0.0045318603515625
local_output_nid generation:  0.00016260147094726562
local_in_edges_tensor generation:  0.00041365623474121094
mini_batch_src_global generation:  0.0007143020629882812
r_  generation:  0.005492210388183594
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.0002262592315673828
r_  generation:  0.0012564659118652344
local_output_nid generation:  0.0002040863037109375
local_in_edges_tensor generation:  0.00045108795166015625
mini_batch_src_global generation:  0.00054931640625
r_  generation:  0.006526947021484375
local_output_nid generation:  0.00017762184143066406
local_in_edges_tensor generation:  0.00042247772216796875
mini_batch_src_global generation:  0.0008523464202880859
r_  generation:  0.006655693054199219
local_output_nid generation:  0.0001990795135498047
local_in_edges_tensor generation:  0.00044989585876464844
mini_batch_src_global generation:  0.0007889270782470703
r_  generation:  0.007582664489746094
local_output_nid generation:  0.00017547607421875
local_in_edges_tensor generation:  0.0003867149353027344
mini_batch_src_global generation:  0.0006206035614013672
r_  generation:  0.005921840667724609
local_output_nid generation:  0.00015735626220703125
local_in_edges_tensor generation:  0.0003612041473388672
mini_batch_src_global generation:  0.0005824565887451172
r_  generation:  0.0058019161224365234
----------------------check_connections_block total spend ----------------------------- 0.06638526916503906
generate_one_block  0.007359743118286133
generate_one_block  0.008115768432617188
generate_one_block  0.00296783447265625
generate_one_block  0.009477376937866211
generate_one_block  0.010647058486938477
generate_one_block  0.01153874397277832
generate_one_block  0.008997440338134766
generate_one_block  0.008511781692504883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022559165954589844
gen group dst list time:  0.0014221668243408203
time for parepare:  0.00174713134765625
local_output_nid generation:  0.0005733966827392578
local_in_edges_tensor generation:  0.0015485286712646484
mini_batch_src_global generation:  0.0013582706451416016
r_  generation:  0.01369619369506836
local_output_nid generation:  0.0006458759307861328
local_in_edges_tensor generation:  0.00164794921875
mini_batch_src_global generation:  0.0017647743225097656
r_  generation:  0.016034603118896484
local_output_nid generation:  0.00021767616271972656
local_in_edges_tensor generation:  0.0004584789276123047
mini_batch_src_global generation:  0.0006268024444580078
r_  generation:  0.004477977752685547
local_output_nid generation:  0.0006842613220214844
local_in_edges_tensor generation:  0.0011332035064697266
mini_batch_src_global generation:  0.001313924789428711
r_  generation:  0.016571998596191406
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0016117095947265625
mini_batch_src_global generation:  0.002046346664428711
r_  generation:  0.018328428268432617
local_output_nid generation:  0.0008282661437988281
local_in_edges_tensor generation:  0.0012135505676269531
mini_batch_src_global generation:  0.0016489028930664062
r_  generation:  0.017778396606445312
local_output_nid generation:  0.0007519721984863281
local_in_edges_tensor generation:  0.0011868476867675781
mini_batch_src_global generation:  0.0017075538635253906
r_  generation:  0.016742467880249023
local_output_nid generation:  0.0005571842193603516
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.001214742660522461
r_  generation:  0.014284610748291016
----------------------check_connections_block total spend ----------------------------- 0.17388224601745605
generate_one_block  0.018110990524291992
generate_one_block  0.02246832847595215
generate_one_block  0.007864236831665039
generate_one_block  0.021376609802246094
generate_one_block  0.024739742279052734
generate_one_block  0.022993803024291992
generate_one_block  0.022040367126464844
generate_one_block  0.01813220977783203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  0.25870847702026367
block generation total time  0.25388264656066895
average batch blocks generation time:  0.03173533082008362
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.024775981903076172  GigaBytes
Max Memory Allocated: 0.024775981903076172  GigaBytes

torch.Size([12319, 500])
torch.Size([6600, 128])
torch.Size([1321, 128])
torch.Size([311, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03892707824707031  GigaBytes
Max Memory Allocated: 0.040480613708496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.03005218505859375  GigaBytes
Max Memory Allocated: 0.052930355072021484  GigaBytes

torch.Size([14917, 500])
torch.Size([7738, 128])
torch.Size([2060, 128])
torch.Size([314, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.04865455627441406  GigaBytes
Max Memory Allocated: 0.052930355072021484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.013926982879638672  GigaBytes
Max Memory Allocated: 0.052930355072021484  GigaBytes

torch.Size([6483, 500])
torch.Size([2133, 128])
torch.Size([430, 128])
torch.Size([148, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.018923282623291016  GigaBytes
Max Memory Allocated: 0.052930355072021484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.029180049896240234  GigaBytes
Max Memory Allocated: 0.052930355072021484  GigaBytes

torch.Size([14416, 500])
torch.Size([8035, 128])
torch.Size([2318, 128])
torch.Size([358, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.048745155334472656  GigaBytes
Max Memory Allocated: 0.052930355072021484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.030663013458251953  GigaBytes
Max Memory Allocated: 0.05684614181518555  GigaBytes

torch.Size([15186, 500])
torch.Size([10080, 128])
torch.Size([2162, 128])
torch.Size([466, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.0534210205078125  GigaBytes
Max Memory Allocated: 0.05684614181518555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.029760360717773438  GigaBytes
Max Memory Allocated: 0.05734539031982422  GigaBytes

torch.Size([14684, 500])
torch.Size([9116, 128])
torch.Size([2387, 128])
torch.Size([548, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.0516057014465332  GigaBytes
Max Memory Allocated: 0.05734539031982422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.029886722564697266  GigaBytes
Max Memory Allocated: 0.05734539031982422  GigaBytes

torch.Size([14805, 500])
torch.Size([8192, 128])
torch.Size([2063, 128])
torch.Size([372, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.04925680160522461  GigaBytes
Max Memory Allocated: 0.05734539031982422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.02460193634033203  GigaBytes
Max Memory Allocated: 0.05734539031982422  GigaBytes

torch.Size([11999, 500])
torch.Size([6526, 128])
torch.Size([1833, 128])
torch.Size([396, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.03992176055908203  GigaBytes
Max Memory Allocated: 0.05734539031982422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010390400886535645 |0.043291956186294556 |0.10109061002731323 |0.00013709068298339844 |0.0047945380210876465 |0.0035979747772216797 |
----------------------------------------------------------pseudo_mini_loss sum 2.096292495727539
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  181073
Number of first layer input nodes during this epoch:  104809
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.027503013610839844  GigaBytes
Max Memory Allocated: 0.05734539031982422  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00048470497131347656
range selection method range initialization spend 5.054473876953125e-05
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5020370483398438e-05
----------------------check_connections_block total spend ----------------------------- 0.001538991928100586
generate_one_block  0.0011661052703857422
generate_one_block  0.0010221004486083984
generate_one_block  0.0010075569152832031
generate_one_block  0.0009877681732177734
generate_one_block  0.0010192394256591797
generate_one_block  0.0009987354278564453
generate_one_block  0.00098419189453125
generate_one_block  0.0011022090911865234
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005235671997070312
gen group dst list time:  5.030632019042969e-05
time for parepare:  0.00027751922607421875
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00016736984252929688
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00013756752014160156
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0003731250762939453
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.00022268295288085938
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00010037422180175781
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0001327991485595703
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00015616416931152344
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.724761962890625e-05
----------------------check_connections_block total spend ----------------------------- 0.003432750701904297
generate_one_block  0.0012159347534179688
generate_one_block  0.0011818408966064453
generate_one_block  0.0015208721160888672
generate_one_block  0.0012712478637695312
generate_one_block  0.0010874271392822266
generate_one_block  0.0011925697326660156
generate_one_block  0.0011496543884277344
generate_one_block  0.0010607242584228516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011577606201171875
gen group dst list time:  0.00010180473327636719
time for parepare:  0.0007658004760742188
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0002586841583251953
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.0008549690246582031
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  0.000133514404296875
r_  generation:  0.0009734630584716797
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.0002346038818359375
mini_batch_src_global generation:  0.00028252601623535156
r_  generation:  0.0025849342346191406
local_output_nid generation:  6.842613220214844e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.0002391338348388672
r_  generation:  0.0017516613006591797
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0005600452423095703
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0008542537689208984
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  8.177757263183594e-05
r_  generation:  0.0006022453308105469
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0005168914794921875
----------------------check_connections_block total spend ----------------------------- 0.014744043350219727
generate_one_block  0.002426624298095703
generate_one_block  0.002202272415161133
generate_one_block  0.004120349884033203
generate_one_block  0.0031900405883789062
generate_one_block  0.0015795230865478516
generate_one_block  0.0019237995147705078
generate_one_block  0.0016512870788574219
generate_one_block  0.0015635490417480469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019521713256835938
gen group dst list time:  0.00026726722717285156
time for parepare:  0.0013797283172607422
local_output_nid generation:  0.00012493133544921875
local_in_edges_tensor generation:  0.0006079673767089844
mini_batch_src_global generation:  0.0004744529724121094
r_  generation:  0.004732847213745117
local_output_nid generation:  0.00015354156494140625
local_in_edges_tensor generation:  0.00039458274841308594
mini_batch_src_global generation:  0.0006902217864990234
r_  generation:  0.005661725997924805
local_output_nid generation:  0.00028443336486816406
local_in_edges_tensor generation:  0.0006625652313232422
mini_batch_src_global generation:  0.0010652542114257812
r_  generation:  0.011237382888793945
local_output_nid generation:  0.00015997886657714844
local_in_edges_tensor generation:  0.00039458274841308594
mini_batch_src_global generation:  0.0007374286651611328
r_  generation:  0.005864381790161133
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.0002732276916503906
mini_batch_src_global generation:  0.0004341602325439453
r_  generation:  0.003593921661376953
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.0003209114074707031
mini_batch_src_global generation:  0.00039839744567871094
r_  generation:  0.004058837890625
local_output_nid generation:  0.00010609626770019531
local_in_edges_tensor generation:  0.0002586841583251953
mini_batch_src_global generation:  0.0003185272216796875
r_  generation:  0.002873659133911133
local_output_nid generation:  0.00011277198791503906
local_in_edges_tensor generation:  0.00027632713317871094
mini_batch_src_global generation:  0.0003581047058105469
r_  generation:  0.0036826133728027344
----------------------check_connections_block total spend ----------------------------- 0.06224370002746582
generate_one_block  0.007162809371948242
generate_one_block  0.008539676666259766
generate_one_block  0.014905929565429688
generate_one_block  0.008873462677001953
generate_one_block  0.006089687347412109
generate_one_block  0.00658726692199707
generate_one_block  0.004599332809448242
generate_one_block  0.005836963653564453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021648406982421875
gen group dst list time:  0.0010612010955810547
time for parepare:  0.0019001960754394531
local_output_nid generation:  0.0005414485931396484
local_in_edges_tensor generation:  0.001468658447265625
mini_batch_src_global generation:  0.0013840198516845703
r_  generation:  0.013565778732299805
local_output_nid generation:  0.0007119178771972656
local_in_edges_tensor generation:  0.0013248920440673828
mini_batch_src_global generation:  0.001636505126953125
r_  generation:  0.015964269638061523
local_output_nid generation:  0.0011014938354492188
local_in_edges_tensor generation:  0.0016262531280517578
mini_batch_src_global generation:  0.0018918514251708984
r_  generation:  0.021220922470092773
local_output_nid generation:  0.0006015300750732422
local_in_edges_tensor generation:  0.0008652210235595703
mini_batch_src_global generation:  0.0011742115020751953
r_  generation:  0.01187443733215332
local_output_nid generation:  0.0006060600280761719
local_in_edges_tensor generation:  0.0008771419525146484
mini_batch_src_global generation:  0.0008857250213623047
r_  generation:  0.011317253112792969
local_output_nid generation:  0.0006625652313232422
local_in_edges_tensor generation:  0.002246856689453125
mini_batch_src_global generation:  0.0009670257568359375
r_  generation:  0.012701988220214844
local_output_nid generation:  0.0005106925964355469
local_in_edges_tensor generation:  0.0007987022399902344
mini_batch_src_global generation:  0.0009851455688476562
r_  generation:  0.011186361312866211
local_output_nid generation:  0.0005238056182861328
local_in_edges_tensor generation:  0.0008211135864257812
mini_batch_src_global generation:  0.00093841552734375
r_  generation:  0.012546062469482422
----------------------check_connections_block total spend ----------------------------- 0.16295194625854492
generate_one_block  0.018239736557006836
generate_one_block  0.022225618362426758
generate_one_block  0.027318716049194336
generate_one_block  0.016307830810546875
generate_one_block  0.015309333801269531
generate_one_block  0.01705646514892578
generate_one_block  0.015160799026489258
generate_one_block  0.017187118530273438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.027503013610839844  GigaBytes
Max Memory Allocated: 0.05734539031982422  GigaBytes

connection checking time:  0.24337244033813477
block generation total time  0.23973846435546875
average batch blocks generation time:  0.029967308044433594
block dataloader generation time/epoch 0.5266361236572266
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.028467178344726562  GigaBytes
Max Memory Allocated: 0.05734539031982422  GigaBytes

torch.Size([13193, 500])
torch.Size([6268, 128])
torch.Size([1665, 128])
torch.Size([312, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.04290437698364258  GigaBytes
Max Memory Allocated: 0.05734539031982422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.03122854232788086  GigaBytes
Max Memory Allocated: 0.05734539031982422  GigaBytes

torch.Size([14634, 500])
torch.Size([8026, 128])
torch.Size([1929, 128])
torch.Size([347, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.048990726470947266  GigaBytes
Max Memory Allocated: 0.05734539031982422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.035605430603027344  GigaBytes
Max Memory Allocated: 0.061987876892089844  GigaBytes

torch.Size([16816, 500])
torch.Size([12613, 128])
torch.Size([3819, 128])
torch.Size([878, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4041748046875 GB
    Memory Allocated: 0.06623506546020508  GigaBytes
Max Memory Allocated: 0.06646537780761719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.02358388900756836  GigaBytes
Max Memory Allocated: 0.06898307800292969  GigaBytes

torch.Size([10558, 500])
torch.Size([5526, 128])
torch.Size([1793, 128])
torch.Size([424, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.037303924560546875  GigaBytes
Max Memory Allocated: 0.06898307800292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.023336410522460938  GigaBytes
Max Memory Allocated: 0.06898307800292969  GigaBytes

torch.Size([10337, 500])
torch.Size([5403, 128])
torch.Size([922, 128])
torch.Size([212, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.03451824188232422  GigaBytes
Max Memory Allocated: 0.06898307800292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.02727985382080078  GigaBytes
Max Memory Allocated: 0.06898307800292969  GigaBytes

torch.Size([12377, 500])
torch.Size([6312, 128])
torch.Size([1414, 128])
torch.Size([341, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.041185855865478516  GigaBytes
Max Memory Allocated: 0.06898307800292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.025101184844970703  GigaBytes
Max Memory Allocated: 0.06898307800292969  GigaBytes

torch.Size([11454, 500])
torch.Size([4893, 128])
torch.Size([1045, 128])
torch.Size([222, 128])Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.0357513427734375  GigaBytes
Max Memory Allocated: 0.06898307800292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.025762081146240234  GigaBytes
Max Memory Allocated: 0.06898307800292969  GigaBytes

torch.Size([11774, 500])
torch.Size([5076, 128])
torch.Size([1141, 128])
torch.Size([163, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.0367894172668457  GigaBytes
Max Memory Allocated: 0.06898307800292969  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007125914096832275 |0.0012336671352386475 |0.0068489909172058105 |0.00014066696166992188 |0.005022019147872925 |0.0021398067474365234 |
----------------------------------------------------------pseudo_mini_loss sum 1.830286979675293
Total (block generation + training)time/epoch 0.7037296295166016
Training time/epoch 0.17684507369995117
Training time without block to device /epoch 0.166975736618042
Training time without total dataloading part /epoch 0.09823322296142578
load block tensor time/epoch 0.0570073127746582
block to device time/epoch 0.00986933708190918
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  172244
Number of first layer input nodes during this epoch:  101143
