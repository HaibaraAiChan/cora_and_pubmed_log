main start at this time 1648532106.8567169
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.002213001251220703
range selection method range initialization spend 0.00011682510375976562
time for parepare:  4.458427429199219e-05
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.001191854476928711
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  6.389617919921875e-05
----------------------check_connections_block total spend ----------------------------- 0.0018608570098876953
generate_one_block  0.0021762847900390625
generate_one_block  0.0011954307556152344
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011603832244873047
gen group dst list time:  2.5033950805664062e-05
time for parepare:  0.0002372264862060547
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00045013427734375
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  0.00011968612670898438
r_  generation:  0.0007624626159667969
----------------------check_connections_block total spend ----------------------------- 0.002360105514526367
generate_one_block  0.0016512870788574219
generate_one_block  0.002111673355102539
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010242462158203125
gen group dst list time:  6.389617919921875e-05
time for parepare:  0.0007090568542480469
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.0003390312194824219
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.0027039051055908203
local_output_nid generation:  0.00011992454528808594
local_in_edges_tensor generation:  0.0003287792205810547
mini_batch_src_global generation:  0.0005891323089599609
r_  generation:  0.004858732223510742
----------------------check_connections_block total spend ----------------------------- 0.011970281600952148
generate_one_block  0.00477290153503418
generate_one_block  0.0067806243896484375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021233558654785156
gen group dst list time:  0.00018310546875
time for parepare:  0.00131988525390625
local_output_nid generation:  0.0003116130828857422
local_in_edges_tensor generation:  0.0009853839874267578
mini_batch_src_global generation:  0.0011627674102783203
r_  generation:  0.011943340301513672
local_output_nid generation:  0.0004057884216308594
local_in_edges_tensor generation:  0.0008940696716308594
mini_batch_src_global generation:  0.0015368461608886719
r_  generation:  0.014465093612670898
----------------------check_connections_block total spend ----------------------------- 0.03973793983459473
generate_one_block  0.0168304443359375
generate_one_block  0.02030777931213379
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018353462219238281
gen group dst list time:  0.0005128383636474609
time for parepare:  0.0015039443969726562
local_output_nid generation:  0.0009176731109619141
local_in_edges_tensor generation:  0.0020034313201904297
mini_batch_src_global generation:  0.0019545555114746094
r_  generation:  0.022356510162353516
local_output_nid generation:  0.0016088485717773438
local_in_edges_tensor generation:  0.002530813217163086
mini_batch_src_global generation:  0.00278472900390625
r_  generation:  0.024233102798461914
----------------------check_connections_block total spend ----------------------------- 0.0707550048828125
generate_one_block  0.029471158981323242
generate_one_block  0.030307531356811523
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  0.12482333183288574
block generation total time  0.11223340034484863
average batch blocks generation time:  0.056116700172424316
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03497171401977539  GigaBytes
Max Memory Allocated: 0.03497171401977539  GigaBytes

torch.Size([17644, 500])
torch.Size([12847, 128])
torch.Size([4771, 128])
torch.Size([1005, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.06798410415649414  GigaBytes
Max Memory Allocated: 0.06824636459350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.03597259521484375  GigaBytes
Max Memory Allocated: 0.07096004486083984  GigaBytes

torch.Size([17753, 500])
torch.Size([14658, 128])
torch.Size([5656, 128])
torch.Size([1740, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.07545614242553711  GigaBytes
Max Memory Allocated: 0.07587528228759766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023790955543518066 |0.17149269580841064 |0.38509082794189453 |0.0001761913299560547 |0.008775711059570312 |0.002980470657348633 |
----------------------------------------------------------pseudo_mini_loss sum 2.1831774711608887
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  76430
Number of first layer input nodes during this epoch:  35397
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.04003095626831055  GigaBytes
Max Memory Allocated: 0.0771017074584961  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004551410675048828
range selection method range initialization spend 5.1975250244140625e-05
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  7.653236389160156e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.792213439941406e-05
----------------------check_connections_block total spend ----------------------------- 0.0006272792816162109
generate_one_block  0.0012156963348388672
generate_one_block  0.0010190010070800781
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004870891571044922
gen group dst list time:  2.4557113647460938e-05
time for parepare:  0.0002505779266357422
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0006840229034423828
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation: Using backend: pytorch
 8.869171142578125e-05
r_  generation:  0.0005488395690917969
----------------------check_connections_block total spend ----------------------------- 0.002440929412841797
generate_one_block  0.0019392967224121094
generate_one_block  0.0018131732940673828
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009915828704833984
gen group dst list time:  7.462501525878906e-05
time for parepare:  0.0007367134094238281
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.00044608116149902344
mini_batch_src_global generation:  0.0004620552062988281
r_  generation:  0.004404306411743164
local_output_nid generation:  9.512901306152344e-05
local_in_edges_tensor generation:  0.00026154518127441406
mini_batch_src_global generation:  0.00040984153747558594
r_  generation:  0.0035376548767089844
----------------------check_connections_block total spend ----------------------------- 0.01240992546081543
generate_one_block  0.0069506168365478516
generate_one_block  0.005415439605712891
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019712448120117188
gen group dst list time:  0.00018358230590820312
time for parepare:  0.0012421607971191406
local_output_nid generation:  0.0003960132598876953
local_in_edges_tensor generation:  0.0012052059173583984
mini_batch_src_global generation:  0.0012738704681396484
r_  generation:  0.014955759048461914
local_output_nid generation:  0.0003757476806640625
local_in_edges_tensor generation:  0.0007314682006835938
mini_batch_src_global generation:  0.0012729167938232422
r_  generation:  0.01202845573425293
----------------------check_connections_block total spend ----------------------------- 0.04025077819824219
generate_one_block  0.021005630493164062
generate_one_block  0.01664590835571289
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017769336700439453
gen group dst list time:  0.0004718303680419922
time for parepare:  0.0014946460723876953
local_output_nid generation:  0.0009527206420898438
local_in_edges_tensor generation:  0.001956939697265625
mini_batch_src_global generation:  0.0019164085388183594
r_  generation:  0.02343463897705078
local_output_nid generation:  0.0009860992431640625
local_in_edges_tensor generation:  0.001962900161743164
mini_batch_src_global generation:  0.0022754669189453125
r_  generation:  0.020461320877075195
----------------------check_connections_block total spend ----------------------------- 0.06535625457763672
generate_one_block  0.029463529586791992
generate_one_block  0.02771306037902832
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.04003095626831055  GigaBytes
Max Memory Allocated: 0.0771017074584961  GigaBytes

connection checking time:  0.12045788764953613
block generation total time  0.1109466552734375
average batch blocks generation time:  0.05547332763671875
block dataloader generation time/epoch 0.2651195526123047
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.038299560546875  GigaBytes
Max Memory Allocated: 0.0771017074584961  GigaBytes

torch.Size([18155, 500])
torch.Size([15030, 128])
torch.Size([6285, 128])
torch.Size([1604, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.07927513122558594  GigaBytes
Max Memory Allocated: 0.07957983016967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03609418869018555  GigaBytes
Max Memory Allocated: 0.08214187622070312  GigaBytes

torch.Size([17044, 500])
torch.Size([12627, 128])
torch.Size([4501, 128])
torch.Size([1189, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06856393814086914  GigaBytes
Max Memory Allocated: 0.08214187622070312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013244271278381348 |0.0014988183975219727 |0.006259799003601074 |0.00012803077697753906 |0.004932284355163574 |0.0032608509063720703 |
----------------------------------------------------------pseudo_mini_loss sum 1.5434812307357788
Total (block generation + training)time/epoch 0.32375621795654297
Training time/epoch 0.05834460258483887
Training time without block to device /epoch 0.05534696578979492
Training time without total dataloading part /epoch 0.025901079177856445
load block tensor time/epoch 0.026488542556762695
block to device time/epoch 0.0029976367950439453
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  76791
Number of first layer input nodes during this epoch:  35199
