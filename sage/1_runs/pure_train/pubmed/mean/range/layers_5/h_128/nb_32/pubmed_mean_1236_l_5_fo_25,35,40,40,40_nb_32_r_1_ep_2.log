main start at this time 1648532139.8294291
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0031850337982177734
range selection method range initialization spend 0.0001010894775390625
time for parepare:  4.458427429199219e-05
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0013773441314697266
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.58306884765625e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.2636184692382812e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.630752563476562e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.630752563476562e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.440017700195312e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.1682510375976562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.002716064453125e-05
----------------------check_connections_block total spend ----------------------------- 0.004007577896118164
generate_one_block  0.0011782646179199219
generate_one_block  0.0010001659393310547
generate_one_block  0.0010139942169189453
generate_one_block  0.0010008811950683594
generate_one_block  0.0009400844573974609
generate_one_block  0.0009465217590332031
generate_one_block  0.0010251998901367188
generate_one_block  0.0009751319885253906
generate_one_block  0.0009407997131347656
generate_one_block  0.0009465217590332031
generate_one_block  0.0009860992431640625
generate_one_block  0.0009655952453613281
generate_one_block  0.0009348392486572266
generate_one_block  0.0009789466857910156
generate_one_block  0.0009856224060058594
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0018181800842285156
gen group dst list time:  7.2479248046875e-05
time for parepare:  0.00024008750915527344
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.937980651855469e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00010180473327636719
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.723403930664062e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  0.00010442733764648438
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.340576171875e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  6.985664367675781e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  8.58306884765625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0001285076141357422
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  6.937980651855469e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00018215179443359375
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.00012993812561035156
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00017786026000976562
----------------------check_connections_block total spend ----------------------------- 0.004343509674072266
generate_one_block  0.0010921955108642578
generate_one_block  0.0010647773742675781
generate_one_block  0.0010237693786621094
generate_one_block  0.0010924339294433594
generate_one_block  0.0010356903076171875
generate_one_block  0.0010175704956054688
generate_one_block  0.0010347366333007812
generate_one_block  0.0011327266693115234
generate_one_block  0.0012066364288330078
generate_one_block  0.0010216236114501953
generate_one_block  0.0010383129119873047
generate_one_block  0.0011899471282958984
generate_one_block  0.0009741783142089844
generate_one_block  0.0011510848999023438
generate_one_block  0.0011687278747558594
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011358261108398438
gen group dst list time:  0.00011181831359863281
time for parepare:  0.0007231235504150391
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0002651214599609375
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0004773139953613281
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.00038743019104003906
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0002727508544921875
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0006380081176757812
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.0001919269561767578
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  9.036064147949219e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0005772113800048828
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.0006129741668701172
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0008671283721923828
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0003604888916015625
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.0003895759582519531
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  0.00014495849609375
r_  generation:  0.0015475749969482422
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.00018978118896484375
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.0009062290191650391
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  0.00013685226440429688
r_  generation:  0.0012936592102050781
----------------------check_connections_block total spend ----------------------------- 0.015590906143188477
generate_one_block  0.0016474723815917969
generate_one_block  0.0013885498046875
generate_one_block  0.0012731552124023438
generate_one_block  0.001859903335571289
generate_one_block  0.0012009143829345703
generate_one_block  0.0010302066802978516
generate_one_block  0.0016512870788574219
generate_one_block  0.001669168472290039
generate_one_block  0.0019888877868652344
generate_one_block  0.0014355182647705078
generate_one_block  0.0013606548309326172
generate_one_block  0.002761363983154297
generate_one_block  0.0014345645904541016
generate_one_block  0.0020492076873779297
generate_one_block  0.0025653839111328125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002070903778076172
gen group dst list time:  0.0003299713134765625
time for parepare:  0.0015430450439453125
local_output_nid generation:  6.222724914550781e-05
local_in_edges_tensor generation:  0.0005011558532714844
mini_batch_src_global generation:  0.0003292560577392578
r_  generation:  0.0027246475219726562
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  0.00030303001403808594
r_  generation:  0.002191781997680664
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.0019447803497314453
local_output_nid generation:  0.00012159347534179688
local_in_edges_tensor generation:  0.0003275871276855469
mini_batch_src_global generation:  0.00036835670471191406
r_  generation:  0.0038917064666748047
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  0.00015115737915039062
r_  generation:  0.0007534027099609375
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0004515647888183594
local_output_nid generation:  0.00010776519775390625
local_in_edges_tensor generation:  0.00030159950256347656
mini_batch_src_global generation:  0.00029587745666503906
r_  generation:  0.003936052322387695
local_output_nid generation:  9.5367431640625e-05
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  0.0003497600555419922
r_  generation:  0.0032396316528320312
local_output_nid generation:  0.00012755393981933594
local_in_edges_tensor generation:  0.00033593177795410156
mini_batch_src_global generation:  0.0005705356597900391
r_  generation:  0.005582571029663086
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  0.0003039836883544922
r_  generation:  0.0022284984588623047
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00019240379333496094
r_  generation:  0.0018815994262695312
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.00038361549377441406
mini_batch_src_global generation:  0.000522613525390625
r_  generation:  0.006278276443481445
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  0.00027823448181152344
r_  generation:  0.001476287841796875
local_output_nid generation:  0.00016999244689941406
local_in_edges_tensor generation:  0.000347137451171875
mini_batch_src_global generation:  0.0004565715789794922
r_  generation:  0.005138397216796875
local_output_nid generation:  0.00014853477478027344
local_in_edges_tensor generation:  0.00035858154296875
mini_batch_src_global generation:  0.0005896091461181641
r_  generation:  0.005700588226318359
----------------------check_connections_block total spend ----------------------------- 0.0715799331665039
generate_one_block  0.005610466003417969
generate_one_block  0.003949403762817383
generate_one_block  0.0035469532012939453
generate_one_block  0.005814313888549805
generate_one_block  0.0018157958984375
generate_one_block  0.0014369487762451172
generate_one_block  0.006022453308105469
generate_one_block  0.005265951156616211
generate_one_block  0.00925755500793457
generate_one_block  0.0035333633422851562
generate_one_block  0.0032498836517333984
generate_one_block  0.009472846984863281
generate_one_block  0.002826213836669922
generate_one_block  0.008041143417358398
generate_one_block  0.009092330932617188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002311229705810547
gen group dst list time:  0.0015788078308105469
time for parepare:  0.0017330646514892578
local_output_nid generation:  0.00031638145446777344
local_in_edges_tensor generation:  0.001115560531616211
mini_batch_src_global generation:  0.0009889602661132812
r_  generation:  0.008488178253173828
local_output_nid generation:  0.0003647804260253906
local_in_edges_tensor generation:  0.0007045269012451172
mini_batch_src_global generation:  0.0008916854858398438
r_  generation:  0.007812023162841797
local_output_nid generation:  0.0003199577331542969
local_in_edges_tensor generation:  0.0006198883056640625
mini_batch_src_global generation:  0.0007598400115966797
r_  generation:  0.008108854293823242
local_output_nid generation:  0.0004341602325439453
local_in_edges_tensor generation:  0.0010535717010498047
mini_batch_src_global generation:  0.00128173828125
r_  generation:  0.011565923690795898
local_output_nid generation:  0.00014495849609375
local_in_edges_tensor generation:  0.0003032684326171875
mini_batch_src_global generation:  0.00045490264892578125
r_  generation:  0.003203153610229492
local_output_nid generation:  7.534027099609375e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  0.00022339820861816406
r_  generation:  0.0018117427825927734
local_output_nid generation:  0.0004181861877441406
local_in_edges_tensor generation:  0.0007524490356445312
mini_batch_src_global generation:  0.0007665157318115234
r_  generation:  0.01174306869506836
local_output_nid generation:  0.00048470497131347656
local_in_edges_tensor generation:  0.0009963512420654297
mini_batch_src_global generation:  0.0013196468353271484
r_  generation:  0.011570215225219727
local_output_nid generation:  0.0007960796356201172
local_in_edges_tensor generation:  0.0014100074768066406
mini_batch_src_global generation:  0.0013823509216308594
r_  generation:  0.015608549118041992
local_output_nid generation:  0.0003254413604736328
local_in_edges_tensor generation:  0.0005404949188232422
mini_batch_src_global generation:  0.0008614063262939453
r_  generation:  0.00799417495727539
local_output_nid generation:  0.000324249267578125
local_in_edges_tensor generation:  0.0005066394805908203
mini_batch_src_global generation:  0.0006761550903320312
r_  generation:  0.007157087326049805
local_output_nid generation:  0.0005884170532226562
local_in_edges_tensor generation:  0.0008907318115234375
mini_batch_src_global generation:  0.001153707504272461
r_  generation:  0.013722419738769531
local_output_nid generation:  0.00032401084899902344
local_in_edges_tensor generation:  0.0005061626434326172
mini_batch_src_global generation:  0.0008544921875
r_  generation:  0.007314443588256836
local_output_nid generation:  0.00060272216796875
local_in_edges_tensor generation:  0.0009605884552001953
mini_batch_src_global generation:  0.001100778579711914
r_  generation:  0.014209985733032227
local_output_nid generation:  0.0005209445953369141
local_in_edges_tensor generation:  0.001157522201538086
mini_batch_src_global generation:  0.0014328956604003906
r_  generation:  0.013147354125976562
----------------------check_connections_block total spend ----------------------------- 0.21224761009216309
generate_one_block  0.012353658676147461
generate_one_block  0.011111736297607422
generate_one_block  0.012341737747192383
generate_one_block  0.015641212463378906
generate_one_block  0.004791975021362305
generate_one_block  0.004281520843505859
generate_one_block  0.01630997657775879
generate_one_block  0.015850305557250977
generate_one_block  0.020740270614624023
generate_one_block  0.011685848236083984
generate_one_block  0.01008296012878418
generate_one_block  0.017783164978027344
generate_one_block  0.01103663444519043
generate_one_block  0.01956772804260254
generate_one_block  0.01766204833984375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  0.30376195907592773
block generation total time  0.32173705101013184
average batch blocks generation time:  0.02144913673400879
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.016794681549072266  GigaBytes
Max Memory Allocated: 0.016794681549072266  GigaBytes

torch.Size([8078, 500])
torch.Size([3592, 128])
torch.Size([773, 128])
torch.Size([146, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.024611473083496094  GigaBytes
Max Memory Allocated: 0.02603769302368164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.019102096557617188  GigaBytes
Max Memory Allocated: 0.03446149826049805  GigaBytes

torch.Size([9196, 500])
torch.Size([4345, 128])
torch.Size([645, 128])
torch.Size([189, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.028202056884765625  GigaBytes
Max Memory Allocated: 0.03446149826049805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.018269062042236328  GigaBytes
Max Memory Allocated: 0.03511810302734375  GigaBytes

torch.Size([8741, 500])
torch.Size([3807, 128])
torch.Size([565, 128])
torch.Size([129, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.026511669158935547  GigaBytes
Max Memory Allocated: 0.03511810302734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.027515411376953125  GigaBytes
Max Memory Allocated: 0.043379783630371094  GigaBytes

torch.Size([13371, 500])
torch.Size([5588, 128])
torch.Size([1575, 128])
torch.Size([186, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.04032611846923828  GigaBytes
Max Memory Allocated: 0.043379783630371094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.01064300537109375  GigaBytes
Max Memory Allocated: 0.043379783630371094  GigaBytes

torch.Size([4745, 500])
torch.Size([1522, 128])
torch.Size([264, 128])
torch.Size([101, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.013881206512451172  GigaBytes
Max Memory Allocated: 0.043379783630371094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.006908416748046875  GigaBytes
Max Memory Allocated: 0.043379783630371094  GigaBytes

torch.Size([2761, 500])
torch.Size([729, 128])
torch.Size([169, 128])
torch.Size([47, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.008580207824707031  GigaBytes
Max Memory Allocated: 0.043379783630371094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.02362966537475586  GigaBytes
Max Memory Allocated: 0.043379783630371094  GigaBytes

torch.Size([11534, 500])
torch.Size([4866, 128])
torch.Size([1291, 128])
torch.Size([138, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.03545427322387695  GigaBytes
Max Memory Allocated: 0.043379783630371094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.024037837982177734  GigaBytes
Max Memory Allocated: 0.04512453079223633  GigaBytes

torch.Size([11775, 500])
torch.Size([5320, 128])
torch.Size([1125, 128])
torch.Size([221, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.035508155822753906  GigaBytes
Max Memory Allocated: 0.04512453079223633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.02820587158203125  GigaBytes
Max Memory Allocated: 0.04956340789794922  GigaBytes

torch.Size([13917, 500])
torch.Size([8815, 128])
torch.Size([1617, 128])
torch.Size([350, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.047702789306640625  GigaBytes
Max Memory Allocated: 0.04956340789794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.01956462860107422  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

torch.Size([9213, 500])
torch.Size([3402, 128])
torch.Size([662, 128])
torch.Size([119, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.026778697967529297  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.019828319549560547  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

torch.Size([9598, 500])
torch.Size([3339, 128])
torch.Size([709, 128])
torch.Size([158, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.027157306671142578  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.024071693420410156  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

torch.Size([11696, 500])
torch.Size([7048, 128])
torch.Size([1736, 128])
torch.Size([389, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.04001569747924805  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.01952648162841797  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

torch.Size([8948, 500])
torch.Size([3117, 128])
torch.Size([369, 128])
torch.Size([65, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.025531291961669922  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.02788257598876953  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

torch.Size([13765, 500])
torch.Size([6941, 128])
torch.Size([1763, 128])
torch.Size([310, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.04352903366088867  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.02392721176147461  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

torch.Size([11643, 500])
torch.Size([6316, 128])
torch.Size([1783, 128])
torch.Size([391, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.038796424865722656  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0070037047068278 |0.023164955774943034 |0.05706330935160319 |0.00012992223103841145 |0.004854901631673177 |0.003509521484375 |
----------------------------------------------------------pseudo_mini_loss sum 2.2762672901153564
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  236070
Number of first layer input nodes during this epoch:  148981
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.02680206298828125  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004818439483642578
range selection method range initialization spend 5.269050598144531e-05
time for parepare:  4.673004150390625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.559226989746094e-05
mini_batch_src_global generation:  1.2636184692382812e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.511543273925781e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.487701416015625e-05
mini_batch_src_global generation:  1.239776611328125e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.559226989746094e-05
mini_batch_src_global generation:  1.239776611328125e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.58306884765625e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.416175842285156e-05
mini_batch_src_global generation:  1.239776611328125e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.239776611328125e-05
r_  generation:  1.4781951904296875e-05
----------------------check_connections_block total spend ----------------------------- 0.0026073455810546875
generate_one_block  0.0012047290802001953
generate_one_block  0.0012171268463134766
generate_one_block  0.0009529590606689453
generate_one_block  0.0009469985961914062
generate_one_block  0.0009987354278564453
generate_one_block  0.0009882450103759766
generate_one_block  0.0009746551513671875
generate_one_block  0.0009503364562988281
generate_one_block  0.0009520053863525391
generate_one_block  0.0009465217590332031
generate_one_block  0.0009410381317138672
generate_one_block  0.0009448528289794922
generate_one_block  0.0009570121765136719
generate_one_block  0.0009531974792480469
generate_one_block  0.0009467601776123047
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006268024444580078
gen group dst list time:  7.796287536621094e-05
time for parepare:  0.0002665519714355469
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00010728836059570312
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.367134094238281e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  6.937980651855469e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.771087646484375e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0002503395080566406
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00011897087097167969
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.9604644775390625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00015687942504882812
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  6.341934204101562e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.7206878662109375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  8.487701416015625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  9.465217590332031e-05
----------------------check_connections_block total spend ----------------------------- 0.0044629573822021484
generate_one_block  0.0011315345764160156
generate_one_block  0.0010175704956054688
generate_one_block  0.001028299331665039
generate_one_block  0.0010786056518554688
generate_one_block  0.0013251304626464844
generate_one_block  0.0010995864868164062
generate_one_block  0.0010082721710205078
generate_one_block  0.0011930465698242188
generate_one_block  0.0010154247283935547
generate_one_block  0.0010263919830322266
generate_one_block  0.0010936260223388672
generate_one_block  0.001051187515258789
generate_one_block  0.001062154769897461
generate_one_block  0.0010955333709716797
generate_one_block  0.0010256767272949219
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011646747589111328
gen group dst list time:  0.00012230873107910156
time for parepare:  0.0007448196411132812
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0002727508544921875
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0006208419799804688
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00026226043701171875
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004260540008544922
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0005483627319335938
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.0002655982971191406
r_  generation:  0.0018875598907470703
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.0007891654968261719
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0002741813659667969
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  0.00014591217041015625
r_  generation:  0.0014193058013916016
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.00023317337036132812
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00029778480529785156
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00045228004455566406
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0004203319549560547
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0001747608184814453
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0004425048828125
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004951953887939453
----------------------check_connections_block total spend ----------------------------- 0.015831470489501953
generate_one_block  0.0020172595977783203
generate_one_block  0.0012650489807128906
generate_one_block  0.0028069019317626953
generate_one_block  0.0016808509826660156
generate_one_block  0.0033054351806640625
generate_one_block  0.0018880367279052734
generate_one_block  0.0012423992156982422
generate_one_block  0.002736806869506836
generate_one_block  0.0012192726135253906
generate_one_block  0.0014379024505615234
generate_one_block  0.0014843940734863281
generate_one_block  0.0014269351959228516
generate_one_block  0.0011477470397949219
generate_one_block  0.0014884471893310547
generate_one_block  0.0015683174133300781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002151012420654297
gen group dst list time:  0.00030922889709472656
time for parepare:  0.0015230178833007812
local_output_nid generation:  0.00010156631469726562
local_in_edges_tensor generation:  0.0005433559417724609
mini_batch_src_global generation:  0.00035452842712402344
r_  generation:  0.0034029483795166016
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  0.0002028942108154297
r_  generation:  0.0012226104736328125
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.00022673606872558594
mini_batch_src_global generation:  0.00023865699768066406
r_  generation:  0.0026755332946777344
local_output_nid generation:  0.00011754035949707031
local_in_edges_tensor generation:  0.0003116130828857422
mini_batch_src_global generation:  0.00038170814514160156
r_  generation:  0.0036230087280273438
local_output_nid generation:  0.0002155303955078125
local_in_edges_tensor generation:  0.0005099773406982422
mini_batch_src_global generation:  0.000804901123046875
r_  generation:  0.007242918014526367
local_output_nid generation:  0.00012636184692382812
local_in_edges_tensor generation:  0.0003306865692138672
mini_batch_src_global generation:  0.0005772113800048828
r_  generation:  0.0047872066497802734
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  0.00024390220642089844
r_  generation:  0.0014123916625976562
local_output_nid generation:  0.00012683868408203125
local_in_edges_tensor generation:  0.000324249267578125
mini_batch_src_global generation:  0.00041484832763671875
r_  generation:  0.004851579666137695
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  0.0002994537353515625
r_  generation:  0.0019197463989257812
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.00021409988403320312
r_  generation:  0.0019288063049316406
local_output_nid generation:  7.414817810058594e-05
local_in_edges_tensor generation:  0.00029468536376953125
mini_batch_src_global generation:  0.0002770423889160156
r_  generation:  0.0026607513427734375
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  0.0002315044403076172
r_  generation:  0.0019996166229248047
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  0.0001513957977294922
r_  generation:  0.001049041748046875
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.00019288063049316406
r_  generation:  0.0021495819091796875
local_output_nid generation:  0.00010609626770019531
local_in_edges_tensor generation:  0.0002779960632324219
mini_batch_src_global generation:  0.00034546852111816406
r_  generation:  0.0037245750427246094
----------------------check_connections_block total spend ----------------------------- 0.06816458702087402
generate_one_block  0.0060002803802490234
generate_one_block  0.002699613571166992
generate_one_block  0.005859851837158203
generate_one_block  0.00564122200012207
generate_one_block  0.010978460311889648
generate_one_block  0.007631540298461914
generate_one_block  0.0026497840881347656
generate_one_block  0.00826406478881836
generate_one_block  0.003436565399169922
generate_one_block  0.0035605430603027344
generate_one_block  0.004569292068481445
generate_one_block  0.003492116928100586
generate_one_block  0.002312183380126953
generate_one_block  0.0036630630493164062
generate_one_block  0.006230354309082031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022881031036376953
gen group dst list time:  0.0014553070068359375
time for parepare:  0.0019834041595458984
local_output_nid generation:  0.00042057037353515625
local_in_edges_tensor generation:  0.0012154579162597656
mini_batch_src_global generation:  0.0011892318725585938
r_  generation:  0.011329174041748047
local_output_nid generation:  0.00021266937255859375
local_in_edges_tensor generation:  0.00046324729919433594
mini_batch_src_global generation:  0.00069427490234375
r_  generation:  0.005017280578613281
local_output_nid generation:  0.0004658699035644531
local_in_edges_tensor generation:  0.0008220672607421875
mini_batch_src_global generation:  0.0008883476257324219
r_  generation:  0.011625051498413086
local_output_nid generation:  0.00047969818115234375
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.0010297298431396484
r_  generation:  0.01149439811706543
local_output_nid generation:  0.0007340908050537109
local_in_edges_tensor generation:  0.0013172626495361328
mini_batch_src_global generation:  0.0014927387237548828
r_  generation:  0.016194820404052734
local_output_nid generation:  0.0008242130279541016
local_in_edges_tensor generation:  0.0011970996856689453
mini_batch_src_global generation:  0.0015158653259277344
r_  generation:  0.015167236328125
local_output_nid generation:  0.00022673606872558594
local_in_edges_tensor generation:  0.0004355907440185547
mini_batch_src_global generation:  0.0007107257843017578
r_  generation:  0.005777597427368164
local_output_nid generation:  0.0004343986511230469
local_in_edges_tensor generation:  0.0007755756378173828
mini_batch_src_global generation:  0.0010192394256591797
r_  generation:  0.00972437858581543
local_output_nid generation:  0.0002682209014892578
local_in_edges_tensor generation:  0.00048613548278808594
mini_batch_src_global generation:  0.0006933212280273438
r_  generation:  0.006398200988769531
local_output_nid generation:  0.00040721893310546875
local_in_edges_tensor generation:  0.0006000995635986328
mini_batch_src_global generation:  0.0007154941558837891
r_  generation:  0.009085655212402344
local_output_nid generation:  0.0005295276641845703
local_in_edges_tensor generation:  0.0007739067077636719
mini_batch_src_global generation:  0.0009582042694091797
r_  generation:  0.01049494743347168
local_output_nid generation:  0.0003464221954345703
local_in_edges_tensor generation:  0.0005338191986083984
mini_batch_src_global generation:  0.0007264614105224609
r_  generation:  0.00681304931640625
local_output_nid generation:  0.00025963783264160156
local_in_edges_tensor generation:  0.00040984153747558594
mini_batch_src_global generation:  0.0004818439483642578
r_  generation:  0.004662752151489258
local_output_nid generation:  0.00035071372985839844
local_in_edges_tensor generation:  0.0005404949188232422
mini_batch_src_global generation:  0.0006902217864990234
r_  generation:  0.007858991622924805
local_output_nid generation:  0.00046539306640625
local_in_edges_tensor generation:  0.0008265972137451172
mini_batch_src_global generation:  0.0012066364288330078
r_  generation:  0.012664794921875
----------------------check_connections_block total spend ----------------------------- 0.21214056015014648
generate_one_block  0.016078710556030273
generate_one_block  0.007417440414428711
generate_one_block  0.014832019805908203
generate_one_block  0.017435073852539062
generate_one_block  0.02289295196533203
generate_one_block  0.020017623901367188
generate_one_block  0.00889730453491211
generate_one_block  0.012745857238769531
generate_one_block  0.008984088897705078
generate_one_block  0.011748313903808594
generate_one_block  0.015241146087646484
generate_one_block  0.009694576263427734
generate_one_block  0.007064104080200195
generate_one_block  0.011806249618530273
generate_one_block  0.016164302825927734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.02680206298828125  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

connection checking time:  0.3005995750427246
block generation total time  0.32097649574279785
average batch blocks generation time:  0.02139843304951986
block dataloader generation time/epoch 0.6821017265319824
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.025133609771728516  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

torch.Size([11450, 500])
torch.Size([4723, 128])
torch.Size([1218, 128])
torch.Size([204, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.03587198257446289  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.015204906463623047  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

torch.Size([6249, 500])
torch.Size([2316, 128])
torch.Size([493, 128])
torch.Size([108, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.020277023315429688  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.024033546447753906  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

torch.Size([10885, 500])
torch.Size([5026, 128])
torch.Size([748, 128])
torch.Size([189, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.03576231002807617  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.02746105194091797  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

torch.Size([12703, 500])
torch.Size([5330, 128])
torch.Size([1372, 128])
torch.Size([159, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.03931617736816406  GigaBytes
Max Memory Allocated: 0.052285194396972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.031409263610839844  GigaBytes
Max Memory Allocated: 0.0544123649597168  GigaBytes

torch.Size([14208, 500])
torch.Size([8251, 128])
torch.Size([2663, 128])
torch.Size([560, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.052460670471191406  GigaBytes
Max Memory Allocated: 0.0544123649597168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.029486656188964844  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

torch.Size([13723, 500])
torch.Size([8357, 128])
torch.Size([1451, 128])
torch.Size([324, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.047330379486083984  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.016294479370117188  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

torch.Size([6814, 500])
torch.Size([2069, 128])
torch.Size([432, 128])
torch.Size([99, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.020834922790527344  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.019526958465576172  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

torch.Size([8422, 500])
torch.Size([4492, 128])
torch.Size([1448, 128])
torch.Size([334, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.030638694763183594  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.013195514678955078  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

torch.Size([5134, 500])
torch.Size([2567, 128])
torch.Size([420, 128])
torch.Size([75, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.01845264434814453  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.021254539489746094  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

torch.Size([9066, 500])
torch.Size([3831, 128])
torch.Size([548, 128])
torch.Size([138, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.029271602630615234  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.02394866943359375  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

torch.Size([10844, 500])
torch.Size([4900, 128])
torch.Size([761, 128])
torch.Size([197, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.03480958938598633  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.01926136016845703  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

torch.Size([8155, 500])
torch.Size([3186, 128])
torch.Size([752, 128])
torch.Size([147, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.026323318481445312  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.015065670013427734  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

torch.Size([6180, 500])
torch.Size([2303, 128])
torch.Size([325, 128])
torch.Size([86, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.019671916961669922  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.02191781997680664  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

torch.Size([9787, 500])
torch.Size([3368, 128])
torch.Size([801, 128])
torch.Size([139, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.029421329498291016  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.02555990219116211  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

torch.Size([11665, 500])
torch.Size([5165, 128])
torch.Size([1147, 128])
torch.Size([163, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.03695058822631836  GigaBytes
Max Memory Allocated: 0.05631208419799805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00551768938700358 |0.0008975982666015625 |0.0055785020192464195 |0.0001449902852376302 |0.005080302556355794 |0.0022957324981689453 |
----------------------------------------------------------pseudo_mini_loss sum 2.0117924213409424
Total (block generation + training)time/epoch 0.961216926574707
Training time/epoch 0.27861499786376953
Training time without block to device /epoch 0.2651510238647461
Training time without total dataloading part /epoch 0.1643526554107666
load block tensor time/epoch 0.08276534080505371
block to device time/epoch 0.013463973999023438
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  229027
Number of first layer input nodes during this epoch:  145285
