main start at this time 1648532117.4648848
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0018622875213623047
range selection method range initialization spend 0.00010395050048828125
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0014984607696533203
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.4809112548828125e-05
----------------------check_connections_block total spend ----------------------------- 0.002501249313354492
generate_one_block  0.0014278888702392578
generate_one_block  0.0010662078857421875
generate_one_block  0.0010628700256347656
generate_one_block  0.0010766983032226562
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011262893676757812
gen group dst list time:  3.314018249511719e-05
time for parepare:  0.0002338886260986328
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0002713203430175781
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.0001926422119140625
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.00041937828063964844
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0003859996795654297
----------------------check_connections_block total spend ----------------------------- 0.0027418136596679688
generate_one_block  0.0014317035675048828
generate_one_block  0.001275777816772461
generate_one_block  0.0016143321990966797
generate_one_block  0.0015544891357421875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001068115234375
gen group dst list time:  7.82012939453125e-05
time for parepare:  0.0007379055023193359
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.0003032684326171875
mini_batch_src_global generation:  0.00014591217041015625
r_  generation:  0.0016541481018066406
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  0.00017499923706054688
r_  generation:  0.001210927963256836
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.0002541542053222656
mini_batch_src_global generation:  0.0003037452697753906
r_  generation:  0.0030090808868408203
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.0002384185791015625
mini_batch_src_global generation:  0.0003161430358886719
r_  generation:  0.0027234554290771484
----------------------check_connections_block total spend ----------------------------- 0.01380157470703125
generate_one_block  0.003332376480102539
generate_one_block  0.0024869441986083984
generate_one_block  0.004739284515380859
generate_one_block  0.004326820373535156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002076387405395508
gen group dst list time:  0.0002574920654296875
time for parepare:  0.001524209976196289
local_output_nid generation:  0.00022172927856445312
local_in_edges_tensor generation:  0.0008194446563720703
mini_batch_src_global generation:  0.0010061264038085938
r_  generation:  0.00851297378540039
local_output_nid generation:  0.000194549560546875
local_in_edges_tensor generation:  0.000453948974609375
mini_batch_src_global generation:  0.0008652210235595703
r_  generation:  0.0064313411712646484
local_output_nid generation:  0.0002951622009277344
local_in_edges_tensor generation:  0.0006639957427978516
mini_batch_src_global generation:  0.0011391639709472656
r_  generation:  0.011274576187133789
local_output_nid generation:  0.0003230571746826172
local_in_edges_tensor generation:  0.0006222724914550781
mini_batch_src_global generation:  0.0009853839874267578
r_  generation:  0.010838747024536133
----------------------check_connections_block total spend ----------------------------- 0.055418968200683594
generate_one_block  0.012779951095581055
generate_one_block  0.009555339813232422
generate_one_block  0.015378236770629883
generate_one_block  0.015431880950927734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018150806427001953
gen group dst list time:  0.0007688999176025391
time for parepare:  0.0017464160919189453
local_output_nid generation:  0.0008273124694824219
local_in_edges_tensor generation:  0.001775503158569336
mini_batch_src_global generation:  0.0019655227661132812
r_  generation:  0.01904439926147461
local_output_nid generation:  0.0007805824279785156
local_in_edges_tensor generation:  0.0013349056243896484
mini_batch_src_global generation:  0.0018813610076904297
r_  generation:  0.016835689544677734
local_output_nid generation:  0.0011892318725585938
local_in_edges_tensor generation:  0.0019025802612304688
mini_batch_src_global generation:  0.0017933845520019531
r_  generation:  0.02126002311706543
local_output_nid generation:  0.001131296157836914
local_in_edges_tensor generation:  0.0017702579498291016
mini_batch_src_global generation:  0.0019311904907226562
r_  generation:  0.01995563507080078
----------------------check_connections_block total spend ----------------------------- 0.11510324478149414
generate_one_block  0.024455547332763672
generate_one_block  0.022836923599243164
generate_one_block  0.02637624740600586
generate_one_block  0.026187658309936523
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  0.18706560134887695
block generation total time  0.17376351356506348
average batch blocks generation time:  0.04344087839126587
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.03285551071166992  GigaBytes
Max Memory Allocated: 0.03285551071166992  GigaBytes

torch.Size([16382, 500])
torch.Size([10587, 128])
torch.Size([3148, 128])
torch.Size([603, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.058600425720214844  GigaBytes
Max Memory Allocated: 0.05867147445678711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.031635284423828125  GigaBytes
Max Memory Allocated: 0.06225442886352539  GigaBytes

torch.Size([15448, 500])
torch.Size([8306, 128])
torch.Size([2340, 128])
torch.Size([410, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.05201435089111328  GigaBytes
Max Memory Allocated: 0.06225442886352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.03385162353515625  GigaBytes
Max Memory Allocated: 0.06225442886352539  GigaBytes

torch.Size([16683, 500])
torch.Size([12572, 128])
torch.Size([3832, 128])
torch.Size([989, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.06438541412353516  GigaBytes
Max Memory Allocated: 0.06464147567749023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.033806800842285156  GigaBytes
Max Memory Allocated: 0.06683683395385742  GigaBytes

torch.Size([16461, 500])
torch.Size([11527, 128])
torch.Size([3695, 128])
torch.Size([883, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.062111854553222656  GigaBytes
Max Memory Allocated: 0.06683683395385742  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008878886699676514 |0.0873841643333435 |0.19849997758865356 |0.00019252300262451172 |0.005275130271911621 |0.002878427505493164 |
----------------------------------------------------------pseudo_mini_loss sum 2.1707022190093994
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  124223
Number of first layer input nodes during this epoch:  64974
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.037389278411865234  GigaBytes
Max Memory Allocated: 0.06683683395385742  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006084442138671875
range selection method range initialization spend 7.462501525878906e-05
time for parepare:  6.651878356933594e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.7670135498046875e-05
----------------------check_connections_block total spend ----------------------------- 0.0012252330780029297
generate_one_block  0.0013566017150878906
generate_one_block  0.0013108253479003906
generate_one_block  0.0017588138580322266
generate_one_block  0.0012755393981933594
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006184577941894531
gen group dst list time:  5.173683166503906e-05
time for parepare:  0.00037360191345214844
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.000354766845703125
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  9.632110595703125e-05
r_  generation:  0.0005469322204589844
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.000392913818359375
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.00029206275939941406
----------------------check_connections_block total spend ----------------------------- 0.0034942626953125
generate_one_block  0.001687765121459961
generate_one_block  0.0019335746765136719
generate_one_block  0.0017328262329101562
generate_one_block  0.001588582992553711
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011878013610839844
gen group dst list time:  0.00011706352233886719
time for parepare:  0.0010230541229248047
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.0003247261047363281
mini_batch_src_global generation:  0.0002689361572265625
r_  generation:  0.0022149085998535156
local_output_nid generation:  0.00010704994201660156
local_in_edges_tensor generation:  0.00030612945556640625
mini_batch_src_global generation:  0.0004961490631103516
r_  generation:  0.003843545913696289
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  0.0003409385681152344
r_  generation:  0.0027747154235839844
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.0002288818359375
mini_batch_src_global generation:  0.0002319812774658203
r_  generation:  0.0015265941619873047
----------------------check_connections_block total spend ----------------------------- 0.016977310180664062
generate_one_block  0.0034019947052001953
generate_one_block  0.004785299301147461
generate_one_block  0.003610372543334961
generate_one_block  0.0028133392333984375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018928050994873047
gen group dst list time:  0.0003266334533691406
time for parepare:  0.0017237663269042969
local_output_nid generation:  0.0002474784851074219
local_in_edges_tensor generation:  0.0007123947143554688
mini_batch_src_global generation:  0.0010554790496826172
r_  generation:  0.009489059448242188
local_output_nid generation:  0.0003285408020019531
local_in_edges_tensor generation:  0.0006883144378662109
mini_batch_src_global generation:  0.0013606548309326172
r_  generation:  0.012295961380004883
local_output_nid generation:  0.00022363662719726562
local_in_edges_tensor generation:  0.0004994869232177734
mini_batch_src_global generation:  0.0009438991546630859
r_  generation:  0.00803375244140625
local_output_nid generation:  0.00027561187744140625
local_in_edges_tensor generation:  0.0005350112915039062
mini_batch_src_global generation:  0.0007274150848388672
r_  generation:  0.007220029830932617
----------------------check_connections_block total spend ----------------------------- 0.055602312088012695
generate_one_block  0.01259303092956543
generate_one_block  0.015677452087402344
generate_one_block  0.01282811164855957
generate_one_block  0.011538028717041016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001737356185913086
gen group dst list time:  0.0009005069732666016
time for parepare:  0.0016946792602539062
local_output_nid generation:  0.0009300708770751953
local_in_edges_tensor generation:  0.0016942024230957031
mini_batch_src_global generation:  0.0018494129180908203
r_  generation:  0.019933700561523438
local_output_nid generation:  0.0013074874877929688
local_in_edges_tensor generation:  0.0016603469848632812
mini_batch_src_global generation:  0.0023047924041748047
r_  generation:  0.022233009338378906
local_output_nid generation:  0.0011172294616699219
local_in_edges_tensor generation:  0.0012860298156738281
mini_batch_src_global generation:  0.008132696151733398
r_  generation:  0.020262956619262695
local_output_nid generation:  0.0011832714080810547
local_in_edges_tensor generation:  0.0013058185577392578
mini_batch_src_global generation: Using backend: pytorch
 0.0019588470458984375
r_  generation:  0.021004676818847656
----------------------check_connections_block total spend ----------------------------- 0.12967729568481445
generate_one_block  0.026126861572265625
generate_one_block  0.030528545379638672
generate_one_block  0.02567768096923828
generate_one_block  0.02595996856689453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.037389278411865234  GigaBytes
Max Memory Allocated: 0.06683683395385742  GigaBytes

connection checking time:  0.2057511806488037
block generation total time  0.18248343467712402
average batch blocks generation time:  0.045620858669281006
block dataloader generation time/epoch 0.42708778381347656
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.035414695739746094  GigaBytes
Max Memory Allocated: 0.06683683395385742  GigaBytes

torch.Size([16528, 500])
torch.Size([10723, 128])
torch.Size([3362, 128])
torch.Size([648, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.06155681610107422  GigaBytes
Max Memory Allocated: 0.06683683395385742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4295654296875 GB
    Memory Allocated: 0.03609132766723633  GigaBytes
Max Memory Allocated: 0.06683683395385742  GigaBytes

torch.Size([17057, 500])
torch.Size([12998, 128])
torch.Size([4212, 128])
torch.Size([1038, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.06815481185913086  GigaBytes
Max Memory Allocated: 0.06841182708740234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.031226634979248047  GigaBytes
Max Memory Allocated: 0.07106828689575195  GigaBytes

torch.Size([14547, 500])
torch.Size([9422, 128])
torch.Size([2544, 128])
torch.Size([688, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.05462360382080078  GigaBytes
Max Memory Allocated: 0.07106828689575195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.0334162712097168  GigaBytes
Max Memory Allocated: 0.07106828689575195  GigaBytes

torch.Size([15738, 500])
torch.Size([9493, 128])
torch.Size([2765, 128])
torch.Size([517, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4334716796875 GB
    Memory Allocated: 0.05659675598144531  GigaBytes
Max Memory Allocated: 0.07106828689575195  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010499119758605957 |0.0016528964042663574 |0.007243096828460693 |0.00015401840209960938 |0.0042778849601745605 |0.0025014877319335938 |
----------------------------------------------------------pseudo_mini_loss sum 1.756871223449707
Total (block generation + training)time/epoch 0.5330197811126709
Training time/epoch 0.1054387092590332
Training time without block to device /epoch 0.09882712364196777
Training time without total dataloading part /epoch 0.04920148849487305
load block tensor time/epoch 0.04199647903442383
block to device time/epoch 0.00661158561706543
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  122637
Number of first layer input nodes during this epoch:  63870
