main start at this time 1648531973.3434677
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.62939453125e-05  GigaBytes
Max Memory Allocated: 7.62939453125e-05  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009369850158691406
range selection method range initialization spend 0.00014400482177734375
time for parepare:  5.5789947509765625e-05
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0025146007537841797
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.6927719116210938e-05
----------------------check_connections_block total spend ----------------------------- 0.005941629409790039
generate_one_block  0.0014574527740478516
generate_one_block  0.0012617111206054688
generate_one_block  0.0012631416320800781
generate_one_block  0.0012459754943847656
generate_one_block  0.0012395381927490234
generate_one_block  0.001253366470336914
generate_one_block  0.0010793209075927734
generate_one_block  0.00107574462890625
generate_one_block  0.0009472370147705078
generate_one_block  0.0009622573852539062
generate_one_block  0.0009484291076660156
generate_one_block  0.0009555816650390625
generate_one_block  0.0009446144104003906
generate_one_block  0.000949859619140625
generate_one_block  0.0009961128234863281
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006213188171386719
gen group dst list time:  0.00010514259338378906
time for parepare:  0.0003101825714111328
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00010704994201660156
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.918212890625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.7206878662109375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002689361572265625
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.000141143798828125
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0002567768096923828
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00010657310485839844
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00020122528076171875
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00010776519775390625
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.96453857421875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.413459777832031e-05
----------------------check_connections_block total spend ----------------------------- 0.005436420440673828
generate_one_block  0.0013470649719238281
generate_one_block  0.0013289451599121094
generate_one_block  0.0012938976287841797
generate_one_block  0.0013272762298583984
generate_one_block  0.0012621879577636719
generate_one_block  0.0016224384307861328
generate_one_block  0.0012049674987792969
generate_one_block  0.0012993812561035156
generate_one_block  0.0011339187622070312
generate_one_block  0.00115203857421875
generate_one_block  0.001005411148071289
generate_one_block  0.0009779930114746094
generate_one_block  0.001180410385131836
generate_one_block  0.0010797977447509766
generate_one_block  0.0009961128234863281
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011365413665771484
gen group dst list time:  0.00017118453979492188
time for parepare:  0.0009181499481201172
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0002677440643310547
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0005357265472412109
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0003256797790527344
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0004410743713378906
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004134178161621094
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00019502639770507812
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  0.00015997886657714844
r_  generation:  0.0017194747924804688
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  0.00012159347534179688
r_  generation:  0.0007789134979248047
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  0.0001518726348876953
r_  generation:  0.0015773773193359375
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  0.00011706352233886719
r_  generation:  0.0008080005645751953
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  0.00010132789611816406
r_  generation:  0.0009765625
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0004317760467529297
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00014472007751464844
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0005288124084472656
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  7.581710815429688e-05
r_  generation:  0.000629425048828125
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.00027823448181152344
----------------------check_connections_block total spend ----------------------------- 0.017405271530151367
generate_one_block  0.0020318031311035156
generate_one_block  0.0012981891632080078
generate_one_block  0.0014219284057617188
generate_one_block  0.0013325214385986328
generate_one_block  0.0012481212615966797
generate_one_block  0.002862691879272461
generate_one_block  0.0017881393432617188
generate_one_block  0.0028107166290283203
generate_one_block  0.0019040107727050781
generate_one_block  0.002016782760620117
generate_one_block  0.0014357566833496094
generate_one_block  0.001094818115234375
generate_one_block  0.00202178955078125
generate_one_block  0.001729726791381836
generate_one_block  0.0012431144714355469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001806020736694336
gen group dst list time:  0.000316619873046875
time for parepare:  0.0016613006591796875
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.0004711151123046875
mini_batch_src_global generation:  0.00035953521728515625
r_  generation:  0.002889394760131836
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  0.0002181529998779297
r_  generation:  0.0014019012451171875
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  0.00027060508728027344
r_  generation:  0.002562284469604492
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  0.00020575523376464844
r_  generation:  0.0017845630645751953
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.00015544891357421875
r_  generation:  0.0013041496276855469
local_output_nid generation:  0.00015425682067871094
local_in_edges_tensor generation:  0.0003886222839355469
mini_batch_src_global generation:  0.0006930828094482422
r_  generation:  0.006541013717651367
local_output_nid generation:  0.00010919570922851562
local_in_edges_tensor generation:  0.00028634071350097656
mini_batch_src_global generation:  0.0005035400390625
r_  generation:  0.00392913818359375
local_output_nid generation:  0.00019097328186035156
local_in_edges_tensor generation:  0.0004248619079589844
mini_batch_src_global generation:  0.0006716251373291016
r_  generation:  0.006178379058837891
local_output_nid generation:  0.00015854835510253906
local_in_edges_tensor generation:  0.0003464221954345703
mini_batch_src_global generation:  0.0005004405975341797
r_  generation:  0.004801750183105469
local_output_nid generation:  0.00013256072998046875
local_in_edges_tensor generation:  0.0003070831298828125
mini_batch_src_global generation:  0.0004067420959472656
r_  generation:  0.00400090217590332
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.00023865699768066406
mini_batch_src_global generation:  0.000339508056640625
r_  generation:  0.003024578094482422
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  0.0001518726348876953
r_  generation:  0.0007426738739013672
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  0.00023984909057617188
r_  generation:  0.002635955810546875
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.00025582313537597656
mini_batch_src_global generation:  0.0003998279571533203
r_  generation:  0.003778696060180664
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  0.00025391578674316406
r_  generation:  0.0018794536590576172
----------------------check_connections_block total spend ----------------------------- 0.07215118408203125
generate_one_block  0.005370140075683594
generate_one_block  0.002679586410522461
generate_one_block  0.004096508026123047
generate_one_block  0.003031492233276367
generate_one_block  0.002483367919921875
generate_one_block  0.009774208068847656
generate_one_block  0.006330966949462891
generate_one_block  0.00927114486694336
generate_one_block  0.008128643035888672
generate_one_block  0.0060541629791259766
generate_one_block  0.00495600700378418
generate_one_block  0.0018832683563232422
generate_one_block  0.0046405792236328125
generate_one_block  0.006678342819213867
generate_one_block  0.0033872127532958984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0023131370544433594
gen group dst list time:  0.0017066001892089844
time for parepare:  0.001878499984741211
local_output_nid generation:  0.00037479400634765625
local_in_edges_tensor generation:  0.0010936260223388672
mini_batch_src_global generation:  0.0010535717010498047
r_  generation:  0.010026693344116211
local_output_nid generation:  0.00024366378784179688
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0007150173187255859
r_  generation:  0.00554203987121582
local_output_nid generation:  0.00037169456481933594
local_in_edges_tensor generation:  0.0006885528564453125
mini_batch_src_global generation:  0.0008671283721923828
r_  generation:  0.010280609130859375
local_output_nid generation:  0.0002524852752685547
local_in_edges_tensor generation:  0.0005586147308349609
mini_batch_src_global generation:  0.0007853507995605469
r_  generation:  0.006453990936279297
local_output_nid generation:  0.00024366378784179688
local_in_edges_tensor generation:  0.00042819976806640625
mini_batch_src_global generation:  0.0004944801330566406
r_  generation:  0.004936695098876953
local_output_nid generation:  0.0006432533264160156
local_in_edges_tensor generation:  0.0012903213500976562
mini_batch_src_global generation:  0.0011675357818603516
r_  generation:  0.01572442054748535
local_output_nid generation:  0.0006506443023681641
local_in_edges_tensor generation:  0.0011553764343261719
mini_batch_src_global generation:  0.0011992454528808594
r_  generation:  0.012531042098999023
local_output_nid generation:  0.0006022453308105469
local_in_edges_tensor generation:  0.0009481906890869141
mini_batch_src_global generation:  0.0012464523315429688
r_  generation:  0.015058279037475586
local_output_nid generation:  0.0006816387176513672
local_in_edges_tensor generation:  0.0010862350463867188
mini_batch_src_global generation:  0.0014808177947998047
r_  generation:  0.0158693790435791
local_output_nid generation:  0.0005261898040771484
local_in_edges_tensor generation:  0.0008018016815185547
mini_batch_src_global generation:  0.0010690689086914062
r_  generation:  0.012206077575683594
local_output_nid generation:  0.0003650188446044922
local_in_edges_tensor generation:  0.0006279945373535156
mini_batch_src_global generation:  0.0008373260498046875
r_  generation:  0.009946107864379883
local_output_nid generation:  0.00017142295837402344
local_in_edges_tensor generation:  0.00034165382385253906
mini_batch_src_global generation:  0.0005054473876953125
r_  generation:  0.0037996768951416016
local_output_nid generation:  0.00046515464782714844
local_in_edges_tensor generation:  0.0007271766662597656
mini_batch_src_global generation:  0.0008471012115478516
r_  generation:  0.010827779769897461
local_output_nid generation:  0.00039649009704589844
local_in_edges_tensor generation:  0.0006833076477050781
mini_batch_src_global generation:  0.0009667873382568359
r_  generation:  0.009152889251708984
local_output_nid generation:  0.00026535987854003906
local_in_edges_tensor generation:  0.0004711151123046875
mini_batch_src_global generation:  0.0007455348968505859
r_  generation:  0.007263660430908203
----------------------check_connections_block total spend ----------------------------- 0.21903133392333984
generate_one_block  0.014267921447753906
generate_one_block  0.008169412612915039
generate_one_block  0.015181541442871094
generate_one_block  0.010276317596435547
generate_one_block  0.007839441299438477
generate_one_block  0.020739078521728516
generate_one_block  0.016340970993041992
generate_one_block  0.019699811935424805
generate_one_block  0.021097183227539062
generate_one_block  0.01565384864807129
generate_one_block  0.01408076286315918
generate_one_block  0.005772829055786133
generate_one_block  0.014337778091430664
generate_one_block  0.01385188102722168
generate_one_block  0.010662317276000977
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.62939453125e-05  GigaBytes
Max Memory Allocated: 7.62939453125e-05  GigaBytes

connection checking time:  0.3140242099761963
block generation total time  0.3311886787414551
average batch blocks generation time:  0.02207924524943034
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.019943714141845703  GigaBytes
Max Memory Allocated: 0.019943714141845703  GigaBytes

torch.Size([10366, 500])
torch.Size([3872, 16])
torch.Size([830, 16])
torch.Size([168, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.021334171295166016  GigaBytes
Max Memory Allocated: 0.02166604995727539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.013007164001464844  GigaBytes
Max Memory Allocated: 0.03237295150756836  GigaBytes

torch.Size([6814, 500])
torch.Size([2496, 16])
torch.Size([484, 16])
torch.Size([104, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.013849735260009766  GigaBytes
Max Memory Allocated: 0.03237295150756836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.02008056640625  GigaBytes
Max Memory Allocated: 0.0324406623840332  GigaBytes

torch.Size([10522, 500])
torch.Size([3919, 16])
torch.Size([708, 16])
torch.Size([100, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.021427154541015625  GigaBytes
Max Memory Allocated: 0.0324406623840332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.014044761657714844  GigaBytes
Max Memory Allocated: 0.03342008590698242  GigaBytes

torch.Size([7231, 500])
torch.Size([2542, 16])
torch.Size([524, 16])
torch.Size([119, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.014963626861572266  GigaBytes
Max Memory Allocated: 0.03342008590698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.013406753540039062  GigaBytes
Max Memory Allocated: 0.03342008590698242  GigaBytes

torch.Size([7029, 500])
torch.Size([2580, 16])
torch.Size([409, 16])
torch.Size([72, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.014231681823730469  GigaBytes
Max Memory Allocated: 0.03342008590698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.024698734283447266  GigaBytes
Max Memory Allocated: 0.037194252014160156  GigaBytes

torch.Size([12859, 500])
torch.Size([7675, 16])
torch.Size([1836, 16])
torch.Size([447, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.027453899383544922  GigaBytes
Max Memory Allocated: 0.037194252014160156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.022698402404785156  GigaBytes
Max Memory Allocated: 0.046248435974121094  GigaBytes

torch.Size([11890, 500])
torch.Size([6813, 16])
torch.Size([1287, 16])
torch.Size([289, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.02490234375  GigaBytes
Max Memory Allocated: 0.046248435974121094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.024413108825683594  GigaBytes
Max Memory Allocated: 0.046248435974121094  GigaBytes

torch.Size([12719, 500])
torch.Size([6597, 16])
torch.Size([2129, 16])
torch.Size([405, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.026998043060302734  GigaBytes
Max Memory Allocated: 0.046248435974121094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.02697610855102539  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([14118, 500])
torch.Size([7369, 16])
torch.Size([1778, 16])
torch.Size([213, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.029525279998779297  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.022662639617919922  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([11875, 500])
torch.Size([6177, 16])
torch.Size([1573, 16])
torch.Size([363, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.024829387664794922  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.016904830932617188  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([8812, 500])
torch.Size([3691, 16])
torch.Size([904, 16])
torch.Size([105, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.018270015716552734  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.009617328643798828  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([5025, 500])
torch.Size([1578, 16])
torch.Size([224, 16])
torch.Size([61, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.0101318359375  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.020670413970947266  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([10832, 500])
torch.Size([4849, 16])
torch.Size([798, 16])
torch.Size([230, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.022273540496826172  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.015901565551757812  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([8261, 500])
torch.Size([4373, 16])
torch.Size([1023, 16])
torch.Size([166, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.017470359802246094  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.014079093933105469  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([7012, 500])
torch.Size([2933, 16])
torch.Size([499, 16])
torch.Size([95, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.015097618103027344  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007887681325276693 |0.024863688151041667 |0.05827507972717285 |0.00015845298767089844 |0.005613549550374349 |0.003116130828857422 |
----------------------------------------------------------pseudo_mini_loss sum 2.4299142360687256
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  231129
Number of first layer input nodes during this epoch:  145365
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.014791011810302734  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012638568878173828
range selection method range initialization spend 5.793571472167969e-05
time for parepare:  5.030632019042969e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4066696166992188e-05
----------------------check_connections_block total spend ----------------------------- 0.0028367042541503906
generate_one_block  0.0011091232299804688
generate_one_block  0.0013005733489990234
generate_one_block  0.001043558120727539
generate_one_block  0.0010344982147216797
generate_one_block  0.001024007797241211
generate_one_block  0.0010344982147216797
generate_one_block  0.0010349750518798828
generate_one_block  0.0010306835174560547
generate_one_block  0.0010178089141845703
generate_one_block  0.0010366439819335938
generate_one_block  0.0009760856628417969
generate_one_block  0.0009317398071289062
generate_one_block  0.0009388923645019531
generate_one_block  0.0009605884552001953
generate_one_block  0.0009379386901855469
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007445812225341797
gen group dst list time:  8.106231689453125e-05
time for parepare:  0.0002663135528564453
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00011944770812988281
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0001430511474609375
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001785755157470703
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00011014938354492188
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00011420249938964844
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00019669532775878906
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  8.845329284667969e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.62939453125e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.982948303222656e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00017189979553222656
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  5.173683166503906e-05
----------------------check_connections_block total spend ----------------------------- 0.004825115203857422
generate_one_block  0.0010972023010253906
generate_one_block  0.0011527538299560547
generate_one_block  0.0012345314025878906
generate_one_block  0.0012748241424560547
generate_one_block  0.0011599063873291016
generate_one_block  0.0011677742004394531
generate_one_block  0.0012977123260498047
generate_one_block  0.0011298656463623047
generate_one_block  0.0010530948638916016
generate_one_block  0.0010814666748046875
generate_one_block  0.001132965087890625
generate_one_block  0.0009832382202148438
generate_one_block  0.0010361671447753906
generate_one_block  0.001132965087890625
generate_one_block  0.0009789466857910156
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010323524475097656
gen group dst list time:  0.0001342296600341797
time for parepare:  0.0008094310760498047
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00023174285888671875
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0002186298370361328
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.00042128562927246094
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  0.00011181831359863281
r_  generation:  0.0009212493896484375
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  0.0001804828643798828
r_  generation:  0.0013375282287597656
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  0.00010323524475097656
r_  generation:  0.0006361007690429688
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  7.677078247070312e-05
r_  generation:  0.0006427764892578125
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  0.0001556873321533203
r_  generation:  0.0015935897827148438
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  8.845329284667969e-05
r_  generation:  0.0004570484161376953
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00021839141845703125
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0008006095886230469
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.0004885196685791016
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00011587142944335938
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00023436546325683594
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  0.00010442733764648438
r_  generation:  0.0012018680572509766
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0003192424774169922
----------------------check_connections_block total spend ----------------------------- 0.01706242561340332
generate_one_block  0.0017600059509277344
generate_one_block  0.001466989517211914
generate_one_block  0.0019383430480957031
generate_one_block  0.0025360584259033203
generate_one_block  0.0016300678253173828
generate_one_block  0.0016326904296875
generate_one_block  0.0027191638946533203
generate_one_block  0.0014429092407226562
generate_one_block  0.0011386871337890625
generate_one_block  0.0019376277923583984
generate_one_block  0.0014605522155761719
generate_one_block  0.0010421276092529297
generate_one_block  0.001184701919555664
generate_one_block  0.0023648738861083984
generate_one_block  0.0012812614440917969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016489028930664062
gen group dst list time:  0.0003330707550048828
time for parepare:  0.0014543533325195312
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0003509521484375
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.0009756088256835938
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  0.0002028942108154297
r_  generation:  0.0016856193542480469
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.00033473968505859375
mini_batch_src_global generation:  0.00047397613525390625
r_  generation:  0.004884958267211914
local_output_nid generation:  0.000133514404296875
local_in_edges_tensor generation:  0.0003743171691894531
mini_batch_src_global generation:  0.0007123947143554688
r_  generation:  0.00562739372253418
local_output_nid generation:  0.00010919570922851562
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  0.0003688335418701172
r_  generation:  0.003180980682373047
local_output_nid generation:  0.00010538101196289062
local_in_edges_tensor generation:  0.0002970695495605469
mini_batch_src_global generation:  0.00038552284240722656
r_  generation:  0.003572702407836914
local_output_nid generation:  0.00015115737915039062
local_in_edges_tensor generation:  0.00039076805114746094
mini_batch_src_global generation:  0.0005388259887695312
r_  generation:  0.005716562271118164
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.000240325927734375
mini_batch_src_global generation:  0.0003399848937988281
r_  generation:  0.0026128292083740234
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  0.00019049644470214844
r_  generation:  0.0015261173248291016
local_output_nid generation:  0.0001201629638671875
local_in_edges_tensor generation:  0.0003066062927246094
mini_batch_src_global generation:  0.0003952980041503906
r_  generation:  0.004460334777832031
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00022101402282714844
mini_batch_src_global generation:  0.0002923011779785156
r_  generation:  0.002309083938598633
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  0.00011467933654785156
r_  generation:  0.0005357265472412109
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  0.00012612342834472656
r_  generation:  0.0012853145599365234
local_output_nid generation:  0.00019049644470214844
local_in_edges_tensor generation:  0.0003981590270996094
mini_batch_src_global generation:  0.0004107952117919922
r_  generation:  0.005388736724853516
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.0002872943878173828
r_  generation:  0.002027750015258789
----------------------check_connections_block total spend ----------------------------- 0.0691995620727539
generate_one_block  0.0026857852935791016
generate_one_block  0.0030291080474853516
generate_one_block  0.007027387619018555
generate_one_block  0.007576942443847656
generate_one_block  0.005163431167602539
generate_one_block  0.0057184696197509766
generate_one_block  0.00868368148803711
generate_one_block  0.005571126937866211
generate_one_block  0.0029218196868896484
generate_one_block  0.006800413131713867
generate_one_block  0.00396728515625
generate_one_block  0.0015370845794677734
generate_one_block  0.0026044845581054688
generate_one_block  0.00782632827758789
generate_one_block  0.0034704208374023438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021944046020507812
gen group dst list time:  0.0013844966888427734
time for parepare:  0.0018193721771240234
local_output_nid generation:  0.0001862049102783203
local_in_edges_tensor generation:  0.0007503032684326172
mini_batch_src_global generation:  0.000469207763671875
r_  generation:  0.003934144973754883
local_output_nid generation:  0.00024008750915527344
local_in_edges_tensor generation:  0.0005042552947998047
mini_batch_src_global generation:  0.0006594657897949219
r_  generation:  0.005444049835205078
local_output_nid generation:  0.0006229877471923828
local_in_edges_tensor generation:  0.001104116439819336
mini_batch_src_global generation:  0.0010750293731689453
r_  generation:  0.013073444366455078
local_output_nid generation:  0.0004658699035644531
local_in_edges_tensor generation:  0.0008513927459716797
mini_batch_src_global generation:  0.0011320114135742188
r_  generation:  0.011620044708251953
local_output_nid generation:  0.0005130767822265625
local_in_edges_tensor generation:  0.0009047985076904297
mini_batch_src_global generation:  0.000978708267211914
r_  generation:  0.01182103157043457
local_output_nid generation:  0.0005233287811279297
local_in_edges_tensor generation:  0.000942230224609375
mini_batch_src_global generation:  0.0011737346649169922
r_  generation:  0.012933015823364258
local_output_nid generation:  0.0005733966827392578
local_in_edges_tensor generation:  0.00098419189453125
mini_batch_src_global generation:  0.0012040138244628906
r_  generation:  0.02402186393737793
local_output_nid generation:  0.0012540817260742188
local_in_edges_tensor generation:  0.0012969970703125
mini_batch_src_global generation:  0.0014677047729492188
r_  generation:  0.012095451354980469
local_output_nid generation:  0.0007240772247314453
local_in_edges_tensor generation:  0.0006735324859619141
mini_batch_src_global generation:  0.0008313655853271484
r_  generation:  0.007371664047241211
local_output_nid generation:  0.0007245540618896484
local_in_edges_tensor generation:  0.0007567405700683594
mini_batch_src_global generation:  0.0009357929229736328
r_  generation:  0.01073765754699707
local_output_nid generation:  0.000629425048828125
local_in_edges_tensor generation:  0.0007064342498779297
mini_batch_src_global generation:  0.0009195804595947266
r_  generation:  0.008487939834594727
local_output_nid generation:  0.00013756752014160156
local_in_edges_tensor generation:  0.0002689361572265625
mini_batch_src_global generation:  0.00041294097900390625
r_  generation:  0.0027484893798828125
local_output_nid generation:  0.00041031837463378906
local_in_edges_tensor generation:  0.0005247592926025391
mini_batch_src_global generation:  0.0005326271057128906
r_  generation:  0.006028413772583008
local_output_nid generation:  0.0009362697601318359
local_in_edges_tensor generation:  0.0012094974517822266
mini_batch_src_global generation:  0.0013301372528076172
r_  generation:  0.015009641647338867
local_output_nid generation:  0.0004241466522216797
local_in_edges_tensor generation:  0.0005514621734619141
mini_batch_src_global generation:  0.0009047985076904297
r_  generation:  0.00766754150390625
----------------------check_connections_block total spend ----------------------------- 0.22397351264953613
generate_one_block  0.006834268569946289
generate_one_block  0.007404804229736328
generate_one_block  0.016297101974487305
generate_one_block  0.016271352767944336
generate_one_block  0.018142223358154297
generate_one_block  0.01777482032775879
generate_one_block  0.018772363662719727
generate_one_block  0.01583695411682129
generate_one_block  0.010595321655273438
generate_one_block  0.013783693313598633
generate_one_block  0.01353001594543457
generate_one_block  0.004817485809326172
generate_one_block  0.009076356887817383
generate_one_block  0.01872396469116211
generate_one_block  0.012322664260864258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.014791011810302734  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

connection checking time:  0.3150606155395508
block generation total time  0.3172166347503662
average batch blocks generation time:  0.021147775650024413
block dataloader generation time/epoch 0.7438375949859619
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.010748863220214844  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([5550, 500])
torch.Size([1777, 16])
torch.Size([313, 16])
torch.Size([109, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.01135396957397461  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.012682914733886719  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([6559, 500])
torch.Size([2598, 16])
torch.Size([646, 16])
torch.Size([168, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.013616085052490234  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.024164199829101562  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([12163, 500])
torch.Size([7471, 16])
torch.Size([1460, 16])
torch.Size([340, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.026591777801513672  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.01908397674560547  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([9842, 500])
torch.Size([5128, 16])
torch.Size([1619, 16])
torch.Size([330, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.02110910415649414  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.02215862274169922  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([11179, 500])
torch.Size([5332, 16])
torch.Size([955, 16])
torch.Size([227, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.0239410400390625  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.021745681762695312  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([11293, 500])
torch.Size([5671, 16])
torch.Size([1032, 16])
torch.Size([244, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.02365589141845703  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.022545337677001953  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([11662, 500])
torch.Size([6048, 16])
torch.Size([1760, 16])
torch.Size([350, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.024863719940185547  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.02285146713256836  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([11918, 500])
torch.Size([5233, 16])
torch.Size([890, 16])
torch.Size([175, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.024562835693359375  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.014185905456542969  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([7117, 500])
torch.Size([3041, 16])
torch.Size([377, 16])
torch.Size([88, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.015157699584960938  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.016756057739257812  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([8619, 500])
torch.Size([4541, 16])
torch.Size([1383, 16])
torch.Size([160, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.018498897552490234  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.01994609832763672  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([10392, 500])
torch.Size([3741, 16])
torch.Size([799, 16])
torch.Size([146, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.02126169204711914  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.0071315765380859375  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([3627, 500])
torch.Size([861, 16])
torch.Size([176, 16])
torch.Size([36, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.007460117340087891  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.015242576599121094  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([7916, 500])
torch.Size([2453, 16])
torch.Size([440, 16])
torch.Size([97, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.016098976135253906  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.028143882751464844  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([14429, 500])
torch.Size([7328, 16])
torch.Size([2384, 16])
torch.Size([363, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.030868053436279297  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.014308929443359375  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

torch.Size([7388, 500])
torch.Size([2778, 16])
torch.Size([495, 16])
torch.Size([90, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.015292167663574219  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0035966078440348307 |0.0010458151499430338 |0.006649573644002278 |0.00019601186116536458 |0.0033433278401692706 |0.0044476985931396484 |
----------------------------------------------------------pseudo_mini_loss sum 2.287992000579834
Total (block generation + training)time/epoch 0.9933931827545166
Training time/epoch 0.24934053421020508
Training time without block to device /epoch 0.23365330696105957
Training time without total dataloading part /epoch 0.15728139877319336
load block tensor time/epoch 0.05394911766052246
block to device time/epoch 0.015687227249145508
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  221663
Number of first layer input nodes during this epoch:  139654
