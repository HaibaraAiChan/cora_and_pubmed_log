main start at this time 1648531941.0069745
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.62939453125e-05  GigaBytes
Max Memory Allocated: 7.62939453125e-05  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0023894309997558594
range selection method range initialization spend 8.273124694824219e-05
time for parepare:  4.57763671875e-05
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0012335777282714844
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  5.936622619628906e-05
----------------------check_connections_block total spend ----------------------------- 0.0019063949584960938
generate_one_block  0.0013914108276367188
generate_one_block  0.0011355876922607422
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011703968048095703
gen group dst list time:  2.6941299438476562e-05
time for parepare:  0.00023937225341796875
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  7.390975952148438e-05
r_  generation:  0.0007843971252441406
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0005183219909667969
----------------------check_connections_block total spend ----------------------------- 0.0024261474609375
generate_one_block  0.0021126270294189453
generate_one_block  0.0017383098602294922
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010199546813964844
gen group dst list time:  6.413459777832031e-05
time for parepare:  0.000751495361328125
local_output_nid generation:  0.00010466575622558594
local_in_edges_tensor generation:  0.00040793418884277344
mini_batch_src_global generation:  0.0003478527069091797
r_  generation:  0.0044689178466796875
local_output_nid generation:  9.799003601074219e-05
local_in_edges_tensor generation:  0.00028228759765625
mini_batch_src_global generation:  0.00047397613525390625
r_  generation:  0.0035965442657470703
----------------------check_connections_block total spend ----------------------------- 0.012635946273803711
generate_one_block  0.007415294647216797
generate_one_block  0.005154132843017578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002184629440307617
gen group dst list time:  0.00020051002502441406
time for parepare:  0.0013730525970458984
local_output_nid generation:  0.00035381317138671875
local_in_edges_tensor generation:  0.0010495185852050781
mini_batch_src_global generation:  0.0014140605926513672
r_  generation:  0.013905525207519531
local_output_nid generation:  0.0004208087921142578
local_in_edges_tensor generation:  0.0008590221405029297
mini_batch_src_global generation:  0.0015761852264404297
r_  generation:  0.014150381088256836
----------------------check_connections_block total spend ----------------------------- 0.04196023941040039
generate_one_block  0.018559932708740234
generate_one_block  0.019850730895996094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017075538635253906
gen group dst list time:  0.0005252361297607422
time for parepare:  0.001501321792602539
local_output_nid generation:  0.0009734630584716797
local_in_edges_tensor generation:  0.0020301342010498047
mini_batch_src_global generation:  0.002125263214111328
r_  generation:  0.02288365364074707
local_output_nid generation:  0.0010886192321777344
local_in_edges_tensor generation:  0.0021910667419433594
mini_batch_src_global generation:  0.002511739730834961
r_  generation:  0.023231983184814453
----------------------check_connections_block total spend ----------------------------- 0.06905436515808105
generate_one_block  0.027487993240356445
generate_one_block  0.02932429313659668
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.62939453125e-05  GigaBytes
Max Memory Allocated: 7.62939453125e-05  GigaBytes

connection checking time:  0.12607669830322266
block generation total time  0.11164331436157227
average batch blocks generation time:  0.05582165718078613
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.034299373626708984  GigaBytes
Max Memory Allocated: 0.034299373626708984  GigaBytes

torch.Size([17699, 500])
torch.Size([14098, 16])
torch.Size([5211, 16])
torch.Size([1516, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.03997468948364258  GigaBytes
Max Memory Allocated: 0.03998756408691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.03434181213378906  GigaBytes
Max Memory Allocated: 0.06655550003051758  GigaBytes

torch.Size([17776, 500])
torch.Size([13827, 16])
torch.Size([5490, 16])
torch.Size([1253, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.03992462158203125  GigaBytes
Max Memory Allocated: 0.06655550003051758  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013927459716796875 |0.17155349254608154 |0.3842592239379883 |0.00021445751190185547 |0.008607864379882812 |0.0032029151916503906 |
----------------------------------------------------------pseudo_mini_loss sum 2.517815589904785
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  77226
Number of first layer input nodes during this epoch:  35475
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.03668546676635742  GigaBytes
Max Memory Allocated: 0.06655550003051758  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005450248718261719
range selection method range initialization spend 6.508827209472656e-05
time for parepare:  5.841255187988281e-05
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  9.775161743164062e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  5.459785461425781e-05
----------------------check_connections_block total spend ----------------------------- 0.0007464885711669922
generate_one_block  0.0012240409851074219
generate_one_block  0.0011148452758789062
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005741119384765625
gen group dst list time:  2.9087066650390625e-05
time for parepare:  0.0003070831298828125
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00020933151245117188
mini_batch_src_global generation:  0.00012040138244628906
r_  generation:  0.0008578300476074219
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation: Using backend: pytorch
 8.797645568847656e-05
r_  generation:  0.00046133995056152344
----------------------check_connections_block total spend ----------------------------- 0.002670764923095703
generate_one_block  0.002155303955078125
generate_one_block  0.0016679763793945312
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001020669937133789
gen group dst list time:  8.678436279296875e-05
time for parepare:  0.0008337497711181641
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.0004413127899169922
mini_batch_src_global generation:  0.0004544258117675781
r_  generation:  0.0050542354583740234
local_output_nid generation:  9.465217590332031e-05
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  0.0004012584686279297
r_  generation:  0.0030241012573242188
----------------------check_connections_block total spend ----------------------------- 0.01281428337097168
generate_one_block  0.007790565490722656
generate_one_block  0.004573822021484375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017852783203125
gen group dst list time:  0.0002033710479736328
time for parepare:  0.0013384819030761719
local_output_nid generation:  0.00039005279541015625
local_in_edges_tensor generation:  0.0010793209075927734
mini_batch_src_global generation:  0.0014851093292236328
r_  generation:  0.015226364135742188
local_output_nid generation:  0.0003998279571533203
local_in_edges_tensor generation:  0.0008299350738525391
mini_batch_src_global generation:  0.0015537738800048828
r_  generation:  0.012895345687866211
----------------------check_connections_block total spend ----------------------------- 0.04217243194580078
generate_one_block  0.01983642578125
generate_one_block  0.018059253692626953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017435550689697266
gen group dst list time:  0.00055694580078125
time for parepare:  0.001520395278930664
local_output_nid generation:  0.0010380744934082031
local_in_edges_tensor generation:  0.002063751220703125
mini_batch_src_global generation:  0.002294778823852539
r_  generation:  0.02397298812866211
local_output_nid generation:  0.001230001449584961
local_in_edges_tensor generation:  0.0024962425231933594
mini_batch_src_global generation:  0.002478361129760742
r_  generation:  0.022233009338378906
----------------------check_connections_block total spend ----------------------------- 0.07018280029296875
generate_one_block  0.029265403747558594
generate_one_block  0.030245542526245117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.03668546676635742  GigaBytes
Max Memory Allocated: 0.06655550003051758  GigaBytes

connection checking time:  0.12784028053283691
block generation total time  0.11359429359436035
average batch blocks generation time:  0.056797146797180176
block dataloader generation time/epoch 0.27424192428588867
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.03481864929199219  GigaBytes
Max Memory Allocated: 0.06696271896362305  GigaBytes

torch.Size([17969, 500])
torch.Size([14554, 16])
torch.Size([5642, 16])
torch.Size([1728, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.04079627990722656  GigaBytes
Max Memory Allocated: 0.06696271896362305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.034415245056152344  GigaBytes
Max Memory Allocated: 0.06696367263793945  GigaBytes

torch.Size([17524, 500])
torch.Size([12641, 16])
torch.Size([4861, 16])
torch.Size([966, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.03944587707519531  GigaBytes
Max Memory Allocated: 0.06696367263793945  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013151288032531738 |0.001437544822692871 |0.005831241607666016 |0.00013947486877441406 |0.004224061965942383 |0.005115032196044922 |
----------------------------------------------------------pseudo_mini_loss sum 2.043862819671631
Total (block generation + training)time/epoch 0.332751989364624
Training time/epoch 0.05817604064941406
Training time without block to device /epoch 0.05530095100402832
Training time without total dataloading part /epoch 0.025504589080810547
load block tensor time/epoch 0.026302576065063477
block to device time/epoch 0.002875089645385742
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  76239
Number of first layer input nodes during this epoch:  35493
