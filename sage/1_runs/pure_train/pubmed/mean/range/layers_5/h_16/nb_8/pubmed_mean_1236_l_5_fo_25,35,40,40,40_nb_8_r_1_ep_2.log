main start at this time 1648531951.6348333
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.62939453125e-05  GigaBytes
Max Memory Allocated: 7.62939453125e-05  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009713172912597656
range selection method range initialization spend 0.00011110305786132812
time for parepare:  5.4836273193359375e-05
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0025436878204345703
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.0994415283203125e-05
----------------------check_connections_block total spend ----------------------------- 0.0037641525268554688
generate_one_block  0.0015723705291748047
generate_one_block  0.0013251304626464844
generate_one_block  0.0012943744659423828
generate_one_block  0.0012590885162353516
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006496906280517578
gen group dst list time:  4.696846008300781e-05
time for parepare:  0.00030612945556640625
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0003337860107421875
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0006051063537597656
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0003972053527832031
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00026345252990722656
----------------------check_connections_block total spend ----------------------------- 0.0033757686614990234
generate_one_block  0.0016527175903320312
generate_one_block  0.0020744800567626953
generate_one_block  0.0017542839050292969
generate_one_block  0.001626729965209961
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011849403381347656
gen group dst list time:  9.584426879882812e-05
time for parepare:  0.0009162425994873047
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00029540061950683594
mini_batch_src_global generation:  0.00014853477478027344
r_  generation:  0.0015232563018798828
local_output_nid generation:  9.942054748535156e-05
local_in_edges_tensor generation:  0.0003266334533691406
mini_batch_src_global generation:  0.0004832744598388672
r_  generation:  0.004122495651245117
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.0002696514129638672
mini_batch_src_global generation:  0.00034356117248535156
r_  generation:  0.00276947021484375
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.00023412704467773438
mini_batch_src_global generation:  0.00020956993103027344
r_  generation:  0.0015990734100341797
----------------------check_connections_block total spend ----------------------------- 0.016331911087036133
generate_one_block  0.0029993057250976562
generate_one_block  0.0050067901611328125
generate_one_block  0.003785848617553711
generate_one_block  0.002596616744995117
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017828941345214844
gen group dst list time:  0.0003001689910888672
time for parepare:  0.0017817020416259766
local_output_nid generation:  0.00022602081298828125
local_in_edges_tensor generation:  0.0007147789001464844
mini_batch_src_global generation:  0.0009739398956298828
r_  generation:  0.008205175399780273
local_output_nid generation:  0.00039958953857421875
local_in_edges_tensor generation:  0.0007812976837158203
mini_batch_src_global generation:  0.0015358924865722656
r_  generation:  0.014323234558105469
local_output_nid generation:  0.0003581047058105469
local_in_edges_tensor generation:  0.0006780624389648438
mini_batch_src_global generation:  0.0013210773468017578
r_  generation:  0.01372218132019043
local_output_nid generation:  0.00021505355834960938
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.0007634162902832031
r_  generation:  0.00714874267578125
----------------------check_connections_block total spend ----------------------------- 0.06403875350952148
generate_one_block  0.009682893753051758
generate_one_block  0.016023635864257812
generate_one_block  0.01851654052734375
generate_one_block  0.014173507690429688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018770694732666016
gen group dst list time:  0.0010504722595214844
time for parepare:  0.002219676971435547
local_output_nid generation:  0.0009555816650390625
local_in_edges_tensor generation:  0.0016398429870605469
mini_batch_src_global generation:  0.0019555091857910156
r_  generation:  0.0192720890045166
local_output_nid generation:  0.0010533332824707031
local_in_edges_tensor generation:  0.0020651817321777344
mini_batch_src_global generation:  0.002765655517578125
r_  generation:  0.024047374725341797
local_output_nid generation:  0.0011718273162841797
local_in_edges_tensor generation:  0.002042531967163086
mini_batch_src_global generation:  0.0023164749145507812
r_  generation:  0.024422168731689453
local_output_nid generation:  0.0009469985961914062
local_in_edges_tensor generation:  0.001230001449584961
mini_batch_src_global generation:  0.0019304752349853516
r_  generation:  0.020760774612426758
----------------------check_connections_block total spend ----------------------------- 0.13230490684509277
generate_one_block  0.021860837936401367
generate_one_block  0.028581857681274414
generate_one_block  0.028190135955810547
generate_one_block  0.023453235626220703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.62939453125e-05  GigaBytes
Max Memory Allocated: 7.62939453125e-05  GigaBytes

connection checking time:  0.21605134010314941
block generation total time  0.18197941780090332
average batch blocks generation time:  0.04549485445022583
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.028250694274902344  GigaBytes
Max Memory Allocated: 0.028250694274902344  GigaBytes

torch.Size([14795, 500])
torch.Size([8398, 16])
torch.Size([2220, 16])
torch.Size([468, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.031294822692871094  GigaBytes
Max Memory Allocated: 0.031298160552978516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.03234577178955078  GigaBytes
Max Memory Allocated: 0.05899810791015625  GigaBytes

torch.Size([16799, 500])
torch.Size([12580, 16])
torch.Size([3900, 16])
torch.Size([1082, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.03711986541748047  GigaBytes
Max Memory Allocated: 0.05899810791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03317117691040039  GigaBytes
Max Memory Allocated: 0.06362152099609375  GigaBytes

torch.Size([17277, 500])
torch.Size([11864, 16])
torch.Size([4187, 16])
torch.Size([755, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03772401809692383  GigaBytes
Max Memory Allocated: 0.06362152099609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.028581619262695312  GigaBytes
Max Memory Allocated: 0.06362152099609375  GigaBytes

torch.Size([14901, 500])
torch.Size([9188, 16])
torch.Size([2248, 16])
torch.Size([536, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.031856536865234375  GigaBytes
Max Memory Allocated: 0.06362152099609375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01709538698196411 |0.08679044246673584 |0.1976187825202942 |0.00018596649169921875 |0.005270481109619141 |0.003031015396118164 |
----------------------------------------------------------pseudo_mini_loss sum 2.016139030456543
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  121555
Number of first layer input nodes during this epoch:  63772
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.030224323272705078  GigaBytes
Max Memory Allocated: 0.06362152099609375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006067752838134766
range selection method range initialization spend 7.414817810058594e-05
time for parepare:  6.0558319091796875e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00020933151245117188
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  5.91278076171875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.719329833984375e-05
----------------------check_connections_block total spend ----------------------------- 0.0011935234069824219
generate_one_block  0.0013322830200195312
generate_one_block  0.0012962818145751953
generate_one_block  0.0017178058624267578
generate_one_block  0.001280069351196289
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006310939788818359
gen group dst list time:  4.3392181396484375e-05
time for parepare:  0.0003743171691894531
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00036525726318359375
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  0.00010657310485839844
r_  generation:  0.0006771087646484375
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0002510547637939453
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00030112266540527344
----------------------check_connections_block total spend ----------------------------- 0.0034852027893066406
generate_one_block  0.0017085075378417969
generate_one_block  0.002100706100463867
generate_one_block  0.0015325546264648438
generate_one_block  0.0015888214111328125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012443065643310547
gen group dst list time:  0.00011229515075683594
time for parepare:  0.0010423660278320312
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00033211708068847656
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.0018224716186523438
local_output_nid generation:  0.0001239776611328125
local_in_edges_tensor generation:  0.0003266334533691406
mini_batch_src_global generation:  0.0006005764007568359
r_  generation:  0.00461125373840332
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  0.0003218650817871094
r_  generation:  0.0018622875213623047
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00023603439331054688
mini_batch_src_global generation:  0.00021767616271972656
r_  generation:  0.0017805099487304688
----------------------check_connections_block total spend ----------------------------- 0.016680002212524414
generate_one_block  0.003495931625366211
generate_one_block  0.00549626350402832
generate_one_block  0.002723217010498047
generate_one_block  0.002977609634399414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019690990447998047
gen group dst list time:  0.0003039836883544922
time for parepare:  0.001802206039428711
local_output_nid generation:  0.00023508071899414062
local_in_edges_tensor generation:  0.0007169246673583984
mini_batch_src_global generation:  0.0009200572967529297
r_  generation:  0.008176565170288086
local_output_nid generation:  0.00041413307189941406
local_in_edges_tensor generation:  0.0008037090301513672
mini_batch_src_global generation:  0.0015788078308105469
r_  generation:  0.014536857604980469
local_output_nid generation:  0.00023937225341796875
local_in_edges_tensor generation:  0.0004711151123046875
mini_batch_src_global generation:  0.0008699893951416016
r_  generation:  0.007619142532348633
local_output_nid generation:  0.0003008842468261719
local_in_edges_tensor generation:  0.0005643367767333984
mini_batch_src_global generation:  0.0007290840148925781
r_  generation:  0.0076601505279541016
----------------------check_connections_block total spend ----------------------------- 0.057100534439086914
generate_one_block  0.009949684143066406
generate_one_block  0.015431880950927734
generate_one_block  0.014794588088989258
generate_one_block  0.01192927360534668
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002189159393310547
gen group dst list time:  0.0008029937744140625
time for parepare:  0.0017507076263427734
local_output_nid generation:  0.0008504390716552734
local_in_edges_tensor generation:  0.0015537738800048828
mini_batch_src_global generation:  0.0015125274658203125
r_  generation:  0.016329526901245117
local_output_nid generation:  0.0011749267578125
local_in_edges_tensor generation:  0.002139568328857422
mini_batch_src_global generation:  0.0023102760314941406
r_  generation:  0.02110600471496582
local_output_nid generation:  0.0010519027709960938
local_in_edges_tensor generation:  0.0013546943664550781
mini_batch_src_global generation:  0.0015802383422851562
r_  generation:  0.018146753311157227
local_output_nid generation:  0.0011668205261230469
local_in_edges_tensor generation:  0.0016126632690429688
mini_batch_src_global generation: Using backend: pytorch
 0.0016913414001464844
r_  generation:  0.019789457321166992
----------------------check_connections_block total spend ----------------------------- 0.11241817474365234
generate_one_block  0.02150130271911621
generate_one_block  0.02800130844116211
generate_one_block  0.023996829986572266
generate_one_block  0.025672197341918945
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.030224323272705078  GigaBytes
Max Memory Allocated: 0.06362152099609375  GigaBytes

connection checking time:  0.1896839141845703
block generation total time  0.17290067672729492
average batch blocks generation time:  0.04322516918182373
block dataloader generation time/epoch 0.4044630527496338
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.028221607208251953  GigaBytes
Max Memory Allocated: 0.06362152099609375  GigaBytes

torch.Size([14690, 500])
torch.Size([9292, 16])
torch.Size([2334, 16])
torch.Size([635, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.031472206115722656  GigaBytes
Max Memory Allocated: 0.06362152099609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03189897537231445  GigaBytes
Max Memory Allocated: 0.06362152099609375  GigaBytes

torch.Size([16488, 500])
torch.Size([11780, 16])
torch.Size([4071, 16])
torch.Size([1146, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03656768798828125  GigaBytes
Max Memory Allocated: 0.06362152099609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.028606414794921875  GigaBytes
Max Memory Allocated: 0.06362152099609375  GigaBytes

torch.Size([14836, 500])
torch.Size([8873, 16])
torch.Size([2590, 16])
torch.Size([440, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03188800811767578  GigaBytes
Max Memory Allocated: 0.06362152099609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.031890869140625  GigaBytes
Max Memory Allocated: 0.06362152099609375  GigaBytes

torch.Size([16577, 500])
torch.Size([9922, 16])
torch.Size([3160, 16])
torch.Size([571, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.035616397857666016  GigaBytes
Max Memory Allocated: 0.06362152099609375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011083722114562988 |0.001456618309020996 |0.006245315074920654 |0.00014591217041015625 |0.004203855991363525 |0.005339860916137695 |
----------------------------------------------------------pseudo_mini_loss sum 2.576228380203247
Total (block generation + training)time/epoch 0.5104818344116211
Training time/epoch 0.10510373115539551
Training time without block to device /epoch 0.09927725791931152
Training time without total dataloading part /epoch 0.04772019386291504
load block tensor time/epoch 0.04433488845825195
block to device time/epoch 0.005826473236083984
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  117760
Number of first layer input nodes during this epoch:  62591
