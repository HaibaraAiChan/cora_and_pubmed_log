main start at this time 1648532029.143848
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000152587890625  GigaBytes
Max Memory Allocated: 0.000152587890625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0022017955780029297
range selection method range initialization spend 8.249282836914062e-05
time for parepare:  4.4345855712890625e-05
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.0014421939849853516
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.1682510375976562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.1682510375976562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.1682510375976562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.09808349609375e-05
----------------------check_connections_block total spend ----------------------------- 0.004166364669799805
generate_one_block  0.0012080669403076172
generate_one_block  0.0010089874267578125
generate_one_block  0.0009930133819580078
generate_one_block  0.0009987354278564453
generate_one_block  0.000985860824584961
generate_one_block  0.000993967056274414
generate_one_block  0.0010447502136230469
generate_one_block  0.0009853839874267578
generate_one_block  0.0009772777557373047
generate_one_block  0.0010402202606201172
generate_one_block  0.0009512901306152344
generate_one_block  0.0009419918060302734
generate_one_block  0.0009355545043945312
generate_one_block  0.0009729862213134766
generate_one_block  0.0009965896606445312
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013775825500488281
gen group dst list time:  7.796287536621094e-05
time for parepare:  0.000244140625
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  9.369850158691406e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  8.130073547363281e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  1.430511474609375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  5.125999450683594e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0002110004425048828
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.57763671875e-05
local_output_nid generation:  1.430511474609375e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00019073486328125
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.700920104980469e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.482269287109375e-05
local_output_nid generation:  1.430511474609375e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00018215179443359375
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00014972686767578125
----------------------check_connections_block total spend ----------------------------- 0.004483222961425781
generate_one_block  0.0011229515075683594
generate_one_block  0.0010879039764404297
generate_one_block  0.0010652542114257812
generate_one_block  0.001088857650756836
generate_one_block  0.0010280609130859375
generate_one_block  0.0011339187622070312
generate_one_block  0.001329183578491211
generate_one_block  0.0010805130004882812
generate_one_block  0.0010271072387695312
generate_one_block  0.0012984275817871094
generate_one_block  0.0010693073272705078
generate_one_block  0.00098419189453125
generate_one_block  0.0009741783142089844
generate_one_block  0.0012786388397216797
generate_one_block  0.0011513233184814453
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010559558868408203
gen group dst list time:  0.0001220703125
time for parepare:  0.0007648468017578125
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00026345252990722656
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.000640869140625
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0005269050598144531
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.00040984153747558594
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0002942085266113281
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.0002124309539794922
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0004265308380126953
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  0.00015401840209960938
r_  generation:  0.00156402587890625
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0001289844512939453
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00026154518127441406
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.0013852119445800781
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.00043082237243652344
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00020766258239746094
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.000202178955078125
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  0.00011754035949707031
r_  generation:  0.0011553764343261719
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  0.000133514404296875
r_  generation:  0.0012001991271972656
----------------------check_connections_block total spend ----------------------------- 0.01600503921508789
generate_one_block  0.002658367156982422
generate_one_block  0.0016071796417236328
generate_one_block  0.0014607906341552734
generate_one_block  0.0012738704681396484
generate_one_block  0.0012297630310058594
generate_one_block  0.0014355182647705078
generate_one_block  0.002893209457397461
generate_one_block  0.0010616779327392578
generate_one_block  0.0012211799621582031
generate_one_block  0.0026361942291259766
generate_one_block  0.0014102458953857422
generate_one_block  0.0011758804321289062
generate_one_block  0.0014579296112060547
generate_one_block  0.0023403167724609375
generate_one_block  0.002354860305786133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020759105682373047
gen group dst list time:  0.00031638145446777344
time for parepare:  0.0015861988067626953
local_output_nid generation:  0.00011491775512695312
local_in_edges_tensor generation:  0.0006239414215087891
mini_batch_src_global generation:  0.00048279762268066406
r_  generation:  0.003972768783569336
local_output_nid generation:  8.153915405273438e-05
local_in_edges_tensor generation:  0.0002651214599609375
mini_batch_src_global generation:  0.0003962516784667969
r_  generation:  0.0030112266540527344
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.00024390220642089844
mini_batch_src_global generation:  0.00032639503479003906
r_  generation:  0.0033910274505615234
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  0.00018143653869628906
r_  generation:  0.0011928081512451172
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  0.00012803077697753906
r_  generation:  0.0011899471282958984
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  0.00018668174743652344
r_  generation:  0.002111196517944336
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.00035858154296875
mini_batch_src_global generation:  0.0005497932434082031
r_  generation:  0.0058498382568359375
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  0.00018715858459472656
r_  generation:  0.0004634857177734375
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  0.00015401840209960938
r_  generation:  0.0017275810241699219
local_output_nid generation:  0.0002002716064453125
local_in_edges_tensor generation:  0.00043129920959472656
mini_batch_src_global generation:  0.0006687641143798828
r_  generation:  0.007350921630859375
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  0.0004050731658935547
r_  generation:  0.0027441978454589844
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.0009622573852539062
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  0.00016808509826660156
r_  generation:  0.001768350601196289
local_output_nid generation:  0.00016355514526367188
local_in_edges_tensor generation:  0.00035262107849121094
mini_batch_src_global generation:  0.00040221214294433594
r_  generation:  0.0050199031829833984
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.0003132820129394531
mini_batch_src_global generation:  0.0005276203155517578
r_  generation:  0.004642963409423828
----------------------check_connections_block total spend ----------------------------- 0.06913948059082031
generate_one_block  0.007124900817871094
generate_one_block  0.004896402359008789
generate_one_block  0.00536799430847168
generate_one_block  0.0022780895233154297
generate_one_block  0.0025510787963867188
generate_one_block  0.00365447998046875
generate_one_block  0.008862733840942383
generate_one_block  0.0014357566833496094
generate_one_block  0.0036051273345947266
generate_one_block  0.011437416076660156
generate_one_block  0.0045282840728759766
generate_one_block  0.002135753631591797
generate_one_block  0.003286123275756836
generate_one_block  0.007929325103759766
generate_one_block  0.007177591323852539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002264261245727539
gen group dst list time:  0.0015990734100341797
time for parepare:  0.0017654895782470703
local_output_nid generation:  0.0004951953887939453
local_in_edges_tensor generation:  0.0014700889587402344
mini_batch_src_global generation:  0.0013294219970703125
r_  generation:  0.013106584548950195
local_output_nid generation:  0.00037384033203125
local_in_edges_tensor generation:  0.00083160400390625
mini_batch_src_global generation:  0.0011181831359863281
r_  generation:  0.009952306747436523
local_output_nid generation:  0.0004756450653076172
local_in_edges_tensor generation:  0.0008039474487304688
mini_batch_src_global generation:  0.0008580684661865234
r_  generation:  0.010695219039916992
local_output_nid generation:  0.00016760826110839844
local_in_edges_tensor generation:  0.00035452842712402344
mini_batch_src_global generation:  0.00051116943359375
r_  generation:  0.003889799118041992
local_output_nid generation:  0.0002741813659667969
local_in_edges_tensor generation:  0.0005011558532714844
mini_batch_src_global generation:  0.00048089027404785156
r_  generation:  0.005543231964111328
local_output_nid generation:  0.0003056526184082031
local_in_edges_tensor generation:  0.0005402565002441406
mini_batch_src_global generation:  0.0006074905395507812
r_  generation:  0.006932735443115234
local_output_nid generation:  0.0005793571472167969
local_in_edges_tensor generation:  0.0010831356048583984
mini_batch_src_global generation:  0.0013921260833740234
r_  generation:  0.013422727584838867
local_output_nid generation:  9.512901306152344e-05
local_in_edges_tensor generation:  0.000240325927734375
mini_batch_src_global generation:  0.000457763671875
r_  generation:  0.002465486526489258
local_output_nid generation:  0.0003199577331542969
local_in_edges_tensor generation:  0.0005574226379394531
mini_batch_src_global generation:  0.0006268024444580078
r_  generation:  0.007460832595825195
local_output_nid generation:  0.0008656978607177734
local_in_edges_tensor generation:  0.0013992786407470703
mini_batch_src_global generation:  0.0017764568328857422
r_  generation:  0.018653154373168945
local_output_nid generation:  0.00034809112548828125
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.0009331703186035156
r_  generation:  0.008540868759155273
local_output_nid generation:  0.0001983642578125
local_in_edges_tensor generation:  0.0003685951232910156
mini_batch_src_global generation:  0.0004756450653076172
r_  generation:  0.003870725631713867
local_output_nid generation:  0.0003173351287841797
local_in_edges_tensor generation:  0.0005419254302978516
mini_batch_src_global generation:  0.0006780624389648438
r_  generation:  0.007882833480834961
local_output_nid generation:  0.0006737709045410156
local_in_edges_tensor generation:  0.0010063648223876953
mini_batch_src_global generation:  0.0013914108276367188
r_  generation:  0.014810323715209961
local_output_nid generation:  0.0004012584686279297
local_in_edges_tensor generation:  0.0006771087646484375
mini_batch_src_global generation:  0.0009505748748779297
r_  generation:  0.010170698165893555
----------------------check_connections_block total spend ----------------------------- 0.20409131050109863
generate_one_block  0.01817488670349121
generate_one_block  0.01478719711303711
generate_one_block  0.014678239822387695
generate_one_block  0.0065460205078125
generate_one_block  0.008359432220458984
generate_one_block  0.010894775390625
generate_one_block  0.017066001892089844
generate_one_block  0.003942251205444336
generate_one_block  0.011026620864868164
generate_one_block  0.02455759048461914
generate_one_block  0.012052536010742188
generate_one_block  0.005984783172607422
generate_one_block  0.011423110961914062
generate_one_block  0.019069671630859375
generate_one_block  0.013935089111328125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000152587890625  GigaBytes
Max Memory Allocated: 0.000152587890625  GigaBytes

connection checking time:  0.2937190532684326
block generation total time  0.3117060661315918
average batch blocks generation time:  0.020780404408772785
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.026001453399658203  GigaBytes
Max Memory Allocated: 0.026001453399658203  GigaBytes

torch.Size([13491, 500])
torch.Size([5880, 32])
torch.Size([1485, 32])
torch.Size([187, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.029661178588867188  GigaBytes
Max Memory Allocated: 0.030092239379882812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.0201873779296875  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([10428, 500])
torch.Size([4099, 32])
torch.Size([981, 32])
torch.Size([159, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02277231216430664  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02011585235595703  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([10434, 500])
torch.Size([5184, 32])
torch.Size([819, 32])
torch.Size([126, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02304363250732422  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.010866641998291016  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([5604, 500])
torch.Size([1810, 32])
torch.Size([517, 32])
torch.Size([121, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.01207113265991211  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.014401435852050781  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([7472, 500])
torch.Size([2943, 32])
torch.Size([354, 32])
torch.Size([105, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.01599597930908203  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.01674175262451172  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([8693, 500])
torch.Size([3567, 32])
torch.Size([813, 32])
torch.Size([156, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.018920421600341797  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.022304058074951172  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([11514, 500])
torch.Size([6758, 32])
torch.Size([1761, 32])
torch.Size([422, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.026680946350097656  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.006072044372558594  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([3060, 500])
torch.Size([833, 32])
torch.Size([158, 32])
torch.Size([62, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.006604194641113281  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.016001224517822266  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([8290, 500])
torch.Size([3261, 32])
torch.Size([484, 32])
torch.Size([83, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.017854690551757812  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.03031158447265625  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([15720, 500])
torch.Size([10373, 32])
torch.Size([2514, 32])
torch.Size([482, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.03733253479003906  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.015877723693847656  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([8196, 500])
torch.Size([3735, 32])
torch.Size([695, 32])
torch.Size([142, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.018114089965820312  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.011080741882324219  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([5719, 500])
torch.Size([1859, 32])
torch.Size([325, 32])
torch.Size([97, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.012174606323242188  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.017159461975097656  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([8902, 500])
torch.Size([3382, 32])
torch.Size([434, 32])
torch.Size([69, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.019048213958740234  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.027206897735595703  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([14159, 500])
torch.Size([7730, 32])
torch.Size([2032, 32])
torch.Size([405, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.03208351135253906  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.017541885375976562  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([9025, 500])
torch.Size([4574, 32])
torch.Size([1484, 32])
torch.Size([316, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.020728111267089844  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007650073369344076 |0.023648468653361003 |0.0565888245900472 |0.00012995402018229168 |0.004602114359537761 |0.0030989646911621094 |
----------------------------------------------------------pseudo_mini_loss sum 2.737616777420044
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  224840
Number of first layer input nodes during this epoch:  140707
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.018779277801513672  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004975795745849609
range selection method range initialization spend 5.364418029785156e-05
time for parepare:  4.9591064453125e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.1682510375976562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.1682510375976562e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1219253540039062e-05
----------------------check_connections_block total spend ----------------------------- 0.0026445388793945312
generate_one_block  0.0011012554168701172
generate_one_block  0.0012722015380859375
generate_one_block  0.0010013580322265625
generate_one_block  0.0009732246398925781
generate_one_block  0.0010089874267578125
generate_one_block  0.0009899139404296875
generate_one_block  0.0009741783142089844
generate_one_block  0.0009744167327880859
generate_one_block  0.0009930133819580078
generate_one_block  0.0009756088256835938
generate_one_block  0.0009396076202392578
generate_one_block  0.00096893310546875
generate_one_block  0.0009906291961669922
generate_one_block  0.0009520053863525391
generate_one_block  0.0009467601776123047
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006546974182128906
gen group dst list time:  8.058547973632812e-05
time for parepare:  0.000274658203125
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  8.535385131835938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  9.560585021972656e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001709461212158203
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.031990051269531e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  5.364418029785156e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  7.009506225585938e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00013399124145507812
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00028395652770996094
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00014925003051757812
----------------------check_connections_block total spend ----------------------------- 0.004625558853149414
generate_one_block  0.0011019706726074219
generate_one_block  0.0010874271392822266
generate_one_block  0.001186370849609375
generate_one_block  0.001062154769897461
generate_one_block  0.0010416507720947266
generate_one_block  0.0010058879852294922
generate_one_block  0.0010597705841064453
generate_one_block  0.0010271072387695312
generate_one_block  0.0010273456573486328
generate_one_block  0.0010533332824707031
generate_one_block  0.0010142326354980469
generate_one_block  0.0010142326354980469
generate_one_block  0.0011496543884277344
generate_one_block  0.0012841224670410156
generate_one_block  0.001100301742553711
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011947154998779297
gen group dst list time:  0.0001277923583984375
time for parepare:  0.0007674694061279297
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0002675056457519531
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0004367828369140625
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0005104541778564453
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  0.00014853477478027344
r_  generation:  0.0012340545654296875
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0003941059112548828
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00025963783264160156
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00018668174743652344
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0002846717834472656
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0003039836883544922
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.00043320655822753906
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0002803802490234375
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00018668174743652344
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0005519390106201172
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0006177425384521484
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00019097328186035156
r_  generation:  0.0020112991333007812
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  0.00012922286987304688
r_  generation:  0.0009047985076904297
----------------------check_connections_block total spend ----------------------------- 0.015556097030639648
generate_one_block  0.0015902519226074219
generate_one_block  0.0015022754669189453
generate_one_block  0.0025556087493896484
generate_one_block  0.0016398429870605469
generate_one_block  0.0013439655303955078
generate_one_block  0.0011463165283203125
generate_one_block  0.0012807846069335938
generate_one_block  0.0013034343719482422
generate_one_block  0.0014891624450683594
generate_one_block  0.0013666152954101562
generate_one_block  0.0011763572692871094
generate_one_block  0.0017042160034179688
generate_one_block  0.0016512870788574219
generate_one_block  0.003400564193725586
generate_one_block  0.001974344253540039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002045869827270508
gen group dst list time:  0.0003311634063720703
time for parepare:  0.0014040470123291016
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.0004925727844238281
mini_batch_src_global generation:  0.00028395652770996094
r_  generation:  0.0026493072509765625
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00024390220642089844
mini_batch_src_global generation:  0.00031256675720214844
r_  generation:  0.002782106399536133
local_output_nid generation:  0.0001933574676513672
local_in_edges_tensor generation:  0.0004429817199707031
mini_batch_src_global generation:  0.0007288455963134766
r_  generation:  0.006821632385253906
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.0002803802490234375
r_  generation:  0.001613616943359375
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  0.0001742839813232422
r_  generation:  0.0013537406921386719
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  0.00014328956604003906
r_  generation:  0.0012412071228027344
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.00017189979553222656
r_  generation:  0.0016219615936279297
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  0.00017189979553222656
r_  generation:  0.0016493797302246094
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  0.0002789497375488281
r_  generation:  0.0028862953186035156
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  0.00018906593322753906
r_  generation:  0.00128936767578125
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.0014472007751464844
local_output_nid generation:  0.00011491775512695312
local_in_edges_tensor generation:  0.0002815723419189453
mini_batch_src_global generation:  0.0002894401550292969
r_  generation:  0.003342866897583008
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.0002570152282714844
mini_batch_src_global generation:  0.0003025531768798828
r_  generation:  0.0028641223907470703
local_output_nid generation:  0.0001571178436279297
local_in_edges_tensor generation:  0.0003802776336669922
mini_batch_src_global generation:  0.0005164146423339844
r_  generation:  0.005593776702880859
local_output_nid generation:  0.00013971328735351562
local_in_edges_tensor generation:  0.0003509521484375
mini_batch_src_global generation:  0.000583648681640625
r_  generation:  0.005153179168701172
----------------------check_connections_block total spend ----------------------------- 0.06451678276062012
generate_one_block  0.005036354064941406
generate_one_block  0.004801034927368164
generate_one_block  0.00982809066772461
generate_one_block  0.002992868423461914
generate_one_block  0.002676248550415039
generate_one_block  0.0026144981384277344
generate_one_block  0.0030317306518554688
generate_one_block  0.004007577896118164
generate_one_block  0.0048923492431640625
generate_one_block  0.0027675628662109375
generate_one_block  0.002856731414794922
generate_one_block  0.00571441650390625
generate_one_block  0.004777193069458008
generate_one_block  0.008138656616210938
generate_one_block  0.008239269256591797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022535324096679688
gen group dst list time:  0.00139617919921875
time for parepare:  0.0019156932830810547
local_output_nid generation:  0.00041365623474121094
local_in_edges_tensor generation:  0.0012485980987548828
mini_batch_src_global generation:  0.001051187515258789
r_  generation:  0.010044097900390625
local_output_nid generation:  0.00040984153747558594
local_in_edges_tensor generation:  0.0008397102355957031
mini_batch_src_global generation:  0.0010600090026855469
r_  generation:  0.010106086730957031
local_output_nid generation:  0.0006139278411865234
local_in_edges_tensor generation:  0.001211404800415039
mini_batch_src_global generation:  0.0013470649719238281
r_  generation:  0.016097068786621094
local_output_nid generation:  0.0002593994140625
local_in_edges_tensor generation:  0.0004863739013671875
mini_batch_src_global generation:  0.0006747245788574219
r_  generation:  0.005509853363037109
local_output_nid generation:  0.0002722740173339844
local_in_edges_tensor generation:  0.0004968643188476562
mini_batch_src_global generation:  0.0005745887756347656
r_  generation:  0.005982875823974609
local_output_nid generation:  0.0002720355987548828
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0005154609680175781
r_  generation:  0.005355358123779297
local_output_nid generation:  0.0002772808074951172
local_in_edges_tensor generation:  0.0005135536193847656
mini_batch_src_global generation:  0.0006685256958007812
r_  generation:  0.007173299789428711
local_output_nid generation:  0.0002720355987548828
local_in_edges_tensor generation:  0.0004794597625732422
mini_batch_src_global generation:  0.0005927085876464844
r_  generation:  0.005928993225097656
local_output_nid generation:  0.00034046173095703125
local_in_edges_tensor generation:  0.0006213188171386719
mini_batch_src_global generation:  0.0007693767547607422
r_  generation:  0.008578300476074219
local_output_nid generation:  0.000244140625
local_in_edges_tensor generation:  0.00044083595275878906
mini_batch_src_global generation:  0.000553131103515625
r_  generation:  0.005131244659423828
local_output_nid generation:  0.00031447410583496094
local_in_edges_tensor generation:  0.0005238056182861328
mini_batch_src_global generation:  0.0006146430969238281
r_  generation:  0.0068607330322265625
local_output_nid generation:  0.0005042552947998047
local_in_edges_tensor generation:  0.0008077621459960938
mini_batch_src_global generation:  0.0009944438934326172
r_  generation:  0.011427164077758789
local_output_nid generation:  0.000514984130859375
local_in_edges_tensor generation:  0.0008187294006347656
mini_batch_src_global generation:  0.0010161399841308594
r_  generation:  0.009668350219726562
local_output_nid generation:  0.0004878044128417969
local_in_edges_tensor generation:  0.0007936954498291016
mini_batch_src_global generation:  0.0010504722595214844
r_  generation:  0.01140451431274414
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0013043880462646484
mini_batch_src_global generation:  0.0013110637664794922
r_  generation:  0.01629805564880371
----------------------check_connections_block total spend ----------------------------- 0.19986200332641602
generate_one_block  0.01437520980834961
generate_one_block  0.014338254928588867
generate_one_block  0.022160768508911133
generate_one_block  0.00811624526977539
generate_one_block  0.010727405548095703
generate_one_block  0.007926464080810547
generate_one_block  0.010684490203857422
generate_one_block  0.008710145950317383
generate_one_block  0.012166261672973633
generate_one_block  0.007292032241821289
generate_one_block  0.009792089462280273
generate_one_block  0.015020132064819336
generate_one_block  0.013228654861450195
generate_one_block  0.014749288558959961
generate_one_block  0.021657228469848633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.018779277801513672  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

connection checking time:  0.2845604419708252
block generation total time  0.3046598434448242
average batch blocks generation time:  0.020310656229654948
block dataloader generation time/epoch 0.6494097709655762
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.020519733428955078  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([10512, 500])
torch.Size([4478, 32])
torch.Size([775, 32])
torch.Size([159, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.023131370544433594  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.02052927017211914  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

torch.Size([10517, 500])
torch.Size([4676, 32])
torch.Size([778, 32])
torch.Size([200, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.023242950439453125  GigaBytes
Max Memory Allocated: 0.04522371292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.028554916381835938  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

torch.Size([14491, 500])
torch.Size([7805, 32])
torch.Size([2401, 32])
torch.Size([361, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03370857238769531  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.014081478118896484  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

torch.Size([7139, 500])
torch.Size([2573, 32])
torch.Size([566, 32])
torch.Size([157, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.015680789947509766  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.014290809631347656  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

torch.Size([7242, 500])
torch.Size([2512, 32])
torch.Size([408, 32])
torch.Size([124, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.01577615737915039  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.013988018035888672  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

torch.Size([7094, 500])
torch.Size([2635, 32])
torch.Size([385, 32])
torch.Size([65, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.01545572280883789  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.01800680160522461  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

torch.Size([9214, 500])
torch.Size([2814, 32])
torch.Size([593, 32])
torch.Size([88, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.01973724365234375  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.015972614288330078  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

torch.Size([8145, 500])
torch.Size([2762, 32])
torch.Size([641, 32])
torch.Size([97, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.017671585083007812  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.017910003662109375  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

torch.Size([9118, 500])
torch.Size([3723, 32])
torch.Size([788, 32])
torch.Size([110, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.020190715789794922  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.013384342193603516  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

torch.Size([6774, 500])
torch.Size([2599, 32])
torch.Size([428, 32])
torch.Size([130, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.014890193939208984  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.01423501968383789  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

torch.Size([7202, 500])
torch.Size([3049, 32])
torch.Size([361, 32])
torch.Size([86, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.015911102294921875  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.024074554443359375  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

torch.Size([12398, 500])
torch.Size([5228, 32])
torch.Size([1330, 32])
torch.Size([165, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.027315139770507812  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.02143096923828125  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

torch.Size([11011, 500])
torch.Size([5166, 32])
torch.Size([1118, 32])
torch.Size([267, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.024548053741455078  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.01943206787109375  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

torch.Size([9840, 500])
torch.Size([5284, 32])
torch.Size([1884, 32])
torch.Size([521, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.0233001708984375  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.02850627899169922  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

torch.Size([14180, 500])
torch.Size([8994, 32])
torch.Size([1622, 32])
torch.Size([353, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.034288883209228516  GigaBytes
Max Memory Allocated: 0.04752922058105469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005164702733357747 |0.0008830229441324869 |0.005497916539510091 |0.00014158884684244792 |0.00518337885538737 |0.0021932125091552734 |
----------------------------------------------------------pseudo_mini_loss sum 2.203890323638916
Total (block generation + training)time/epoch 0.922696590423584
Training time/epoch 0.2729628086090088
Training time without block to device /epoch 0.2597174644470215
Training time without total dataloading part /epoch 0.1645364761352539
load block tensor time/epoch 0.07747054100036621
block to device time/epoch 0.013245344161987305
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  226493
Number of first layer input nodes during this epoch:  144877
