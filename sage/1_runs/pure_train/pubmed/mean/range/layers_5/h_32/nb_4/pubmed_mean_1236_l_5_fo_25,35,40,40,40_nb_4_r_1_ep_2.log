main start at this time 1648531995.9457278
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000152587890625  GigaBytes
Max Memory Allocated: 0.000152587890625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0028607845306396484
range selection method range initialization spend 8.392333984375e-05
time for parepare:  4.363059997558594e-05
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0012202262878417969
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  6.389617919921875e-05
----------------------check_connections_block total spend ----------------------------- 0.001878499984741211
generate_one_block  0.0013298988342285156
generate_one_block  0.0011279582977294922
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0015590190887451172
gen group dst list time:  2.384185791015625e-05
time for parepare:  0.00024080276489257812
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0005707740783691406
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0006856918334960938
----------------------check_connections_block total spend ----------------------------- 0.0023622512817382812
generate_one_block  0.0018513202667236328
generate_one_block  0.0018894672393798828
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010395050048828125
gen group dst list time:  6.365776062011719e-05
time for parepare:  0.0007028579711914062
local_output_nid generation:  8.463859558105469e-05
local_in_edges_tensor generation:  0.00037860870361328125
mini_batch_src_global generation:  0.0002830028533935547
r_  generation:  0.0035741329193115234
local_output_nid generation:  0.00010371208190917969
local_in_edges_tensor generation:  0.00030732154846191406
mini_batch_src_global generation:  0.0005137920379638672
r_  generation:  0.004029273986816406
----------------------check_connections_block total spend ----------------------------- 0.012002229690551758
generate_one_block  0.00641942024230957
generate_one_block  0.005977153778076172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002123117446899414
gen group dst list time:  0.0001804828643798828
time for parepare:  0.0013620853424072266
local_output_nid generation:  0.0003437995910644531
local_in_edges_tensor generation:  0.0010373592376708984
mini_batch_src_global generation:  0.0013377666473388672
r_  generation:  0.01283717155456543
local_output_nid generation:  0.0004048347473144531
local_in_edges_tensor generation:  0.0008435249328613281
mini_batch_src_global generation:  0.0015082359313964844
r_  generation:  0.013937950134277344
----------------------check_connections_block total spend ----------------------------- 0.040120601654052734
generate_one_block  0.01888895034790039
generate_one_block  0.019773483276367188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018155574798583984
gen group dst list time:  0.00048422813415527344
time for parepare:  0.0014538764953613281
local_output_nid generation:  0.0009324550628662109
local_in_edges_tensor generation:  0.0019521713256835938
mini_batch_src_global generation:  0.002012014389038086
r_  generation:  0.021977663040161133
local_output_nid generation:  0.0011031627655029297
local_in_edges_tensor generation:  0.0021741390228271484
mini_batch_src_global generation:  0.002668142318725586
r_  generation:  0.022711753845214844
----------------------check_connections_block total spend ----------------------------- 0.06728076934814453
generate_one_block  0.027437448501586914
generate_one_block  0.02854466438293457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000152587890625  GigaBytes
Max Memory Allocated: 0.000152587890625  GigaBytes

connection checking time:  0.1217658519744873
block generation total time  0.11078190803527832
average batch blocks generation time:  0.05539095401763916
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03433656692504883  GigaBytes
Max Memory Allocated: 0.03433656692504883  GigaBytes

torch.Size([17702, 500])
torch.Size([13294, 32])
torch.Size([5121, 32])
torch.Size([1264, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.04447507858276367  GigaBytes
Max Memory Allocated: 0.044516563415527344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.03452587127685547  GigaBytes
Max Memory Allocated: 0.06670808792114258  GigaBytes

torch.Size([17577, 500])
torch.Size([14084, 32])
torch.Size([5450, 32])
torch.Size([1473, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.04518842697143555  GigaBytes
Max Memory Allocated: 0.06670808792114258  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01944148540496826 |0.17216801643371582 |0.38796985149383545 |0.00019538402557373047 |0.007498741149902344 |0.0038726329803466797 |
----------------------------------------------------------pseudo_mini_loss sum 2.9539706707000732
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  76320
Number of first layer input nodes during this epoch:  35279
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.03708839416503906  GigaBytes
Max Memory Allocated: 0.06670808792114258  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004756450653076172
range selection method range initialization spend 5.1975250244140625e-05
time for parepare:  4.553794860839844e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  5.6743621826171875e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.890296936035156e-05
----------------------check_connections_block total spend ----------------------------- 0.0006496906280517578
generate_one_block  0.0011327266693115234
generate_one_block  0.0011081695556640625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004820823669433594
gen group dst list time:  2.4318695068359375e-05
time for parepare:  0.0002429485321044922
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0004703998565673828
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation: Using backend: pytorch
 7.987022399902344e-05
r_  generation:  0.0006718635559082031
----------------------check_connections_block total spend ----------------------------- 0.0022759437561035156
generate_one_block  0.0016722679138183594
generate_one_block  0.0019223690032958984
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001073598861694336
gen group dst list time:  6.866455078125e-05
time for parepare:  0.0006730556488037109
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.0003457069396972656
mini_batch_src_global generation:  0.0002779960632324219
r_  generation:  0.002912282943725586
local_output_nid generation:  0.00011134147644042969
local_in_edges_tensor generation:  0.0002999305725097656
mini_batch_src_global generation:  0.0004639625549316406
r_  generation:  0.004472970962524414
----------------------check_connections_block total spend ----------------------------- 0.011556863784790039
generate_one_block  0.004784822463989258
generate_one_block  0.0064237117767333984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017852783203125
gen group dst list time:  0.0001735687255859375
time for parepare:  0.0012083053588867188
local_output_nid generation:  0.0003046989440917969
local_in_edges_tensor generation:  0.0010137557983398438
mini_batch_src_global generation:  0.0009903907775878906
r_  generation:  0.011890172958374023
local_output_nid generation:  0.00040435791015625
local_in_edges_tensor generation:  0.0008721351623535156
mini_batch_src_global generation:  0.00144195556640625
r_  generation:  0.01397395133972168
----------------------check_connections_block total spend ----------------------------- 0.038704633712768555
generate_one_block  0.016310691833496094
generate_one_block  0.019539594650268555
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017480850219726562
gen group dst list time:  0.0004937648773193359
time for parepare:  0.0014505386352539062
local_output_nid generation:  0.0008945465087890625
local_in_edges_tensor generation:  0.001924276351928711
mini_batch_src_global generation:  0.0017435550689697266
r_  generation:  0.02142477035522461
local_output_nid generation:  0.001066446304321289
local_in_edges_tensor generation:  0.002303600311279297
mini_batch_src_global generation:  0.0024242401123046875
r_  generation:  0.022617578506469727
----------------------check_connections_block total spend ----------------------------- 0.06596016883850098
generate_one_block  0.02761220932006836
generate_one_block  0.030498981475830078
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.03708839416503906  GigaBytes
Max Memory Allocated: 0.06670808792114258  GigaBytes

connection checking time:  0.11849761009216309
block generation total time  0.1087646484375
average batch blocks generation time:  0.05438232421875
block dataloader generation time/epoch 0.25997042655944824
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.03472328186035156  GigaBytes
Max Memory Allocated: 0.0670008659362793  GigaBytes

torch.Size([17507, 500])
torch.Size([12911, 32])
torch.Size([4784, 32])
torch.Size([1155, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.0444340705871582  GigaBytes
Max Memory Allocated: 0.0670008659362793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.034842491149902344  GigaBytes
Max Memory Allocated: 0.0670018196105957  GigaBytes

torch.Size([17818, 500])
torch.Size([14238, 32])
torch.Size([5616, 32])
torch.Size([1550, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.045735836029052734  GigaBytes
Max Memory Allocated: 0.0670018196105957  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012281537055969238 |0.0013315677642822266 |0.005626678466796875 |0.00014328956604003906 |0.005532503128051758 |0.0053784847259521484 |
----------------------------------------------------------pseudo_mini_loss sum 3.0992932319641113
Total (block generation + training)time/epoch 0.3184640407562256
Training time/epoch 0.05817818641662598
Training time without block to device /epoch 0.05551505088806152
Training time without total dataloading part /epoch 0.027983427047729492
load block tensor time/epoch 0.024563074111938477
block to device time/epoch 0.002663135528564453
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  75934
Number of first layer input nodes during this epoch:  35325
