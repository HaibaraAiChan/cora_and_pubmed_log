main start at this time 1648532017.5496812
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000152587890625  GigaBytes
Max Memory Allocated: 0.000152587890625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0020411014556884766
range selection method range initialization spend 8.20159912109375e-05
time for parepare:  4.839897155761719e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0035152435302734375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1457672119140625e-05
----------------------check_connections_block total spend ----------------------------- 0.005361795425415039
generate_one_block  0.0013480186462402344
generate_one_block  0.0010752677917480469
generate_one_block  0.0010514259338378906
generate_one_block  0.0010559558868408203
generate_one_block  0.0010554790496826172
generate_one_block  0.0010361671447753906
generate_one_block  0.0010559558868408203
generate_one_block  0.0010967254638671875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012011528015136719
gen group dst list time:  4.9591064453125e-05
time for parepare:  0.0002574920654296875
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0001976490020751953
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001366138458251953
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001251697540283203
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00024890899658203125
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00022649765014648438
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00011444091796875
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0002155303955078125
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00015997886657714844
----------------------check_connections_block total spend ----------------------------- 0.003537416458129883
generate_one_block  0.0012807846069335938
generate_one_block  0.0012111663818359375
generate_one_block  0.001184701919555664
generate_one_block  0.0013675689697265625
generate_one_block  0.001361846923828125
generate_one_block  0.0011739730834960938
generate_one_block  0.0013647079467773438
generate_one_block  0.0012552738189697266
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011818408966064453
gen group dst list time:  9.34600830078125e-05
time for parepare:  0.0007824897766113281
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00027823448181152344
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.0012087821960449219
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.0007073879241943359
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0006113052368164062
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  0.00018024444580078125
r_  generation:  0.0017426013946533203
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0015904903411865234
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0006387233734130859
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  0.0001308917999267578
r_  generation:  0.0013859272003173828
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  0.0001621246337890625
r_  generation:  0.0013012886047363281
----------------------check_connections_block total spend ----------------------------- 0.01523137092590332
generate_one_block  0.0033538341522216797
generate_one_block  0.0017757415771484375
generate_one_block  0.0016281604766845703
generate_one_block  0.002981901168823242
generate_one_block  0.0027675628662109375
generate_one_block  0.0016913414001464844
generate_one_block  0.002550363540649414
generate_one_block  0.0023696422576904297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002088785171508789
gen group dst list time:  0.00026917457580566406
time for parepare:  0.0015916824340820312
local_output_nid generation:  0.00019073486328125
local_in_edges_tensor generation:  0.0007343292236328125
mini_batch_src_global generation:  0.0008375644683837891
r_  generation:  0.006865739822387695
local_output_nid generation:  0.00011301040649414062
local_in_edges_tensor generation:  0.0003228187561035156
mini_batch_src_global generation:  0.00061798095703125
r_  generation:  0.004504203796386719
local_output_nid generation:  9.846687316894531e-05
local_in_edges_tensor generation:  0.0002796649932861328
mini_batch_src_global generation:  0.0003516674041748047
r_  generation:  0.002862215042114258
local_output_nid generation:  0.00015425682067871094
local_in_edges_tensor generation:  0.0003695487976074219
mini_batch_src_global generation:  0.0005486011505126953
r_  generation:  0.0061206817626953125
local_output_nid generation:  0.0002143383026123047
local_in_edges_tensor generation:  0.0004987716674804688
mini_batch_src_global generation:  0.0009121894836425781
r_  generation:  0.007884979248046875
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.0004725456237792969
r_  generation:  0.0036478042602539062
local_output_nid generation:  0.0001919269561767578
local_in_edges_tensor generation:  0.00041413307189941406
mini_batch_src_global generation:  0.0005605220794677734
r_  generation:  0.006264925003051758
local_output_nid generation:  0.00012373924255371094
local_in_edges_tensor generation:  0.0003190040588378906
mini_batch_src_global generation:  0.0005433559417724609
r_  generation:  0.0046689510345458984
----------------------check_connections_block total spend ----------------------------- 0.065032958984375
generate_one_block  0.009946107864379883
generate_one_block  0.006519317626953125
generate_one_block  0.004807949066162109
generate_one_block  0.009787797927856445
generate_one_block  0.011915922164916992
generate_one_block  0.006425142288208008
generate_one_block  0.009345531463623047
generate_one_block  0.006980419158935547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0035552978515625
gen group dst list time:  0.0032396316528320312
time for parepare:  0.003923892974853516
local_output_nid generation:  0.0013232231140136719
local_in_edges_tensor generation:  0.0020287036895751953
mini_batch_src_global generation:  0.002376556396484375
r_  generation:  0.01777482032775879
local_output_nid generation:  0.0007467269897460938
local_in_edges_tensor generation:  0.001329183578491211
mini_batch_src_global generation:  0.0017313957214355469
r_  generation:  0.013718366622924805
local_output_nid generation:  0.0006403923034667969
local_in_edges_tensor generation:  0.0008714199066162109
mini_batch_src_global generation:  0.0009148120880126953
r_  generation:  0.009448528289794922
local_output_nid generation:  0.0008282661437988281
local_in_edges_tensor generation:  0.0010225772857666016
mini_batch_src_global generation:  0.0013475418090820312
r_  generation:  0.015410900115966797
local_output_nid generation:  0.0011162757873535156
local_in_edges_tensor generation:  0.0019106864929199219
mini_batch_src_global generation:  0.0018591880798339844
r_  generation:  0.01969432830810547
local_output_nid generation:  0.0006382465362548828
local_in_edges_tensor generation:  0.0008394718170166016
mini_batch_src_global generation:  0.0012197494506835938
r_  generation:  0.012320280075073242
local_output_nid generation:  0.0010409355163574219
local_in_edges_tensor generation:  0.0014147758483886719
mini_batch_src_global generation:  0.0013840198516845703
r_  generation:  0.0180971622467041
local_output_nid generation:  0.0004639625549316406
local_in_edges_tensor generation:  0.0007038116455078125
mini_batch_src_global generation:  0.0011184215545654297
r_  generation:  0.010827064514160156
----------------------check_connections_block total spend ----------------------------- 0.17946791648864746
generate_one_block  0.02396368980407715
generate_one_block  0.0185544490814209
generate_one_block  0.015269279479980469
generate_one_block  0.017936229705810547
generate_one_block  0.02653813362121582
generate_one_block  0.0170133113861084
generate_one_block  0.02333855628967285
generate_one_block  0.014488935470581055
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000152587890625  GigaBytes
Max Memory Allocated: 0.000152587890625  GigaBytes

connection checking time:  0.26326966285705566
block generation total time  0.2521493434906006
average batch blocks generation time:  0.03151866793632507
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.03008890151977539  GigaBytes
Max Memory Allocated: 0.03008890151977539  GigaBytes

torch.Size([15676, 500])
torch.Size([8340, 32])
torch.Size([2475, 32])
torch.Size([345, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036380767822265625  GigaBytes
Max Memory Allocated: 0.03643321990966797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.024194717407226562  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

torch.Size([12571, 500])
torch.Size([6272, 32])
torch.Size([1272, 32])
torch.Size([244, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.027942657470703125  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.0206298828125  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

torch.Size([10734, 500])
torch.Size([5114, 32])
torch.Size([1105, 32])
torch.Size([261, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.02371692657470703  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.023319721221923828  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

torch.Size([12050, 500])
torch.Size([7081, 32])
torch.Size([1891, 32])
torch.Size([481, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.02794647216796875  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.03045940399169922  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

torch.Size([15796, 500])
torch.Size([10629, 32])
torch.Size([2660, 32])
torch.Size([520, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.0382390022277832  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.021477222442626953  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

torch.Size([11150, 500])
torch.Size([5254, 32])
torch.Size([1019, 32])
torch.Size([239, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.024629592895507812  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.03024005889892578  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

torch.Size([15442, 500])
torch.Size([9305, 32])
torch.Size([2404, 32])
torch.Size([476, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.036809444427490234  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.017618656158447266  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

torch.Size([9066, 500])
torch.Size([4570, 32])
torch.Size([1480, 32])
torch.Size([318, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.020803451538085938  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009793132543563843 |0.04418817162513733 |0.10366439819335938 |0.00017052888870239258 |0.006470829248428345 |0.003329753875732422 |
----------------------------------------------------------pseudo_mini_loss sum 2.416172742843628
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  176596
Number of first layer input nodes during this epoch:  102485
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.018856048583984375  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005648136138916016
range selection method range initialization spend 6.699562072753906e-05
time for parepare:  6.079673767089844e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.5510787963867188e-05
----------------------check_connections_block total spend ----------------------------- 0.0019180774688720703
generate_one_block  0.0016067028045654297
generate_one_block  0.0012848377227783203
generate_one_block  0.0012204647064208984
generate_one_block  0.0012335777282714844
generate_one_block  0.0012364387512207031
generate_one_block  0.0012238025665283203
generate_one_block  0.0012655258178710938
generate_one_block  0.001359701156616211
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006573200225830078
gen group dst list time:  6.556510925292969e-05
time for parepare:  0.0003790855407714844
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00020313262939453125
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0002834796905517578
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00011181831359863281
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0001277923583984375
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00013375282287597656
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00012564659118652344
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0005068778991699219
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00018787384033203125
----------------------check_connections_block total spend ----------------------------- 0.004289388656616211
generate_one_block  0.0015063285827636719
generate_one_block  0.0015673637390136719
generate_one_block  0.0013382434844970703
generate_one_block  0.001352071762084961
generate_one_block  0.0013799667358398438
generate_one_block  0.0013756752014160156
generate_one_block  0.001683950424194336
generate_one_block  0.0011153221130371094
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010986328125
gen group dst list time:  0.00014925003051757812
time for parepare:  0.0010676383972167969
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.0003135204315185547
mini_batch_src_global generation:  0.0001373291015625
r_  generation:  0.0011279582977294922
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00022840499877929688
mini_batch_src_global generation:  0.0002238750457763672
r_  generation:  0.0019524097442626953
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  0.00011610984802246094
r_  generation:  0.0005736351013183594
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  9.417533874511719e-05
r_  generation:  0.0007359981536865234
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  0.00010371208190917969
r_  generation:  0.0008444786071777344
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  0.00011706352233886719
r_  generation:  0.0009799003601074219
local_output_nid generation:  9.512901306152344e-05
local_in_edges_tensor generation:  0.00027632713317871094
mini_batch_src_global generation:  0.0003788471221923828
r_  generation:  0.003154277801513672
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  0.00014901161193847656
r_  generation:  0.0008618831634521484
----------------------check_connections_block total spend ----------------------------- 0.017672300338745117
generate_one_block  0.002125978469848633
generate_one_block  0.0027418136596679688
generate_one_block  0.0014345645904541016
generate_one_block  0.0017268657684326172
generate_one_block  0.0017518997192382812
generate_one_block  0.001947164535522461
generate_one_block  0.004266262054443359
generate_one_block  0.0019745826721191406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018863677978515625
gen group dst list time:  0.00036334991455078125
time for parepare:  0.0029163360595703125
local_output_nid generation:  0.0003533363342285156
local_in_edges_tensor generation:  0.0010943412780761719
mini_batch_src_global generation:  0.001056671142578125
r_  generation:  0.00983428955078125
local_output_nid generation:  0.0004100799560546875
local_in_edges_tensor generation:  0.0008063316345214844
mini_batch_src_global generation:  0.0015475749969482422
r_  generation:  0.007633686065673828
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  0.0003814697265625
r_  generation:  0.0026574134826660156
local_output_nid generation:  0.000110626220703125
local_in_edges_tensor generation:  0.0002703666687011719
mini_batch_src_global generation:  0.0002963542938232422
r_  generation:  0.0029048919677734375
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.0002880096435546875
mini_batch_src_global generation:  0.0003864765167236328
r_  generation:  0.0040166378021240234
local_output_nid generation:  0.0001697540283203125
local_in_edges_tensor generation:  0.00034928321838378906
mini_batch_src_global generation:  0.00049591064453125
r_  generation:  0.004781007766723633
local_output_nid generation:  0.0002579689025878906
local_in_edges_tensor generation:  0.0004992485046386719
mini_batch_src_global generation:  0.0008680820465087891
r_  generation:  0.00790095329284668
local_output_nid generation:  0.00014472007751464844
local_in_edges_tensor generation:  0.0003476142883300781
mini_batch_src_global generation:  0.0006098747253417969
r_  generation:  0.005213260650634766
----------------------check_connections_block total spend ----------------------------- 0.07280182838439941
generate_one_block  0.00768589973449707
generate_one_block  0.010748863220214844
generate_one_block  0.004461050033569336
generate_one_block  0.004761219024658203
generate_one_block  0.006323099136352539
generate_one_block  0.007537841796875
generate_one_block  0.011834383010864258
generate_one_block  0.010430574417114258
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0023577213287353516
gen group dst list time:  0.0015683174133300781
time for parepare:  0.002338409423828125
local_output_nid generation:  0.0009310245513916016
local_in_edges_tensor generation:  0.0017952919006347656
mini_batch_src_global generation:  0.00174713134765625
r_  generation:  0.01706719398498535
local_output_nid generation:  0.0007576942443847656
local_in_edges_tensor generation:  0.0012917518615722656
mini_batch_src_global generation:  0.0022759437561035156
r_  generation:  0.018791675567626953
local_output_nid generation:  0.0005764961242675781
local_in_edges_tensor generation:  0.0008237361907958984
mini_batch_src_global generation:  0.0011107921600341797
r_  generation:  0.011037826538085938
local_output_nid generation:  0.0005190372467041016
local_in_edges_tensor generation:  0.0008120536804199219
mini_batch_src_global generation:  0.0008404254913330078
r_  generation:  0.010996341705322266
local_output_nid generation:  0.0005981922149658203
local_in_edges_tensor generation:  0.000881195068359375
mini_batch_src_global generation:  0.0009143352508544922
r_  generation:  0.013895988464355469
local_output_nid generation:  0.0008428096771240234
local_in_edges_tensor generation:  0.0025038719177246094
mini_batch_src_global generation:  0.0013806819915771484
r_  generation:  0.01607370376586914
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0013332366943359375
mini_batch_src_global generation:  0.0015101432800292969
r_  generation:  0.017767667770385742
local_output_nid generation:  0.0010135173797607422
local_in_edges_tensor generation:  0.0012562274932861328
mini_batch_src_global generation:  0.0014560222625732422
r_  generation:  0.017065048217773438
----------------------check_connections_block total spend ----------------------------- 0.18222284317016602
generate_one_block  0.018752574920654297
generate_one_block  0.025690317153930664
generate_one_block  0.01509857177734375
generate_one_block  0.015189170837402344
generate_one_block  0.01656317710876465
generate_one_block  0.02191901206970215
generate_one_block  0.024950027465820312
generate_one_block  0.02202773094177246
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.018856048583984375  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

connection checking time:  0.27698636054992676
block generation total time  0.2532615661621094
average batch blocks generation time:  0.03165769577026367
block dataloader generation time/epoch 0.5827012062072754
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.025818347930908203  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

torch.Size([13269, 500])
torch.Size([7076, 32])
torch.Size([1435, 32])
torch.Size([358, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.030071258544921875  GigaBytes
Max Memory Allocated: 0.05303621292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.029545307159423828  GigaBytes
Max Memory Allocated: 0.05359983444213867  GigaBytes

torch.Size([15187, 500])
torch.Size([8441, 32])
torch.Size([2680, 32])
torch.Size([487, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.036158084869384766  GigaBytes
Max Memory Allocated: 0.05359983444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.021388530731201172  GigaBytes
Max Memory Allocated: 0.05359983444213867  GigaBytes

torch.Size([10979, 500])
torch.Size([4755, 32])
torch.Size([784, 32])
torch.Size([189, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.024130821228027344  GigaBytes
Max Memory Allocated: 0.05359983444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.02281951904296875  GigaBytes
Max Memory Allocated: 0.05359983444213867  GigaBytes

torch.Size([11740, 500])
torch.Size([4662, 32])
torch.Size([1175, 32])
torch.Size([184, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.02574443817138672  GigaBytes
Max Memory Allocated: 0.05359983444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.021663665771484375  GigaBytes
Max Memory Allocated: 0.05359983444213867  GigaBytes

torch.Size([11082, 500])
torch.Size([5539, 32])
torch.Size([1172, 32])
torch.Size([239, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.02503061294555664  GigaBytes
Max Memory Allocated: 0.05359983444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.0281219482421875  GigaBytes
Max Memory Allocated: 0.05359983444213867  GigaBytes

torch.Size([14489, 500])
torch.Size([7446, 32])
torch.Size([1814, 32])
torch.Size([252, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.032689571380615234  GigaBytes
Max Memory Allocated: 0.05359983444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.028282642364501953  GigaBytes
Max Memory Allocated: 0.054551124572753906  GigaBytes

torch.Size([14478, 500])
torch.Size([9093, 32])
torch.Size([2891, 32])
torch.Size([792, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.03455018997192383  GigaBytes
Max Memory Allocated: 0.054551124572753906  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.027529239654541016  GigaBytes
Max Memory Allocated: 0.054551124572753906  GigaBytes

torch.Size([14158, 500])
torch.Size([8894, 32])
torch.Size([1590, 32])
torch.Size([351, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.03343486785888672  GigaBytes
Max Memory Allocated: 0.054551124572753906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005207091569900513 |0.0014694035053253174 |0.007723450660705566 |0.00016391277313232422 |0.006964325904846191 |0.005144596099853516 |
----------------------------------------------------------pseudo_mini_loss sum 2.253479242324829
Total (block generation + training)time/epoch 0.7755050659179688
Training time/epoch 0.19259381294250488
Training time without block to device /epoch 0.18083858489990234
Training time without total dataloading part /epoch 0.12395811080932617
load block tensor time/epoch 0.0416567325592041
block to device time/epoch 0.011755228042602539
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  178037
Number of first layer input nodes during this epoch:  105382
