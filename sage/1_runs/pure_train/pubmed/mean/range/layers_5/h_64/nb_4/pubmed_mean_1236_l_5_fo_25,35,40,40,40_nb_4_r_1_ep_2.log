main start at this time 1648532051.4070349
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003414154052734375  GigaBytes
Max Memory Allocated: 0.0003414154052734375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0025756359100341797
range selection method range initialization spend 8.726119995117188e-05
time for parepare:  4.315376281738281e-05
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0012319087982177734
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  6.794929504394531e-05
----------------------check_connections_block total spend ----------------------------- 0.001916646957397461
generate_one_block  0.0013892650604248047
generate_one_block  0.001134634017944336
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012054443359375
gen group dst list time:  2.5272369384765625e-05
time for parepare:  0.00023221969604492188
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0005528926849365234
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  0.0001068115234375
r_  generation:  0.0007145404815673828
----------------------check_connections_block total spend ----------------------------- 0.0023849010467529297
generate_one_block  0.0018439292907714844
generate_one_block  0.0019390583038330078
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010404586791992188
gen group dst list time:  6.29425048828125e-05
time for parepare:  0.0007297992706298828
local_output_nid generation:  8.320808410644531e-05
local_in_edges_tensor generation:  0.00037980079650878906
mini_batch_src_global generation:  0.0003063678741455078
r_  generation:  0.0036468505859375
local_output_nid generation:  0.00011444091796875
local_in_edges_tensor generation:  0.0003325939178466797
mini_batch_src_global generation:  0.0005350112915039062
r_  generation:  0.004489898681640625
----------------------check_connections_block total spend ----------------------------- 0.012796640396118164
generate_one_block  0.005583286285400391
generate_one_block  0.006452322006225586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022182464599609375
gen group dst list time:  0.0001895427703857422
time for parepare:  0.001371145248413086
local_output_nid generation:  0.0003237724304199219
local_in_edges_tensor generation:  0.0010180473327636719
mini_batch_src_global generation:  0.0013306140899658203
r_  generation:  0.012943744659423828
local_output_nid generation:  0.00043892860412597656
local_in_edges_tensor generation:  0.0008897781372070312
mini_batch_src_global generation:  0.001497507095336914
r_  generation:  0.014600276947021484
----------------------check_connections_block total spend ----------------------------- 0.041229248046875
generate_one_block  0.01786017417907715
generate_one_block  0.020434141159057617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017049312591552734
gen group dst list time:  0.0004665851593017578
time for parepare:  0.0014693737030029297
local_output_nid generation:  0.0009205341339111328
local_in_edges_tensor generation:  0.001973867416381836
mini_batch_src_global generation:  0.0019910335540771484
r_  generation:  0.021843433380126953
local_output_nid generation:  0.0010955333709716797
local_in_edges_tensor generation:  0.0024085044860839844
mini_batch_src_global generation:  0.0025262832641601562
r_  generation:  0.022951841354370117
----------------------check_connections_block total spend ----------------------------- 0.06731033325195312
generate_one_block  0.027485370635986328
generate_one_block  0.029515504837036133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003414154052734375  GigaBytes
Max Memory Allocated: 0.0003414154052734375  GigaBytes

connection checking time:  0.12372112274169922
block generation total time  0.1111137866973877
average batch blocks generation time:  0.05555689334869385
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.0333552360534668  GigaBytes
Max Memory Allocated: 0.0333552360534668  GigaBytes

torch.Size([17203, 500])
torch.Size([13441, 64])
torch.Size([4768, 64])
torch.Size([1218, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.05208587646484375  GigaBytes
Max Memory Allocated: 0.05218696594238281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.035182952880859375  GigaBytes
Max Memory Allocated: 0.06618165969848633  GigaBytes

torch.Size([17963, 500])
torch.Size([14368, 64])
torch.Size([5867, 64])
torch.Size([1575, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.05619239807128906  GigaBytes
Max Memory Allocated: 0.06618165969848633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012662291526794434 |0.17248880863189697 |0.3892359733581543 |0.00019562244415283203 |0.008333325386047363 |0.003365039825439453 |
----------------------------------------------------------pseudo_mini_loss sum 2.9137325286865234
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  76759
Number of first layer input nodes during this epoch:  35166
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.0381779670715332  GigaBytes
Max Memory Allocated: 0.06618165969848633  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006120204925537109
range selection method range initialization spend 7.772445678710938e-05
time for parepare:  6.723403930664062e-05
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  6.29425048828125e-05
----------------------check_connections_block total spend ----------------------------- 0.0008394718170166016
generate_one_block  0.0014157295227050781
generate_one_block  0.0013282299041748047
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006270408630371094
gen group dst list time:  3.5762786865234375e-05
time for parepare:  0.00037741661071777344
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00023818016052246094
mini_batch_src_global generation:  0.00014400482177734375
r_  generation:  0.0009884834289550781
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation: Using backend: pytorch
 0.00010943412780761719
r_  generation:  0.0005960464477539062
----------------------check_connections_block total spend ----------------------------- 0.0031964778900146484
generate_one_block  0.002494335174560547
generate_one_block  0.0020720958709716797
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011897087097167969
gen group dst list time:  9.679794311523438e-05
time for parepare:  0.001033782958984375
local_output_nid generation:  0.00016498565673828125
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0007288455963134766
r_  generation:  0.006360530853271484
local_output_nid generation:  0.00014281272888183594
local_in_edges_tensor generation:  0.0003287792205810547
mini_batch_src_global generation:  0.00046324729919433594
r_  generation:  0.003389596939086914
----------------------check_connections_block total spend ----------------------------- 0.015544652938842773
generate_one_block  0.008199691772460938
generate_one_block  0.004180192947387695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018689632415771484
gen group dst list time:  0.00022029876708984375
time for parepare:  0.0013887882232666016
local_output_nid generation:  0.0004439353942871094
local_in_edges_tensor generation:  0.0011167526245117188
mini_batch_src_global generation:  0.0016117095947265625
r_  generation:  0.016290903091430664
local_output_nid generation:  0.00033926963806152344
local_in_edges_tensor generation:  0.0007224082946777344
mini_batch_src_global generation:  0.0014286041259765625
r_  generation:  0.011706352233886719
----------------------check_connections_block total spend ----------------------------- 0.041950225830078125
generate_one_block  0.020629167556762695
generate_one_block  0.01660943031311035
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0030303001403808594
gen group dst list time:  0.0016922950744628906
time for parepare:  0.0037512779235839844
local_output_nid generation:  0.002240419387817383
local_in_edges_tensor generation:  0.0035893917083740234
mini_batch_src_global generation:  0.0030660629272460938
r_  generation:  0.022919654846191406
local_output_nid generation:  0.001247406005859375
local_in_edges_tensor generation:  0.002247333526611328
mini_batch_src_global generation:  0.0024178028106689453
r_  generation:  0.022020578384399414
----------------------check_connections_block total spend ----------------------------- 0.07574701309204102
generate_one_block  0.029001951217651367
generate_one_block  0.02923750877380371
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.0381779670715332  GigaBytes
Max Memory Allocated: 0.06618165969848633  GigaBytes

connection checking time:  0.13643836975097656
block generation total time  0.11242437362670898
average batch blocks generation time:  0.05621218681335449
block dataloader generation time/epoch 0.2867555618286133
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.035980224609375  GigaBytes
Max Memory Allocated: 0.06835508346557617  GigaBytes

torch.Size([18010, 500])
torch.Size([14192, 64])
torch.Size([6449, 64])
torch.Size([1619, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.057099342346191406  GigaBytes
Max Memory Allocated: 0.06835508346557617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.03440523147583008  GigaBytes
Max Memory Allocated: 0.06835508346557617  GigaBytes

torch.Size([17273, 500])
torch.Size([13208, 64])
torch.Size([3959, 64])
torch.Size([1132, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.05097532272338867  GigaBytes
Max Memory Allocated: 0.06835508346557617  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013551115989685059 |0.0015012025833129883 |0.006432175636291504 |0.0001342296600341797 |0.007349848747253418 |0.002924680709838867 |
----------------------------------------------------------pseudo_mini_loss sum 1.7938706874847412
Total (block generation + training)time/epoch 0.3510146141052246
Training time/epoch 0.06395530700683594
Training time without block to device /epoch 0.06095290184020996
Training time without total dataloading part /epoch 0.03075718879699707
load block tensor time/epoch 0.027102231979370117
block to device time/epoch 0.0030024051666259766
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  76198
Number of first layer input nodes during this epoch:  35283
