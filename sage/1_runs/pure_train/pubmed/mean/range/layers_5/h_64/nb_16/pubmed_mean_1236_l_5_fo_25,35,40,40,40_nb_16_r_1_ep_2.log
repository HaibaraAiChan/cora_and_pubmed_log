main start at this time 1648532073.0150592
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003414154052734375  GigaBytes
Max Memory Allocated: 0.0003414154052734375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012433528900146484
range selection method range initialization spend 8.7738037109375e-05
time for parepare:  4.792213439941406e-05
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0012288093566894531
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1696090698242188e-05
----------------------check_connections_block total spend ----------------------------- 0.003031015396118164
generate_one_block  0.0012264251708984375
generate_one_block  0.0010845661163330078
generate_one_block  0.0010824203491210938
generate_one_block  0.0010459423065185547
generate_one_block  0.0010731220245361328
generate_one_block  0.001062631607055664
generate_one_block  0.0010616779327392578
generate_one_block  0.0010895729064941406
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007460117340087891
gen group dst list time:  5.14984130859375e-05
time for parepare:  0.00024628639221191406
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.0002048015594482422
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00010251998901367188
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00026679039001464844
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00010061264038085938
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0002720355987548828
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001800060272216797
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00020885467529296875
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00010657310485839844
----------------------check_connections_block total spend ----------------------------- 0.0035653114318847656
generate_one_block  0.0013272762298583984
generate_one_block  0.0011546611785888672
generate_one_block  0.0013971328735351562
generate_one_block  0.0011587142944335938
generate_one_block  0.001407623291015625
generate_one_block  0.0012750625610351562
generate_one_block  0.001379251480102539
generate_one_block  0.0011639595031738281
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001180410385131836
gen group dst list time:  9.72747802734375e-05
time for parepare:  0.0007762908935546875
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0002727508544921875
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.001295328140258789
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0005655288696289062
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.00017118453979492188
r_  generation:  0.0016856193542480469
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  0.00011229515075683594
r_  generation:  0.0006482601165771484
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.00020265579223632812
mini_batch_src_global generation:  0.00020074844360351562
r_  generation:  0.0022954940795898438
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0009875297546386719
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0012161731719970703
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.0005738735198974609
----------------------check_connections_block total spend ----------------------------- 0.015362977981567383
generate_one_block  0.003398418426513672
generate_one_block  0.0015947818756103516
generate_one_block  0.0029664039611816406
generate_one_block  0.0016753673553466797
generate_one_block  0.0037000179290771484
generate_one_block  0.0021257400512695312
generate_one_block  0.0023741722106933594
generate_one_block  0.0015997886657714844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018706321716308594
gen group dst list time:  0.0002684593200683594
time for parepare:  0.0015342235565185547
local_output_nid generation:  0.00016260147094726562
local_in_edges_tensor generation:  0.0006761550903320312
mini_batch_src_global generation:  0.00089263916015625
r_  generation:  0.007105588912963867
local_output_nid generation:  0.000110626220703125
local_in_edges_tensor generation:  0.00029468536376953125
mini_batch_src_global generation:  0.0005643367767333984
r_  generation:  0.00391387939453125
local_output_nid generation:  0.00018930435180664062
local_in_edges_tensor generation:  0.0004374980926513672
mini_batch_src_global generation:  0.0006301403045654297
r_  generation:  0.0064754486083984375
local_output_nid generation:  9.608268737792969e-05
local_in_edges_tensor generation:  0.0002689361572265625
mini_batch_src_global generation:  0.00046253204345703125
r_  generation:  0.003603219985961914
local_output_nid generation:  0.00024318695068359375
local_in_edges_tensor generation:  0.0005269050598144531
mini_batch_src_global generation:  0.0008695125579833984
r_  generation:  0.009502887725830078
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.0003523826599121094
mini_batch_src_global generation:  0.0006110668182373047
r_  generation:  0.004734516143798828
local_output_nid generation:  0.00019216537475585938
local_in_edges_tensor generation:  0.00041103363037109375
mini_batch_src_global generation:  0.0005810260772705078
r_  generation:  0.005964994430541992
local_output_nid generation:  8.7738037109375e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  0.00032782554626464844
r_  generation:  0.002420186996459961
----------------------check_connections_block total spend ----------------------------- 0.0661630630493164
generate_one_block  0.010564088821411133
generate_one_block  0.005556821823120117
generate_one_block  0.010297298431396484
generate_one_block  0.0057413578033447266
generate_one_block  0.012908697128295898
generate_one_block  0.007212638854980469
generate_one_block  0.009736061096191406
generate_one_block  0.004372358322143555
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017309188842773438
gen group dst list time:  0.0012505054473876953
time for parepare:  0.00183868408203125
local_output_nid generation:  0.0008292198181152344
local_in_edges_tensor generation:  0.0017850399017333984
mini_batch_src_global generation:  0.0019006729125976562
r_  generation:  0.018081188201904297
local_output_nid generation:  0.0004115104675292969
local_in_edges_tensor generation:  0.0009496212005615234
mini_batch_src_global generation:  0.00139617919921875
r_  generation:  0.011154413223266602
local_output_nid generation:  0.0007479190826416016
local_in_edges_tensor generation:  0.0012254714965820312
mini_batch_src_global generation:  0.0014014244079589844
r_  generation:  0.016006946563720703
local_output_nid generation:  0.0004706382751464844
local_in_edges_tensor generation:  0.0007004737854003906
mini_batch_src_global generation:  0.0010221004486083984
r_  generation:  0.01068258285522461
local_output_nid generation:  0.0009160041809082031
local_in_edges_tensor generation:  0.001474618911743164
mini_batch_src_global generation:  0.0015263557434082031
r_  generation:  0.018938541412353516
local_output_nid generation:  0.0006184577941894531
local_in_edges_tensor generation:  0.0011932849884033203
mini_batch_src_global generation:  0.0013577938079833984
r_  generation:  0.014230012893676758
local_output_nid generation:  0.0008113384246826172
local_in_edges_tensor generation:  0.001207590103149414
mini_batch_src_global generation:  0.0013842582702636719
r_  generation:  0.017503023147583008
local_output_nid generation:  0.0003669261932373047
local_in_edges_tensor generation:  0.0006146430969238281
mini_batch_src_global generation:  0.0008580684661865234
r_  generation:  0.007600069046020508
----------------------check_connections_block total spend ----------------------------- 0.168076753616333
generate_one_block  0.022688865661621094
generate_one_block  0.015621185302734375
generate_one_block  0.022313833236694336
generate_one_block  0.014484405517578125
generate_one_block  0.025267601013183594
generate_one_block  0.01854991912841797
generate_one_block  0.02266526222229004
generate_one_block  0.011749029159545898
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003414154052734375  GigaBytes
Max Memory Allocated: 0.0003414154052734375  GigaBytes

connection checking time:  0.25316810607910156
block generation total time  0.24942779541015625
average batch blocks generation time:  0.03117847442626953
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.028682708740234375  GigaBytes
Max Memory Allocated: 0.028682708740234375  GigaBytes

torch.Size([14865, 500])
torch.Size([9793, 64])
torch.Size([2157, 64])
torch.Size([460, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.039722442626953125  GigaBytes
Max Memory Allocated: 0.03977775573730469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.020740509033203125  GigaBytes
Max Memory Allocated: 0.04803943634033203  GigaBytes

torch.Size([10561, 500])
torch.Size([4294, 64])
torch.Size([1161, 64])
torch.Size([171, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.02668619155883789  GigaBytes
Max Memory Allocated: 0.04803943634033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.026525497436523438  GigaBytes
Max Memory Allocated: 0.04803943634033203  GigaBytes

torch.Size([13549, 500])
torch.Size([7564, 64])
torch.Size([2204, 64])
torch.Size([481, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.035880088806152344  GigaBytes
Max Memory Allocated: 0.04803943634033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.01864767074584961  GigaBytes
Max Memory Allocated: 0.04803943634033203  GigaBytes

torch.Size([9446, 500])
torch.Size([4586, 64])
torch.Size([1017, 64])
torch.Size([217, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.024745941162109375  GigaBytes
Max Memory Allocated: 0.04803943634033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.030745506286621094  GigaBytes
Max Memory Allocated: 0.04803943634033203  GigaBytes

torch.Size([15668, 500])
torch.Size([9811, 64])
torch.Size([3084, 64])
torch.Size([571, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.0429844856262207  GigaBytes
Max Memory Allocated: 0.04803943634033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.026534080505371094  GigaBytes
Max Memory Allocated: 0.05536699295043945  GigaBytes

torch.Size([13251, 500])
torch.Size([6919, 64])
torch.Size([1620, 64])
torch.Size([368, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03449392318725586  GigaBytes
Max Memory Allocated: 0.05536699295043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.0290679931640625  GigaBytes
Max Memory Allocated: 0.05536699295043945  GigaBytes

torch.Size([14920, 500])
torch.Size([8797, 64])
torch.Size([2128, 64])
torch.Size([462, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03925466537475586  GigaBytes
Max Memory Allocated: 0.05536699295043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.0188751220703125  GigaBytes
Max Memory Allocated: 0.05536699295043945  GigaBytes

torch.Size([9622, 500])
torch.Size([3604, 64])
torch.Size([949, 64])
torch.Size([194, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.02317523956298828  GigaBytes
Max Memory Allocated: 0.05536699295043945  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010483026504516602 |0.043755024671554565 |0.10149803757667542 |0.00016546249389648438 |0.0042237937450408936 |0.004515171051025391 |
----------------------------------------------------------pseudo_mini_loss sum 3.2723746299743652
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  174851
Number of first layer input nodes during this epoch:  101882
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.020168304443359375  GigaBytes
Max Memory Allocated: 0.05536699295043945  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000732421875
range selection method range initialization spend 8.20159912109375e-05
time for parepare:  6.818771362304688e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0002532005310058594
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  4.7206878662109375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  4.5299530029296875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  2.4318695068359375e-05
----------------------check_connections_block total spend ----------------------------- 0.0023889541625976562
generate_one_block  0.0017709732055664062
generate_one_block  0.0014820098876953125
generate_one_block  0.0014448165893554688
generate_one_block  0.001413106918334961
generate_one_block  0.001405477523803711
generate_one_block  0.0014264583587646484
generate_one_block  0.0013995170593261719
generate_one_block  0.001295328140258789
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007340908050537109
gen group dst list time:  8.559226989746094e-05
time for parepare:  0.00038361549377441406
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0002505779266357422
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0002624988555908203
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.00028395652770996094
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0003905296325683594
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00013256072998046875
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00013828277587890625
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00021123886108398438
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00012159347534179688
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00014710426330566406
----------------------check_connections_block total spend ----------------------------- 0.0047266483306884766
generate_one_block  0.0018482208251953125
generate_one_block  0.0016629695892333984
generate_one_block  0.0016994476318359375
generate_one_block  0.0013437271118164062
generate_one_block  0.0013892650604248047
generate_one_block  0.0013892650604248047
generate_one_block  0.0011026859283447266
generate_one_block  0.001077413558959961
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011305809020996094
gen group dst list time:  0.00015020370483398438
time for parepare:  0.0010712146759033203
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00033164024353027344
mini_batch_src_global generation:  0.0002827644348144531
r_  generation:  0.0018646717071533203
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  0.0003018379211425781
r_  generation:  0.0018329620361328125
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.0002465248107910156
mini_batch_src_global generation:  0.00038242340087890625
r_  generation:  0.0028595924377441406
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00018739700317382812
r_  generation:  0.0007948875427246094
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  0.000110626220703125
r_  generation:  0.0009510517120361328
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  0.00012421607971191406
r_  generation:  0.0009531974792480469
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.00044345855712890625
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0007622241973876953
----------------------check_connections_block total spend ----------------------------- 0.018113136291503906
generate_one_block  0.002992391586303711
generate_one_block  0.0027871131896972656
generate_one_block  0.0037064552307128906
generate_one_block  0.0017802715301513672
generate_one_block  0.0018537044525146484
generate_one_block  0.0019233226776123047
generate_one_block  0.0014162063598632812
generate_one_block  0.0018939971923828125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019533634185791016
gen group dst list time:  0.0003840923309326172
time for parepare:  0.001802682876586914
local_output_nid generation:  0.00020170211791992188
local_in_edges_tensor generation:  0.000690460205078125
mini_batch_src_global generation:  0.0008368492126464844
r_  generation:  0.007884025573730469
local_output_nid generation:  0.00029468536376953125
local_in_edges_tensor generation:  0.0005724430084228516
mini_batch_src_global generation:  0.0010061264038085938
r_  generation:  0.0064716339111328125
local_output_nid generation:  0.0002319812774658203
local_in_edges_tensor generation:  0.0005049705505371094
mini_batch_src_global generation:  0.0008547306060791016
r_  generation:  0.007930755615234375
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.0003082752227783203
mini_batch_src_global generation:  0.0005080699920654297
r_  generation:  0.0043714046478271484
local_output_nid generation:  0.0001308917999267578
local_in_edges_tensor generation:  0.0003104209899902344
mini_batch_src_global generation:  0.0004706382751464844
r_  generation:  0.004744291305541992
local_output_nid generation:  0.00013399124145507812
local_in_edges_tensor generation:  0.00029349327087402344
mini_batch_src_global generation:  0.0004303455352783203
r_  generation:  0.0040934085845947266
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  0.0002799034118652344
r_  generation:  0.002263307571411133
local_output_nid generation:  0.0001418590545654297
local_in_edges_tensor generation:  0.0003101825714111328
mini_batch_src_global generation:  0.0004220008850097656
r_  generation:  0.004740238189697266
----------------------check_connections_block total spend ----------------------------- 0.06481599807739258
generate_one_block  0.00921487808227539
generate_one_block  0.008950948715209961
generate_one_block  0.01182246208190918
generate_one_block  0.006767988204956055
generate_one_block  0.007340431213378906
generate_one_block  0.006489992141723633
generate_one_block  0.003915071487426758
generate_one_block  0.007601261138916016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002266407012939453
gen group dst list time:  0.0017099380493164062
time for parepare:  0.002263307571411133
local_output_nid generation:  0.0008268356323242188
local_in_edges_tensor generation:  0.0017502307891845703
mini_batch_src_global generation:  0.0016016960144042969
r_  generation:  0.01619434356689453
local_output_nid generation:  0.0007662773132324219
local_in_edges_tensor generation:  0.0012006759643554688
mini_batch_src_global generation:  0.0020890235900878906
r_  generation:  0.018240690231323242
local_output_nid generation:  0.0008947849273681641
local_in_edges_tensor generation:  0.0012242794036865234
mini_batch_src_global generation:  0.0018019676208496094
r_  generation:  0.018790245056152344
local_output_nid generation:  0.0007679462432861328
local_in_edges_tensor generation:  0.0009582042694091797
mini_batch_src_global generation:  0.001131296157836914
r_  generation:  0.013669729232788086
local_output_nid generation:  0.0007963180541992188
local_in_edges_tensor generation:  0.000980377197265625
mini_batch_src_global generation:  0.0012023448944091797
r_  generation:  0.01633310317993164
local_output_nid generation:  0.0008268356323242188
local_in_edges_tensor generation:  0.0026717185974121094
mini_batch_src_global generation:  0.001172780990600586
r_  generation:  0.014530420303344727
local_output_nid generation:  0.00044989585876464844
local_in_edges_tensor generation:  0.0007295608520507812
mini_batch_src_global generation:  0.0008955001831054688
r_  generation:  0.007793903350830078
local_output_nid generation:  0.000827789306640625
local_in_edges_tensor generation:  0.0011196136474609375
mini_batch_src_global generation:  0.0011546611785888672
r_  generation:  0.016259431838989258
----------------------check_connections_block total spend ----------------------------- 0.18407511711120605
generate_one_block  0.01739192008972168
generate_one_block  0.022010326385498047
generate_one_block  0.02443718910217285
generate_one_block  0.017866134643554688
generate_one_block  0.019387245178222656
generate_one_block  0.01845717430114746
generate_one_block  0.01182866096496582
generate_one_block  0.0205535888671875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.020168304443359375  GigaBytes
Max Memory Allocated: 0.05536699295043945  GigaBytes

connection checking time:  0.271730899810791
block generation total time  0.24390172958374023
average batch blocks generation time:  0.03048771619796753
block dataloader generation time/epoch 0.5693511962890625
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.02387714385986328  GigaBytes
Max Memory Allocated: 0.05536699295043945  GigaBytes

torch.Size([11807, 500])
torch.Size([6552, 64])
torch.Size([1869, 64])
torch.Size([451, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03195905685424805  GigaBytes
Max Memory Allocated: 0.05536699295043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.030035972595214844  GigaBytes
Max Memory Allocated: 0.05536699295043945  GigaBytes

torch.Size([15087, 500])
torch.Size([8130, 64])
torch.Size([2682, 64])
torch.Size([483, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.04029035568237305  GigaBytes
Max Memory Allocated: 0.05536699295043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.02958536148071289  GigaBytes
Max Memory Allocated: 0.05697917938232422  GigaBytes

torch.Size([14778, 500])
torch.Size([8695, 64])
torch.Size([2831, 64])
torch.Size([611, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.040692806243896484  GigaBytes
Max Memory Allocated: 0.05697917938232422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.023299217224121094  GigaBytes
Max Memory Allocated: 0.05697917938232422  GigaBytes

torch.Size([11461, 500])
torch.Size([6071, 64])
torch.Size([1343, 64])
torch.Size([199, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.030134201049804688  GigaBytes
Max Memory Allocated: 0.05697917938232422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.02595806121826172  GigaBytes
Max Memory Allocated: 0.05697917938232422  GigaBytes

torch.Size([12935, 500])
torch.Size([6460, 64])
torch.Size([1363, 64])
torch.Size([258, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.033220767974853516  GigaBytes
Max Memory Allocated: 0.05697917938232422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.026443958282470703  GigaBytes
Max Memory Allocated: 0.05697917938232422  GigaBytes

torch.Size([13219, 500])
torch.Size([7153, 64])
torch.Size([1386, 64])
torch.Size([371, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.03436851501464844  GigaBytes
Max Memory Allocated: 0.05697917938232422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.019684314727783203  GigaBytes
Max Memory Allocated: 0.05697917938232422  GigaBytes

torch.Size([9700, 500])
torch.Size([4270, 64])
torch.Size([769, 64])
torch.Size([222, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.024784088134765625  GigaBytes
Max Memory Allocated: 0.05697917938232422  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.027575016021728516  GigaBytes
Max Memory Allocated: 0.05697917938232422  GigaBytes

torch.Size([13793, 500])
torch.Size([8244, 64])
torch.Size([1479, 64])
torch.Size([303, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.03641700744628906  GigaBytes
Max Memory Allocated: 0.05697917938232422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007323861122131348 |0.0013009905815124512 |0.006783783435821533 |0.00014060735702514648 |0.003835350275039673 |0.005193233489990234 |
----------------------------------------------------------pseudo_mini_loss sum 1.9932615756988525
Total (block generation + training)time/epoch 0.7434535026550293
Training time/epoch 0.1736438274383545
Training time without block to device /epoch 0.16323590278625488
Training time without total dataloading part /epoch 0.09127116203308105
load block tensor time/epoch 0.05859088897705078
block to device time/epoch 0.01040792465209961
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  175332
Number of first layer input nodes during this epoch:  102780
