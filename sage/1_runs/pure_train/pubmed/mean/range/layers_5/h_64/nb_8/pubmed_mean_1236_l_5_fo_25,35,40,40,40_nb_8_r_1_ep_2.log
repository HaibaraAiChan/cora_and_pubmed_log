main start at this time 1648532062.0413013
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003414154052734375  GigaBytes
Max Memory Allocated: 0.0003414154052734375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001983165740966797
range selection method range initialization spend 8.535385131835938e-05
time for parepare:  4.363059997558594e-05
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0012135505676269531
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.528594970703125e-05
----------------------check_connections_block total spend ----------------------------- 0.0022306442260742188
generate_one_block  0.0012578964233398438
generate_one_block  0.0010941028594970703
generate_one_block  0.0010585784912109375
generate_one_block  0.0010356903076171875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011296272277832031
gen group dst list time:  3.314018249511719e-05
time for parepare:  0.0002307891845703125
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00027060508728027344
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0003139972686767578
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00040650367736816406
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0003123283386230469
----------------------check_connections_block total spend ----------------------------- 0.0027573108673095703
generate_one_block  0.0013744831085205078
generate_one_block  0.0014309883117675781
generate_one_block  0.0015752315521240234
generate_one_block  0.0014882087707519531
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010297298431396484
gen group dst list time:  7.224082946777344e-05
time for parepare:  0.0007817745208740234
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0003108978271484375
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.0016736984252929688
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  0.00021696090698242188
r_  generation:  0.0020079612731933594
local_output_nid generation:  7.534027099609375e-05
local_in_edges_tensor generation:  0.0002460479736328125
mini_batch_src_global generation:  0.0003077983856201172
r_  generation:  0.002891063690185547
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.0017957687377929688
----------------------check_connections_block total spend ----------------------------- 0.013343334197998047
generate_one_block  0.0040132999420166016
generate_one_block  0.0034575462341308594
generate_one_block  0.004809141159057617
generate_one_block  0.003175973892211914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002197742462158203
gen group dst list time:  0.00022363662719726562
time for parepare:  0.001360177993774414
local_output_nid generation:  0.0002079010009765625
local_in_edges_tensor generation:  0.0008404254913330078
mini_batch_src_global generation:  0.001100778579711914
r_  generation:  0.008957624435424805
local_output_nid generation:  0.00020766258239746094
local_in_edges_tensor generation:  0.0005509853363037109
mini_batch_src_global generation:  0.0010285377502441406
r_  generation:  0.007496356964111328
local_output_nid generation:  0.0003173351287841797
local_in_edges_tensor generation:  0.0007109642028808594
mini_batch_src_global generation:  0.0012183189392089844
r_  generation:  0.011427879333496094
local_output_nid generation:  0.00024509429931640625
local_in_edges_tensor generation:  0.0005166530609130859
mini_batch_src_global generation:  0.00081634521484375
r_  generation:  0.007679462432861328
----------------------check_connections_block total spend ----------------------------- 0.053516387939453125
generate_one_block  0.013209104537963867
generate_one_block  0.010907173156738281
generate_one_block  0.01537942886352539
generate_one_block  0.011521100997924805
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002076387405395508
gen group dst list time:  0.0007183551788330078
time for parepare:  0.0016908645629882812
local_output_nid generation:  0.0008475780487060547
local_in_edges_tensor generation:  0.0020401477813720703
mini_batch_src_global generation:  0.002068042755126953
r_  generation:  0.0194244384765625
local_output_nid generation:  0.0007245540618896484
local_in_edges_tensor generation:  0.0014355182647705078
mini_batch_src_global generation:  0.0018627643585205078
r_  generation:  0.016439199447631836
local_output_nid generation:  0.0011608600616455078
local_in_edges_tensor generation:  0.002113819122314453
mini_batch_src_global generation:  0.0020444393157958984
r_  generation:  0.021138906478881836
local_output_nid generation:  0.0010628700256347656
local_in_edges_tensor generation:  0.0017609596252441406
mini_batch_src_global generation:  0.0018165111541748047
r_  generation:  0.01900339126586914
----------------------check_connections_block total spend ----------------------------- 0.11377644538879395
generate_one_block  0.02438187599182129
generate_one_block  0.021973133087158203
generate_one_block  0.026730060577392578
generate_one_block  0.02459263801574707
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003414154052734375  GigaBytes
Max Memory Allocated: 0.0003414154052734375  GigaBytes

connection checking time:  0.1833934783935547
block generation total time  0.17001938819885254
average batch blocks generation time:  0.042504847049713135
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.03064727783203125  GigaBytes
Max Memory Allocated: 0.03064727783203125  GigaBytes

torch.Size([15864, 500])
torch.Size([11101, 64])
torch.Size([2977, 64])
torch.Size([612, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.0438389778137207  GigaBytes
Max Memory Allocated: 0.043897151947021484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.02868938446044922  GigaBytes
Max Memory Allocated: 0.057572364807128906  GigaBytes

torch.Size([14218, 500])
torch.Size([8289, 64])
torch.Size([2557, 64])
torch.Size([628, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.03919410705566406  GigaBytes
Max Memory Allocated: 0.057572364807128906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.03327226638793945  GigaBytes
Max Memory Allocated: 0.05972003936767578  GigaBytes

torch.Size([17017, 500])
torch.Size([12105, 64])
torch.Size([4111, 64])
torch.Size([897, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.04938793182373047  GigaBytes
Max Memory Allocated: 0.05972003936767578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.031537532806396484  GigaBytes
Max Memory Allocated: 0.06252527236938477  GigaBytes

torch.Size([16186, 500])
torch.Size([10526, 64])
torch.Size([3027, 64])
torch.Size([740, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.0450439453125  GigaBytes
Max Memory Allocated: 0.06252527236938477  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011837899684906006 |0.08653688430786133 |0.19748955965042114 |0.0001760721206665039 |0.00534290075302124 |0.002989053726196289 |
----------------------------------------------------------pseudo_mini_loss sum 2.3543803691864014
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  121212
Number of first layer input nodes during this epoch:  63285
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.033797264099121094  GigaBytes
Max Memory Allocated: 0.06252527236938477  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005309581756591797
range selection method range initialization spend 6.103515625e-05
time for parepare:  5.245208740234375e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.9325485229492188e-05
----------------------check_connections_block total spend ----------------------------- 0.001031637191772461
generate_one_block  0.0011403560638427734
generate_one_block  0.0010864734649658203
generate_one_block  0.00146484375
generate_one_block  0.0010571479797363281
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005440711975097656
gen group dst list time:  3.504753112792969e-05
time for parepare:  0.00030112266540527344
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.00043272972106933594
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  0.00015115737915039062
r_  generation:  0.00104522705078125
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0003466606140136719
mini_batch_src_global generation:  0.00010466575622558594
r_  generation:  0.0005755424499511719
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0005230903625488281
----------------------check_connections_block total spend ----------------------------- 0.005208730697631836
generate_one_block  0.003832101821899414
generate_one_block  0.0031747817993164062
generate_one_block  0.00276947021484375
generate_one_block  0.002100706100463867
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001737833023071289
gen group dst list time:  0.00011587142944335938
time for parepare:  0.0011150836944580078
local_output_nid generation:  9.894371032714844e-05
local_in_edges_tensor generation:  0.0004911422729492188
mini_batch_src_global generation:  0.0004322528839111328
r_  generation:  0.00406336784362793
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.00024509429931640625
mini_batch_src_global generation:  0.0003490447998046875
r_  generation:  0.0028066635131835938
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.00018095970153808594
r_  generation:  0.0013985633850097656
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  0.0001385211944580078
r_  generation:  0.0013740062713623047
----------------------check_connections_block total spend ----------------------------- 0.015616178512573242
generate_one_block  0.005007743835449219
generate_one_block  0.00462651252746582
generate_one_block  0.002629518508911133
generate_one_block  0.0025086402893066406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020945072174072266
gen group dst list time:  0.00022554397583007812
time for parepare:  0.0013799667358398438
local_output_nid generation:  0.0002987384796142578
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.0009284019470214844
r_  generation:  0.011424779891967773
local_output_nid generation:  0.0002751350402832031
local_in_edges_tensor generation:  0.0006678104400634766
mini_batch_src_global generation:  0.0011858940124511719
r_  generation:  0.010391950607299805
local_output_nid generation:  0.00019931793212890625
local_in_edges_tensor generation:  0.00046944618225097656
mini_batch_src_global generation:  0.0007860660552978516
r_  generation:  0.00676727294921875
local_output_nid generation:  0.0001971721649169922
local_in_edges_tensor generation:  0.0004532337188720703
mini_batch_src_global generation:  0.0006532669067382812
r_  generation:  0.0063724517822265625
----------------------check_connections_block total spend ----------------------------- 0.0521392822265625
generate_one_block  0.01471567153930664
generate_one_block  0.014981985092163086
generate_one_block  0.010579586029052734
generate_one_block  0.009902000427246094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018794536590576172
gen group dst list time:  0.0007719993591308594
time for parepare:  0.0015921592712402344
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0018434524536132812
mini_batch_src_global generation:  0.0017256736755371094
r_  generation:  0.01988530158996582
local_output_nid generation:  0.0009250640869140625
local_in_edges_tensor generation:  0.0016045570373535156
mini_batch_src_global generation:  0.0020627975463867188
r_  generation:  0.019380807876586914
local_output_nid generation:  0.0008988380432128906
local_in_edges_tensor generation:  0.0013306140899658203
mini_batch_src_global generation:  0.0013256072998046875
r_  generation:  0.017085552215576172
local_output_nid generation:  0.0010504722595214844
local_in_edges_tensor generation:  0.001378774642944336
mini_batch_src_global generation:  0.0015113353729248047Using backend: pytorch

r_  generation:  0.018131732940673828
----------------------check_connections_block total spend ----------------------------- 0.10969805717468262
generate_one_block  0.026625633239746094
generate_one_block  0.026561975479125977
generate_one_block  0.02291274070739746
generate_one_block  0.02555704116821289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.033797264099121094  GigaBytes
Max Memory Allocated: 0.06252527236938477  GigaBytes

connection checking time:  0.1826622486114502
block generation total time  0.17848610877990723
average batch blocks generation time:  0.04462152719497681
block dataloader generation time/epoch 0.3967163562774658
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.033535003662109375  GigaBytes
Max Memory Allocated: 0.06282520294189453  GigaBytes

torch.Size([16818, 500])
torch.Size([11293, 64])
torch.Size([4274, 64])
torch.Size([898, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.04948568344116211  GigaBytes
Max Memory Allocated: 0.06282520294189453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.0318608283996582  GigaBytes
Max Memory Allocated: 0.06282520294189453  GigaBytes

torch.Size([15934, 500])
torch.Size([10912, 64])
torch.Size([3671, 64])
torch.Size([805, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.04603290557861328  GigaBytes
Max Memory Allocated: 0.06282520294189453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.02950572967529297  GigaBytes
Max Memory Allocated: 0.06282520294189453  GigaBytes

torch.Size([14768, 500])
torch.Size([8905, 64])
torch.Size([2231, 64])
torch.Size([554, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.04006004333496094  GigaBytes
Max Memory Allocated: 0.06282520294189453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.030883312225341797  GigaBytes
Max Memory Allocated: 0.06282520294189453  GigaBytes

torch.Size([15505, 500])
torch.Size([10387, 64])
torch.Size([2248, 64])
torch.Size([606, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.04362058639526367  GigaBytes
Max Memory Allocated: 0.06282520294189453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009834468364715576 |0.0015655755996704102 |0.006526291370391846 |0.00015628337860107422 |0.004225313663482666 |0.0027723312377929688 |
----------------------------------------------------------pseudo_mini_loss sum 1.8049805164337158
Total (block generation + training)time/epoch 0.4960756301879883
Training time/epoch 0.09900593757629395
Training time without block to device /epoch 0.0927436351776123
Training time without total dataloading part /epoch 0.04640388488769531
load block tensor time/epoch 0.039337873458862305
block to device time/epoch 0.006262302398681641
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  120166
Number of first layer input nodes during this epoch:  63025
