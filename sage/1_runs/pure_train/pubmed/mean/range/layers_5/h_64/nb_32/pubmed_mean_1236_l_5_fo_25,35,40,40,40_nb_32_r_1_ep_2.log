main start at this time 1648532084.460735
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003414154052734375  GigaBytes
Max Memory Allocated: 0.0003414154052734375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0019731521606445312
range selection method range initialization spend 8.7738037109375e-05
time for parepare:  4.291534423828125e-05
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.0014858245849609375
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.654594421386719e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.58306884765625e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.1205673217773438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.511543273925781e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.58306884765625e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.511543273925781e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.440017700195312e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.463859558105469e-05
mini_batch_src_global generation:  1.2636184692382812e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.440017700195312e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  8.535385131835938e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.392333984375e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.7881393432617188e-05
----------------------check_connections_block total spend ----------------------------- 0.0040395259857177734
generate_one_block  0.00121307373046875
generate_one_block  0.0009851455688476562
generate_one_block  0.0009791851043701172
generate_one_block  0.0009706020355224609
generate_one_block  0.000988006591796875
generate_one_block  0.0009768009185791016
generate_one_block  0.001004934310913086
generate_one_block  0.0009818077087402344
generate_one_block  0.0009763240814208984
generate_one_block  0.0009682178497314453
generate_one_block  0.0009720325469970703
generate_one_block  0.0009691715240478516
generate_one_block  0.0009772777557373047
generate_one_block  0.0009632110595703125
generate_one_block  0.0010151863098144531
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0015897750854492188
gen group dst list time:  7.677078247070312e-05
time for parepare:  0.00022935867309570312
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0001232624053955078
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  5.6743621826171875e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  0.00010204315185546875
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00013947486877441406
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.982948303222656e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0001780986785888672
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  9.989738464355469e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  8.225440979003906e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  8.320808410644531e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00012636184692382812
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  9.012222290039062e-05
----------------------check_connections_block total spend ----------------------------- 0.004253864288330078
generate_one_block  0.0011773109436035156
generate_one_block  0.0010991096496582031
generate_one_block  0.00106048583984375
generate_one_block  0.000995635986328125
generate_one_block  0.0011096000671386719
generate_one_block  0.0012559890747070312
generate_one_block  0.0010187625885009766
generate_one_block  0.0010235309600830078
generate_one_block  0.0012586116790771484
generate_one_block  0.001093149185180664
generate_one_block  0.0010633468627929688
generate_one_block  0.0011286735534667969
generate_one_block  0.0011548995971679688
generate_one_block  0.0010840892791748047
generate_one_block  0.001119375228881836
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011358261108398438
gen group dst list time:  0.00011420249938964844
time for parepare:  0.0006861686706542969
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0002503395080566406
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0007410049438476562
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.0005309581756591797
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0003848075866699219
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00015783309936523438
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0003829002380371094
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  0.00011610984802246094
r_  generation:  0.0011701583862304688
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.0003299713134765625
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0002999305725097656
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.0013682842254638672
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  0.00010442733764648438
r_  generation:  0.0007750988006591797
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0004703998565673828
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0004374980926513672
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0007829666137695312
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0003724098205566406
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0005197525024414062
----------------------check_connections_block total spend ----------------------------- 0.015374183654785156
generate_one_block  0.002613067626953125
generate_one_block  0.0017027854919433594
generate_one_block  0.001440286636352539
generate_one_block  0.0011477470397949219
generate_one_block  0.0015232563018798828
generate_one_block  0.002418041229248047
generate_one_block  0.0013489723205566406
generate_one_block  0.0013217926025390625
generate_one_block  0.002691507339477539
generate_one_block  0.0018978118896484375
generate_one_block  0.0015075206756591797
generate_one_block  0.0014498233795166016
generate_one_block  0.002227783203125
generate_one_block  0.0013325214385986328
generate_one_block  0.0015597343444824219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020253658294677734
gen group dst list time:  0.00029349327087402344
time for parepare:  0.0015192031860351562
local_output_nid generation:  0.00010275840759277344
local_in_edges_tensor generation:  0.00058746337890625
mini_batch_src_global generation:  0.0005662441253662109
r_  generation:  0.004477739334106445
local_output_nid generation:  7.343292236328125e-05
local_in_edges_tensor generation:  0.00025010108947753906
mini_batch_src_global generation:  0.00044226646423339844
r_  generation:  0.003084421157836914
local_output_nid generation:  9.965896606445312e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  0.00029349327087402344
r_  generation:  0.002881765365600586
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.0007250308990478516
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  0.00012040138244628906
r_  generation:  0.0013065338134765625
local_output_nid generation:  0.00011777877807617188
local_in_edges_tensor generation:  0.0003273487091064453
mini_batch_src_global generation:  0.00045752525329589844
r_  generation:  0.00505518913269043
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.0003657341003417969
r_  generation:  0.002438068389892578
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.000286102294921875
r_  generation:  0.0024285316467285156
local_output_nid generation:  0.00012922286987304688
local_in_edges_tensor generation:  0.0003211498260498047
mini_batch_src_global generation:  0.00047278404235839844
r_  generation:  0.005278825759887695
local_output_nid generation:  0.00013756752014160156
local_in_edges_tensor generation:  0.0004329681396484375
mini_batch_src_global generation:  0.0004725456237792969
r_  generation:  0.004307985305786133
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.0002391338348388672
mini_batch_src_global generation:  0.0002989768981933594
r_  generation:  0.002609729766845703
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  0.0002536773681640625
r_  generation:  0.0022051334381103516
local_output_nid generation:  0.0001323223114013672
local_in_edges_tensor generation:  0.0003142356872558594
mini_batch_src_global generation:  0.0003631114959716797
r_  generation:  0.00421142578125
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  0.000274658203125
r_  generation:  0.002092123031616211
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  0.0002410411834716797
r_  generation:  0.0023889541625976562
----------------------check_connections_block total spend ----------------------------- 0.06897139549255371
generate_one_block  0.008129358291625977
generate_one_block  0.005202054977416992
generate_one_block  0.004876136779785156
generate_one_block  0.0017786026000976562
generate_one_block  0.0025780200958251953
generate_one_block  0.008407115936279297
generate_one_block  0.00423741340637207
generate_one_block  0.004052162170410156
generate_one_block  0.008287429809570312
generate_one_block  0.006641387939453125
generate_one_block  0.004320383071899414
generate_one_block  0.0039441585540771484
generate_one_block  0.007157802581787109
generate_one_block  0.0037267208099365234
generate_one_block  0.004011869430541992
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021963119506835938
gen group dst list time:  0.0015728473663330078
time for parepare:  0.001743316650390625
local_output_nid generation:  0.0006852149963378906
local_in_edges_tensor generation:  0.0016489028930664062
mini_batch_src_global generation:  0.0013642311096191406
r_  generation:  0.014229774475097656
local_output_nid generation:  0.0004000663757324219
local_in_edges_tensor generation:  0.0008866786956787109
mini_batch_src_global generation:  0.0010983943939208984
r_  generation:  0.009902477264404297
local_output_nid generation:  0.0003566741943359375
local_in_edges_tensor generation:  0.0006086826324462891
mini_batch_src_global generation:  0.0007166862487792969
r_  generation:  0.008993148803710938
local_output_nid generation:  0.0001461505889892578
local_in_edges_tensor generation:  0.0003123283386230469
mini_batch_src_global generation:  0.0004889965057373047
r_  generation:  0.003668546676635742
local_output_nid generation:  0.00018072128295898438
local_in_edges_tensor generation:  0.0003523826599121094
mini_batch_src_global generation:  0.0003859996795654297
r_  generation:  0.004196643829345703
local_output_nid generation:  0.0005080699920654297
local_in_edges_tensor generation:  0.0008020401000976562
mini_batch_src_global generation:  0.0009808540344238281
r_  generation:  0.011440515518188477
local_output_nid generation:  0.0003058910369873047
local_in_edges_tensor generation:  0.0005128383636474609
mini_batch_src_global generation:  0.0008428096771240234
r_  generation:  0.0074727535247802734
local_output_nid generation:  0.0003223419189453125
local_in_edges_tensor generation:  0.0005128383636474609
mini_batch_src_global generation:  0.0007090568542480469
r_  generation:  0.007417201995849609
local_output_nid generation:  0.0005207061767578125
local_in_edges_tensor generation:  0.0009291172027587891
mini_batch_src_global generation:  0.0009620189666748047
r_  generation:  0.011352062225341797
local_output_nid generation:  0.0006110668182373047
local_in_edges_tensor generation:  0.0008404254913330078
mini_batch_src_global generation:  0.0010676383972167969
r_  generation:  0.012789487838745117
local_output_nid generation:  0.00040435791015625
local_in_edges_tensor generation:  0.0007081031799316406
mini_batch_src_global generation:  0.0007998943328857422
r_  generation:  0.009524106979370117
local_output_nid generation:  0.00041747093200683594
local_in_edges_tensor generation:  0.0006194114685058594
mini_batch_src_global generation:  0.0007722377777099609
r_  generation:  0.007967710494995117
local_output_nid generation:  0.0005676746368408203
local_in_edges_tensor generation:  0.0009119510650634766
mini_batch_src_global generation:  0.001127004623413086
r_  generation:  0.01319742202758789
local_output_nid generation:  0.0003781318664550781
local_in_edges_tensor generation:  0.0005934238433837891
mini_batch_src_global generation:  0.0009160041809082031
r_  generation:  0.008329391479492188
local_output_nid generation:  0.00036144256591796875
local_in_edges_tensor generation:  0.0005559921264648438
mini_batch_src_global generation:  0.0007414817810058594
r_  generation:  0.007663726806640625
----------------------check_connections_block total spend ----------------------------- 0.20457005500793457
generate_one_block  0.019473791122436523
generate_one_block  0.013943910598754883
generate_one_block  0.012620925903320312
generate_one_block  0.0056493282318115234
generate_one_block  0.006213188171386719
generate_one_block  0.017462491989135742
generate_one_block  0.010706424713134766
generate_one_block  0.010585784912109375
generate_one_block  0.01566290855407715
generate_one_block  0.018083572387695312
generate_one_block  0.012873172760009766
generate_one_block  0.010891199111938477
generate_one_block  0.0177156925201416
generate_one_block  0.011764049530029297
generate_one_block  0.010648250579833984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003414154052734375  GigaBytes
Max Memory Allocated: 0.0003414154052734375  GigaBytes

connection checking time:  0.2931694984436035
block generation total time  0.3144705295562744
average batch blocks generation time:  0.020964701970418293
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1092529296875 GB
    Memory Allocated: 0.026384353637695312  GigaBytes
Max Memory Allocated: 0.026384353637695312  GigaBytes

torch.Size([13707, 500])
torch.Size([8159, 64])
torch.Size([1453, 64])
torch.Size([303, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03511238098144531  GigaBytes
Max Memory Allocated: 0.03590869903564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.019016265869140625  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

torch.Size([9646, 500])
torch.Size([4614, 64])
torch.Size([900, 64])
torch.Size([163, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.02456951141357422  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.018020153045654297  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

torch.Size([9128, 500])
torch.Size([3545, 64])
torch.Size([946, 64])
torch.Size([93, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.02222919464111328  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.009429931640625  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

torch.Size([4633, 500])
torch.Size([1400, 64])
torch.Size([221, 64])
torch.Size([78, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.010970115661621094  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.011879920959472656  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

torch.Size([5931, 500])
torch.Size([1938, 64])
torch.Size([607, 64])
torch.Size([153, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.014384746551513672  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.0226593017578125  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

torch.Size([11159, 500])
torch.Size([5843, 64])
torch.Size([1581, 64])
torch.Size([326, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.029713153839111328  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.014672279357910156  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

torch.Size([7363, 500])
torch.Size([3281, 64])
torch.Size([599, 64])
torch.Size([112, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.018262863159179688  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.01444244384765625  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

torch.Size([7241, 500])
torch.Size([3422, 64])
torch.Size([583, 64])
torch.Size([108, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.018125057220458984  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.021246910095214844  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

torch.Size([10775, 500])
torch.Size([5918, 64])
torch.Size([1567, 64])
torch.Size([343, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.02883434295654297  GigaBytes
Max Memory Allocated: 0.044178009033203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.026536941528320312  GigaBytes
Max Memory Allocated: 0.046140193939208984  GigaBytes

torch.Size([13480, 500])
torch.Size([6123, 64])
torch.Size([1554, 64])
torch.Size([228, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.03364896774291992  GigaBytes
Max Memory Allocated: 0.046140193939208984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.022490501403808594  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

torch.Size([11182, 500])
torch.Size([4350, 64])
torch.Size([980, 64])
torch.Size([156, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.027420520782470703  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.018958091735839844  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

torch.Size([9666, 500])
torch.Size([4407, 64])
torch.Size([702, 64])
torch.Size([215, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.024116039276123047  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.02653980255126953  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

torch.Size([13449, 500])
torch.Size([6691, 64])
torch.Size([1587, 64])
torch.Size([310, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.03423166275024414  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.018140792846679688  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

torch.Size([9221, 500])
torch.Size([3819, 64])
torch.Size([592, 64])
torch.Size([152, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.02219676971435547  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.018787860870361328  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

torch.Size([9576, 500])
torch.Size([3612, 64])
torch.Size([948, 64])
torch.Size([194, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.023090362548828125  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006245168050130209 |0.02361138661702474 |0.05653050740559896 |0.00013608932495117186 |0.004256312052408854 |0.003013134002685547 |
----------------------------------------------------------pseudo_mini_loss sum 3.0716652870178223
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  231390
Number of first layer input nodes during this epoch:  146157
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.020076751708984375  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005037784576416016
range selection method range initialization spend 5.364418029785156e-05
time for parepare:  5.14984130859375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.1682510375976562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.002716064453125e-05
----------------------check_connections_block total spend ----------------------------- 0.002631664276123047
generate_one_block  0.0010883808135986328
generate_one_block  0.0012524127960205078
generate_one_block  0.0010106563568115234
generate_one_block  0.0009937286376953125
generate_one_block  0.0010280609130859375
generate_one_block  0.0010137557983398438
generate_one_block  0.00098419189453125
generate_one_block  0.0009829998016357422
generate_one_block  0.0009779930114746094
generate_one_block  0.0009822845458984375
generate_one_block  0.0009558200836181641
generate_one_block  0.0009431838989257812
generate_one_block  0.0009398460388183594
generate_one_block  0.0009379386901855469
generate_one_block  0.0009477138519287109
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006551742553710938
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.0002636909484863281
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00016880035400390625
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00012159347534179688
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00012063980102539062
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00014591217041015625
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0001690387725830078
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  5.91278076171875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00013256072998046875
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.00011801719665527344
----------------------check_connections_block total spend ----------------------------- 0.004545927047729492
generate_one_block  0.0010645389556884766
generate_one_block  0.0011944770812988281
generate_one_block  0.0011372566223144531
generate_one_block  0.0011754035949707031
generate_one_block  0.0011663436889648438
generate_one_block  0.001207590103149414
generate_one_block  0.0010411739349365234
generate_one_block  0.0010263919830322266
generate_one_block  0.0010161399841308594
generate_one_block  0.0010929107666015625
generate_one_block  0.0010998249053955078
generate_one_block  0.0009839534759521484
generate_one_block  0.0026078224182128906
generate_one_block  0.001009225845336914
generate_one_block  0.0010952949523925781
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011544227600097656
gen group dst list time:  0.0001270771026611328
time for parepare:  0.0008175373077392578
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.00024437904357910156
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  0.00014710426330566406
r_  generation:  0.0012674331665039062
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0008783340454101562
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0006394386291503906
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.001003265380859375
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  0.00015354156494140625
r_  generation:  0.0013048648834228516
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.00025916099548339844
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.0003809928894042969
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0003046989440917969
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0005173683166503906
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0006680488586425781
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00023055076599121094
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.0002028942108154297
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.0002727508544921875
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0008108615875244141
----------------------check_connections_block total spend ----------------------------- 0.016220569610595703
generate_one_block  0.001340627670288086
generate_one_block  0.0024635791778564453
generate_one_block  0.0020813941955566406
generate_one_block  0.0016715526580810547
generate_one_block  0.002162933349609375
generate_one_block  0.002476930618286133
generate_one_block  0.001238107681274414
generate_one_block  0.0014197826385498047
generate_one_block  0.0013241767883300781
generate_one_block  0.0016722679138183594
generate_one_block  0.0017116069793701172
generate_one_block  0.001211404800415039
generate_one_block  0.0011661052703857422
generate_one_block  0.0012135505676269531
generate_one_block  0.002207517623901367
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020182132720947266
gen group dst list time:  0.000331878662109375
time for parepare:  0.0015249252319335938
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.0004451274871826172
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.001522064208984375
local_output_nid generation:  0.0001366138458251953
local_in_edges_tensor generation:  0.00034117698669433594
mini_batch_src_global generation:  0.0006287097930908203
r_  generation:  0.005361795425415039
local_output_nid generation:  0.0001766681671142578
local_in_edges_tensor generation:  0.0003826618194580078
mini_batch_src_global generation:  0.0005474090576171875
r_  generation:  0.0047414302825927734
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.0002608299255371094
mini_batch_src_global generation:  0.00032448768615722656
r_  generation:  0.0028138160705566406
local_output_nid generation:  0.00015282630920410156
local_in_edges_tensor generation:  0.00035762786865234375
mini_batch_src_global generation:  0.0004570484161376953
r_  generation:  0.005124568939208984
local_output_nid generation:  0.00011873245239257812
local_in_edges_tensor generation:  0.00032329559326171875
mini_batch_src_global generation:  0.0005338191986083984
r_  generation:  0.0046770572662353516
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.0002605915069580078
r_  generation:  0.0016779899597167969
local_output_nid generation:  8.606910705566406e-05
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.0002906322479248047
r_  generation:  0.003101825714111328
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  0.0002968311309814453
r_  generation:  0.0023419857025146484
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  0.00036597251892089844
r_  generation:  0.0037348270416259766
local_output_nid generation:  9.799003601074219e-05
local_in_edges_tensor generation:  0.0002732276916503906
mini_batch_src_global generation:  0.0003638267517089844
r_  generation:  0.0046231746673583984
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  0.00021386146545410156
r_  generation:  0.0015101432800292969
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.0012629032135009766
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  0.000133514404296875
r_  generation:  0.0011718273162841797
local_output_nid generation:  0.00013065338134765625
local_in_edges_tensor generation:  0.0003178119659423828
mini_batch_src_global generation:  0.0003962516784667969
r_  generation:  0.004648447036743164
----------------------check_connections_block total spend ----------------------------- 0.0726158618927002
generate_one_block  0.003500223159790039
generate_one_block  0.00797724723815918
generate_one_block  0.006901264190673828
generate_one_block  0.004807949066162109
generate_one_block  0.008088111877441406
generate_one_block  0.007113218307495117
generate_one_block  0.003146648406982422
generate_one_block  0.00612187385559082
generate_one_block  0.0040416717529296875
generate_one_block  0.005981922149658203
generate_one_block  0.005353212356567383
generate_one_block  0.0029888153076171875
generate_one_block  0.0025925636291503906
generate_one_block  0.0024111270904541016
generate_one_block  0.007969141006469727
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022034645080566406
gen group dst list time:  0.0016040802001953125
time for parepare:  0.0019321441650390625
local_output_nid generation:  0.00029730796813964844
local_in_edges_tensor generation:  0.0009703636169433594
mini_batch_src_global generation:  0.0007836818695068359
r_  generation:  0.006681680679321289
local_output_nid generation:  0.00045609474182128906
local_in_edges_tensor generation:  0.0008347034454345703
mini_batch_src_global generation:  0.0011506080627441406
r_  generation:  0.010763406753540039
local_output_nid generation:  0.0005412101745605469
local_in_edges_tensor generation:  0.0010039806365966797
mini_batch_src_global generation:  0.0010950565338134766
r_  generation:  0.013063430786132812
local_output_nid generation:  0.00046539306640625
local_in_edges_tensor generation:  0.0007829666137695312
mini_batch_src_global generation:  0.0009233951568603516
r_  generation:  0.010452747344970703
local_output_nid generation:  0.0006422996520996094
local_in_edges_tensor generation:  0.0010800361633300781
mini_batch_src_global generation:  0.0011985301971435547
r_  generation:  0.01492166519165039
local_output_nid generation:  0.00043272972106933594
local_in_edges_tensor generation:  0.0007317066192626953
mini_batch_src_global generation:  0.0010268688201904297
r_  generation:  0.010405540466308594
local_output_nid generation:  0.00035190582275390625
local_in_edges_tensor generation:  0.0005860328674316406
mini_batch_src_global generation:  0.0008289813995361328
r_  generation:  0.007416725158691406
local_output_nid generation:  0.0004172325134277344
local_in_edges_tensor generation:  0.0006449222564697266
mini_batch_src_global generation:  0.0009329319000244141
r_  generation:  0.010266542434692383
local_output_nid generation:  0.0003342628479003906
local_in_edges_tensor generation:  0.0005419254302978516
mini_batch_src_global generation:  0.0008676052093505859
r_  generation:  0.008162498474121094
local_output_nid generation:  0.0005695819854736328
local_in_edges_tensor generation:  0.0008568763732910156
mini_batch_src_global generation:  0.001123666763305664
r_  generation:  0.012930870056152344
local_output_nid generation:  0.0006053447723388672
local_in_edges_tensor generation:  0.0008738040924072266
mini_batch_src_global generation:  0.0009233951568603516
r_  generation:  0.012127161026000977
local_output_nid generation:  0.0003285408020019531
local_in_edges_tensor generation:  0.0005486011505126953
mini_batch_src_global generation:  0.0007622241973876953
r_  generation:  0.006603240966796875
local_output_nid generation:  0.0002808570861816406
local_in_edges_tensor generation:  0.0005123615264892578
mini_batch_src_global generation:  0.0005919933319091797
r_  generation:  0.005735874176025391
local_output_nid generation:  0.00020837783813476562
local_in_edges_tensor generation:  0.00037670135498046875
mini_batch_src_global generation:  0.0004513263702392578
r_  generation:  0.004354715347290039
local_output_nid generation:  0.0007083415985107422
local_in_edges_tensor generation:  0.0010826587677001953
mini_batch_src_global generation:  0.0010497570037841797
r_  generation:  0.0168612003326416
----------------------check_connections_block total spend ----------------------------- 0.22336363792419434
generate_one_block  0.010930538177490234
generate_one_block  0.015041112899780273
generate_one_block  0.018740177154541016
generate_one_block  0.015087127685546875
generate_one_block  0.022356748580932617
generate_one_block  0.014475822448730469
generate_one_block  0.01238250732421875
generate_one_block  0.013721942901611328
generate_one_block  0.012279510498046875
generate_one_block  0.017421960830688477
generate_one_block  0.01624894142150879
generate_one_block  0.00991964340209961
generate_one_block  0.008555173873901367
generate_one_block  0.006223440170288086
generate_one_block  0.020934104919433594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.020076751708984375  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

connection checking time:  0.3167459964752197
block generation total time  0.3365936279296875
average batch blocks generation time:  0.0224395751953125
block dataloader generation time/epoch 0.7138633728027344
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.015600204467773438  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

torch.Size([7534, 500])
torch.Size([2863, 64])
torch.Size([416, 64])
torch.Size([102, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.01860523223876953  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.019370555877685547  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

torch.Size([9429, 500])
torch.Size([5183, 64])
torch.Size([1589, 64])
torch.Size([353, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.025907516479492188  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.027688026428222656  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

torch.Size([13890, 500])
torch.Size([6445, 64])
torch.Size([2029, 64])
torch.Size([253, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03557777404785156  GigaBytes
Max Memory Allocated: 0.04755449295043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.023184776306152344  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

torch.Size([11094, 500])
torch.Size([4828, 64])
torch.Size([1007, 64])
torch.Size([233, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.028615474700927734  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.02752208709716797  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

torch.Size([13763, 500])
torch.Size([6926, 64])
torch.Size([1843, 64])
torch.Size([329, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.035803794860839844  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.01864337921142578  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

torch.Size([9049, 500])
torch.Size([4789, 64])
torch.Size([1346, 64])
torch.Size([296, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.024543285369873047  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.016761302947998047  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

torch.Size([8139, 500])
torch.Size([3271, 64])
torch.Size([465, 64])
torch.Size([111, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.020187854766845703  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.018620967864990234  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

torch.Size([9080, 500])
torch.Size([4180, 64])
torch.Size([941, 64])
torch.Size([89, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.0233306884765625  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.016784191131591797  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

torch.Size([8127, 500])
torch.Size([3148, 64])
torch.Size([582, 64])
torch.Size([84, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.02024078369140625  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.023506641387939453  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

torch.Size([11659, 500])
torch.Size([5648, 64])
torch.Size([970, 64])
torch.Size([179, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.029567718505859375  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.023509502410888672  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

torch.Size([11683, 500])
torch.Size([5764, 64])
torch.Size([1087, 64])
torch.Size([270, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.029858112335205078  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.017481327056884766  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

torch.Size([8545, 500])
torch.Size([3262, 64])
torch.Size([430, 64])
torch.Size([102, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.020809173583984375  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.016219139099121094  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

torch.Size([7882, 500])
torch.Size([2806, 64])
torch.Size([399, 64])
torch.Size([92, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.01912546157836914  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.01252603530883789  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

torch.Size([5922, 500])
torch.Size([2169, 64])
torch.Size([405, 64])
torch.Size([132, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.014940738677978516  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.027579784393310547  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

torch.Size([13797, 500])
torch.Size([8192, 64])
torch.Size([1473, 64])
torch.Size([304, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03637218475341797  GigaBytes
Max Memory Allocated: 0.04870748519897461  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0054839134216308595 |0.0010291417439778647 |0.005549208323160807 |0.0001525243123372396 |0.0034350077311197918 |0.0022139549255371094 |
----------------------------------------------------------pseudo_mini_loss sum 2.573202133178711
Total (block generation + training)time/epoch 0.9698479175567627
Training time/epoch 0.2556498050689697
Training time without block to device /epoch 0.24021267890930176
Training time without total dataloading part /epoch 0.1392650604248047
load block tensor time/epoch 0.08225870132446289
block to device time/epoch 0.015437126159667969
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  237335
Number of first layer input nodes during this epoch:  149593
