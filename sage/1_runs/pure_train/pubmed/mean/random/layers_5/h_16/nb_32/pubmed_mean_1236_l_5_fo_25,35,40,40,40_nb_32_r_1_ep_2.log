main start at this time 1648531698.5582845
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.62939453125e-05  GigaBytes
Max Memory Allocated: 7.62939453125e-05  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013327598571777344
random selection method range initialization spend 0.00025272369384765625
time for parepare:  5.555152893066406e-05
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.002511739730834961
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.2649765014648438e-05
----------------------check_connections_block total spend ----------------------------- 0.005805015563964844
generate_one_block  0.001402139663696289
generate_one_block  0.0012502670288085938
generate_one_block  0.0012390613555908203
generate_one_block  0.0012316703796386719
generate_one_block  0.0012333393096923828
generate_one_block  0.0012371540069580078
generate_one_block  0.001085519790649414
generate_one_block  0.0010612010955810547
generate_one_block  0.0009446144104003906
generate_one_block  0.0009388923645019531
generate_one_block  0.0010056495666503906
generate_one_block  0.0009398460388183594
generate_one_block  0.0009396076202392578
generate_one_block  0.0009572505950927734
generate_one_block  0.0009951591491699219
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007226467132568359
gen group dst list time:  0.00010538101196289062
time for parepare:  0.0003161430358886719
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0002357959747314453
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00022101402282714844
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  9.012222290039062e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0001316070556640625
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00019550323486328125
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.367134094238281e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0001087188720703125
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.869171142578125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  9.083747863769531e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00020074844360351562
----------------------check_connections_block total spend ----------------------------- 0.005466461181640625
generate_one_block  0.0013113021850585938
generate_one_block  0.0015714168548583984
generate_one_block  0.0015234947204589844
generate_one_block  0.0013213157653808594
generate_one_block  0.001394033432006836
generate_one_block  0.0014698505401611328
generate_one_block  0.0010914802551269531
generate_one_block  0.0011501312255859375
generate_one_block  0.0011157989501953125
generate_one_block  0.0010209083557128906
generate_one_block  0.0010120868682861328
generate_one_block  0.001142740249633789
generate_one_block  0.0009670257568359375
generate_one_block  0.0010733604431152344
generate_one_block  0.0011599063873291016
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011153221130371094
gen group dst list time:  0.00015783309936523438
time for parepare:  0.0009157657623291016
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00025773048400878906
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00026488304138183594
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00021839141845703125
mini_batch_src_global generation:  0.0002052783966064453
r_  generation:  0.00156402587890625
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.0010814666748046875
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0002989768981933594
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0008249282836914062
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  0.00011181831359863281
r_  generation:  0.0011262893676757812
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0004279613494873047
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0004901885986328125
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.00046062469482421875
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00016117095947265625
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0003032684326171875
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005769729614257812
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  9.417533874511719e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0004456043243408203
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.0014204978942871094
----------------------check_connections_block total spend ----------------------------- 0.017306089401245117
generate_one_block  0.002113819122314453
generate_one_block  0.002893209457397461
generate_one_block  0.0021674633026123047
generate_one_block  0.0012235641479492188
generate_one_block  0.0020132064819335938
generate_one_block  0.0022339820861816406
generate_one_block  0.0014095306396484375
generate_one_block  0.001463174819946289
generate_one_block  0.0014910697937011719
generate_one_block  0.0011050701141357422
generate_one_block  0.0012769699096679688
generate_one_block  0.0016002655029296875
generate_one_block  0.0013136863708496094
generate_one_block  0.0014426708221435547
generate_one_block  0.002513885498046875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00202178955078125
gen group dst list time:  0.00031375885009765625
time for parepare:  0.0017540454864501953
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.0004172325134277344
mini_batch_src_global generation:  0.00018668174743652344
r_  generation:  0.001420736312866211
local_output_nid generation:  0.00018739700317382812
local_in_edges_tensor generation:  0.000457763671875
mini_batch_src_global generation:  0.0009255409240722656
r_  generation:  0.0072324275970458984
local_output_nid generation:  0.00016069412231445312
local_in_edges_tensor generation:  0.0003650188446044922
mini_batch_src_global generation:  0.0005843639373779297
r_  generation:  0.004922151565551758
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  0.0002269744873046875
r_  generation:  0.0011799335479736328
local_output_nid generation:  0.00014448165893554688
local_in_edges_tensor generation:  0.0003249645233154297
mini_batch_src_global generation:  0.0003407001495361328
r_  generation:  0.004230976104736328
local_output_nid generation:  0.0001506805419921875
local_in_edges_tensor generation:  0.0003693103790283203
mini_batch_src_global generation:  0.0006701946258544922
r_  generation:  0.005815982818603516
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  0.0003376007080078125
r_  generation:  0.0025262832641601562
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.00023031234741210938
r_  generation:  0.002125263214111328
local_output_nid generation:  8.96453857421875e-05
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  0.0003132820129394531
r_  generation:  0.003319263458251953
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  0.00017833709716796875
r_  generation:  0.0010187625885009766
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.00017333030700683594
r_  generation:  0.0017933845520019531
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.0002486705780029297
mini_batch_src_global generation:  0.0003380775451660156
r_  generation:  0.0033545494079589844
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  0.0001316070556640625
r_  generation:  0.0003921985626220703
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.00017786026000976562
r_  generation:  0.002108335494995117
local_output_nid generation:  0.00010561943054199219
local_in_edges_tensor generation:  0.00028705596923828125
mini_batch_src_global generation:  0.00042629241943359375
r_  generation:  0.0047512054443359375
----------------------check_connections_block total spend ----------------------------- 0.07054924964904785
generate_one_block  0.0037374496459960938
generate_one_block  0.009888648986816406
generate_one_block  0.006639003753662109
generate_one_block  0.0022215843200683594
generate_one_block  0.00667881965637207
generate_one_block  0.009190559387207031
generate_one_block  0.004113435745239258
generate_one_block  0.003736257553100586
generate_one_block  0.005794048309326172
generate_one_block  0.0023369789123535156
generate_one_block  0.003236055374145508
generate_one_block  0.005635976791381836
generate_one_block  0.0014002323150634766
generate_one_block  0.003686189651489258
generate_one_block  0.007856130599975586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00215911865234375
gen group dst list time:  0.0016057491302490234
time for parepare:  0.0018396377563476562
local_output_nid generation:  0.0002942085266113281
local_in_edges_tensor generation:  0.0009284019470214844
mini_batch_src_global generation:  0.0006835460662841797
r_  generation:  0.006140708923339844
local_output_nid generation:  0.000698089599609375
local_in_edges_tensor generation:  0.0011887550354003906
mini_batch_src_global generation:  0.001615285873413086
r_  generation:  0.016217947006225586
local_output_nid generation:  0.0006117820739746094
local_in_edges_tensor generation:  0.0010325908660888672
mini_batch_src_global generation:  0.001256704330444336
r_  generation:  0.01276254653930664
local_output_nid generation:  0.0002219676971435547
local_in_edges_tensor generation:  0.000408172607421875
mini_batch_src_global generation:  0.0005776882171630859
r_  generation:  0.004450082778930664
local_output_nid generation:  0.0006356239318847656
local_in_edges_tensor generation:  0.0009126663208007812
mini_batch_src_global generation:  0.00092315673828125
r_  generation:  0.013419628143310547
local_output_nid generation:  0.0008692741394042969
local_in_edges_tensor generation:  0.0017940998077392578
mini_batch_src_global generation:  0.0018186569213867188
r_  generation:  0.017556428909301758
local_output_nid generation:  0.0003826618194580078
local_in_edges_tensor generation:  0.000637054443359375
mini_batch_src_global generation:  0.0010194778442382812
r_  generation:  0.010126113891601562
local_output_nid generation:  0.0003829002380371094
local_in_edges_tensor generation:  0.0006124973297119141
mini_batch_src_global generation:  0.0007631778717041016
r_  generation:  0.007277965545654297
local_output_nid generation:  0.00040268898010253906
local_in_edges_tensor generation:  0.0006432533264160156
mini_batch_src_global generation:  0.0009171962738037109
r_  generation:  0.010779142379760742
local_output_nid generation:  0.00023794174194335938
local_in_edges_tensor generation:  0.0004298686981201172
mini_batch_src_global generation:  0.0006573200225830078
r_  generation:  0.0057260990142822266
local_output_nid generation:  0.00028324127197265625
local_in_edges_tensor generation:  0.0004868507385253906
mini_batch_src_global generation:  0.0006363391876220703
r_  generation:  0.00687718391418457
local_output_nid generation:  0.0003292560577392578
local_in_edges_tensor generation:  0.0005538463592529297
mini_batch_src_global generation:  0.0007493495941162109
r_  generation:  0.008076906204223633
local_output_nid generation:  8.797645568847656e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  0.0004513263702392578
r_  generation:  0.0023217201232910156
local_output_nid generation:  0.00029015541076660156
local_in_edges_tensor generation:  0.0005049705505371094
mini_batch_src_global generation:  0.0006706714630126953
r_  generation:  0.008230209350585938
local_output_nid generation:  0.0003941059112548828
local_in_edges_tensor generation:  0.0006692409515380859
mini_batch_src_global generation:  0.0010211467742919922
r_  generation:  0.01133871078491211
----------------------check_connections_block total spend ----------------------------- 0.2083113193511963
generate_one_block  0.010128021240234375
generate_one_block  0.020398855209350586
generate_one_block  0.017118215560913086
generate_one_block  0.007159233093261719
generate_one_block  0.016922473907470703
generate_one_block  0.025228500366210938
generate_one_block  0.014147520065307617
generate_one_block  0.010690689086914062
generate_one_block  0.014277935028076172
generate_one_block  0.008289813995361328
generate_one_block  0.01088857650756836
generate_one_block  0.01185464859008789
generate_one_block  0.003846406936645508
generate_one_block  0.01157069206237793
generate_one_block  0.01403951644897461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.62939453125e-05  GigaBytes
Max Memory Allocated: 7.62939453125e-05  GigaBytes

connection checking time:  0.3016331195831299
block generation total time  0.31729888916015625
average batch blocks generation time:  0.02115325927734375
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.014343738555908203  GigaBytes
Max Memory Allocated: 0.014343738555908203  GigaBytes

torch.Size([7561, 500])
torch.Size([2941, 16])
torch.Size([415, 16])
torch.Size([96, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.015262603759765625  GigaBytes
Max Memory Allocated: 0.01548624038696289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.02616405487060547  GigaBytes
Max Memory Allocated: 0.03962373733520508  GigaBytes

torch.Size([13225, 500])
torch.Size([7801, 16])
torch.Size([2058, 16])
torch.Size([441, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02903270721435547  GigaBytes
Max Memory Allocated: 0.03962373733520508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.024013519287109375  GigaBytes
Max Memory Allocated: 0.04897737503051758  GigaBytes

torch.Size([12393, 500])
torch.Size([6661, 16])
torch.Size([1734, 16])
torch.Size([401, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.026361942291259766  GigaBytes
Max Memory Allocated: 0.04897737503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.012265205383300781  GigaBytes
Max Memory Allocated: 0.04897737503051758  GigaBytes

torch.Size([6428, 500])
torch.Size([1970, 16])
torch.Size([388, 16])
torch.Size([129, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.012959003448486328  GigaBytes
Max Memory Allocated: 0.04897737503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.025991439819335938  GigaBytes
Max Memory Allocated: 0.04897737503051758  GigaBytes

torch.Size([13184, 500])
torch.Size([6440, 16])
torch.Size([1641, 16])
torch.Size([270, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.02825641632080078  GigaBytes
Max Memory Allocated: 0.04897737503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.02809619903564453  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([14577, 500])
torch.Size([9126, 16])
torch.Size([1949, 16])
torch.Size([413, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.031172752380371094  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.019726276397705078  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([10336, 500])
torch.Size([3807, 16])
torch.Size([838, 16])
torch.Size([101, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.021077632904052734  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.016225814819335938  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([8498, 500])
torch.Size([3677, 16])
torch.Size([720, 16])
torch.Size([179, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.01746368408203125  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.01902627944946289  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([9934, 500])
torch.Size([4195, 16])
torch.Size([995, 16])
torch.Size([119, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.02054882049560547  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.012817859649658203  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([6712, 500])
torch.Size([2331, 16])
torch.Size([280, 16])
torch.Size([52, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.013555049896240234  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.013921737670898438  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([7263, 500])
torch.Size([2979, 16])
torch.Size([571, 16])
torch.Size([104, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.014962196350097656  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.014085769653320312  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([7304, 500])
torch.Size([3819, 16])
torch.Size([928, 16])
torch.Size([151, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.015480995178222656  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.006786346435546875  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([3525, 500])
torch.Size([824, 16])
torch.Size([121, 16])
torch.Size([42, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.007081508636474609  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.01789236068725586  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([9364, 500])
torch.Size([3283, 16])
torch.Size([719, 16])
torch.Size([135, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.019093036651611328  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.018774032592773438  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([9754, 500])
torch.Size([4853, 16])
torch.Size([1430, 16])
torch.Size([305, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.020680904388427734  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007193533579508463 |0.0232301394144694 |0.05622851053873698 |0.00013488133748372396 |0.004634046554565429 |0.003139019012451172 |
----------------------------------------------------------pseudo_mini_loss sum 2.246138095855713
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  222847
Number of first layer input nodes during this epoch:  140058
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.019917011260986328  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005059242248535156
random selection method range initialization spend 0.00011348724365234375
time for parepare:  5.0067901611328125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.1682510375976562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.33514404296875e-05
----------------------check_connections_block total spend ----------------------------- 0.0027561187744140625
generate_one_block  0.001089334487915039
generate_one_block  0.0012748241424560547
generate_one_block  0.0010256767272949219
generate_one_block  0.0010280609130859375
generate_one_block  0.0010306835174560547
generate_one_block  0.0010237693786621094
generate_one_block  0.0010333061218261719
generate_one_block  0.0010297298431396484
generate_one_block  0.0010116100311279297
generate_one_block  0.001026153564453125
generate_one_block  0.0009925365447998047
generate_one_block  0.0009899139404296875
generate_one_block  0.0009317398071289062
generate_one_block  0.0009415149688720703
generate_one_block  0.0009405612945556641
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006151199340820312
gen group dst list time:  8.296966552734375e-05
time for parepare:  0.00027942657470703125
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  9.870529174804688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  9.751319885253906e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.034706115722656e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00017595291137695312
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00017142295837402344
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  5.316734313964844e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00018525123596191406
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00010800361633300781
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00017571449279785156
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  6.341934204101562e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  5.054473876953125e-05
----------------------check_connections_block total spend ----------------------------- 0.004830121994018555
generate_one_block  0.0011551380157470703
generate_one_block  0.0010826587677001953
generate_one_block  0.0010592937469482422
generate_one_block  0.001146078109741211
generate_one_block  0.0010945796966552734
generate_one_block  0.0011069774627685547
generate_one_block  0.001226663589477539
generate_one_block  0.0012307167053222656
generate_one_block  0.0010652542114257812
generate_one_block  0.001262664794921875
generate_one_block  0.0011456012725830078
generate_one_block  0.0011513233184814453
generate_one_block  0.00104522705078125
generate_one_block  0.0009999275207519531
generate_one_block  0.0009834766387939453
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001214742660522461
gen group dst list time:  0.000125885009765625
time for parepare:  0.0007810592651367188
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0002779960632324219
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0007021427154541016
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0002892017364501953
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.00037169456481933594
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.000621795654296875
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0002498626708984375
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0003826618194580078
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  0.00010442733764648438
r_  generation:  0.0010704994201660156
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  0.0001308917999267578
r_  generation:  0.0010790824890136719
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.00022101402282714844
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  0.00012636184692382812
r_  generation:  0.0013828277587890625
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  0.0001232624053955078
r_  generation:  0.0009217262268066406
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  0.00015044212341308594
r_  generation:  0.0014090538024902344
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0002732276916503906
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0002963542938232422
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.0002491474151611328
----------------------check_connections_block total spend ----------------------------- 0.017009973526000977
generate_one_block  0.0019402503967285156
generate_one_block  0.0012576580047607422
generate_one_block  0.0013599395751953125
generate_one_block  0.001744985580444336
generate_one_block  0.001172780990600586
generate_one_block  0.0013577938079833984
generate_one_block  0.0021631717681884766
generate_one_block  0.0021772384643554688
generate_one_block  0.0011515617370605469
generate_one_block  0.002668142318725586
generate_one_block  0.0020706653594970703
generate_one_block  0.002851247787475586
generate_one_block  0.0012235641479492188
generate_one_block  0.0012655258178710938
generate_one_block  0.0011894702911376953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020525455474853516
gen group dst list time:  0.0003521442413330078
time for parepare:  0.0015120506286621094
local_output_nid generation:  0.00011968612670898438
local_in_edges_tensor generation:  0.0005753040313720703
mini_batch_src_global generation:  0.00040793418884277344
r_  generation:  0.004302501678466797
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  0.0002887248992919922
r_  generation:  0.001967191696166992
local_output_nid generation:  7.05718994140625e-05
local_in_edges_tensor generation:  0.000244140625
mini_batch_src_global generation:  0.00032830238342285156
r_  generation:  0.0031871795654296875
local_output_nid generation:  0.00012087821960449219
local_in_edges_tensor generation:  0.0003066062927246094
mini_batch_src_global generation:  0.0003666877746582031
r_  generation:  0.003754138946533203
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.00016355514526367188
r_  generation:  0.000885009765625
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  0.00013256072998046875
r_  generation:  0.0014562606811523438
local_output_nid generation:  0.00015783309936523438
local_in_edges_tensor generation:  0.00033855438232421875
mini_batch_src_global generation:  0.00034737586975097656
r_  generation:  0.004578113555908203
local_output_nid generation:  0.0001480579376220703
local_in_edges_tensor generation:  0.0003685951232910156
mini_batch_src_global generation:  0.0006601810455322266
r_  generation:  0.005396604537963867
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.0002524852752685547
r_  generation:  0.0014050006866455078
local_output_nid generation:  0.00015783309936523438
local_in_edges_tensor generation:  0.00034618377685546875
mini_batch_src_global generation:  0.00045299530029296875
r_  generation:  0.005535125732421875
local_output_nid generation:  0.00017452239990234375
local_in_edges_tensor generation:  0.0004024505615234375
mini_batch_src_global generation:  0.0007367134094238281
r_  generation:  0.0059320926666259766
local_output_nid generation:  0.00010561943054199219
local_in_edges_tensor generation:  0.00028395652770996094
mini_batch_src_global generation:  0.0005142688751220703
r_  generation:  0.0046999454498291016
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  0.00021457672119140625
r_  generation:  0.001008749008178711
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  0.0001239776611328125
r_  generation:  0.0011832714080810547
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  0.00013399124145507812
r_  generation:  0.0012156963348388672
----------------------check_connections_block total spend ----------------------------- 0.07053160667419434
generate_one_block  0.006635904312133789
generate_one_block  0.003455638885498047
generate_one_block  0.0048980712890625
generate_one_block  0.00562739372253418
generate_one_block  0.0018630027770996094
generate_one_block  0.002766847610473633
generate_one_block  0.007092952728271484
generate_one_block  0.00946807861328125
generate_one_block  0.0026655197143554688
generate_one_block  0.008251667022705078
generate_one_block  0.00911259651184082
generate_one_block  0.007039546966552734
generate_one_block  0.002164125442504883
generate_one_block  0.0024504661560058594
generate_one_block  0.002477407455444336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002209901809692383
gen group dst list time:  0.0015532970428466797
time for parepare:  0.001924276351928711
local_output_nid generation:  0.00048613548278808594
local_in_edges_tensor generation:  0.0012936592102050781
mini_batch_src_global generation:  0.0010852813720703125
r_  generation:  0.010845661163330078
local_output_nid generation:  0.00037670135498046875
local_in_edges_tensor generation:  0.0006997585296630859
mini_batch_src_global generation:  0.0011157989501953125
r_  generation:  0.008724689483642578
local_output_nid generation:  0.0003845691680908203
local_in_edges_tensor generation:  0.0007150173187255859
mini_batch_src_global generation:  0.0008592605590820312
r_  generation:  0.008926153182983398
local_output_nid generation:  0.000560760498046875
local_in_edges_tensor generation:  0.0009100437164306641
mini_batch_src_global generation:  0.0011906623840332031
r_  generation:  0.012553215026855469
local_output_nid generation:  0.00015854835510253906
local_in_edges_tensor generation:  0.00034165382385253906
mini_batch_src_global generation:  0.0004992485046386719
r_  generation:  0.0033745765686035156
local_output_nid generation:  0.0002541542053222656
local_in_edges_tensor generation:  0.0004467964172363281
mini_batch_src_global generation:  0.0005128383636474609
r_  generation:  0.005288600921630859
local_output_nid generation:  0.0005574226379394531
local_in_edges_tensor generation:  0.000904083251953125
mini_batch_src_global generation:  0.0010104179382324219
r_  generation:  0.01294708251953125
local_output_nid generation:  0.0008437633514404297
local_in_edges_tensor generation:  0.0013120174407958984
mini_batch_src_global generation:  0.0015110969543457031
r_  generation:  0.0165708065032959
local_output_nid generation:  0.0002841949462890625
local_in_edges_tensor generation:  0.00047779083251953125
mini_batch_src_global generation:  0.0007410049438476562
r_  generation:  0.006220817565917969
local_output_nid generation:  0.0006663799285888672
local_in_edges_tensor generation:  0.000904083251953125
mini_batch_src_global generation:  0.0010561943054199219
r_  generation:  0.013594388961791992
local_output_nid generation:  0.000690460205078125
local_in_edges_tensor generation:  0.00110626220703125
mini_batch_src_global generation:  0.0015020370483398438
r_  generation:  0.016733646392822266
local_output_nid generation:  0.00040793418884277344
local_in_edges_tensor generation:  0.0007033348083496094
mini_batch_src_global generation:  0.0011630058288574219
r_  generation:  0.010986566543579102
local_output_nid generation:  0.00017380714416503906
local_in_edges_tensor generation:  0.0003502368927001953
mini_batch_src_global generation:  0.0005791187286376953
r_  generation:  0.00475001335144043
local_output_nid generation:  0.00022935867309570312
local_in_edges_tensor generation:  0.0004184246063232422
mini_batch_src_global generation:  0.0004687309265136719
r_  generation:  0.0047550201416015625
local_output_nid generation:  0.0001938343048095703
local_in_edges_tensor generation:  0.0003676414489746094
mini_batch_src_global generation:  0.0004382133483886719
r_  generation:  0.004604816436767578
----------------------check_connections_block total spend ----------------------------- 0.20785140991210938
generate_one_block  0.014560222625732422
generate_one_block  0.01353597640991211
generate_one_block  0.013033151626586914
generate_one_block  0.016078948974609375
generate_one_block  0.0066454410552978516
generate_one_block  0.008314847946166992
generate_one_block  0.016400575637817383
generate_one_block  0.02224135398864746
generate_one_block  0.009674787521362305
generate_one_block  0.017354249954223633
generate_one_block  0.022780179977416992
generate_one_block  0.014599084854125977
generate_one_block  0.00723576545715332
generate_one_block  0.007715702056884766
generate_one_block  0.006526470184326172
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.019917011260986328  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

connection checking time:  0.30022311210632324
block generation total time  0.3150155544281006
average batch blocks generation time:  0.021001036961873373
block dataloader generation time/epoch 0.6742196083068848
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.018840312957763672  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([9747, 500])
torch.Size([4965, 16])
torch.Size([1153, 16])
torch.Size([202, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.020605087280273438  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.019075870513916016  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([9935, 500])
torch.Size([3803, 16])
torch.Size([510, 16])
torch.Size([104, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.020294189453125  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.01635122299194336  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([8442, 500])
torch.Size([4045, 16])
torch.Size([686, 16])
torch.Size([78, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.017714977264404297  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.022962570190429688  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([11951, 500])
torch.Size([6010, 16])
torch.Size([1084, 16])
torch.Size([212, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.024938106536865234  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.008938789367675781  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([4590, 500])
torch.Size([1425, 16])
torch.Size([380, 16])
torch.Size([107, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.009473323822021484  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.013226032257080078  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([6847, 500])
torch.Size([2397, 16])
torch.Size([528, 16])
torch.Size([141, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.014081001281738281  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.024726390838623047  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([12883, 500])
torch.Size([6564, 16])
torch.Size([1914, 16])
torch.Size([365, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.027103900909423828  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.02820587158203125  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([14260, 500])
torch.Size([8938, 16])
torch.Size([1733, 16])
torch.Size([414, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.031154632568359375  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.013880252838134766  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([7187, 500])
torch.Size([2706, 16])
torch.Size([353, 16])
torch.Size([90, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.014760017395019531  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.022610187530517578  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([11702, 500])
torch.Size([6438, 16])
torch.Size([1744, 16])
torch.Size([382, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.025002479553222656  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.028228759765625  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([14472, 500])
torch.Size([7342, 16])
torch.Size([2166, 16])
torch.Size([219, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.030942916870117188  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.017725467681884766  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([9125, 500])
torch.Size([4913, 16])
torch.Size([1351, 16])
torch.Size([296, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.01960277557373047  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.010470390319824219  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([5384, 500])
torch.Size([1646, 16])
torch.Size([343, 16])
torch.Size([97, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.011082172393798828  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.014020442962646484  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([7286, 500])
torch.Size([2142, 16])
torch.Size([581, 16])
torch.Size([116, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.01481008529663086  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.011962413787841797  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([6183, 500])
torch.Size([2116, 16])
torch.Size([404, 16])
torch.Size([96, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.012688159942626953  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005009206136067709 |0.0008967717488606771 |0.005602327982584635 |0.00014869372049967447 |0.004971790313720703 |0.002613544464111328 |
----------------------------------------------------------pseudo_mini_loss sum 1.673067569732666
Total (block generation + training)time/epoch 0.9451696872711182
Training time/epoch 0.27074599266052246
Training time without block to device /epoch 0.2572944164276123
Training time without total dataloading part /epoch 0.16345572471618652
load block tensor time/epoch 0.07513809204101562
block to device time/epoch 0.013451576232910156
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  223649
Number of first layer input nodes during this epoch:  139994
