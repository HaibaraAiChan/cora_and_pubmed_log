main start at this time 1648531665.5980852
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.62939453125e-05  GigaBytes
Max Memory Allocated: 7.62939453125e-05  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001512289047241211
random selection method range initialization spend 0.00021791458129882812
time for parepare:  5.435943603515625e-05
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0002276897430419922
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0014448165893554688
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  6.842613220214844e-05
----------------------check_connections_block total spend ----------------------------- 0.002242565155029297
generate_one_block  0.0016231536865234375
generate_one_block  0.0013613700866699219
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001094818115234375
gen group dst list time:  3.0279159545898438e-05
time for parepare:  0.0002872943878173828
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00024056434631347656
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0008828639984130859
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.0006051063537597656
----------------------check_connections_block total spend ----------------------------- 0.0028514862060546875
generate_one_block  0.002508401870727539
generate_one_block  0.002031564712524414
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001180410385131836
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.0009088516235351562
local_output_nid generation:  0.0001659393310546875
local_in_edges_tensor generation:  0.0005199909210205078
mini_batch_src_global generation:  0.00048422813415527344
r_  generation:  0.005746364593505859
local_output_nid generation:  0.00010013580322265625
local_in_edges_tensor generation:  0.0003085136413574219
mini_batch_src_global generation:  0.0005440711975097656
r_  generation:  0.0038623809814453125
----------------------check_connections_block total spend ----------------------------- 0.01537632942199707
generate_one_block  0.007042407989501953
generate_one_block  0.00483250617980957
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022673606872558594
gen group dst list time:  0.00024199485778808594
time for parepare:  0.0016579627990722656
local_output_nid generation:  0.0006246566772460938
local_in_edges_tensor generation:  0.0014688968658447266
mini_batch_src_global generation:  0.0018646717071533203
r_  generation:  0.017794132232666016
local_output_nid generation:  0.0002892017364501953
local_in_edges_tensor generation:  0.0006222724914550781
mini_batch_src_global generation:  0.0013384819030761719
r_  generation:  0.011031150817871094
----------------------check_connections_block total spend ----------------------------- 0.0442049503326416
generate_one_block  0.021564245223999023
generate_one_block  0.015447378158569336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017004013061523438
gen group dst list time:  0.0004684925079345703
time for parepare:  0.0015187263488769531
local_output_nid generation:  0.0011408329010009766
local_in_edges_tensor generation:  0.00229644775390625
mini_batch_src_global generation:  0.002318143844604492
r_  generation:  0.02390122413635254
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0017600059509277344
mini_batch_src_global generation:  0.0022373199462890625
r_  generation:  0.020343542098999023
----------------------check_connections_block total spend ----------------------------- 0.0670006275177002
generate_one_block  0.028563976287841797
generate_one_block  0.02661275863647461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.62939453125e-05  GigaBytes
Max Memory Allocated: 7.62939453125e-05  GigaBytes

connection checking time:  0.12943339347839355
block generation total time  0.10860323905944824
average batch blocks generation time:  0.05430161952972412
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.035040855407714844  GigaBytes
Max Memory Allocated: 0.035040855407714844  GigaBytes

torch.Size([18190, 500])
torch.Size([15139, 16])
torch.Size([6368, 16])
torch.Size([1757, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.04134941101074219  GigaBytes
Max Memory Allocated: 0.04137849807739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.031054973602294922  GigaBytes
Max Memory Allocated: 0.06409406661987305  GigaBytes

torch.Size([16140, 500])
torch.Size([10561, 16])
torch.Size([3855, 16])
torch.Size([965, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03533220291137695  GigaBytes
Max Memory Allocated: 0.06409406661987305  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012488484382629395 |0.17166352272033691 |0.38725876808166504 |0.00022971630096435547 |0.007141470909118652 |0.003040313720703125 |
----------------------------------------------------------pseudo_mini_loss sum 2.0024220943450928
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  73330
Number of first layer input nodes during this epoch:  34330
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03306102752685547  GigaBytes
Max Memory Allocated: 0.06409406661987305  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006120204925537109
random selection method range initialization spend 0.00014209747314453125
time for parepare:  6.604194641113281e-05
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  8.702278137207031e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.985664367675781e-05
----------------------check_connections_block total spend ----------------------------- 0.0008161067962646484
generate_one_block  0.0016074180603027344
generate_one_block  0.001352548599243164
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006451606750488281
gen group dst list time:  3.314018249511719e-05
time for parepare:  0.00035572052001953125
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0007700920104980469
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation: Using backend: pytorch
 0.00014829635620117188
r_  generation:  0.0008094310760498047
----------------------check_connections_block total spend ----------------------------- 0.00319671630859375
generate_one_block  0.002234935760498047
generate_one_block  0.0023055076599121094
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001199960708618164
gen group dst list time:  9.918212890625e-05
time for parepare:  0.0010285377502441406
local_output_nid generation:  0.000156402587890625
local_in_edges_tensor generation:  0.0004668235778808594
mini_batch_src_global generation:  0.0005068778991699219
r_  generation:  0.004537105560302734
local_output_nid generation:  0.00012135505676269531
local_in_edges_tensor generation:  0.0003056526184082031
mini_batch_src_global generation:  0.0005316734313964844
r_  generation:  0.0044384002685546875
----------------------check_connections_block total spend ----------------------------- 0.014489412307739258
generate_one_block  0.005747795104980469
generate_one_block  0.0060918331146240234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016672611236572266
gen group dst list time:  0.00020432472229003906
time for parepare:  0.0013976097106933594
local_output_nid generation:  0.00042176246643066406
local_in_edges_tensor generation:  0.0010519027709960938
mini_batch_src_global generation:  0.0013380050659179688
r_  generation:  0.014424562454223633
local_output_nid generation:  0.00040268898010253906
local_in_edges_tensor generation:  0.0008556842803955078
mini_batch_src_global generation:  0.0015380382537841797
r_  generation:  0.013853073120117188
----------------------check_connections_block total spend ----------------------------- 0.042077064514160156
generate_one_block  0.01835036277770996
generate_one_block  0.0191042423248291
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0016644001007080078
gen group dst list time:  0.0005366802215576172
time for parepare:  0.0015568733215332031
local_output_nid generation:  0.00115203857421875
local_in_edges_tensor generation:  0.002112150192260742
mini_batch_src_global generation:  0.002184152603149414
r_  generation:  0.02345442771911621
local_output_nid generation:  0.0011458396911621094
local_in_edges_tensor generation:  0.002256155014038086
mini_batch_src_global generation:  0.0024979114532470703
r_  generation:  0.022472620010375977
----------------------check_connections_block total spend ----------------------------- 0.06974601745605469
generate_one_block  0.02813243865966797
generate_one_block  0.030811309814453125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03306102752685547  GigaBytes
Max Memory Allocated: 0.06409406661987305  GigaBytes

connection checking time:  0.12950921058654785
block generation total time  0.1127784252166748
average batch blocks generation time:  0.0563892126083374
block dataloader generation time/epoch 0.277233362197876
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03455543518066406  GigaBytes
Max Memory Allocated: 0.06409406661987305  GigaBytes

torch.Size([17865, 500])
torch.Size([14316, 16])
torch.Size([5339, 16])
torch.Size([1402, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.040241241455078125  GigaBytes
Max Memory Allocated: 0.06409406661987305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03448200225830078  GigaBytes
Max Memory Allocated: 0.06677007675170898  GigaBytes

torch.Size([17389, 500])
torch.Size([12871, 16])
torch.Size([5180, 16])
torch.Size([1346, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.039818763732910156  GigaBytes
Max Memory Allocated: 0.06677007675170898  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014845013618469238 |0.0020450353622436523 |0.00679469108581543 |0.0001653432846069336 |0.003594636917114258 |0.004899501800537109 |
----------------------------------------------------------pseudo_mini_loss sum 2.232612371444702
Total (block generation + training)time/epoch 0.34224796295166016
Training time/epoch 0.06414937973022461
Training time without block to device /epoch 0.060059309005737305
Training time without total dataloading part /epoch 0.02600884437561035
load block tensor time/epoch 0.029690027236938477
block to device time/epoch 0.004090070724487305
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  76064
Number of first layer input nodes during this epoch:  35254
