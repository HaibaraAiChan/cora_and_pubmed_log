main start at this time 1648531687.3352103
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.62939453125e-05  GigaBytes
Max Memory Allocated: 7.62939453125e-05  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005340576171875
random selection method range initialization spend 0.00016069412231445312
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0008840560913085938
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1696090698242188e-05
----------------------check_connections_block total spend ----------------------------- 0.0026276111602783203
generate_one_block  0.0011754035949707031
generate_one_block  0.0010387897491455078
generate_one_block  0.0010287761688232422
generate_one_block  0.001007080078125
generate_one_block  0.0010056495666503906
generate_one_block  0.001018524169921875
generate_one_block  0.0010159015655517578
generate_one_block  0.0010495185852050781
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005421638488769531
gen group dst list time:  5.173683166503906e-05
time for parepare:  0.00023055076599121094
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.000232696533203125
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0002334117889404297
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00026798248291015625
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00013947486877441406
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.000125885009765625
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00010156631469726562
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00016999244689941406
----------------------check_connections_block total spend ----------------------------- 0.0034084320068359375
generate_one_block  0.0013303756713867188
generate_one_block  0.0013048648834228516
generate_one_block  0.0013391971588134766
generate_one_block  0.00116729736328125
generate_one_block  0.0011017322540283203
generate_one_block  0.0011477470397949219
generate_one_block  0.0011589527130126953
generate_one_block  0.0012302398681640625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011582374572753906
gen group dst list time:  9.298324584960938e-05
time for parepare:  0.0007455348968505859
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.0003025531768798828
mini_batch_src_global generation:  0.00014925003051757812
r_  generation:  0.0016775131225585938
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.00016450881958007812
r_  generation:  0.0012612342834472656
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00017404556274414062
r_  generation:  0.001850128173828125
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  0.0001277923583984375
r_  generation:  0.0008707046508789062
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0005900859832763672
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0008537769317626953
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0005083084106445312
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  0.0001347064971923828
r_  generation:  0.0013914108276367188
----------------------check_connections_block total spend ----------------------------- 0.014804840087890625
generate_one_block  0.0037643909454345703
generate_one_block  0.0024175643920898438
generate_one_block  0.0031995773315429688
generate_one_block  0.001893758773803711
generate_one_block  0.0016219615936279297
generate_one_block  0.0019519329071044922
generate_one_block  0.0015027523040771484
generate_one_block  0.002562284469604492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018439292907714844
gen group dst list time:  0.0002586841583251953
time for parepare:  0.0015156269073486328
local_output_nid generation:  0.000213623046875
local_in_edges_tensor generation:  0.0007989406585693359
mini_batch_src_global generation:  0.000982522964477539
r_  generation:  0.0077457427978515625
local_output_nid generation:  0.00018739700317382812
local_in_edges_tensor generation:  0.0004181861877441406
mini_batch_src_global generation:  0.0006916522979736328
r_  generation:  0.0054302215576171875
local_output_nid generation:  0.00026297569274902344
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.0008323192596435547
r_  generation:  0.008703947067260742
local_output_nid generation:  0.00013184547424316406
local_in_edges_tensor generation:  0.0003139972686767578
mini_batch_src_global generation:  0.0005021095275878906
r_  generation:  0.004317522048950195
local_output_nid generation:  0.00011014938354492188
local_in_edges_tensor generation:  0.00028395652770996094
mini_batch_src_global generation:  0.0004181861877441406
r_  generation:  0.0041768550872802734
local_output_nid generation:  0.000118255615234375
local_in_edges_tensor generation:  0.00030040740966796875
mini_batch_src_global generation:  0.000446319580078125
r_  generation:  0.004380941390991211
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  0.00030922889709472656
r_  generation:  0.0024695396423339844
local_output_nid generation:  0.000110626220703125
local_in_edges_tensor generation:  0.0002925395965576172
mini_batch_src_global generation:  0.00043845176696777344
r_  generation:  0.0047664642333984375
----------------------check_connections_block total spend ----------------------------- 0.06328153610229492
generate_one_block  0.011702299118041992
generate_one_block  0.007683753967285156
generate_one_block  0.013105392456054688
generate_one_block  0.006515026092529297
generate_one_block  0.006747722625732422
generate_one_block  0.006784915924072266
generate_one_block  0.004102468490600586
generate_one_block  0.007818460464477539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002223968505859375
gen group dst list time:  0.0012090206146240234
time for parepare:  0.0017161369323730469
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.002035856246948242
mini_batch_src_global generation:  0.001706838607788086
r_  generation:  0.017799854278564453
local_output_nid generation:  0.0007050037384033203
local_in_edges_tensor generation:  0.0012967586517333984
mini_batch_src_global generation:  0.0015902519226074219
r_  generation:  0.013742446899414062
local_output_nid generation:  0.0009443759918212891
local_in_edges_tensor generation:  0.001481771469116211
mini_batch_src_global generation:  0.0015964508056640625
r_  generation:  0.020127296447753906
local_output_nid generation:  0.0006401538848876953
local_in_edges_tensor generation:  0.0010066032409667969
mini_batch_src_global generation:  0.0013248920440673828
r_  generation:  0.014007568359375
local_output_nid generation:  0.0005462169647216797
local_in_edges_tensor generation:  0.0009272098541259766
mini_batch_src_global generation:  0.001016855239868164
r_  generation:  0.013206958770751953
local_output_nid generation:  0.00048279762268066406
local_in_edges_tensor generation:  0.0007283687591552734
mini_batch_src_global generation:  0.000946044921875
r_  generation:  0.011202812194824219
local_output_nid generation:  0.00034308433532714844
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.0007951259613037109
r_  generation:  0.009873628616333008
local_output_nid generation:  0.0004038810729980469
local_in_edges_tensor generation:  0.0007236003875732422
mini_batch_src_global generation:  0.0008330345153808594
r_  generation:  0.011037111282348633
----------------------check_connections_block total spend ----------------------------- 0.1619274616241455
generate_one_block  0.023361921310424805
generate_one_block  0.017881155014038086
generate_one_block  0.027603626251220703
generate_one_block  0.01849222183227539
generate_one_block  0.017524003982543945
generate_one_block  0.015018701553344727
generate_one_block  0.014053583145141602
generate_one_block  0.015079736709594727
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.62939453125e-05  GigaBytes
Max Memory Allocated: 7.62939453125e-05  GigaBytes

connection checking time:  0.243422269821167
block generation total time  0.24216961860656738
average batch blocks generation time:  0.030271202325820923
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1092529296875 GB
    Memory Allocated: 0.02811288833618164  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

torch.Size([14592, 500])
torch.Size([9320, 16])
torch.Size([2367, 16])
torch.Size([529, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.031458377838134766  GigaBytes
Max Memory Allocated: 0.031467437744140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.026021957397460938  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

torch.Size([13376, 500])
torch.Size([7503, 16])
torch.Size([2016, 16])
torch.Size([525, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.028704166412353516  GigaBytes
Max Memory Allocated: 0.05288362503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.032166481018066406  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

torch.Size([16484, 500])
torch.Size([11233, 16])
torch.Size([3324, 16])
torch.Size([667, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.03626441955566406  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.026017189025878906  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

torch.Size([13289, 500])
torch.Size([6491, 16])
torch.Size([1491, 16])
torch.Size([278, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.028283119201660156  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.022716522216796875  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

torch.Size([11868, 500])
torch.Size([5731, 16])
torch.Size([1263, 16])
torch.Size([171, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.024723529815673828  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.01926708221435547  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

torch.Size([10035, 500])
torch.Size([5187, 16])
torch.Size([1383, 16])
torch.Size([254, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.021187305450439453  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.019271373748779297  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

torch.Size([10088, 500])
torch.Size([3764, 16])
torch.Size([830, 16])
torch.Size([177, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.02064228057861328  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.01876211166381836  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

torch.Size([9747, 500])
torch.Size([4836, 16])
torch.Size([1433, 16])
torch.Size([306, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.020668983459472656  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010483145713806152 |0.043501824140548706 |0.1005072295665741 |0.00013428926467895508 |0.004159748554229736 |0.0035398006439208984 |
----------------------------------------------------------pseudo_mini_loss sum 1.9195600748062134
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  170915
Number of first layer input nodes during this epoch:  99479
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.019906997680664062  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005171298980712891
random selection method range initialization spend 0.00011157989501953125
time for parepare:  5.0067901611328125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3589859008789062e-05
----------------------check_connections_block total spend ----------------------------- 0.0016019344329833984
generate_one_block  0.0011141300201416016
generate_one_block  0.001035451889038086
generate_one_block  0.0010068416595458984
generate_one_block  0.0010151863098144531
generate_one_block  0.0010006427764892578
generate_one_block  0.0010573863983154297
generate_one_block  0.0010151863098144531
generate_one_block  0.0010797977447509766
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005145072937011719
gen group dst list time:  5.173683166503906e-05
time for parepare:  0.00027751922607421875
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00013136863708496094
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00012302398681640625
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.000141143798828125
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0003020763397216797
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00021123886108398438
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002536773681640625
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001163482666015625
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.1021575927734375e-05
----------------------check_connections_block total spend ----------------------------- 0.003422260284423828
generate_one_block  0.001214742660522461
generate_one_block  0.0011668205261230469
generate_one_block  0.0011487007141113281
generate_one_block  0.0013909339904785156
generate_one_block  0.0012619495391845703
generate_one_block  0.0013179779052734375
generate_one_block  0.0011615753173828125
generate_one_block  0.0010502338409423828
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010485649108886719
gen group dst list time:  9.72747802734375e-05
time for parepare:  0.0007827281951904297
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00027060508728027344
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0009448528289794922
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  0.0001304149627685547
r_  generation:  0.0009183883666992188
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.0006158351898193359
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.0019273757934570312
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  0.00018906593322753906
r_  generation:  0.0015342235565185547
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.000247955322265625
r_  generation:  0.0021364688873291016
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  0.00010895729064941406
r_  generation:  0.0005474090576171875
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00023674964904785156
----------------------check_connections_block total spend ----------------------------- 0.014882087707519531
generate_one_block  0.0024132728576660156
generate_one_block  0.0020689964294433594
generate_one_block  0.001592874526977539
generate_one_block  0.0034351348876953125
generate_one_block  0.0028138160705566406
generate_one_block  0.0035941600799560547
generate_one_block  0.0015347003936767578
generate_one_block  0.0011982917785644531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002106904983520508
gen group dst list time:  0.00028777122497558594
time for parepare:  0.0013785362243652344
local_output_nid generation:  0.0001385211944580078
local_in_edges_tensor generation:  0.0006499290466308594
mini_batch_src_global generation:  0.0005464553833007812
r_  generation:  0.005574941635131836
local_output_nid generation:  0.000156402587890625
local_in_edges_tensor generation:  0.0004162788391113281
mini_batch_src_global generation:  0.0007555484771728516
r_  generation:  0.005713939666748047
local_output_nid generation:  8.988380432128906e-05
local_in_edges_tensor generation:  0.0002541542053222656
mini_batch_src_global generation:  0.0003218650817871094
r_  generation:  0.0023872852325439453
local_output_nid generation:  0.000255584716796875
local_in_edges_tensor generation:  0.0005500316619873047
mini_batch_src_global generation:  0.0006451606750488281
r_  generation:  0.008159160614013672
local_output_nid generation:  0.00017309188842773438
local_in_edges_tensor generation:  0.00042557716369628906
mini_batch_src_global generation:  0.0008156299591064453
r_  generation:  0.006188392639160156
local_output_nid generation:  0.000232696533203125
local_in_edges_tensor generation:  0.0004937648773193359
mini_batch_src_global generation:  0.0008618831634521484
r_  generation:  0.008287668228149414
local_output_nid generation:  8.726119995117188e-05
local_in_edges_tensor generation:  0.00023555755615234375
mini_batch_src_global generation:  0.0003674030303955078
r_  generation:  0.002216815948486328
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  0.00016069412231445312
r_  generation:  0.00124359130859375
----------------------check_connections_block total spend ----------------------------- 0.06013631820678711
generate_one_block  0.008957624435424805
generate_one_block  0.009063720703125
generate_one_block  0.003868579864501953
generate_one_block  0.011576652526855469
generate_one_block  0.009726524353027344
generate_one_block  0.0119476318359375
generate_one_block  0.0037393569946289062
generate_one_block  0.0025391578674316406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022203922271728516
gen group dst list time:  0.0010890960693359375
time for parepare:  0.0018372535705566406
local_output_nid generation:  0.0006797313690185547
local_in_edges_tensor generation:  0.0015816688537597656
mini_batch_src_global generation:  0.0014162063598632812
r_  generation:  0.014251470565795898
local_output_nid generation:  0.0007240772247314453
local_in_edges_tensor generation:  0.0013070106506347656
mini_batch_src_global generation:  0.0016131401062011719
r_  generation:  0.015450239181518555
local_output_nid generation:  0.0004019737243652344
local_in_edges_tensor generation:  0.0006480216979980469
mini_batch_src_global generation:  0.0007951259613037109
r_  generation:  0.007302522659301758
local_output_nid generation:  0.0009961128234863281
local_in_edges_tensor generation:  0.0014891624450683594
mini_batch_src_global generation:  0.004254579544067383
r_  generation:  0.019014596939086914
local_output_nid generation:  0.000759124755859375
local_in_edges_tensor generation:  0.0011837482452392578
mini_batch_src_global generation:  0.0014691352844238281
r_  generation:  0.014728069305419922
local_output_nid generation:  0.0008115768432617188
local_in_edges_tensor generation:  0.0026102066040039062
mini_batch_src_global generation:  0.0015382766723632812
r_  generation:  0.017785310745239258
local_output_nid generation:  0.00041556358337402344
local_in_edges_tensor generation:  0.0006866455078125
mini_batch_src_global generation:  0.0009453296661376953
r_  generation:  0.00827169418334961
local_output_nid generation:  0.0002276897430419922
local_in_edges_tensor generation:  0.00043129920959472656
mini_batch_src_global generation:  0.0005350112915039062
r_  generation:  0.004639148712158203
----------------------check_connections_block total spend ----------------------------- 0.15479040145874023
generate_one_block  0.019171476364135742
generate_one_block  0.021324634552001953
generate_one_block  0.011118650436401367
generate_one_block  0.024168014526367188
generate_one_block  0.019580602645874023
generate_one_block  0.02378249168395996
generate_one_block  0.012628793716430664
generate_one_block  0.006962299346923828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.019906997680664062  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

connection checking time:  0.2332310676574707
block generation total time  0.22852039337158203
average batch blocks generation time:  0.028565049171447754
block dataloader generation time/epoch 0.5052802562713623
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.02512979507446289  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

torch.Size([13051, 500])
torch.Size([7139, 16])
torch.Size([1619, 16])
torch.Size([308, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.027618885040283203  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.02624988555908203  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

torch.Size([13541, 500])
torch.Size([7865, 16])
torch.Size([1622, 16])
torch.Size([290, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.028919696807861328  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.017525672912597656  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

torch.Size([9114, 500])
torch.Size([3642, 16])
torch.Size([902, 16])
torch.Size([248, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.018843650817871094  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.03226757049560547  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

torch.Size([16265, 500])
torch.Size([11203, 16])
torch.Size([3228, 16])
torch.Size([764, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.036321163177490234  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.024790287017822266  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

torch.Size([12841, 500])
torch.Size([7468, 16])
torch.Size([2003, 16])
torch.Size([477, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.027544021606445312  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.02956390380859375  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

torch.Size([15321, 500])
torch.Size([8853, 16])
torch.Size([3042, 16])
torch.Size([512, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.03303670883178711  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.020314693450927734  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

torch.Size([10595, 500])
torch.Size([3627, 16])
torch.Size([918, 16])
torch.Size([213, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.0216522216796875  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.012053489685058594  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

torch.Size([6232, 500])
torch.Size([2115, 16])
torch.Size([404, 16])
torch.Size([96, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.01277923583984375  GigaBytes
Max Memory Allocated: 0.05678987503051758  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006638169288635254 |0.0010646581649780273 |0.0059157609939575195 |0.0001284182071685791 |0.003767669200897217 |0.0025451183319091797 |
----------------------------------------------------------pseudo_mini_loss sum 2.3695428371429443
Total (block generation + training)time/epoch 0.6592204570770264
Training time/epoch 0.15365386009216309
Training time without block to device /epoch 0.14513659477233887
Training time without total dataloading part /epoch 0.0810399055480957
load block tensor time/epoch 0.05310535430908203
block to device time/epoch 0.008517265319824219
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  165874
Number of first layer input nodes during this epoch:  96960
