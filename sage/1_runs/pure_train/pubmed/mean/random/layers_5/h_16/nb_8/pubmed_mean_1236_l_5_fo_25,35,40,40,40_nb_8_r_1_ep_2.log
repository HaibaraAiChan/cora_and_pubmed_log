main start at this time 1648531676.3762906
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.62939453125e-05  GigaBytes
Max Memory Allocated: 7.62939453125e-05  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012807846069335938
random selection method range initialization spend 0.0002193450927734375
time for parepare:  5.53131103515625e-05
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0017077922821044922
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  5.602836608886719e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.695487976074219e-05
----------------------check_connections_block total spend ----------------------------- 0.0029168128967285156
generate_one_block  0.0015544891357421875
generate_one_block  0.0013146400451660156
generate_one_block  0.0012640953063964844
generate_one_block  0.0012691020965576172
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0008413791656494141
gen group dst list time:  4.1484832763671875e-05
time for parepare:  0.0002951622009277344
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0005052089691162109
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0004277229309082031
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.0002644062042236328
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0003516674041748047
----------------------check_connections_block total spend ----------------------------- 0.003317117691040039
generate_one_block  0.0019805431365966797
generate_one_block  0.0017812252044677734
generate_one_block  0.0015418529510498047
generate_one_block  0.0017313957214355469
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012080669403076172
gen group dst list time:  9.393692016601562e-05
time for parepare:  0.0009362697601318359
local_output_nid generation:  9.870529174804688e-05
local_in_edges_tensor generation:  0.0003998279571533203
mini_batch_src_global generation:  0.0002913475036621094
r_  generation:  0.0034296512603759766
local_output_nid generation:  8.678436279296875e-05
local_in_edges_tensor generation:  0.00028014183044433594
mini_batch_src_global generation:  0.0003581047058105469
r_  generation:  0.0028820037841796875
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  0.00019216537475585938
r_  generation:  0.001516103744506836
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.00024390220642089844
mini_batch_src_global generation:  0.0002620220184326172
r_  generation:  0.0024008750915527344
----------------------check_connections_block total spend ----------------------------- 0.016618728637695312
generate_one_block  0.004738569259643555
generate_one_block  0.003893136978149414
generate_one_block  0.0023932456970214844
generate_one_block  0.003545522689819336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021283626556396484
gen group dst list time:  0.00030803680419921875
time for parepare:  0.0017709732055664062
local_output_nid generation:  0.0004353523254394531
local_in_edges_tensor generation:  0.0010602474212646484
mini_batch_src_global generation:  0.0014221668243408203
r_  generation:  0.013967752456665039
local_output_nid generation:  0.0003273487091064453
local_in_edges_tensor generation:  0.0007712841033935547
mini_batch_src_global generation:  0.001547098159790039
r_  generation:  0.011593818664550781
local_output_nid generation:  0.00019550323486328125
local_in_edges_tensor generation:  0.0004334449768066406
mini_batch_src_global generation:  0.0007979869842529297
r_  generation:  0.0066416263580322266
local_output_nid generation:  0.00021719932556152344
local_in_edges_tensor generation:  0.00046563148498535156
mini_batch_src_global generation:  0.0007009506225585938
r_  generation:  0.006887674331665039
----------------------check_connections_block total spend ----------------------------- 0.05915260314941406
generate_one_block  0.015477895736694336
generate_one_block  0.01689004898071289
generate_one_block  0.010893106460571289
generate_one_block  0.010637044906616211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017383098602294922
gen group dst list time:  0.0007576942443847656
time for parepare:  0.0018057823181152344
local_output_nid generation:  0.001108407974243164
local_in_edges_tensor generation:  0.002444744110107422
mini_batch_src_global generation:  0.002118349075317383
r_  generation:  0.021542072296142578
local_output_nid generation:  0.00115203857421875
local_in_edges_tensor generation:  0.0022873878479003906
mini_batch_src_global generation:  0.0024132728576660156
r_  generation:  0.02239537239074707
local_output_nid generation:  0.0008881092071533203
local_in_edges_tensor generation:  0.0012478828430175781
mini_batch_src_global generation:  0.0014591217041015625
r_  generation:  0.017903804779052734
local_output_nid generation:  0.0007402896881103516
local_in_edges_tensor generation:  0.001062631607055664
mini_batch_src_global generation:  0.001279592514038086
r_  generation:  0.015413761138916016
----------------------check_connections_block total spend ----------------------------- 0.11461639404296875
generate_one_block  0.02631688117980957
generate_one_block  0.029032230377197266
generate_one_block  0.023389816284179688
generate_one_block  0.019833803176879883
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.62939453125e-05  GigaBytes
Max Memory Allocated: 7.62939453125e-05  GigaBytes

connection checking time:  0.19370484352111816
block generation total time  0.17407631874084473
average batch blocks generation time:  0.04351907968521118
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03236246109008789  GigaBytes
Max Memory Allocated: 0.03236246109008789  GigaBytes

torch.Size([16861, 500])
torch.Size([12409, 16])
torch.Size([3932, 16])
torch.Size([1006, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.037062644958496094  GigaBytes
Max Memory Allocated: 0.03708076477050781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03314065933227539  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

torch.Size([17253, 500])
torch.Size([12573, 16])
torch.Size([4085, 16])
torch.Size([855, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03784942626953125  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.028260231018066406  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

torch.Size([14750, 500])
torch.Size([8525, 16])
torch.Size([2225, 16])
torch.Size([418, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.031336307525634766  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.025120258331298828  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

torch.Size([13069, 500])
torch.Size([7163, 16])
torch.Size([2456, 16])
torch.Size([585, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.02801370620727539  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021246790885925293 |0.08860480785369873 |0.19768762588500977 |0.0001976490020751953 |0.006041049957275391 |0.003177165985107422 |
----------------------------------------------------------pseudo_mini_loss sum 1.9115183353424072
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  118521
Number of first layer input nodes during this epoch:  61933
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.026645660400390625  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00047707557678222656
random selection method range initialization spend 0.00011086463928222656
time for parepare:  4.673004150390625e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.504753112792969e-05
----------------------check_connections_block total spend ----------------------------- 0.0010018348693847656
generate_one_block  0.0011456012725830078
generate_one_block  0.0011076927185058594
generate_one_block  0.0013575553894042969
generate_one_block  0.001035928726196289
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005350112915039062
gen group dst list time:  3.457069396972656e-05
time for parepare:  0.0002734661102294922
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00021266937255859375
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.00042366981506347656
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0003654956817626953
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0002970695495605469
----------------------check_connections_block total spend ----------------------------- 0.00281524658203125
generate_one_block  0.0013172626495361328
generate_one_block  0.0015292167663574219
generate_one_block  0.0014653205871582031
generate_one_block  0.0013899803161621094
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010304450988769531
gen group dst list time:  8.225440979003906e-05
time for parepare:  0.0007879734039306641
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.00030040740966796875
mini_batch_src_global generation:  0.00018262863159179688
r_  generation:  0.0015273094177246094
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.00024437904357910156
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.002349376678466797
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.0002372264862060547
mini_batch_src_global generation:  0.00029730796813964844
r_  generation:  0.002720355987548828
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.0020074844360351562
----------------------check_connections_block total spend ----------------------------- 0.013919353485107422
generate_one_block  0.0029532909393310547
generate_one_block  0.003826141357421875
generate_one_block  0.004542350769042969
generate_one_block  0.003290891647338867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020232200622558594
gen group dst list time:  0.00023651123046875
time for parepare:  0.0013921260833740234
local_output_nid generation:  0.00022077560424804688
local_in_edges_tensor generation:  0.0007836818695068359
mini_batch_src_global generation:  0.0008342266082763672
r_  generation:  0.008142948150634766
local_output_nid generation:  0.00028252601623535156
local_in_edges_tensor generation:  0.0006413459777832031
mini_batch_src_global generation:  0.0010762214660644531
r_  generation:  0.008441686630249023
local_output_nid generation:  0.00028967857360839844
local_in_edges_tensor generation:  0.0006649494171142578
mini_batch_src_global generation:  0.0010945796966552734
r_  generation:  0.011042594909667969
local_output_nid generation:  0.0002086162567138672
local_in_edges_tensor generation:  0.0004832744598388672
mini_batch_src_global generation:  0.000843048095703125
r_  generation:  0.007447242736816406
----------------------check_connections_block total spend ----------------------------- 0.052945613861083984
generate_one_block  0.011749505996704102
generate_one_block  0.011941671371459961
generate_one_block  0.014421463012695312
generate_one_block  0.011643171310424805
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020339488983154297
gen group dst list time:  0.0007655620574951172
time for parepare:  0.0016090869903564453
local_output_nid generation:  0.0010230541229248047
local_in_edges_tensor generation:  0.0018737316131591797
mini_batch_src_global generation:  0.0016312599182128906
r_  generation:  0.018446922302246094
local_output_nid generation:  0.0009059906005859375
local_in_edges_tensor generation:  0.0015904903411865234
mini_batch_src_global generation:  0.0019366741180419922
r_  generation:  0.018779754638671875
local_output_nid generation:  0.0009748935699462891
local_in_edges_tensor generation:  0.0015454292297363281
mini_batch_src_global generation:  0.0016169548034667969
r_  generation:  0.019891023635864258
local_output_nid generation:  0.0008041858673095703
local_in_edges_tensor generation:  0.0011906623840332031
mini_batch_src_global generation: Using backend: pytorch
 0.001478433609008789
r_  generation:  0.01708197593688965
----------------------check_connections_block total spend ----------------------------- 0.1095573902130127
generate_one_block  0.024222135543823242
generate_one_block  0.0249783992767334
generate_one_block  0.0272982120513916
generate_one_block  0.022245407104492188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.026645660400390625  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

connection checking time:  0.17923760414123535
block generation total time  0.16881442070007324
average batch blocks generation time:  0.04220360517501831
block dataloader generation time/epoch 0.3827357292175293
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.02921295166015625  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

torch.Size([15150, 500])
torch.Size([10158, 16])
torch.Size([2470, 16])
torch.Size([542, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.032769203186035156  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.0312800407409668  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

torch.Size([16250, 500])
torch.Size([11163, 16])
torch.Size([3666, 16])
torch.Size([904, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03548622131347656  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.031139373779296875  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

torch.Size([16112, 500])
torch.Size([10901, 16])
torch.Size([3920, 16])
torch.Size([826, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03544282913208008  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.027771472930908203  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

torch.Size([14395, 500])
torch.Size([8292, 16])
torch.Size([2487, 16])
torch.Size([589, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.030942440032958984  GigaBytes
Max Memory Allocated: 0.06369209289550781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01024782657623291 |0.0012188553810119629 |0.005400717258453369 |0.00012934207916259766 |0.0046160221099853516 |0.0022618770599365234 |
----------------------------------------------------------pseudo_mini_loss sum 1.987776279449463
Total (block generation + training)time/epoch 0.4775075912475586
Training time/epoch 0.09430813789367676
Training time without block to device /epoch 0.0894327163696289
Training time without total dataloading part /epoch 0.0428462028503418
load block tensor time/epoch 0.04099130630493164
block to device time/epoch 0.0048754215240478516
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  118181
Number of first layer input nodes during this epoch:  61907
