main start at this time 1648531907.2372708
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006070137023925781
random selection method range initialization spend 0.00020432472229003906
time for parepare:  4.792213439941406e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.0010254383087158203
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.430511474609375e-05
----------------------check_connections_block total spend ----------------------------- 0.0027544498443603516
generate_one_block  0.0011777877807617188
generate_one_block  0.0010466575622558594
generate_one_block  0.0010364055633544922
generate_one_block  0.001031637191772461
generate_one_block  0.0010251998901367188
generate_one_block  0.0010592937469482422
generate_one_block  0.0010213851928710938
generate_one_block  0.0010554790496826172
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005362033843994141
gen group dst list time:  5.173683166503906e-05
time for parepare:  0.00025343894958496094
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0002808570861816406
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00015783309936523438
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0002460479736328125
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00016069412231445312
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010013580322265625
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0003025531768798828
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00011229515075683594
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.081031799316406e-05
----------------------check_connections_block total spend ----------------------------- 0.0035398006439208984
generate_one_block  0.0013508796691894531
generate_one_block  0.0012111663818359375
generate_one_block  0.001336812973022461
generate_one_block  0.0012264251708984375
generate_one_block  0.0011205673217773438
generate_one_block  0.0014040470123291016
generate_one_block  0.0012040138244628906
generate_one_block  0.0010921955108642578
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012106895446777344
gen group dst list time:  9.1552734375e-05
time for parepare:  0.0007812976837158203
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00032591819763183594
mini_batch_src_global generation:  0.00015926361083984375
r_  generation:  0.0016524791717529297
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.00014591217041015625
r_  generation:  0.0010592937469482422
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.000202178955078125
r_  generation:  0.002019643783569336
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.0008122920989990234
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0004642009735107422
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  0.0001647472381591797
r_  generation:  0.0020589828491210938
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0006062984466552734
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0004863739013671875
----------------------check_connections_block total spend ----------------------------- 0.01522207260131836
generate_one_block  0.00315093994140625
generate_one_block  0.0022122859954833984
generate_one_block  0.003356456756591797
generate_one_block  0.0018131732940673828
generate_one_block  0.001447439193725586
generate_one_block  0.003403902053833008
generate_one_block  0.0015745162963867188
generate_one_block  0.0014600753784179688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021207332611083984
gen group dst list time:  0.0002601146697998047
time for parepare:  0.0015895366668701172
local_output_nid generation:  0.00015687942504882812
local_in_edges_tensor generation:  0.0007050037384033203
mini_batch_src_global generation:  0.0007991790771484375
r_  generation:  0.006386518478393555
local_output_nid generation:  0.0001678466796875
local_in_edges_tensor generation:  0.0004239082336425781
mini_batch_src_global generation:  0.0007011890411376953
r_  generation:  0.00844573974609375
local_output_nid generation:  0.00022935867309570312
local_in_edges_tensor generation:  0.0006451606750488281
mini_batch_src_global generation:  0.0008065700531005859
r_  generation:  0.007256984710693359
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.00026917457580566406
mini_batch_src_global generation:  0.0003991127014160156
r_  generation:  0.003309488296508789
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  0.00026726722717285156
r_  generation:  0.0024929046630859375
local_output_nid generation:  0.00024318695068359375
local_in_edges_tensor generation:  0.0005202293395996094
mini_batch_src_global generation:  0.0008456707000732422
r_  generation:  0.010227203369140625
local_output_nid generation:  9.608268737792969e-05
local_in_edges_tensor generation:  0.0002627372741699219
mini_batch_src_global generation:  0.0004818439483642578
r_  generation:  0.0031859874725341797
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.0002391338348388672
mini_batch_src_global generation:  0.0003254413604736328
r_  generation:  0.0031790733337402344
----------------------check_connections_block total spend ----------------------------- 0.0659630298614502
generate_one_block  0.010043621063232422
generate_one_block  0.007758617401123047
generate_one_block  0.010748624801635742
generate_one_block  0.005238056182861328
generate_one_block  0.0044612884521484375
generate_one_block  0.01348423957824707
generate_one_block  0.0051195621490478516
generate_one_block  0.0051496028900146484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0047872066497802734
gen group dst list time:  0.0011076927185058594
time for parepare:  0.0018563270568847656
local_output_nid generation:  0.0006587505340576172
local_in_edges_tensor generation:  0.0014500617980957031
mini_batch_src_global generation:  0.001352548599243164
r_  generation:  0.01418304443359375
local_output_nid generation:  0.0006668567657470703
local_in_edges_tensor generation:  0.001409292221069336
mini_batch_src_global generation:  0.001827239990234375
r_  generation:  0.014998674392700195
local_output_nid generation:  0.0006492137908935547
local_in_edges_tensor generation:  0.0011882781982421875
mini_batch_src_global generation:  0.0012841224670410156
r_  generation:  0.0159456729888916
local_output_nid generation:  0.0005350112915039062
local_in_edges_tensor generation:  0.0007958412170410156
mini_batch_src_global generation:  0.0009582042694091797
r_  generation:  0.009525299072265625
local_output_nid generation:  0.00040721893310546875
local_in_edges_tensor generation:  0.0006768703460693359
mini_batch_src_global generation:  0.001010894775390625
r_  generation:  0.01093602180480957
local_output_nid generation:  0.0010039806365966797
local_in_edges_tensor generation:  0.0020275115966796875
mini_batch_src_global generation:  0.0015685558319091797
r_  generation:  0.021526575088500977
local_output_nid generation:  0.0004534721374511719
local_in_edges_tensor generation:  0.0008342266082763672
mini_batch_src_global generation:  0.0012552738189697266
r_  generation:  0.012174129486083984
local_output_nid generation:  0.00032711029052734375
local_in_edges_tensor generation:  0.0005936622619628906
mini_batch_src_global generation:  0.0009090900421142578
r_  generation:  0.00808858871459961
----------------------check_connections_block total spend ----------------------------- 0.1586153507232666
generate_one_block  0.017813444137573242
generate_one_block  0.020595073699951172
generate_one_block  0.02200937271118164
generate_one_block  0.014012336730957031
generate_one_block  0.013761520385742188
generate_one_block  0.02829909324645996
generate_one_block  0.01644611358642578
generate_one_block  0.012163639068603516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

connection checking time:  0.24334025382995605
block generation total time  0.23546910285949707
average batch blocks generation time:  0.029433637857437134
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.02643442153930664  GigaBytes
Max Memory Allocated: 0.02643442153930664  GigaBytes

torch.Size([12118, 500])
torch.Size([6827, 256])
torch.Size([1880, 256])
torch.Size([440, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.05791664123535156  GigaBytes
Max Memory Allocated: 0.0580744743347168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.03153181076049805  GigaBytes
Max Memory Allocated: 0.06296491622924805  GigaBytes

torch.Size([14032, 500])
torch.Size([7336, 256])
torch.Size([1921, 256])
torch.Size([351, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.06428289413452148  GigaBytes
Max Memory Allocated: 0.06631135940551758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.029499530792236328  GigaBytes
Max Memory Allocated: 0.06905221939086914  GigaBytes

torch.Size([12877, 500])
torch.Size([7836, 256])
torch.Size([2564, 256])
torch.Size([548, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.06748104095458984  GigaBytes
Max Memory Allocated: 0.06905221939086914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.02577972412109375  GigaBytes
Max Memory Allocated: 0.07000446319580078  GigaBytes

torch.Size([11035, 500])
torch.Size([5402, 256])
torch.Size([1151, 256])
torch.Size([328, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.04987525939941406  GigaBytes
Max Memory Allocated: 0.07000446319580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.026176929473876953  GigaBytes
Max Memory Allocated: 0.07000446319580078  GigaBytes

torch.Size([11254, 500])
torch.Size([4480, 256])
torch.Size([905, 256])
torch.Size([182, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.04501962661743164  GigaBytes
Max Memory Allocated: 0.07000446319580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.03746843338012695  GigaBytes
Max Memory Allocated: 0.07000446319580078  GigaBytes

torch.Size([17062, 500])
torch.Size([12302, 256])
torch.Size([3484, 256])
torch.Size([715, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.0938725471496582  GigaBytes
Max Memory Allocated: 0.09423446655273438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.02869415283203125  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

torch.Size([12337, 500])
torch.Size([4908, 256])
torch.Size([987, 256])
torch.Size([214, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.04932212829589844  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.019143104553222656  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

torch.Size([7494, 500])
torch.Size([3505, 256])
torch.Size([758, 256])
torch.Size([140, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.034056663513183594  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006148040294647217 |0.04316055774688721 |0.10164269804954529 |0.00017651915550231934 |0.004678249359130859 |0.0036041736602783203 |
----------------------------------------------------------pseudo_mini_loss sum 2.1537442207336426
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  167730
Number of first layer input nodes during this epoch:  98209
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.024688243865966797  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004923343658447266
random selection method range initialization spend 0.00011849403381347656
time for parepare:  4.982948303222656e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.0517578125e-05
----------------------check_connections_block total spend ----------------------------- 0.0016741752624511719
generate_one_block  0.0011026859283447266
generate_one_block  0.0010302066802978516
generate_one_block  0.0010344982147216797
generate_one_block  0.0010235309600830078
generate_one_block  0.0010330677032470703
generate_one_block  0.0010352134704589844
generate_one_block  0.0010476112365722656
generate_one_block  0.001154184341430664
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005273818969726562
gen group dst list time:  5.14984130859375e-05
time for parepare:  0.0002834796905517578
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.00026726722717285156
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00011801719665527344
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.000125885009765625
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00016617774963378906
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.00033783912658691406
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  9.5367431640625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00014066696166992188
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00017452239990234375
----------------------check_connections_block total spend ----------------------------- 0.003576517105102539
generate_one_block  0.0013756752014160156
generate_one_block  0.0011827945709228516
generate_one_block  0.0011889934539794922
generate_one_block  0.0012440681457519531
generate_one_block  0.0014426708221435547
generate_one_block  0.0011065006256103516
generate_one_block  0.0012145042419433594
generate_one_block  0.0012450218200683594
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012164115905761719
gen group dst list time:  9.512901306152344e-05
time for parepare:  0.0007810592651367188
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.0003142356872558594
mini_batch_src_global generation:  0.00022101402282714844
r_  generation:  0.0018062591552734375
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  0.0001289844512939453
r_  generation:  0.0007534027099609375
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0007605552673339844
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  0.00014328956604003906
r_  generation:  0.0013659000396728516
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.00024247169494628906
r_  generation:  0.002471923828125
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  0.00014019012451171875
r_  generation:  0.0004467964172363281
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0008895397186279297
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0009462833404541016
----------------------check_connections_block total spend ----------------------------- 0.01575636863708496
generate_one_block  0.00318145751953125
generate_one_block  0.0017895698547363281
generate_one_block  0.001804351806640625
generate_one_block  0.0027332305908203125
generate_one_block  0.004065990447998047
generate_one_block  0.0013992786407470703
generate_one_block  0.0019762516021728516
generate_one_block  0.0019729137420654297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019898414611816406
gen group dst list time:  0.0002887248992919922
time for parepare:  0.0014171600341796875
local_output_nid generation:  0.0001785755157470703
local_in_edges_tensor generation:  0.000682830810546875
mini_batch_src_global generation:  0.0006520748138427734
r_  generation:  0.007071018218994141
local_output_nid generation:  0.00012063980102539062
local_in_edges_tensor generation:  0.0003345012664794922
mini_batch_src_global generation:  0.0005779266357421875
r_  generation:  0.0046923160552978516
local_output_nid generation:  0.00012922286987304688
local_in_edges_tensor generation:  0.000324249267578125
mini_batch_src_global generation:  0.0003960132598876953
r_  generation:  0.003648042678833008
local_output_nid generation:  0.0002162456512451172
local_in_edges_tensor generation:  0.00046896934509277344
mini_batch_src_global generation:  0.0006453990936279297
r_  generation:  0.007390022277832031
local_output_nid generation:  0.00026917457580566406
local_in_edges_tensor generation:  0.0006070137023925781
mini_batch_src_global generation:  0.0012061595916748047
r_  generation:  0.010621309280395508
local_output_nid generation:  9.059906005859375e-05
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  0.0004494190216064453
r_  generation:  0.0025300979614257812
local_output_nid generation:  0.00015091896057128906
local_in_edges_tensor generation:  0.0003535747528076172
mini_batch_src_global generation:  0.0004756450653076172
r_  generation:  0.004979610443115234
local_output_nid generation:  0.0001373291015625
local_in_edges_tensor generation:  0.00031566619873046875
mini_batch_src_global generation:  0.00040340423583984375
r_  generation:  0.0037970542907714844
----------------------check_connections_block total spend ----------------------------- 0.06706452369689941
generate_one_block  0.01010751724243164
generate_one_block  0.006896018981933594
generate_one_block  0.00545954704284668
generate_one_block  0.010852575302124023
generate_one_block  0.013835906982421875
generate_one_block  0.00412750244140625
generate_one_block  0.007924079895019531
generate_one_block  0.006121158599853516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018076896667480469
gen group dst list time:  0.0011646747589111328
time for parepare:  0.0015933513641357422
local_output_nid generation:  0.0007441043853759766
local_in_edges_tensor generation:  0.0015819072723388672
mini_batch_src_global generation:  0.0014798641204833984
r_  generation:  0.015294075012207031
local_output_nid generation:  0.0005948543548583984
local_in_edges_tensor generation:  0.0010797977447509766
mini_batch_src_global generation:  0.0015749931335449219
r_  generation:  0.013931989669799805
local_output_nid generation:  0.0005831718444824219
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.001008749008178711
r_  generation:  0.01268768310546875
local_output_nid generation:  0.0008537769317626953
local_in_edges_tensor generation:  0.0013341903686523438
mini_batch_src_global generation:  0.0017344951629638672
r_  generation:  0.01813793182373047
local_output_nid generation:  0.000997304916381836
local_in_edges_tensor generation:  0.0015156269073486328
mini_batch_src_global generation:  0.0018265247344970703
r_  generation:  0.020575523376464844
local_output_nid generation:  0.0004050731658935547
local_in_edges_tensor generation:  0.002116680145263672
mini_batch_src_global generation:  0.000997781753540039
r_  generation:  0.00849151611328125
local_output_nid generation:  0.0005781650543212891
local_in_edges_tensor generation:  0.0009517669677734375
mini_batch_src_global generation:  0.001188516616821289
r_  generation:  0.014174222946166992
local_output_nid generation:  0.0005812644958496094
local_in_edges_tensor generation:  0.0008792877197265625
mini_batch_src_global generation:  0.0009129047393798828
r_  generation:  0.011790990829467773
----------------------check_connections_block total spend ----------------------------- 0.17026877403259277
generate_one_block  0.020497560501098633
generate_one_block  0.018837928771972656
generate_one_block  0.017033815383911133
generate_one_block  0.025959014892578125
generate_one_block  0.027194738388061523
generate_one_block  0.013151168823242188
generate_one_block  0.017276763916015625
generate_one_block  0.01510763168334961
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.024688243865966797  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

connection checking time:  0.2566661834716797
block generation total time  0.24930620193481445
average batch blocks generation time:  0.031163275241851807
block dataloader generation time/epoch 0.5525407791137695
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.035737037658691406  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

torch.Size([13528, 500])
torch.Size([7702, 256])
torch.Size([2032, 256])
torch.Size([476, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.07128000259399414  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.03365516662597656  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

torch.Size([12449, 500])
torch.Size([6438, 256])
torch.Size([1223, 256])
torch.Size([253, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.060242652893066406  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.03413581848144531  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

torch.Size([12874, 500])
torch.Size([5419, 256])
torch.Size([1345, 256])
torch.Size([256, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.05894136428833008  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.03877067565917969  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

torch.Size([15218, 500])
torch.Size([9276, 256])
torch.Size([2538, 256])
torch.Size([376, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.08093023300170898  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4783935546875 GB
    Memory Allocated: 0.04050397872924805  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

torch.Size([16076, 500])
torch.Size([11636, 256])
torch.Size([3243, 256])
torch.Size([771, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4822998046875 GB
    Memory Allocated: 0.09467363357543945  GigaBytes
Max Memory Allocated: 0.1003575325012207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4822998046875 GB
    Memory Allocated: 0.02839040756225586  GigaBytes
Max Memory Allocated: 0.10070991516113281  GigaBytes

torch.Size([9855, 500])
torch.Size([3577, 256])
torch.Size([714, 256])
torch.Size([152, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4822998046875 GB
    Memory Allocated: 0.04344797134399414  GigaBytes
Max Memory Allocated: 0.10070991516113281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4822998046875 GB
    Memory Allocated: 0.03367424011230469  GigaBytes
Max Memory Allocated: 0.10070991516113281  GigaBytes

torch.Size([12237, 500])
torch.Size([6197, 256])
torch.Size([1606, 256])
torch.Size([304, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4822998046875 GB
    Memory Allocated: 0.06171131134033203  GigaBytes
Max Memory Allocated: 0.10070991516113281  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4822998046875 GB
    Memory Allocated: 0.032935142517089844  GigaBytes
Max Memory Allocated: 0.10070991516113281  GigaBytes

torch.Size([12246, 500])
torch.Size([5852, 256])
torch.Size([1620, 256])
torch.Size([337, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4822998046875 GB
    Memory Allocated: 0.06068229675292969  GigaBytes
Max Memory Allocated: 0.10070991516113281  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008174717426300049 |0.0011014938354492188 |0.005801945924758911 |0.00013366341590881348 |0.004005849361419678 |0.002364635467529297 |
----------------------------------------------------------pseudo_mini_loss sum 1.9499690532684326
Total (block generation + training)time/epoch 0.7214558124542236
Training time/epoch 0.16855382919311523
Training time without block to device /epoch 0.15974187850952148
Training time without total dataloading part /epoch 0.08189630508422852
load block tensor time/epoch 0.06539773941040039
block to device time/epoch 0.00881195068359375
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  178183
Number of first layer input nodes during this epoch:  104483
