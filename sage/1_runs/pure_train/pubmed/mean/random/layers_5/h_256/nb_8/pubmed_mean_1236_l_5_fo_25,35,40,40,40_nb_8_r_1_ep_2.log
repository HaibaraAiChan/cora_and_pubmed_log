main start at this time 1648531896.3142142
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.002221345901489258
random selection method range initialization spend 0.00019311904907226562
time for parepare:  4.4345855712890625e-05
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0014834403991699219
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.7894973754882812e-05
----------------------check_connections_block total spend ----------------------------- 0.0024852752685546875
generate_one_block  0.002166748046875
generate_one_block  0.0010886192321777344
generate_one_block  0.0010004043579101562
generate_one_block  0.0010192394256591797
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012650489807128906
gen group dst list time:  3.0279159545898438e-05
time for parepare:  0.00022721290588378906
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0003554821014404297
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0003044605255126953
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0003154277801513672
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00027680397033691406
----------------------check_connections_block total spend ----------------------------- 0.002664327621459961
generate_one_block  0.0014872550964355469
generate_one_block  0.0013628005981445312
generate_one_block  0.0014300346374511719
generate_one_block  0.0013623237609863281
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009760856628417969
gen group dst list time:  7.152557373046875e-05
time for parepare:  0.0007531642913818359
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.0003364086151123047
mini_batch_src_global generation:  0.00021386146545410156
r_  generation:  0.002332448959350586
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00023603439331054688
mini_batch_src_global generation:  0.0002658367156982422
r_  generation:  0.002073526382446289
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.00018334388732910156
r_  generation:  0.0018582344055175781
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.00017714500427246094
r_  generation:  0.001789093017578125
----------------------check_connections_block total spend ----------------------------- 0.01294565200805664
generate_one_block  0.004328727722167969
generate_one_block  0.0036907196044921875
generate_one_block  0.0032401084899902344
generate_one_block  0.003185272216796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00609898567199707
gen group dst list time:  0.00022172927856445312
time for parepare:  0.001405477523803711
local_output_nid generation:  0.0002720355987548828
local_in_edges_tensor generation:  0.0009312629699707031
mini_batch_src_global generation:  0.0010423660278320312
r_  generation:  0.009961605072021484
local_output_nid generation:  0.00022363662719726562
local_in_edges_tensor generation:  0.0005204677581787109
mini_batch_src_global generation:  0.0011107921600341797
r_  generation:  0.008293867111206055
local_output_nid generation:  0.00022459030151367188
local_in_edges_tensor generation:  0.00048661231994628906
mini_batch_src_global generation:  0.0007750988006591797
r_  generation:  0.007911443710327148
local_output_nid generation:  0.00023365020751953125
local_in_edges_tensor generation:  0.0005044937133789062
mini_batch_src_global generation:  0.0008671283721923828
r_  generation:  0.00879979133605957
----------------------check_connections_block total spend ----------------------------- 0.0522918701171875
generate_one_block  0.014963626861572266
generate_one_block  0.01251673698425293
generate_one_block  0.011531591415405273
generate_one_block  0.01268458366394043
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021257400512695312
gen group dst list time:  0.0007357597351074219
time for parepare:  0.001699686050415039
local_output_nid generation:  0.0009415149688720703
local_in_edges_tensor generation:  0.002254962921142578
mini_batch_src_global generation:  0.0020227432250976562
r_  generation:  0.018974781036376953
local_output_nid generation:  0.0007538795471191406
local_in_edges_tensor generation:  0.0014421939849853516
mini_batch_src_global generation:  0.001840829849243164
r_  generation:  0.01723170280456543
local_output_nid generation:  0.0009098052978515625
local_in_edges_tensor generation:  0.0014278888702392578
mini_batch_src_global generation:  0.0013992786407470703
r_  generation:  0.018692731857299805
local_output_nid generation:  0.0009469985961914062
local_in_edges_tensor generation:  0.0017209053039550781
mini_batch_src_global generation:  0.001901865005493164
r_  generation:  0.019390583038330078
----------------------check_connections_block total spend ----------------------------- 0.11114096641540527
generate_one_block  0.02489304542541504
generate_one_block  0.02249312400817871
generate_one_block  0.023651123046875
generate_one_block  0.025398731231689453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

connection checking time:  0.17904281616210938
block generation total time  0.16821980476379395
average batch blocks generation time:  0.042054951190948486
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03452348709106445  GigaBytes
Max Memory Allocated: 0.03452348709106445  GigaBytes

torch.Size([16295, 500])
torch.Size([11075, 256])
torch.Size([3609, 256])
torch.Size([775, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.0880126953125  GigaBytes
Max Memory Allocated: 0.0883035659790039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.03304338455200195  GigaBytes
Max Memory Allocated: 0.09279727935791016  GigaBytes

torch.Size([14737, 500])
torch.Size([9275, 256])
torch.Size([2947, 256])
torch.Size([699, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.07843637466430664  GigaBytes
Max Memory Allocated: 0.09279727935791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.036866188049316406  GigaBytes
Max Memory Allocated: 0.09279727935791016  GigaBytes

torch.Size([16354, 500])
torch.Size([10639, 256])
torch.Size([3078, 256])
torch.Size([715, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.08648538589477539  GigaBytes
Max Memory Allocated: 0.09279727935791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.03690624237060547  GigaBytes
Max Memory Allocated: 0.09279727935791016  GigaBytes

torch.Size([16454, 500])
torch.Size([11520, 256])
torch.Size([3093, 256])
torch.Size([688, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.09059667587280273  GigaBytes
Max Memory Allocated: 0.09279727935791016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011833548545837402 |0.08632099628448486 |0.19529181718826294 |0.00015717744827270508 |0.0068711042404174805 |0.006880760192871094 |
----------------------------------------------------------pseudo_mini_loss sum 2.6798484325408936
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  122310
Number of first layer input nodes during this epoch:  63840
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.04351091384887695  GigaBytes
Max Memory Allocated: 0.0980215072631836  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005507469177246094
random selection method range initialization spend 0.00012421607971191406
time for parepare:  5.555152893066406e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.984306335449219e-05
----------------------check_connections_block total spend ----------------------------- 0.0011570453643798828
generate_one_block  0.0014581680297851562
generate_one_block  0.0010831356048583984
generate_one_block  0.001336812973022461
generate_one_block  0.001064300537109375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005323886871337891
gen group dst list time:  3.457069396972656e-05
time for parepare:  0.00028228759765625
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.00026607513427734375
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00023555755615234375
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0003769397735595703
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0003001689910888672
----------------------check_connections_block total spend ----------------------------- 0.002644062042236328
generate_one_block  0.0013916492462158203
generate_one_block  0.0013120174407958984
generate_one_block  0.0015323162078857422
generate_one_block  0.0013813972473144531
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009486675262451172
gen group dst list time:  7.772445678710938e-05
time for parepare:  0.0007190704345703125
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00029397010803222656
mini_batch_src_global generation:  0.0002536773681640625
r_  generation:  0.0019505023956298828
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  0.0002040863037109375
r_  generation:  0.0017805099487304688
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  0.0002655982971191406
r_  generation:  0.0028095245361328125
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  0.00019741058349609375
r_  generation:  0.0016798973083496094
----------------------check_connections_block total spend ----------------------------- 0.013188362121582031
generate_one_block  0.0037224292755126953
generate_one_block  0.0031359195709228516
generate_one_block  0.004653215408325195
generate_one_block  0.003055572509765625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002078533172607422
gen group dst list time:  0.00023031234741210938
time for parepare:  0.0014405250549316406
local_output_nid generation:  0.00019025802612304688
local_in_edges_tensor generation:  0.0007915496826171875
mini_batch_src_global generation:  0.0008187294006347656
r_  generation:  0.007837295532226562
local_output_nid generation:  0.00021576881408691406
local_in_edges_tensor generation:  0.0005366802215576172
mini_batch_src_global generation:  0.0011382102966308594
r_  generation:  0.008019447326660156
local_output_nid generation:  0.00030994415283203125
local_in_edges_tensor generation:  0.0007047653198242188
mini_batch_src_global generation:  0.0011870861053466797
r_  generation:  0.011680841445922852
local_output_nid generation:  0.00024890899658203125
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.0008761882781982422
r_  generation:  0.007943391799926758
----------------------check_connections_block total spend ----------------------------- 0.053354501724243164
generate_one_block  0.011564016342163086
generate_one_block  0.012124776840209961
generate_one_block  0.01577472686767578
generate_one_block  0.011509418487548828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020079612731933594
gen group dst list time:  0.0007271766662597656
time for parepare:  0.001581430435180664
local_output_nid generation:  0.0008485317230224609
local_in_edges_tensor generation:  0.0017595291137695312
mini_batch_src_global generation:  0.0016548633575439453
r_  generation:  0.01662898063659668
local_output_nid generation:  0.0008809566497802734
local_in_edges_tensor generation:  0.0016813278198242188
mini_batch_src_global generation:  0.001989126205444336
r_  generation:  0.018494606018066406
local_output_nid generation:  0.0011119842529296875
local_in_edges_tensor generation:  0.0017096996307373047
mini_batch_src_global generation:  0.001787424087524414
r_  generation:  0.020679473876953125
local_output_nid generation:  0.0009253025054931641
local_in_edges_tensor generation:  0.0014023780822753906
mini_batch_src_global generation: Using backend: pytorch
 0.0016317367553710938
r_  generation:  0.018678903579711914
----------------------check_connections_block total spend ----------------------------- 0.11070752143859863
generate_one_block  0.023382902145385742
generate_one_block  0.025128841400146484
generate_one_block  0.027728557586669922
generate_one_block  0.02370166778564453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.04351091384887695  GigaBytes
Max Memory Allocated: 0.0980215072631836  GigaBytes

connection checking time:  0.17989444732666016
block generation total time  0.17109942436218262
average batch blocks generation time:  0.042774856090545654
block dataloader generation time/epoch 0.3915584087371826
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.037964820861816406  GigaBytes
Max Memory Allocated: 0.0980215072631836  GigaBytes

torch.Size([14784, 500])
torch.Size([9203, 256])
torch.Size([2534, 256])
torch.Size([608, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.08157730102539062  GigaBytes
Max Memory Allocated: 0.0980215072631836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.0400691032409668  GigaBytes
Max Memory Allocated: 0.0980215072631836  GigaBytes

torch.Size([15886, 500])
torch.Size([10252, 256])
torch.Size([2781, 256])
torch.Size([614, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.08670568466186523  GigaBytes
Max Memory Allocated: 0.0980215072631836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.0425562858581543  GigaBytes
Max Memory Allocated: 0.0980215072631836  GigaBytes

torch.Size([17130, 500])
torch.Size([12710, 256])
torch.Size([4294, 256])
torch.Size([976, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.10548782348632812  GigaBytes
Max Memory Allocated: 0.106109619140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.040396690368652344  GigaBytes
Max Memory Allocated: 0.11040210723876953  GigaBytes

torch.Size([16071, 500])
torch.Size([9824, 256])
torch.Size([3227, 256])
torch.Size([653, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.08804988861083984  GigaBytes
Max Memory Allocated: 0.11040210723876953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009413719177246094 |0.0012204647064208984 |0.005883574485778809 |0.00012534856796264648 |0.004330992698669434 |0.002338409423828125 |
----------------------------------------------------------pseudo_mini_loss sum 1.7820849418640137
Total (block generation + training)time/epoch 0.4839508533477783
Training time/epoch 0.09203505516052246
Training time without block to device /epoch 0.08715319633483887
Training time without total dataloading part /epoch 0.04369807243347168
load block tensor time/epoch 0.037654876708984375
block to device time/epoch 0.004881858825683594
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  121903
Number of first layer input nodes during this epoch:  63871
