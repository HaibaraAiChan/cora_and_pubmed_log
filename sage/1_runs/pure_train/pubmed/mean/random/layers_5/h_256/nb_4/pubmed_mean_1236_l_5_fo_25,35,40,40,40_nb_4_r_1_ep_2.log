main start at this time 1648531885.7345147
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.002039670944213867
random selection method range initialization spend 0.0002295970916748047
time for parepare:  4.673004150390625e-05
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00226593017578125
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  6.103515625e-05
----------------------check_connections_block total spend ----------------------------- 0.002955198287963867
generate_one_block  0.0014095306396484375
generate_one_block  0.0011143684387207031
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0009253025054931641
gen group dst list time:  2.3603439331054688e-05
time for parepare:  0.0002338886260986328
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0007154941558837891
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  9.512901306152344e-05
r_  generation:  0.0005681514739990234
----------------------check_connections_block total spend ----------------------------- 0.0024383068084716797
generate_one_block  0.0019512176513671875
generate_one_block  0.0018010139465332031
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010256767272949219
gen group dst list time:  5.8650970458984375e-05
time for parepare:  0.00075531005859375
local_output_nid generation:  0.00010061264038085938
local_in_edges_tensor generation:  0.0004107952117919922
mini_batch_src_global generation:  0.000331878662109375
r_  generation:  0.004235506057739258
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.000286102294921875
mini_batch_src_global generation:  0.0004303455352783203
r_  generation:  0.003383636474609375
----------------------check_connections_block total spend ----------------------------- 0.012131929397583008
generate_one_block  0.007167339324951172
generate_one_block  0.004994392395019531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020864009857177734
gen group dst list time:  0.0001747608184814453
time for parepare:  0.0013589859008789062
local_output_nid generation:  0.0004115104675292969
local_in_edges_tensor generation:  0.001150369644165039
mini_batch_src_global generation:  0.0013549327850341797
r_  generation:  0.013324499130249023
local_output_nid generation:  0.00035953521728515625
local_in_edges_tensor generation:  0.0008141994476318359
mini_batch_src_global generation:  0.0013995170593261719
r_  generation:  0.012930631637573242
----------------------check_connections_block total spend ----------------------------- 0.03951883316040039
generate_one_block  0.018746376037597656
generate_one_block  0.017667293548583984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017898082733154297
gen group dst list time:  0.0004520416259765625
time for parepare:  0.0013911724090576172
local_output_nid generation:  0.0009713172912597656
local_in_edges_tensor generation:  0.0023183822631835938
mini_batch_src_global generation:  0.002049684524536133
r_  generation:  0.02163839340209961
local_output_nid generation:  0.0010788440704345703
local_in_edges_tensor generation:  0.0021321773529052734
mini_batch_src_global generation:  0.002481698989868164
r_  generation:  0.02268385887145996
----------------------check_connections_block total spend ----------------------------- 0.06701135635375977
generate_one_block  0.026829004287719727
generate_one_block  0.028797388076782227
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

connection checking time:  0.12110042572021484
block generation total time  0.10795402526855469
average batch blocks generation time:  0.053977012634277344
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03664541244506836  GigaBytes
Max Memory Allocated: 0.03664541244506836  GigaBytes

torch.Size([17446, 500])
torch.Size([13234, 256])
torch.Size([5216, 256])
torch.Size([1403, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.10755443572998047  GigaBytes
Max Memory Allocated: 0.10811853408813477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.03905010223388672  GigaBytes
Max Memory Allocated: 0.1116018295288086  GigaBytes

torch.Size([17755, 500])
torch.Size([14051, 256])
torch.Size([5084, 256])
torch.Size([1341, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.11204814910888672  GigaBytes
Max Memory Allocated: 0.11261224746704102  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015729665756225586 |0.17244243621826172 |0.3853534460067749 |0.0001990795135498047 |0.010662198066711426 |0.007569074630737305 |
----------------------------------------------------------pseudo_mini_loss sum 2.3324971199035645
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  75886
Number of first layer input nodes during this epoch:  35201
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.046079158782958984  GigaBytes
Max Memory Allocated: 0.11566162109375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004582405090332031
random selection method range initialization spend 0.00010657310485839844
time for parepare:  4.410743713378906e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  5.1975250244140625e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  6.866455078125e-05
----------------------check_connections_block total spend ----------------------------- 0.0006234645843505859
generate_one_block  0.0011153221130371094
generate_one_block  0.0010647773742675781
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005216598510742188
gen group dst list time:  2.5510787963867188e-05
time for parepare:  0.0002593994140625
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.000492095947265625
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  9.942054748535156e-05Using backend: pytorch

r_  generation:  0.0006861686706542969
----------------------check_connections_block total spend ----------------------------- 0.0023849010467529297
generate_one_block  0.001712799072265625
generate_one_block  0.001847982406616211
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000990152359008789
gen group dst list time:  6.628036499023438e-05
time for parepare:  0.0007240772247314453
local_output_nid generation:  9.250640869140625e-05
local_in_edges_tensor generation:  0.0003724098205566406
mini_batch_src_global generation:  0.0003058910369873047
r_  generation:  0.003385305404663086
local_output_nid generation:  0.00012159347534179688
local_in_edges_tensor generation:  0.0003139972686767578
mini_batch_src_global generation:  0.0004489421844482422
r_  generation:  0.004168033599853516
----------------------check_connections_block total spend ----------------------------- 0.01191091537475586
generate_one_block  0.005315542221069336
generate_one_block  0.006396770477294922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019223690032958984
gen group dst list time:  0.00018477439880371094
time for parepare:  0.0012574195861816406
local_output_nid generation:  0.0003266334533691406
local_in_edges_tensor generation:  0.0010259151458740234
mini_batch_src_global generation:  0.0010368824005126953
r_  generation:  0.011928796768188477
local_output_nid generation:  0.0004184246063232422
local_in_edges_tensor generation:  0.0008745193481445312
mini_batch_src_global generation:  0.00162506103515625
r_  generation:  0.014354228973388672
----------------------check_connections_block total spend ----------------------------- 0.03953886032104492
generate_one_block  0.01646733283996582
generate_one_block  0.0199739933013916
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001680135726928711
gen group dst list time:  0.0004687309265136719
time for parepare:  0.0013408660888671875
local_output_nid generation:  0.0009629726409912109
local_in_edges_tensor generation:  0.002061128616333008
mini_batch_src_global generation:  0.0016775131225585938
r_  generation:  0.020588159561157227
local_output_nid generation:  0.0010733604431152344
local_in_edges_tensor generation:  0.0024204254150390625
mini_batch_src_global generation:  0.0024521350860595703
r_  generation:  0.0222170352935791
----------------------check_connections_block total spend ----------------------------- 0.06476807594299316
generate_one_block  0.026575565338134766
generate_one_block  0.02964162826538086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.046079158782958984  GigaBytes
Max Memory Allocated: 0.11566162109375  GigaBytes

connection checking time:  0.11860275268554688
block generation total time  0.10793161392211914
average batch blocks generation time:  0.05396580696105957
block dataloader generation time/epoch 0.2627732753753662
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.0426788330078125  GigaBytes
Max Memory Allocated: 0.11566162109375  GigaBytes

torch.Size([17180, 500])
torch.Size([12792, 256])
torch.Size([4465, 256])
torch.Size([1207, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.10742712020874023  GigaBytes
Max Memory Allocated: 0.11566162109375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.04456949234008789  GigaBytes
Max Memory Allocated: 0.11566162109375  GigaBytes

torch.Size([18130, 500])
torch.Size([14640, 256])
torch.Size([6205, 256])
torch.Size([1582, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.12413835525512695  GigaBytes
Max Memory Allocated: 0.12504291534423828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01227712631225586 |0.001325368881225586 |0.005698084831237793 |0.00014007091522216797 |0.00612795352935791 |0.0052301883697509766 |
----------------------------------------------------------pseudo_mini_loss sum 1.7025736570358276
Total (block generation + training)time/epoch 0.3224794864654541
Training time/epoch 0.05931711196899414
Training time without block to device /epoch 0.05666637420654297
Training time without total dataloading part /epoch 0.02916240692138672
load block tensor time/epoch 0.02455425262451172
block to device time/epoch 0.002650737762451172
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  76557
Number of first layer input nodes during this epoch:  35310
