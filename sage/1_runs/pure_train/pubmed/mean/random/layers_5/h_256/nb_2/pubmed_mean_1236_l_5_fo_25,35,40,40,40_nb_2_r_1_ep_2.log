main start at this time 1648531875.240574
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012829303741455078
random selection method range initialization spend 0.00024890899658203125
time for parepare:  5.745887756347656e-05
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00021839141845703125
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0027704238891601562
----------------------check_connections_block total spend ----------------------------- 0.0032613277435302734
generate_one_block  0.002735137939453125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00089263916015625
gen group dst list time:  2.6464462280273438e-05
time for parepare:  0.000293731689453125
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0002639293670654297
mini_batch_src_global generation:  0.00016427040100097656
r_  generation:  0.0014526844024658203
----------------------check_connections_block total spend ----------------------------- 0.002640247344970703
generate_one_block  0.0033462047576904297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011951923370361328
gen group dst list time:  6.914138793945312e-05
time for parepare:  0.0009098052978515625
local_output_nid generation:  0.00023055076599121094
local_in_edges_tensor generation:  0.0006229877471923828
mini_batch_src_global generation:  0.0007202625274658203
r_  generation:  0.00832056999206543
----------------------check_connections_block total spend ----------------------------- 0.013494491577148438
generate_one_block  0.009960651397705078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001867055892944336
gen group dst list time:  0.00019502639770507812
time for parepare:  0.0016477108001708984
local_output_nid generation:  0.0007653236389160156
local_in_edges_tensor generation:  0.0015652179718017578
mini_batch_src_global generation:  0.0022819042205810547
r_  generation:  0.018227338790893555
----------------------check_connections_block total spend ----------------------------- 0.030573368072509766
generate_one_block  0.02317500114440918
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002002716064453125
gen group dst list time:  0.00032138824462890625
time for parepare:  0.0015511512756347656
local_output_nid generation:  0.0011653900146484375
local_in_edges_tensor generation:  0.002410888671875
mini_batch_src_global generation:  0.002168893814086914
r_  generation:  0.025475740432739258
----------------------check_connections_block total spend ----------------------------- 0.0394892692565918
generate_one_block  0.030025959014892578
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.00244140625  GigaBytes
Max Memory Allocated: 0.00244140625  GigaBytes

connection checking time:  0.0861973762512207
block generation total time  0.06650781631469727
average batch blocks generation time:  0.06650781631469727
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.038828372955322266  GigaBytes
Max Memory Allocated: 0.038828372955322266  GigaBytes

torch.Size([18670, 500])
torch.Size([16329, 256])
torch.Size([8079, 256])
torch.Size([2570, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.13586854934692383  GigaBytes
Max Memory Allocated: 0.13719749450683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009205341339111328 |0.3416273593902588 |0.7700686454772949 |0.00030922889709472656 |0.01356196403503418 |0.007721424102783203 |
----------------------------------------------------------pseudo_mini_loss sum 2.476969003677368
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  46002
Number of first layer input nodes during this epoch:  18670
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.04886198043823242  GigaBytes
Max Memory Allocated: 0.14064407348632812  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005424022674560547
random selection method range initialization spend 0.00014710426330566406
time for parepare:  6.771087646484375e-05
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00011944770812988281
----------------------check_connections_block total spend ----------------------------- 0.0005614757537841797
generate_one_block  0.0013976097106933594
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005598068237304688
gen group dst list time:  2.1457672119140625e-05
time for parepare:  0.0002884864807128906
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.00013208389282226562
r_  generation:  0.0011780261993408203
----------------------check_connections_block total spend ----------------------------- 0.0021941661834716797
generate_one_block  0.002612590789794922
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010089874267578125
gen group dst list time:  7.319450378417969e-05
time for parepare:  0.0008015632629394531
local_output_nid generation:  0.00018835067749023438
local_in_edges_tensor generation:  0.0005517005920410156
mini_batch_src_global generation:  0.0007069110870361328
r_  generation:  0.006888866424560547
----------------------check_connections_block total spend ----------------------------- 0.01132822036743164
generate_one_block  0.009957551956176758
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019447803497314453
gen group dst list time:  0.00015163421630859375
time for parepare:  0.0012671947479248047
local_output_nid generation:  0.0005426406860351562
local_in_edges_tensor generation:  0.001458883285522461
mini_batch_src_global generation:  0.0017445087432861328
r_  generation:  0.017344236373901367
----------------------check_connections_block total spend ----------------------------- 0.02760791778564453
generate_one_block  0.023791074752807617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020487308502197266
gen group dst list time:  0.00032973289489746094
time for parepare:  0.0014584064483642578
local_output_nid generation:  0.0011126995086669922
local_in_edges_tensor generation:  0.002470731735229492
mini_batch_src_global generation:  0.0021278858184814453
r_  generation:  0.024219751358032227
----------------------check_connections_block total spend ----------------------------- 0.038001060485839844
generate_one_block  0.02999567985534668
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.04886198043823242  GigaBytes
Max Memory Allocated: 0.14064407348632812  GigaBytes

connection checking time:  0.0791313648223877
block generation total time  0.06635689735412598
average batch blocks generation time:  0.06635689735412598
block dataloader generation time/epoch 0.17847251892089844Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.04612398147583008  GigaBytes
Max Memory Allocated: 0.14064407348632812  GigaBytes

torch.Size([18626, 500])
torch.Size([16223, 256])
torch.Size([8111, 256])
torch.Size([2577, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.14325857162475586  GigaBytes
Max Memory Allocated: 0.1446056365966797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013254880905151367 |0.0016312599182128906 |0.0061109066009521484 |0.00016570091247558594 |0.005637407302856445 |0.0025806427001953125 |
----------------------------------------------------------pseudo_mini_loss sum 1.7414761781692505
Total (block generation + training)time/epoch 0.2105846405029297
Training time/epoch 0.031852006912231445
Training time without block to device /epoch 0.030220746994018555
Training time without total dataloading part /epoch 0.014494657516479492
load block tensor time/epoch 0.013254880905151367
block to device time/epoch 0.0016312599182128906
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.1920928955078125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  45891
Number of first layer input nodes during this epoch:  18626
