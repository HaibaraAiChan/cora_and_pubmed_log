main start at this time 1648531765.32678
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003414154052734375  GigaBytes
Max Memory Allocated: 0.0003414154052734375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013432502746582031
random selection method range initialization spend 0.00023627281188964844
time for parepare:  4.9114227294921875e-05
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.002560853958129883
----------------------check_connections_block total spend ----------------------------- 0.0029938220977783203
generate_one_block  0.0016529560089111328
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0008342266082763672
gen group dst list time:  2.0742416381835938e-05
time for parepare:  0.00024271011352539062
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0002276897430419922
mini_batch_src_global generation:  0.00012946128845214844
r_  generation:  0.0012242794036865234
----------------------check_connections_block total spend ----------------------------- 0.0022025108337402344
generate_one_block  0.002847909927368164
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001085042953491211
gen group dst list time:  5.53131103515625e-05
time for parepare:  0.0007469654083251953
local_output_nid generation:  0.00018858909606933594
local_in_edges_tensor generation:  0.0005381107330322266
mini_batch_src_global generation:  0.0006837844848632812
r_  generation:  0.007036924362182617
----------------------check_connections_block total spend ----------------------------- 0.011356115341186523
generate_one_block  0.01018834114074707
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018029212951660156
gen group dst list time:  0.00014638900756835938
time for parepare:  0.0014154911041259766
local_output_nid generation:  0.0005741119384765625
local_in_edges_tensor generation:  0.0013551712036132812
mini_batch_src_global generation:  0.001829385757446289
r_  generation:  0.01835322380065918
----------------------check_connections_block total spend ----------------------------- 0.028827667236328125
generate_one_block  0.02323007583618164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017037391662597656
gen group dst list time:  0.000308990478515625
time for parepare:  0.0016078948974609375
local_output_nid generation:  0.0011713504791259766
local_in_edges_tensor generation:  0.002368927001953125
mini_batch_src_global generation:  0.0022470951080322266
r_  generation:  0.025121212005615234
----------------------check_connections_block total spend ----------------------------- 0.03908419609069824
generate_one_block  0.030179977416992188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003414154052734375  GigaBytes
Max Memory Allocated: 0.0003414154052734375  GigaBytes

connection checking time:  0.08147048950195312
block generation total time  0.06644630432128906
average batch blocks generation time:  0.06644630432128906
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03672933578491211  GigaBytes
Max Memory Allocated: 0.03672933578491211  GigaBytes

torch.Size([18650, 500])
torch.Size([16214, 64])
torch.Size([8132, 64])
torch.Size([2583, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.06253433227539062  GigaBytes
Max Memory Allocated: 0.06275320053100586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013088703155517578 |0.34284496307373047 |0.7676301002502441 |0.00027632713317871094 |0.011508703231811523 |0.006688594818115234 |
----------------------------------------------------------pseudo_mini_loss sum 2.4809341430664062
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  45933
Number of first layer input nodes during this epoch:  18650
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.04047536849975586  GigaBytes
Max Memory Allocated: 0.06373357772827148  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000568389892578125
random selection method range initialization spend 0.0001354217529296875
time for parepare:  5.7697296142578125e-05
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00011706352233886719
----------------------check_connections_block total spend ----------------------------- 0.0005440711975097656
generate_one_block  0.0013303756713867188
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005719661712646484
gen group dst list time:  2.1457672119140625e-05
time for parepare:  0.00030803680419921875
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.0011944770812988281
----------------------check_connections_block total spend ----------------------------- 0.0023193359375
generate_one_block  0.002676248550415039
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010187625885009766
gen group dst list time:  7.176399230957031e-05
time for parepare:  0.0008029937744140625
local_output_nid generation:  0.0001876354217529297
local_in_edges_tensor generation:  0.0005385875701904297
mini_batch_src_global generation:  0.0007216930389404297
r_  generation:  0.006889820098876953
----------------------check_connections_block total spend ----------------------------- 0.011269092559814453
generate_one_block  0.010004758834838867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018649101257324219
gen group dst list time:  0.0001437664031982422
time for parepare:  0.0013613700866699219
local_output_nid generation:  0.0005469322204589844
local_in_edges_tensor generation:  0.0013461112976074219
mini_batch_src_global generation:  0.0017647743225097656
r_  generation:  0.017604589462280273
----------------------check_connections_block total spend ----------------------------- 0.02779221534729004
generate_one_block  0.023417234420776367
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00209808349609375
gen group dst list time:  0.0003104209899902344
time for parepare:  0.00152587890625
local_output_nid generation:  0.0011050701141357422
local_in_edges_tensor generation:  0.0024595260620117188
mini_batch_src_global generation:  0.00244140625
r_  generation:  0.0247802734375
----------------------check_connections_block total spend ----------------------------- 0.03904843330383301
generate_one_block  0.03047657012939453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.04047536849975586  GigaBytes
Max Memory Allocated: 0.06373357772827148  GigaBytes

connection checking time:  0.0804290771484375
block generation total time  0.0665748119354248
average batch blocks generation time:  0.0665748119354248
block dataloader generation time/epoch 0.1809520721435547Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.0377354621887207  GigaBytes
Max Memory Allocated: 0.07166290283203125  GigaBytes

torch.Size([18605, 500])
torch.Size([16219, 64])
torch.Size([8079, 64])
torch.Size([2578, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.06348609924316406  GigaBytes
Max Memory Allocated: 0.07166290283203125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010465621948242188 |0.001575469970703125 |0.006314516067504883 |0.00015783309936523438 |0.0038690567016601562 |0.002569913864135742 |
----------------------------------------------------------pseudo_mini_loss sum 1.624729037284851
Total (block generation + training)time/epoch 0.20793628692626953
Training time/epoch 0.026725292205810547
Training time without block to device /epoch 0.025149822235107422
Training time without total dataloading part /epoch 0.012911319732666016
load block tensor time/epoch 0.010465621948242188
block to device time/epoch 0.001575469970703125
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.1920928955078125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  45835
Number of first layer input nodes during this epoch:  18605
