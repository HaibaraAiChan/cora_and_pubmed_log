main start at this time 1648531775.9369242
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003414154052734375  GigaBytes
Max Memory Allocated: 0.0003414154052734375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0016374588012695312
random selection method range initialization spend 0.00019502639770507812
time for parepare:  4.673004150390625e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0011143684387207031
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  6.079673767089844e-05
----------------------check_connections_block total spend ----------------------------- 0.0017902851104736328
generate_one_block  0.0014295578002929688
generate_one_block  0.0011441707611083984
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001008749008178711
gen group dst list time:  2.47955322265625e-05
time for parepare:  0.00022912025451660156
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00023055076599121094
mini_batch_src_global generation:  7.390975952148438e-05
r_  generation:  0.0007593631744384766
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0005104541778564453
----------------------check_connections_block total spend ----------------------------- 0.0024518966674804688
generate_one_block  0.0020897388458251953
generate_one_block  0.0017502307891845703
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010287761688232422
gen group dst list time:  6.079673767089844e-05
time for parepare:  0.0007483959197998047
local_output_nid generation:  0.00011229515075683594
local_in_edges_tensor generation:  0.0004324913024902344
mini_batch_src_global generation:  0.00039315223693847656
r_  generation:  0.004393339157104492
local_output_nid generation:  9.5367431640625e-05
local_in_edges_tensor generation:  0.0002849102020263672
mini_batch_src_global generation:  0.0004591941833496094
r_  generation:  0.0034024715423583984
----------------------check_connections_block total spend ----------------------------- 0.012527704238891602
generate_one_block  0.007311820983886719
generate_one_block  0.00519251823425293
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018126964569091797
gen group dst list time:  0.000186920166015625
time for parepare:  0.0013933181762695312
local_output_nid generation:  0.000377655029296875
local_in_edges_tensor generation:  0.0011165142059326172
mini_batch_src_global generation:  0.001369476318359375
r_  generation:  0.013787269592285156
local_output_nid generation:  0.0003876686096191406
local_in_edges_tensor generation:  0.0008459091186523438
mini_batch_src_global generation:  0.0014750957489013672
r_  generation:  0.013860940933227539
----------------------check_connections_block total spend ----------------------------- 0.04133963584899902
generate_one_block  0.018568992614746094
generate_one_block  0.019603490829467773
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001855611801147461
gen group dst list time:  0.0004930496215820312
time for parepare:  0.0015301704406738281
local_output_nid generation:  0.0010557174682617188
local_in_edges_tensor generation:  0.002272367477416992
mini_batch_src_global generation:  0.002097606658935547
r_  generation:  0.023082494735717773
local_output_nid generation:  0.0010380744934082031
local_in_edges_tensor generation:  0.0022842884063720703
mini_batch_src_global generation:  0.0025174617767333984
r_  generation:  0.023395538330078125
----------------------check_connections_block total spend ----------------------------- 0.06978559494018555
generate_one_block  0.027538061141967773
generate_one_block  0.029985904693603516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003414154052734375  GigaBytes
Max Memory Allocated: 0.0003414154052734375  GigaBytes

connection checking time:  0.12610483169555664
block generation total time  0.11204075813293457
average batch blocks generation time:  0.056020379066467285
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03455018997192383  GigaBytes
Max Memory Allocated: 0.03455018997192383  GigaBytes

torch.Size([17567, 500])
torch.Size([13649, 64])
torch.Size([5200, 64])
torch.Size([1537, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.05408906936645508  GigaBytes
Max Memory Allocated: 0.054238319396972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.034862518310546875  GigaBytes
Max Memory Allocated: 0.06708574295043945  GigaBytes

torch.Size([17691, 500])
torch.Size([13857, 64])
torch.Size([5189, 64])
torch.Size([1196, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.05421161651611328  GigaBytes
Max Memory Allocated: 0.06708574295043945  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012405633926391602 |0.1707901954650879 |0.3971937894821167 |0.00019598007202148438 |0.008215904235839844 |0.004030466079711914 |
----------------------------------------------------------pseudo_mini_loss sum 2.7313084602355957
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  76242
Number of first layer input nodes during this epoch:  35258
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.03771543502807617  GigaBytes
Max Memory Allocated: 0.06708574295043945  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00048065185546875
random selection method range initialization spend 0.00010609626770019531
time for parepare:  4.4345855712890625e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  5.936622619628906e-05
----------------------check_connections_block total spend ----------------------------- 0.0006709098815917969
generate_one_block  0.0011243820190429688
generate_one_block  0.0010426044464111328
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004897117614746094
gen group dst list time:  2.4080276489257812e-05
time for parepare:  0.00023984909057617188
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.00055694580078125
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014781951904296875Using backend: pytorch

mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0006687641143798828
----------------------check_connections_block total spend ----------------------------- 0.0024154186248779297
generate_one_block  0.0017151832580566406
generate_one_block  0.0019497871398925781
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000978231430053711
gen group dst list time:  6.437301635742188e-05
time for parepare:  0.0007078647613525391
local_output_nid generation:  9.107589721679688e-05
local_in_edges_tensor generation:  0.00036644935607910156
mini_batch_src_global generation:  0.00028967857360839844
r_  generation:  0.0027234554290771484
local_output_nid generation:  0.00011348724365234375
local_in_edges_tensor generation:  0.00032639503479003906
mini_batch_src_global generation:  0.00047397613525390625
r_  generation:  0.004493236541748047
----------------------check_connections_block total spend ----------------------------- 0.011621713638305664
generate_one_block  0.005324125289916992
generate_one_block  0.006481170654296875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002062559127807617
gen group dst list time:  0.0001671314239501953
time for parepare:  0.001199483871459961
local_output_nid generation:  0.0002982616424560547
local_in_edges_tensor generation:  0.0010116100311279297
mini_batch_src_global generation:  0.0009808540344238281
r_  generation:  0.011126041412353516
local_output_nid generation:  0.000385284423828125
local_in_edges_tensor generation:  0.0008265972137451172
mini_batch_src_global generation:  0.0015685558319091797
r_  generation:  0.013860702514648438
----------------------check_connections_block total spend ----------------------------- 0.03773927688598633
generate_one_block  0.015385627746582031
generate_one_block  0.019278287887573242
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018353462219238281
gen group dst list time:  0.0004980564117431641
time for parepare:  0.0013880729675292969
local_output_nid generation:  0.0009508132934570312
local_in_edges_tensor generation:  0.0020995140075683594
mini_batch_src_global generation:  0.0016231536865234375
r_  generation:  0.021018028259277344
local_output_nid generation:  0.0011072158813476562
local_in_edges_tensor generation:  0.002213716506958008
mini_batch_src_global generation:  0.0025730133056640625
r_  generation:  0.02220940589904785
----------------------check_connections_block total spend ----------------------------- 0.06530046463012695
generate_one_block  0.026645898818969727
generate_one_block  0.029117107391357422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.03771543502807617  GigaBytes
Max Memory Allocated: 0.06708574295043945  GigaBytes

connection checking time:  0.11707687377929688
block generation total time  0.10589718818664551
average batch blocks generation time:  0.052948594093322754
block dataloader generation time/epoch 0.25529980659484863
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.03544425964355469  GigaBytes
Max Memory Allocated: 0.06775617599487305  GigaBytes

torch.Size([17387, 500])
torch.Size([12735, 64])
torch.Size([4353, 64])
torch.Size([1192, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.05214834213256836  GigaBytes
Max Memory Allocated: 0.06775617599487305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.035597801208496094  GigaBytes
Max Memory Allocated: 0.06775712966918945  GigaBytes

torch.Size([17720, 500])
torch.Size([14078, 64])
torch.Size([5687, 64])
torch.Size([1476, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.05568361282348633  GigaBytes
Max Memory Allocated: 0.06775712966918945  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009093880653381348 |0.0011959075927734375 |0.005612611770629883 |0.0001289844512939453 |0.004116415977478027 |0.0023233890533447266 |
----------------------------------------------------------pseudo_mini_loss sum 1.796522617340088
Total (block generation + training)time/epoch 0.3007848262786865
Training time/epoch 0.045269012451171875
Training time without block to device /epoch 0.042877197265625
Training time without total dataloading part /epoch 0.022039413452148438
load block tensor time/epoch 0.018187761306762695
block to device time/epoch 0.002391815185546875
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  74982
Number of first layer input nodes during this epoch:  35107
