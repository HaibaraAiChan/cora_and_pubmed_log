main start at this time 1648531786.5702198
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003414154052734375  GigaBytes
Max Memory Allocated: 0.0003414154052734375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0018758773803710938
random selection method range initialization spend 0.0002396106719970703
time for parepare:  4.887580871582031e-05
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0025892257690429688
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.504753112792969e-05
----------------------check_connections_block total spend ----------------------------- 0.0036630630493164062
generate_one_block  0.0014438629150390625
generate_one_block  0.0010957717895507812
generate_one_block  0.0010895729064941406
generate_one_block  0.0010781288146972656
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0008804798126220703
gen group dst list time:  3.409385681152344e-05
time for parepare:  0.0002422332763671875
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0005168914794921875
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0002722740173339844
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00031065940856933594
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0002446174621582031
----------------------check_connections_block total spend ----------------------------- 0.0028569698333740234
generate_one_block  0.0017485618591308594
generate_one_block  0.0014078617095947266
generate_one_block  0.0014684200286865234
generate_one_block  0.001415252685546875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011038780212402344
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.0007944107055664062
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.0003631114959716797
mini_batch_src_global generation:  0.0002963542938232422
r_  generation:  0.003224611282348633
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  0.00020551681518554688
r_  generation:  0.001495361328125
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  0.0002129077911376953
r_  generation:  0.002204418182373047
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  0.0001747608184814453
r_  generation:  0.0014576911926269531
----------------------check_connections_block total spend ----------------------------- 0.01361227035522461
generate_one_block  0.005217075347900391
generate_one_block  0.0026140213012695312
generate_one_block  0.0036890506744384766
generate_one_block  0.0026199817657470703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019295215606689453
gen group dst list time:  0.00022745132446289062
time for parepare:  0.0015878677368164062
local_output_nid generation:  0.00030040740966796875
local_in_edges_tensor generation:  0.0009357929229736328
mini_batch_src_global generation:  0.0012090206146240234
r_  generation:  0.01135396957397461
local_output_nid generation:  0.00019621849060058594
local_in_edges_tensor generation:  0.0004665851593017578
mini_batch_src_global generation:  0.001092672348022461
r_  generation:  0.006939888000488281
local_output_nid generation:  0.0002925395965576172
local_in_edges_tensor generation:  0.0006496906280517578
mini_batch_src_global generation:  0.000990152359008789
r_  generation:  0.01030111312866211
local_output_nid generation:  0.000202178955078125
local_in_edges_tensor generation:  0.0004680156707763672
mini_batch_src_global generation:  0.0008590221405029297
r_  generation:  0.007635831832885742
----------------------check_connections_block total spend ----------------------------- 0.05482029914855957
generate_one_block  0.015147686004638672
generate_one_block  0.011528491973876953
generate_one_block  0.014697551727294922
generate_one_block  0.011968374252319336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001804351806640625
gen group dst list time:  0.0008809566497802734
time for parepare:  0.0018482208251953125
local_output_nid generation:  0.0009796619415283203
local_in_edges_tensor generation:  0.002355813980102539
mini_batch_src_global generation:  0.002220630645751953
r_  generation:  0.02066516876220703
local_output_nid generation:  0.0008218288421630859
local_in_edges_tensor generation:  0.0015795230865478516
mini_batch_src_global generation:  0.002053976058959961
r_  generation:  0.018484115600585938
local_output_nid generation:  0.0009593963623046875
local_in_edges_tensor generation:  0.0015339851379394531
mini_batch_src_global generation:  0.0018546581268310547
r_  generation:  0.02034759521484375
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.0015025138854980469
mini_batch_src_global generation:  0.0019054412841796875
r_  generation:  0.01954483985900879
----------------------check_connections_block total spend ----------------------------- 0.11786293983459473
generate_one_block  0.026082992553710938
generate_one_block  0.023760080337524414
generate_one_block  0.027889251708984375
generate_one_block  0.025495290756225586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003414154052734375  GigaBytes
Max Memory Allocated: 0.0003414154052734375  GigaBytes

connection checking time:  0.18915247917175293
block generation total time  0.17674994468688965
average batch blocks generation time:  0.04418748617172241
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.03246259689331055  GigaBytes
Max Memory Allocated: 0.03246259689331055  GigaBytes

torch.Size([16685, 500])
torch.Size([11440, 64])
torch.Size([3924, 64])
torch.Size([973, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.0474085807800293  GigaBytes
Max Memory Allocated: 0.04750680923461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.029160022735595703  GigaBytes
Max Memory Allocated: 0.05976676940917969  GigaBytes

torch.Size([14945, 500])
torch.Size([9504, 64])
torch.Size([2242, 64])
torch.Size([621, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.04024553298950195  GigaBytes
Max Memory Allocated: 0.05976676940917969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.03273773193359375  GigaBytes
Max Memory Allocated: 0.05976676940917969  GigaBytes

torch.Size([16485, 500])
torch.Size([10926, 64])
torch.Size([3700, 64])
torch.Size([689, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.04666852951049805  GigaBytes
Max Memory Allocated: 0.05976676940917969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.03067779541015625  GigaBytes
Max Memory Allocated: 0.06122636795043945  GigaBytes

torch.Size([15703, 500])
torch.Size([10584, 64])
torch.Size([2444, 64])
torch.Size([566, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.04347419738769531  GigaBytes
Max Memory Allocated: 0.06122636795043945  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011968135833740234 |0.09305471181869507 |0.19959837198257446 |0.00017780065536499023 |0.005200624465942383 |0.0031919479370117188 |
----------------------------------------------------------pseudo_mini_loss sum 2.3480112552642822
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  121788
Number of first layer input nodes during this epoch:  63818
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.032915592193603516  GigaBytes
Max Memory Allocated: 0.06122636795043945  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005905628204345703
random selection method range initialization spend 0.000125885009765625
time for parepare:  5.5789947509765625e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  5.745887756347656e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.8623809814453125e-05
----------------------check_connections_block total spend ----------------------------- 0.0011746883392333984
generate_one_block  0.0013320446014404297
generate_one_block  0.0012555122375488281
generate_one_block  0.0016169548034667969
generate_one_block  0.0012483596801757812
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006422996520996094
gen group dst list time:  4.2438507080078125e-05
time for parepare:  0.00033354759216308594
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00022101402282714844
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0003972053527832031
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0003094673156738281
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0003867149353027344
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.00047588348388671875
----------------------check_connections_block total spend ----------------------------- 0.003400564193725586
generate_one_block  0.00170135498046875
generate_one_block  0.0015611648559570312
generate_one_block  0.0017461776733398438
generate_one_block  0.001772165298461914
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011796951293945312
gen group dst list time:  0.00010204315185546875
time for parepare:  0.0009295940399169922
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.00036907196044921875
mini_batch_src_global generation:  0.00021791458129882812
r_  generation:  0.0022230148315429688
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  0.0002353191375732422
r_  generation:  0.001667022705078125
local_output_nid generation:  8.821487426757812e-05
local_in_edges_tensor generation:  0.0002815723419189453
mini_batch_src_global generation:  0.0003032684326171875
r_  generation:  0.00279998779296875
local_output_nid generation:  8.606910705566406e-05
local_in_edges_tensor generation:  0.0002810955047607422
mini_batch_src_global generation:  0.0003879070281982422
r_  generation:  0.0030167102813720703
----------------------check_connections_block total spend ----------------------------- 0.016091585159301758
generate_one_block  0.003078460693359375
generate_one_block  0.0026891231536865234
generate_one_block  0.0038344860076904297
generate_one_block  0.004505157470703125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020601749420166016
gen group dst list time:  0.0002951622009277344
time for parepare:  0.0017175674438476562
local_output_nid generation:  0.000293731689453125
local_in_edges_tensor generation:  0.0008614063262939453
mini_batch_src_global generation:  0.0009589195251464844
r_  generation:  0.009493112564086914
local_output_nid generation:  0.00019049644470214844
local_in_edges_tensor generation:  0.0004553794860839844
mini_batch_src_global generation:  0.0009438991546630859
r_  generation:  0.006359577178955078
local_output_nid generation:  0.00031757354736328125
local_in_edges_tensor generation:  0.0006506443023681641
mini_batch_src_global generation:  0.0013730525970458984
r_  generation:  0.02140021324157715
local_output_nid generation:  0.0003190040588378906
local_in_edges_tensor generation:  0.0007255077362060547
mini_batch_src_global generation:  0.0015609264373779297
r_  generation:  0.008950233459472656
----------------------check_connections_block total spend ----------------------------- 0.06761980056762695
generate_one_block  0.011192560195922852
generate_one_block  0.00952458381652832
generate_one_block  0.014881610870361328
generate_one_block  0.013019084930419922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001790761947631836
gen group dst list time:  0.0007336139678955078
time for parepare:  0.0016014575958251953
local_output_nid generation:  0.0009267330169677734
local_in_edges_tensor generation:  0.0018105506896972656
mini_batch_src_global generation:  0.0017750263214111328
r_  generation:  0.018486499786376953
local_output_nid generation:  0.0007920265197753906
local_in_edges_tensor generation:  0.001390218734741211
mini_batch_src_global generation:  0.002012491226196289
r_  generation:  0.017783164978027344
local_output_nid generation:  0.0011227130889892578
local_in_edges_tensor generation:  0.0017752647399902344
mini_batch_src_global generation:  0.0019140243530273438
r_  generation:  0.021803855895996094
local_output_nid generation:  0.0008425712585449219
local_in_edges_tensor generation:  0.0012667179107666016
mini_batch_src_global generation: Using backend: pytorch
 0.0017175674438476562
r_  generation:  0.018150806427001953
----------------------check_connections_block total spend ----------------------------- 0.11328434944152832
generate_one_block  0.02486872673034668
generate_one_block  0.025148391723632812
generate_one_block  0.02742624282836914
generate_one_block  0.023702621459960938
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.032915592193603516  GigaBytes
Max Memory Allocated: 0.06122636795043945  GigaBytes

connection checking time:  0.20039629936218262
block generation total time  0.17065191268920898
average batch blocks generation time:  0.042662978172302246
block dataloader generation time/epoch 0.40937089920043945
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.03160429000854492  GigaBytes
Max Memory Allocated: 0.06122636795043945  GigaBytes

torch.Size([15869, 500])
torch.Size([9934, 64])
torch.Size([2799, 64])
torch.Size([711, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.04376935958862305  GigaBytes
Max Memory Allocated: 0.06122636795043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.02982044219970703  GigaBytes
Max Memory Allocated: 0.06122636795043945  GigaBytes

torch.Size([14942, 500])
torch.Size([8865, 64])
torch.Size([2248, 64])
torch.Size([522, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.04030609130859375  GigaBytes
Max Memory Allocated: 0.06122636795043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.03400850296020508  GigaBytes
Max Memory Allocated: 0.06122636795043945  GigaBytes

torch.Size([17065, 500])
torch.Size([12518, 64])
torch.Size([4073, 64])
torch.Size([795, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.04974555969238281  GigaBytes
Max Memory Allocated: 0.06122636795043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.02939605712890625  GigaBytes
Max Memory Allocated: 0.06122636795043945  GigaBytes

torch.Size([14664, 500])
torch.Size([9147, 64])
torch.Size([2959, 64])
torch.Size([759, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.04118061065673828  GigaBytes
Max Memory Allocated: 0.06122636795043945  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009236931800842285 |0.0011919736862182617 |0.005743145942687988 |0.00013524293899536133 |0.0036140084266662598 |0.002323150634765625 |
----------------------------------------------------------pseudo_mini_loss sum 2.1334197521209717
Total (block generation + training)time/epoch 0.49765610694885254
Training time/epoch 0.08779120445251465
Training time without block to device /epoch 0.0830233097076416
Training time without total dataloading part /epoch 0.04029273986816406
load block tensor time/epoch 0.03694772720336914
block to device time/epoch 0.004767894744873047
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  118226
Number of first layer input nodes during this epoch:  62540
