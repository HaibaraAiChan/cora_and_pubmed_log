main start at this time 1648531753.4133344
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000152587890625  GigaBytes
Max Memory Allocated: 0.000152587890625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.002520322799682617
random selection method range initialization spend 0.0001914501190185547
time for parepare:  4.506111145019531e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.0010569095611572266
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5497207641601562e-05
----------------------check_connections_block total spend ----------------------------- 0.0038003921508789062
generate_one_block  0.001142740249633789
generate_one_block  0.0009982585906982422
generate_one_block  0.0010232925415039062
generate_one_block  0.000993967056274414
generate_one_block  0.0009899139404296875
generate_one_block  0.0010416507720947266
generate_one_block  0.0010504722595214844
generate_one_block  0.0010035037994384766
generate_one_block  0.0009849071502685547
generate_one_block  0.001004934310913086
generate_one_block  0.0009629726409912109
generate_one_block  0.0009496212005615234
generate_one_block  0.0009887218475341797
generate_one_block  0.0009560585021972656
generate_one_block  0.0009925365447998047
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013790130615234375
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.0002498626708984375
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  7.677078247070312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00017261505126953125
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0001544952392578125
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.00010418891906738281
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0001685619354248047
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.2479248046875e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00018167495727539062
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  7.843971252441406e-05
----------------------check_connections_block total spend ----------------------------- 0.004496335983276367
generate_one_block  0.001138925552368164
generate_one_block  0.00104522705078125
generate_one_block  0.0011057853698730469
generate_one_block  0.001264810562133789
generate_one_block  0.0010061264038085938
generate_one_block  0.0012784004211425781
generate_one_block  0.0011017322540283203
generate_one_block  0.0010612010955810547
generate_one_block  0.0010302066802978516
generate_one_block  0.0011377334594726562
generate_one_block  0.0011515617370605469
generate_one_block  0.0011107921600341797
generate_one_block  0.0010297298431396484
generate_one_block  0.0012142658233642578
generate_one_block  0.0010793209075927734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011401176452636719
gen group dst list time:  0.00012040138244628906
time for parepare:  0.0007307529449462891
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0002720355987548828
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.00041413307189941406
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0002713203430175781
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00032401084899902344
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  0.00014543533325195312
r_  generation:  0.0014462471008300781
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0001819133758544922
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  9.274482727050781e-05
r_  generation:  0.0010149478912353516
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0005490779876708984
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0002498626708984375
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0003123283386230469
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0006051063537597656
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.0009834766387939453
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0005040168762207031
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00026726722717285156
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  0.0001289844512939453
r_  generation:  0.0014109611511230469
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.0006740093231201172
----------------------check_connections_block total spend ----------------------------- 0.016382932662963867
generate_one_block  0.0023200511932373047
generate_one_block  0.0013413429260253906
generate_one_block  0.0013446807861328125
generate_one_block  0.0026710033416748047
generate_one_block  0.0012555122375488281
generate_one_block  0.0022258758544921875
generate_one_block  0.001583099365234375
generate_one_block  0.001203298568725586
generate_one_block  0.0013191699981689453
generate_one_block  0.0016307830810546875
generate_one_block  0.0021321773529052734
generate_one_block  0.001514434814453125
generate_one_block  0.0015287399291992188
generate_one_block  0.0026209354400634766
generate_one_block  0.001775979995727539
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020513534545898438
gen group dst list time:  0.0003066062927246094
time for parepare:  0.0016613006591796875
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.0005505084991455078
mini_batch_src_global generation:  0.000396728515625
r_  generation:  0.0031020641326904297
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.00023889541625976562
r_  generation:  0.0016007423400878906
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  0.0001556873321533203
r_  generation:  0.0015842914581298828
local_output_nid generation:  0.00012636184692382812
local_in_edges_tensor generation:  0.0003542900085449219
mini_batch_src_global generation:  0.0005738735198974609
r_  generation:  0.005422353744506836
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  0.00023555755615234375
r_  generation:  0.001363992691040039
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.00034880638122558594
mini_batch_src_global generation:  0.0003800392150878906
r_  generation:  0.004800558090209961
local_output_nid generation:  9.679794311523438e-05
local_in_edges_tensor generation:  0.00028634071350097656
mini_batch_src_global generation:  0.00037932395935058594
r_  generation:  0.0034139156341552734
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.0007636547088623047
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  0.0001976490020751953
r_  generation:  0.0022177696228027344
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  0.0002715587615966797
r_  generation:  0.0027551651000976562
local_output_nid generation:  0.00012993812561035156
local_in_edges_tensor generation:  0.0003190040588378906
mini_batch_src_global generation:  0.0003962516784667969
r_  generation:  0.0044689178466796875
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.0003571510314941406
r_  generation:  0.0029315948486328125
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  0.00021767616271972656
r_  generation:  0.0017580986022949219
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.000347137451171875
mini_batch_src_global generation:  0.0005025863647460938
r_  generation:  0.0057642459869384766
local_output_nid generation:  0.00011420249938964844
local_in_edges_tensor generation:  0.0003085136413574219
mini_batch_src_global generation:  0.0005643367767333984
r_  generation:  0.004666328430175781
----------------------check_connections_block total spend ----------------------------- 0.07089614868164062
generate_one_block  0.006188392639160156
generate_one_block  0.0029401779174804688
generate_one_block  0.002908945083618164
generate_one_block  0.007758378982543945
generate_one_block  0.002641439437866211
generate_one_block  0.007554054260253906
generate_one_block  0.0054225921630859375
generate_one_block  0.001859426498413086
generate_one_block  0.0043201446533203125
generate_one_block  0.004728078842163086
generate_one_block  0.0070171356201171875
generate_one_block  0.004618644714355469
generate_one_block  0.0033407211303710938
generate_one_block  0.00907588005065918
generate_one_block  0.007284402847290039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0024182796478271484
gen group dst list time:  0.0016551017761230469
time for parepare:  0.0017228126525878906
local_output_nid generation:  0.0004611015319824219
local_in_edges_tensor generation:  0.0014350414276123047
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.01068258285522461
local_output_nid generation:  0.00024080276489257812
local_in_edges_tensor generation:  0.0005941390991210938
mini_batch_src_global generation:  0.0009198188781738281
r_  generation:  0.006805896759033203
local_output_nid generation:  0.0002684593200683594
local_in_edges_tensor generation:  0.0005571842193603516
mini_batch_src_global generation:  0.0005450248718261719
r_  generation:  0.005764484405517578
local_output_nid generation:  0.00047087669372558594
local_in_edges_tensor generation:  0.0009660720825195312
mini_batch_src_global generation:  0.0012586116790771484
r_  generation:  0.011821508407592773
local_output_nid generation:  0.0001862049102783203
local_in_edges_tensor generation:  0.00040435791015625
mini_batch_src_global generation:  0.0006504058837890625
r_  generation:  0.005374908447265625
local_output_nid generation:  0.0006604194641113281
local_in_edges_tensor generation:  0.0010390281677246094
mini_batch_src_global generation:  0.0009005069732666016
r_  generation:  0.013095617294311523
local_output_nid generation:  0.0004150867462158203
local_in_edges_tensor generation:  0.0006995201110839844
mini_batch_src_global generation:  0.0011668205261230469
r_  generation:  0.010811328887939453
local_output_nid generation:  0.00012803077697753906
local_in_edges_tensor generation:  0.00028395652770996094
mini_batch_src_global generation:  0.000461578369140625
r_  generation:  0.0031430721282958984
local_output_nid generation:  0.0003681182861328125
local_in_edges_tensor generation:  0.0006203651428222656
mini_batch_src_global generation:  0.0007283687591552734
r_  generation:  0.008745431900024414
local_output_nid generation:  0.00041937828063964844
local_in_edges_tensor generation:  0.0007200241088867188
mini_batch_src_global generation:  0.0009419918060302734
r_  generation:  0.00891733169555664
local_output_nid generation:  0.0005609989166259766
local_in_edges_tensor generation:  0.0012583732604980469
mini_batch_src_global generation:  0.00139617919921875
r_  generation:  0.013940572738647461
local_output_nid generation:  0.00032138824462890625
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.0009663105010986328
r_  generation:  0.008463144302368164
local_output_nid generation:  0.0003790855407714844
local_in_edges_tensor generation:  0.0006015300750732422
mini_batch_src_global generation:  0.0007505416870117188
r_  generation:  0.007767677307128906
local_output_nid generation:  0.0005795955657958984
local_in_edges_tensor generation:  0.0008893013000488281
mini_batch_src_global generation:  0.0011818408966064453
r_  generation:  0.013844728469848633
local_output_nid generation:  0.0005564689636230469
local_in_edges_tensor generation:  0.0010221004486083984
mini_batch_src_global generation:  0.0013494491577148438
r_  generation:  0.014762163162231445
----------------------check_connections_block total spend ----------------------------- 0.21425914764404297
generate_one_block  0.014972209930419922
generate_one_block  0.010142803192138672
generate_one_block  0.009059906005859375
generate_one_block  0.01578378677368164
generate_one_block  0.007935762405395508
generate_one_block  0.019086122512817383
generate_one_block  0.015439271926879883
generate_one_block  0.0050411224365234375
generate_one_block  0.012867927551269531
generate_one_block  0.012794971466064453
generate_one_block  0.01720714569091797
generate_one_block  0.012317419052124023
generate_one_block  0.01172184944152832
generate_one_block  0.017639636993408203
generate_one_block  0.020301103591918945
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000152587890625  GigaBytes
Max Memory Allocated: 0.000152587890625  GigaBytes

connection checking time:  0.30603456497192383
block generation total time  0.3231923580169678
average batch blocks generation time:  0.021546157201131184
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02044057846069336  GigaBytes
Max Memory Allocated: 0.02044057846069336  GigaBytes

torch.Size([10695, 500])
torch.Size([4958, 32])
torch.Size([810, 32])
torch.Size([152, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.023277759552001953  GigaBytes
Max Memory Allocated: 0.024083614349365234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01614856719970703  GigaBytes
Max Memory Allocated: 0.035848140716552734  GigaBytes

torch.Size([8250, 500])
torch.Size([2444, 32])
torch.Size([521, 32])
torch.Size([71, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01765918731689453  GigaBytes
Max Memory Allocated: 0.035848140716552734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.015738487243652344  GigaBytes
Max Memory Allocated: 0.035848140716552734  GigaBytes

torch.Size([8181, 500])
torch.Size([2897, 32])
torch.Size([643, 32])
torch.Size([149, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.017512798309326172  GigaBytes
Max Memory Allocated: 0.035848140716552734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.02068328857421875  GigaBytes
Max Memory Allocated: 0.035848140716552734  GigaBytes

torch.Size([10677, 500])
torch.Size([5839, 32])
torch.Size([1549, 32])
torch.Size([338, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.024480342864990234  GigaBytes
Max Memory Allocated: 0.035848140716552734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.008783817291259766  GigaBytes
Max Memory Allocated: 0.035848140716552734  GigaBytes

torch.Size([4455, 500])
torch.Size([1923, 32])
torch.Size([320, 32])
torch.Size([56, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.009937763214111328  GigaBytes
Max Memory Allocated: 0.035848140716552734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.024591445922851562  GigaBytes
Max Memory Allocated: 0.035848140716552734  GigaBytes

torch.Size([12789, 500])
torch.Size([7600, 32])
torch.Size([1764, 32])
torch.Size([385, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.029194355010986328  GigaBytes
Max Memory Allocated: 0.035848140716552734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.019466876983642578  GigaBytes
Max Memory Allocated: 0.042899131774902344  GigaBytes

torch.Size([10080, 500])
torch.Size([4423, 32])
torch.Size([1090, 32])
torch.Size([139, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.02225637435913086  GigaBytes
Max Memory Allocated: 0.042899131774902344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.009072303771972656  GigaBytes
Max Memory Allocated: 0.042899131774902344  GigaBytes

torch.Size([4656, 500])
torch.Size([1290, 32])
torch.Size([393, 32])
torch.Size([99, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.009964942932128906  GigaBytes
Max Memory Allocated: 0.042899131774902344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.01795196533203125  GigaBytes
Max Memory Allocated: 0.042899131774902344  GigaBytes

torch.Size([9310, 500])
torch.Size([4034, 32])
torch.Size([601, 32])
torch.Size([101, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.020232677459716797  GigaBytes
Max Memory Allocated: 0.042899131774902344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.019958019256591797  GigaBytes
Max Memory Allocated: 0.042899131774902344  GigaBytes

torch.Size([10380, 500])
torch.Size([4872, 32])
torch.Size([912, 32])
torch.Size([249, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.022821426391601562  GigaBytes
Max Memory Allocated: 0.042899131774902344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.026170730590820312  GigaBytes
Max Memory Allocated: 0.04502677917480469  GigaBytes

torch.Size([13561, 500])
torch.Size([6839, 32])
torch.Size([1688, 32])
torch.Size([368, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.03043985366821289  GigaBytes
Max Memory Allocated: 0.04502677917480469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.014475345611572266  GigaBytes
Max Memory Allocated: 0.04502677917480469  GigaBytes

torch.Size([7443, 500])
torch.Size([3612, 32])
torch.Size([834, 32])
torch.Size([142, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.016734600067138672  GigaBytes
Max Memory Allocated: 0.04502677917480469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.017075061798095703  GigaBytes
Max Memory Allocated: 0.04502677917480469  GigaBytes

torch.Size([8864, 500])
torch.Size([3760, 32])
torch.Size([491, 32])
torch.Size([121, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.019153118133544922  GigaBytes
Max Memory Allocated: 0.04502677917480469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.023320674896240234  GigaBytes
Max Memory Allocated: 0.04502677917480469  GigaBytes

torch.Size([12067, 500])
torch.Size([6719, 32])
torch.Size([1835, 32])
torch.Size([393, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.027691364288330078  GigaBytes
Max Memory Allocated: 0.04502677917480469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.026310443878173828  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

torch.Size([13688, 500])
torch.Size([6317, 32])
torch.Size([1543, 32])
torch.Size([170, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.030220508575439453  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007566674550374349 |0.023468923568725587 |0.05636650721232096 |0.00012989044189453124 |0.004792610804239909 |0.0031430721282958984 |
----------------------------------------------------------pseudo_mini_loss sum 2.3171932697296143
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  230907
Number of first layer input nodes during this epoch:  145096
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.027744293212890625  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00048542022705078125
random selection method range initialization spend 0.00011086463928222656
time for parepare:  5.054473876953125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.7738037109375e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.726119995117188e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.702278137207031e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.678436279296875e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  8.654594421386719e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.1920928955078125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.726119995117188e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.511543273925781e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.630752563476562e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.678436279296875e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.1457672119140625e-05
----------------------check_connections_block total spend ----------------------------- 0.0025866031646728516
generate_one_block  0.0010890960693359375
generate_one_block  0.0012218952178955078
generate_one_block  0.0009615421295166016
generate_one_block  0.0009653568267822266
generate_one_block  0.001008749008178711
generate_one_block  0.0010066032409667969
generate_one_block  0.0009889602661132812
generate_one_block  0.0010008811950683594
generate_one_block  0.0009930133819580078
generate_one_block  0.0009567737579345703
generate_one_block  0.0009465217590332031
generate_one_block  0.0009946823120117188
generate_one_block  0.0009860992431640625
generate_one_block  0.00095367431640625
generate_one_block  0.0009622573852539062
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006313323974609375
gen group dst list time:  8.082389831542969e-05
time for parepare:  0.0002651214599609375
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0001888275146484375
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  9.655952453613281e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.723403930664062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00015735626220703125
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00022172927856445312
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  6.890296936035156e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.058547973632812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  9.5367431640625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  9.775161743164062e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.7738037109375e-05
----------------------check_connections_block total spend ----------------------------- 0.00457310676574707
generate_one_block  0.0010478496551513672
generate_one_block  0.0009832382202148438
generate_one_block  0.0010640621185302734
generate_one_block  0.001252889633178711
generate_one_block  0.0011112689971923828
generate_one_block  0.0010564327239990234
generate_one_block  0.0011937618255615234
generate_one_block  0.0012359619140625
generate_one_block  0.0023009777069091797
generate_one_block  0.0010237693786621094
generate_one_block  0.0009937286376953125
generate_one_block  0.001047372817993164
generate_one_block  0.0011174678802490234
generate_one_block  0.0010623931884765625
generate_one_block  0.0010726451873779297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011484622955322266
gen group dst list time:  0.00012302398681640625
time for parepare:  0.0007753372192382812
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.0003390312194824219
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001354217529296875
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.000293731689453125
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  0.0001773834228515625
r_  generation:  0.0014777183532714844
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.0005145072937011719
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  7.748603820800781e-05
r_  generation:  0.0005967617034912109
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  0.00013518333435058594
r_  generation:  0.0011951923370361328
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.0001595020294189453
r_  generation:  0.0016186237335205078
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.00017833709716796875
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00028514862060546875
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00021600723266601562
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.00038886070251464844
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0005345344543457031
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0007555484771728516
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00023317337036132812
----------------------check_connections_block total spend ----------------------------- 0.01585841178894043
generate_one_block  0.0017583370208740234
generate_one_block  0.0011332035064697266
generate_one_block  0.0012927055358886719
generate_one_block  0.002789020538330078
generate_one_block  0.0015027523040771484
generate_one_block  0.0017178058624267578
generate_one_block  0.002447366714477539
generate_one_block  0.003040790557861328
generate_one_block  0.0011301040649414062
generate_one_block  0.0014400482177734375
generate_one_block  0.001203298568725586
generate_one_block  0.0014123916625976562
generate_one_block  0.0016131401062011719
generate_one_block  0.0018711090087890625
generate_one_block  0.0011892318725585938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002010822296142578
gen group dst list time:  0.00032973289489746094
time for parepare:  0.0014262199401855469
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.0004951953887939453
mini_batch_src_global generation:  0.00020956993103027344
r_  generation:  0.0019378662109375
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  0.00010538101196289062
r_  generation:  0.0004813671112060547
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  0.00013256072998046875
r_  generation:  0.0014545917510986328
local_output_nid generation:  0.0001399517059326172
local_in_edges_tensor generation:  0.0003783702850341797
mini_batch_src_global generation:  0.0006535053253173828
r_  generation:  0.005876779556274414
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  0.00041294097900390625
r_  generation:  0.0029795169830322266
local_output_nid generation:  0.00012755393981933594
local_in_edges_tensor generation:  0.00031638145446777344
mini_batch_src_global generation:  0.00040411949157714844
r_  generation:  0.004098176956176758
local_output_nid generation:  0.00013875961303710938
local_in_edges_tensor generation:  0.00035500526428222656
mini_batch_src_global generation:  0.0005199909210205078
r_  generation:  0.005288600921630859
local_output_nid generation:  0.00023651123046875
local_in_edges_tensor generation:  0.0005376338958740234
mini_batch_src_global generation:  0.0009484291076660156
r_  generation:  0.00885629653930664
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  0.0003368854522705078
r_  generation:  0.0014519691467285156
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.00019049644470214844
r_  generation:  0.0018208026885986328
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  0.00018835067749023438
r_  generation:  0.001608133316040039
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.00020933151245117188
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.002237081527709961
local_output_nid generation:  9.512901306152344e-05
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  0.00028824806213378906
r_  generation:  0.0028579235076904297
local_output_nid generation:  0.00013637542724609375
local_in_edges_tensor generation:  0.0003192424774169922
mini_batch_src_global generation:  0.0003693103790283203
r_  generation:  0.003914833068847656
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  0.00015997886657714844
r_  generation:  0.000690460205078125
----------------------check_connections_block total spend ----------------------------- 0.07063436508178711
generate_one_block  0.004038572311401367
generate_one_block  0.001687765121459961
generate_one_block  0.002892017364501953
generate_one_block  0.008585691452026367
generate_one_block  0.00505518913269043
generate_one_block  0.006376743316650391
generate_one_block  0.007988691329956055
generate_one_block  0.01414632797241211
generate_one_block  0.002692699432373047
generate_one_block  0.0033833980560302734
generate_one_block  0.0030677318572998047
generate_one_block  0.004106760025024414
generate_one_block  0.004722118377685547
generate_one_block  0.0058672428131103516
generate_one_block  0.0017001628875732422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0023636817932128906
gen group dst list time:  0.0013539791107177734
time for parepare:  0.0017819404602050781
local_output_nid generation:  0.00032210350036621094
local_in_edges_tensor generation:  0.0011162757873535156
mini_batch_src_global generation:  0.0009388923645019531
r_  generation:  0.007810831069946289
local_output_nid generation:  9.5367431640625e-05
local_in_edges_tensor generation:  0.0002665519714355469
mini_batch_src_global generation:  0.0003592967987060547
r_  generation:  0.002191305160522461
local_output_nid generation:  0.00026988983154296875
local_in_edges_tensor generation:  0.0005323886871337891
mini_batch_src_global generation:  0.0005230903625488281
r_  generation:  0.0061914920806884766
local_output_nid generation:  0.0005860328674316406
local_in_edges_tensor generation:  0.0010428428649902344
mini_batch_src_global generation:  0.00142669677734375
r_  generation:  0.01301264762878418
local_output_nid generation:  0.0005245208740234375
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0010406970977783203
r_  generation:  0.01137685775756836
local_output_nid generation:  0.0004899501800537109
local_in_edges_tensor generation:  0.0008375644683837891
mini_batch_src_global generation:  0.0009796619415283203
r_  generation:  0.01166987419128418
local_output_nid generation:  0.0005316734313964844
local_in_edges_tensor generation:  0.0008633136749267578
mini_batch_src_global generation:  0.0009856224060058594
r_  generation:  0.012076139450073242
local_output_nid generation:  0.0010073184967041016
local_in_edges_tensor generation:  0.0015494823455810547
mini_batch_src_global generation:  0.0018737316131591797
r_  generation:  0.02082371711730957
local_output_nid generation:  0.0002040863037109375
local_in_edges_tensor generation:  0.0004363059997558594
mini_batch_src_global generation:  0.0008003711700439453
r_  generation:  0.00553584098815918
local_output_nid generation:  0.0003733634948730469
local_in_edges_tensor generation:  0.0005977153778076172
mini_batch_src_global generation:  0.0006060600280761719
r_  generation:  0.00654292106628418
local_output_nid generation:  0.0003542900085449219
local_in_edges_tensor generation:  0.0005602836608886719
mini_batch_src_global generation:  0.0006895065307617188
r_  generation:  0.0070455074310302734
local_output_nid generation:  0.0004265308380126953
local_in_edges_tensor generation:  0.0006749629974365234
mini_batch_src_global generation:  0.0007483959197998047
r_  generation:  0.008112907409667969
local_output_nid generation:  0.00043892860412597656
local_in_edges_tensor generation:  0.0007236003875732422
mini_batch_src_global generation:  0.0009510517120361328
r_  generation:  0.009716510772705078
local_output_nid generation:  0.0005118846893310547
local_in_edges_tensor generation:  0.0007989406585693359
mini_batch_src_global generation:  0.0008738040924072266
r_  generation:  0.011611223220825195
local_output_nid generation:  0.00010800361633300781
local_in_edges_tensor generation:  0.0002741813659667969
mini_batch_src_global generation:  0.0004601478576660156
r_  generation:  0.002378702163696289
----------------------check_connections_block total spend ----------------------------- 0.20218348503112793
generate_one_block  0.012390613555908203
generate_one_block  0.003742218017578125
generate_one_block  0.01035165786743164
generate_one_block  0.01786208152770996
generate_one_block  0.017966032028198242
generate_one_block  0.01602029800415039
generate_one_block  0.016902923583984375
generate_one_block  0.02589726448059082
generate_one_block  0.009155988693237305
generate_one_block  0.009390830993652344
generate_one_block  0.010125398635864258
generate_one_block  0.011317253112792969
generate_one_block  0.013948678970336914
generate_one_block  0.015499114990234375
generate_one_block  0.003913164138793945
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.027744293212890625  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

connection checking time:  0.29324936866760254
block generation total time  0.3138997554779053
average batch blocks generation time:  0.020926650365193686
block dataloader generation time/epoch 0.6666862964630127
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.018522262573242188  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

torch.Size([9476, 500])
torch.Size([3333, 32])
torch.Size([691, 32])
torch.Size([137, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.020568370819091797  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.0076732635498046875  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

torch.Size([3764, 500])
torch.Size([881, 32])
torch.Size([209, 32])
torch.Size([65, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.008249282836914062  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.01656055450439453  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

torch.Size([8454, 500])
torch.Size([2760, 32])
torch.Size([517, 32])
torch.Size([114, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.018212318420410156  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.024442672729492188  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

torch.Size([12503, 500])
torch.Size([6497, 32])
torch.Size([1831, 32])
torch.Size([362, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.028725624084472656  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.022474288940429688  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

torch.Size([11497, 500])
torch.Size([5379, 32])
torch.Size([817, 32])
torch.Size([205, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.025538921356201172  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.022521018981933594  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

torch.Size([11312, 500])
torch.Size([5287, 32])
torch.Size([1296, 32])
torch.Size([146, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.025812625885009766  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.0225830078125  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

torch.Size([11287, 500])
torch.Size([6043, 32])
torch.Size([1658, 32])
torch.Size([348, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.026531696319580078  GigaBytes
Max Memory Allocated: 0.04827451705932617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.03262615203857422  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes

torch.Size([16394, 500])
torch.Size([11580, 32])
torch.Size([3016, 32])
torch.Size([579, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.04044151306152344  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.00992441177368164  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes

torch.Size([4906, 500])
torch.Size([2115, 32])
torch.Size([294, 32])
torch.Size([60, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.01114654541015625  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.015439510345458984  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes

torch.Size([7847, 500])
torch.Size([3341, 32])
torch.Size([566, 32])
torch.Size([118, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.017362117767333984  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.016457557678222656  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes

torch.Size([7902, 500])
torch.Size([3179, 32])
torch.Size([447, 32])
torch.Size([103, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.01824808120727539  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.019034862518310547  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes

torch.Size([9748, 500])
torch.Size([4529, 32])
torch.Size([685, 32])
torch.Size([191, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.021575450897216797  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.020649433135986328  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes

torch.Size([10578, 500])
torch.Size([4691, 32])
torch.Size([977, 32])
torch.Size([206, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.023484230041503906  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.02511453628540039  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes

torch.Size([12939, 500])
torch.Size([5573, 32])
torch.Size([1535, 32])
torch.Size([198, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.028649330139160156  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.007498264312744141  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes

torch.Size([3664, 500])
torch.Size([1007, 32])
torch.Size([349, 32])
torch.Size([98, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.008234500885009766  GigaBytes
Max Memory Allocated: 0.0533299446105957  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005322376887003581 |0.0010374069213867187 |0.0054667154947916664 |0.00013783772786458333 |0.005236132939656576 |0.002668619155883789 |
----------------------------------------------------------pseudo_mini_loss sum 2.429316997528076
Total (block generation + training)time/epoch 0.9453721046447754
Training time/epoch 0.27819180488586426
Training time without block to device /epoch 0.2626307010650635
Training time without total dataloading part /epoch 0.16527891159057617
load block tensor time/epoch 0.07983565330505371
block to device time/epoch 0.015561103820800781
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  226641
Number of first layer input nodes during this epoch:  142271
