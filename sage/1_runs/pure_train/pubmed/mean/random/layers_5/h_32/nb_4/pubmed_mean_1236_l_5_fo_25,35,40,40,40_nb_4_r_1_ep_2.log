main start at this time 1648531720.917897
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000152587890625  GigaBytes
Max Memory Allocated: 0.000152587890625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013964176177978516
random selection method range initialization spend 0.0002110004425048828
time for parepare:  4.744529724121094e-05
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0015418529510498047
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  6.318092346191406e-05
----------------------check_connections_block total spend ----------------------------- 0.0022573471069335938
generate_one_block  0.0014121532440185547
generate_one_block  0.001154184341430664
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0008218288421630859
gen group dst list time:  2.7179718017578125e-05
time for parepare:  0.0002415180206298828
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0006327629089355469
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  0.00010323524475097656
r_  generation:  0.0006725788116455078
----------------------check_connections_block total spend ----------------------------- 0.0024671554565429688
generate_one_block  0.001926422119140625
generate_one_block  0.0019402503967285156
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010218620300292969
gen group dst list time:  6.556510925292969e-05
time for parepare:  0.0007531642913818359
local_output_nid generation:  9.369850158691406e-05
local_in_edges_tensor generation:  0.0003838539123535156
mini_batch_src_global generation:  0.0003247261047363281
r_  generation:  0.003918170928955078
local_output_nid generation:  0.00011229515075683594
local_in_edges_tensor generation:  0.0003192424774169922
mini_batch_src_global generation:  0.0005567073822021484
r_  generation:  0.004429340362548828
----------------------check_connections_block total spend ----------------------------- 0.013126373291015625
generate_one_block  0.006890535354614258
generate_one_block  0.0063211917877197266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019011497497558594
gen group dst list time:  0.00019550323486328125
time for parepare:  0.001432657241821289
local_output_nid generation:  0.0003886222839355469
local_in_edges_tensor generation:  0.0010254383087158203
mini_batch_src_global generation:  0.001386404037475586
r_  generation:  0.013732433319091797
local_output_nid generation:  0.0004267692565917969
local_in_edges_tensor generation:  0.0009067058563232422
mini_batch_src_global generation:  0.0016636848449707031
r_  generation:  0.015128135681152344
----------------------check_connections_block total spend ----------------------------- 0.04325079917907715
generate_one_block  0.01842188835144043
generate_one_block  0.021074533462524414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001725912094116211
gen group dst list time:  0.0004956722259521484
time for parepare:  0.0015518665313720703
local_output_nid generation:  0.0010936260223388672
local_in_edges_tensor generation:  0.0020482540130615234
mini_batch_src_global generation:  0.0020627975463867188
r_  generation:  0.022547245025634766
local_output_nid generation:  0.0011386871337890625
local_in_edges_tensor generation:  0.002201080322265625
mini_batch_src_global generation:  0.00270843505859375
r_  generation:  0.023727893829345703
----------------------check_connections_block total spend ----------------------------- 0.0696723461151123
generate_one_block  0.027045011520385742
generate_one_block  0.030180692672729492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000152587890625  GigaBytes
Max Memory Allocated: 0.000152587890625  GigaBytes

connection checking time:  0.12851667404174805
block generation total time  0.1138005256652832
average batch blocks generation time:  0.0569002628326416
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03434324264526367  GigaBytes
Max Memory Allocated: 0.03434324264526367  GigaBytes

torch.Size([17630, 500])
torch.Size([13517, 32])
torch.Size([5127, 32])
torch.Size([1267, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.04455232620239258  GigaBytes
Max Memory Allocated: 0.044587135314941406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.034539222717285156  GigaBytes
Max Memory Allocated: 0.06670808792114258  GigaBytes

torch.Size([17632, 500])
torch.Size([14001, 32])
torch.Size([5618, 32])
torch.Size([1496, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.045289039611816406  GigaBytes
Max Memory Allocated: 0.06670808792114258  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0245516300201416 |0.17246758937835693 |0.3879586458206177 |0.00020194053649902344 |0.008874893188476562 |0.006646156311035156 |
----------------------------------------------------------pseudo_mini_loss sum 2.430530548095703
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  76642
Number of first layer input nodes during this epoch:  35262
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.037128448486328125  GigaBytes
Max Memory Allocated: 0.06670808792114258  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004947185516357422
random selection method range initialization spend 0.0001087188720703125
time for parepare:  4.9591064453125e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  5.936622619628906e-05
----------------------check_connections_block total spend ----------------------------- 0.0006968975067138672
generate_one_block  0.0011415481567382812
generate_one_block  0.0011081695556640625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005207061767578125
gen group dst list time:  2.6464462280273438e-05
time for parepare:  0.0002689361572265625
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0007178783416748047
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation: Using backend: pytorch
 8.368492126464844e-05
r_  generation:  0.0005686283111572266
----------------------check_connections_block total spend ----------------------------- 0.002537250518798828
generate_one_block  0.00196075439453125
generate_one_block  0.0017883777618408203
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000997304916381836
gen group dst list time:  7.152557373046875e-05
time for parepare:  0.0007431507110595703
local_output_nid generation:  0.00011229515075683594
local_in_edges_tensor generation:  0.00042510032653808594
mini_batch_src_global generation:  0.00039577484130859375
r_  generation:  0.004656314849853516
local_output_nid generation:  9.465217590332031e-05
local_in_edges_tensor generation:  0.00027370452880859375
mini_batch_src_global generation:  0.00035881996154785156
r_  generation:  0.003193378448486328
----------------------check_connections_block total spend ----------------------------- 0.012270450592041016
generate_one_block  0.007519960403442383
generate_one_block  0.004637718200683594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001802682876586914
gen group dst list time:  0.0001895427703857422
time for parepare:  0.001308441162109375
local_output_nid generation:  0.0003895759582519531
local_in_edges_tensor generation:  0.0011334419250488281
mini_batch_src_global generation:  0.0012900829315185547
r_  generation:  0.014792442321777344
local_output_nid generation:  0.0003666877746582031
local_in_edges_tensor generation:  0.0007946491241455078
mini_batch_src_global generation:  0.0014495849609375
r_  generation:  0.012446403503417969
----------------------check_connections_block total spend ----------------------------- 0.040547847747802734
generate_one_block  0.01884746551513672
generate_one_block  0.017232894897460938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001676797866821289
gen group dst list time:  0.0005273818969726562
time for parepare:  0.0014629364013671875
local_output_nid generation:  0.001077413558959961
local_in_edges_tensor generation:  0.0022737979888916016
mini_batch_src_global generation:  0.001916646957397461
r_  generation:  0.023116588592529297
local_output_nid generation:  0.0010399818420410156
local_in_edges_tensor generation:  0.002138853073120117
mini_batch_src_global generation:  0.002424955368041992
r_  generation:  0.022565126419067383
----------------------check_connections_block total spend ----------------------------- 0.06866598129272461
generate_one_block  0.027475595474243164
generate_one_block  0.0306093692779541
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.037128448486328125  GigaBytes
Max Memory Allocated: 0.06670808792114258  GigaBytes

connection checking time:  0.12402153015136719
block generation total time  0.11007213592529297
average batch blocks generation time:  0.055036067962646484
block dataloader generation time/epoch 0.2683906555175781
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.034834861755371094  GigaBytes
Max Memory Allocated: 0.0670008659362793  GigaBytes

torch.Size([17677, 500])
torch.Size([14079, 32])
torch.Size([5421, 32])
torch.Size([1520, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.04553079605102539  GigaBytes
Max Memory Allocated: 0.0670008659362793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.03471851348876953  GigaBytes
Max Memory Allocated: 0.0670018196105957  GigaBytes

torch.Size([17521, 500])
torch.Size([13146, 32])
torch.Size([4766, 32])
torch.Size([1187, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.04451274871826172  GigaBytes
Max Memory Allocated: 0.0670018196105957  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012256741523742676 |0.0013562440872192383 |0.0057457685470581055 |0.00014007091522216797 |0.004478812217712402 |0.00238800048828125 |
----------------------------------------------------------pseudo_mini_loss sum 2.4215664863586426
Total (block generation + training)time/epoch 0.32208871841430664
Training time/epoch 0.05329322814941406
Training time without block to device /epoch 0.050580739974975586
Training time without total dataloading part /epoch 0.0231173038482666
load block tensor time/epoch 0.02451348304748535
block to device time/epoch 0.0027124881744384766
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  75672
Number of first layer input nodes during this epoch:  35198
