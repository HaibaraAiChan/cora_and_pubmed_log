main start at this time 1648531742.6416945
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000152587890625  GigaBytes
Max Memory Allocated: 0.000152587890625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007936954498291016
random selection method range initialization spend 0.00021719932556152344
time for parepare:  5.626678466796875e-05
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0014293193817138672
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.7881393432617188e-05
----------------------check_connections_block total spend ----------------------------- 0.0034570693969726562
generate_one_block  0.0014491081237792969
generate_one_block  0.0012912750244140625
generate_one_block  0.0012700557708740234
generate_one_block  0.0012657642364501953
generate_one_block  0.0012488365173339844
generate_one_block  0.0012814998626708984
generate_one_block  0.0012555122375488281
generate_one_block  0.001199483871459961
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006392002105712891
gen group dst list time:  7.128715515136719e-05
time for parepare:  0.0002913475036621094
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00014162063598632812
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00029730796813964844
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0002276897430419922
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00016951560974121094
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00018072128295898438
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002789497375488281
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00027298927307128906
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  9.72747802734375e-05
----------------------check_connections_block total spend ----------------------------- 0.004126548767089844
generate_one_block  0.001438140869140625
generate_one_block  0.0016279220581054688
generate_one_block  0.0015437602996826172
generate_one_block  0.0014345645904541016
generate_one_block  0.0014796257019042969
generate_one_block  0.0015931129455566406
generate_one_block  0.0014193058013916016
generate_one_block  0.0010857582092285156
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011415481567382812
gen group dst list time:  0.00011849403381347656
time for parepare:  0.0009598731994628906
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.0002810955047607422
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0008137226104736328
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  0.00022077560424804688
r_  generation:  0.0021533966064453125
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  0.0001811981201171875
r_  generation:  0.0014753341674804688
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0009486675262451172
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  0.00013113021850585938
r_  generation:  0.001207590103149414
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.000225067138671875
mini_batch_src_global generation:  0.00018095970153808594
r_  generation:  0.0018050670623779297
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.00023293495178222656
mini_batch_src_global generation:  0.0002224445343017578
r_  generation:  0.001608133316040039
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.0006561279296875
----------------------check_connections_block total spend ----------------------------- 0.018004655838012695
generate_one_block  0.0025157928466796875
generate_one_block  0.003068208694458008
generate_one_block  0.0023937225341796875
generate_one_block  0.0017926692962646484
generate_one_block  0.0020363330841064453
generate_one_block  0.002753019332885742
generate_one_block  0.002912759780883789
generate_one_block  0.0018279552459716797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019674301147460938
gen group dst list time:  0.00036525726318359375
time for parepare:  0.0019335746765136719
local_output_nid generation:  0.00017523765563964844
local_in_edges_tensor generation:  0.0006103515625
mini_batch_src_global generation:  0.0006706714630126953
r_  generation:  0.0045087337493896484
local_output_nid generation:  0.00019860267639160156
local_in_edges_tensor generation:  0.00043463706970214844
mini_batch_src_global generation:  0.0009288787841796875
r_  generation:  0.0069446563720703125
local_output_nid generation:  0.00019097328186035156
local_in_edges_tensor generation:  0.0004260540008544922
mini_batch_src_global generation:  0.0006918907165527344
r_  generation:  0.005974531173706055
local_output_nid generation:  0.000156402587890625
local_in_edges_tensor generation:  0.0003261566162109375
mini_batch_src_global generation:  0.0004799365997314453
r_  generation:  0.004128932952880859
local_output_nid generation:  0.0001354217529296875
local_in_edges_tensor generation:  0.000316619873046875
mini_batch_src_global generation:  0.0004620552062988281
r_  generation:  0.004752397537231445
local_output_nid generation:  0.000202178955078125
local_in_edges_tensor generation:  0.0004360675811767578
mini_batch_src_global generation:  0.0006468296051025391
r_  generation:  0.006863832473754883
local_output_nid generation:  0.00017976760864257812
local_in_edges_tensor generation:  0.00040030479431152344
mini_batch_src_global generation:  0.0007035732269287109
r_  generation:  0.006711244583129883
local_output_nid generation:  0.0001277923583984375
local_in_edges_tensor generation:  0.00032138824462890625
mini_batch_src_global generation:  0.0005562305450439453
r_  generation:  0.00497126579284668
----------------------check_connections_block total spend ----------------------------- 0.06862521171569824
generate_one_block  0.006805896759033203
generate_one_block  0.009789228439331055
generate_one_block  0.009580135345458984
generate_one_block  0.006265401840209961
generate_one_block  0.007995843887329102
generate_one_block  0.010518550872802734
generate_one_block  0.009863853454589844
generate_one_block  0.007447242736816406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002691984176635742
gen group dst list time:  0.0014469623565673828
time for parepare:  0.0017859935760498047
local_output_nid generation:  0.0005960464477539062
local_in_edges_tensor generation:  0.0013763904571533203
mini_batch_src_global generation:  0.0015451908111572266
r_  generation:  0.014489889144897461
local_output_nid generation:  0.0007119178771972656
local_in_edges_tensor generation:  0.0016319751739501953
mini_batch_src_global generation:  0.001836538314819336
r_  generation:  0.015947341918945312
local_output_nid generation:  0.0009658336639404297
local_in_edges_tensor generation:  0.0013916492462158203
mini_batch_src_global generation:  0.0014922618865966797
r_  generation:  0.018072128295898438
local_output_nid generation:  0.0005917549133300781
local_in_edges_tensor generation:  0.0008356571197509766
mini_batch_src_global generation:  0.0012443065643310547
r_  generation:  0.013177156448364258
local_output_nid generation:  0.0008282661437988281
local_in_edges_tensor generation:  0.0011463165283203125
mini_batch_src_global generation:  0.0012176036834716797
r_  generation:  0.015635967254638672
local_output_nid generation:  0.0008018016815185547
local_in_edges_tensor generation:  0.0013539791107177734
mini_batch_src_global generation:  0.0017275810241699219
r_  generation:  0.0202333927154541
local_output_nid generation:  0.0007560253143310547
local_in_edges_tensor generation:  0.0010628700256347656
mini_batch_src_global generation:  0.0016372203826904297
r_  generation:  0.018636703491210938
local_output_nid generation:  0.0006265640258789062
local_in_edges_tensor generation:  0.0009202957153320312
mini_batch_src_global generation:  0.0016031265258789062
r_  generation:  0.017877817153930664
----------------------check_connections_block total spend ----------------------------- 0.19572758674621582
generate_one_block  0.018822908401489258
generate_one_block  0.021941184997558594
generate_one_block  0.026059389114379883
generate_one_block  0.019269943237304688
generate_one_block  0.02056884765625
generate_one_block  0.02623295783996582
generate_one_block  0.02369832992553711
generate_one_block  0.02237534523010254
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000152587890625  GigaBytes
Max Memory Allocated: 0.000152587890625  GigaBytes

connection checking time:  0.2864840030670166
block generation total time  0.27815771102905273
average batch blocks generation time:  0.03476971387863159
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.02603006362915039  GigaBytes
Max Memory Allocated: 0.02603006362915039  GigaBytes

torch.Size([13435, 500])
torch.Size([6341, 32])
torch.Size([1279, 32])
torch.Size([223, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02981853485107422  GigaBytes
Max Memory Allocated: 0.030300140380859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.026294708251953125  GigaBytes
Max Memory Allocated: 0.05108308792114258  GigaBytes

torch.Size([13463, 500])
torch.Size([7618, 32])
torch.Size([2131, 32])
torch.Size([483, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03128814697265625  GigaBytes
Max Memory Allocated: 0.05108308792114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.0289459228515625  GigaBytes
Max Memory Allocated: 0.05371236801147461  GigaBytes

torch.Size([15043, 500])
torch.Size([9286, 32])
torch.Size([2087, 32])
torch.Size([444, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.035430908203125  GigaBytes
Max Memory Allocated: 0.05371236801147461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.022617340087890625  GigaBytes
Max Memory Allocated: 0.05371236801147461  GigaBytes

torch.Size([11739, 500])
torch.Size([5320, 32])
torch.Size([1476, 32])
torch.Size([238, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.026088714599609375  GigaBytes
Max Memory Allocated: 0.05371236801147461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.02621746063232422  GigaBytes
Max Memory Allocated: 0.05371236801147461  GigaBytes

torch.Size([13461, 500])
torch.Size([7642, 32])
torch.Size([1495, 32])
torch.Size([351, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.030733108520507812  GigaBytes
Max Memory Allocated: 0.05371236801147461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.030261993408203125  GigaBytes
Max Memory Allocated: 0.05498933792114258  GigaBytes

torch.Size([15466, 500])
torch.Size([9021, 32])
torch.Size([2448, 32])
torch.Size([507, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.0368194580078125  GigaBytes
Max Memory Allocated: 0.05498933792114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.02631092071533203  GigaBytes
Max Memory Allocated: 0.05498933792114258  GigaBytes

torch.Size([13558, 500])
torch.Size([8108, 32])
torch.Size([2164, 32])
torch.Size([515, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.031542301177978516  GigaBytes
Max Memory Allocated: 0.05498933792114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.026622772216796875  GigaBytes
Max Memory Allocated: 0.05498933792114258  GigaBytes

torch.Size([13846, 500])
torch.Size([6761, 32])
torch.Size([1663, 32])
torch.Size([170, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.030786514282226562  GigaBytes
Max Memory Allocated: 0.05498933792114258  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012287497520446777 |0.04386049509048462 |0.10119268298149109 |0.00015789270401000977 |0.005095422267913818 |0.003931760787963867 |
----------------------------------------------------------pseudo_mini_loss sum 2.7609288692474365
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  188139
Number of first layer input nodes during this epoch:  110011
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.028096675872802734  GigaBytes
Max Memory Allocated: 0.05498933792114258  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005030632019042969
random selection method range initialization spend 0.00011444091796875
time for parepare:  5.125999450683594e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.288818359375e-05
----------------------check_connections_block total spend ----------------------------- 0.0016756057739257812
generate_one_block  0.0013132095336914062
generate_one_block  0.0010695457458496094
generate_one_block  0.0010559558868408203
generate_one_block  0.001069784164428711
generate_one_block  0.0010383129119873047
generate_one_block  0.0010457038879394531
generate_one_block  0.0010519027709960938
generate_one_block  0.0011479854583740234
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005390644073486328
gen group dst list time:  5.269050598144531e-05
time for parepare:  0.00029015541076660156
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00010561943054199219
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.0002536773681640625
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00016355514526367188
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0003974437713623047
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00010228157043457031
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0001163482666015625
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0001919269561767578
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  8.463859558105469e-05
----------------------check_connections_block total spend ----------------------------- 0.0036432743072509766
generate_one_block  0.0011813640594482422
generate_one_block  0.001361846923828125
generate_one_block  0.0012288093566894531
generate_one_block  0.0015461444854736328
generate_one_block  0.0011315345764160156
generate_one_block  0.0011816024780273438
generate_one_block  0.0012784004211425781
generate_one_block  0.0011065006256103516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001203298568725586
gen group dst list time:  0.00010848045349121094
time for parepare:  0.0008480548858642578
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.00047850608825683594
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  0.0002567768096923828
r_  generation:  0.0019168853759765625
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  0.0001671314239501953
r_  generation:  0.001085519790649414
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.00024437904357910156
mini_batch_src_global generation:  0.0002818107604980469
r_  generation:  0.0029311180114746094
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  0.00012803077697753906
r_  generation:  0.0005140304565429688
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0006644725799560547
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  0.0001266002655029297
r_  generation:  0.0012254714965820312
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0002536773681640625
----------------------check_connections_block total spend ----------------------------- 0.015398740768432617
generate_one_block  0.0017223358154296875
generate_one_block  0.003159761428833008
generate_one_block  0.0022542476654052734
generate_one_block  0.00455927848815918
generate_one_block  0.0015072822570800781
generate_one_block  0.0016450881958007812
generate_one_block  0.0024268627166748047
generate_one_block  0.001180887222290039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020613670349121094
gen group dst list time:  0.00028824806213378906
time for parepare:  0.0015015602111816406
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.00051116943359375
mini_batch_src_global generation:  0.00026154518127441406
r_  generation:  0.0024933815002441406
local_output_nid generation:  0.00018739700317382812
local_in_edges_tensor generation:  0.0004658699035644531
mini_batch_src_global generation:  0.0008060932159423828
r_  generation:  0.007619619369506836
local_output_nid generation:  0.00018668174743652344
local_in_edges_tensor generation:  0.00044417381286621094
mini_batch_src_global generation:  0.0007922649383544922
r_  generation:  0.006335020065307617
local_output_nid generation:  0.00029921531677246094
local_in_edges_tensor generation:  0.0006740093231201172
mini_batch_src_global generation:  0.0028476715087890625
r_  generation:  0.012144804000854492
local_output_nid generation:  8.726119995117188e-05
local_in_edges_tensor generation:  0.0002675056457519531
mini_batch_src_global generation:  0.0005514621734619141
r_  generation:  0.0034630298614501953
local_output_nid generation:  0.00010919570922851562
local_in_edges_tensor generation:  0.00029850006103515625
mini_batch_src_global generation:  0.00042366981506347656
r_  generation:  0.003591299057006836
local_output_nid generation:  0.0001976490020751953
local_in_edges_tensor generation:  0.00040602684020996094
mini_batch_src_global generation:  0.0004930496215820312
r_  generation:  0.0052433013916015625
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  0.00019121170043945312
r_  generation:  0.0007193088531494141
----------------------check_connections_block total spend ----------------------------- 0.06423115730285645
generate_one_block  0.004309177398681641
generate_one_block  0.010030269622802734
generate_one_block  0.009281158447265625
generate_one_block  0.01576399803161621
generate_one_block  0.005642890930175781
generate_one_block  0.006543397903442383
generate_one_block  0.008505582809448242
generate_one_block  0.001771688461303711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001750946044921875
gen group dst list time:  0.001051187515258789
time for parepare:  0.0017800331115722656
local_output_nid generation:  0.0004055500030517578
local_in_edges_tensor generation:  0.0009853839874267578
mini_batch_src_global generation:  0.0024585723876953125
r_  generation:  0.00960993766784668
local_output_nid generation:  0.0007066726684570312
local_in_edges_tensor generation:  0.001264810562133789
mini_batch_src_global generation:  0.0018818378448486328
r_  generation:  0.016327857971191406
local_output_nid generation:  0.0008299350738525391
local_in_edges_tensor generation:  0.0012867450714111328
mini_batch_src_global generation:  0.0015234947204589844
r_  generation:  0.016623973846435547
local_output_nid generation:  0.0012345314025878906
local_in_edges_tensor generation:  0.001631021499633789
mini_batch_src_global generation:  0.0020165443420410156
r_  generation:  0.022027969360351562
local_output_nid generation:  0.0005812644958496094
local_in_edges_tensor generation:  0.0008003711700439453
mini_batch_src_global generation:  0.0012469291687011719
r_  generation:  0.014719724655151367
local_output_nid generation:  0.0007088184356689453
local_in_edges_tensor generation:  0.0023956298828125
mini_batch_src_global generation:  0.0012073516845703125
r_  generation:  0.013993978500366211
local_output_nid generation:  0.0007238388061523438
local_in_edges_tensor generation:  0.0010652542114257812
mini_batch_src_global generation:  0.0013353824615478516
r_  generation:  0.015686988830566406
local_output_nid generation:  0.00011038780212402344
local_in_edges_tensor generation:  0.0002636909484863281
mini_batch_src_global generation:  0.0005130767822265625
r_  generation:  0.0025606155395507812
----------------------check_connections_block total spend ----------------------------- 0.1656339168548584
generate_one_block  0.013640165328979492
generate_one_block  0.020188093185424805
generate_one_block  0.023407697677612305
generate_one_block  0.028006553649902344
generate_one_block  0.016399145126342773
generate_one_block  0.01811838150024414
generate_one_block  0.02107071876525879
generate_one_block  0.005140781402587891
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.028096675872802734  GigaBytes
Max Memory Allocated: 0.05498933792114258  GigaBytes

connection checking time:  0.24890708923339844
block generation total time  0.23629164695739746
average batch blocks generation time:  0.029536455869674683
block dataloader generation time/epoch 0.5300347805023193
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.020569324493408203  GigaBytes
Max Memory Allocated: 0.05498933792114258  GigaBytes

torch.Size([10558, 500])
torch.Size([3826, 32])
torch.Size([848, 32])
torch.Size([199, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.02295684814453125  GigaBytes
Max Memory Allocated: 0.05498933792114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.026871681213378906  GigaBytes
Max Memory Allocated: 0.05498933792114258  GigaBytes

torch.Size([13766, 500])
torch.Size([7765, 32])
torch.Size([2266, 32])
torch.Size([474, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03201913833618164  GigaBytes
Max Memory Allocated: 0.05498933792114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.027070045471191406  GigaBytes
Max Memory Allocated: 0.05498933792114258  GigaBytes

torch.Size([13894, 500])
torch.Size([7721, 32])
torch.Size([1911, 32])
torch.Size([348, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03190326690673828  GigaBytes
Max Memory Allocated: 0.05498933792114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.03299856185913086  GigaBytes
Max Memory Allocated: 0.057976722717285156  GigaBytes

torch.Size([16912, 500])
torch.Size([12748, 32])
torch.Size([4052, 32])
torch.Size([881, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0422053337097168  GigaBytes
Max Memory Allocated: 0.057976722717285156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.02074718475341797  GigaBytes
Max Memory Allocated: 0.057976722717285156  GigaBytes

torch.Size([10611, 500])
torch.Size([5163, 32])
torch.Size([852, 32])
torch.Size([178, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.02372884750366211  GigaBytes
Max Memory Allocated: 0.057976722717285156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.024300575256347656  GigaBytes
Max Memory Allocated: 0.057976722717285156  GigaBytes

torch.Size([12490, 500])
torch.Size([6719, 32])
torch.Size([1087, 32])
torch.Size([293, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.02812671661376953  GigaBytes
Max Memory Allocated: 0.057976722717285156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.028479576110839844  GigaBytes
Max Memory Allocated: 0.057976722717285156  GigaBytes

torch.Size([14494, 500])
torch.Size([7337, 32])
torch.Size([2136, 32])
torch.Size([391, 32])Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.033251285552978516  GigaBytes
Max Memory Allocated: 0.057976722717285156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.007541179656982422  GigaBytes
Max Memory Allocated: 0.057976722717285156  GigaBytes

torch.Size([3687, 500])
torch.Size([1008, 32])
torch.Size([351, 32])
torch.Size([98, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.008277416229248047  GigaBytes
Max Memory Allocated: 0.057976722717285156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006873041391372681 |0.0010085701942443848 |0.005685746669769287 |0.0001354515552520752 |0.004152894020080566 |0.00241851806640625 |
----------------------------------------------------------pseudo_mini_loss sum 2.234128475189209
Total (block generation + training)time/epoch 0.6864182949066162
Training time/epoch 0.15589141845703125
Training time without block to device /epoch 0.14782285690307617
Training time without total dataloading part /epoch 0.08221125602722168
load block tensor time/epoch 0.054984331130981445
block to device time/epoch 0.008068561553955078
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  165420
Number of first layer input nodes during this epoch:  96412
