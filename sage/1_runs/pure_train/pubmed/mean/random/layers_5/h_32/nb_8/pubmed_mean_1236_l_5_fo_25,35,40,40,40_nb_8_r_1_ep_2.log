main start at this time 1648531731.6082273
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000152587890625  GigaBytes
Max Memory Allocated: 0.000152587890625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.006590604782104492
random selection method range initialization spend 0.00023698806762695312
time for parepare:  5.793571472167969e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0012862682342529297
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  5.340576171875e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.743171691894531e-05
----------------------check_connections_block total spend ----------------------------- 0.002476930618286133
generate_one_block  0.0024051666259765625
generate_one_block  0.0012922286987304688
generate_one_block  0.0012340545654296875
generate_one_block  0.001230478286743164
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001194000244140625
gen group dst list time:  4.0531158447265625e-05
time for parepare:  0.0002872943878173828
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0002639293670654297
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0003719329833984375
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.00034689903259277344
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.00036907196044921875
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0004260540008544922
----------------------check_connections_block total spend ----------------------------- 0.003278970718383789
generate_one_block  0.0017778873443603516
generate_one_block  0.0016329288482666016
generate_one_block  0.0016624927520751953
generate_one_block  0.0017588138580322266
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012240409851074219
gen group dst list time:  9.5367431640625e-05
time for parepare:  0.0009055137634277344
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.0003681182861328125
mini_batch_src_global generation:  0.0002474784851074219
r_  generation:  0.002634763717651367
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  0.00028634071350097656
r_  generation:  0.0020716190338134766
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.00025582313537597656
mini_batch_src_global generation:  0.0002455711364746094
r_  generation:  0.002208232879638672
local_output_nid generation:  8.20159912109375e-05
local_in_edges_tensor generation:  0.0002701282501220703
mini_batch_src_global generation:  0.00029087066650390625
r_  generation:  0.0027713775634765625
----------------------check_connections_block total spend ----------------------------- 0.016034603118896484
generate_one_block  0.0039403438568115234
generate_one_block  0.0031766891479492188
generate_one_block  0.0031442642211914062
generate_one_block  0.0041620731353759766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023889541625976562
gen group dst list time:  0.00032258033752441406
time for parepare:  0.0016527175903320312
local_output_nid generation:  0.0002396106719970703
local_in_edges_tensor generation:  0.0008413791656494141
mini_batch_src_global generation:  0.0010538101196289062
r_  generation:  0.008722543716430664
local_output_nid generation:  0.0002532005310058594
local_in_edges_tensor generation:  0.0005977153778076172
mini_batch_src_global generation:  0.0011906623840332031
r_  generation:  0.00882411003112793
local_output_nid generation:  0.0002238750457763672
local_in_edges_tensor generation:  0.00047135353088378906
mini_batch_src_global generation:  0.0007288455963134766
r_  generation:  0.007649421691894531
local_output_nid generation:  0.0002913475036621094
local_in_edges_tensor generation:  0.0006105899810791016
mini_batch_src_global generation:  0.0011012554168701172
r_  generation:  0.01089024543762207
----------------------check_connections_block total spend ----------------------------- 0.05475187301635742
generate_one_block  0.01318216323852539
generate_one_block  0.012877702713012695
generate_one_block  0.011043548583984375
generate_one_block  0.014410018920898438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002152681350708008
gen group dst list time:  0.0008456707000732422
time for parepare:  0.0017676353454589844
local_output_nid generation:  0.0008356571197509766
local_in_edges_tensor generation:  0.002048015594482422
mini_batch_src_global generation:  0.0019006729125976562
r_  generation:  0.01836085319519043
local_output_nid generation:  0.0009181499481201172
local_in_edges_tensor generation:  0.0018041133880615234
mini_batch_src_global generation:  0.0023615360260009766
r_  generation:  0.020383834838867188
local_output_nid generation:  0.0009794235229492188
local_in_edges_tensor generation:  0.0013506412506103516
mini_batch_src_global generation:  0.0015606880187988281
r_  generation:  0.019084453582763672
local_output_nid generation:  0.0009398460388183594
local_in_edges_tensor generation:  0.0014994144439697266
mini_batch_src_global generation:  0.0020134449005126953
r_  generation:  0.020183801651000977
----------------------check_connections_block total spend ----------------------------- 0.11605572700500488
generate_one_block  0.023468017578125
generate_one_block  0.02662491798400879
generate_one_block  0.024343252182006836
generate_one_block  0.025841712951660156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000152587890625  GigaBytes
Max Memory Allocated: 0.000152587890625  GigaBytes

connection checking time:  0.19012117385864258
block generation total time  0.17304682731628418
average batch blocks generation time:  0.043261706829071045
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.03020620346069336  GigaBytes
Max Memory Allocated: 0.03020620346069336  GigaBytes

torch.Size([15702, 500])
torch.Size([10007, 32])
torch.Size([2993, 32])
torch.Size([673, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.03753376007080078  GigaBytes
Max Memory Allocated: 0.03755903244018555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.032317161560058594  GigaBytes
Max Memory Allocated: 0.06084871292114258  GigaBytes

torch.Size([16323, 500])
torch.Size([11080, 32])
torch.Size([3181, 32])
torch.Size([654, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.04011821746826172  GigaBytes
Max Memory Allocated: 0.06084871292114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.030891895294189453  GigaBytes
Max Memory Allocated: 0.061425209045410156  GigaBytes

torch.Size([16038, 500])
torch.Size([10514, 32])
torch.Size([2844, 32])
torch.Size([729, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.038433074951171875  GigaBytes
Max Memory Allocated: 0.061425209045410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.031219005584716797  GigaBytes
Max Memory Allocated: 0.061425209045410156  GigaBytes

torch.Size([16148, 500])
torch.Size([11072, 32])
torch.Size([3771, 32])
torch.Size([790, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.03943490982055664  GigaBytes
Max Memory Allocated: 0.061425209045410156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008687734603881836 |0.08828985691070557 |0.19678819179534912 |0.00019419193267822266 |0.004832804203033447 |0.0029921531677246094 |
----------------------------------------------------------pseudo_mini_loss sum 2.7895379066467285
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  122874
Number of first layer input nodes during this epoch:  64211
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.0333709716796875  GigaBytes
Max Memory Allocated: 0.061425209045410156  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006124973297119141
random selection method range initialization spend 0.00014781951904296875
time for parepare:  6.604194641113281e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  5.555152893066406e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  5.078315734863281e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.4345855712890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0012350082397460938
generate_one_block  0.0014307498931884766
generate_one_block  0.0013222694396972656
generate_one_block  0.0021398067474365234
generate_one_block  0.0017726421356201172
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00061798095703125
gen group dst list time:  4.172325134277344e-05
time for parepare:  0.0002944469451904297
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0003066062927246094
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0004258155822753906
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00024700164794921875
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00030541419982910156
----------------------check_connections_block total spend ----------------------------- 0.0028715133666992188
generate_one_block  0.0014882087707519531
generate_one_block  0.0015718936920166016
generate_one_block  0.0013303756713867188
generate_one_block  0.001401662826538086
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010597705841064453
gen group dst list time:  8.296966552734375e-05
time for parepare:  0.0008037090301513672
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00030732154846191406
mini_batch_src_global generation:  0.00022530555725097656
r_  generation:  0.0020203590393066406
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.00026535987854003906
mini_batch_src_global generation:  0.0003647804260253906
r_  generation:  0.003092527389526367
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  0.00022459030151367188
r_  generation:  0.0015714168548583984
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  0.00017642974853515625
r_  generation:  0.0017719268798828125
----------------------check_connections_block total spend ----------------------------- 0.013669013977050781
generate_one_block  0.0038766860961914062
generate_one_block  0.005006551742553711
generate_one_block  0.0028007030487060547
generate_one_block  0.003117799758911133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021021366119384766
gen group dst list time:  0.0002429485321044922
time for parepare:  0.0014357566833496094
local_output_nid generation:  0.0002009868621826172
local_in_edges_tensor generation:  0.0007357597351074219
mini_batch_src_global generation:  0.0007395744323730469
r_  generation:  0.007598400115966797
local_output_nid generation:  0.00034499168395996094
local_in_edges_tensor generation:  0.0007386207580566406
mini_batch_src_global generation:  0.0013489723205566406
r_  generation:  0.012083768844604492
local_output_nid generation:  0.0002460479736328125
local_in_edges_tensor generation:  0.0005276203155517578
mini_batch_src_global generation:  0.0009162425994873047
r_  generation:  0.0076618194580078125
local_output_nid generation:  0.00024008750915527344
local_in_edges_tensor generation:  0.0004837512969970703
mini_batch_src_global generation:  0.0006520748138427734
r_  generation:  0.006420612335205078
----------------------check_connections_block total spend ----------------------------- 0.05083799362182617
generate_one_block  0.01101827621459961
generate_one_block  0.016002178192138672
generate_one_block  0.012034416198730469
generate_one_block  0.01008462905883789
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001772165298461914
gen group dst list time:  0.0008027553558349609
time for parepare:  0.001512289047241211
local_output_nid generation:  0.0006988048553466797
local_in_edges_tensor generation:  0.0015773773193359375
mini_batch_src_global generation:  0.0014529228210449219
r_  generation:  0.016208410263061523
local_output_nid generation:  0.0010728836059570312
local_in_edges_tensor generation:  0.0017979145050048828
mini_batch_src_global generation:  0.002222776412963867
r_  generation:  0.021209716796875
local_output_nid generation:  0.0009968280792236328
local_in_edges_tensor generation:  0.0014309883117675781
mini_batch_src_global generation:  0.0016417503356933594
r_  generation:  0.01915884017944336
local_output_nid generation:  0.0008683204650878906
local_in_edges_tensor generation:  0.0013053417205810547
mini_batch_src_global generation: Using backend: pytorch
 0.001466512680053711
r_  generation:  0.01728081703186035
----------------------check_connections_block total spend ----------------------------- 0.10876750946044922
generate_one_block  0.02178049087524414
generate_one_block  0.027415752410888672
generate_one_block  0.02460336685180664
generate_one_block  0.022314786911010742
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.0333709716796875  GigaBytes
Max Memory Allocated: 0.061425209045410156  GigaBytes

connection checking time:  0.1761460304260254
block generation total time  0.1658477783203125
average batch blocks generation time:  0.041461944580078125
block dataloader generation time/epoch 0.38396358489990234
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.027932167053222656  GigaBytes
Max Memory Allocated: 0.061425209045410156  GigaBytes

torch.Size([14324, 500])
torch.Size([8134, 32])
torch.Size([2442, 32])
torch.Size([606, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.03341960906982422  GigaBytes
Max Memory Allocated: 0.061425209045410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.03291606903076172  GigaBytes
Max Memory Allocated: 0.061425209045410156  GigaBytes

torch.Size([16861, 500])
torch.Size([12681, 32])
torch.Size([4217, 32])
torch.Size([981, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.04235649108886719  GigaBytes
Max Memory Allocated: 0.061425209045410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.030616283416748047  GigaBytes
Max Memory Allocated: 0.061425209045410156  GigaBytes

torch.Size([15736, 500])
torch.Size([10078, 32])
torch.Size([2705, 32])
torch.Size([562, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.03777599334716797  GigaBytes
Max Memory Allocated: 0.061425209045410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.03061199188232422  GigaBytes
Max Memory Allocated: 0.061425209045410156  GigaBytes

torch.Size([15775, 500])
torch.Size([9043, 32])
torch.Size([2806, 32])
torch.Size([651, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.038245201110839844  GigaBytes
Max Memory Allocated: 0.061425209045410156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010238111019134521 |0.0014457106590270996 |0.0065825581550598145 |0.00014972686767578125 |0.00380629301071167 |0.002444744110107422 |
----------------------------------------------------------pseudo_mini_loss sum 1.986384630203247
Total (block generation + training)time/epoch 0.48253393173217773
Training time/epoch 0.09799718856811523
Training time without block to device /epoch 0.09221434593200684
Training time without total dataloading part /epoch 0.044599056243896484
load block tensor time/epoch 0.040952444076538086
block to device time/epoch 0.0057828426361083984
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  117957
Number of first layer input nodes during this epoch:  62696
