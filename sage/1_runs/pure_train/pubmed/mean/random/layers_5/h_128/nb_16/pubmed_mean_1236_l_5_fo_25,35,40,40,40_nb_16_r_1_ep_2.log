main start at this time 1648531852.7106714
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012099742889404297
random selection method range initialization spend 0.00018334388732910156
time for parepare:  4.601478576660156e-05
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.0011970996856689453
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.4781951904296875e-05
----------------------check_connections_block total spend ----------------------------- 0.003002643585205078
generate_one_block  0.0020689964294433594
generate_one_block  0.0011119842529296875
generate_one_block  0.0010690689086914062
generate_one_block  0.0010535717010498047
generate_one_block  0.0010771751403808594
generate_one_block  0.0010750293731689453
generate_one_block  0.0010764598846435547
generate_one_block  0.0011150836944580078
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007836818695068359
gen group dst list time:  5.936622619628906e-05
time for parepare:  0.0002503395080566406
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00011444091796875
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00019431114196777344
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001850128173828125
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00010585784912109375
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.000232696533203125
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00014781951904296875
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00037789344787597656
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  5.984306335449219e-05
----------------------check_connections_block total spend ----------------------------- 0.003580808639526367
generate_one_block  0.0012230873107910156
generate_one_block  0.0013196468353271484
generate_one_block  0.0012753009796142578
generate_one_block  0.0011754035949707031
generate_one_block  0.0013549327850341797
generate_one_block  0.0012154579162597656
generate_one_block  0.001607656478881836
generate_one_block  0.0010859966278076172
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001146554946899414
gen group dst list time:  9.322166442871094e-05
time for parepare:  0.0007715225219726562
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00024437904357910156
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0008327960968017578
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.0012135505676269531
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  0.00014710426330566406
r_  generation:  0.0012590885162353516
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0005249977111816406
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.00011563301086425781
r_  generation:  0.0012867450714111328
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0006334781646728516
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.0002276897430419922
r_  generation:  0.0026602745056152344
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.0002868175506591797
----------------------check_connections_block total spend ----------------------------- 0.014687538146972656
generate_one_block  0.002180814743041992
generate_one_block  0.0024318695068359375
generate_one_block  0.002470254898071289
generate_one_block  0.0015189647674560547
generate_one_block  0.0024220943450927734
generate_one_block  0.0016810894012451172
generate_one_block  0.004046440124511719
generate_one_block  0.001220703125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018160343170166016
gen group dst list time:  0.0002579689025878906
time for parepare:  0.0015232563018798828
local_output_nid generation:  0.00014257431030273438
local_in_edges_tensor generation:  0.0006339550018310547
mini_batch_src_global generation:  0.0006999969482421875
r_  generation:  0.0056917667388916016
local_output_nid generation:  0.00017642974853515625
local_in_edges_tensor generation:  0.0004324913024902344
mini_batch_src_global generation:  0.0009524822235107422
r_  generation:  0.0071811676025390625
local_output_nid generation:  0.00018596649169921875
local_in_edges_tensor generation:  0.00042700767517089844
mini_batch_src_global generation:  0.0006747245788574219
r_  generation:  0.006145477294921875
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.00023794174194335938
mini_batch_src_global generation:  0.00035643577575683594
r_  generation:  0.0030090808868408203
local_output_nid generation:  0.00018167495727539062
local_in_edges_tensor generation:  0.00037860870361328125
mini_batch_src_global generation:  0.00044083595275878906
r_  generation:  0.005244016647338867
local_output_nid generation:  8.463859558105469e-05
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  0.0003371238708496094
r_  generation:  0.0028226375579833984
local_output_nid generation:  0.00021600723266601562
local_in_edges_tensor generation:  0.00045490264892578125
mini_batch_src_global generation:  0.0006647109985351562
r_  generation:  0.007914066314697266
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  0.0003170967102050781
r_  generation:  0.0015077590942382812
----------------------check_connections_block total spend ----------------------------- 0.060159921646118164
generate_one_block  0.008510351181030273
generate_one_block  0.010309934616088867
generate_one_block  0.009546279907226562
generate_one_block  0.004818916320800781
generate_one_block  0.008065938949584961
generate_one_block  0.004649639129638672
generate_one_block  0.01149606704711914
generate_one_block  0.0028259754180908203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002071857452392578
gen group dst list time:  0.0013031959533691406
time for parepare:  0.0017993450164794922
local_output_nid generation:  0.000606536865234375
local_in_edges_tensor generation:  0.0015742778778076172
mini_batch_src_global generation:  0.0016262531280517578
r_  generation:  0.014777660369873047
local_output_nid generation:  0.0010223388671875
local_in_edges_tensor generation:  0.002007722854614258
mini_batch_src_global generation:  0.002264738082885742
r_  generation:  0.01886725425720215
local_output_nid generation:  0.0008134841918945312
local_in_edges_tensor generation:  0.0013098716735839844
mini_batch_src_global generation:  0.0015218257904052734
r_  generation:  0.017904996871948242
local_output_nid generation:  0.0005145072937011719
local_in_edges_tensor generation:  0.0007703304290771484
mini_batch_src_global generation:  0.0011043548583984375
r_  generation:  0.01198887825012207
local_output_nid generation:  0.00078582763671875
local_in_edges_tensor generation:  0.0011174678802490234
mini_batch_src_global generation:  0.0011131763458251953
r_  generation:  0.015568017959594727
local_output_nid generation:  0.0005049705505371094
local_in_edges_tensor generation:  0.0007369518280029297
mini_batch_src_global generation:  0.0010340213775634766
r_  generation:  0.011098861694335938
local_output_nid generation:  0.0008373260498046875
local_in_edges_tensor generation:  0.0012485980987548828
mini_batch_src_global generation:  0.0012581348419189453
r_  generation:  0.018128156661987305
local_output_nid generation:  0.0002446174621582031
local_in_edges_tensor generation:  0.0004425048828125
mini_batch_src_global generation:  0.0008144378662109375
r_  generation:  0.006364107131958008
----------------------check_connections_block total spend ----------------------------- 0.1690046787261963
generate_one_block  0.01910710334777832
generate_one_block  0.025907039642333984
generate_one_block  0.024518251419067383
generate_one_block  0.016295909881591797
generate_one_block  0.020409822463989258
generate_one_block  0.015064239501953125
generate_one_block  0.02372145652770996
generate_one_block  0.010329723358154297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  0.24743294715881348
block generation total time  0.2438063621520996
average batch blocks generation time:  0.03047579526901245
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.02559041976928711  GigaBytes
Max Memory Allocated: 0.02559041976928711  GigaBytes

torch.Size([12993, 500])
torch.Size([6596, 128])
torch.Size([1616, 128])
torch.Size([246, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.041001319885253906  GigaBytes
Max Memory Allocated: 0.04163169860839844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.030602455139160156  GigaBytes
Max Memory Allocated: 0.054135799407958984  GigaBytes

torch.Size([15154, 500])
torch.Size([10229, 128])
torch.Size([2024, 128])
torch.Size([466, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.05234670639038086  GigaBytes
Max Memory Allocated: 0.054135799407958984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.030171871185302734  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

torch.Size([14948, 500])
torch.Size([7964, 128])
torch.Size([2267, 128])
torch.Size([354, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.04870462417602539  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.023426055908203125  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

torch.Size([11457, 500])
torch.Size([4922, 128])
torch.Size([949, 128])
torch.Size([178, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.03383922576904297  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.029033660888671875  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

torch.Size([14382, 500])
torch.Size([7832, 128])
torch.Size([2196, 128])
torch.Size([498, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.04783344268798828  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.022445201873779297  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

torch.Size([10942, 500])
torch.Size([5185, 128])
torch.Size([1011, 128])
torch.Size([270, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.03360939025878906  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.030539512634277344  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

torch.Size([15088, 500])
torch.Size([9135, 128])
torch.Size([2835, 128])
torch.Size([721, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.052976131439208984  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.015883445739746094  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

torch.Size([7492, 500])
torch.Size([2448, 128])
torch.Size([420, 128])
torch.Size([108, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.021017074584960938  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012801676988601685 |0.04384744167327881 |0.10155975818634033 |0.00016137957572937012 |0.0062074363231658936 |0.003409147262573242 |
----------------------------------------------------------pseudo_mini_loss sum 2.7415361404418945
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  173283
Number of first layer input nodes during this epoch:  102456
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.018078327178955078  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005662441253662109
random selection method range initialization spend 0.00012445449829101562
time for parepare:  5.9604644775390625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  4.482269287109375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.6927719116210938e-05
----------------------check_connections_block total spend ----------------------------- 0.0019025802612304688
generate_one_block  0.0013270378112792969
generate_one_block  0.0012662410736083984
generate_one_block  0.0012557506561279297
generate_one_block  0.001251220703125
generate_one_block  0.0012390613555908203
generate_one_block  0.0012421607971191406
generate_one_block  0.0012481212615966797
generate_one_block  0.0013425350189208984
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006303787231445312
gen group dst list time:  6.699562072753906e-05
time for parepare:  0.00034332275390625
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0002231597900390625
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0002980232238769531
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.00027823448181152344
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00011658668518066406
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00026535987854003906
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0002410411834716797
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001068115234375
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0002422332763671875
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  9.226799011230469e-05
----------------------check_connections_block total spend ----------------------------- 0.004220485687255859
generate_one_block  0.0016551017761230469
generate_one_block  0.0015807151794433594
generate_one_block  0.0013463497161865234
generate_one_block  0.0015871524810791016
generate_one_block  0.0015447139739990234
generate_one_block  0.0013468265533447266
generate_one_block  0.0013134479522705078
generate_one_block  0.0010869503021240234
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011119842529296875
gen group dst list time:  0.0001323223114013672
time for parepare:  0.0009558200836181641
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.0003304481506347656
mini_batch_src_global generation:  0.00020933151245117188
r_  generation:  0.0017664432525634766
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  0.0002796649932861328
r_  generation:  0.0021066665649414062
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  0.00011372566223144531
r_  generation:  0.0004928112030029297
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.0002357959747314453
mini_batch_src_global generation:  0.0001780986785888672
r_  generation:  0.0017392635345458984
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  0.00018286705017089844
r_  generation:  0.001621246337890625
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0005817413330078125
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.0010976791381835938
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.0005359649658203125
----------------------check_connections_block total spend ----------------------------- 0.017043352127075195
generate_one_block  0.0028429031372070312
generate_one_block  0.0030088424682617188
generate_one_block  0.001378774642944336
generate_one_block  0.0029528141021728516
generate_one_block  0.0027713775634765625
generate_one_block  0.0016002655029296875
generate_one_block  0.002202272415161133
generate_one_block  0.0016300678253173828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016810894012451172
gen group dst list time:  0.00028586387634277344
time for parepare:  0.0014350414276123047
local_output_nid generation:  0.0002014636993408203
local_in_edges_tensor generation:  0.0006530284881591797
mini_batch_src_global generation:  0.0006661415100097656
r_  generation:  0.0066013336181640625
local_output_nid generation:  0.00020194053649902344
local_in_edges_tensor generation:  0.00045561790466308594
mini_batch_src_global generation:  0.0009403228759765625
r_  generation:  0.00702667236328125
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  0.0003001689910888672
r_  generation:  0.0019903182983398438
local_output_nid generation:  0.00023674964904785156
local_in_edges_tensor generation:  0.0005168914794921875
mini_batch_src_global generation:  0.0006132125854492188
r_  generation:  0.006905555725097656
local_output_nid generation:  0.00012111663818359375
local_in_edges_tensor generation:  0.0003542900085449219
mini_batch_src_global generation:  0.0006709098815917969
r_  generation:  0.005129814147949219
local_output_nid generation:  9.989738464355469e-05
local_in_edges_tensor generation:  0.0002772808074951172
mini_batch_src_global generation:  0.00040340423583984375
r_  generation:  0.0036475658416748047
local_output_nid generation:  0.00014162063598632812
local_in_edges_tensor generation:  0.00033211708068847656
mini_batch_src_global generation:  0.0004076957702636719
r_  generation:  0.004441738128662109
local_output_nid generation:  9.942054748535156e-05
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  0.0004050731658935547
r_  generation:  0.0037386417388916016
----------------------check_connections_block total spend ----------------------------- 0.06018853187561035
generate_one_block  0.009065866470336914
generate_one_block  0.009902477264404297
generate_one_block  0.0037565231323242188
generate_one_block  0.010427713394165039
generate_one_block  0.007740497589111328
generate_one_block  0.0057697296142578125
generate_one_block  0.006642818450927734
generate_one_block  0.0059032440185546875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020253658294677734
gen group dst list time:  0.0011229515075683594
time for parepare:  0.001847982406616211
local_output_nid generation:  0.0008165836334228516
local_in_edges_tensor generation:  0.0017485618591308594
mini_batch_src_global generation:  0.0015838146209716797
r_  generation:  0.017023801803588867
local_output_nid generation:  0.0006191730499267578
local_in_edges_tensor generation:  0.001129150390625
mini_batch_src_global generation:  0.001608133316040039
r_  generation:  0.014716148376464844
local_output_nid generation:  0.0003712177276611328
local_in_edges_tensor generation:  0.0006835460662841797
mini_batch_src_global generation:  0.0008003711700439453
r_  generation:  0.0077512264251708984
local_output_nid generation:  0.0009388923645019531
local_in_edges_tensor generation:  0.0013554096221923828
mini_batch_src_global generation:  0.0014498233795166016
r_  generation:  0.018339157104492188
local_output_nid generation:  0.0004813671112060547
local_in_edges_tensor generation:  0.0007503032684326172
mini_batch_src_global generation:  0.0011475086212158203
r_  generation:  0.012321710586547852
local_output_nid generation:  0.0005371570587158203
local_in_edges_tensor generation:  0.002148866653442383
mini_batch_src_global generation:  0.0010693073272705078
r_  generation:  0.012528419494628906
local_output_nid generation:  0.0005977153778076172
local_in_edges_tensor generation:  0.000982522964477539
mini_batch_src_global generation:  0.0010402202606201172
r_  generation:  0.013044357299804688
local_output_nid generation:  0.0005388259887695312
local_in_edges_tensor generation:  0.0008826255798339844
mini_batch_src_global generation:  0.0010313987731933594
r_  generation:  0.012085676193237305
----------------------check_connections_block total spend ----------------------------- 0.1598210334777832
generate_one_block  0.021167516708374023
generate_one_block  0.019529104232788086
generate_one_block  0.01223444938659668
generate_one_block  0.0223391056060791
generate_one_block  0.0173647403717041
generate_one_block  0.01676774024963379
generate_one_block  0.016530990600585938
generate_one_block  0.016435861587524414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.018078327178955078  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

connection checking time:  0.2412734031677246
block generation total time  0.23142695426940918
average batch blocks generation time:  0.028928369283676147
block dataloader generation time/epoch 0.5201559066772461
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.03141069412231445  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

torch.Size([14719, 500])
torch.Size([8969, 128])
torch.Size([2282, 128])
torch.Size([605, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.052776336669921875  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.026936054229736328  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

torch.Size([12320, 500])
torch.Size([6562, 128])
torch.Size([2194, 128])
torch.Size([466, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.04336738586425781  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.020390033721923828  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

torch.Size([8972, 500])
torch.Size([3488, 128])
torch.Size([714, 128])
torch.Size([137, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.02793264389038086  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.033364295959472656  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

torch.Size([15608, 500])
torch.Size([10127, 128])
torch.Size([2747, 128])
torch.Size([573, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.05757331848144531  GigaBytes
Max Memory Allocated: 0.05777740478515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.024086952209472656  GigaBytes
Max Memory Allocated: 0.059758663177490234  GigaBytes

torch.Size([10838, 500])
torch.Size([5303, 128])
torch.Size([1551, 128])
torch.Size([369, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.03682661056518555  GigaBytes
Max Memory Allocated: 0.059758663177490234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.025262832641601562  GigaBytes
Max Memory Allocated: 0.059758663177490234  GigaBytes

torch.Size([11508, 500])
torch.Size([5176, 128])
torch.Size([1151, 128])
torch.Size([181, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.036515235900878906  GigaBytes
Max Memory Allocated: 0.059758663177490234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.0279388427734375  GigaBytes
Max Memory Allocated: 0.059758663177490234  GigaBytes

torch.Size([12935, 500])
torch.Size([6675, 128])
torch.Size([1804, 128])Using backend: pytorch

torch.Size([402, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.044013023376464844  GigaBytes
Max Memory Allocated: 0.059758663177490234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.024040699005126953  GigaBytes
Max Memory Allocated: 0.059758663177490234  GigaBytes

torch.Size([10857, 500])
torch.Size([5433, 128])
torch.Size([1045, 128])
torch.Size([172, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3690185546875 GB
    Memory Allocated: 0.03542280197143555  GigaBytes
Max Memory Allocated: 0.059758663177490234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007408589124679565 |0.0012978017330169678 |0.006942242383956909 |0.00014457106590270996 |0.005726724863052368 |0.002517223358154297 |
----------------------------------------------------------pseudo_mini_loss sum 1.7860535383224487
Total (block generation + training)time/epoch 0.7087736129760742
Training time/epoch 0.18821477890014648
Training time without block to device /epoch 0.17783236503601074
Training time without total dataloading part /epoch 0.1050255298614502
load block tensor time/epoch 0.05926871299743652
block to device time/epoch 0.010382413864135742
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  166240
Number of first layer input nodes during this epoch:  97757
