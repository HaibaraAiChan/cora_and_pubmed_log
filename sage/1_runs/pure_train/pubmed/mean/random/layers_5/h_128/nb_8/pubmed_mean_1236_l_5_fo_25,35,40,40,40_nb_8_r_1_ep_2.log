main start at this time 1648531841.8637555
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0019009113311767578
random selection method range initialization spend 0.0001857280731201172
time for parepare:  4.482269287109375e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.0011463165283203125
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.553794860839844e-05
----------------------check_connections_block total spend ----------------------------- 0.0021567344665527344
generate_one_block  0.001264333724975586
generate_one_block  0.0010302066802978516
generate_one_block  0.0010633468627929688
generate_one_block  0.0010745525360107422
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001096963882446289
gen group dst list time:  3.218650817871094e-05
time for parepare:  0.00023245811462402344
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.000225067138671875
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.00029587745666503906
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002777576446533203
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0004906654357910156
----------------------check_connections_block total spend ----------------------------- 0.0027310848236083984
generate_one_block  0.00136566162109375
generate_one_block  0.001386404037475586
generate_one_block  0.00136566162109375
generate_one_block  0.0016803741455078125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010247230529785156
gen group dst list time:  7.653236389160156e-05
time for parepare:  0.0007419586181640625
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0002887248992919922
mini_batch_src_global generation:  0.0001442432403564453
r_  generation:  0.001697540283203125
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00024962425231933594
r_  generation:  0.0018506050109863281
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.00015234947204589844
r_  generation:  0.0014977455139160156
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.0002484321594238281
mini_batch_src_global generation:  0.0002720355987548828
r_  generation:  0.003131866455078125
----------------------check_connections_block total spend ----------------------------- 0.013129472732543945
generate_one_block  0.0038177967071533203
generate_one_block  0.0032727718353271484
generate_one_block  0.002835512161254883
generate_one_block  0.004751443862915039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019898414611816406
gen group dst list time:  0.00021338462829589844
time for parepare:  0.0015759468078613281
local_output_nid generation:  0.0002410411834716797
local_in_edges_tensor generation:  0.0008797645568847656
mini_batch_src_global generation:  0.0010051727294921875
r_  generation:  0.00909733772277832
local_output_nid generation:  0.0002372264862060547
local_in_edges_tensor generation:  0.0005609989166259766
mini_batch_src_global generation:  0.00119781494140625
r_  generation:  0.008798599243164062
local_output_nid generation:  0.00024199485778808594
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.0006928443908691406
r_  generation:  0.006337642669677734
local_output_nid generation:  0.00026917457580566406
local_in_edges_tensor generation:  0.0005517005920410156
mini_batch_src_global generation:  0.0010027885437011719
r_  generation:  0.00993967056274414
----------------------check_connections_block total spend ----------------------------- 0.05173611640930176
generate_one_block  0.013924360275268555
generate_one_block  0.013439416885375977
generate_one_block  0.009615421295166016
generate_one_block  0.01369619369506836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020186901092529297
gen group dst list time:  0.0007643699645996094
time for parepare:  0.001836538314819336
local_output_nid generation:  0.0009222030639648438
local_in_edges_tensor generation:  0.002095937728881836
mini_batch_src_global generation:  0.0018868446350097656
r_  generation:  0.019527196884155273
local_output_nid generation:  0.0008256435394287109
local_in_edges_tensor generation:  0.001781463623046875
mini_batch_src_global generation:  0.002229928970336914
r_  generation:  0.019832372665405273
local_output_nid generation:  0.0009591579437255859
local_in_edges_tensor generation:  0.0013585090637207031
mini_batch_src_global generation:  0.0015447139739990234
r_  generation:  0.017789363861083984
local_output_nid generation:  0.0009403228759765625
local_in_edges_tensor generation:  0.0014491081237792969
mini_batch_src_global generation:  0.001737833023071289
r_  generation:  0.019621849060058594
----------------------check_connections_block total spend ----------------------------- 0.11468243598937988
generate_one_block  0.02478313446044922
generate_one_block  0.02565765380859375
generate_one_block  0.022836685180664062
generate_one_block  0.025142192840576172
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  0.18227910995483398
block generation total time  0.1695706844329834
average batch blocks generation time:  0.04239267110824585
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.031536102294921875  GigaBytes
Max Memory Allocated: 0.031536102294921875  GigaBytes

torch.Size([16058, 500])
torch.Size([11159, 128])
torch.Size([2917, 128])
torch.Size([589, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.05695295333862305  GigaBytes
Max Memory Allocated: 0.05710172653198242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03372001647949219  GigaBytes
Max Memory Allocated: 0.06286811828613281  GigaBytes

torch.Size([16338, 500])
torch.Size([10558, 128])
torch.Size([3204, 128])
torch.Size([609, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.05939817428588867  GigaBytes
Max Memory Allocated: 0.06286811828613281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.031466007232666016  GigaBytes
Max Memory Allocated: 0.06286811828613281  GigaBytes

torch.Size([15635, 500])
torch.Size([9451, 128])
torch.Size([2551, 128])
torch.Size([602, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.054677486419677734  GigaBytes
Max Memory Allocated: 0.06286811828613281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.032776832580566406  GigaBytes
Max Memory Allocated: 0.06286811828613281  GigaBytes

torch.Size([16237, 500])
torch.Size([10835, 128])
torch.Size([3643, 128])
torch.Size([1018, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.060216426849365234  GigaBytes
Max Memory Allocated: 0.06286811828613281  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011593222618103027 |0.08794361352920532 |0.1930944323539734 |0.0001601576805114746 |0.005733191967010498 |0.003094911575317383 |
----------------------------------------------------------pseudo_mini_loss sum 2.3851664066314697
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  121761
Number of first layer input nodes during this epoch:  64268
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.036305904388427734  GigaBytes
Max Memory Allocated: 0.06286811828613281  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004799365997314453
random selection method range initialization spend 0.00010442733764648438
time for parepare:  4.553794860839844e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.266334533691406e-05
----------------------check_connections_block total spend ----------------------------- 0.0009737014770507812
generate_one_block  0.0011553764343261719
generate_one_block  0.0010752677917480469
generate_one_block  0.0013432502746582031
generate_one_block  0.0010142326354980469
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005130767822265625
gen group dst list time:  3.2901763916015625e-05
time for parepare:  0.0002593994140625
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.00043463706970214844
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0002334117889404297
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0003445148468017578
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00026154518127441406
----------------------check_connections_block total spend ----------------------------- 0.002791166305541992
generate_one_block  0.0016179084777832031
generate_one_block  0.0012843608856201172
generate_one_block  0.0014281272888183594
generate_one_block  0.0013537406921386719
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010180473327636719
gen group dst list time:  8.249282836914062e-05
time for parepare:  0.0007681846618652344
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.00034928321838378906
mini_batch_src_global generation:  0.00030732154846191406
r_  generation:  0.002979755401611328
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  0.00020265579223632812
r_  generation:  0.0013413429260253906
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.0002238750457763672
mini_batch_src_global generation:  0.00023603439331054688
r_  generation:  0.0026493072509765625
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.001728057861328125
----------------------check_connections_block total spend ----------------------------- 0.013926506042480469
generate_one_block  0.005033969879150391
generate_one_block  0.0027251243591308594
generate_one_block  0.004175424575805664
generate_one_block  0.0029916763305664062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020346641540527344
gen group dst list time:  0.0002346038818359375
time for parepare:  0.001367807388305664
local_output_nid generation:  0.00032138824462890625
local_in_edges_tensor generation:  0.0009932518005371094
mini_batch_src_global generation:  0.0009140968322753906
r_  generation:  0.011147737503051758
local_output_nid generation:  0.0002117156982421875
local_in_edges_tensor generation:  0.0004761219024658203
mini_batch_src_global generation:  0.0009391307830810547
r_  generation:  0.006544828414916992
local_output_nid generation:  0.00027823448181152344
local_in_edges_tensor generation:  0.0005669593811035156
mini_batch_src_global generation:  0.0009021759033203125
r_  generation:  0.010592222213745117
local_output_nid generation:  0.00024771690368652344
local_in_edges_tensor generation:  0.0005359649658203125
mini_batch_src_global generation:  0.00091552734375
r_  generation:  0.007747173309326172
----------------------check_connections_block total spend ----------------------------- 0.053786277770996094
generate_one_block  0.014842033386230469
generate_one_block  0.009988784790039062
generate_one_block  0.014883995056152344
generate_one_block  0.012368202209472656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017044544219970703
gen group dst list time:  0.0008022785186767578
time for parepare:  0.0016100406646728516
local_output_nid generation:  0.0009887218475341797
local_in_edges_tensor generation:  0.001954793930053711
mini_batch_src_global generation:  0.001772165298461914
r_  generation:  0.020319461822509766
local_output_nid generation:  0.0008196830749511719
local_in_edges_tensor generation:  0.0014195442199707031
mini_batch_src_global generation:  0.0019245147705078125
r_  generation:  0.017209291458129883
local_output_nid generation:  0.0011286735534667969
local_in_edges_tensor generation:  0.0016188621520996094
mini_batch_src_global generation:  0.0015592575073242188
r_  generation:  0.020735740661621094
local_output_nid generation:  0.0011105537414550781
local_in_edges_tensor generation:  0.0015492439270019531
mini_batch_src_global generation: Using backend: pytorch
 0.0017595291137695312
r_  generation:  0.019797563552856445
----------------------check_connections_block total spend ----------------------------- 0.11565327644348145
generate_one_block  0.026609420776367188
generate_one_block  0.023401498794555664
generate_one_block  0.02570509910583496
generate_one_block  0.0252993106842041
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.036305904388427734  GigaBytes
Max Memory Allocated: 0.06286811828613281  GigaBytes

connection checking time:  0.1861572265625
block generation total time  0.17370867729187012
average batch blocks generation time:  0.04342716932296753
block dataloader generation time/epoch 0.39383387565612793
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.03551292419433594  GigaBytes
Max Memory Allocated: 0.06489992141723633  GigaBytes

torch.Size([16434, 500])
torch.Size([11615, 128])
torch.Size([3950, 128])
torch.Size([1002, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.06474971771240234  GigaBytes
Max Memory Allocated: 0.06499958038330078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.032587528228759766  GigaBytes
Max Memory Allocated: 0.06637048721313477  GigaBytes

torch.Size([15334, 500])
torch.Size([8640, 128])
torch.Size([2500, 128])
torch.Size([461, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.053351402282714844  GigaBytes
Max Memory Allocated: 0.06637048721313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.03448057174682617  GigaBytes
Max Memory Allocated: 0.06637048721313477  GigaBytes

torch.Size([16230, 500])
torch.Size([11756, 128])
torch.Size([3365, 128])
torch.Size([793, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.06225395202636719  GigaBytes
Max Memory Allocated: 0.06637048721313477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.03539085388183594  GigaBytes
Max Memory Allocated: 0.06637048721313477  GigaBytes

torch.Size([16465, 500])
torch.Size([10699, 128])
torch.Size([2921, 128])
torch.Size([622, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.06124401092529297  GigaBytes
Max Memory Allocated: 0.06637048721313477  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008285045623779297 |0.0013003349304199219 |0.006158053874969482 |0.0001412034034729004 |0.003760397434234619 |0.0021791458129882812 |
----------------------------------------------------------pseudo_mini_loss sum 1.6745338439941406
Total (block generation + training)time/epoch 0.4813814163208008
Training time/epoch 0.08705520629882812
Training time without block to device /epoch 0.08185386657714844
Training time without total dataloading part /epoch 0.04241776466369629
load block tensor time/epoch 0.03314018249511719
block to device time/epoch 0.0052013397216796875
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  123143
Number of first layer input nodes during this epoch:  64463
