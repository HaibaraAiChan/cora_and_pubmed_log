main start at this time 1648530488.817024
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014257431030273438  GigaBytes
Max Memory Allocated: 0.00014257431030273438  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0025305747985839844
random selection method range initialization spend 0.0001914501190185547
time for parepare:  4.363059997558594e-05
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0013453960418701172
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.6716461181640625e-05
----------------------check_connections_block total spend ----------------------------- 0.0023741722106933594
generate_one_block  0.0014624595642089844
generate_one_block  0.0011565685272216797
generate_one_block  0.001054525375366211
generate_one_block  0.0010514259338378906
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014004707336425781
gen group dst list time:  3.910064697265625e-05
time for parepare:  0.0002434253692626953
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0004413127899169922
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00023126602172851562
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0003809928894042969
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002467632293701172
----------------------check_connections_block total spend ----------------------------- 0.002785921096801758
generate_one_block  0.001608133316040039
generate_one_block  0.0013186931610107422
generate_one_block  0.0014984607696533203
generate_one_block  0.0013930797576904297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010221004486083984
gen group dst list time:  7.2479248046875e-05
time for parepare:  0.0007572174072265625
local_output_nid generation:  6.604194641113281e-05
local_in_edges_tensor generation:  0.0003414154052734375
mini_batch_src_global generation:  0.0002300739288330078
r_  generation:  0.0026607513427734375
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  0.00020956993103027344
r_  generation:  0.0014324188232421875
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00022840499877929688
mini_batch_src_global generation:  0.000270843505859375
r_  generation:  0.002653837203979492
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.0001785755157470703
r_  generation:  0.0015211105346679688
----------------------check_connections_block total spend ----------------------------- 0.013341426849365234
generate_one_block  0.004822731018066406
generate_one_block  0.0026531219482421875
generate_one_block  0.004361629486083984
generate_one_block  0.0028090476989746094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019526481628417969
gen group dst list time:  0.00022792816162109375
time for parepare:  0.0014867782592773438
local_output_nid generation:  0.0002677440643310547
local_in_edges_tensor generation:  0.0009443759918212891
mini_batch_src_global generation:  0.0010242462158203125
r_  generation:  0.009600162506103516
local_output_nid generation:  0.0001983642578125
local_in_edges_tensor generation:  0.0004725456237792969
mini_batch_src_global generation:  0.000972747802734375
r_  generation:  0.006893157958984375
local_output_nid generation:  0.0002930164337158203
local_in_edges_tensor generation:  0.0006046295166015625
mini_batch_src_global generation:  0.0008435249328613281
r_  generation:  0.009528636932373047
local_output_nid generation:  0.00022554397583007812
local_in_edges_tensor generation:  0.0004646778106689453
mini_batch_src_global generation:  0.0007357597351074219
r_  generation:  0.007164478302001953
----------------------check_connections_block total spend ----------------------------- 0.05005311965942383
generate_one_block  0.013809442520141602
generate_one_block  0.011141538619995117
generate_one_block  0.014323711395263672
generate_one_block  0.010933399200439453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014257431030273438  GigaBytes
Max Memory Allocated: 0.00014257431030273438  GigaBytes

connection checking time:  0.06618046760559082
block generation total time  0.07067298889160156
average batch blocks generation time:  0.01766824722290039
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02045583724975586  GigaBytes
Max Memory Allocated: 0.02045583724975586  GigaBytes

torch.Size([10725, 500])
torch.Size([3779, 32])
torch.Size([910, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.022821426391601562  GigaBytes
Max Memory Allocated: 0.023598194122314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020046710968017578  GigaBytes
Max Memory Allocated: 0.03979158401489258  GigaBytes

torch.Size([10203, 500])
torch.Size([2352, 32])
torch.Size([567, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021537303924560547  GigaBytes
Max Memory Allocated: 0.03979158401489258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019916534423828125  GigaBytes
Max Memory Allocated: 0.03979158401489258  GigaBytes

torch.Size([10364, 500])
torch.Size([3614, 32])
torch.Size([843, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022156715393066406  GigaBytes
Max Memory Allocated: 0.03979158401489258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01752185821533203  GigaBytes
Max Memory Allocated: 0.03979158401489258  GigaBytes

torch.Size([9130, 500])
torch.Size([2823, 32])
torch.Size([544, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019205093383789062  GigaBytes
Max Memory Allocated: 0.03979158401489258  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012075483798980713 |0.08540374040603638 |0.1965329647064209 |0.0001639723777770996 |0.005167961120605469 |0.0026149749755859375 |
----------------------------------------------------------pseudo_mini_loss sum 2.2301034927368164
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  56210
Number of first layer input nodes during this epoch:  40422
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0183258056640625  GigaBytes
Max Memory Allocated: 0.03979158401489258  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005869865417480469
random selection method range initialization spend 0.0001506805419921875
time for parepare:  6.103515625e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.651878356933594e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.4809112548828125e-05
----------------------check_connections_block total spend ----------------------------- 0.0011823177337646484
generate_one_block  0.0015645027160644531
generate_one_block  0.0012516975402832031
generate_one_block  0.001224517822265625
generate_one_block  0.001219034194946289
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006196498870849609
gen group dst list time:  4.1484832763671875e-05
time for parepare:  0.0003197193145751953
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0002257823944091797
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0003993511199951172
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.00040650367736816406
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0005025863647460938
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00023889541625976562
----------------------check_connections_block total spend ----------------------------- 0.003333568572998047
generate_one_block  0.0017066001892089844
generate_one_block  0.0017154216766357422
generate_one_block  0.001814126968383789
generate_one_block  0.0014772415161132812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002032041549682617
gen group dst list time:  0.0001628398895263672
time for parepare:  0.0016393661499023438
local_output_nid generation:  0.0001227855682373047
local_in_edges_tensor generation:  0.0011775493621826172
mini_batch_src_global generation:  0.00035762786865234375
r_  generation:  0.003806591033935547
local_output_nid generation:  0.00013899803161621094
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0005829334259033203
r_  generation:  0.004441738128662109
local_output_nid generation:  9.989738464355469e-05
local_in_edges_tensor generation:  0.000331878662109375
mini_batch_src_global generation:  0.00043964385986328125
r_  generation:  0.004187583923339844
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.0002512931823730469
mini_batch_src_global generation:  0.0002582073211669922
r_  generation:  0.001413583755493164
----------------------check_connections_block total spend ----------------------------- 0.023479223251342773
generate_one_block  0.0033965110778808594
generate_one_block  0.004237174987792969
generate_one_block  0.004387617111206055
generate_one_block  0.002446889877319336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001953601837158203
gen group dst list time:  0.00022459030151367188
time for parepare:  0.0013582706451416016
local_output_nid generation:  0.00020813941955566406
local_in_edges_tensor generation:  0.0007464885711669922
mini_batch_src_global generation:  0.0007421970367431641
r_  generation:  0.0063970088958740234
local_output_nid generation:  0.0002613067626953125
local_in_edges_tensor generation:  0.0005810260772705078
mini_batch_src_global generation:  0.0011544227600097656
r_  generation:  0.00894021987915039
local_output_nid generation:  0.00025153160095214844
local_in_edges_tensor generation:  0.0005443096160888672
mini_batch_src_global generation:  0.0010340213775634766
r_  generation:  0.01037454605102539
local_output_nid generation:  0.00021529197692871094
local_in_edges_tensor generation:  0.0004565715789794922
mini_batch_src_global generation:  0.0007278919219970703
r_  generation:  0.006822347640991211
----------------------check_connections_block total spend ----------------------------- 0.05022573471069336
generate_one_block  0.01866912841796875
generate_one_block  0.014274835586547852
generate_one_block  0.01446533203125
generate_one_block  0.012433767318725586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0183258056640625  GigaBytes
Max Memory Allocated: 0.03979158401489258  GigaBytes

connection checking time:  0.07703852653503418
block generation total time  0.0810246467590332
average batch blocks generation time:  0.0202561616897583
block dataloader generation time/epoch 0.1865532398223877
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016957759857177734  GigaBytes
Max Memory Allocated: 0.03979158401489258  GigaBytes

torch.Size([8693, 500])
torch.Size([2703, 32])
torch.Size([677, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018648147583007812  GigaBytes
Max Memory Allocated: 0.03979158401489258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02039957046508789  GigaBytes
Max Memory Allocated: 0.03979158401489258  GigaBytes

torch.Size([10215, 500])
torch.Size([3277, 32])
torch.Size([805, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022466182708740234  GigaBytes
Max Memory Allocated: 0.03979158401489258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.022389888763427734  GigaBytes
Max Memory Allocated: 0.04157543182373047  GigaBytes

torch.Size([11359, 500])
torch.Size([3499, 32])
torch.Size([898, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.024634838104248047  GigaBytes
Max Memory Allocated: 0.04157543182373047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.017499446868896484  GigaBytes
Max Memory Allocated: 0.04157543182373047  GigaBytes

torch.Size([8985, 500])
torch.Size([2508, 32])
torch.Size([453, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01897144317626953  GigaBytes
Max Memory Allocated: 0.04157543182373047  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0054152607917785645 |0.0010042190551757812 |0.005380570888519287 |0.00016051530838012695 |0.004820287227630615 |0.0021677017211914062 |
----------------------------------------------------------pseudo_mini_loss sum 1.7574338912963867
Total (block generation + training)time/epoch 0.2631514072418213
Training time/epoch 0.07635712623596191
Training time without block to device /epoch 0.07234025001525879
Training time without total dataloading part /epoch 0.04361319541931152
load block tensor time/epoch 0.021661043167114258
block to device time/epoch 0.004016876220703125
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  54428
Number of first layer input nodes during this epoch:  39252
