main start at this time 1648530510.2047508
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014257431030273438  GigaBytes
Max Memory Allocated: 0.00014257431030273438  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0022869110107421875
random selection method range initialization spend 0.0002589225769042969
time for parepare:  4.267692565917969e-05
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.002444744110107422
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.606910705566406e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  2.3603439331054688e-05
----------------------check_connections_block total spend ----------------------------- 0.0052487850189208984
generate_one_block  0.0011210441589355469
generate_one_block  0.0009827613830566406
generate_one_block  0.0010008811950683594
generate_one_block  0.0009629726409912109
generate_one_block  0.0009958744049072266
generate_one_block  0.0009951591491699219
generate_one_block  0.0010297298431396484
generate_one_block  0.0009489059448242188
generate_one_block  0.0009465217590332031
generate_one_block  0.0009603500366210938
generate_one_block  0.0009603500366210938
generate_one_block  0.0009377002716064453
generate_one_block  0.0009579658508300781
generate_one_block  0.000949859619140625
generate_one_block  0.0009667873382568359
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0016214847564697266
gen group dst list time:  7.748603820800781e-05
time for parepare:  0.00022649765014648438
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00020933151245117188
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  8.726119995117188e-05
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0002827644348144531
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  9.608268737792969e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00013494491577148438
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  6.866455078125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.0002090930938720703
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  8.821487426757812e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  0.00011515617370605469
----------------------check_connections_block total spend ----------------------------- 0.004368782043457031
generate_one_block  0.0010714530944824219
generate_one_block  0.0013461112976074219
generate_one_block  0.0011153221130371094
generate_one_block  0.0010650157928466797
generate_one_block  0.0011589527130126953
generate_one_block  0.0010182857513427734
generate_one_block  0.0010204315185546875
generate_one_block  0.0010535717010498047
generate_one_block  0.0009949207305908203
generate_one_block  0.0010275840759277344
generate_one_block  0.0012829303741455078
generate_one_block  0.0009691715240478516
generate_one_block  0.0010576248168945312
generate_one_block  0.00102996826171875
generate_one_block  0.001092672348022461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010612010955810547
gen group dst list time:  0.00011610984802246094
time for parepare:  0.0007078647613525391
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0002243518829345703
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001323223114013672
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  0.0001888275146484375
r_  generation:  0.0018358230590820312
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0005357265472412109
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00041031837463378906
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  9.632110595703125e-05
r_  generation:  0.0009648799896240234
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00017547607421875
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0001761913299560547
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0002677440643310547
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0002849102020263672
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00031113624572753906
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00015425682067871094
r_  generation:  0.0017278194427490234
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0001232624053955078
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0005288124084472656
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0002582073211669922
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0006859302520751953
----------------------check_connections_block total spend ----------------------------- 0.015327215194702148
generate_one_block  0.0012764930725097656
generate_one_block  0.003392934799194336
generate_one_block  0.0015592575073242188
generate_one_block  0.0014688968658447266
generate_one_block  0.002369403839111328
generate_one_block  0.001172780990600586
generate_one_block  0.001180410385131836
generate_one_block  0.0012879371643066406
generate_one_block  0.0013282299041748047
generate_one_block  0.0013608932495117188
generate_one_block  0.003297567367553711
generate_one_block  0.0010881423950195312
generate_one_block  0.0019030570983886719
generate_one_block  0.0012755393981933594
generate_one_block  0.0017843246459960938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020737648010253906
gen group dst list time:  0.0002963542938232422
time for parepare:  0.0015442371368408203
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0004057884216308594
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0005502700805664062
local_output_nid generation:  0.00019097328186035156
local_in_edges_tensor generation:  0.0005278587341308594
mini_batch_src_global generation:  0.000881195068359375
r_  generation:  0.0071544647216796875
local_output_nid generation:  7.367134094238281e-05
local_in_edges_tensor generation:  0.0002856254577636719
mini_batch_src_global generation:  0.0003693103790283203
r_  generation:  0.0025200843811035156
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  0.0002396106719970703
r_  generation:  0.0024874210357666016
local_output_nid generation:  0.0001544952392578125
local_in_edges_tensor generation:  0.00038504600524902344
mini_batch_src_global generation:  0.0005242824554443359
r_  generation:  0.005638599395751953
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  0.00024008750915527344
r_  generation:  0.0011675357818603516
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  0.00012755393981933594
r_  generation:  0.0011272430419921875
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  0.00013685226440429688
r_  generation:  0.0010530948638916016
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.00017189979553222656
r_  generation:  0.0017633438110351562
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00018262863159179688
r_  generation:  0.001638174057006836
local_output_nid generation:  0.0002048015594482422
local_in_edges_tensor generation:  0.0004394054412841797
mini_batch_src_global generation:  0.0005860328674316406
r_  generation:  0.007256269454956055
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  0.0002281665802001953
r_  generation:  0.0005724430084228516
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.00024580955505371094
mini_batch_src_global generation:  0.00021719932556152344
r_  generation:  0.0027506351470947266
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  0.00018644332885742188
r_  generation:  0.001378774642944336
local_output_nid generation:  0.00010728836059570312
local_in_edges_tensor generation:  0.0002772808074951172
mini_batch_src_global generation:  0.0003223419189453125
r_  generation:  0.003924846649169922
----------------------check_connections_block total spend ----------------------------- 0.06319069862365723
generate_one_block  0.0025212764739990234
generate_one_block  0.010571718215942383
generate_one_block  0.004278898239135742
generate_one_block  0.004185914993286133
generate_one_block  0.009184837341308594
generate_one_block  0.0024199485778808594
generate_one_block  0.002523183822631836
generate_one_block  0.002270221710205078
generate_one_block  0.003543853759765625
generate_one_block  0.003248453140258789
generate_one_block  0.01137852668762207
generate_one_block  0.00157928466796875
generate_one_block  0.004671335220336914
generate_one_block  0.0027549266815185547
generate_one_block  0.0060579776763916016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014257431030273438  GigaBytes
Max Memory Allocated: 0.00014257431030273438  GigaBytes

connection checking time:  0.0828866958618164
block generation total time  0.11324024200439453
average batch blocks generation time:  0.007549349466959635
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0025224685668945312  GigaBytes
Max Memory Allocated: 0.0025224685668945312  GigaBytes

torch.Size([1267, 500])
torch.Size([214, 32])
torch.Size([67, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0026769638061523438  GigaBytes
Max Memory Allocated: 0.0027670860290527344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.015572071075439453  GigaBytes
Max Memory Allocated: 0.017681121826171875  GigaBytes

torch.Size([8073, 500])
torch.Size([2763, 32])
torch.Size([580, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.017256736755371094  GigaBytes
Max Memory Allocated: 0.017737865447998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.008969306945800781  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([4621, 500])
torch.Size([800, 32])
torch.Size([216, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.009494304656982422  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.006103038787841797  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([3082, 500])
torch.Size([724, 32])
torch.Size([99, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.006532192230224609  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01677083969116211  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([8749, 500])
torch.Size([1841, 32])
torch.Size([377, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.017906665802001953  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.004542827606201172  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([2268, 500])
torch.Size([321, 32])
torch.Size([69, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.004755973815917969  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.005169391632080078  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([2604, 500])
torch.Size([391, 32])
torch.Size([77, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.005414485931396484  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.004544734954833984  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([1887, 500])
torch.Size([425, 32])
torch.Size([134, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.004838466644287109  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.0054988861083984375  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([2769, 500])
torch.Size([595, 32])
torch.Size([72, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.0058441162109375  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.006867885589599609  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([3506, 500])
torch.Size([562, 32])
torch.Size([173, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.007252693176269531  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.016682147979736328  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([8663, 500])
torch.Size([2676, 32])
torch.Size([494, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.018283367156982422  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.002407550811767578  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([1132, 500])
torch.Size([153, 32])
torch.Size([56, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.00252532958984375  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.009778022766113281  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([5049, 500])
torch.Size([1146, 32])
torch.Size([194, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.010447502136230469  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.0047283172607421875  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([2362, 500])
torch.Size([452, 32])
torch.Size([90, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.0050106048583984375  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.010200977325439453  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([5256, 500])
torch.Size([1398, 32])
torch.Size([224, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011026859283447266  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0027270793914794924 |0.023563305536905926 |0.05593166351318359 |0.00014988581339518228 |0.0030618985493977863 |0.0027112960815429688 |
----------------------------------------------------------pseudo_mini_loss sum 2.0657920837402344
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  79028
Number of first layer input nodes during this epoch:  61288
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01076650619506836  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00046539306640625
random selection method range initialization spend 0.00012040138244628906
time for parepare:  4.57763671875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.2636184692382812e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3365020751953125e-05
----------------------check_connections_block total spend ----------------------------- 0.0026063919067382812
generate_one_block  0.0013513565063476562
generate_one_block  0.0010385513305664062
generate_one_block  0.0010144710540771484
generate_one_block  0.0010263919830322266
generate_one_block  0.0010175704956054688
generate_one_block  0.001001596450805664
generate_one_block  0.0009875297546386719
generate_one_block  0.0011725425720214844
generate_one_block  0.0010170936584472656
generate_one_block  0.0009911060333251953
generate_one_block  0.0009405612945556641
generate_one_block  0.0009474754333496094
generate_one_block  0.0009369850158691406
generate_one_block  0.0009367465972900391
generate_one_block  0.0009539127349853516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006401538848876953
gen group dst list time:  8.058547973632812e-05
time for parepare:  0.00024247169494628906
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00010085105895996094
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00011467933654785156
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00013589859008789062
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  7.2479248046875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.462501525878906e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00016736984252929688
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00020933151245117188
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00013494491577148438
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.988380432128906e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.580352783203125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00011539459228515625
----------------------check_connections_block total spend ----------------------------- 0.004601955413818359
generate_one_block  0.001117706298828125
generate_one_block  0.0011305809020996094
generate_one_block  0.0010483264923095703
generate_one_block  0.001178741455078125
generate_one_block  0.0011408329010009766
generate_one_block  0.0010991096496582031
generate_one_block  0.0012121200561523438
generate_one_block  0.001249074935913086
generate_one_block  0.0011935234069824219
generate_one_block  0.0010983943939208984
generate_one_block  0.001005411148071289
generate_one_block  0.0009958744049072266
generate_one_block  0.0010380744934082031
generate_one_block  0.0009770393371582031
generate_one_block  0.0010714530944824219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010728836059570312
gen group dst list time:  0.0001327991485595703
time for parepare:  0.0007658004760742188
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0002486705780029297
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0004124641418457031
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0005962848663330078
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00014519691467285156
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.0008168220520019531
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  7.390975952148438e-05
r_  generation:  0.0004975795745849609
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.0004107952117919922
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  0.0001316070556640625
r_  generation:  0.001275777816772461
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  0.00018978118896484375
r_  generation:  0.0015072822570800781
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0008676052093505859
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0003764629364013672
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0005106925964355469
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0003249645233154297
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0001513957977294922
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00020265579223632812
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0007612705230712891
----------------------check_connections_block total spend ----------------------------- 0.01604008674621582
generate_one_block  0.0015554428100585938
generate_one_block  0.0017321109771728516
generate_one_block  0.00110626220703125
generate_one_block  0.0018596649169921875
generate_one_block  0.0015492439270019531
generate_one_block  0.0014388561248779297
generate_one_block  0.0025103092193603516
generate_one_block  0.0027883052825927734
generate_one_block  0.0019199848175048828
generate_one_block  0.0013818740844726562
generate_one_block  0.0016243457794189453
generate_one_block  0.0013287067413330078
generate_one_block  0.0011076927185058594
generate_one_block  0.001177072525024414
generate_one_block  0.0019359588623046875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002057313919067383
gen group dst list time:  0.0003044605255126953
time for parepare:  0.0015082359313964844
local_output_nid generation:  8.535385131835938e-05
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.00022077560424804688
r_  generation:  0.0017254352569580078
local_output_nid generation:  8.893013000488281e-05
local_in_edges_tensor generation:  0.00027942657470703125
mini_batch_src_global generation:  0.0003447532653808594
r_  generation:  0.002739429473876953
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  0.00012969970703125
r_  generation:  0.0006875991821289062
local_output_nid generation:  0.00012087821960449219
local_in_edges_tensor generation:  0.00030732154846191406
mini_batch_src_global generation:  0.00025653839111328125
r_  generation:  0.003464937210083008
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.0002689361572265625
mini_batch_src_global generation:  0.0003495216369628906
r_  generation:  0.002733469009399414
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  0.00028896331787109375
r_  generation:  0.0023670196533203125
local_output_nid generation:  0.0001380443572998047
local_in_edges_tensor generation:  0.00036072731018066406
mini_batch_src_global generation:  0.00047659873962402344
r_  generation:  0.004678964614868164
local_output_nid generation:  0.000133514404296875
local_in_edges_tensor generation:  0.0003590583801269531
mini_batch_src_global generation:  0.0005753040313720703
r_  generation:  0.005240917205810547
local_output_nid generation:  0.00012159347534179688
local_in_edges_tensor generation:  0.00031876564025878906
mini_batch_src_global generation:  0.00044083595275878906
r_  generation:  0.004234790802001953
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.0002276897430419922
r_  generation:  0.0015475749969482422
local_output_nid generation:  9.799003601074219e-05
local_in_edges_tensor generation:  0.0002689361572265625
mini_batch_src_global generation:  0.0002982616424560547
r_  generation:  0.0032892227172851562
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.0002837181091308594
r_  generation:  0.0023546218872070312
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.0007119178771972656
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.0001423358917236328
r_  generation:  0.0013761520385742188
local_output_nid generation:  0.0001354217529296875
local_in_edges_tensor generation:  0.0003285408020019531
mini_batch_src_global generation:  0.00032258033752441406
r_  generation:  0.003875255584716797
----------------------check_connections_block total spend ----------------------------- 0.06346535682678223
generate_one_block  0.0037450790405273438
generate_one_block  0.004750728607177734
generate_one_block  0.0017828941345214844
generate_one_block  0.0054247379302978516
generate_one_block  0.004441261291503906
generate_one_block  0.004184246063232422
generate_one_block  0.007524967193603516
generate_one_block  0.00793766975402832
generate_one_block  0.006824970245361328
generate_one_block  0.0028247833251953125
generate_one_block  0.0053789615631103516
generate_one_block  0.004528045654296875
generate_one_block  0.0018093585968017578
generate_one_block  0.002782583236694336
generate_one_block  0.0065119266510009766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01076650619506836  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

connection checking time:  0.0841073989868164
block generation total time  0.11202430725097656
average batch blocks generation time:  0.007468287150065104
block dataloader generation time/epoch 0.23915743827819824
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.005620002746582031  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([2687, 500])
torch.Size([764, 32])
torch.Size([139, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.00608062744140625  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.0092315673828125  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([4607, 500])
torch.Size([903, 32])
torch.Size([235, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.00981760025024414  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.003048419952392578  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([1325, 500])
torch.Size([291, 32])
torch.Size([52, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.003226757049560547  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.010436058044433594  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([5243, 500])
torch.Size([1423, 32])
torch.Size([302, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011292457580566406  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.007908821105957031  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([3899, 500])
torch.Size([836, 32])
torch.Size([164, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.008425235748291016  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.009087562561035156  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([4538, 500])
torch.Size([866, 32])
torch.Size([155, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.009604930877685547  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.010151386260986328  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([5058, 500])
torch.Size([1610, 32])
torch.Size([349, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01116180419921875  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01221323013305664  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

torch.Size([6152, 500])
torch.Size([1622, 32])
torch.Size([415, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.013285636901855469  GigaBytes
Max Memory Allocated: 0.023928165435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.014471054077148438  GigaBytes
Max Memory Allocated: 0.025791645050048828  GigaBytes

torch.Size([7394, 500])
torch.Size([1451, 32])
torch.Size([341, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.015383243560791016  GigaBytes
Max Memory Allocated: 0.025791645050048828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.006366729736328125  GigaBytes
Max Memory Allocated: 0.025791645050048828  GigaBytes

torch.Size([2815, 500])
torch.Size([540, 32])
torch.Size([174, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.006738185882568359  GigaBytes
Max Memory Allocated: 0.025791645050048828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.007638454437255859  GigaBytes
Max Memory Allocated: 0.025791645050048828  GigaBytes

torch.Size([3741, 500])
torch.Size([1109, 32])
torch.Size([118, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.00826406478881836  GigaBytes
Max Memory Allocated: 0.025791645050048828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.0077419281005859375  GigaBytes
Max Memory Allocated: 0.025791645050048828  GigaBytes

torch.Size([3815, 500])
torch.Size([611, 32])
torch.Size([111, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.008129596710205078  GigaBytes
Max Memory Allocated: 0.025791645050048828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.003124237060546875  GigaBytes
Max Memory Allocated: 0.025791645050048828  GigaBytes

torch.Size([1364, 500])
torch.Size([269, 32])
torch.Size([71, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.003307342529296875  GigaBytes
Max Memory Allocated: 0.025791645050048828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.004853248596191406  GigaBytes
Max Memory Allocated: 0.025791645050048828  GigaBytes

torch.Size([2280, 500])
torch.Size([386, 32])
torch.Size([66, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.005099773406982422  GigaBytes
Max Memory Allocated: 0.025791645050048828  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011241912841796875  GigaBytes
Max Memory Allocated: 0.025791645050048828  GigaBytes

torch.Size([5669, 500])
torch.Size([1721, 32])
torch.Size([238, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.012197494506835938  GigaBytes
Max Memory Allocated: 0.025791645050048828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002343257268269857 |0.0006315231323242188 |0.004612382253011068 |0.0001250743865966797 |0.004334863026936849 |0.004055500030517578 |
----------------------------------------------------------pseudo_mini_loss sum 2.2368693351745605
Total (block generation + training)time/epoch 0.4441530704498291
Training time/epoch 0.20473718643188477
Training time without block to device /epoch 0.19526433944702148
Training time without total dataloading part /epoch 0.14014029502868652
load block tensor time/epoch 0.03514885902404785
block to device time/epoch 0.009472846984863281
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  78276
Number of first layer input nodes during this epoch:  60587
