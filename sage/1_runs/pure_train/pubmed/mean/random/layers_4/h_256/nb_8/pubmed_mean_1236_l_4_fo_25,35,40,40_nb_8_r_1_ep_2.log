main start at this time 1648530643.3579123
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019488334655761719  GigaBytes
Max Memory Allocated: 0.0019488334655761719  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.002034425735473633
random selection method range initialization spend 0.0002040863037109375
time for parepare:  4.291534423828125e-05
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.0014121532440185547
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.337860107421875e-05
----------------------check_connections_block total spend ----------------------------- 0.0024132728576660156
generate_one_block  0.0013222694396972656
generate_one_block  0.0010900497436523438
generate_one_block  0.0010318756103515625
generate_one_block  0.0010716915130615234
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012013912200927734
gen group dst list time:  7.772445678710938e-05
time for parepare:  0.0002231597900390625
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00043582916259765625
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0001895427703857422
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0003077983856201172
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0003120899200439453
----------------------check_connections_block total spend ----------------------------- 0.0026695728302001953
generate_one_block  0.0016427040100097656
generate_one_block  0.001218557357788086
generate_one_block  0.0014140605926513672
generate_one_block  0.0014395713806152344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010776519775390625
gen group dst list time:  7.319450378417969e-05
time for parepare:  0.0007653236389160156
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.0003495216369628906
mini_batch_src_global generation:  0.000240325927734375
r_  generation:  0.002936840057373047
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  0.0001766681671142578
r_  generation:  0.0011005401611328125
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.0017883777618408203
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.0002079010009765625
r_  generation:  0.002174854278564453
----------------------check_connections_block total spend ----------------------------- 0.01282644271850586
generate_one_block  0.005021333694458008
generate_one_block  0.0027053356170654297
generate_one_block  0.0032176971435546875
generate_one_block  0.003814220428466797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002062082290649414
gen group dst list time:  0.00021505355834960938
time for parepare:  0.0013842582702636719
local_output_nid generation:  0.00031447410583496094
local_in_edges_tensor generation:  0.0009937286376953125
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.010754823684692383
local_output_nid generation:  0.0001876354217529297
local_in_edges_tensor generation:  0.00045800209045410156
mini_batch_src_global generation:  0.0008802413940429688
r_  generation:  0.006183624267578125
local_output_nid generation:  0.0002067089080810547
local_in_edges_tensor generation:  0.00044536590576171875
mini_batch_src_global generation:  0.0006759166717529297
r_  generation:  0.0069463253021240234
local_output_nid generation:  0.0002951622009277344
local_in_edges_tensor generation:  0.0005862712860107422
mini_batch_src_global generation:  0.0009980201721191406
r_  generation:  0.009934186935424805
----------------------check_connections_block total spend ----------------------------- 0.05102038383483887
generate_one_block  0.01575636863708496
generate_one_block  0.009135246276855469
generate_one_block  0.011032342910766602
generate_one_block  0.014156579971313477
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019488334655761719  GigaBytes
Max Memory Allocated: 0.0019488334655761719  GigaBytes

connection checking time:  0.06651639938354492
block generation total time  0.07055401802062988
average batch blocks generation time:  0.01763850450515747
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.025771141052246094  GigaBytes
Max Memory Allocated: 0.025771141052246094  GigaBytes

torch.Size([12500, 500])
torch.Size([4121, 256])
torch.Size([1031, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.0444636344909668  GigaBytes
Max Memory Allocated: 0.0498046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.0194549560546875  GigaBytes
Max Memory Allocated: 0.0498046875  GigaBytes

torch.Size([8251, 500])
torch.Size([2197, 256])
torch.Size([444, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.028522014617919922  GigaBytes
Max Memory Allocated: 0.0498046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.020316600799560547  GigaBytes
Max Memory Allocated: 0.0498046875  GigaBytes

torch.Size([8685, 500])
torch.Size([2652, 256])
torch.Size([622, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.03176689147949219  GigaBytes
Max Memory Allocated: 0.0498046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.02570486068725586  GigaBytes
Max Memory Allocated: 0.0498046875  GigaBytes

torch.Size([11511, 500])
torch.Size([3946, 256])
torch.Size([788, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.04183816909790039  GigaBytes
Max Memory Allocated: 0.0498046875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012982189655303955 |0.08585304021835327 |0.19603049755096436 |0.0001735091209411621 |0.004480719566345215 |0.002547740936279297 |
----------------------------------------------------------pseudo_mini_loss sum 2.4597625732421875
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  57105
Number of first layer input nodes during this epoch:  40947
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.030324459075927734  GigaBytes
Max Memory Allocated: 0.0498046875  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004553794860839844
random selection method range initialization spend 0.000102996826171875
time for parepare:  4.553794860839844e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.2928924560546875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.8848648071289062e-05
----------------------check_connections_block total spend ----------------------------- 0.0009615421295166016
generate_one_block  0.0015001296997070312
generate_one_block  0.0010731220245361328
generate_one_block  0.001016378402709961
generate_one_block  0.000972747802734375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005123615264892578
gen group dst list time:  3.2901763916015625e-05
time for parepare:  0.0002307891845703125
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00016999244689941406
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0002834796905517578
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0005826950073242188
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.00021028518676757812
----------------------check_connections_block total spend ----------------------------- 0.0026924610137939453
generate_one_block  0.0011870861053466797
generate_one_block  0.0013251304626464844
generate_one_block  0.001697540283203125
generate_one_block  0.0012133121490478516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009431838989257812
gen group dst list time:  7.128715515136719e-05
time for parepare:  0.0006859302520751953
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0005943775177001953
mini_batch_src_global generation:  0.00013184547424316406
r_  generation:  0.0010745525360107422
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.000202178955078125
r_  generation:  0.0014531612396240234
local_output_nid generation:  8.7738037109375e-05
local_in_edges_tensor generation:  0.0002739429473876953
mini_batch_src_global generation:  0.0003895759582519531
r_  generation:  0.0036017894744873047
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00022125244140625
r_  generation:  0.0014765262603759766
----------------------check_connections_block total spend ----------------------------- 0.012777566909790039
generate_one_block  0.0024666786193847656
generate_one_block  0.002847433090209961
generate_one_block  0.0054950714111328125
generate_one_block  0.0027773380279541016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018582344055175781
gen group dst list time:  0.00020933151245117188
time for parepare:  0.001216888427734375
local_output_nid generation:  0.00016450881958007812
local_in_edges_tensor generation:  0.0006990432739257812
mini_batch_src_global generation:  0.0007152557373046875
r_  generation:  0.005647897720336914
local_output_nid generation:  0.00020766258239746094
local_in_edges_tensor generation:  0.0004937648773193359
mini_batch_src_global generation:  0.0008902549743652344
r_  generation:  0.006725311279296875
local_output_nid generation:  0.00031948089599609375
local_in_edges_tensor generation:  0.0007002353668212891
mini_batch_src_global generation:  0.0009837150573730469
r_  generation:  0.011276960372924805
local_output_nid generation:  0.000232696533203125
local_in_edges_tensor generation:  0.0005137920379638672
mini_batch_src_global generation:  0.000812530517578125
r_  generation:  0.007367134094238281
----------------------check_connections_block total spend ----------------------------- 0.04688072204589844
generate_one_block  0.009313106536865234
generate_one_block  0.010329484939575195
generate_one_block  0.015943527221679688
generate_one_block  0.010466575622558594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.030324459075927734  GigaBytes
Max Memory Allocated: 0.0498046875  GigaBytes

connection checking time:  0.06235074996948242
block generation total time  0.06506228446960449
average batch blocks generation time:  0.016265571117401123
block dataloader generation time/epoch 0.15122079849243164
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.022402286529541016  GigaBytes
Max Memory Allocated: 0.0498046875  GigaBytes

torch.Size([7751, 500])
torch.Size([2045, 256])
torch.Size([394, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.030757427215576172  GigaBytes
Max Memory Allocated: 0.0498046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.02464771270751953  GigaBytes
Max Memory Allocated: 0.0498046875  GigaBytes

torch.Size([8934, 500])
torch.Size([2678, 256])
torch.Size([597, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.036057472229003906  GigaBytes
Max Memory Allocated: 0.0498046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03197765350341797  GigaBytes
Max Memory Allocated: 0.0498046875  GigaBytes

torch.Size([12771, 500])
torch.Size([4502, 256])
torch.Size([1257, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.05327892303466797  GigaBytes
Max Memory Allocated: 0.057373046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.025676727294921875  GigaBytes
Max Memory Allocated: 0.057373046875  GigaBytes

torch.Size([9484, 500])
torch.Size([2882, 256])
torch.Size([550, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03736448287963867  GigaBytes
Max Memory Allocated: 0.057373046875  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006968319416046143 |0.001094222068786621 |0.006161928176879883 |0.00015425682067871094 |0.00394052267074585 |0.003003835678100586 |
----------------------------------------------------------pseudo_mini_loss sum 1.0040781497955322
Total (block generation + training)time/epoch 0.23572492599487305
Training time/epoch 0.08387327194213867
Training time without block to device /epoch 0.07949638366699219
Training time without total dataloading part /epoch 0.04403066635131836
load block tensor time/epoch 0.02787327766418457
block to device time/epoch 0.004376888275146484
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  54201
Number of first layer input nodes during this epoch:  38940
