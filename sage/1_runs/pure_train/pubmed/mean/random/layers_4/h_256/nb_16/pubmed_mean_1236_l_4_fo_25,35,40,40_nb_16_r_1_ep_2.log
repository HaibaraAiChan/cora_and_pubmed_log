main start at this time 1648530653.3282695
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019488334655761719  GigaBytes
Max Memory Allocated: 0.0019488334655761719  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.002518177032470703
random selection method range initialization spend 0.00022029876708984375
time for parepare:  4.267692565917969e-05
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.002167224884033203
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.3113021850585938e-05
----------------------check_connections_block total spend ----------------------------- 0.0037794113159179688
generate_one_block  0.0013153553009033203
generate_one_block  0.0010380744934082031
generate_one_block  0.001116037368774414
generate_one_block  0.001039743423461914
generate_one_block  0.0010311603546142578
generate_one_block  0.0010564327239990234
generate_one_block  0.0010530948638916016
generate_one_block  0.0009965896606445312
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012328624725341797
gen group dst list time:  4.9591064453125e-05
time for parepare:  0.00023126602172851562
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00022482872009277344
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0002608299255371094
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0002307891845703125
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.00011730194091796875
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0002338886260986328
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00011706352233886719
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00021266937255859375
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  5.841255187988281e-05
----------------------check_connections_block total spend ----------------------------- 0.003347635269165039
generate_one_block  0.0014166831970214844
generate_one_block  0.0013451576232910156
generate_one_block  0.001092672348022461
generate_one_block  0.0012691020965576172
generate_one_block  0.0013458728790283203
generate_one_block  0.0011489391326904297
generate_one_block  0.0014333724975585938
generate_one_block  0.0010833740234375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011196136474609375
gen group dst list time:  8.463859558105469e-05
time for parepare:  0.0007960796356201172
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.0002932548522949219
mini_batch_src_global generation:  0.00013494491577148438
r_  generation:  0.0012769699096679688
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.00019693374633789062
r_  generation:  0.001848459243774414
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.00036072731018066406
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  8.20159912109375e-05
r_  generation:  0.000827789306640625
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  0.00013971328735351562
r_  generation:  0.0014264583587646484
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  0.0001125335693359375
r_  generation:  0.0008611679077148438
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.0012505054473876953
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  8.225440979003906e-05
r_  generation:  0.0004477500915527344
----------------------check_connections_block total spend ----------------------------- 0.013921499252319336
generate_one_block  0.0028083324432373047
generate_one_block  0.0034215450286865234
generate_one_block  0.0016908645629882812
generate_one_block  0.0019741058349609375
generate_one_block  0.0027360916137695312
generate_one_block  0.002245187759399414
generate_one_block  0.0024552345275878906
generate_one_block  0.001631021499633789
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020112991333007812
gen group dst list time:  0.0002570152282714844
time for parepare:  0.0015408992767333984
local_output_nid generation:  0.0001895427703857422
local_in_edges_tensor generation:  0.0007197856903076172
mini_batch_src_global generation:  0.0007746219635009766
r_  generation:  0.006435394287109375
local_output_nid generation:  0.00022649765014648438
local_in_edges_tensor generation:  0.0005011558532714844
mini_batch_src_global generation:  0.0009403228759765625
r_  generation:  0.007075309753417969
local_output_nid generation:  6.222724914550781e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  0.00031185150146484375
r_  generation:  0.0022003650665283203
local_output_nid generation:  0.0001461505889892578
local_in_edges_tensor generation:  0.0003459453582763672
mini_batch_src_global generation:  0.0003788471221923828
r_  generation:  0.004589080810546875
local_output_nid generation:  0.00016117095947265625
local_in_edges_tensor generation:  0.0003800392150878906
mini_batch_src_global generation:  0.0005400180816650391
r_  generation:  0.005487680435180664
local_output_nid generation:  0.00015473365783691406
local_in_edges_tensor generation:  0.0003483295440673828
mini_batch_src_global generation:  0.0005249977111816406
r_  generation:  0.005284309387207031
local_output_nid generation:  0.00016427040100097656
local_in_edges_tensor generation:  0.00037741661071777344
mini_batch_src_global generation:  0.0005350112915039062
r_  generation:  0.005398988723754883
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  0.0003516674041748047
r_  generation:  0.0025739669799804688
----------------------check_connections_block total spend ----------------------------- 0.05918407440185547
generate_one_block  0.010451078414916992
generate_one_block  0.011054515838623047
generate_one_block  0.0036742687225341797
generate_one_block  0.007042646408081055
generate_one_block  0.008490324020385742
generate_one_block  0.008381366729736328
generate_one_block  0.008284568786621094
generate_one_block  0.00420069694519043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019488334655761719  GigaBytes
Max Memory Allocated: 0.0019488334655761719  GigaBytes

connection checking time:  0.07645320892333984
block generation total time  0.09067702293395996
average batch blocks generation time:  0.011334627866744995
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.020265579223632812  GigaBytes
Max Memory Allocated: 0.020265579223632812  GigaBytes

torch.Size([9715, 500])
torch.Size([2429, 256])
torch.Size([539, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03049468994140625  GigaBytes
Max Memory Allocated: 0.03667736053466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.020129680633544922  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

torch.Size([8582, 500])
torch.Size([2357, 256])
torch.Size([522, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.030028343200683594  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.011108875274658203  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

torch.Size([3840, 500])
torch.Size([632, 256])
torch.Size([180, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.013973236083984375  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.016422748565673828  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

torch.Size([6461, 500])
torch.Size([1729, 256])
torch.Size([280, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.023251056671142578  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.015552043914794922  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

torch.Size([6154, 500])
torch.Size([2038, 256])
torch.Size([447, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.024236679077148438  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.018240928649902344  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

torch.Size([7610, 500])
torch.Size([1992, 256])
torch.Size([304, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.02598094940185547  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.019546985626220703  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

torch.Size([8307, 500])
torch.Size([2114, 256])
torch.Size([530, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.028680801391601562  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.009335517883300781  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

torch.Size([2876, 500])
torch.Size([778, 256])
torch.Size([114, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.012355327606201172  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0037650763988494873 |0.04315313696861267 |0.10098522901535034 |0.00017192959785461426 |0.0034271180629730225 |0.003064393997192383 |
----------------------------------------------------------pseudo_mini_loss sum 2.4960806369781494
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  70887
Number of first layer input nodes during this epoch:  53545
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.013410091400146484  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00045943260192871094
random selection method range initialization spend 0.00011086463928222656
time for parepare:  4.744529724121094e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.821487426757812e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0002815723419189453
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0742416381835938e-05
----------------------check_connections_block total spend ----------------------------- 0.0018458366394042969
generate_one_block  0.0013318061828613281
generate_one_block  0.0010349750518798828
generate_one_block  0.0010333061218261719
generate_one_block  0.0010106563568115234
generate_one_block  0.0009770393371582031
generate_one_block  0.0009644031524658203
generate_one_block  0.001005411148071289
generate_one_block  0.0009791851043701172
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004892349243164062
gen group dst list time:  4.744529724121094e-05
time for parepare:  0.00022840499877929688
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001163482666015625
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00014328956604003906
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002460479736328125
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0003230571746826172
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.00024271011352539062
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00010895729064941406
----------------------check_connections_block total spend ----------------------------- 0.003314971923828125
generate_one_block  0.00110626220703125
generate_one_block  0.0011179447174072266
generate_one_block  0.0011663436889648438
generate_one_block  0.0012311935424804688
generate_one_block  0.0013589859008789062
generate_one_block  0.001287221908569336
generate_one_block  0.001035928726196289
generate_one_block  0.0011239051818847656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011076927185058594
gen group dst list time:  9.059906005859375e-05
time for parepare:  0.0006687641143798828
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.00010442733764648438
r_  generation:  0.0007498264312744141
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.00041937828063964844
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0008606910705566406
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  0.0001430511474609375
r_  generation:  0.0012924671173095703
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  0.0002532005310058594
r_  generation:  0.0020956993103027344
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00021266937255859375
r_  generation:  0.0020322799682617188
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0004177093505859375
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0005414485931396484
----------------------check_connections_block total spend ----------------------------- 0.014070510864257812
generate_one_block  0.0019392967224121094
generate_one_block  0.0013997554779052734
generate_one_block  0.002068758010864258
generate_one_block  0.0025277137756347656
generate_one_block  0.0035507678985595703
generate_one_block  0.003565549850463867
generate_one_block  0.0014452934265136719
generate_one_block  0.0015621185302734375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020112991333007812
gen group dst list time:  0.0002601146697998047
time for parepare:  0.0014467239379882812
local_output_nid generation:  0.0001087188720703125
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.0005490779876708984
r_  generation:  0.004101276397705078
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  0.00028395652770996094
r_  generation:  0.0018835067749023438
local_output_nid generation:  0.00013446807861328125
local_in_edges_tensor generation:  0.00035190582275390625
mini_batch_src_global generation:  0.00047087669372558594
r_  generation:  0.004836082458496094
local_output_nid generation:  0.00017786026000976562
local_in_edges_tensor generation:  0.00040411949157714844
mini_batch_src_global generation:  0.0006096363067626953
r_  generation:  0.005227327346801758
local_output_nid generation:  0.00021123886108398438
local_in_edges_tensor generation:  0.0005037784576416016
mini_batch_src_global generation:  0.0008702278137207031
r_  generation:  0.008118391036987305
local_output_nid generation:  0.00023245811462402344
local_in_edges_tensor generation:  0.0005261898040771484
mini_batch_src_global generation:  0.0008945465087890625
r_  generation:  0.0076656341552734375
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  0.0003638267517089844
r_  generation:  0.002292156219482422
local_output_nid generation:  8.96453857421875e-05
local_in_edges_tensor generation:  0.000244140625
mini_batch_src_global generation:  0.0002613067626953125
r_  generation:  0.0026123523712158203
----------------------check_connections_block total spend ----------------------------- 0.0561823844909668
generate_one_block  0.007039785385131836
generate_one_block  0.0035789012908935547
generate_one_block  0.007470846176147461
generate_one_block  0.007788896560668945
generate_one_block  0.012070655822753906
generate_one_block  0.011208295822143555
generate_one_block  0.003936767578125
generate_one_block  0.004469156265258789
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.013410091400146484  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

connection checking time:  0.07356786727905273
block generation total time  0.08505034446716309
average batch blocks generation time: Using backend: pytorch
 0.010631293058395386
block dataloader generation time/epoch 0.1898488998413086
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.018114089965820312  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

torch.Size([5476, 500])
torch.Size([1316, 256])
torch.Size([266, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.02375030517578125  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.013835906982421875  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

torch.Size([3221, 500])
torch.Size([773, 256])
torch.Size([135, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.016957759857177734  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.020226001739501953  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

torch.Size([6599, 500])
torch.Size([1690, 256])
torch.Size([343, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.027211666107177734  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.022118568420410156  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

torch.Size([7607, 500])
torch.Size([2290, 256])
torch.Size([505, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.031855106353759766  GigaBytes
Max Memory Allocated: 0.03797435760498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.027879714965820312  GigaBytes
Max Memory Allocated: 0.041754722595214844  GigaBytes

torch.Size([10635, 500])
torch.Size([2974, 256])
torch.Size([684, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.041361331939697266  GigaBytes
Max Memory Allocated: 0.04766559600830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.024608612060546875  GigaBytes
Max Memory Allocated: 0.04766559600830078  GigaBytes

torch.Size([8887, 500])
torch.Size([2861, 256])
torch.Size([542, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.03658151626586914  GigaBytes
Max Memory Allocated: 0.04766559600830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.014879226684570312  GigaBytes
Max Memory Allocated: 0.04766559600830078  GigaBytes

torch.Size([3775, 500])
torch.Size([659, 256])
torch.Size([148, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.01768636703491211  GigaBytes
Max Memory Allocated: 0.04766559600830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.017016887664794922  GigaBytes
Max Memory Allocated: 0.04766559600830078  GigaBytes

torch.Size([4915, 500])
torch.Size([980, 256])
torch.Size([258, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.021314144134521484  GigaBytes
Max Memory Allocated: 0.04766559600830078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0023698806762695312 |0.0008115172386169434 |0.00519677996635437 |0.0001423358917236328 |0.0027103424072265625 |0.002377748489379883 |
----------------------------------------------------------pseudo_mini_loss sum 1.5927879810333252
Total (block generation + training)time/epoch 0.2940359115600586
Training time/epoch 0.1039884090423584
Training time without block to device /epoch 0.09749627113342285
Training time without total dataloading part /epoch 0.0667734146118164
load block tensor time/epoch 0.01895904541015625
block to device time/epoch 0.006492137908935547
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  67895
Number of first layer input nodes during this epoch:  51115
