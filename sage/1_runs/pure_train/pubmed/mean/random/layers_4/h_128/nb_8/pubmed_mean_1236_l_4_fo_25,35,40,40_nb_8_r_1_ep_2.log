main start at this time 1648530593.4407775
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007309913635253906  GigaBytes
Max Memory Allocated: 0.0007309913635253906  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0014979839324951172
random selection method range initialization spend 0.00020551681518554688
time for parepare:  4.887580871582031e-05
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.001306295394897461
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.5762786865234375e-05
----------------------check_connections_block total spend ----------------------------- 0.002384662628173828
generate_one_block  0.0019266605377197266
generate_one_block  0.0012664794921875
generate_one_block  0.0012183189392089844
generate_one_block  0.0012192726135253906
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010647773742675781
gen group dst list time:  3.910064697265625e-05
time for parepare:  0.0002613067626953125
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0004432201385498047
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0002808570861816406
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0003421306610107422
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00038123130798339844
----------------------check_connections_block total spend ----------------------------- 0.0030624866485595703
generate_one_block  0.0018367767333984375
generate_one_block  0.0015292167663574219
generate_one_block  0.0015869140625
generate_one_block  0.0017523765563964844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001249551773071289
gen group dst list time:  8.511543273925781e-05
time for parepare:  0.0008511543273925781
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.00043010711669921875
mini_batch_src_global generation:  0.00029468536376953125
r_  generation:  0.0030531883239746094
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  0.00025725364685058594
r_  generation:  0.0016429424285888672
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.00023317337036132812
mini_batch_src_global generation:  0.0001895427703857422
r_  generation:  0.001934051513671875
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.00024962425231933594
mini_batch_src_global generation:  0.0002548694610595703
r_  generation:  0.0025484561920166016
----------------------check_connections_block total spend ----------------------------- 0.015119314193725586
generate_one_block  0.004595279693603516
generate_one_block  0.0027391910552978516
generate_one_block  0.0029234886169433594
generate_one_block  0.003899097442626953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0022134780883789062
gen group dst list time:  0.0002655982971191406
time for parepare:  0.0017518997192382812
local_output_nid generation:  0.00034356117248535156
local_in_edges_tensor generation:  0.0010819435119628906
mini_batch_src_global generation:  0.0012040138244628906
r_  generation:  0.01898813247680664
local_output_nid generation:  0.0002834796905517578
local_in_edges_tensor generation:  0.0006544589996337891
mini_batch_src_global generation:  0.0012233257293701172
r_  generation:  0.006459712982177734
local_output_nid generation:  0.0002357959747314453
local_in_edges_tensor generation:  0.0005190372467041016
mini_batch_src_global generation:  0.0007338523864746094
r_  generation:  0.007150173187255859
local_output_nid generation:  0.0002396106719970703
local_in_edges_tensor generation:  0.0005290508270263672
mini_batch_src_global generation:  0.0008475780487060547
r_  generation:  0.008507490158081055
----------------------check_connections_block total spend ----------------------------- 0.06177997589111328
generate_one_block  0.014104366302490234
generate_one_block  0.009624958038330078
generate_one_block  0.01187276840209961
generate_one_block  0.012603521347045898
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007309913635253906  GigaBytes
Max Memory Allocated: 0.0007309913635253906  GigaBytes

connection checking time:  0.07996177673339844
block generation total time  0.06906795501708984
average batch blocks generation time:  0.01726698875427246
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.022635459899902344  GigaBytes
Max Memory Allocated: 0.022635459899902344  GigaBytes

torch.Size([11573, 500])
torch.Size([3436, 128])
torch.Size([863, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03051137924194336  GigaBytes
Max Memory Allocated: 0.033602237701416016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.017312049865722656  GigaBytes
Max Memory Allocated: 0.03866910934448242  GigaBytes

torch.Size([8403, 500])
torch.Size([2520, 128])
torch.Size([525, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.022953510284423828  GigaBytes
Max Memory Allocated: 0.03866910934448242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.020503520965576172  GigaBytes
Max Memory Allocated: 0.03866910934448242  GigaBytes

torch.Size([10093, 500])
torch.Size([2948, 128])
torch.Size([673, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.027331829071044922  GigaBytes
Max Memory Allocated: 0.03866910934448242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.021298885345458984  GigaBytes
Max Memory Allocated: 0.039791107177734375  GigaBytes

torch.Size([10246, 500])
torch.Size([3441, 128])
torch.Size([796, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.02877330780029297  GigaBytes
Max Memory Allocated: 0.039791107177734375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010509788990020752 |0.08584606647491455 |0.19639486074447632 |0.00019240379333496094 |0.004529356956481934 |0.0033812522888183594 |
----------------------------------------------------------pseudo_mini_loss sum 2.3284056186676025
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  55873
Number of first layer input nodes during this epoch:  40315
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.02344036102294922  GigaBytes
Max Memory Allocated: 0.039791107177734375  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000453948974609375
random selection method range initialization spend 0.00012040138244628906
time for parepare:  4.57763671875e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  5.626678466796875e-05
----------------------check_connections_block total spend ----------------------------- 0.0009527206420898438
generate_one_block  0.0015056133270263672
generate_one_block  0.001020669937133789
generate_one_block  0.0010223388671875
generate_one_block  0.0010175704956054688
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00048160552978515625
gen group dst list time:  3.218650817871094e-05
time for parepare:  0.00022459030151367188
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00024509429931640625
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00024127960205078125
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0003428459167480469
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00041103363037109375
----------------------check_connections_block total spend ----------------------------- 0.002622365951538086
generate_one_block  0.0013072490692138672
generate_one_block  0.0012392997741699219
generate_one_block  0.0013530254364013672
generate_one_block  0.0014586448669433594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009834766387939453
gen group dst list time:  7.939338684082031e-05
time for parepare:  0.000751495361328125
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.0006077289581298828
mini_batch_src_global generation:  0.00018477439880371094
r_  generation:  0.0016884803771972656
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.0015926361083984375
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  0.00023365020751953125
r_  generation:  0.0022242069244384766
local_output_nid generation:  6.222724914550781e-05
local_in_edges_tensor generation:  0.00021839141845703125
mini_batch_src_global generation:  0.00025963783264160156
r_  generation:  0.0023345947265625
----------------------check_connections_block total spend ----------------------------- 0.013020038604736328
generate_one_block  0.0032095909118652344
generate_one_block  0.002900838851928711
generate_one_block  0.0036935806274414062
generate_one_block  0.003949880599975586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019626617431640625
gen group dst list time:  0.00021696090698242188
time for parepare:  0.00125885009765625
local_output_nid generation:  0.00023818016052246094
local_in_edges_tensor generation:  0.0008523464202880859
mini_batch_src_global generation:  0.0009317398071289062
r_  generation:  0.0076787471771240234
local_output_nid generation:  0.00025653839111328125
local_in_edges_tensor generation:  0.0005800724029541016
mini_batch_src_global generation:  0.0011203289031982422
r_  generation:  0.008075237274169922
local_output_nid generation:  0.00021147727966308594
local_in_edges_tensor generation:  0.0004932880401611328
mini_batch_src_global generation:  0.0007557868957519531
r_  generation:  0.0076448917388916016
local_output_nid generation:  0.0002512931823730469
local_in_edges_tensor generation:  0.000530242919921875
mini_batch_src_global generation:  0.0007472038269042969
r_  generation:  0.00806283950805664
----------------------check_connections_block total spend ----------------------------- 0.04759955406188965
generate_one_block  0.011871814727783203
generate_one_block  0.012633800506591797
generate_one_block  0.011668682098388672
generate_one_block  0.011578083038330078
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.02344036102294922  GigaBytes
Max Memory Allocated: 0.039791107177734375  GigaBytes

connection checking time:  0.06324195861816406
block generation total time  0.0668644905090332
average batch blocks generation time:  0.0167161226272583
block dataloader generation time/epoch 0.1549534797668457
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.02263355255126953  GigaBytes
Max Memory Allocated: 0.0419011116027832  GigaBytes

torch.Size([10446, 500])
torch.Size([3305, 128])
torch.Size([654, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.02953338623046875  GigaBytes
Max Memory Allocated: 0.0419011116027832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.023586750030517578  GigaBytes
Max Memory Allocated: 0.04276895523071289  GigaBytes

torch.Size([10951, 500])
torch.Size([2986, 128])
torch.Size([583, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.029848575592041016  GigaBytes
Max Memory Allocated: 0.04276895523071289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.020763874053955078  GigaBytes
Max Memory Allocated: 0.04276895523071289  GigaBytes

torch.Size([9432, 500])
torch.Size([2730, 128])
torch.Size([750, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.02764415740966797  GigaBytes
Max Memory Allocated: 0.04276895523071289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.02048492431640625  GigaBytes
Max Memory Allocated: 0.04276895523071289  GigaBytes

torch.Size([9277, 500])
torch.Size([3353, 128])
torch.Size([829, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.027962207794189453  GigaBytes
Max Memory Allocated: 0.04276895523071289  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004695892333984375 |0.0008081197738647461 |0.004660606384277344 |0.00013846158981323242 |0.0029693245887756348 |0.0022971630096435547 |
----------------------------------------------------------pseudo_mini_loss sum 1.6615278720855713
Total (block generation + training)time/epoch 0.21668577194213867
Training time/epoch 0.061490535736083984
Training time without block to device /epoch 0.058258056640625
Training time without total dataloading part /epoch 0.0333707332611084
load block tensor time/epoch 0.0187835693359375
block to device time/epoch 0.0032324790954589844
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  55651
Number of first layer input nodes during this epoch:  40106
