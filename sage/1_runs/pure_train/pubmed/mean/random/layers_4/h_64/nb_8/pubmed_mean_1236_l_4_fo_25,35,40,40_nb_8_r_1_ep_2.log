main start at this time 1648530541.693072
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003085136413574219  GigaBytes
Max Memory Allocated: 0.0003085136413574219  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0016674995422363281
random selection method range initialization spend 0.00019311904907226562
time for parepare:  4.410743713378906e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0011587142944335938
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.86102294921875e-05
----------------------check_connections_block total spend ----------------------------- 0.002152681350708008
generate_one_block  0.0017077922821044922
generate_one_block  0.0011470317840576172
generate_one_block  0.0010678768157958984
generate_one_block  0.0010325908660888672
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011148452758789062
gen group dst list time:  3.647804260253906e-05
time for parepare:  0.0002231597900390625
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0004527568817138672
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.000255584716796875
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0003159046173095703
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00021767616271972656
----------------------check_connections_block total spend ----------------------------- 0.0026509761810302734
generate_one_block  0.0016322135925292969
generate_one_block  0.0013537406921386719
generate_one_block  0.0014286041259765625
generate_one_block  0.0013267993927001953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010607242584228516
gen group dst list time:  7.200241088867188e-05
time for parepare:  0.0007550716400146484
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.00035071372985839844
mini_batch_src_global generation:  0.00023508071899414062
r_  generation:  0.0027799606323242188
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  0.00027871131896972656
r_  generation:  0.0019333362579345703
local_output_nid generation:  6.151199340820312e-05
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.001794576644897461
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.0012629032135009766
----------------------check_connections_block total spend ----------------------------- 0.01261138916015625
generate_one_block  0.00466609001159668
generate_one_block  0.003524303436279297
generate_one_block  0.0030808448791503906
generate_one_block  0.002484560012817383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019445419311523438
gen group dst list time:  0.00021123886108398438
time for parepare:  0.0014581680297851562
local_output_nid generation:  0.0002205371856689453
local_in_edges_tensor generation:  0.0008232593536376953
mini_batch_src_global generation:  0.000985860824584961
r_  generation:  0.008294820785522461
local_output_nid generation:  0.0002779960632324219
local_in_edges_tensor generation:  0.0006046295166015625
mini_batch_src_global generation:  0.0010800361633300781
r_  generation:  0.008400440216064453
local_output_nid generation:  0.00021409988403320312
local_in_edges_tensor generation:  0.0004639625549316406
mini_batch_src_global generation:  0.0006489753723144531
r_  generation:  0.006939411163330078
local_output_nid generation:  0.00020122528076171875
local_in_edges_tensor generation:  0.0004143714904785156
mini_batch_src_global generation:  0.0006124973297119141
r_  generation:  0.00596928596496582
----------------------check_connections_block total spend ----------------------------- 0.04510188102722168
generate_one_block  0.012145757675170898
generate_one_block  0.012783050537109375
generate_one_block  0.01030731201171875
generate_one_block  0.009082317352294922
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003085136413574219  GigaBytes
Max Memory Allocated: 0.0003085136413574219  GigaBytes

connection checking time:  0.0603642463684082
block generation total time  0.06381559371948242
average batch blocks generation time:  0.015953898429870605
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.017062664031982422  GigaBytes
Max Memory Allocated: 0.017062664031982422  GigaBytes

torch.Size([8829, 500])
torch.Size([3146, 64])
torch.Size([852, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0208282470703125  GigaBytes
Max Memory Allocated: 0.021662235260009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019287109375  GigaBytes
Max Memory Allocated: 0.03544330596923828  GigaBytes

torch.Size([9869, 500])
torch.Size([3593, 64])
torch.Size([608, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.023099422454833984  GigaBytes
Max Memory Allocated: 0.03544330596923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02037668228149414  GigaBytes
Max Memory Allocated: 0.0385289192199707  GigaBytes

torch.Size([10064, 500])
torch.Size([2934, 64])
torch.Size([785, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.023807048797607422  GigaBytes
Max Memory Allocated: 0.0385289192199707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.018394947052001953  GigaBytes
Max Memory Allocated: 0.0385289192199707  GigaBytes

torch.Size([9140, 500])
torch.Size([2146, 64])
torch.Size([541, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.020900726318359375  GigaBytes
Max Memory Allocated: 0.0385289192199707  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010454058647155762 |0.0859140157699585 |0.19547194242477417 |0.0001639723777770996 |0.00449603796005249 |0.002581357955932617 |
----------------------------------------------------------pseudo_mini_loss sum 2.401447296142578
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  52863
Number of first layer input nodes during this epoch:  37902
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.01946401596069336  GigaBytes
Max Memory Allocated: 0.0385289192199707  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005090236663818359
random selection method range initialization spend 0.00010132789611816406
time for parepare:  4.7206878662109375e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.00543212890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0009784698486328125
generate_one_block  0.0013287067413330078
generate_one_block  0.0010542869567871094
generate_one_block  0.0010254383087158203
generate_one_block  0.0010251998901367188
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005178451538085938
gen group dst list time:  3.075599670410156e-05
time for parepare:  0.0002243518829345703
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002181529998779297
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.0002701282501220703
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00035572052001953125
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0004515647888183594
----------------------check_connections_block total spend ----------------------------- 0.002745389938354492
generate_one_block  0.0012574195861816406
generate_one_block  0.0013091564178466797
generate_one_block  0.0014562606811523438
generate_one_block  0.0015146732330322266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009903907775878906
gen group dst list time:  8.106231689453125e-05
time for parepare:  0.000720977783203125
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0005705356597900391
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.0010318756103515625
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.00017309188842773438
r_  generation:  0.0015773773193359375
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  0.00029158592224121094
r_  generation:  0.0027189254760742188
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.00024199485778808594
mini_batch_src_global generation:  0.00029349327087402344
r_  generation:  0.0026700496673583984
----------------------check_connections_block total spend ----------------------------- 0.013233184814453125
generate_one_block  0.0026586055755615234
generate_one_block  0.00290679931640625
generate_one_block  0.0044476985931396484
generate_one_block  0.004278421401977539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002078533172607422
gen group dst list time:  0.0002377033233642578
time for parepare:  0.0013515949249267578
local_output_nid generation:  0.0001652240753173828
local_in_edges_tensor generation:  0.000682830810546875
mini_batch_src_global generation:  0.0006270408630371094
r_  generation:  0.005341053009033203
local_output_nid generation:  0.00024819374084472656
local_in_edges_tensor generation:  0.0005578994750976562
mini_batch_src_global generation:  0.0009677410125732422
r_  generation:  0.007433176040649414
local_output_nid generation:  0.0002987384796142578
local_in_edges_tensor generation:  0.0006644725799560547
mini_batch_src_global generation:  0.0009222030639648438
r_  generation:  0.010075092315673828
local_output_nid generation:  0.000270843505859375
local_in_edges_tensor generation:  0.0006010532379150391
mini_batch_src_global generation:  0.0008223056793212891
r_  generation:  0.010209321975708008
----------------------check_connections_block total spend ----------------------------- 0.049480438232421875
generate_one_block  0.00865483283996582
generate_one_block  0.01103973388671875
generate_one_block  0.01457834243774414
generate_one_block  0.014152765274047852
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.01946401596069336  GigaBytes
Max Memory Allocated: 0.0385289192199707  GigaBytes

connection checking time:  0.06545901298522949
block generation total time  0.06825470924377441
average batch blocks generation time:  0.017063677310943604
block dataloader generation time/epoch 0.15772080421447754
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.015148639678955078  GigaBytes
Max Memory Allocated: 0.0385289192199707  GigaBytes

torch.Size([7382, 500])
torch.Size([1966, 64])
torch.Size([438, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.017408370971679688  GigaBytes
Max Memory Allocated: 0.0385289192199707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.021004199981689453  GigaBytes
Max Memory Allocated: 0.0385289192199707  GigaBytes

torch.Size([10100, 500])
torch.Size([2929, 64])
torch.Size([607, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.024248123168945312  GigaBytes
Max Memory Allocated: 0.0385289192199707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.023061275482177734  GigaBytes
Max Memory Allocated: 0.04223918914794922  GigaBytes

torch.Size([11248, 500])
torch.Size([3901, 64])
torch.Size([825, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.027400970458984375  GigaBytes
Max Memory Allocated: 0.04223918914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.023669719696044922  GigaBytes
Max Memory Allocated: 0.04480266571044922  GigaBytes

torch.Size([11862, 500])
torch.Size([3850, 64])
torch.Size([1008, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.028182506561279297  GigaBytes
Max Memory Allocated: 0.04480266571044922  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003929257392883301 |0.0008294582366943359 |0.004763305187225342 |0.0001455545425415039 |0.002902686595916748 |0.002088308334350586 |
----------------------------------------------------------pseudo_mini_loss sum 1.8319106101989746
Total (block generation + training)time/epoch 0.21652936935424805
Training time/epoch 0.058322906494140625
Training time without block to device /epoch 0.05500507354736328
Training time without total dataloading part /epoch 0.03333449363708496
load block tensor time/epoch 0.015717029571533203
block to device time/epoch 0.0033178329467773438
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  56473
Number of first layer input nodes during this epoch:  40592
