main start at this time 1648530520.998133
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003085136413574219  GigaBytes
Max Memory Allocated: 0.0003085136413574219  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005373954772949219
random selection method range initialization spend 0.00018477439880371094
time for parepare:  4.601478576660156e-05
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.0009605884552001953
----------------------check_connections_block total spend ----------------------------- 0.0013806819915771484
generate_one_block  0.001399993896484375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005927085876464844
gen group dst list time:  2.0265579223632812e-05
time for parepare:  0.00023627281188964844
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0011410713195800781
----------------------check_connections_block total spend ----------------------------- 0.0021042823791503906
generate_one_block  0.0027022361755371094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010137557983398438
gen group dst list time:  5.269050598144531e-05
time for parepare:  0.0006992816925048828
local_output_nid generation:  0.00017380714416503906
local_in_edges_tensor generation:  0.0005431175231933594
mini_batch_src_global generation:  0.0005526542663574219
r_  generation:  0.006561756134033203
----------------------check_connections_block total spend ----------------------------- 0.010533809661865234
generate_one_block  0.00971078872680664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001976490020751953
gen group dst list time:  0.000141143798828125
time for parepare:  0.0013043880462646484
local_output_nid generation:  0.0005121231079101562
local_in_edges_tensor generation:  0.001428365707397461
mini_batch_src_global generation:  0.0016298294067382812
r_  generation:  0.016965866088867188
----------------------check_connections_block total spend ----------------------------- 0.026542186737060547
generate_one_block  0.02512669563293457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003085136413574219  GigaBytes
Max Memory Allocated: 0.0003085136413574219  GigaBytes

connection checking time:  0.03918027877807617
block generation total time  0.03753972053527832
average batch blocks generation time:  0.03753972053527832
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.030490398406982422  GigaBytes
Max Memory Allocated: 0.030490398406982422  GigaBytes

torch.Size([15867, 500])
torch.Size([7971, 64])
torch.Size([2574, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.04035043716430664  GigaBytes
Max Memory Allocated: 0.04056692123413086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01234579086303711 |0.34665822982788086 |0.7667222023010254 |0.0002715587615966797 |0.010615825653076172 |0.0052835941314697266 |
----------------------------------------------------------pseudo_mini_loss sum 2.8057947158813477
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  26766
Number of first layer input nodes during this epoch:  15867
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.03280019760131836  GigaBytes
Max Memory Allocated: 0.04147911071777344  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0019121170043945312
random selection method range initialization spend 0.00012803077697753906
time for parepare:  5.91278076171875e-05
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00022101402282714844
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.0001354217529296875
----------------------check_connections_block total spend ----------------------------- 0.0005919933319091797
generate_one_block  0.0021479129791259766
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011591911315917969
gen group dst list time:  2.3126602172851562e-05
time for parepare:  0.0003008842468261719
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00027179718017578125
mini_batch_src_global generation:  0.0001666545867919922
r_  generation:  0.0014247894287109375
----------------------check_connections_block total spend ----------------------------- 0.002603292465209961
generate_one_block  0.0034852027893066406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011878013610839844
gen group dst list time:  7.414817810058594e-05
time for parepare:  0.0008718967437744141
local_output_nid generation:  0.0002460479736328125
local_in_edges_tensor generation:  0.0006639957427978516
mini_batch_src_global generation:  0.0007543563842773438
r_  generation:  0.007460355758666992
----------------------check_connections_block total spend ----------------------------- 0.012468814849853516
generate_one_block  0.009824752807617188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0016613006591796875
gen group dst list time:  0.00014781951904296875
time for parepare:  0.0013158321380615234
local_output_nid generation:  0.0005657672882080078
local_in_edges_tensor generation:  0.0013051033020019531
mini_batch_src_global generation:  0.0015034675598144531
r_  generation:  0.017377853393554688
----------------------check_connections_block total spend ----------------------------- 0.026993751525878906
generate_one_block  0.02236199378967285
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.03280019760131836  GigaBytes
Max Memory Allocated: 0.04147911071777344  GigaBytes

connection checking time:  0.04206585884094238
block generation total time  0.03567194938659668
average batch blocks generation time:  0.03567194938659668
block dataloader generation time/epoch 0.1455080509185791
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.031505584716796875  GigaBytes
Max Memory Allocated: 0.06043529510498047  GigaBytes

torch.Size([15922, 500])
torch.Size([7972, 64])
torch.Size([2580, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.04136991500854492  GigaBytes
Max Memory Allocated: 0.06043529510498047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012180089950561523 |0.000988006591796875 |0.004869222640991211 |0.00014591217041015625 |0.005060672760009766 |0.0019290447235107422 |
----------------------------------------------------------pseudo_mini_loss sum 1.6716614961624146
Total (block generation + training)time/epoch 0.17268872261047363
Training time/epoch 0.026725292205810547
Training time without block to device /epoch 0.025737285614013672Using backend: pytorch

Training time without total dataloading part /epoch 0.012004852294921875
load block tensor time/epoch 0.012180089950561523
block to device time/epoch 0.000988006591796875
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  26828
Number of first layer input nodes during this epoch:  15922
