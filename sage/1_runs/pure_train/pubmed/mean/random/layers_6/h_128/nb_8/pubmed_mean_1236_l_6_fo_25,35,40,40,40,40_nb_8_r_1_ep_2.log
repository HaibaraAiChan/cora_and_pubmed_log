main start at this time 1648533286.3546035
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.002031564712524414
random selection method range initialization spend 0.00017905235290527344
time for parepare:  4.363059997558594e-05
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.0011107921600341797
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.814697265625e-05
----------------------check_connections_block total spend ----------------------------- 0.0021452903747558594
generate_one_block  0.0012235641479492188
generate_one_block  0.001016378402709961
generate_one_block  0.0010037422180175781
generate_one_block  0.0010654926300048828
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012755393981933594
gen group dst list time:  3.0279159545898438e-05
time for parepare:  0.00022125244140625
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00030875205993652344
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.00027108192443847656
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0003192424774169922
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0003352165222167969
----------------------check_connections_block total spend ----------------------------- 0.0026848316192626953
generate_one_block  0.0014255046844482422
generate_one_block  0.0013737678527832031
generate_one_block  0.0014407634735107422
generate_one_block  0.0014297962188720703
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010371208190917969
gen group dst list time:  6.866455078125e-05
time for parepare:  0.00075531005859375
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.0003180503845214844
mini_batch_src_global generation:  0.00015473365783691406
r_  generation:  0.0016582012176513672
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.0002751350402832031
r_  generation:  0.001960277557373047
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.00022172927856445312
r_  generation:  0.0023603439331054688
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.0002238750457763672
r_  generation:  0.0021123886108398438
----------------------check_connections_block total spend ----------------------------- 0.013129711151123047
generate_one_block  0.003329753875732422
generate_one_block  0.003583192825317383
generate_one_block  0.0039958953857421875
generate_one_block  0.0037221908569335938
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002028942108154297
gen group dst list time:  0.00021338462829589844
time for parepare:  0.0014677047729492188
local_output_nid generation:  0.0002162456512451172
local_in_edges_tensor generation:  0.0008237361907958984
mini_batch_src_global generation:  0.0009407997131347656
r_  generation:  0.007985830307006836
local_output_nid generation:  0.00020647048950195312
local_in_edges_tensor generation:  0.000993490219116211
mini_batch_src_global generation:  0.0010271072387695312
r_  generation:  0.0076351165771484375
local_output_nid generation:  0.0002522468566894531
local_in_edges_tensor generation:  0.0005474090576171875
mini_batch_src_global generation:  0.0008552074432373047
r_  generation:  0.009551286697387695
local_output_nid generation:  0.00028252601623535156
local_in_edges_tensor generation:  0.0006048679351806641
mini_batch_src_global generation:  0.0007870197296142578
r_  generation:  0.010335206985473633
----------------------check_connections_block total spend ----------------------------- 0.05336618423461914
generate_one_block  0.012130260467529297
generate_one_block  0.01152491569519043
generate_one_block  0.013854503631591797
generate_one_block  0.014985799789428711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018696784973144531
gen group dst list time:  0.0008132457733154297
time for parepare:  0.0017142295837402344
local_output_nid generation:  0.0009233951568603516
local_in_edges_tensor generation:  0.0020294189453125
mini_batch_src_global generation:  0.0017921924591064453
r_  generation:  0.01934671401977539
local_output_nid generation:  0.0007381439208984375
local_in_edges_tensor generation:  0.0015630722045898438
mini_batch_src_global generation:  0.002006053924560547
r_  generation:  0.01742076873779297
local_output_nid generation:  0.0008337497711181641
local_in_edges_tensor generation:  0.0016565322875976562
mini_batch_src_global generation:  0.0017664432525634766
r_  generation:  0.019159317016601562
local_output_nid generation:  0.0009753704071044922
local_in_edges_tensor generation:  0.0016777515411376953
mini_batch_src_global generation:  0.0018489360809326172
r_  generation:  0.02097010612487793
----------------------check_connections_block total spend ----------------------------- 0.11384725570678711
generate_one_block  0.025081634521484375
generate_one_block  0.024567604064941406
generate_one_block  0.025369644165039062
generate_one_block  0.028748750686645508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020151138305664062
gen group dst list time:  0.001405954360961914
time for parepare:  0.0015704631805419922
local_output_nid generation:  0.0014195442199707031
local_in_edges_tensor generation:  0.002689838409423828
mini_batch_src_global generation:  0.0020356178283691406
r_  generation:  0.024833202362060547
local_output_nid generation:  0.0013387203216552734
local_in_edges_tensor generation:  0.0024547576904296875
mini_batch_src_global generation:  0.002521514892578125
r_  generation:  0.023957252502441406
local_output_nid generation:  0.0015101432800292969
local_in_edges_tensor generation:  0.002260446548461914
mini_batch_src_global generation:  0.0022377967834472656
r_  generation:  0.02475595474243164
local_output_nid generation:  0.001519918441772461
local_in_edges_tensor generation:  0.0025048255920410156
mini_batch_src_global generation:  0.002118349075317383
r_  generation:  0.025545835494995117
----------------------check_connections_block total spend ----------------------------- 0.14619159698486328
generate_one_block  0.029670238494873047
generate_one_block  0.031226158142089844
generate_one_block  0.03163480758666992
generate_one_block  0.032735347747802734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

connection checking time:  0.3292195796966553
block generation total time  0.301830530166626
average batch blocks generation time:  0.0754576325416565
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.03778076171875  GigaBytes
Max Memory Allocated: 0.03778076171875  GigaBytes

torch.Size([19036, 500])
torch.Size([16391, 128])
torch.Size([11084, 128])
torch.Size([2856, 128])
torch.Size([723, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.09560108184814453  GigaBytes
Max Memory Allocated: 0.09618234634399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.038411617279052734  GigaBytes
Max Memory Allocated: 0.09881114959716797  GigaBytes

torch.Size([18648, 500])
torch.Size([15169, 128])
torch.Size([9112, 128])
torch.Size([2556, 128])
torch.Size([615, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.0890493392944336  GigaBytes
Max Memory Allocated: 0.09881114959716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.03833913803100586  GigaBytes
Max Memory Allocated: 0.09881114959716797  GigaBytes

torch.Size([18778, 500])
torch.Size([16287, 128])
torch.Size([10562, 128])
torch.Size([3552, 128])
torch.Size([740, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.09691858291625977  GigaBytes
Max Memory Allocated: 0.09881114959716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4569091796875 GB
    Memory Allocated: 0.039019107818603516  GigaBytes
Max Memory Allocated: 0.09881114959716797  GigaBytes

torch.Size([19118, 500])
torch.Size([17313, 128])
torch.Size([11951, 128])
torch.Size([3819, 128])
torch.Size([788, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4569091796875 GB
    Memory Allocated: 0.10235738754272461  GigaBytes
Max Memory Allocated: 0.10291671752929688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011575043201446533 |0.08753693103790283 |0.19710177183151245 |0.00016963481903076172 |0.0065582990646362305 |0.004827260971069336 |
----------------------------------------------------------pseudo_mini_loss sum 2.1489014625549316
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  199455
Number of first layer input nodes during this epoch:  75580
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.04420042037963867  GigaBytes
Max Memory Allocated: 0.10585784912109375  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006301403045654297
random selection method range initialization spend 0.00014972686767578125
time for parepare:  6.794929504394531e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  5.626678466796875e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.91278076171875e-05
----------------------check_connections_block total spend ----------------------------- 0.0012156963348388672
generate_one_block  0.0013365745544433594
generate_one_block  0.0012819766998291016
generate_one_block  0.0013816356658935547
generate_one_block  0.0012955665588378906
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006296634674072266
gen group dst list time:  4.38690185546875e-05
time for parepare:  0.00037217140197753906
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  7.748603820800781e-05
r_  generation:  0.0004532337188720703
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.00026535987854003906
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00021505355834960938
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0006620883941650391
----------------------check_connections_block total spend ----------------------------- 0.0034978389739990234
generate_one_block  0.0018324851989746094
generate_one_block  0.001516103744506836
generate_one_block  0.0014836788177490234
generate_one_block  0.002060413360595703
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011930465698242188
gen group dst list time:  0.0001068115234375
time for parepare:  0.0011112689971923828
local_output_nid generation:  9.894371032714844e-05
local_in_edges_tensor generation:  0.00037598609924316406
mini_batch_src_global generation:  0.0003581047058105469
r_  generation:  0.0030345916748046875
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.0013170242309570312
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00021600723266601562
mini_batch_src_global generation:  0.000148773193359375
r_  generation:  0.0011909008026123047
local_output_nid generation:  0.00011658668518066406
local_in_edges_tensor generation:  0.000316619873046875
mini_batch_src_global generation:  0.0004360675811767578
r_  generation:  0.004267692565917969
----------------------check_connections_block total spend ----------------------------- 0.016381025314331055
generate_one_block  0.004792690277099609
generate_one_block  0.0022144317626953125
generate_one_block  0.0020859241485595703
generate_one_block  0.005461931228637695
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018939971923828125
gen group dst list time:  0.00032138824462890625
time for parepare:  0.0017781257629394531
local_output_nid generation:  0.0004410743713378906
local_in_edges_tensor generation:  0.0010166168212890625
mini_batch_src_global generation:  0.0013654232025146484
r_  generation:  0.014872074127197266
local_output_nid generation:  0.00017452239990234375
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.0007493495941162109
r_  generation:  0.005624294281005859
local_output_nid generation:  0.00014972686767578125
local_in_edges_tensor generation:  0.0003902912139892578
mini_batch_src_global generation:  0.0005474090576171875
r_  generation: Using backend: pytorch
 0.005399227142333984
local_output_nid generation:  0.0003657341003417969
local_in_edges_tensor generation:  0.0007145404815673828
mini_batch_src_global generation:  0.0012216567993164062
r_  generation:  0.012717723846435547
----------------------check_connections_block total spend ----------------------------- 0.057854413986206055
generate_one_block  0.01741313934326172
generate_one_block  0.009385347366333008
generate_one_block  0.00929117202758789
generate_one_block  0.01619887351989746
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017938613891601562
gen group dst list time:  0.0008578300476074219
time for parepare:  0.0016782283782958984
local_output_nid generation:  0.0012285709381103516
local_in_edges_tensor generation:  0.0024504661560058594
mini_batch_src_global generation:  0.002255678176879883
r_  generation:  0.02362513542175293
local_output_nid generation:  0.0009577274322509766
local_in_edges_tensor generation:  0.0012786388397216797
mini_batch_src_global generation:  0.0021729469299316406
r_  generation:  0.018206357955932617
local_output_nid generation:  0.000993967056274414
local_in_edges_tensor generation:  0.0012655258178710938
mini_batch_src_global generation:  0.0014412403106689453
r_  generation:  0.017951488494873047
local_output_nid generation:  0.0012989044189453125
local_in_edges_tensor generation:  0.0018339157104492188
mini_batch_src_global generation:  0.0020835399627685547
r_  generation:  0.02206730842590332
----------------------check_connections_block total spend ----------------------------- 0.12198519706726074
generate_one_block  0.02735757827758789
generate_one_block  0.02438187599182129
generate_one_block  0.02291703224182129
generate_one_block  0.03084421157836914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018558502197265625
gen group dst list time:  0.0015187263488769531
time for parepare:  0.0017638206481933594
local_output_nid generation:  0.0015366077423095703
local_in_edges_tensor generation:  0.002681255340576172
mini_batch_src_global generation:  0.002237081527709961
r_  generation:  0.026253700256347656
local_output_nid generation:  0.0019276142120361328
local_in_edges_tensor generation:  0.002501964569091797
mini_batch_src_global generation:  0.0027337074279785156
r_  generation:  0.024883747100830078
local_output_nid generation:  0.0018122196197509766
local_in_edges_tensor generation:  0.0020093917846679688
mini_batch_src_global generation:  0.002002239227294922
r_  generation:  0.024244070053100586
local_output_nid generation:  0.0020439624786376953
local_in_edges_tensor generation:  0.0027437210083007812
mini_batch_src_global generation:  0.002198457717895508
r_  generation:  0.02686023712158203
----------------------check_connections_block total spend ----------------------------- 0.15233278274536133
generate_one_block  0.03042125701904297
generate_one_block  0.031583547592163086
generate_one_block  0.030414819717407227
generate_one_block  0.03209972381591797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.04420042037963867  GigaBytes
Max Memory Allocated: 0.10585784912109375  GigaBytes

connection checking time:  0.3520512580871582
block generation total time  0.3037562370300293
average batch blocks generation time:  0.07593905925750732
block dataloader generation time/epoch 0.7096281051635742
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.04098987579345703  GigaBytes
Max Memory Allocated: 0.10585784912109375  GigaBytes

torch.Size([19107, 500])
torch.Size([17112, 128])
torch.Size([12815, 128])
torch.Size([3923, 128])
torch.Size([881, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.10617828369140625  GigaBytes
Max Memory Allocated: 0.10641098022460938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.0402369499206543  GigaBytes
Max Memory Allocated: 0.1084132194519043  GigaBytes

torch.Size([18717, 500])
torch.Size([15242, 128])
torch.Size([8504, 128])
torch.Size([1942, 128])
torch.Size([415, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.08741426467895508  GigaBytes
Max Memory Allocated: 0.1084132194519043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.03973388671875  GigaBytes
Max Memory Allocated: 0.1084132194519043  GigaBytes

torch.Size([18617, 500])
torch.Size([14532, 128])
torch.Size([8401, 128])
torch.Size([1661, 128])
torch.Size([409, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.0863037109375  GigaBytes
Max Memory Allocated: 0.1084132194519043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.04090690612792969  GigaBytes
Max Memory Allocated: 0.1084132194519043  GigaBytes

torch.Size([19048, 500])
torch.Size([17295, 128])
torch.Size([11653, 128])
torch.Size([4598, 128])
torch.Size([1101, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.10700654983520508  GigaBytes
Max Memory Allocated: 0.1084132194519043  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014774501323699951 |0.0019236207008361816 |0.006995856761932373 |0.00014191865921020508 |0.004332125186920166 |0.003538370132446289 |
----------------------------------------------------------pseudo_mini_loss sum 2.0557522773742676
Total (block generation + training)time/epoch 0.8331999778747559
Training time/epoch 0.12298965454101562
Training time without block to device /epoch 0.1152951717376709
Training time without total dataloading part /epoch 0.049417972564697266
load block tensor time/epoch 0.059098005294799805
block to device time/epoch 0.0076944828033447266
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  196329
Number of first layer input nodes during this epoch:  75489
