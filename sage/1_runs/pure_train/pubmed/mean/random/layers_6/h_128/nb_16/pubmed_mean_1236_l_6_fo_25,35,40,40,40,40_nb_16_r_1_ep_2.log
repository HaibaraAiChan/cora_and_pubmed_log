main start at this time 1648533298.0341089
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0026535987854003906
random selection method range initialization spend 0.00023317337036132812
time for parepare:  4.57763671875e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0011420249938964844
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5497207641601562e-05
----------------------check_connections_block total spend ----------------------------- 0.0028543472290039062
generate_one_block  0.0016865730285644531
generate_one_block  0.0010960102081298828
generate_one_block  0.0010333061218261719
generate_one_block  0.001007080078125
generate_one_block  0.0010106563568115234
generate_one_block  0.0010671615600585938
generate_one_block  0.0010411739349365234
generate_one_block  0.000989675521850586
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0015761852264404297
gen group dst list time:  5.125999450683594e-05
time for parepare:  0.00024175643920898438
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001652240753173828
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002110004425048828
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  9.1552734375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0002288818359375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0002541542053222656
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00012350082397460938
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00024628639221191406
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  7.367134094238281e-05
----------------------check_connections_block total spend ----------------------------- 0.0035066604614257812
generate_one_block  0.0012052059173583984
generate_one_block  0.0012845993041992188
generate_one_block  0.0010950565338134766
generate_one_block  0.0013544559478759766
generate_one_block  0.0013103485107421875
generate_one_block  0.0011749267578125
generate_one_block  0.001355886459350586
generate_one_block  0.0010683536529541016
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001196146011352539
gen group dst list time:  9.5367431640625e-05
time for parepare:  0.0007655620574951172
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00024700164794921875
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0006797313690185547
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0012156963348388672
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0004425048828125
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  0.000152587890625
r_  generation:  0.0015652179718017578
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  0.00019669532775878906
r_  generation:  0.00179290771484375
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.0009083747863769531
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.0016205310821533203
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  9.679794311523438e-05
r_  generation:  0.0005784034729003906
----------------------check_connections_block total spend ----------------------------- 0.01464533805847168
generate_one_block  0.0021219253540039062
generate_one_block  0.002437591552734375
generate_one_block  0.0015773773193359375
generate_one_block  0.002943754196166992
generate_one_block  0.003275632858276367
generate_one_block  0.002155303955078125
generate_one_block  0.002960205078125
generate_one_block  0.0016219615936279297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021996498107910156
gen group dst list time:  0.00025463104248046875
time for parepare:  0.00154876708984375
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.0005962848663330078
mini_batch_src_global generation:  0.0004563331604003906
r_  generation:  0.0036613941192626953
local_output_nid generation:  0.0001609325408935547
local_in_edges_tensor generation:  0.0004146099090576172
mini_batch_src_global generation:  0.0007414817810058594
r_  generation:  0.005829334259033203
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.00025081634521484375
mini_batch_src_global generation:  0.00032782554626464844
r_  generation:  0.002573251724243164
local_output_nid generation:  0.00016546249389648438
local_in_edges_tensor generation:  0.00041174888610839844
mini_batch_src_global generation:  0.0005466938018798828
r_  generation:  0.006064653396606445
local_output_nid generation:  0.0001773834228515625
local_in_edges_tensor generation:  0.0004496574401855469
mini_batch_src_global generation:  0.0008392333984375
r_  generation:  0.007265329360961914
local_output_nid generation:  0.00016117095947265625
local_in_edges_tensor generation:  0.0003790855407714844
mini_batch_src_global generation:  0.0005948543548583984
r_  generation:  0.005720615386962891
local_output_nid generation:  0.0002067089080810547
local_in_edges_tensor generation:  0.0004703998565673828
mini_batch_src_global generation:  0.0007429122924804688
r_  generation:  0.00749969482421875
local_output_nid generation:  9.775161743164062e-05
local_in_edges_tensor generation:  0.00027680397033691406
mini_batch_src_global generation:  0.0005199909210205078
r_  generation:  0.004215240478515625
----------------------check_connections_block total spend ----------------------------- 0.06475019454956055
generate_one_block  0.0060198307037353516
generate_one_block  0.009087800979614258
generate_one_block  0.0042324066162109375
generate_one_block  0.008891105651855469
generate_one_block  0.010984182357788086
generate_one_block  0.008702754974365234
generate_one_block  0.011148691177368164
generate_one_block  0.006509304046630859
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021965503692626953
gen group dst list time:  0.001299142837524414
time for parepare:  0.001873016357421875
local_output_nid generation:  0.0004773139953613281
local_in_edges_tensor generation:  0.0014195442199707031
mini_batch_src_global generation:  0.001294851303100586
r_  generation:  0.011775970458984375
local_output_nid generation:  0.0007927417755126953
local_in_edges_tensor generation:  0.0018024444580078125
mini_batch_src_global generation:  0.0017175674438476562
r_  generation:  0.0158236026763916
local_output_nid generation:  0.00043654441833496094
local_in_edges_tensor generation:  0.0007443428039550781
mini_batch_src_global generation:  0.001071929931640625
r_  generation:  0.010884523391723633
local_output_nid generation:  0.00055694580078125
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.0010921955108642578
r_  generation:  0.014463663101196289
local_output_nid generation:  0.0006582736968994141
local_in_edges_tensor generation:  0.0014276504516601562
mini_batch_src_global generation:  0.001573324203491211
r_  generation:  0.01701951026916504
local_output_nid generation:  0.00074005126953125
local_in_edges_tensor generation:  0.0012311935424804688
mini_batch_src_global generation:  0.001527547836303711
r_  generation:  0.01729607582092285
local_output_nid generation:  0.0008614063262939453
local_in_edges_tensor generation:  0.0013935565948486328
mini_batch_src_global generation:  0.0017209053039550781
r_  generation:  0.019711732864379883
local_output_nid generation:  0.00047659873962402344
local_in_edges_tensor generation:  0.0008103847503662109
mini_batch_src_global generation:  0.0012407302856445312
r_  generation:  0.011781454086303711
----------------------check_connections_block total spend ----------------------------- 0.1741189956665039
generate_one_block  0.017399311065673828
generate_one_block  0.020722150802612305
generate_one_block  0.014610528945922852
generate_one_block  0.01928400993347168
generate_one_block  0.021929264068603516
generate_one_block  0.022911548614501953
generate_one_block  0.02559065818786621
generate_one_block  0.01542210578918457
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001832723617553711
gen group dst list time:  0.0024614334106445312
time for parepare:  0.0017669200897216797
local_output_nid generation:  0.0010483264923095703
local_in_edges_tensor generation:  0.0020241737365722656
mini_batch_src_global generation:  0.0017647743225097656
r_  generation:  0.018932580947875977
local_output_nid generation:  0.001219034194946289
local_in_edges_tensor generation:  0.0020895004272460938
mini_batch_src_global generation:  0.0026733875274658203
r_  generation:  0.022851943969726562
local_output_nid generation:  0.0010328292846679688
local_in_edges_tensor generation:  0.0017476081848144531
mini_batch_src_global generation:  0.001680135726928711
r_  generation:  0.02036452293395996
local_output_nid generation:  0.001262664794921875
local_in_edges_tensor generation:  0.004044532775878906
mini_batch_src_global generation:  0.0020329952239990234
r_  generation:  0.021607398986816406
local_output_nid generation:  0.0012161731719970703
local_in_edges_tensor generation:  0.00214385986328125
mini_batch_src_global generation:  0.0017178058624267578
r_  generation:  0.02249455451965332
local_output_nid generation:  0.001516580581665039
local_in_edges_tensor generation:  0.0025453567504882812
mini_batch_src_global generation:  0.0019140243530273438
r_  generation:  0.024089813232421875
local_output_nid generation:  0.0014240741729736328
local_in_edges_tensor generation:  0.0022008419036865234
mini_batch_src_global generation:  0.0019621849060058594
r_  generation:  0.025320768356323242
local_output_nid generation:  0.0009396076202392578
local_in_edges_tensor generation:  0.0015540122985839844
mini_batch_src_global generation:  0.0017173290252685547
r_  generation:  0.019224166870117188
----------------------check_connections_block total spend ----------------------------- 0.25719356536865234
generate_one_block  0.02417445182800293
generate_one_block  0.029900312423706055
generate_one_block  0.02689218521118164
generate_one_block  0.027074813842773438
generate_one_block  0.028380393981933594
generate_one_block  0.030588865280151367
generate_one_block  0.030662059783935547
generate_one_block  0.024638652801513672
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

connection checking time:  0.5142147541046143
block generation total time  0.4746999740600586
average batch blocks generation time:  0.059337496757507324
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.03186845779418945  GigaBytes
Max Memory Allocated: 0.03186845779418945  GigaBytes

torch.Size([16103, 500])
torch.Size([10821, 128])
torch.Size([4969, 128])
torch.Size([1242, 128])
torch.Size([249, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.06327152252197266  GigaBytes
Max Memory Allocated: 0.06329631805419922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.03821992874145508  GigaBytes
Max Memory Allocated: 0.06710577011108398  GigaBytes

torch.Size([18714, 500])
torch.Size([14254, 128])
torch.Size([8927, 128])
torch.Size([1938, 128])
torch.Size([519, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.08539867401123047  GigaBytes
Max Memory Allocated: 0.08554553985595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.0359959602355957  GigaBytes
Max Memory Allocated: 0.08906078338623047  GigaBytes

torch.Size([17388, 500])
torch.Size([10981, 128])
torch.Size([4911, 128])
torch.Size([744, 128])
torch.Size([205, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.0660867691040039  GigaBytes
Max Memory Allocated: 0.08906078338623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.03504800796508789  GigaBytes
Max Memory Allocated: 0.08906078338623047  GigaBytes

torch.Size([17176, 500])
torch.Size([12644, 128])
torch.Size([6348, 128])
torch.Size([1877, 128])
torch.Size([398, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.07347774505615234  GigaBytes
Max Memory Allocated: 0.08906078338623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.036665916442871094  GigaBytes
Max Memory Allocated: 0.08906078338623047  GigaBytes

torch.Size([17982, 500])
torch.Size([13671, 128])
torch.Size([8313, 128])
torch.Size([2439, 128])
torch.Size([512, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.08244848251342773  GigaBytes
Max Memory Allocated: 0.08906078338623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.03829240798950195  GigaBytes
Max Memory Allocated: 0.08906078338623047  GigaBytes

torch.Size([18502, 500])
torch.Size([15379, 128])
torch.Size([7968, 128])
torch.Size([1986, 128])
torch.Size([294, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.0843358039855957  GigaBytes
Max Memory Allocated: 0.08906078338623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.03874778747558594  GigaBytes
Max Memory Allocated: 0.08906078338623047  GigaBytes

torch.Size([19047, 500])
torch.Size([16628, 128])
torch.Size([10236, 128])
torch.Size([2889, 128])
torch.Size([594, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.09475183486938477  GigaBytes
Max Memory Allocated: 0.09563064575195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.03310346603393555  GigaBytes
Max Memory Allocated: 0.09727001190185547  GigaBytes

torch.Size([16241, 500])
torch.Size([10027, 128])
torch.Size([5047, 128])
torch.Size([1167, 128])
torch.Size([137, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.06298208236694336  GigaBytes
Max Memory Allocated: 0.09727001190185547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011626601219177246 |0.04408898949623108 |0.10363399982452393 |0.00018155574798583984 |0.0056171715259552 |0.00407099723815918 |
----------------------------------------------------------pseudo_mini_loss sum 2.0039966106414795
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  319824
Number of first layer input nodes during this epoch:  141153
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.03703022003173828  GigaBytes
Max Memory Allocated: 0.09727001190185547  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005095005035400391
random selection method range initialization spend 0.00011587142944335938
time for parepare:  4.982948303222656e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.6689300537109375e-05
----------------------check_connections_block total spend ----------------------------- 0.0016193389892578125
generate_one_block  0.0010762214660644531
generate_one_block  0.0010447502136230469
generate_one_block  0.0010340213775634766
generate_one_block  0.0010178089141845703
generate_one_block  0.0010128021240234375
generate_one_block  0.0011620521545410156
generate_one_block  0.001047372817993164
generate_one_block  0.001009225845336914
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005333423614501953
gen group dst list time:  5.054473876953125e-05
time for parepare:  0.00027298927307128906
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00015401840209960938
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.000240325927734375
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00012826919555664062
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00010251998901367188
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00014901161193847656
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.000446319580078125
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  8.416175842285156e-05
----------------------check_connections_block total spend ----------------------------- 0.0034847259521484375
generate_one_block  0.001237630844116211
generate_one_block  0.001323699951171875
generate_one_block  0.0011513233184814453
generate_one_block  0.0011420249938964844
generate_one_block  0.0010859966278076172
generate_one_block  0.0011966228485107422
generate_one_block  0.001589059829711914
generate_one_block  0.0010848045349121094
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011777877807617188
gen group dst list time:  0.00010371208190917969
time for parepare:  0.0007901191711425781
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00029921531677246094
mini_batch_src_global generation:  0.00012612342834472656
r_  generation:  0.0010156631469726562
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.000213623046875
r_  generation:  0.0017275810241699219
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0005207061767578125
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0005805492401123047
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0004169940948486328
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0007467269897460938
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.0002391338348388672
mini_batch_src_global generation:  0.0002570152282714844
r_  generation:  0.0028879642486572266
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  0.00013685226440429688
r_  generation:  0.0006554126739501953
----------------------check_connections_block total spend ----------------------------- 0.014527559280395508
generate_one_block  0.0029473304748535156
generate_one_block  0.0030388832092285156
generate_one_block  0.001512765884399414
generate_one_block  0.0016324520111083984
generate_one_block  0.001451253890991211
generate_one_block  0.0018105506896972656
generate_one_block  0.004591703414916992
generate_one_block  0.0017359256744384766
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020210742950439453
gen group dst list time:  0.0002720355987548828
time for parepare:  0.0014872550964355469
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.0006799697875976562
mini_batch_src_global generation:  0.0005834102630615234
r_  generation:  0.005733013153076172
local_output_nid generation:  0.0002357959747314453
local_in_edges_tensor generation:  0.0006680488586425781
mini_batch_src_global generation:  0.0011141300201416016
r_  generation:  0.00930023193359375
local_output_nid generation:  8.249282836914062e-05
local_in_edges_tensor generation:  0.00023627281188964844
mini_batch_src_global generation:  0.00040435791015625
r_  generation:  0.004013538360595703
local_output_nid generation:  0.00011396408081054688
local_in_edges_tensor generation:  0.0002853870391845703
mini_batch_src_global generation:  0.0003619194030761719
r_  generation:  0.0035147666931152344
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  0.000335693359375
r_  generation:  0.0029647350311279297
local_output_nid generation:  0.00011372566223144531
local_in_edges_tensor generation:  0.0002765655517578125
mini_batch_src_global generation:  0.00036406517028808594
r_  generation:  0.003717184066772461
local_output_nid generation:  0.0002410411834716797
local_in_edges_tensor generation:  0.0004975795745849609
mini_batch_src_global generation:  0.0007486343383789062
r_  generation:  0.008546829223632812
local_output_nid generation:  0.0001354217529296875
local_in_edges_tensor generation:  0.0003116130828857422
mini_batch_src_global generation:  0.0005326271057128906
r_  generation:  0.0042285919189453125
----------------------check_connections_block total spend ----------------------------- 0.062325477600097656
generate_one_block  0.009187698364257812
generate_one_block  0.01306915283203125
generate_one_block  0.004278898239135742
generate_one_block  0.005625009536743164
generate_one_block  0.004963397979736328
generate_one_block  0.006040811538696289
generate_one_block  0.013208389282226562
generate_one_block  0.006426572799682617
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00228118896484375
gen group dst list time:  0.0010886192321777344
time for parepare:  0.0016489028930664062
local_output_nid generation:  0.0007741451263427734
local_in_edges_tensor generation:  0.001764535903930664
mini_batch_src_global generation:  0.0034644603729248047
r_  generation:  0.01733541488647461
local_output_nid generation:  0.0009565353393554688
local_in_edges_tensor generation:  0.0019071102142333984
mini_batch_src_global generation:  0.002442598342895508
r_  generation:  0.02060246467590332
local_output_nid generation:  0.0004684925079345703
local_in_edges_tensor generation:  0.0007295608520507812
mini_batch_src_global generation:  0.0009784698486328125
r_  generation:  0.008923053741455078
local_output_nid generation:  0.0005419254302978516
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.001150369644165039
r_  generation:  0.013791799545288086
local_output_nid generation:  0.00046133995056152344
local_in_edges_tensor generation:  0.0006947517395019531
mini_batch_src_global generation:  0.0009186267852783203
r_  generation:  0.0121612548828125
local_output_nid generation:  0.0006494522094726562
local_in_edges_tensor generation:  0.0009362697601318359
mini_batch_src_global generation:  0.0009813308715820312
r_  generation:  0.01408839225769043
local_output_nid generation:  0.0008275508880615234
local_in_edges_tensor generation:  0.0014603137969970703
mini_batch_src_global generation:  0.001611948013305664
r_  generation:  0.018536090850830078
local_output_nid generation:  0.0006148815155029297
local_in_edges_tensor generation:  0.0010635852813720703
mini_batch_src_global generation:  0.0014183521270751953
r_  generation:  0.015081405639648438
----------------------check_connections_block total spend ----------------------------- 0.17824983596801758
generate_one_block  0.0216062068939209
generate_one_block  0.027637243270874023
generate_one_block  0.012839794158935547
generate_one_block  0.017575502395629883
generate_one_block  0.015415191650390625
generate_one_block  0.018669843673706055
generate_one_block  0.02616405487060547
generate_one_block  0.020317554473876953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017712116241455078
gen group dst list time:  0.0026311874389648438
time for parepare:  0.0018367767333984375
local_output_nid generation:  0.0014088153839111328
local_in_edges_tensor generation:  0.0025205612182617188
mini_batch_src_global generation:  0.0020570755004882812
r_  generation:  0.023294448852539062
local_output_nid generation:  0.0014209747314453125
local_in_edges_tensor generation:  0.002536296844482422
mini_batch_src_global generation:  0.0026369094848632812
r_  generation:  0.024758100509643555
local_output_nid generation:  0.0010991096496582031
local_in_edges_tensor generation:  0.0015728473663330078
mini_batch_src_global generation:  0.0017712116241455078
r_  generation:  0.019561290740966797
local_output_nid generation:  0.0013082027435302734
local_in_edges_tensor generation:  0.0020694732666015625
mini_batch_src_global generation:  0.0018994808197021484
r_  generation:  0.022244691848754883
local_output_nid generation:  0.0010933876037597656
local_in_edges_tensor generation:  0.0015709400177001953
mini_batch_src_global generation:  0.0016219615936279297
r_  generation:  0.0201113224029541
local_output_nid generation:  0.0013344287872314453
local_in_edges_tensor generation:  0.0017943382263183594
mini_batch_src_global generation:  0.0017282962799072266
r_  generation:  0.022780179977416992
local_output_nid generation:  0.0016558170318603516
local_in_edges_tensor generation:  0.00228118896484375
mini_batch_src_global generation: Using backend: pytorch
 0.0019910335540771484
r_  generation:  0.024728775024414062
local_output_nid generation:  0.0013651847839355469
local_in_edges_tensor generation:  0.0019385814666748047
mini_batch_src_global generation:  0.0018925666809082031
r_  generation:  0.023062705993652344
----------------------check_connections_block total spend ----------------------------- 0.2644307613372803
generate_one_block  0.029472827911376953
generate_one_block  0.03204083442687988
generate_one_block  0.0274965763092041
generate_one_block  0.028593063354492188
generate_one_block  0.02667236328125
generate_one_block  0.028385639190673828
generate_one_block  0.031141996383666992
generate_one_block  0.028318405151367188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.03703022003173828  GigaBytes
Max Memory Allocated: 0.09727001190185547  GigaBytes

connection checking time:  0.5230183601379395
block generation total time  0.48367905616760254
average batch blocks generation time:  0.06045988202095032
block dataloader generation time/epoch 1.073070764541626
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.038950443267822266  GigaBytes
Max Memory Allocated: 0.09727001190185547  GigaBytes

torch.Size([18205, 500])
torch.Size([14368, 128])
torch.Size([7944, 128])
torch.Size([1750, 128])
torch.Size([362, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.08332204818725586  GigaBytes
Max Memory Allocated: 0.09727001190185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.040514469146728516  GigaBytes
Max Memory Allocated: 0.09727001190185547  GigaBytes

torch.Size([18926, 500])
torch.Size([16168, 128])
torch.Size([11109, 128])
torch.Size([2795, 128])
torch.Size([549, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.09721946716308594  GigaBytes
Max Memory Allocated: 0.09812211990356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.036518096923828125  GigaBytes
Max Memory Allocated: 0.10113525390625  GigaBytes

torch.Size([17099, 500])
torch.Size([10430, 128])
torch.Size([4732, 128])
torch.Size([898, 128])
torch.Size([235, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.06624555587768555  GigaBytes
Max Memory Allocated: 0.10113525390625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.0380854606628418  GigaBytes
Max Memory Allocated: 0.10113525390625  GigaBytes

torch.Size([17822, 500])
torch.Size([12875, 128])
torch.Size([5465, 128])
torch.Size([1097, 128])
torch.Size([198, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.07336664199829102  GigaBytes
Max Memory Allocated: 0.10113525390625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.03610038757324219  GigaBytes
Max Memory Allocated: 0.10113525390625  GigaBytes

torch.Size([16830, 500])
torch.Size([10394, 128])
torch.Size([4406, 128])
torch.Size([805, 128])
torch.Size([135, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.06469392776489258  GigaBytes
Max Memory Allocated: 0.10113525390625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.03850984573364258  GigaBytes
Max Memory Allocated: 0.10113525390625  GigaBytes

torch.Size([18049, 500])
torch.Size([13102, 128])
torch.Size([6637, 128])
torch.Size([1295, 128])
torch.Size([346, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.0775442123413086  GigaBytes
Max Memory Allocated: 0.10113525390625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.04039907455444336  GigaBytes
Max Memory Allocated: 0.10113525390625  GigaBytes

torch.Size([18584, 500])
torch.Size([15333, 128])
torch.Size([9286, 128])
torch.Size([3201, 128])
torch.Size([869, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.09300661087036133  GigaBytes
Max Memory Allocated: 0.10113525390625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.038144588470458984  GigaBytes
Max Memory Allocated: 0.10113525390625  GigaBytes

torch.Size([17693, 500])
torch.Size([13966, 128])
torch.Size([5980, 128])
torch.Size([1501, 128])
torch.Size([144, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.07700872421264648  GigaBytes
Max Memory Allocated: 0.10113525390625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013210713863372803 |0.002042621374130249 |0.0068968236446380615 |0.00013759732246398926 |0.005267590284347534 |0.006215810775756836 |
----------------------------------------------------------pseudo_mini_loss sum 2.000648021697998
Total (block generation + training)time/epoch 1.3129043579101562
Training time/epoch 0.23928165435791016
Training time without block to device /epoch 0.22294068336486816
Training time without total dataloading part /epoch 0.10463190078735352
load block tensor time/epoch 0.10568571090698242
block to device time/epoch 0.016340970993041992
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  321939
Number of first layer input nodes during this epoch:  143208
