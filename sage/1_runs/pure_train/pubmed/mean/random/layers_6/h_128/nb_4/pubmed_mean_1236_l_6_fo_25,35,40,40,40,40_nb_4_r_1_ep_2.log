main start at this time 1648533275.5212848
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005853176116943359
random selection method range initialization spend 0.00019240379333496094
time for parepare:  4.506111145019531e-05
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.001039266586303711
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  6.461143493652344e-05
----------------------check_connections_block total spend ----------------------------- 0.0017762184143066406
generate_one_block  0.0016298294067382812
generate_one_block  0.001115560531616211
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005345344543457031
gen group dst list time:  2.5510787963867188e-05
time for parepare:  0.00023245811462402344
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0005803108215332031
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0006906986236572266
----------------------check_connections_block total spend ----------------------------- 0.0024297237396240234
generate_one_block  0.0017812252044677734
generate_one_block  0.0018360614776611328
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010426044464111328
gen group dst list time:  6.318092346191406e-05
time for parepare:  0.0007069110870361328
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.0004024505615234375
mini_batch_src_global generation:  0.0002834796905517578
r_  generation:  0.003557920455932617
local_output_nid generation:  0.00010776519775390625
local_in_edges_tensor generation:  0.0003101825714111328
mini_batch_src_global generation:  0.0005402565002441406
r_  generation:  0.0043561458587646484
----------------------check_connections_block total spend ----------------------------- 0.012546062469482422
generate_one_block  0.005948543548583984
generate_one_block  0.006610870361328125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021295547485351562
gen group dst list time:  0.0001876354217529297
time for parepare:  0.0013704299926757812
local_output_nid generation:  0.0003845691680908203
local_in_edges_tensor generation:  0.0011429786682128906
mini_batch_src_global generation:  0.00138092041015625
r_  generation:  0.013173341751098633
local_output_nid generation:  0.000431060791015625
local_in_edges_tensor generation:  0.0009429454803466797
mini_batch_src_global generation:  0.0015518665313720703
r_  generation:  0.01464080810546875
----------------------check_connections_block total spend ----------------------------- 0.04196023941040039
generate_one_block  0.017574548721313477
generate_one_block  0.020379304885864258
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018205642700195312
gen group dst list time:  0.00048470497131347656
time for parepare:  0.001626729965209961
local_output_nid generation:  0.0011031627655029297
local_in_edges_tensor generation:  0.0022614002227783203
mini_batch_src_global generation:  0.002098560333251953
r_  generation:  0.023072242736816406
local_output_nid generation:  0.0010404586791992188
local_in_edges_tensor generation:  0.002173185348510742
mini_batch_src_global generation:  0.0027670860290527344
r_  generation:  0.023684978485107422
----------------------check_connections_block total spend ----------------------------- 0.07061505317687988
generate_one_block  0.028599977493286133
generate_one_block  0.03012537956237793
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002168416976928711
gen group dst list time:  0.0007307529449462891
time for parepare:  0.0016372203826904297
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.00290679931640625
mini_batch_src_global generation:  0.00205230712890625
r_  generation:  0.027653217315673828
local_output_nid generation:  0.0013680458068847656
local_in_edges_tensor generation:  0.002304553985595703
mini_batch_src_global generation:  0.0032873153686523438
r_  generation:  0.028467655181884766
----------------------check_connections_block total spend ----------------------------- 0.08353614807128906
generate_one_block  0.030193805694580078
generate_one_block  0.03569674491882324
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

connection checking time:  0.21108722686767578
block generation total time  0.17874646186828613
average batch blocks generation time:  0.08937323093414307
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.03854990005493164  GigaBytes
Max Memory Allocated: 0.03854990005493164  GigaBytes

torch.Size([19303, 500])
torch.Size([17676, 128])
torch.Size([14122, 128])
torch.Size([4765, 128])
torch.Size([1308, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.11010265350341797  GigaBytes
Max Memory Allocated: 0.11036062240600586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.0395503044128418  GigaBytes
Max Memory Allocated: 0.11202526092529297  GigaBytes

torch.Size([19286, 500])
torch.Size([18079, 128])
torch.Size([14171, 128])
torch.Size([6054, 128])
torch.Size([1491, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.1144871711730957  GigaBytes
Max Memory Allocated: 0.11479759216308594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015319108963012695 |0.1719416379928589 |0.39229750633239746 |0.00021660327911376953 |0.009181737899780273 |0.0039327144622802734 |
----------------------------------------------------------pseudo_mini_loss sum 2.3543782234191895
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  116612
Number of first layer input nodes during this epoch:  38589
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.04521369934082031  GigaBytes
Max Memory Allocated: 0.11700916290283203  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.002584695816040039
random selection method range initialization spend 0.0001513957977294922
time for parepare:  6.651878356933594e-05
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  8.821487426757812e-05
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.0001385211944580078
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  8.988380432128906e-05
----------------------check_connections_block total spend ----------------------------- 0.000985860824584961
generate_one_block  0.0015020370483398438
generate_one_block  0.0013914108276367188
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001590728759765625
gen group dst list time:  3.552436828613281e-05
time for parepare:  0.00037670135498046875
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  9.918212890625e-05
r_  generation:  0.0006558895111083984
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  0.00012612342834472656
r_  generation:  0.00089263916015625
----------------------check_connections_block total spend ----------------------------- 0.003072023391723633
generate_one_block  0.0023262500762939453
generate_one_block  0.002391338348388672
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012307167053222656
gen group dst list time:  9.5367431640625e-05
time for parepare:  0.0010805130004882812
local_output_nid generation:  0.00013327598571777344
local_in_edges_tensor generation:  0.0004398822784423828
mini_batch_src_global generation:  0.0004839897155761719
r_  generation:  0.004134416580200195
local_output_nid generation:  0.0001723766326904297
local_in_edges_tensor generation:  0.00038552284240722656
mini_batch_src_global generation:  0.0006062984466552734
r_  generation:  0.005604982376098633
----------------------check_connections_block total spend ----------------------------- 0.01568603515625
generate_one_block  0.005675315856933594
generate_one_block  0.0066149234771728516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002362966537475586
gen group dst list time:  0.0002627372741699219
time for parepare:  0.0017704963684082031
local_output_nid generation:  0.0005362033843994141
local_in_edges_tensor generation:  0.0011584758758544922
mini_batch_src_global generation:  0.0017018318176269531
r_  generation:  0.017160892486572266
local_output_nid generation:  0.00041937828063964844
local_in_edges_tensor generation:  0.0008423328399658203
mini_batch_src_global generation:  0.0020170211791992188
r_  generation:  0.014356851577758789
----------------------check_connections_block total spend ----------------------------- 0.047823190689086914
generate_one_block  0.03388619422912598
generate_one_block  0.01958489418029785
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018377304077148438
gen group dst list time:  0.0006034374237060547
time for parepare:  0.0016105175018310547
local_output_nid generation:  0.0011749267578125
local_in_edges_tensor generation:  0.002359151840209961
mini_batch_src_global generation:  0.002648591995239258
r_  generation:  0.023979902267456055
local_output_nid generation:  0.0010406970977783203
local_in_edges_tensor generation:  0.0023522377014160156
mini_batch_src_global generation:  0.0025339126586914062
r_  generation:  0.02300572395324707
----------------------check_connections_block total spend ----------------------------- 0.07126259803771973
generate_one_block  0.028624296188354492
generate_one_block  0.030621767044067383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020296573638916016
gen group dst list time:  0.0007309913635253906
time for parepare:  0.0016338825225830078
local_output_nid generation:  0.0014734268188476562
local_in_edges_tensor generation:  0.0028803348541259766
mini_batch_src_global generation:  0.0018661022186279297
r_  generation:  0.025995731353759766
local_output_nid generation:  0.0014216899871826172
local_in_edges_tensor generation:  0.0025823116302490234
mini_batch_src_global generation:  0.00266265869140625
r_  generation:  0.02590489387512207
----------------------check_connections_block total spend ----------------------------- 0.0778200626373291
generate_one_block  0.03083491325378418
generate_one_block  0.032085418701171875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.04521369934082031  GigaBytes
Max Memory Allocated: 0.11700916290283203  GigaBytes

connection checking time:  0.21566390991210938
block generation total time  0.19264531135559082
average batch blocks generation time:  0.09632265567779541
block dataloader generation time/epoch 0.46497035026550293
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.04151582717895508  GigaBytes
Max Memory Allocated: 0.11700916290283203  GigaBytes

torch.Size([19330, 500])
torch.Size([17942, 128])
torch.Size([14318, 128])
torch.Size([5007, 128])
torch.Size([1223, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.1135396957397461  GigaBytes
Max Memory Allocated: 0.11700916290283203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.0414280891418457  GigaBytes
Max Memory Allocated: 0.11700916290283203  GigaBytes

torch.Size([19273, 500])
torch.Size([17795, 128])
torch.Size([13218, 128])
torch.Size([5454, 128])
torch.Size([1477, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.1138153076171875  GigaBytes
Max Memory Allocated: 0.11700916290283203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014950394630432129 |0.002122163772583008 |0.007328152656555176 |0.00013589859008789062 |0.00633084774017334 |0.0030608177185058594 |
----------------------------------------------------------pseudo_mini_loss sum 1.5264371633529663
Total (block generation + training)time/epoch 0.5336380004882812
Training time/epoch 0.0680532455444336
Training time without block to device /epoch 0.06380891799926758
Training time without total dataloading part /epoch 0.030650615692138672
load block tensor time/epoch 0.029900789260864258
block to device time/epoch 0.004244327545166016
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  115391
Number of first layer input nodes during this epoch:  38603
