main start at this time 1648533310.6228333
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.003139019012451172
random selection method range initialization spend 0.0002048015594482422
time for parepare:  4.601478576660156e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0016927719116210938
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.004488229751586914
generate_one_block  0.0012323856353759766
generate_one_block  0.0010535717010498047
generate_one_block  0.0009953975677490234
generate_one_block  0.0010292530059814453
generate_one_block  0.0010170936584472656
generate_one_block  0.0010006427764892578
generate_one_block  0.0009958744049072266
generate_one_block  0.0009801387786865234
generate_one_block  0.0010218620300292969
generate_one_block  0.0009508132934570312
generate_one_block  0.000946044921875
generate_one_block  0.0009839534759521484
generate_one_block  0.0009577274322509766
generate_one_block  0.0009469985961914062
generate_one_block  0.0009429454803466797
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0014302730560302734
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.0002694129943847656
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  9.918212890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00015544891357421875
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.605552673339844e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.1975250244140625e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0001914501190185547
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  0.00010657310485839844
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00014829635620117188
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  9.632110595703125e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0001800060272216797
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0001087188720703125
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  6.651878356933594e-05
----------------------check_connections_block total spend ----------------------------- 0.00455927848815918
generate_one_block  0.0010499954223632812
generate_one_block  0.0011363029479980469
generate_one_block  0.0012819766998291016
generate_one_block  0.0010716915130615234
generate_one_block  0.0010402202606201172
generate_one_block  0.0010590553283691406
generate_one_block  0.0012521743774414062
generate_one_block  0.0010151863098144531
generate_one_block  0.0011527538299560547
generate_one_block  0.0011949539184570312
generate_one_block  0.0010848045349121094
generate_one_block  0.0009822845458984375
generate_one_block  0.0011484622955322266
generate_one_block  0.001123189926147461
generate_one_block  0.0010263919830322266
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012085437774658203
gen group dst list time:  0.00011992454528808594
time for parepare:  0.0007419586181640625
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0002675056457519531
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0003447532653808594
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0003764629364013672
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  9.489059448242188e-05
r_  generation:  0.0009069442749023438
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0003154277801513672
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00021076202392578125
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.0002219676971435547
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  0.00015282630920410156
r_  generation:  0.0015811920166015625
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.00010728836059570312
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0005595684051513672
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  0.0001227855682373047
r_  generation:  0.0012590885162353516
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0007717609405517578
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00022125244140625
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  9.989738464355469e-05
r_  generation:  0.0010995864868164062
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  9.608268737792969e-05
r_  generation:  0.000514984130859375
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.00055694580078125
----------------------check_connections_block total spend ----------------------------- 0.016112804412841797
generate_one_block  0.0015685558319091797
generate_one_block  0.0015058517456054688
generate_one_block  0.0020220279693603516
generate_one_block  0.0012853145599365234
generate_one_block  0.0011646747589111328
generate_one_block  0.0011911392211914062
generate_one_block  0.002798795700073242
generate_one_block  0.0010318756103515625
generate_one_block  0.0016016960144042969
generate_one_block  0.0027267932891845703
generate_one_block  0.0019121170043945312
generate_one_block  0.001163482666015625
generate_one_block  0.0023412704467773438
generate_one_block  0.001482248306274414
generate_one_block  0.001626729965209961
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002166748046875
gen group dst list time:  0.0003058910369873047
time for parepare:  0.0016186237335205078
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.0005125999450683594
mini_batch_src_global generation:  0.00031280517578125
r_  generation:  0.002437591552734375
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  0.0002181529998779297
r_  generation:  0.0015261173248291016
local_output_nid generation:  0.00015401840209960938
local_in_edges_tensor generation:  0.00034880638122558594
mini_batch_src_global generation:  0.0005209445953369141
r_  generation:  0.004780292510986328
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00022745132446289062
r_  generation:  0.0014374256134033203
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.0012505054473876953
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  0.00013399124145507812
r_  generation:  0.0012404918670654297
local_output_nid generation:  0.00013875961303710938
local_in_edges_tensor generation:  0.0003616809844970703
mini_batch_src_global generation:  0.0004916191101074219
r_  generation:  0.00591731071472168
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  0.00019025802612304688
r_  generation:  0.0005240440368652344
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.00022840499877929688
mini_batch_src_global generation:  0.00021839141845703125
r_  generation:  0.0026137828826904297
local_output_nid generation:  0.00011372566223144531
local_in_edges_tensor generation:  0.00031256675720214844
mini_batch_src_global generation:  0.0005314350128173828
r_  generation:  0.005286693572998047
local_output_nid generation:  0.00013446807861328125
local_in_edges_tensor generation:  0.0003292560577392578
mini_batch_src_global generation:  0.0005097389221191406
r_  generation:  0.0044939517974853516
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  0.0002560615539550781
r_  generation:  0.0017251968383789062
local_output_nid generation:  0.0001590251922607422
local_in_edges_tensor generation:  0.0003714561462402344
mini_batch_src_global generation:  0.0005295276641845703
r_  generation:  0.005894184112548828
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.00035262107849121094
r_  generation:  0.0023779869079589844
local_output_nid generation:  0.0001125335693359375
local_in_edges_tensor generation:  0.0002751350402832031
mini_batch_src_global generation:  0.0004208087921142578
r_  generation:  0.004123210906982422
----------------------check_connections_block total spend ----------------------------- 0.06980776786804199
generate_one_block  0.004530429840087891
generate_one_block  0.0028617382049560547
generate_one_block  0.007353782653808594
generate_one_block  0.0025496482849121094
generate_one_block  0.0028142929077148438
generate_one_block  0.0025670528411865234
generate_one_block  0.00948953628540039
generate_one_block  0.0015420913696289062
generate_one_block  0.004517555236816406
generate_one_block  0.007881879806518555
generate_one_block  0.006894350051879883
generate_one_block  0.0031104087829589844
generate_one_block  0.009483575820922852
generate_one_block  0.004095792770385742
generate_one_block  0.006375551223754883
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023059844970703125
gen group dst list time:  0.001638174057006836
time for parepare:  0.0017690658569335938
local_output_nid generation:  0.0002961158752441406
local_in_edges_tensor generation:  0.001112222671508789
mini_batch_src_global generation:  0.0010521411895751953
r_  generation:  0.008231639862060547
local_output_nid generation:  0.0002760887145996094
local_in_edges_tensor generation:  0.0005331039428710938
mini_batch_src_global generation:  0.0007541179656982422
r_  generation:  0.006010532379150391
local_output_nid generation:  0.0007078647613525391
local_in_edges_tensor generation:  0.0012829303741455078
mini_batch_src_global generation:  0.0014269351959228516
r_  generation:  0.014034509658813477
local_output_nid generation:  0.00019669532775878906
local_in_edges_tensor generation:  0.0003859996795654297
mini_batch_src_global generation:  0.0005772113800048828
r_  generation:  0.004819631576538086
local_output_nid generation:  0.00027871131896972656
local_in_edges_tensor generation:  0.000492095947265625
mini_batch_src_global generation:  0.0005481243133544922
r_  generation:  0.0059964656829833984
local_output_nid generation:  0.00023794174194335938
local_in_edges_tensor generation:  0.0004379749298095703
mini_batch_src_global generation:  0.0005950927734375
r_  generation:  0.006251096725463867
local_output_nid generation:  0.0005006790161132812
local_in_edges_tensor generation:  0.0010066032409667969
mini_batch_src_global generation:  0.0013921260833740234
r_  generation:  0.014070272445678711
local_output_nid generation:  9.632110595703125e-05
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  0.0005502700805664062
r_  generation:  0.0032012462615966797
local_output_nid generation:  0.0004100799560546875
local_in_edges_tensor generation:  0.0006544589996337891
mini_batch_src_global generation:  0.0007219314575195312
r_  generation:  0.009941339492797852
local_output_nid generation:  0.0004715919494628906
local_in_edges_tensor generation:  0.0009505748748779297
mini_batch_src_global generation:  0.0012445449829101562
r_  generation:  0.013298988342285156
local_output_nid generation:  0.0005517005920410156
local_in_edges_tensor generation:  0.0012602806091308594
mini_batch_src_global generation:  0.0014295578002929688
r_  generation:  0.014892101287841797
local_output_nid generation:  0.00026035308837890625
local_in_edges_tensor generation:  0.0005011558532714844
mini_batch_src_global generation:  0.000858306884765625
r_  generation:  0.007395744323730469
local_output_nid generation:  0.0006585121154785156
local_in_edges_tensor generation:  0.0011858940124511719
mini_batch_src_global generation:  0.0013914108276367188
r_  generation:  0.017548799514770508
local_output_nid generation:  0.0004112720489501953
local_in_edges_tensor generation:  0.0007023811340332031
mini_batch_src_global generation:  0.001068115234375
r_  generation:  0.009476423263549805
local_output_nid generation:  0.0004088878631591797
local_in_edges_tensor generation:  0.0007054805755615234
mini_batch_src_global generation:  0.0011131763458251953
r_  generation:  0.011762857437133789
----------------------check_connections_block total spend ----------------------------- 0.21720242500305176
generate_one_block  0.012501001358032227
generate_one_block  0.009312629699707031
generate_one_block  0.017426013946533203
generate_one_block  0.007462024688720703
generate_one_block  0.009310483932495117
generate_one_block  0.009808778762817383
generate_one_block  0.018479347229003906
generate_one_block  0.005917072296142578
generate_one_block  0.013930082321166992
generate_one_block  0.017578125
generate_one_block  0.02113199234008789
generate_one_block  0.011206388473510742
generate_one_block  0.022375822067260742
generate_one_block  0.013451337814331055
generate_one_block  0.01623845100402832
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019087791442871094
gen group dst list time:  0.003986358642578125
time for parepare:  0.0017104148864746094
local_output_nid generation:  0.0007486343383789062
local_in_edges_tensor generation:  0.0017409324645996094
mini_batch_src_global generation:  0.0015189647674560547
r_  generation:  0.015719175338745117
local_output_nid generation:  0.0006463527679443359
local_in_edges_tensor generation:  0.0012357234954833984
mini_batch_src_global generation:  0.0017704963684082031
r_  generation:  0.015197277069091797
local_output_nid generation:  0.0011248588562011719
local_in_edges_tensor generation:  0.0022783279418945312
mini_batch_src_global generation:  0.0018105506896972656
r_  generation:  0.021969318389892578
local_output_nid generation:  0.000698089599609375
local_in_edges_tensor generation:  0.000982046127319336
mini_batch_src_global generation:  0.0014064311981201172
r_  generation:  0.014190435409545898
local_output_nid generation:  0.000827789306640625
local_in_edges_tensor generation:  0.0012478828430175781
mini_batch_src_global generation:  0.0014753341674804688
r_  generation:  0.017067432403564453
local_output_nid generation:  0.0007405281066894531
local_in_edges_tensor generation:  0.0011222362518310547
mini_batch_src_global generation:  0.0014595985412597656
r_  generation:  0.01632523536682129
local_output_nid generation:  0.0010967254638671875
local_in_edges_tensor generation:  0.0016999244689941406
mini_batch_src_global generation:  0.0019366741180419922
r_  generation:  0.021389245986938477
local_output_nid generation:  0.000396728515625
local_in_edges_tensor generation:  0.0006718635559082031
mini_batch_src_global generation:  0.001180410385131836
r_  generation:  0.010329008102416992
local_output_nid generation:  0.0009834766387939453
local_in_edges_tensor generation:  0.0013992786407470703
mini_batch_src_global generation:  0.001280069351196289
r_  generation:  0.019344806671142578
local_output_nid generation:  0.0009324550628662109
local_in_edges_tensor generation:  0.0018315315246582031
mini_batch_src_global generation:  0.0017223358154296875
r_  generation:  0.020029306411743164
local_output_nid generation:  0.0012497901916503906
local_in_edges_tensor generation:  0.002141714096069336
mini_batch_src_global generation:  0.0018649101257324219
r_  generation:  0.023154735565185547
local_output_nid generation:  0.0007607936859130859
local_in_edges_tensor generation:  0.0011074542999267578
mini_batch_src_global generation:  0.0014989376068115234
r_  generation:  0.01630401611328125
local_output_nid generation:  0.0013318061828613281
local_in_edges_tensor generation:  0.0019686222076416016
mini_batch_src_global generation:  0.001949310302734375
r_  generation:  0.02442336082458496
local_output_nid generation:  0.0009884834289550781
local_in_edges_tensor generation:  0.0017116069793701172
mini_batch_src_global generation:  0.0017688274383544922
r_  generation:  0.020495891571044922
local_output_nid generation:  0.0008683204650878906
local_in_edges_tensor generation:  0.0016345977783203125
mini_batch_src_global generation:  0.0016651153564453125
r_  generation:  0.01902031898498535
----------------------check_connections_block total spend ----------------------------- 0.3976144790649414
generate_one_block  0.019968748092651367
generate_one_block  0.02129530906677246
generate_one_block  0.028220653533935547
generate_one_block  0.018537044525146484
generate_one_block  0.022526979446411133
generate_one_block  0.021744489669799805
generate_one_block  0.02738666534423828
generate_one_block  0.01428842544555664
generate_one_block  0.024885892868041992
generate_one_block  0.025649309158325195
generate_one_block  0.02916574478149414
generate_one_block  0.023804187774658203
generate_one_block  0.030973196029663086
generate_one_block  0.02685689926147461
generate_one_block  0.024725675582885742
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0009799003601074219  GigaBytes
Max Memory Allocated: 0.0009799003601074219  GigaBytes

connection checking time:  0.7052967548370361
block generation total time  0.6842684745788574
average batch blocks generation time:  0.045617898305257164
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.0270538330078125  GigaBytes
Max Memory Allocated: 0.0270538330078125  GigaBytes

torch.Size([13376, 500])
torch.Size([8082, 128])
torch.Size([2940, 128])
torch.Size([652, 128])
torch.Size([80, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.047824859619140625  GigaBytes
Max Memory Allocated: 0.04793214797973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.02986764907836914  GigaBytes
Max Memory Allocated: 0.05468940734863281  GigaBytes

torch.Size([14372, 500])
torch.Size([7320, 128])
torch.Size([2613, 128])
torch.Size([603, 128])
torch.Size([169, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.04969501495361328  GigaBytes
Max Memory Allocated: 0.05468940734863281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.03710126876831055  GigaBytes
Max Memory Allocated: 0.06343555450439453  GigaBytes

torch.Size([18327, 500])
torch.Size([13108, 128])
torch.Size([7900, 128])
torch.Size([1497, 128])
torch.Size([387, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.07890510559082031  GigaBytes
Max Memory Allocated: 0.07902669906616211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.028720855712890625  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

torch.Size([14100, 500])
torch.Size([6665, 128])
torch.Size([2085, 128])
torch.Size([473, 128])
torch.Size([135, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.04541826248168945  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.03248882293701172  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

torch.Size([16060, 500])
torch.Size([7968, 128])
torch.Size([2934, 128])
torch.Size([370, 128])
torch.Size([110, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.052968502044677734  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.030466556549072266  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

torch.Size([14981, 500])
torch.Size([7681, 128])
torch.Size([2510, 128])
torch.Size([386, 128])
torch.Size([95, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.04936075210571289  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.0345921516418457  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

torch.Size([16941, 500])
torch.Size([12484, 128])
torch.Size([6168, 128])
torch.Size([1809, 128])
torch.Size([369, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.07242631912231445  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.020822525024414062  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

torch.Size([9937, 500])
torch.Size([4042, 128])
torch.Size([868, 128])
torch.Size([143, 128])
torch.Size([33, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.029629230499267578  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.0337672233581543  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

torch.Size([16641, 500])
torch.Size([10364, 128])
torch.Size([4230, 128])
torch.Size([899, 128])
torch.Size([210, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.06165266036987305  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.03421354293823242  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

torch.Size([16576, 500])
torch.Size([11281, 128])
torch.Size([5986, 128])
torch.Size([1649, 128])
torch.Size([301, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.06900215148925781  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.036581993103027344  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

torch.Size([18018, 500])
torch.Size([14340, 128])
torch.Size([6546, 128])
torch.Size([1710, 128])
torch.Size([216, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.07785606384277344  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.029947757720947266  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

torch.Size([14582, 500])
torch.Size([7868, 128])
torch.Size([2942, 128])
torch.Size([386, 128])
torch.Size([78, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.0511469841003418  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.03830671310424805  GigaBytes
Max Memory Allocated: 0.08274650573730469  GigaBytes

torch.Size([18762, 500])
torch.Size([15504, 128])
torch.Size([8459, 128])
torch.Size([2209, 128])
torch.Size([383, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.08642578125  GigaBytes
Max Memory Allocated: 0.08740425109863281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.035970211029052734  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

torch.Size([17442, 500])
torch.Size([11127, 128])
torch.Size([4545, 128])
torch.Size([859, 128])
torch.Size([216, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.0657343864440918  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.03282308578491211  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

torch.Size([16092, 500])
torch.Size([9970, 128])
torch.Size([5024, 128])
torch.Size([1162, 128])
torch.Size([137, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.06274890899658203  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013264338175455729 |0.024114720026652017 |0.057568963368733725 |0.00012947718302408855 |0.005218696594238281 |0.00390625 |
----------------------------------------------------------pseudo_mini_loss sum 1.732083797454834
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  467844
Number of first layer input nodes during this epoch:  236207
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.0367426872253418  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005145072937011719
random selection method range initialization spend 0.0001308917999267578
time for parepare:  5.173683166503906e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.6689300537109375e-05
----------------------check_connections_block total spend ----------------------------- 0.0026345252990722656
generate_one_block  0.001398324966430664
generate_one_block  0.0010080337524414062
generate_one_block  0.000985860824584961
generate_one_block  0.0009868144989013672
generate_one_block  0.0009884834289550781
generate_one_block  0.0009694099426269531
generate_one_block  0.000982046127319336
generate_one_block  0.0009815692901611328
generate_one_block  0.0009756088256835938
generate_one_block  0.0009746551513671875
generate_one_block  0.0009527206420898438
generate_one_block  0.00098419189453125
generate_one_block  0.000972747802734375
generate_one_block  0.0009555816650390625
generate_one_block  0.0009944438934326172
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006399154663085938
gen group dst list time:  7.82012939453125e-05
time for parepare:  0.0002846717834472656
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  9.226799011230469e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  7.605552673339844e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  9.608268737792969e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00015997886657714844
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.700920104980469e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  9.036064147949219e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  7.605552673339844e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00017023086547851562
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00028586387634277344
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  7.677078247070312e-05
----------------------check_connections_block total spend ----------------------------- 0.00464177131652832
generate_one_block  0.0011060237884521484
generate_one_block  0.0010595321655273438
generate_one_block  0.0011053085327148438
generate_one_block  0.0011749267578125
generate_one_block  0.0010733604431152344
generate_one_block  0.0010170936584472656
generate_one_block  0.0010662078857421875
generate_one_block  0.0009963512420654297
generate_one_block  0.0010008811950683594
generate_one_block  0.0010263919830322266
generate_one_block  0.0010724067687988281
generate_one_block  0.0014636516571044922
generate_one_block  0.0011479854583740234
generate_one_block  0.0012850761413574219
generate_one_block  0.0010106563568115234
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011506080627441406
gen group dst list time:  0.00012993812561035156
time for parepare:  0.0007920265197753906
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00027441978454589844
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.00043010711669921875
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0005660057067871094
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.0007305145263671875
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  0.00011777877807617188
r_  generation:  0.0009484291076660156
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.00033545494079589844
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00018167495727539062
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00045299530029296875
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00017380714416503906
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00010824203491210938
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00028133392333984375
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0004858970642089844
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0002837181091308594
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  0.0001246929168701172
r_  generation:  0.0013072490692138672
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  0.00023174285888671875
r_  generation:  0.002062082290649414
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  0.00011706352233886719
r_  generation:  0.0006301403045654297
----------------------check_connections_block total spend ----------------------------- 0.016148805618286133
generate_one_block  0.001512289047241211
generate_one_block  0.0016360282897949219
generate_one_block  0.001791238784790039
generate_one_block  0.0020558834075927734
generate_one_block  0.001317739486694336
generate_one_block  0.0011286735534667969
generate_one_block  0.0014755725860595703
generate_one_block  0.0011138916015625
generate_one_block  0.0011339187622070312
generate_one_block  0.0013086795806884766
generate_one_block  0.0014960765838623047
generate_one_block  0.0012619495391845703
generate_one_block  0.002559185028076172
generate_one_block  0.003490924835205078
generate_one_block  0.0017285346984863281
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002099752426147461
gen group dst list time:  0.0003216266632080078
time for parepare:  0.0014820098876953125
local_output_nid generation:  7.534027099609375e-05
local_in_edges_tensor generation:  0.0004990100860595703
mini_batch_src_global generation:  0.00027871131896972656
r_  generation:  0.002331972122192383
local_output_nid generation:  0.00012063980102539062
local_in_edges_tensor generation:  0.0003161430358886719
mini_batch_src_global generation:  0.00043320655822753906
r_  generation:  0.0036132335662841797
local_output_nid generation:  0.00014066696166992188
local_in_edges_tensor generation:  0.0003674030303955078
mini_batch_src_global generation:  0.0005702972412109375
r_  generation:  0.005314350128173828
local_output_nid generation:  0.00014209747314453125
local_in_edges_tensor generation:  0.0003418922424316406
mini_batch_src_global generation:  0.0005383491516113281
r_  generation:  0.00479888916015625
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.00025844573974609375
r_  generation:  0.0016999244689941406
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.0010688304901123047
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  0.00023794174194335938
r_  generation:  0.0026259422302246094
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  0.00017499923706054688
r_  generation:  0.0011894702911376953
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.00045561790466308594
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  0.00020003318786621094
r_  generation:  0.002232789993286133
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.0002224445343017578
mini_batch_src_global generation:  0.00027680397033691406
r_  generation:  0.0026891231536865234
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  0.00019049644470214844
r_  generation:  0.0025250911712646484
local_output_nid generation:  0.00014662742614746094
local_in_edges_tensor generation:  0.0003600120544433594
mini_batch_src_global generation:  0.0005011558532714844
r_  generation:  0.0055141448974609375
local_output_nid generation:  0.00019097328186035156
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0007927417755126953
r_  generation:  0.007622718811035156
local_output_nid generation:  0.0001437664031982422
local_in_edges_tensor generation:  0.00031304359436035156
mini_batch_src_global generation:  0.0005164146423339844
r_  generation:  0.0041544437408447266
----------------------check_connections_block total spend ----------------------------- 0.07193613052368164
generate_one_block  0.004673004150390625
generate_one_block  0.005730152130126953
generate_one_block  0.007555723190307617
generate_one_block  0.007422447204589844
generate_one_block  0.0030279159545898438
generate_one_block  0.0023157596588134766
generate_one_block  0.0048100948333740234
generate_one_block  0.002476215362548828
generate_one_block  0.0015048980712890625
generate_one_block  0.004069805145263672
generate_one_block  0.004686117172241211
generate_one_block  0.0027456283569335938
generate_one_block  0.008425474166870117
generate_one_block  0.010930776596069336
generate_one_block  0.0063135623931884766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023584365844726562
gen group dst list time:  0.0014035701751708984
time for parepare:  0.0016093254089355469
local_output_nid generation:  0.0004353523254394531
local_in_edges_tensor generation:  0.0012743473052978516
mini_batch_src_global generation:  0.0008809566497802734
r_  generation:  0.009070873260498047
local_output_nid generation:  0.00043272972106933594
local_in_edges_tensor generation:  0.0009510517120361328
mini_batch_src_global generation:  0.0013575553894042969
r_  generation:  0.011737346649169922
local_output_nid generation:  0.0005307197570800781
local_in_edges_tensor generation:  0.00110626220703125
mini_batch_src_global generation:  0.0011529922485351562
r_  generation:  0.013753175735473633
local_output_nid generation:  0.0006477832794189453
local_in_edges_tensor generation:  0.0011317729949951172
mini_batch_src_global generation:  0.0013365745544433594
r_  generation:  0.013842582702636719
local_output_nid generation:  0.00032639503479003906
local_in_edges_tensor generation:  0.0006070137023925781
mini_batch_src_global generation:  0.0007493495941162109
r_  generation:  0.006850719451904297
local_output_nid generation:  0.00022339820861816406
local_in_edges_tensor generation:  0.00043845176696777344
mini_batch_src_global generation:  0.0005118846893310547
r_  generation:  0.004817962646484375
local_output_nid generation:  0.00039958953857421875
local_in_edges_tensor generation:  0.0007228851318359375
mini_batch_src_global generation:  0.0009813308715820312
r_  generation:  0.011307954788208008
local_output_nid generation:  0.00025153160095214844
local_in_edges_tensor generation:  0.0004634857177734375
mini_batch_src_global generation:  0.0007917881011962891
r_  generation:  0.006851911544799805
local_output_nid generation:  0.00010800361633300781
local_in_edges_tensor generation:  0.0002689361572265625
mini_batch_src_global generation:  0.0005013942718505859
r_  generation:  0.003314971923828125
local_output_nid generation:  0.0003528594970703125
local_in_edges_tensor generation:  0.0006148815155029297
mini_batch_src_global generation:  0.0008370876312255859
r_  generation:  0.009388446807861328
local_output_nid generation:  0.0004830360412597656
local_in_edges_tensor generation:  0.0008475780487060547
mini_batch_src_global generation:  0.0010361671447753906
r_  generation:  0.011126279830932617
local_output_nid generation:  0.00027298927307128906
local_in_edges_tensor generation:  0.0004909038543701172
mini_batch_src_global generation:  0.0006971359252929688
r_  generation:  0.006096601486206055
local_output_nid generation:  0.0005197525024414062
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0011022090911865234
r_  generation:  0.012971162796020508
local_output_nid generation:  0.0007688999176025391
local_in_edges_tensor generation:  0.0013065338134765625
mini_batch_src_global generation:  0.0015971660614013672
r_  generation:  0.017250776290893555
local_output_nid generation:  0.0005466938018798828
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.0014166831970214844
r_  generation:  0.01449441909790039
----------------------check_connections_block total spend ----------------------------- 0.22435736656188965
generate_one_block  0.012139558792114258
generate_one_block  0.015602350234985352
generate_one_block  0.01880669593811035
generate_one_block  0.0193173885345459
generate_one_block  0.010946035385131836
generate_one_block  0.007032871246337891
generate_one_block  0.014562368392944336
generate_one_block  0.010003328323364258
generate_one_block  0.005555152893066406
generate_one_block  0.012775182723999023
generate_one_block  0.015762805938720703
generate_one_block  0.009144306182861328
generate_one_block  0.01695418357849121
generate_one_block  0.02391791343688965
generate_one_block  0.019446134567260742
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018050670623779297
gen group dst list time:  0.004175901412963867
time for parepare:  0.001901865005493164
local_output_nid generation:  0.0010671615600585938
local_in_edges_tensor generation:  0.0018970966339111328
mini_batch_src_global generation:  0.0017189979553222656
r_  generation:  0.019232511520385742
local_output_nid generation:  0.0010223388671875
local_in_edges_tensor generation:  0.0022263526916503906
mini_batch_src_global generation:  0.0023555755615234375
r_  generation:  0.0198366641998291
local_output_nid generation:  0.0011696815490722656
local_in_edges_tensor generation:  0.0018086433410644531
mini_batch_src_global generation:  0.0018115043640136719
r_  generation:  0.02043771743774414
local_output_nid generation:  0.0012786388397216797
local_in_edges_tensor generation:  0.0018839836120605469
mini_batch_src_global generation:  0.001939535140991211
r_  generation:  0.02189350128173828
local_output_nid generation:  0.0009295940399169922
local_in_edges_tensor generation:  0.0014333724975585938
mini_batch_src_global generation:  0.0015106201171875
r_  generation:  0.017113447189331055
local_output_nid generation:  0.0007686614990234375
local_in_edges_tensor generation:  0.0010094642639160156
mini_batch_src_global generation:  0.0013089179992675781
r_  generation:  0.014051437377929688
local_output_nid generation:  0.0013742446899414062
local_in_edges_tensor generation:  0.0017323493957519531
mini_batch_src_global generation:  0.0015621185302734375
r_  generation:  0.02087879180908203
local_output_nid generation:  0.0007679462432861328
local_in_edges_tensor generation:  0.0014209747314453125
mini_batch_src_global generation:  0.001537322998046875
r_  generation:  0.017007112503051758
local_output_nid generation:  0.0005202293395996094
local_in_edges_tensor generation:  0.0008151531219482422
mini_batch_src_global generation:  0.001155853271484375
r_  generation:  0.012470722198486328
local_output_nid generation:  0.0009276866912841797
local_in_edges_tensor generation:  0.001445770263671875
mini_batch_src_global generation:  0.0016548633575439453
r_  generation:  0.01833343505859375
local_output_nid generation:  0.0010194778442382812
local_in_edges_tensor generation:  0.0018393993377685547
mini_batch_src_global generation:  0.0017094612121582031
r_  generation:  0.020479440689086914
local_output_nid generation:  0.0008285045623779297
local_in_edges_tensor generation:  0.0011658668518066406
mini_batch_src_global generation:  0.0014195442199707031
r_  generation:  0.015391826629638672
local_output_nid generation:  0.0010597705841064453
local_in_edges_tensor generation:  0.0015740394592285156
mini_batch_src_global generation:  0.0014948844909667969
r_  generation:  0.020096778869628906
local_output_nid generation:  0.0013606548309326172
local_in_edges_tensor generation:  0.002475261688232422
mini_batch_src_global generation:  0.0022046566009521484
r_  generation:  0.024049997329711914
local_output_nid generation:  0.0014171600341796875
local_in_edges_tensor generation:  0.0020596981048583984
mini_batch_src_global generation:  0.0018265247344970703
r_  generation:  0.022899150848388672
----------------------check_connections_block total spend ----------------------------- 0.4138174057006836
generate_one_block  0.02416062355041504
generate_one_block  0.029139995574951172
generate_one_block  0.026454448699951172
generate_one_block  0.0277862548828125
generate_one_block  0.022092580795288086
generate_one_block  0.01865553855895996
generate_one_block  0.026581764221191406
generate_one_block  0.02294921875
generate_one_block  0.016587495803833008
generate_one_block  0.024348735809326172
generate_one_block  0.027151823043823242
generate_one_block  0.019507884979248047
generate_one_block  0.025531768798828125
generate_one_block  0.030419349670410156
generate_one_block  0.028716325759887695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.0367426872253418  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

connection checking time:  0.7309014797210693
block generation total time  0.7003540992736816
average batch blocks generation time:  0.04669027328491211
block dataloader generation time/epoch 1.5129382610321045
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.03786134719848633  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

torch.Size([17313, 500])
torch.Size([10138, 128])
torch.Size([4540, 128])
torch.Size([674, 128])
torch.Size([214, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.06618356704711914  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.034487247467041016  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

torch.Size([15942, 500])
torch.Size([11159, 128])
torch.Size([4654, 128])
torch.Size([1086, 128])
torch.Size([151, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.06502532958984375  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.035859107971191406  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

torch.Size([16618, 500])
torch.Size([11721, 128])
torch.Size([5991, 128])
torch.Size([1407, 128])
torch.Size([201, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.07147598266601562  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.03893852233886719  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

torch.Size([18273, 500])
torch.Size([13076, 128])
torch.Size([7728, 128])
torch.Size([1603, 128])
torch.Size([352, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.08076047897338867  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.0345306396484375  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

torch.Size([16101, 500])
torch.Size([8798, 128])
torch.Size([3308, 128])
torch.Size([621, 128])
torch.Size([152, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.05748414993286133  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.03214216232299805  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

torch.Size([14896, 500])
torch.Size([6583, 128])
torch.Size([2414, 128])
torch.Size([319, 128])
torch.Size([83, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.049878597259521484  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.03663063049316406  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

torch.Size([17099, 500])
torch.Size([11767, 128])
torch.Size([4277, 128])
torch.Size([855, 128])
torch.Size([147, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.06661701202392578  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.033833980560302734  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

torch.Size([15257, 500])
torch.Size([7744, 128])
torch.Size([2270, 128])
torch.Size([304, 128])
torch.Size([53, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.052242279052734375  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.02619171142578125  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

torch.Size([11746, 500])
torch.Size([5243, 128])
torch.Size([1046, 128])
torch.Size([175, 128])
torch.Size([53, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.03740072250366211  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.03460264205932617  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

torch.Size([16069, 500])
torch.Size([9250, 128])
torch.Size([3617, 128])
torch.Size([569, 128])
torch.Size([83, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.05887794494628906  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.0379643440246582  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

torch.Size([17369, 500])
torch.Size([11033, 128])
torch.Size([5248, 128])
torch.Size([804, 128])
torch.Size([224, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.06906938552856445  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.03230571746826172  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

torch.Size([14952, 500])
torch.Size([8256, 128])
torch.Size([2740, 128])
torch.Size([551, 128])
torch.Size([123, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.05437517166137695  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.03614950180053711  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes
Using backend: pytorch

torch.Size([16644, 500])
torch.Size([11201, 128])
torch.Size([5686, 128])
torch.Size([1674, 128])
torch.Size([359, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.07036638259887695  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.040323734283447266  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

torch.Size([18451, 500])
torch.Size([14904, 128])
torch.Size([8562, 128])
torch.Size([2604, 128])
torch.Size([592, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.0896005630493164  GigaBytes
Max Memory Allocated: 0.08988571166992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.03813505172729492  GigaBytes
Max Memory Allocated: 0.09092903137207031  GigaBytes

torch.Size([17511, 500])
torch.Size([13914, 128])
torch.Size([5667, 128])
torch.Size([1506, 128])
torch.Size([141, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.07662439346313477  GigaBytes
Max Memory Allocated: 0.09092903137207031  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010695648193359376 |0.0016974925994873047 |0.007512331008911133 |0.00014247894287109376 |0.00465081532796224 |0.0030858516693115234 |
----------------------------------------------------------pseudo_mini_loss sum 2.8306798934936523
Total (block generation + training)time/epoch 1.9127130508422852
Training time/epoch 0.39949822425842285
Training time without block to device /epoch 0.3740358352661133
Training time without total dataloading part /epoch 0.18767023086547852
load block tensor time/epoch 0.16043472290039062
block to device time/epoch 0.02546238899230957
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  484813
Number of first layer input nodes during this epoch:  244241
