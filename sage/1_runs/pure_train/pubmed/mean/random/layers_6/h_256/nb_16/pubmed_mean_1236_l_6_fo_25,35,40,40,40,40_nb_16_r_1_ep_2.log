main start at this time 1648533357.8354757
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002933979034423828  GigaBytes
Max Memory Allocated: 0.002933979034423828  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001775979995727539
random selection method range initialization spend 0.00018739700317382812
time for parepare:  4.6253204345703125e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0011487007141113281
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2411346435546875e-05
----------------------check_connections_block total spend ----------------------------- 0.0029125213623046875
generate_one_block  0.0012614727020263672
generate_one_block  0.0010883808135986328
generate_one_block  0.0010883808135986328
generate_one_block  0.001056671142578125
generate_one_block  0.001031637191772461
generate_one_block  0.0011072158813476562
generate_one_block  0.0010471343994140625
generate_one_block  0.0010459423065185547
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009655952453613281
gen group dst list time:  5.1975250244140625e-05
time for parepare:  0.00026798248291015625
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0002613067626953125
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0001964569091796875
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00010538101196289062
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00021123886108398438
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001251697540283203
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00019550323486328125
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  8.273124694824219e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00018787384033203125
----------------------check_connections_block total spend ----------------------------- 0.003483295440673828
generate_one_block  0.0014281272888183594
generate_one_block  0.001316070556640625
generate_one_block  0.0011572837829589844
generate_one_block  0.0014047622680664062
generate_one_block  0.0011982917785644531
generate_one_block  0.0012736320495605469
generate_one_block  0.0011470317840576172
generate_one_block  0.001283884048461914
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012316703796386719
gen group dst list time:  9.393692016601562e-05
time for parepare:  0.0007917881011962891
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00029850006103515625
mini_batch_src_global generation:  0.00017690658569335938
r_  generation:  0.0017647743225097656
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  0.00014901161193847656
r_  generation:  0.0010814666748046875
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0005404949188232422
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  0.00012063980102539062
r_  generation:  0.0012691020965576172
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  0.00011968612670898438
r_  generation:  0.0010111331939697266
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.0012633800506591797
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.00047850608825683594
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.0001533031463623047
r_  generation:  0.0016465187072753906
----------------------check_connections_block total spend ----------------------------- 0.015057802200317383
generate_one_block  0.0032072067260742188
generate_one_block  0.0021758079528808594
generate_one_block  0.0015988349914550781
generate_one_block  0.0024487972259521484
generate_one_block  0.0021514892578125
generate_one_block  0.0024170875549316406
generate_one_block  0.0014209747314453125
generate_one_block  0.0029306411743164062
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018351078033447266
gen group dst list time:  0.0002613067626953125
time for parepare:  0.0015788078308105469
local_output_nid generation:  0.00020575523376464844
local_in_edges_tensor generation:  0.0007522106170654297
mini_batch_src_global generation:  0.0009493827819824219
r_  generation:  0.0072803497314453125
local_output_nid generation:  0.0001666545867919922
local_in_edges_tensor generation:  0.00040340423583984375
mini_batch_src_global generation:  0.0008132457733154297
r_  generation:  0.0058019161224365234
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.0002536773681640625
mini_batch_src_global generation:  0.000370025634765625
r_  generation:  0.002987384796142578
local_output_nid generation:  0.00018405914306640625
local_in_edges_tensor generation:  0.0004119873046875
mini_batch_src_global generation:  0.0005488395690917969
r_  generation:  0.006314992904663086
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.00037980079650878906
mini_batch_src_global generation:  0.0006308555603027344
r_  generation:  0.005437374114990234
local_output_nid generation:  0.00016736984252929688
local_in_edges_tensor generation:  0.00038623809814453125
mini_batch_src_global generation:  0.0005581378936767578
r_  generation:  0.005728721618652344
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.00022292137145996094
mini_batch_src_global generation:  0.00039196014404296875
r_  generation:  0.0030074119567871094
local_output_nid generation:  0.00014472007751464844
local_in_edges_tensor generation:  0.0003523826599121094
mini_batch_src_global generation:  0.0005254745483398438
r_  generation:  0.005769252777099609
----------------------check_connections_block total spend ----------------------------- 0.06395578384399414
generate_one_block  0.010781526565551758
generate_one_block  0.0089263916015625
generate_one_block  0.0048792362213134766
generate_one_block  0.009745597839355469
generate_one_block  0.008470535278320312
generate_one_block  0.008635997772216797
generate_one_block  0.004911184310913086
generate_one_block  0.009044885635375977
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00220489501953125
gen group dst list time:  0.001430511474609375
time for parepare:  0.0017659664154052734
local_output_nid generation:  0.0007646083831787109
local_in_edges_tensor generation:  0.0019040107727050781
mini_batch_src_global generation:  0.0016999244689941406
r_  generation:  0.017467498779296875
local_output_nid generation:  0.0007791519165039062
local_in_edges_tensor generation:  0.0017657279968261719
mini_batch_src_global generation:  0.0021126270294189453
r_  generation:  0.01766657829284668
local_output_nid generation:  0.0005121231079101562
local_in_edges_tensor generation:  0.0008244514465332031
mini_batch_src_global generation:  0.0009431838989257812
r_  generation:  0.010766029357910156
local_output_nid generation:  0.0007653236389160156
local_in_edges_tensor generation:  0.0013287067413330078
mini_batch_src_global generation:  0.0012900829315185547
r_  generation:  0.017565488815307617
local_output_nid generation:  0.0006759166717529297
local_in_edges_tensor generation:  0.001283884048461914
mini_batch_src_global generation:  0.0017042160034179688
r_  generation:  0.017643451690673828
local_output_nid generation:  0.0007374286651611328
local_in_edges_tensor generation:  0.00107574462890625
mini_batch_src_global generation:  0.001524209976196289
r_  generation:  0.017341136932373047
local_output_nid generation:  0.0004210472106933594
local_in_edges_tensor generation:  0.0006830692291259766
mini_batch_src_global generation:  0.0010898113250732422
r_  generation:  0.010908842086791992
local_output_nid generation:  0.0004792213439941406
local_in_edges_tensor generation:  0.0008015632629394531
mini_batch_src_global generation:  0.0009171962738037109
r_  generation:  0.012012481689453125
----------------------check_connections_block total spend ----------------------------- 0.17718005180358887
generate_one_block  0.023472309112548828
generate_one_block  0.02429366111755371
generate_one_block  0.01428985595703125
generate_one_block  0.023552656173706055
generate_one_block  0.02362799644470215
generate_one_block  0.02215099334716797
generate_one_block  0.014789581298828125
generate_one_block  0.01580953598022461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002039670944213867
gen group dst list time:  0.002689361572265625
time for parepare:  0.0018339157104492188
local_output_nid generation:  0.0012679100036621094
local_in_edges_tensor generation:  0.002849102020263672
mini_batch_src_global generation:  0.0023970603942871094
r_  generation:  0.0234375
local_output_nid generation:  0.0013492107391357422
local_in_edges_tensor generation:  0.0026094913482666016
mini_batch_src_global generation:  0.0026259422302246094
r_  generation:  0.02399134635925293
local_output_nid generation:  0.0010657310485839844
local_in_edges_tensor generation:  0.0014476776123046875
mini_batch_src_global generation:  0.0016911029815673828
r_  generation:  0.020560026168823242
local_output_nid generation:  0.0013959407806396484
local_in_edges_tensor generation:  0.004424333572387695
mini_batch_src_global generation:  0.0021364688873291016
r_  generation:  0.02386760711669922
local_output_nid generation:  0.0014643669128417969
local_in_edges_tensor generation:  0.002283334732055664
mini_batch_src_global generation:  0.001970052719116211
r_  generation:  0.024967432022094727
local_output_nid generation:  0.0012853145599365234
local_in_edges_tensor generation:  0.0025205612182617188
mini_batch_src_global generation:  0.0019335746765136719
r_  generation:  0.02480316162109375
local_output_nid generation:  0.0009324550628662109
local_in_edges_tensor generation:  0.0013442039489746094
mini_batch_src_global generation:  0.001735687255859375
r_  generation:  0.019489526748657227
local_output_nid generation:  0.0008661746978759766
local_in_edges_tensor generation:  0.0012195110321044922
mini_batch_src_global generation:  0.0015790462493896484
r_  generation:  0.018320560455322266
----------------------check_connections_block total spend ----------------------------- 0.26349520683288574
generate_one_block  0.028701305389404297
generate_one_block  0.0304563045501709
generate_one_block  0.02741837501525879
generate_one_block  0.030237197875976562
generate_one_block  0.031238794326782227
generate_one_block  0.030552148818969727
generate_one_block  0.02477240562438965
generate_one_block  0.02354574203491211
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002933979034423828  GigaBytes
Max Memory Allocated: 0.002933979034423828  GigaBytes

connection checking time:  0.52317214012146
block generation total time  0.4828641414642334
average batch blocks generation time:  0.060358017683029175
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.03931903839111328  GigaBytes
Max Memory Allocated: 0.03931903839111328  GigaBytes

torch.Size([18384, 500])
torch.Size([14461, 256])
torch.Size([8539, 256])
torch.Size([2190, 256])
torch.Size([503, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4041748046875 GB
    Memory Allocated: 0.13164472579956055  GigaBytes
Max Memory Allocated: 0.13190507888793945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4803466796875 GB
    Memory Allocated: 0.04217863082885742  GigaBytes
Max Memory Allocated: 0.1385655403137207  GigaBytes

torch.Size([18713, 500])
torch.Size([14766, 256])
torch.Size([8927, 256])
torch.Size([1829, 256])
torch.Size([396, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4803466796875 GB
    Memory Allocated: 0.13517284393310547  GigaBytes
Max Memory Allocated: 0.1385655403137207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.039792537689208984  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

torch.Size([17771, 500])
torch.Size([10986, 256])
torch.Size([5309, 256])
torch.Size([863, 256])
torch.Size([237, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.10210943222045898  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.0422215461730957  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

torch.Size([18422, 500])
torch.Size([14543, 256])
torch.Size([8552, 256])
torch.Size([2197, 256])
torch.Size([481, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.1346750259399414  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.04219388961791992  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

torch.Size([18660, 500])
torch.Size([15479, 256])
torch.Size([8020, 256])
torch.Size([2044, 256])
torch.Size([279, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.1371293067932129  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.04217672348022461  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

torch.Size([18743, 500])
torch.Size([15134, 256])
torch.Size([8503, 256])
torch.Size([2234, 256])
torch.Size([463, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.13608312606811523  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.03735065460205078  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

torch.Size([16459, 500])
torch.Size([9852, 256])
torch.Size([4361, 256])
torch.Size([763, 256])
torch.Size([144, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.09031009674072266  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.03445148468017578  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

torch.Size([14846, 500])
torch.Size([9568, 256])
torch.Size([5275, 256])
torch.Size([1965, 256])
torch.Size([407, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.09703397750854492  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017484039068222046 |0.04391944408416748 |0.10204693675041199 |0.00014767050743103027 |0.008187562227249146 |0.00835871696472168 |
----------------------------------------------------------pseudo_mini_loss sum 2.8006012439727783
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  321625
Number of first layer input nodes during this epoch:  141998
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.04236316680908203  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0004894733428955078
random selection method range initialization spend 0.00011682510375976562
time for parepare:  5.173683166503906e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.6941299438476562e-05
----------------------check_connections_block total spend ----------------------------- 0.0016314983367919922
generate_one_block  0.0012862682342529297
generate_one_block  0.0010704994201660156
generate_one_block  0.0010361671447753906
generate_one_block  0.0010738372802734375
generate_one_block  0.0010454654693603516
generate_one_block  0.001155853271484375
generate_one_block  0.0010526180267333984
generate_one_block  0.001026153564453125
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005340576171875
gen group dst list time:  5.2928924560546875e-05
time for parepare:  0.00028204917907714844
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00013780593872070312
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00025153160095214844
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001239776611328125
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00018262863159179688
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  9.846687316894531e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00014734268188476562
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00029730796813964844
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00013709068298339844
----------------------check_connections_block total spend ----------------------------- 0.0034918785095214844
generate_one_block  0.0011987686157226562
generate_one_block  0.0013298988342285156
generate_one_block  0.001163482666015625
generate_one_block  0.0012323856353759766
generate_one_block  0.0011210441589355469
generate_one_block  0.0011932849884033203
generate_one_block  0.001397848129272461
generate_one_block  0.0011756420135498047
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012159347534179688
gen group dst list time:  0.00010800361633300781
time for parepare:  0.0008072853088378906
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.000728607177734375
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.00021386146545410156
r_  generation:  0.001711130142211914
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.0009212493896484375
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  0.0001480579376220703
r_  generation:  0.0013415813446044922
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  8.7738037109375e-05
r_  generation:  0.0004906654357910156
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.000766754150390625
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  0.0001983642578125
r_  generation:  0.0022487640380859375
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.000873565673828125
----------------------check_connections_block total spend ----------------------------- 0.015248298645019531
generate_one_block  0.0018873214721679688
generate_one_block  0.0032303333282470703
generate_one_block  0.0019774436950683594
generate_one_block  0.002631664276123047
generate_one_block  0.0030570030212402344
generate_one_block  0.0018076896667480469
generate_one_block  0.0036554336547851562
generate_one_block  0.001996755599975586
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001867532730102539
gen group dst list time:  0.0002872943878173828
time for parepare:  0.0014979839324951172
local_output_nid generation:  0.00012183189392089844
local_in_edges_tensor generation:  0.0005750656127929688
mini_batch_src_global generation:  0.0003993511199951172
r_  generation:  0.00397181510925293
local_output_nid generation:  0.00021886825561523438
local_in_edges_tensor generation:  0.0004928112030029297
mini_batch_src_global generation:  0.0007658004760742188
r_  generation:  0.0072879791259765625
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.000370025634765625
mini_batch_src_global generation:  0.0006461143493652344
r_  generation:  0.005600929260253906
local_output_nid generation:  0.00020122528076171875
local_in_edges_tensor generation:  0.0004515647888183594
mini_batch_src_global generation:  0.0007071495056152344
r_  generation:  0.006726503372192383
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.00023698806762695312
mini_batch_src_global generation:  0.00036644935607910156
r_  generation:  0.0025107860565185547
local_output_nid generation:  0.00010395050048828125
local_in_edges_tensor generation:  0.0002777576446533203
mini_batch_src_global generation:  0.00034689903259277344
r_  generation:  0.0036814212799072266
local_output_nid generation:  0.0002307891845703125
local_in_edges_tensor generation:  0.0005209445953369141
mini_batch_src_global generation:  0.0008866786956787109
r_  generation:  0.009810209274291992
local_output_nid generation:  0.0001652240753173828
local_in_edges_tensor generation:  0.00036215782165527344
mini_batch_src_global generation:  0.0006055831909179688
r_  generation:  0.004840373992919922
----------------------check_connections_block total spend ----------------------------- 0.06598281860351562
generate_one_block  0.0065310001373291016
generate_one_block  0.010118961334228516
generate_one_block  0.008140325546264648
generate_one_block  0.011384725570678711
generate_one_block  0.00426936149597168
generate_one_block  0.005849599838256836
generate_one_block  0.013892650604248047
generate_one_block  0.0071544647216796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002049684524536133
gen group dst list time:  0.00113677978515625
time for parepare:  0.001617431640625
local_output_nid generation:  0.0005896091461181641
local_in_edges_tensor generation:  0.0013954639434814453
mini_batch_src_global generation:  0.0009329319000244141
r_  generation:  0.011867761611938477
local_output_nid generation:  0.0006742477416992188
local_in_edges_tensor generation:  0.0012121200561523438
mini_batch_src_global generation:  0.0016188621520996094
r_  generation:  0.01586318016052246
local_output_nid generation:  0.0006325244903564453
local_in_edges_tensor generation:  0.0011584758758544922
mini_batch_src_global generation:  0.0014603137969970703
r_  generation:  0.015182256698608398
local_output_nid generation:  0.0007421970367431641
local_in_edges_tensor generation:  0.0011463165283203125
mini_batch_src_global generation:  0.001483917236328125
r_  generation:  0.017184734344482422
local_output_nid generation:  0.0004947185516357422
local_in_edges_tensor generation:  0.0007588863372802734
mini_batch_src_global generation:  0.0010647773742675781
r_  generation:  0.011526823043823242
local_output_nid generation:  0.0006241798400878906
local_in_edges_tensor generation:  0.0009446144104003906
mini_batch_src_global generation:  0.0009851455688476562
r_  generation:  0.013518810272216797
local_output_nid generation:  0.0010826587677001953
local_in_edges_tensor generation:  0.0014753341674804688
mini_batch_src_global generation:  0.0016834735870361328
r_  generation:  0.02022528648376465
local_output_nid generation:  0.0006327629089355469
local_in_edges_tensor generation:  0.000904083251953125
mini_batch_src_global generation:  0.001346588134765625
r_  generation:  0.014953851699829102
----------------------check_connections_block total spend ----------------------------- 0.17479300498962402
generate_one_block  0.015223026275634766
generate_one_block  0.02160024642944336
generate_one_block  0.019951343536376953
generate_one_block  0.0234529972076416
generate_one_block  0.016669750213623047
generate_one_block  0.017578125
generate_one_block  0.026515722274780273
generate_one_block  0.01793837547302246
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018482208251953125
gen group dst list time:  0.0025806427001953125
time for parepare:  0.001833200454711914
local_output_nid generation:  0.0011839866638183594
local_in_edges_tensor generation:  0.002081155776977539
mini_batch_src_global generation:  0.0017905235290527344
r_  generation:  0.020183324813842773
local_output_nid generation:  0.001298666000366211
local_in_edges_tensor generation:  0.002434253692626953
mini_batch_src_global generation:  0.003734588623046875
r_  generation:  0.022554636001586914
local_output_nid generation:  0.0013308525085449219
local_in_edges_tensor generation:  0.0018231868743896484
mini_batch_src_global generation:  0.0018489360809326172
r_  generation:  0.021695852279663086
local_output_nid generation:  0.0014586448669433594
local_in_edges_tensor generation:  0.002249002456665039
mini_batch_src_global generation:  0.0018546581268310547
r_  generation:  0.024027585983276367
local_output_nid generation:  0.0013113021850585938
local_in_edges_tensor generation:  0.0016815662384033203
mini_batch_src_global generation:  0.0017733573913574219
r_  generation:  0.022389888763427734
local_output_nid generation:  0.0013060569763183594
local_in_edges_tensor generation:  0.002012491226196289
mini_batch_src_global generation:  0.0019736289978027344
r_  generation:  0.022406339645385742
local_output_nid generation:  0.0014867782592773438
local_in_edges_tensor generation:  0.0023546218872070312
mini_batch_src_global generation: Using backend: pytorch
 0.0019936561584472656
r_  generation:  0.0253140926361084
local_output_nid generation:  0.0013549327850341797
local_in_edges_tensor generation:  0.001931905746459961
mini_batch_src_global generation:  0.001905679702758789
r_  generation:  0.024151325225830078
----------------------check_connections_block total spend ----------------------------- 0.267317533493042
generate_one_block  0.025020360946655273
generate_one_block  0.02953338623046875
generate_one_block  0.030924558639526367
generate_one_block  0.0326533317565918
generate_one_block  0.02710700035095215
generate_one_block  0.02846050262451172
generate_one_block  0.03235006332397461
generate_one_block  0.028660058975219727
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.04236316680908203  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

connection checking time:  0.5268335342407227
block generation total time  0.49103593826293945
average batch blocks generation time:  0.06137949228286743
block dataloader generation time/epoch 1.0830307006835938
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.04481172561645508  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

torch.Size([17306, 500])
torch.Size([11632, 256])
torch.Size([5908, 256])
torch.Size([1324, 256])
torch.Size([311, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.11477231979370117  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.04615592956542969  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

torch.Size([17871, 500])
torch.Size([13408, 256])
torch.Size([7385, 256])
torch.Size([2312, 256])
torch.Size([503, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.1313953399658203  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.04554176330566406  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

torch.Size([17594, 500])
torch.Size([12761, 256])
torch.Size([6991, 256])
torch.Size([1510, 256])
torch.Size([287, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.1236720085144043  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.047061920166015625  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

torch.Size([18336, 500])
torch.Size([14825, 256])
torch.Size([7987, 256])
torch.Size([2446, 256])
torch.Size([404, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.13974809646606445  GigaBytes
Max Memory Allocated: 0.1431102752685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.04521465301513672  GigaBytes
Max Memory Allocated: 0.1434311866760254  GigaBytes

torch.Size([17529, 500])
torch.Size([11747, 256])
torch.Size([4606, 256])
torch.Size([864, 256])
torch.Size([195, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.10625076293945312  GigaBytes
Max Memory Allocated: 0.1434311866760254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.04606962203979492  GigaBytes
Max Memory Allocated: 0.1434311866760254  GigaBytes

torch.Size([17929, 500])
torch.Size([12530, 256])
torch.Size([6211, 256])
torch.Size([1165, 256])
torch.Size([313, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.11865901947021484  GigaBytes
Max Memory Allocated: 0.1434311866760254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5291748046875 GB
    Memory Allocated: 0.048304080963134766  GigaBytes
Max Memory Allocated: 0.1434311866760254  GigaBytes

torch.Size([18910, 500])
torch.Size([15681, 256])
torch.Size([11188, 256])
torch.Size([2758, 256])
torch.Size([640, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5291748046875 GB
    Memory Allocated: 0.16019058227539062  GigaBytes
Max Memory Allocated: 0.160552978515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5291748046875 GB
    Memory Allocated: 0.04638385772705078  GigaBytes
Max Memory Allocated: 0.16690921783447266  GigaBytes

torch.Size([18087, 500])
torch.Size([13911, 256])
torch.Size([6223, 256])
torch.Size([1774, 256])
torch.Size([266, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5291748046875 GB
    Memory Allocated: 0.1256427764892578  GigaBytes
Max Memory Allocated: 0.16690921783447266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013840794563293457 |0.0021113157272338867 |0.007411837577819824 |0.00013783574104309082 |0.006021559238433838 |0.006184577941894531 |
----------------------------------------------------------pseudo_mini_loss sum 2.224597692489624
Total (block generation + training)time/epoch 1.339137077331543
Training time/epoch 0.25551772117614746
Training time without block to device /epoch 0.23862719535827637
Training time without total dataloading part /epoch 0.11475443840026855
load block tensor time/epoch 0.11072635650634766
block to device time/epoch 0.016890525817871094
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  323985
Number of first layer input nodes during this epoch:  143562
