main start at this time 1648533346.0157437
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002933979034423828  GigaBytes
Max Memory Allocated: 0.002933979034423828  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001890420913696289
random selection method range initialization spend 0.0001990795135498047
time for parepare:  5.888938903808594e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0015785694122314453
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.7670135498046875e-05
----------------------check_connections_block total spend ----------------------------- 0.0028874874114990234
generate_one_block  0.001970529556274414
generate_one_block  0.0013096332550048828
generate_one_block  0.0012958049774169922
generate_one_block  0.0012903213500976562
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011637210845947266
gen group dst list time:  4.2438507080078125e-05
time for parepare:  0.00032448768615722656
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0004684925079345703
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0003421306610107422
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0004134178161621094
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0003669261932373047
----------------------check_connections_block total spend ----------------------------- 0.003428220748901367
generate_one_block  0.0019114017486572266
generate_one_block  0.0017390251159667969
generate_one_block  0.0017921924591064453
generate_one_block  0.0017232894897460938
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013132095336914062
gen group dst list time:  9.465217590332031e-05
time for parepare:  0.0009903907775878906
local_output_nid generation:  8.821487426757812e-05
local_in_edges_tensor generation:  0.0003998279571533203
mini_batch_src_global generation:  0.00029921531677246094
r_  generation:  0.003225088119506836
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00024962425231933594
mini_batch_src_global generation:  0.0002887248992919922
r_  generation:  0.0018851757049560547
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.00026869773864746094
mini_batch_src_global generation:  0.0002753734588623047
r_  generation:  0.0026252269744873047
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00025773048400878906
mini_batch_src_global generation:  0.00028777122497558594
r_  generation:  0.0023488998413085938
----------------------check_connections_block total spend ----------------------------- 0.0165102481842041
generate_one_block  0.004436492919921875
generate_one_block  0.0028488636016845703
generate_one_block  0.0036728382110595703
generate_one_block  0.003808259963989258
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019068717956542969
gen group dst list time:  0.0002346038818359375
time for parepare:  0.0016641616821289062
local_output_nid generation:  0.0002739429473876953
local_in_edges_tensor generation:  0.0008347034454345703
mini_batch_src_global generation:  0.0011718273162841797
r_  generation:  0.011044740676879883
local_output_nid generation:  0.00023174285888671875
local_in_edges_tensor generation:  0.001171112060546875
mini_batch_src_global generation:  0.0011181831359863281
r_  generation:  0.007676839828491211
local_output_nid generation:  0.0002815723419189453
local_in_edges_tensor generation:  0.0006186962127685547
mini_batch_src_global generation:  0.0008347034454345703
r_  generation:  0.008811473846435547
local_output_nid generation:  0.00022172927856445312
local_in_edges_tensor generation:  0.000484466552734375
mini_batch_src_global generation:  0.0008115768432617188
r_  generation:  0.008218765258789062
----------------------check_connections_block total spend ----------------------------- 0.054383039474487305
generate_one_block  0.014681339263916016
generate_one_block  0.012142181396484375
generate_one_block  0.01354360580444336
generate_one_block  0.012065649032592773
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020825862884521484
gen group dst list time:  0.0009369850158691406
time for parepare:  0.0018854141235351562
local_output_nid generation:  0.0011093616485595703
local_in_edges_tensor generation:  0.0027289390563964844
mini_batch_src_global generation:  0.0023088455200195312
r_  generation:  0.021805524826049805
local_output_nid generation:  0.0009815692901611328
local_in_edges_tensor generation:  0.0016145706176757812
mini_batch_src_global generation:  0.0022623538970947266
r_  generation:  0.01975226402282715
local_output_nid generation:  0.0010917186737060547
local_in_edges_tensor generation:  0.0015685558319091797
mini_batch_src_global generation:  0.0020406246185302734
r_  generation:  0.021671533584594727
local_output_nid generation:  0.0008821487426757812
local_in_edges_tensor generation:  0.0012366771697998047
mini_batch_src_global generation:  0.001668691635131836
r_  generation:  0.019137144088745117
----------------------check_connections_block total spend ----------------------------- 0.12221860885620117
generate_one_block  0.02690911293029785
generate_one_block  0.026414155960083008
generate_one_block  0.028168439865112305
generate_one_block  0.025849103927612305
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019769668579101562
gen group dst list time:  0.0015573501586914062
time for parepare:  0.0017218589782714844
local_output_nid generation:  0.0015001296997070312
local_in_edges_tensor generation:  0.0025076866149902344
mini_batch_src_global generation:  0.0022890567779541016
r_  generation:  0.025841951370239258
local_output_nid generation:  0.0016956329345703125
local_in_edges_tensor generation:  0.0026636123657226562
mini_batch_src_global generation:  0.002828359603881836
r_  generation:  0.025191783905029297
local_output_nid generation:  0.0016655921936035156
local_in_edges_tensor generation:  0.0025246143341064453
mini_batch_src_global generation:  0.0022449493408203125
r_  generation:  0.026468276977539062
local_output_nid generation:  0.0013687610626220703
local_in_edges_tensor generation:  0.002012968063354492
mini_batch_src_global generation:  0.0018570423126220703
r_  generation:  0.024219989776611328
----------------------check_connections_block total spend ----------------------------- 0.15044832229614258
generate_one_block  0.03047776222229004
generate_one_block  0.032414913177490234
generate_one_block  0.03209996223449707
generate_one_block  0.030193805694580078
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002933979034423828  GigaBytes
Max Memory Allocated: 0.002933979034423828  GigaBytes

connection checking time:  0.3469884395599365
block generation total time  0.30689239501953125
average batch blocks generation time:  0.07672309875488281
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1229248046875 GB
    Memory Allocated: 0.03992938995361328  GigaBytes
Max Memory Allocated: 0.03992938995361328  GigaBytes

torch.Size([19081, 500])
torch.Size([16589, 256])
torch.Size([12188, 256])
torch.Size([3414, 256])
torch.Size([846, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.16117334365844727  GigaBytes
Max Memory Allocated: 0.16160821914672852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5115966796875 GB
    Memory Allocated: 0.042302608489990234  GigaBytes
Max Memory Allocated: 0.16867303848266602  GigaBytes

torch.Size([18873, 500])
torch.Size([15747, 256])
torch.Size([9922, 256])
torch.Size([2670, 256])
torch.Size([602, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.14791631698608398  GigaBytes
Max Memory Allocated: 0.16867303848266602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.042951107025146484  GigaBytes
Max Memory Allocated: 0.16867303848266602  GigaBytes

torch.Size([19161, 500])
torch.Size([17231, 256])
torch.Size([11249, 256])
torch.Size([3557, 256])
torch.Size([772, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.16277790069580078  GigaBytes
Max Memory Allocated: 0.16867303848266602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.04130697250366211  GigaBytes
Max Memory Allocated: 0.16867303848266602  GigaBytes

torch.Size([18333, 500])
torch.Size([14803, 256])
torch.Size([9304, 256])
torch.Size([2959, 256])
torch.Size([652, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.14267873764038086  GigaBytes
Max Memory Allocated: 0.16867303848266602  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014603972434997559 |0.0868181586265564 |0.19857215881347656 |0.00018388032913208008 |0.010302424430847168 |0.008185863494873047 |
----------------------------------------------------------pseudo_mini_loss sum 3.257305860519409
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  198310
Number of first layer input nodes during this epoch:  75448
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.050031185150146484  GigaBytes
Max Memory Allocated: 0.16867303848266602  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005064010620117188
random selection method range initialization spend 0.00011587142944335938
time for parepare:  5.0067901611328125e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.76837158203125e-05
----------------------check_connections_block total spend ----------------------------- 0.0010020732879638672
generate_one_block  0.0011715888977050781
generate_one_block  0.0010802745819091797
generate_one_block  0.0011363029479980469
generate_one_block  0.001062631607055664
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005242824554443359
gen group dst list time:  3.361701965332031e-05
time for parepare:  0.0002753734588623047
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.000354766845703125
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.00031638145446777344
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0001971721649169922
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.00046634674072265625
----------------------check_connections_block total spend ----------------------------- 0.002851247787475586
generate_one_block  0.0027604103088378906
generate_one_block  0.0013937950134277344
generate_one_block  0.0012941360473632812
generate_one_block  0.0016751289367675781
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001199483871459961
gen group dst list time:  8.940696716308594e-05
time for parepare:  0.0008788108825683594
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.0003361701965332031
mini_batch_src_global generation:  0.0002551078796386719
r_  generation:  0.0024566650390625
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  0.0002675056457519531
r_  generation:  0.0022330284118652344
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  0.000148773193359375
r_  generation:  0.00104522705078125
local_output_nid generation:  8.249282836914062e-05
local_in_edges_tensor generation:  0.0002551078796386719
mini_batch_src_global generation:  0.00026798248291015625
r_  generation:  0.0032281875610351562
----------------------check_connections_block total spend ----------------------------- 0.014386892318725586
generate_one_block  0.004297971725463867
generate_one_block  0.003734111785888672
generate_one_block  0.002074718475341797
generate_one_block  0.005036830902099609
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020096302032470703
gen group dst list time:  0.00025844573974609375
time for parepare:  0.0013980865478515625
local_output_nid generation:  0.0002713203430175781
local_in_edges_tensor generation:  0.0009202957153320312
mini_batch_src_global generation:  0.0008814334869384766
r_  generation:  0.010227203369140625
local_output_nid generation:  0.0003139972686767578
local_in_edges_tensor generation:  0.0006396770477294922
mini_batch_src_global generation:  0.0010831356048583984
r_  generation:  0.010275840759277344
local_output_nid generation:  0.00016260147094726562
local_in_edges_tensor generation:  0.0003826618194580078Using backend: pytorch

mini_batch_src_global generation:  0.0006561279296875
r_  generation:  0.005414009094238281
local_output_nid generation:  0.00039267539978027344
local_in_edges_tensor generation:  0.0007309913635253906
mini_batch_src_global generation:  0.0010561943054199219
r_  generation:  0.013206720352172852
----------------------check_connections_block total spend ----------------------------- 0.057737112045288086
generate_one_block  0.015481710433959961
generate_one_block  0.015104055404663086
generate_one_block  0.008595466613769531
generate_one_block  0.017055988311767578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020265579223632812
gen group dst list time:  0.0008635520935058594
time for parepare:  0.0015671253204345703
local_output_nid generation:  0.0009272098541259766
local_in_edges_tensor generation:  0.002359151840209961
mini_batch_src_global generation:  0.001965045928955078
r_  generation:  0.020401477813720703
local_output_nid generation:  0.0009975433349609375
local_in_edges_tensor generation:  0.0019145011901855469
mini_batch_src_global generation:  0.002596139907836914
r_  generation:  0.0209810733795166
local_output_nid generation:  0.0009105205535888672
local_in_edges_tensor generation:  0.0011966228485107422
mini_batch_src_global generation:  0.0014100074768066406
r_  generation:  0.017278194427490234
local_output_nid generation:  0.0012898445129394531
local_in_edges_tensor generation:  0.0017688274383544922
mini_batch_src_global generation:  0.00232696533203125
r_  generation:  0.023540258407592773
----------------------check_connections_block total spend ----------------------------- 0.12222719192504883
generate_one_block  0.025487899780273438
generate_one_block  0.029759883880615234
generate_one_block  0.02295660972595215
generate_one_block  0.03121042251586914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018947124481201172
gen group dst list time:  0.0013799667358398438
time for parepare:  0.0017185211181640625
local_output_nid generation:  0.001444101333618164
local_in_edges_tensor generation:  0.0027103424072265625
mini_batch_src_global generation:  0.0020339488983154297
r_  generation:  0.026463031768798828
local_output_nid generation:  0.0015978813171386719
local_in_edges_tensor generation:  0.002837657928466797
mini_batch_src_global generation:  0.0027489662170410156
r_  generation:  0.025966405868530273
local_output_nid generation:  0.0015850067138671875
local_in_edges_tensor generation:  0.0023183822631835938
mini_batch_src_global generation:  0.0019507408142089844
r_  generation:  0.02487778663635254
local_output_nid generation:  0.0018661022186279297
local_in_edges_tensor generation:  0.002519369125366211
mini_batch_src_global generation:  0.0023567676544189453
r_  generation:  0.027768611907958984
----------------------check_connections_block total spend ----------------------------- 0.15477490425109863
generate_one_block  0.030367612838745117
generate_one_block  0.032807111740112305
generate_one_block  0.03174543380737305
generate_one_block  0.032129764556884766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.050031185150146484  GigaBytes
Max Memory Allocated: 0.16867303848266602  GigaBytes

connection checking time:  0.3519773483276367
block generation total time  0.3149690628051758
average batch blocks generation time:  0.07874226570129395
block dataloader generation time/epoch 0.7223460674285889
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.04817008972167969  GigaBytes
Max Memory Allocated: 0.16867303848266602  GigaBytes

torch.Size([18833, 500])
torch.Size([15987, 256])
torch.Size([10669, 256])
torch.Size([3389, 256])
torch.Size([772, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.16027212142944336  GigaBytes
Max Memory Allocated: 0.16867303848266602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.0483708381652832  GigaBytes
Max Memory Allocated: 0.16867303848266602  GigaBytes

torch.Size([18930, 500])
torch.Size([16520, 256])
torch.Size([10832, 256])
torch.Size([3518, 256])
torch.Size([686, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.16253089904785156  GigaBytes
Max Memory Allocated: 0.16867303848266602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.04799509048461914  GigaBytes
Max Memory Allocated: 0.16867303848266602  GigaBytes

torch.Size([18568, 500])
torch.Size([14766, 256])
torch.Size([8246, 256])
torch.Size([1698, 256])
torch.Size([444, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.13801813125610352  GigaBytes
Max Memory Allocated: 0.16867303848266602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.04912424087524414  GigaBytes
Max Memory Allocated: 0.16867303848266602  GigaBytes

torch.Size([19251, 500])
torch.Size([17481, 256])
torch.Size([13259, 256])
torch.Size([4423, 256])
torch.Size([997, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.1833786964416504  GigaBytes
Max Memory Allocated: 0.1838059425354004  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010906994342803955 |0.0018590688705444336 |0.00829547643661499 |0.00014483928680419922 |0.00666576623916626 |0.006340503692626953 |
----------------------------------------------------------pseudo_mini_loss sum 2.0817551612854004
Total (block generation + training)time/epoch 0.8474462032318115
Training time/epoch 0.12479281425476074
Training time without block to device /epoch 0.11735653877258301
Training time without total dataloading part /epoch 0.06676483154296875
load block tensor time/epoch 0.04362797737121582
block to device time/epoch 0.007436275482177734
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  199626
Number of first layer input nodes during this epoch:  75582
