main start at this time 1648533179.0313818
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00016260147094726562  GigaBytes
Max Memory Allocated: 0.00016260147094726562  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.002004384994506836
random selection method range initialization spend 0.00019669532775878906
time for parepare:  4.0531158447265625e-05
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.0013625621795654297
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.726119995117188e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.606910705566406e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.535385131835938e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.8596649169921875e-05
----------------------check_connections_block total spend ----------------------------- 0.0029680728912353516
generate_one_block  0.0011856555938720703
generate_one_block  0.001001596450805664
generate_one_block  0.0009715557098388672
generate_one_block  0.0009891986846923828
generate_one_block  0.0009849071502685547
generate_one_block  0.0010533332824707031
generate_one_block  0.0009639263153076172
generate_one_block  0.0009496212005615234
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012104511260986328
gen group dst list time:  5.0067901611328125e-05
time for parepare:  0.00022721290588378906
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00014281272888183594
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0003490447998046875
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00023126602172851562
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0002048015594482422
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00013017654418945312
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  9.107589721679688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  8.845329284667969e-05
----------------------check_connections_block total spend ----------------------------- 0.00327301025390625
generate_one_block  0.0012578964233398438
generate_one_block  0.001392364501953125
generate_one_block  0.0012826919555664062
generate_one_block  0.0012950897216796875
generate_one_block  0.001001119613647461
generate_one_block  0.0011444091796875
generate_one_block  0.0011208057403564453
generate_one_block  0.001054525375366211
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012366771697998047
gen group dst list time:  8.7738037109375e-05
time for parepare:  0.0007691383361816406
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0002689361572265625
mini_batch_src_global generation:  0.00013875961303710938
r_  generation:  0.0011019706726074219
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  0.0002181529998779297
r_  generation:  0.002342700958251953
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.0002009868621826172
r_  generation:  0.0016231536865234375
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  0.0001442432403564453
r_  generation:  0.0011196136474609375
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0002613067626953125
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0009028911590576172
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0005176067352294922
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0004799365997314453
----------------------check_connections_block total spend ----------------------------- 0.013959169387817383
generate_one_block  0.0026183128356933594
generate_one_block  0.003972768783569336
generate_one_block  0.003160238265991211
generate_one_block  0.0022592544555664062
generate_one_block  0.0012068748474121094
generate_one_block  0.002110004425048828
generate_one_block  0.0015516281127929688
generate_one_block  0.0016007423400878906
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020368099212646484
gen group dst list time:  0.0002453327178955078
time for parepare:  0.0014243125915527344
local_output_nid generation:  0.0001895427703857422
local_in_edges_tensor generation:  0.0007736682891845703
mini_batch_src_global generation:  0.0008368492126464844
r_  generation:  0.006782054901123047
local_output_nid generation:  0.0002200603485107422
local_in_edges_tensor generation:  0.0005335807800292969
mini_batch_src_global generation:  0.0011065006256103516
r_  generation:  0.009671688079833984
local_output_nid generation:  0.00016999244689941406
local_in_edges_tensor generation:  0.0004239082336425781
mini_batch_src_global generation:  0.0007226467132568359
r_  generation:  0.006804704666137695
local_output_nid generation:  0.000164031982421875
local_in_edges_tensor generation:  0.0003566741943359375
mini_batch_src_global generation:  0.00048065185546875
r_  generation:  0.0045244693756103516
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.00023984909057617188
r_  generation:  0.0017392635345458984
local_output_nid generation:  0.0001671314239501953
local_in_edges_tensor generation:  0.0003814697265625
mini_batch_src_global generation:  0.0005028247833251953
r_  generation:  0.005803108215332031
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.00025343894958496094
mini_batch_src_global generation:  0.0004088878631591797
r_  generation:  0.003584146499633789
local_output_nid generation:  8.654594421386719e-05
local_in_edges_tensor generation:  0.00023508071899414062
mini_batch_src_global generation:  0.0002980232238769531
r_  generation:  0.002735614776611328
----------------------check_connections_block total spend ----------------------------- 0.062325477600097656
generate_one_block  0.010837554931640625
generate_one_block  0.014937162399291992
generate_one_block  0.009972333908081055
generate_one_block  0.006757497787475586
generate_one_block  0.0030748844146728516
generate_one_block  0.008913755416870117
generate_one_block  0.005784273147583008
generate_one_block  0.004483222961425781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022165775299072266
gen group dst list time:  0.0011627674102783203
time for parepare:  0.0017046928405761719
local_output_nid generation:  0.0007610321044921875
local_in_edges_tensor generation:  0.0020978450775146484
mini_batch_src_global generation:  0.0018620491027832031
r_  generation:  0.017228126525878906
local_output_nid generation:  0.000926971435546875
local_in_edges_tensor generation:  0.001870870590209961
mini_batch_src_global generation:  0.00231170654296875
r_  generation:  0.019819021224975586
local_output_nid generation:  0.0006690025329589844
local_in_edges_tensor generation:  0.001186370849609375
mini_batch_src_global generation:  0.001331329345703125
r_  generation:  0.015366315841674805
local_output_nid generation:  0.0005869865417480469
local_in_edges_tensor generation:  0.0008912086486816406
mini_batch_src_global generation:  0.0009372234344482422
r_  generation:  0.012498855590820312
local_output_nid generation:  0.0002830028533935547
local_in_edges_tensor generation:  0.0005133152008056641
mini_batch_src_global generation:  0.0008399486541748047
r_  generation:  0.0077495574951171875
local_output_nid generation:  0.0006098747253417969
local_in_edges_tensor generation:  0.0009770393371582031
mini_batch_src_global generation:  0.0012235641479492188
r_  generation:  0.01629161834716797
local_output_nid generation:  0.0005548000335693359
local_in_edges_tensor generation:  0.0009434223175048828
mini_batch_src_global generation:  0.0010232925415039062
r_  generation:  0.013170719146728516
local_output_nid generation:  0.0003695487976074219
local_in_edges_tensor generation:  0.0006208419799804688
mini_batch_src_global generation:  0.0009882450103759766
r_  generation:  0.010835647583007812
----------------------check_connections_block total spend ----------------------------- 0.1649174690246582
generate_one_block  0.02487969398498535
generate_one_block  0.026263952255249023
generate_one_block  0.02031540870666504
generate_one_block  0.01608896255493164
generate_one_block  0.011535406112670898
generate_one_block  0.021871089935302734
generate_one_block  0.01836681365966797
generate_one_block  0.014835834503173828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017588138580322266
gen group dst list time:  0.0025930404663085938
time for parepare:  0.001651763916015625
local_output_nid generation:  0.0014934539794921875
local_in_edges_tensor generation:  0.0026161670684814453
mini_batch_src_global generation:  0.0020227432250976562
r_  generation:  0.023787260055541992
local_output_nid generation:  0.0012781620025634766
local_in_edges_tensor generation:  0.0025856494903564453
mini_batch_src_global generation:  0.0026578903198242188
r_  generation:  0.024255752563476562
local_output_nid generation:  0.001177072525024414
local_in_edges_tensor generation:  0.0021581649780273438
mini_batch_src_global generation:  0.0016980171203613281
r_  generation:  0.022192716598510742
local_output_nid generation:  0.0012803077697753906
local_in_edges_tensor generation:  0.003885507583618164
mini_batch_src_global generation:  0.0017328262329101562
r_  generation:  0.0206296443939209
local_output_nid generation:  0.0008254051208496094
local_in_edges_tensor generation:  0.001394510269165039
mini_batch_src_global generation:  0.001554727554321289
r_  generation:  0.017290353775024414
local_output_nid generation:  0.0013129711151123047
local_in_edges_tensor generation:  0.0018835067749023438
mini_batch_src_global generation:  0.0019121170043945312
r_  generation:  0.023605823516845703
local_output_nid generation:  0.0011899471282958984
local_in_edges_tensor generation:  0.0018541812896728516
mini_batch_src_global generation:  0.001840829849243164
r_  generation:  0.02141094207763672
local_output_nid generation:  0.001117706298828125
local_in_edges_tensor generation:  0.0017044544219970703
mini_batch_src_global generation:  0.0017402172088623047
r_  generation:  0.020693063735961914
----------------------check_connections_block total spend ----------------------------- 0.2558417320251465
generate_one_block  0.029138565063476562
generate_one_block  0.031174421310424805
generate_one_block  0.02804708480834961
generate_one_block  0.025876283645629883
generate_one_block  0.02311992645263672
generate_one_block  0.029030323028564453
generate_one_block  0.028036117553710938
generate_one_block  0.02647256851196289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00016260147094726562  GigaBytes
Max Memory Allocated: 0.00016260147094726562  GigaBytes

connection checking time:  0.500316858291626
block generation total time  0.46784186363220215
average batch blocks generation time:  0.05848023295402527
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03657245635986328  GigaBytes
Max Memory Allocated: 0.03657245635986328  GigaBytes

torch.Size([18470, 500])
torch.Size([15701, 32])
torch.Size([8426, 32])
torch.Size([2402, 32])
torch.Size([324, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.050124168395996094  GigaBytes
Max Memory Allocated: 0.05033445358276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.03696012496948242  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

torch.Size([18905, 500])
torch.Size([16062, 32])
torch.Size([11625, 32])
torch.Size([3161, 32])
torch.Size([737, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.05362653732299805  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03498554229736328  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

torch.Size([17983, 500])
torch.Size([13515, 32])
torch.Size([7865, 32])
torch.Size([2174, 32])
torch.Size([523, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.04754209518432617  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03440523147583008  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

torch.Size([17801, 500])
torch.Size([12800, 32])
torch.Size([6778, 32])
torch.Size([1956, 32])
torch.Size([468, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.04606962203979492  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.030063629150390625  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

torch.Size([15592, 500])
torch.Size([8414, 32])
torch.Size([3103, 32])
torch.Size([439, 32])
torch.Size([107, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.036226749420166016  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03539848327636719  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

torch.Size([18208, 500])
torch.Size([14597, 32])
torch.Size([7500, 32])
torch.Size([1952, 32])
torch.Size([332, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.047391414642333984  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03446388244628906  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

torch.Size([17809, 500])
torch.Size([12536, 32])
torch.Size([6346, 32])
torch.Size([1041, 32])
torch.Size([227, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.04544782638549805  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.032770633697509766  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

torch.Size([16960, 500])
torch.Size([11404, 32])
torch.Size([4243, 32])
torch.Size([964, 32])
torch.Size([166, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.040923118591308594  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011962860822677612 |0.044087618589401245 |0.10281038284301758 |0.00017076730728149414 |0.005320936441421509 |0.008086919784545898 |
----------------------------------------------------------pseudo_mini_loss sum 2.4583888053894043
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  319972
Number of first layer input nodes during this epoch:  141728
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03499412536621094  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0004858970642089844
random selection method range initialization spend 0.00011324882507324219
time for parepare:  4.792213439941406e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.8596649169921875e-05
----------------------check_connections_block total spend ----------------------------- 0.0015616416931152344
generate_one_block  0.0010941028594970703
generate_one_block  0.0010521411895751953
generate_one_block  0.0009975433349609375
generate_one_block  0.0010018348693847656
generate_one_block  0.0010173320770263672
generate_one_block  0.0011415481567382812
generate_one_block  0.0010001659393310547
generate_one_block  0.0010225772857666016
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005319118499755859
gen group dst list time:  5.054473876953125e-05
time for parepare:  0.0002675056457519531
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00017952919006347656
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.00039005279541015625
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0001277923583984375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00020456314086914062
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  8.034706115722656e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00012826919555664062
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00013327598571777344
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0001220703125
----------------------check_connections_block total spend ----------------------------- 0.003488302230834961
generate_one_block  0.0012462139129638672
generate_one_block  0.0014584064483642578
generate_one_block  0.0011730194091796875
generate_one_block  0.0012471675872802734
generate_one_block  0.001068115234375
generate_one_block  0.0011706352233886719
generate_one_block  0.00115966796875
generate_one_block  0.0011336803436279297
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011205673217773438
gen group dst list time:  0.00010323524475097656
time for parepare:  0.0007827281951904297
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  0.00012087821960449219
r_  generation:  0.0010042190551757812
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0002224445343017578
mini_batch_src_global generation:  0.00031638145446777344
r_  generation:  0.0026459693908691406
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  0.00015544891357421875
r_  generation:  0.0008864402770996094
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.00016260147094726562
r_  generation:  0.0015873908996582031
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.000377655029296875
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0005228519439697266
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0008466243743896484
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  8.726119995117188e-05
r_  generation:  0.0007340908050537109
----------------------check_connections_block total spend ----------------------------- 0.01462244987487793
generate_one_block  0.002858877182006836
generate_one_block  0.004244327545166016
generate_one_block  0.0019450187683105469
generate_one_block  0.002914905548095703
generate_one_block  0.0013742446899414062
generate_one_block  0.001552581787109375
generate_one_block  0.0020258426666259766
generate_one_block  0.0017914772033691406
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019779205322265625
gen group dst list time:  0.0002703666687011719
time for parepare:  0.0014338493347167969
local_output_nid generation:  0.0001380443572998047
local_in_edges_tensor generation:  0.0006496906280517578
mini_batch_src_global generation:  0.0005714893341064453
r_  generation:  0.005437374114990234
local_output_nid generation:  0.00027179718017578125
local_in_edges_tensor generation:  0.0006995201110839844
mini_batch_src_global generation:  0.000904083251953125
r_  generation:  0.00979924201965332
local_output_nid generation:  0.00013065338134765625
local_in_edges_tensor generation:  0.0003349781036376953
mini_batch_src_global generation:  0.0006136894226074219
r_  generation:  0.004935264587402344
local_output_nid generation:  0.00016617774963378906
local_in_edges_tensor generation:  0.0003879070281982422
mini_batch_src_global generation:  0.0005929470062255859
r_  generation:  0.007647514343261719
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  0.0003337860107421875
r_  generation:  0.0022339820861816406
local_output_nid generation:  9.226799011230469e-05
local_in_edges_tensor generation:  0.0002434253692626953
mini_batch_src_global generation:  0.00028705596923828125
r_  generation:  0.0029304027557373047
local_output_nid generation:  0.00016617774963378906
local_in_edges_tensor generation:  0.0003521442413330078
mini_batch_src_global generation:  0.0004534721374511719
r_  generation:  0.005060672760009766
local_output_nid generation:  0.00011777877807617188
local_in_edges_tensor generation:  0.00029349327087402344
mini_batch_src_global generation:  0.0004544258117675781
r_  generation:  0.004135608673095703
----------------------check_connections_block total spend ----------------------------- 0.062232255935668945
generate_one_block  0.008980989456176758
generate_one_block  0.013448476791381836
generate_one_block  0.0074923038482666016
generate_one_block  0.010226964950561523
generate_one_block  0.004168987274169922
generate_one_block  0.004831552505493164
generate_one_block  0.008154153823852539
generate_one_block  0.006595611572265625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022792816162109375
gen group dst list time:  0.0010297298431396484
time for parepare:  0.0015408992767333984
local_output_nid generation:  0.0007412433624267578
local_in_edges_tensor generation:  0.0017349720001220703
mini_batch_src_global generation:  0.0013422966003417969
r_  generation:  0.016927719116210938
local_output_nid generation:  0.0008881092071533203
local_in_edges_tensor generation:  0.0017118453979492188
mini_batch_src_global generation:  0.002307415008544922
r_  generation:  0.01952052116394043
local_output_nid generation:  0.0004925727844238281
local_in_edges_tensor generation:  0.0009353160858154297
mini_batch_src_global generation:  0.0011708736419677734
r_  generation:  0.012511014938354492
local_output_nid generation:  0.0006060600280761719
local_in_edges_tensor generation:  0.0011129379272460938
mini_batch_src_global generation:  0.0010979175567626953
r_  generation:  0.014076471328735352
local_output_nid generation:  0.0004436969757080078
local_in_edges_tensor generation:  0.0006558895111083984
mini_batch_src_global generation:  0.0011837482452392578
r_  generation:  0.010298490524291992
local_output_nid generation:  0.0005218982696533203
local_in_edges_tensor generation:  0.0007607936859130859
mini_batch_src_global generation:  0.0008573532104492188
r_  generation:  0.012905359268188477
local_output_nid generation:  0.0007677078247070312
local_in_edges_tensor generation:  0.001646280288696289
mini_batch_src_global generation:  0.0013129711151123047
r_  generation:  0.01638007164001465
local_output_nid generation:  0.0007417201995849609
local_in_edges_tensor generation:  0.0009627342224121094
mini_batch_src_global generation:  0.0010905265808105469
r_  generation:  0.01287698745727539
----------------------check_connections_block total spend ----------------------------- 0.16865205764770508
generate_one_block  0.020113229751586914
generate_one_block  0.026377439498901367
generate_one_block  0.017657995223999023
generate_one_block  0.018508434295654297
generate_one_block  0.014212369918823242
generate_one_block  0.015682697296142578
generate_one_block  0.022463560104370117
generate_one_block  0.016009092330932617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001825094223022461
gen group dst list time:  0.002490997314453125
time for parepare:  0.0018227100372314453
local_output_nid generation:  0.0013332366943359375
local_in_edges_tensor generation:  0.00351715087890625
mini_batch_src_global generation:  0.0021457672119140625
r_  generation:  0.022182703018188477
local_output_nid generation:  0.0014576911926269531
local_in_edges_tensor generation:  0.002749204635620117
mini_batch_src_global generation:  0.0026197433471679688
r_  generation:  0.024987220764160156
local_output_nid generation:  0.0011515617370605469
local_in_edges_tensor generation:  0.0015377998352050781
mini_batch_src_global generation:  0.0017137527465820312
r_  generation:  0.01989126205444336
local_output_nid generation:  0.0012187957763671875
local_in_edges_tensor generation:  0.0018360614776611328
mini_batch_src_global generation:  0.001699209213256836
r_  generation:  0.02114105224609375
local_output_nid generation:  0.0011539459228515625
local_in_edges_tensor generation:  0.002057790756225586
mini_batch_src_global generation:  0.001689910888671875
r_  generation:  0.019984006881713867
local_output_nid generation:  0.0011682510375976562
local_in_edges_tensor generation:  0.0015463829040527344
mini_batch_src_global generation:  0.0017447471618652344
r_  generation:  0.020839691162109375
local_output_nid generation:  0.0013327598571777344
local_in_edges_tensor generation:  0.0025086402893066406
mini_batch_src_global generation:  0.0019426345825195312
r_  generation:  0.025133371353149414
local_output_nid generation:  0.001199483871459961
local_in_edges_tensor generation:  0.0020127296447753906
mini_batch_src_global generation: Using backend: pytorch
 0.0017621517181396484
r_  generation:  0.021511316299438477
----------------------check_connections_block total spend ----------------------------- 0.2581164836883545
generate_one_block  0.02766108512878418
generate_one_block  0.031219482421875
generate_one_block  0.02975320816040039
generate_one_block  0.02735137939453125
generate_one_block  0.02569270133972168
generate_one_block  0.02793431282043457
generate_one_block  0.030505895614624023
generate_one_block  0.026518583297729492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03499412536621094  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

connection checking time:  0.5071115493774414
block generation total time  0.4699246883392334
average batch blocks generation time:  0.058740586042404175
block dataloader generation time/epoch 1.0467729568481445
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03507280349731445  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

torch.Size([17906, 500])
torch.Size([13429, 32])
torch.Size([7838, 32])
torch.Size([1610, 32])
torch.Size([421, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.04731178283691406  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.037067413330078125  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

torch.Size([18809, 500])
torch.Size([16493, 32])
torch.Size([10180, 32])
torch.Size([3428, 32])
torch.Size([736, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.05279731750488281  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.032587528228759766  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

torch.Size([16643, 500])
torch.Size([11193, 32])
torch.Size([5395, 32])
torch.Size([1543, 32])
torch.Size([248, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.041689395904541016  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.0337672233581543  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

torch.Size([17204, 500])
torch.Size([12210, 32])
torch.Size([6415, 32])
torch.Size([1971, 32])
torch.Size([454, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.04495668411254883  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.03278350830078125  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

torch.Size([16823, 500])
torch.Size([10587, 32])
torch.Size([4287, 32])
torch.Size([643, 32])
torch.Size([174, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.04042816162109375  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.0343012809753418  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

torch.Size([17601, 500])
torch.Size([11422, 32])
torch.Size([5121, 32])
torch.Size([1005, 32])
torch.Size([235, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.04301023483276367  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.036913394927978516  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

torch.Size([18521, 500])
torch.Size([15124, 32])
torch.Size([7695, 32])
torch.Size([1958, 32])
torch.Size([297, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.04956865310668945  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.035031795501708984  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

torch.Size([17971, 500])
torch.Size([12270, 32])
torch.Size([7054, 32])
torch.Size([1284, 32])
torch.Size([305, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.045984745025634766  GigaBytes
Max Memory Allocated: 0.07069015502929688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013372033834457397 |0.0018306970596313477 |0.006947815418243408 |0.00013694167137145996 |0.004899263381958008 |0.0035729408264160156 |
----------------------------------------------------------pseudo_mini_loss sum 2.1673269271850586
Total (block generation + training)time/epoch 1.2809178829193115
Training time/epoch 0.23352861404418945
Training time without block to device /epoch 0.21888303756713867
Training time without total dataloading part /epoch 0.09944510459899902
load block tensor time/epoch 0.10697627067565918
block to device time/epoch 0.014645576477050781
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  314860
Number of first layer input nodes during this epoch:  141478
