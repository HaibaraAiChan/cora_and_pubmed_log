main start at this time 1648533167.3999047
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00016260147094726562  GigaBytes
Max Memory Allocated: 0.00016260147094726562  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0015354156494140625
random selection method range initialization spend 0.0001995563507080078
time for parepare:  4.696846008300781e-05
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0014743804931640625
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.409385681152344e-05
----------------------check_connections_block total spend ----------------------------- 0.0026111602783203125
generate_one_block  0.0015480518341064453
generate_one_block  0.0011000633239746094
generate_one_block  0.0010831356048583984
generate_one_block  0.0010707378387451172
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0008742809295654297
gen group dst list time:  3.4332275390625e-05
time for parepare:  0.0002422332763671875
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.00048041343688964844
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.00036835670471191406
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0002636909484863281
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00023174285888671875
----------------------check_connections_block total spend ----------------------------- 0.0028357505798339844
generate_one_block  0.0017325878143310547
generate_one_block  0.001569509506225586
generate_one_block  0.0013804435729980469
generate_one_block  0.0013353824615478516
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010256767272949219
gen group dst list time:  7.581710815429688e-05
time for parepare:  0.0007627010345458984
local_output_nid generation:  8.034706115722656e-05
local_in_edges_tensor generation:  0.00035572052001953125
mini_batch_src_global generation:  0.0002853870391845703
r_  generation:  0.0034608840942382812
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.00023055076599121094
mini_batch_src_global generation:  0.00032138824462890625
r_  generation:  0.002359151840209961
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00018262863159179688
r_  generation:  0.0017459392547607422
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0012829303741455078
----------------------check_connections_block total spend ----------------------------- 0.014007329940795898
generate_one_block  0.0054912567138671875
generate_one_block  0.0036411285400390625
generate_one_block  0.002919912338256836
generate_one_block  0.0024487972259521484
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0016486644744873047
gen group dst list time:  0.00024175643920898438
time for parepare:  0.0014548301696777344
local_output_nid generation:  0.0003390312194824219
local_in_edges_tensor generation:  0.0009579658508300781
mini_batch_src_global generation:  0.001344442367553711
r_  generation:  0.013191938400268555
local_output_nid generation:  0.0002472400665283203
local_in_edges_tensor generation:  0.0012202262878417969
mini_batch_src_global generation:  0.0012340545654296875
r_  generation:  0.008339881896972656
local_output_nid generation:  0.0002493858337402344
local_in_edges_tensor generation:  0.0005464553833007812
mini_batch_src_global generation:  0.0007867813110351562
r_  generation:  0.008043766021728516
local_output_nid generation:  0.00017762184143066406
local_in_edges_tensor generation:  0.00040340423583984375
mini_batch_src_global generation:  0.000640869140625
r_  generation:  0.006407499313354492
----------------------check_connections_block total spend ----------------------------- 0.054418087005615234
generate_one_block  0.01672816276550293
generate_one_block  0.013634204864501953
generate_one_block  0.012738943099975586
generate_one_block  0.009630441665649414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00185394287109375
gen group dst list time:  0.0008709430694580078
time for parepare:  0.0017282962799072266
local_output_nid generation:  0.0010428428649902344
local_in_edges_tensor generation:  0.002689361572265625
mini_batch_src_global generation:  0.002309083938598633
r_  generation:  0.02297830581665039
local_output_nid generation:  0.0008952617645263672
local_in_edges_tensor generation:  0.0016102790832519531
mini_batch_src_global generation:  0.0021584033966064453
r_  generation:  0.019976139068603516
local_output_nid generation:  0.0010361671447753906
local_in_edges_tensor generation:  0.0017123222351074219
mini_batch_src_global generation:  0.0015897750854492188
r_  generation:  0.020474910736083984
local_output_nid generation:  0.0009050369262695312
local_in_edges_tensor generation:  0.0012865066528320312
mini_batch_src_global generation:  0.0016236305236816406
r_  generation:  0.019655227661132812
----------------------check_connections_block total spend ----------------------------- 0.12218952178955078
generate_one_block  0.027730703353881836
generate_one_block  0.02649664878845215
generate_one_block  0.02619004249572754
generate_one_block  0.025726318359375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017142295837402344
gen group dst list time:  0.0015156269073486328
time for parepare:  0.0017116069793701172
local_output_nid generation:  0.0014879703521728516
local_in_edges_tensor generation:  0.0026819705963134766
mini_batch_src_global generation:  0.002422809600830078
r_  generation:  0.026297569274902344
local_output_nid generation:  0.0013992786407470703
local_in_edges_tensor generation:  0.002682209014892578
mini_batch_src_global generation:  0.002721071243286133
r_  generation:  0.025046110153198242
local_output_nid generation:  0.0015957355499267578
local_in_edges_tensor generation:  0.0023462772369384766
mini_batch_src_global generation:  0.0023467540740966797
r_  generation:  0.025488853454589844
local_output_nid generation:  0.0015273094177246094
local_in_edges_tensor generation:  0.002154827117919922
mini_batch_src_global generation:  0.0020308494567871094
r_  generation:  0.02557659149169922
----------------------check_connections_block total spend ----------------------------- 0.15116167068481445
generate_one_block  0.03025341033935547
generate_one_block  0.031641244888305664
generate_one_block  0.03133726119995117
generate_one_block  0.030849456787109375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00016260147094726562  GigaBytes
Max Memory Allocated: 0.00016260147094726562  GigaBytes

connection checking time:  0.34461236000061035
block generation total time  0.30347585678100586
average batch blocks generation time:  0.07586896419525146
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.037374019622802734  GigaBytes
Max Memory Allocated: 0.037374019622802734  GigaBytes

torch.Size([19135, 500])
torch.Size([17235, 32])
torch.Size([13115, 32])
torch.Size([4510, 32])
torch.Size([1019, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.055626869201660156  GigaBytes
Max Memory Allocated: 0.05567741394042969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03681039810180664  GigaBytes
Max Memory Allocated: 0.07111883163452148  GigaBytes

torch.Size([18772, 500])
torch.Size([15642, 32])
torch.Size([10152, 32])
torch.Size([2972, 32])
torch.Size([763, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.05189323425292969  GigaBytes
Max Memory Allocated: 0.07111883163452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03691530227661133  GigaBytes
Max Memory Allocated: 0.07111883163452148  GigaBytes

torch.Size([18925, 500])
torch.Size([16329, 32])
torch.Size([10342, 32])
torch.Size([2917, 32])
torch.Size([592, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.05290508270263672  GigaBytes
Max Memory Allocated: 0.07111883163452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03672933578491211  GigaBytes
Max Memory Allocated: 0.07111883163452148  GigaBytes

torch.Size([18874, 500])
torch.Size([16098, 32])
torch.Size([9674, 32])
torch.Size([2357, 32])
torch.Size([504, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.05116748809814453  GigaBytes
Max Memory Allocated: 0.07111883163452148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024907171726226807 |0.08761078119277954 |0.19379639625549316 |0.0001704692840576172 |0.007087767124176025 |0.0037932395935058594 |
----------------------------------------------------------pseudo_mini_loss sum 2.0544309616088867
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  200284
Number of first layer input nodes during this epoch:  75706
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03983259201049805  GigaBytes
Max Memory Allocated: 0.07111883163452148  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005159378051757812
random selection method range initialization spend 0.00011730194091796875
time for parepare:  4.982948303222656e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  5.888938903808594e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.266334533691406e-05
----------------------check_connections_block total spend ----------------------------- 0.0010356903076171875
generate_one_block  0.0011851787567138672
generate_one_block  0.001070261001586914
generate_one_block  0.0011944770812988281
generate_one_block  0.001074075698852539
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005443096160888672
gen group dst list time:  3.4809112548828125e-05
time for parepare:  0.0002727508544921875
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0005419254302978516
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00022792816162109375
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0002903938293457031
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0002605915069580078
----------------------check_connections_block total spend ----------------------------- 0.002859354019165039
generate_one_block  0.0017464160919189453
generate_one_block  0.001325368881225586
generate_one_block  0.0014085769653320312
generate_one_block  0.0013914108276367188
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010979175567626953
gen group dst list time:  8.177757263183594e-05
time for parepare:  0.0008625984191894531
local_output_nid generation:  9.679794311523438e-05
local_in_edges_tensor generation:  0.0003707408905029297
mini_batch_src_global generation:  0.00034999847412109375
r_  generation:  0.0034372806549072266
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.0002484321594238281
r_  generation:  0.0016639232635498047
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.00019884109497070312
r_  generation:  0.00183868408203125
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.00018787384033203125
r_  generation:  0.0017850399017333984
----------------------check_connections_block total spend ----------------------------- 0.01411581039428711
generate_one_block  0.005381345748901367
generate_one_block  0.004488468170166016
generate_one_block  0.0031228065490722656
generate_one_block  0.003059864044189453
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002007722854614258
gen group dst list time:  0.0002472400665283203
time for parepare:  0.0014488697052001953
local_output_nid generation:  0.00031256675720214844
local_in_edges_tensor generation:  0.0009768009185791016
mini_batch_src_global generation:  0.0008966922760009766
r_  generation:  0.012328147888183594
local_output_nid generation:  0.00022149085998535156
local_in_edges_tensor generation:  0.0005099773406982422
mini_batch_src_global generation:  0.001031637191772461
r_  generation:  0.00785064697265625
local_output_nid generation:  0.00019812583923339844
local_in_edges_tensor generation:  0.00042247772216796875
mini_batch_src_global generation:  0.0007560253143310547
r_  generation:  0.006971120834350586Using backend: pytorch

local_output_nid generation:  0.0002703666687011719
local_in_edges_tensor generation:  0.0005731582641601562
mini_batch_src_global generation:  0.0007965564727783203
r_  generation:  0.008524894714355469
----------------------check_connections_block total spend ----------------------------- 0.05292344093322754
generate_one_block  0.016330480575561523
generate_one_block  0.012621641159057617
generate_one_block  0.011213541030883789
generate_one_block  0.013685226440429688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022804737091064453
gen group dst list time:  0.0008060932159423828
time for parepare:  0.0015807151794433594
local_output_nid generation:  0.0010671615600585938
local_in_edges_tensor generation:  0.002755403518676758
mini_batch_src_global generation:  0.0021593570709228516
r_  generation:  0.022858619689941406
local_output_nid generation:  0.0007758140563964844
local_in_edges_tensor generation:  0.0014126300811767578
mini_batch_src_global generation:  0.0021550655364990234
r_  generation:  0.01858687400817871
local_output_nid generation:  0.0008375644683837891
local_in_edges_tensor generation:  0.0012516975402832031
mini_batch_src_global generation:  0.0013747215270996094
r_  generation:  0.01740264892578125
local_output_nid generation:  0.0010890960693359375
local_in_edges_tensor generation:  0.001638650894165039
mini_batch_src_global generation:  0.001979827880859375
r_  generation:  0.021073341369628906
----------------------check_connections_block total spend ----------------------------- 0.11938142776489258
generate_one_block  0.027232646942138672
generate_one_block  0.025028705596923828
generate_one_block  0.021575212478637695
generate_one_block  0.03014516830444336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019927024841308594
gen group dst list time:  0.0013375282287597656
time for parepare:  0.0016584396362304688
local_output_nid generation:  0.0014824867248535156
local_in_edges_tensor generation:  0.0027055740356445312
mini_batch_src_global generation:  0.002111196517944336
r_  generation:  0.02602386474609375
local_output_nid generation:  0.0015003681182861328
local_in_edges_tensor generation:  0.002607583999633789
mini_batch_src_global generation:  0.0027077198028564453
r_  generation:  0.024889707565307617
local_output_nid generation:  0.0015170574188232422
local_in_edges_tensor generation:  0.0030739307403564453
mini_batch_src_global generation:  0.0021457672119140625
r_  generation:  0.023487567901611328
local_output_nid generation:  0.0016646385192871094
local_in_edges_tensor generation:  0.0027534961700439453
mini_batch_src_global generation:  0.0020580291748046875
r_  generation:  0.0260772705078125
----------------------check_connections_block total spend ----------------------------- 0.15038776397705078
generate_one_block  0.030602693557739258
generate_one_block  0.033380985260009766
generate_one_block  0.03003215789794922
generate_one_block  0.0317072868347168
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03983259201049805  GigaBytes
Max Memory Allocated: 0.07111883163452148  GigaBytes

connection checking time:  0.33966779708862305
block generation total time  0.3054800033569336
average batch blocks generation time:  0.0763700008392334
block dataloader generation time/epoch 0.6944022178649902
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.037662506103515625  GigaBytes
Max Memory Allocated: 0.07129621505737305  GigaBytes

torch.Size([19064, 500])
torch.Size([17030, 32])
torch.Size([12370, 32])
torch.Size([4111, 32])
torch.Size([1084, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.05581378936767578  GigaBytes
Max Memory Allocated: 0.07129621505737305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03705644607543945  GigaBytes
Max Memory Allocated: 0.07129716873168945  GigaBytes

torch.Size([18486, 500])
torch.Size([15285, 32])
torch.Size([8670, 32])
torch.Size([2648, 32])
torch.Size([476, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.05084800720214844  GigaBytes
Max Memory Allocated: 0.07129716873168945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.035599708557128906  GigaBytes
Max Memory Allocated: 0.07129716873168945  GigaBytes

torch.Size([18131, 500])
torch.Size([14034, 32])
torch.Size([7948, 32])
torch.Size([2390, 32])
torch.Size([599, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.048021793365478516  GigaBytes
Max Memory Allocated: 0.07129716873168945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.037531375885009766  GigaBytes
Max Memory Allocated: 0.07129716873168945  GigaBytes

torch.Size([19078, 500])
torch.Size([16854, 32])
torch.Size([11545, 32])
torch.Size([3198, 32])
torch.Size([653, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.05441904067993164  GigaBytes
Max Memory Allocated: 0.07129716873168945  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01423799991607666 |0.002165555953979492 |0.0071863532066345215 |0.0001392960548400879 |0.006015479564666748 |0.003217458724975586 |
----------------------------------------------------------pseudo_mini_loss sum 2.280033588409424
Total (block generation + training)time/epoch 0.823434591293335
Training time/epoch 0.12843680381774902
Training time without block to device /epoch 0.11977458000183105
Training time without total dataloading part /epoch 0.056581974029541016
load block tensor time/epoch 0.05695199966430664
block to device time/epoch 0.008662223815917969
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  194010
Number of first layer input nodes during this epoch:  74759
