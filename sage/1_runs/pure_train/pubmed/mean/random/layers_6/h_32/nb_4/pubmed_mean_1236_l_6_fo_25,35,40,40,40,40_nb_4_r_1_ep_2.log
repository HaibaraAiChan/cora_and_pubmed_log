main start at this time 1648533156.3947458
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00016260147094726562  GigaBytes
Max Memory Allocated: 0.00016260147094726562  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0019011497497558594
random selection method range initialization spend 0.00021696090698242188
time for parepare:  4.839897155761719e-05
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.001619577407836914
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  5.984306335449219e-05
----------------------check_connections_block total spend ----------------------------- 0.0024042129516601562
generate_one_block  0.0015745162963867188
generate_one_block  0.001230478286743164
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001203775405883789
gen group dst list time:  2.8848648071289062e-05
time for parepare:  0.00027680397033691406
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.0008490085601806641
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0005252361297607422
----------------------check_connections_block total spend ----------------------------- 0.0026824474334716797
generate_one_block  0.002421855926513672
generate_one_block  0.0017850399017333984
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011854171752929688
gen group dst list time:  7.43865966796875e-05
time for parepare:  0.0008342266082763672
local_output_nid generation:  0.00014019012451171875
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0005280971527099609
r_  generation:  0.005553483963012695
local_output_nid generation:  0.00010061264038085938
local_in_edges_tensor generation:  0.0002818107604980469
mini_batch_src_global generation:  0.0004162788391113281
r_  generation:  0.0030450820922851562
----------------------check_connections_block total spend ----------------------------- 0.013793706893920898
generate_one_block  0.007784843444824219
generate_one_block  0.004421710968017578
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002295970916748047
gen group dst list time:  0.00022268295288085938
time for parepare:  0.0015361309051513672
local_output_nid generation:  0.0005197525024414062
local_in_edges_tensor generation:  0.0016112327575683594
mini_batch_src_global generation:  0.0018033981323242188
r_  generation:  0.016275644302368164
local_output_nid generation:  0.00036454200744628906
local_in_edges_tensor generation:  0.0007281303405761719
mini_batch_src_global generation:  0.0015988349914550781
r_  generation:  0.01353001594543457
----------------------check_connections_block total spend ----------------------------- 0.045713186264038086
generate_one_block  0.02036571502685547
generate_one_block  0.01834273338317871
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002163410186767578
gen group dst list time:  0.0005900859832763672
time for parepare:  0.0018150806427001953
local_output_nid generation:  0.0014247894287109375
local_in_edges_tensor generation:  0.002804994583129883
mini_batch_src_global generation:  0.0025527477264404297
r_  generation:  0.024964332580566406
local_output_nid generation:  0.0010035037994384766
local_in_edges_tensor generation:  0.0022149085998535156
mini_batch_src_global generation:  0.002894163131713867
r_  generation:  0.023807048797607422
----------------------check_connections_block total spend ----------------------------- 0.07577657699584961
generate_one_block  0.028805971145629883
generate_one_block  0.029117107391357422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017933845520019531
gen group dst list time:  0.0007252693176269531
time for parepare:  0.0015730857849121094
local_output_nid generation:  0.0013797283172607422
local_in_edges_tensor generation:  0.0026504993438720703
mini_batch_src_global generation:  0.002075672149658203
r_  generation:  0.025658845901489258
local_output_nid generation:  0.0014376640319824219
local_in_edges_tensor generation:  0.002434253692626953
mini_batch_src_global generation:  0.002765178680419922
r_  generation:  0.025659561157226562
----------------------check_connections_block total spend ----------------------------- 0.07685446739196777
generate_one_block  0.031279802322387695
generate_one_block  0.03255105018615723
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00016260147094726562  GigaBytes
Max Memory Allocated: 0.00016260147094726562  GigaBytes

connection checking time:  0.21482038497924805
block generation total time  0.17687582969665527
average batch blocks generation time:  0.08843791484832764
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.0379338264465332  GigaBytes
Max Memory Allocated: 0.0379338264465332  GigaBytes

torch.Size([19362, 500])
torch.Size([17946, 32])
torch.Size([14760, 32])
torch.Size([5960, 32])
torch.Size([1658, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.05851411819458008  GigaBytes
Max Memory Allocated: 0.05858469009399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.03768730163574219  GigaBytes
Max Memory Allocated: 0.07222461700439453  GigaBytes

torch.Size([19241, 500])
torch.Size([17728, 32])
torch.Size([13015, 32])
torch.Size([4539, 32])
torch.Size([1061, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.056058406829833984  GigaBytes
Max Memory Allocated: 0.07222461700439453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01972651481628418 |0.17567682266235352 |0.3850226402282715 |0.0002181529998779297 |0.008513808250427246 |0.004781484603881836 |
----------------------------------------------------------pseudo_mini_loss sum 2.608651876449585
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  115625
Number of first layer input nodes during this epoch:  38603
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.04140043258666992  GigaBytes
Max Memory Allocated: 0.07222461700439453  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007531642913818359
random selection method range initialization spend 0.00015854835510253906
time for parepare:  7.009506225585938e-05
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  8.845329284667969e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00016427040100097656
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  8.392333984375e-05
----------------------check_connections_block total spend ----------------------------- 0.0010528564453125
generate_one_block  0.0020682811737060547
generate_one_block  0.0015316009521484375
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007555484771728516
gen group dst list time:  3.8623809814453125e-05
time for parepare:  0.0003764629364013672
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0002627372741699219
mini_batch_src_global generation:  0.0001266002655029297
r_  generation:  0.0008852481842041016
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  0.0001087188720703125
r_  generation:  0.0006513595581054688
----------------------check_connections_block total spend ----------------------------- 0.003158092498779297
generate_one_block  0.002664804458618164
generate_one_block  0.002218484878540039
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013434886932373047
gen group dst list time:  9.989738464355469e-05
time for parepare:  0.0010187625885009766
local_output_nid generation:  0.00015425682067871094
local_in_edges_tensor generation:  0.0005137920379638672
mini_batch_src_global generation:  0.0006515979766845703
r_  generation:  0.005701780319213867
local_output_nid generation:  0.00014591217041015625
local_in_edges_tensor generation:  0.000377655029296875
mini_batch_src_global generation:  0.0005102157592773438
r_  generation:  0.004112958908081055
----------------------check_connections_block total spend ----------------------------- 0.01593017578125
generate_one_block  0.007260799407958984
generate_one_block  0.005145549774169922
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0022478103637695312
gen group dst list time:  0.0002579689025878906
time for parepare:  0.0019404888153076172
local_output_nid generation:  0.0005497932434082031
local_in_edges_tensor generation:  0.0012710094451904297
mini_batch_src_global generation:  0.0016713142395019531
r_  generation:  0.017316818237304688
local_output_nid generation:  0.00040340423583984375
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.001986980438232422
r_  generation:  0.0135955810546875
----------------------check_connections_block total spend ----------------------------- 0.048174381256103516
generate_one_block  0.018950700759887695
generate_one_block  0.019201993942260742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018410682678222656
gen group dst list time:  0.0005514621734619141
time for parepare:  0.001634836196899414
local_output_nid generation:  0.003121614456176758
local_in_edges_tensor generation:  0.0046558380126953125
mini_batch_src_global generation:  0.004144430160522461
r_  generation:  0.02413463592529297
local_output_nid generation:  0.0017933845520019531
local_in_edges_tensor generation:  0.002382516860961914
mini_batch_src_global generation:  0.0028014183044433594
r_  generation:  0.02328944206237793
----------------------check_connections_block total spend ----------------------------- 0.0811164379119873
generate_one_block  0.02839040756225586
generate_one_block  0.031222105026245117
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018353462219238281
gen group dst list time:  0.0007319450378417969
time for parepare:  0.0015797615051269531
local_output_nid generation:  0.001405954360961914
local_in_edges_tensor generation:  0.002581357955932617
mini_batch_src_global generation:  0.0019075870513916016
r_  generation:  0.025851964950561523
local_output_nid generation:  0.0014770030975341797
local_in_edges_tensor generation:  0.002645730972290039
mini_batch_src_global generation:  0.002866983413696289
r_  generation:  0.026053905487060547
----------------------check_connections_block total spend ----------------------------- 0.07959103584289551
generate_one_block  0.030293941497802734
generate_one_block  0.0316166877746582
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.04140043258666992  GigaBytes
Max Memory Allocated: 0.07222461700439453  GigaBytes

connection checking time:  0.22797012329101562
block generation total time  0.17696547508239746
average batch blocks generation time:  0.08848273754119873
block dataloader generation time/epoch 0.4730184078216553
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.03807544708251953  GigaBytes
Max Memory Allocated: 0.07226276397705078  GigaBytes

torch.Size([19216, 500])
torch.Size([17776, 32])
torch.Size([13578, 32])
torch.Size([5534, 32])
torch.Size([1502, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.05762338638305664  GigaBytes
Max Memory Allocated: 0.07226276397705078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.03829193115234375  GigaBytes
Max Memory Allocated: 0.0724945068359375  GigaBytes

torch.Size([19365, 500])
torch.Size([17869, 32])
torch.Size([13820, 32])
torch.Size([4975, 32])
torch.Size([1241, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.057517051696777344  GigaBytes
Max Memory Allocated: 0.0724945068359375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014571785926818848 |0.0018631219863891602 |0.006461143493652344 |0.00015234947204589844 |0.006812930107116699 |0.0031158924102783203 |
----------------------------------------------------------pseudo_mini_loss sum 1.8396546840667725
Total (block generation + training)time/epoch 0.5392851829528809
Training time/epoch 0.06576871871948242
Training time without block to device /epoch 0.0620424747467041
Training time without total dataloading part /epoch 0.029968738555908203
load block tensor time/epoch 0.029143571853637695
block to device time/epoch 0.0037262439727783203
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  115231
Number of first layer input nodes during this epoch:  38581
