main start at this time 1648533250.8926244
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003743171691894531  GigaBytes
Max Memory Allocated: 0.0003743171691894531  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0019788742065429688
random selection method range initialization spend 0.00020170211791992188
time for parepare:  4.7206878662109375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.001682281494140625
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.821487426757812e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.1920928955078125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.8358230590820312e-05
----------------------check_connections_block total spend ----------------------------- 0.004395008087158203
generate_one_block  0.0015788078308105469
generate_one_block  0.0010304450988769531
generate_one_block  0.00102996826171875
generate_one_block  0.001032114028930664
generate_one_block  0.0009775161743164062
generate_one_block  0.0009853839874267578
generate_one_block  0.0009894371032714844
generate_one_block  0.0009801387786865234
generate_one_block  0.0009827613830566406
generate_one_block  0.0009477138519287109
generate_one_block  0.0009293556213378906
generate_one_block  0.0009746551513671875
generate_one_block  0.0009374618530273438
generate_one_block  0.0009405612945556641
generate_one_block  0.0009458065032958984
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0016968250274658203
gen group dst list time:  7.724761962890625e-05
time for parepare:  0.00026607513427734375
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  9.822845458984375e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00021076202392578125
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  9.489059448242188e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00020599365234375
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  7.915496826171875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.00010204315185546875
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00020575523376464844
----------------------check_connections_block total spend ----------------------------- 0.004425764083862305
generate_one_block  0.001142263412475586
generate_one_block  0.0012705326080322266
generate_one_block  0.0011303424835205078
generate_one_block  0.001039743423461914
generate_one_block  0.0010743141174316406
generate_one_block  0.0010406970977783203
generate_one_block  0.0012841224670410156
generate_one_block  0.001073598861694336
generate_one_block  0.0010623931884765625
generate_one_block  0.0011208057403564453
generate_one_block  0.0010013580322265625
generate_one_block  0.0009703636169433594
generate_one_block  0.001055002212524414
generate_one_block  0.0009882450103759766
generate_one_block  0.0011951923370361328
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001035451889038086
gen group dst list time:  0.00011873245239257812
time for parepare:  0.0007386207580566406
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0002396106719970703
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0005710124969482422
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  0.00016641616821289062
r_  generation:  0.0012607574462890625
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.000362396240234375
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00012826919555664062
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0004582405090332031
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.000247955322265625
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  0.0001442432403564453
r_  generation:  0.0017278194427490234
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.00038695335388183594
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0003581047058105469
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  8.845329284667969e-05
r_  generation:  0.0008795261383056641
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00015020370483398438
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0001506805419921875
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0004553794860839844
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0001976490020751953
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  0.00013303756713867188
r_  generation:  0.0015306472778320312
----------------------check_connections_block total spend ----------------------------- 0.015854597091674805
generate_one_block  0.0020651817321777344
generate_one_block  0.002583026885986328
generate_one_block  0.001318216323852539
generate_one_block  0.0011000633239746094
generate_one_block  0.0014851093292236328
generate_one_block  0.0012164115905761719
generate_one_block  0.0031805038452148438
generate_one_block  0.0013527870178222656
generate_one_block  0.0013506412506103516
generate_one_block  0.002498149871826172
generate_one_block  0.0010914802551269531
generate_one_block  0.0010900497436523438
generate_one_block  0.001497030258178711
generate_one_block  0.0011386871337890625
generate_one_block  0.002852916717529297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002158641815185547
gen group dst list time:  0.00029158592224121094
time for parepare:  0.0016481876373291016
local_output_nid generation:  9.822845458984375e-05
local_in_edges_tensor generation:  0.0005688667297363281
mini_batch_src_global generation:  0.00038695335388183594
r_  generation:  0.0031137466430664062
local_output_nid generation:  0.00018358230590820312
local_in_edges_tensor generation:  0.00045013427734375
mini_batch_src_global generation:  0.0007615089416503906
r_  generation:  0.006125926971435547
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  0.00026226043701171875
r_  generation:  0.0017201900482177734
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.0005998611450195312
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.0002288818359375
mini_batch_src_global generation:  0.00020599365234375
r_  generation:  0.002517223358154297
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0015091896057128906
local_output_nid generation:  0.00016951560974121094
local_in_edges_tensor generation:  0.0004420280456542969
mini_batch_src_global generation:  0.0005905628204345703
r_  generation:  0.006806612014770508
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  0.0003020763397216797
r_  generation:  0.0018465518951416016
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.0017976760864257812
local_output_nid generation:  0.00014400482177734375
local_in_edges_tensor generation:  0.0003437995910644531
mini_batch_src_global generation:  0.0004782676696777344
r_  generation:  0.005282163619995117
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.0008084774017333984
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  9.918212890625e-05
r_  generation:  0.0009157657623291016
local_output_nid generation:  8.463859558105469e-05
local_in_edges_tensor generation:  0.0002491474151611328
mini_batch_src_global generation:  0.0002868175506591797
r_  generation:  0.003378629684448242
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  0.0001583099365234375
r_  generation:  0.0008249282836914062
local_output_nid generation:  0.00011467933654785156
local_in_edges_tensor generation:  0.0003190040588378906
mini_batch_src_global generation:  0.00047850608825683594
r_  generation:  0.005881309509277344
----------------------check_connections_block total spend ----------------------------- 0.06582093238830566
generate_one_block  0.005177974700927734
generate_one_block  0.008903264999389648
generate_one_block  0.00293731689453125
generate_one_block  0.0016651153564453125
generate_one_block  0.0045490264892578125
generate_one_block  0.0029680728912353516
generate_one_block  0.010059118270874023
generate_one_block  0.0034885406494140625
generate_one_block  0.003396272659301758
generate_one_block  0.008584260940551758
generate_one_block  0.001901388168334961
generate_one_block  0.0021347999572753906
generate_one_block  0.005802631378173828
generate_one_block  0.0019402503967285156
generate_one_block  0.009022712707519531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002334117889404297
gen group dst list time:  0.0014138221740722656
time for parepare:  0.0018074512481689453
local_output_nid generation:  0.0004258155822753906
local_in_edges_tensor generation:  0.001318216323852539
mini_batch_src_global generation:  0.001138925552368164
r_  generation:  0.011018991470336914
local_output_nid generation:  0.0007493495941162109
local_in_edges_tensor generation:  0.0018737316131591797
mini_batch_src_global generation:  0.0016031265258789062
r_  generation:  0.01539158821105957
local_output_nid generation:  0.0002620220184326172
local_in_edges_tensor generation:  0.0005228519439697266
mini_batch_src_global generation:  0.0007140636444091797
r_  generation:  0.006399631500244141
local_output_nid generation:  0.00012350082397460938
local_in_edges_tensor generation:  0.0003046989440917969
mini_batch_src_global generation:  0.00041365623474121094
r_  generation:  0.003206014633178711
local_output_nid generation:  0.0003733634948730469
local_in_edges_tensor generation:  0.0006499290466308594
mini_batch_src_global generation:  0.0007951259613037109
r_  generation:  0.00978398323059082
local_output_nid generation:  0.0002944469451904297
local_in_edges_tensor generation:  0.0005352497100830078
mini_batch_src_global generation:  0.0007731914520263672
r_  generation:  0.007704973220825195
local_output_nid generation:  0.0005819797515869141
local_in_edges_tensor generation:  0.001001596450805664
mini_batch_src_global generation:  0.0012848377227783203
r_  generation:  0.014882802963256836
local_output_nid generation:  0.0003218650817871094
local_in_edges_tensor generation:  0.0005142688751220703
mini_batch_src_global generation:  0.0007297992706298828
r_  generation:  0.006234169006347656
local_output_nid generation:  0.0003490447998046875
local_in_edges_tensor generation:  0.0005240440368652344
mini_batch_src_global generation:  0.0006117820739746094
r_  generation:  0.0067903995513916016
local_output_nid generation:  0.0005853176116943359
local_in_edges_tensor generation:  0.0009441375732421875
mini_batch_src_global generation:  0.0012173652648925781
r_  generation:  0.01581287384033203
local_output_nid generation:  0.0001633167266845703
local_in_edges_tensor generation:  0.0003383159637451172
mini_batch_src_global generation:  0.0006341934204101562
r_  generation:  0.0039825439453125
local_output_nid generation:  0.0002052783966064453
local_in_edges_tensor generation:  0.0003895759582519531
mini_batch_src_global generation:  0.00047087669372558594
r_  generation:  0.005099773406982422
local_output_nid generation:  0.0003337860107421875
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.0008866786956787109
r_  generation:  0.009937286376953125
local_output_nid generation:  0.00015354156494140625
local_in_edges_tensor generation:  0.0003478527069091797
mini_batch_src_global generation:  0.0005319118499755859
r_  generation:  0.003648042678833008
local_output_nid generation:  0.0005402565002441406
local_in_edges_tensor generation:  0.0009436607360839844
mini_batch_src_global generation:  0.0009484291076660156
r_  generation:  0.014068841934204102
----------------------check_connections_block total spend ----------------------------- 0.1978604793548584
generate_one_block  0.015144824981689453
generate_one_block  0.02151322364807129
generate_one_block  0.01003265380859375
generate_one_block  0.005300283432006836
generate_one_block  0.01311182975769043
generate_one_block  0.011400461196899414
generate_one_block  0.019616365432739258
generate_one_block  0.009033441543579102
generate_one_block  0.010015010833740234
generate_one_block  0.021055221557617188
generate_one_block  0.0061986446380615234
generate_one_block  0.007785320281982422
generate_one_block  0.013613462448120117
generate_one_block  0.005589723587036133
generate_one_block  0.018879175186157227
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019638538360595703
gen group dst list time:  0.0037260055541992188
time for parepare:  0.001661062240600586
local_output_nid generation:  0.001054525375366211
local_in_edges_tensor generation:  0.0022530555725097656
mini_batch_src_global generation:  0.001844167709350586
r_  generation:  0.020446062088012695
local_output_nid generation:  0.0012097358703613281
local_in_edges_tensor generation:  0.0025262832641601562
mini_batch_src_global generation:  0.002583742141723633
r_  generation:  0.023117780685424805
local_output_nid generation:  0.0008797645568847656
local_in_edges_tensor generation:  0.0011997222900390625
mini_batch_src_global generation:  0.005746364593505859
r_  generation:  0.016641616821289062
local_output_nid generation:  0.0004355907440185547
local_in_edges_tensor generation:  0.0007352828979492188
mini_batch_src_global generation:  0.0010843276977539062
r_  generation:  0.010848522186279297
local_output_nid generation:  0.0009737014770507812
local_in_edges_tensor generation:  0.001390695571899414
mini_batch_src_global generation:  0.0012640953063964844
r_  generation:  0.01940011978149414
local_output_nid generation:  0.0008537769317626953
local_in_edges_tensor generation:  0.0016193389892578125
mini_batch_src_global generation:  0.0015294551849365234
r_  generation:  0.01778125762939453
local_output_nid generation:  0.001008749008178711
local_in_edges_tensor generation:  0.0020666122436523438
mini_batch_src_global generation:  0.0016689300537109375
r_  generation:  0.0210418701171875
local_output_nid generation:  0.0007097721099853516
local_in_edges_tensor generation:  0.0010404586791992188
mini_batch_src_global generation:  0.0013685226440429688
r_  generation:  0.015348434448242188
local_output_nid generation:  0.0008053779602050781
local_in_edges_tensor generation:  0.0011172294616699219
mini_batch_src_global generation:  0.001214742660522461
r_  generation:  0.015906572341918945
local_output_nid generation:  0.0011992454528808594
local_in_edges_tensor generation:  0.0019807815551757812
mini_batch_src_global generation:  0.0017058849334716797
r_  generation:  0.023405075073242188
local_output_nid generation:  0.0005924701690673828
local_in_edges_tensor generation:  0.0008807182312011719
mini_batch_src_global generation:  0.0012993812561035156
r_  generation:  0.01245260238647461
local_output_nid generation:  0.00066375732421875
local_in_edges_tensor generation:  0.0010235309600830078
mini_batch_src_global generation:  0.0011394023895263672
r_  generation:  0.015493154525756836
local_output_nid generation:  0.0008528232574462891
local_in_edges_tensor generation:  0.001325845718383789
mini_batch_src_global generation:  0.0014150142669677734
r_  generation:  0.01740121841430664
local_output_nid generation:  0.0004634857177734375
local_in_edges_tensor generation:  0.0006897449493408203
mini_batch_src_global generation:  0.0009527206420898438
r_  generation:  0.009140729904174805
local_output_nid generation:  0.0009951591491699219
local_in_edges_tensor generation:  0.0014607906341552734
mini_batch_src_global generation:  0.0015227794647216797
r_  generation:  0.02068638801574707
----------------------check_connections_block total spend ----------------------------- 0.37866854667663574
generate_one_block  0.025603771209716797
generate_one_block  0.029313325881958008
generate_one_block  0.02188849449157715
generate_one_block  0.014880657196044922
generate_one_block  0.02523040771484375
generate_one_block  0.023506879806518555
generate_one_block  0.0266873836517334
generate_one_block  0.02008533477783203
generate_one_block  0.020104169845581055
generate_one_block  0.029566049575805664
generate_one_block  0.01648545265197754
generate_one_block  0.02340245246887207
generate_one_block  0.023142576217651367
generate_one_block  0.013054370880126953
generate_one_block  0.025324344635009766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003743171691894531  GigaBytes
Max Memory Allocated: 0.0003743171691894531  GigaBytes

connection checking time:  0.6626303195953369
block generation total time  0.6413652896881104
average batch blocks generation time:  0.04275768597920736
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03266096115112305  GigaBytes
Max Memory Allocated: 0.03266096115112305  GigaBytes

torch.Size([16865, 500])
torch.Size([11570, 64])
torch.Size([4613, 64])
torch.Size([1117, 64])
torch.Size([175, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.04934215545654297  GigaBytes
Max Memory Allocated: 0.049379825592041016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.0370020866394043  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

torch.Size([18563, 500])
torch.Size([14301, 64])
torch.Size([9158, 64])
torch.Size([2258, 64])
torch.Size([504, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.06158304214477539  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.030350208282470703  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

torch.Size([15562, 500])
torch.Size([8749, 64])
torch.Size([2793, 64])
torch.Size([628, 64])
torch.Size([141, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.04150962829589844  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.020650863647460938  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

torch.Size([10486, 500])
torch.Size([4396, 64])
torch.Size([1152, 64])
torch.Size([184, 64])
torch.Size([61, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.025914669036865234  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03319978713989258  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

torch.Size([16991, 500])
torch.Size([10056, 64])
torch.Size([4253, 64])
torch.Size([762, 64])
torch.Size([179, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.048113346099853516  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.030609607696533203  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

torch.Size([15667, 500])
torch.Size([8814, 64])
torch.Size([3076, 64])
torch.Size([422, 64])
torch.Size([107, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.04189157485961914  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.033448219299316406  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

torch.Size([16953, 500])
torch.Size([12172, 64])
torch.Size([7042, 64])
torch.Size([2156, 64])
torch.Size([463, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.05453205108642578  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.02980804443359375  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

torch.Size([15289, 500])
torch.Size([7844, 64])
torch.Size([3510, 64])
torch.Size([634, 64])
torch.Size([170, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.04096508026123047  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.030407428741455078  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

torch.Size([15601, 500])
torch.Size([8725, 64])
torch.Size([3493, 64])
torch.Size([686, 64])
torch.Size([155, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.04230165481567383  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03542947769165039  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

torch.Size([18013, 500])
torch.Size([14580, 64])
torch.Size([6971, 64])
torch.Size([1884, 64])
torch.Size([223, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.0583953857421875  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.026535511016845703  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

torch.Size([13619, 500])
torch.Size([5885, 64])
torch.Size([1692, 64])
torch.Size([231, 64])
torch.Size([62, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03398942947387695  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.029344558715820312  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

torch.Size([15060, 500])
torch.Size([6603, 64])
torch.Size([2215, 64])
torch.Size([283, 64])
torch.Size([77, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.037715911865234375  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.02848958969116211  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

torch.Size([14469, 500])
torch.Size([9038, 64])
torch.Size([3878, 64])
torch.Size([1027, 64])
torch.Size([101, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.04149770736694336  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.021976470947265625  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

torch.Size([11216, 500])
torch.Size([4899, 64])
torch.Size([1690, 64])
torch.Size([288, 64])
torch.Size([100, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.028296947479248047  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.033782005310058594  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

torch.Size([17163, 500])
torch.Size([11532, 64])
torch.Size([6836, 64])
torch.Size([1684, 64])
torch.Size([408, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.05302619934082031  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011230738957722981 |0.024869982401529947 |0.06032889684041341 |0.00014707247416178386 |0.005726957321166992 |0.006276130676269531 |
----------------------------------------------------------pseudo_mini_loss sum 2.041001081466675
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  450580
Number of first layer input nodes during this epoch:  231517
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03687715530395508  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006113052368164062
random selection method range initialization spend 0.00014400482177734375
time for parepare:  5.125999450683594e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.1920928955078125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.0742416381835938e-05
----------------------check_connections_block total spend ----------------------------- 0.003103017807006836
generate_one_block  0.0016765594482421875
generate_one_block  0.0011010169982910156
generate_one_block  0.0010769367218017578
generate_one_block  0.0010704994201660156
generate_one_block  0.0010752677917480469
generate_one_block  0.0010790824890136719
generate_one_block  0.0010654926300048828
generate_one_block  0.0010836124420166016
generate_one_block  0.001070261001586914
generate_one_block  0.001024484634399414
generate_one_block  0.0010395050048828125
generate_one_block  0.0010442733764648438
generate_one_block  0.0010476112365722656
generate_one_block  0.001031637191772461
generate_one_block  0.001100301742553711
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006856918334960938
gen group dst list time:  8.273124694824219e-05
time for parepare:  0.00026726722717285156
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00012731552124023438
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  9.751319885253906e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  8.821487426757812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.555152893066406e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.000148773193359375
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  5.125999450683594e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  9.703636169433594e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  5.364418029785156e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00010824203491210938
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  9.298324584960938e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00018310546875
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00017833709716796875
----------------------check_connections_block total spend ----------------------------- 0.005112171173095703
generate_one_block  0.0012698173522949219
generate_one_block  0.0011868476867675781
generate_one_block  0.0011813640594482422
generate_one_block  0.0011286735534667969
generate_one_block  0.0011279582977294922
generate_one_block  0.0012536048889160156
generate_one_block  0.001132965087890625
generate_one_block  0.001190185546875
generate_one_block  0.001130819320678711
generate_one_block  0.0010879039764404297
generate_one_block  0.0011599063873291016
generate_one_block  0.001600503921508789
generate_one_block  0.0012507438659667969
generate_one_block  0.00107574462890625
generate_one_block  0.0012521743774414062
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011670589447021484
gen group dst list time:  0.0001366138458251953
time for parepare:  0.0007853507995605469
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00028443336486816406
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.0007214546203613281
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  9.34600830078125e-05
r_  generation:  0.0005388259887695312
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0004940032958984375
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.0002162456512451172
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00023674964904785156
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  0.00012755393981933594
r_  generation:  0.0011773109436035156
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0003094673156738281
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0007302761077880859
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0001895427703857422
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0003383159637451172
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0005869865417480469
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0004169940948486328
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0011432170867919922
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0004277229309082031
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.00014781951904296875
r_  generation:  0.001459360122680664
----------------------check_connections_block total spend ----------------------------- 0.016832590103149414
generate_one_block  0.002002239227294922
generate_one_block  0.001703500747680664
generate_one_block  0.00159454345703125
generate_one_block  0.0012700557708740234
generate_one_block  0.0012822151184082031
generate_one_block  0.002420663833618164
generate_one_block  0.0013685226440429688
generate_one_block  0.001947164535522461
generate_one_block  0.0013036727905273438
generate_one_block  0.0014324188232421875
generate_one_block  0.0017056465148925781
generate_one_block  0.001489400863647461
generate_one_block  0.0024170875549316406
generate_one_block  0.0017392635345458984
generate_one_block  0.0028710365295410156
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.003261566162109375
gen group dst list time:  0.00036025047302246094
time for parepare:  0.0015461444854736328
local_output_nid generation:  0.0001304149627685547
local_in_edges_tensor generation:  0.0006289482116699219
mini_batch_src_global generation:  0.00046133995056152344
r_  generation:  0.004416227340698242
local_output_nid generation:  9.965896606445312e-05
local_in_edges_tensor generation:  0.0003094673156738281
mini_batch_src_global generation:  0.0004520416259765625
r_  generation:  0.003507375717163086
local_output_nid generation:  9.107589721679688e-05
local_in_edges_tensor generation:  0.0002846717834472656
mini_batch_src_global generation:  0.0003533363342285156
r_  generation:  0.0031859874725341797
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  0.0002319812774658203
r_  generation:  0.0015735626220703125
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  0.00014543533325195312
r_  generation:  0.0011301040649414062
local_output_nid generation:  0.00013518333435058594
local_in_edges_tensor generation:  0.0003802776336669922
mini_batch_src_global generation:  0.0004513263702392578
r_  generation:  0.0048754215240478516
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.0002319812774658203
mini_batch_src_global generation:  0.00031638145446777344
r_  generation:  0.0020570755004882812
local_output_nid generation:  0.00014328956604003906
local_in_edges_tensor generation:  0.0003516674041748047
mini_batch_src_global generation:  0.00037980079650878906
r_  generation:  0.004240512847900391
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  0.00018143653869628906
r_  generation:  0.00077056884765625
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.00023746490478515625
mini_batch_src_global generation:  0.0002543926239013672
r_  generation:  0.0027964115142822266
local_output_nid generation:  8.749961853027344e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  0.0002994537353515625
r_  generation:  0.0027968883514404297
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  0.00021266937255859375
r_  generation:  0.0017333030700683594
local_output_nid generation:  0.00017547607421875
local_in_edges_tensor generation:  0.00040721893310546875
mini_batch_src_global generation:  0.0004620552062988281
r_  generation:  0.0054473876953125
local_output_nid generation:  8.96453857421875e-05
local_in_edges_tensor generation:  0.0002815723419189453
mini_batch_src_global generation:  0.0004229545593261719
r_  generation:  0.003473997116088867
local_output_nid generation:  0.0001366138458251953
local_in_edges_tensor generation:  0.00035881996154785156
mini_batch_src_global generation:  0.0005538463592529297
r_  generation:  0.005430459976196289
----------------------check_connections_block total spend ----------------------------- 0.07244420051574707
generate_one_block  0.0074884891510009766
generate_one_block  0.005682229995727539
generate_one_block  0.005152702331542969
generate_one_block  0.0030629634857177734
generate_one_block  0.002435445785522461
generate_one_block  0.00791311264038086
generate_one_block  0.0055239200592041016
generate_one_block  0.006549835205078125
generate_one_block  0.0019028186798095703
generate_one_block  0.0049266815185546875
generate_one_block  0.004785060882568359
generate_one_block  0.0031173229217529297
generate_one_block  0.008354425430297852
generate_one_block  0.005583047866821289
generate_one_block  0.008213281631469727
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002422332763671875
gen group dst list time:  0.0015180110931396484
time for parepare:  0.0017552375793457031
local_output_nid generation:  0.0007925033569335938
local_in_edges_tensor generation:  0.001650094985961914
mini_batch_src_global generation:  0.0013003349304199219
r_  generation:  0.013454437255859375
local_output_nid generation:  0.0004773139953613281
local_in_edges_tensor generation:  0.000934600830078125
mini_batch_src_global generation:  0.0011701583862304688
r_  generation:  0.010994672775268555
local_output_nid generation:  0.00047850608825683594
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0010116100311279297
r_  generation:  0.01151585578918457
local_output_nid generation:  0.00031828880310058594
local_in_edges_tensor generation:  0.0005946159362792969
mini_batch_src_global generation:  0.0008640289306640625
r_  generation:  0.00763249397277832
local_output_nid generation:  0.00023293495178222656
local_in_edges_tensor generation:  0.0004322528839111328
mini_batch_src_global generation:  0.0005249977111816406
r_  generation:  0.004553318023681641
local_output_nid generation:  0.0004801750183105469
local_in_edges_tensor generation:  0.0008227825164794922
mini_batch_src_global generation:  0.0010156631469726562
r_  generation:  0.012218952178955078
local_output_nid generation:  0.0003466606140136719
local_in_edges_tensor generation:  0.0006194114685058594
mini_batch_src_global generation:  0.0009398460388183594
r_  generation:  0.00797891616821289
local_output_nid generation:  0.0006213188171386719
local_in_edges_tensor generation:  0.0010106563568115234
mini_batch_src_global generation:  0.0012750625610351562
r_  generation:  0.014794349670410156
local_output_nid generation:  0.00017523765563964844
local_in_edges_tensor generation:  0.00035190582275390625
mini_batch_src_global generation:  0.0006928443908691406
r_  generation:  0.0033936500549316406
local_output_nid generation:  0.0004830360412597656
local_in_edges_tensor generation:  0.0007495880126953125
mini_batch_src_global generation:  0.0009098052978515625
r_  generation:  0.010937213897705078
local_output_nid generation:  0.0005216598510742188
local_in_edges_tensor generation:  0.0007963180541992188
mini_batch_src_global generation:  0.0010437965393066406
r_  generation:  0.010379791259765625
local_output_nid generation:  0.00028634071350097656
local_in_edges_tensor generation:  0.0004932880401611328
mini_batch_src_global generation:  0.0006318092346191406
r_  generation:  0.0060198307037353516
local_output_nid generation:  0.0007314682006835938
local_in_edges_tensor generation:  0.0011143684387207031
mini_batch_src_global generation:  0.0013890266418457031
r_  generation:  0.016575098037719727
local_output_nid generation:  0.0004889965057373047
local_in_edges_tensor generation:  0.0008170604705810547
mini_batch_src_global generation:  0.0012755393981933594
r_  generation:  0.012083768844604492
local_output_nid generation:  0.0005385875701904297
local_in_edges_tensor generation:  0.0008842945098876953
mini_batch_src_global generation:  0.001081228256225586
r_  generation:  0.013436079025268555
----------------------check_connections_block total spend ----------------------------- 0.2298877239227295
generate_one_block  0.01718902587890625
generate_one_block  0.017882823944091797
generate_one_block  0.016448259353637695
generate_one_block  0.013997554779052734
generate_one_block  0.0069963932037353516
generate_one_block  0.01633620262145996
generate_one_block  0.012151002883911133
generate_one_block  0.019941091537475586
generate_one_block  0.00557708740234375
generate_one_block  0.01849842071533203
generate_one_block  0.014465570449829102
generate_one_block  0.008653879165649414
generate_one_block  0.021398544311523438
generate_one_block  0.01687932014465332
generate_one_block  0.017926931381225586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.003124713897705078
gen group dst list time:  0.004789590835571289
time for parepare:  0.0021331310272216797
local_output_nid generation:  0.0013027191162109375
local_in_edges_tensor generation:  0.011307954788208008
mini_batch_src_global generation:  0.0023374557495117188
r_  generation:  0.022951126098632812
local_output_nid generation:  0.0011448860168457031
local_in_edges_tensor generation:  0.002550840377807617
mini_batch_src_global generation:  0.0023164749145507812
r_  generation:  0.020177602767944336
local_output_nid generation:  0.0012862682342529297
local_in_edges_tensor generation:  0.0017604827880859375
mini_batch_src_global generation:  0.0015625953674316406
r_  generation:  0.019883394241333008
local_output_nid generation:  0.0010235309600830078
local_in_edges_tensor generation:  0.0012807846069335938
mini_batch_src_global generation:  0.0014996528625488281
r_  generation:  0.01703166961669922
local_output_nid generation:  0.0007665157318115234
local_in_edges_tensor generation:  0.0010900497436523438
mini_batch_src_global generation:  0.0011854171752929688
r_  generation:  0.013806343078613281
local_output_nid generation:  0.0012183189392089844
local_in_edges_tensor generation:  0.0014734268188476562
mini_batch_src_global generation:  0.0016591548919677734
r_  generation:  0.019690513610839844
local_output_nid generation:  0.0008771419525146484
local_in_edges_tensor generation:  0.0014691352844238281
mini_batch_src_global generation:  0.0015251636505126953
r_  generation:  0.016978025436401367
local_output_nid generation:  0.0013480186462402344
local_in_edges_tensor generation:  0.0020704269409179688
mini_batch_src_global generation:  0.001901865005493164
r_  generation:  0.023142337799072266
local_output_nid generation:  0.0004811286926269531
local_in_edges_tensor generation:  0.0008270740509033203
mini_batch_src_global generation:  0.0010669231414794922
r_  generation:  0.009351968765258789
local_output_nid generation:  0.0010809898376464844
local_in_edges_tensor generation:  0.0014715194702148438
mini_batch_src_global generation:  0.0015532970428466797
r_  generation:  0.020184040069580078
local_output_nid generation:  0.0011293888092041016
local_in_edges_tensor generation:  0.0015177726745605469
mini_batch_src_global generation:  0.0016396045684814453
r_  generation:  0.02014899253845215
local_output_nid generation:  0.000820159912109375
local_in_edges_tensor generation:  0.0011339187622070312
mini_batch_src_global generation:  0.0014185905456542969
r_  generation:  0.015266180038452148
local_output_nid generation:  0.0015327930450439453
local_in_edges_tensor generation:  0.002376079559326172
mini_batch_src_global generation:  0.0018117427825927734
r_  generation:  0.024187088012695312
local_output_nid generation:  0.0011143684387207031
local_in_edges_tensor generation:  0.0018200874328613281
mini_batch_src_global generation:  0.0018911361694335938
r_  generation:  0.02091503143310547
local_output_nid generation:  0.0011456012725830078
local_in_edges_tensor generation:  0.0017070770263671875
mini_batch_src_global generation:  0.0017299652099609375
r_  generation:  0.020746707916259766
----------------------check_connections_block total spend ----------------------------- 0.42675042152404785
generate_one_block  0.02831244468688965
generate_one_block  0.029877901077270508
generate_one_block  0.02609729766845703
generate_one_block  0.0229799747467041
generate_one_block  0.018492937088012695
generate_one_block  0.02573561668395996
generate_one_block  0.023041963577270508
generate_one_block  0.02930140495300293
generate_one_block  0.01476430892944336
generate_one_block  0.023952007293701172
generate_one_block  0.026209115982055664
generate_one_block  0.018632888793945312
generate_one_block  0.030212879180908203
generate_one_block  0.02661275863647461
generate_one_block  0.026343345642089844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03687715530395508  GigaBytes
Max Memory Allocated: 0.06731367111206055  GigaBytes

connection checking time:  0.7510271072387695
block generation total time  0.7201769351959229
average batch blocks generation time:  0.04801179567972819
block dataloader generation time/epoch 1.5672566890716553
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03760957717895508  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

torch.Size([18378, 500])
torch.Size([12928, 64])
torch.Size([7626, 64])
torch.Size([1313, 64])
torch.Size([318, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.05893564224243164  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.0340733528137207  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

torch.Size([17027, 500])
torch.Size([10831, 64])
torch.Size([4900, 64])
torch.Size([915, 64])
torch.Size([201, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.05006742477416992  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03255033493041992  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

torch.Size([16218, 500])
torch.Size([10571, 64])
torch.Size([4973, 64])
torch.Size([806, 64])
torch.Size([202, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.0480189323425293  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.029288291931152344  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

torch.Size([14570, 500])
torch.Size([8270, 64])
torch.Size([2963, 64])
torch.Size([404, 64])
torch.Size([91, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.03998994827270508  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.026679515838623047  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

torch.Size([13272, 500])
torch.Size([6238, 64])
torch.Size([1892, 64])
torch.Size([383, 64])
torch.Size([101, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03449201583862305  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03240394592285156  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

torch.Size([16085, 500])
torch.Size([10939, 64])
torch.Size([5236, 64])
torch.Size([1523, 64])
torch.Size([284, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.049902915954589844  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.030443191528320312  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

torch.Size([15179, 500])
torch.Size([7888, 64])
torch.Size([3313, 64])
torch.Size([543, 64])
torch.Size([104, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.04136991500854492  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.035737037658691406  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

torch.Size([17829, 500])
torch.Size([14149, 64])
torch.Size([6285, 64])
torch.Size([1609, 64])
torch.Size([214, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.05699348449707031  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.023043155670166016  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

torch.Size([11393, 500])
torch.Size([4686, 64])
torch.Size([1434, 64])
torch.Size([244, 64])
torch.Size([99, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.028892040252685547  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.03362846374511719  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

torch.Size([16803, 500])
torch.Size([10414, 64])
torch.Size([4749, 64])
torch.Size([670, 64])
torch.Size([126, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.04891824722290039  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.03432798385620117  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

torch.Size([17204, 500])
torch.Size([10523, 64])
torch.Size([4749, 64])
torch.Size([938, 64])
torch.Size([234, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.04984569549560547  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.027948379516601562  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

torch.Size([13922, 500])
torch.Size([8028, 64])
torch.Size([2702, 64])
torch.Size([787, 64])
torch.Size([140, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.03869342803955078  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.03777456283569336  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes
Using backend: pytorch

torch.Size([18354, 500])
torch.Size([14724, 64])
torch.Size([7463, 64])
torch.Size([2102, 64])
torch.Size([400, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.06149482727050781  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.033750057220458984  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

torch.Size([16841, 500])
torch.Size([10877, 64])
torch.Size([4707, 64])
torch.Size([984, 64])
torch.Size([92, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.04980754852294922  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.03251457214355469  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

torch.Size([16119, 500])
torch.Size([11369, 64])
torch.Size([5462, 64])
torch.Size([1643, 64])
torch.Size([316, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.05014848709106445  GigaBytes
Max Memory Allocated: 0.06860208511352539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011404609680175782 |0.0028925100962320966 |0.00816809336344401 |0.00016560554504394532 |0.0045737743377685545 |0.004026889801025391 |
----------------------------------------------------------pseudo_mini_loss sum 1.8958942890167236
Total (block generation + training)time/epoch 2.0035367012023926
Training time/epoch 0.43593335151672363
Training time without block to device /epoch 0.3925457000732422
Training time without total dataloading part /epoch 0.19763898849487305
load block tensor time/epoch 0.17106914520263672
block to device time/epoch 0.043387651443481445
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  478226
Number of first layer input nodes during this epoch:  239194
