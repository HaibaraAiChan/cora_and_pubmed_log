main start at this time 1648533226.7038796
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003743171691894531  GigaBytes
Max Memory Allocated: 0.0003743171691894531  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005385875701904297
random selection method range initialization spend 0.00018453598022460938
time for parepare:  4.601478576660156e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0009119510650634766
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.266334533691406e-05
----------------------check_connections_block total spend ----------------------------- 0.0019788742065429688
generate_one_block  0.0012099742889404297
generate_one_block  0.0010259151458740234
generate_one_block  0.0010120868682861328
generate_one_block  0.0010399818420410156
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005414485931396484
gen group dst list time:  3.4332275390625e-05
time for parepare:  0.0002377033233642578
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.0003781318664550781
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0003712177276611328
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0002155303955078125
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00029754638671875
----------------------check_connections_block total spend ----------------------------- 0.0026960372924804688
generate_one_block  0.0015175342559814453
generate_one_block  0.0015070438385009766
generate_one_block  0.0012860298156738281
generate_one_block  0.0013947486877441406
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010097026824951172
gen group dst list time:  6.937980651855469e-05
time for parepare:  0.0007426738739013672
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.0003380775451660156
mini_batch_src_global generation:  0.00017571449279785156
r_  generation:  0.0021131038665771484
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  0.0003566741943359375
r_  generation:  0.002641916275024414
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  0.00017309188842773438
r_  generation:  0.001501321792602539
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  0.0002071857452392578
r_  generation:  0.0022878646850585938
----------------------check_connections_block total spend ----------------------------- 0.013664722442626953
generate_one_block  0.004164934158325195
generate_one_block  0.004189252853393555
generate_one_block  0.005700349807739258
generate_one_block  0.003960371017456055
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.004938840866088867
gen group dst list time:  0.00022530555725097656
time for parepare:  0.001558065414428711
local_output_nid generation:  0.0002872943878173828
local_in_edges_tensor generation:  0.0008816719055175781
mini_batch_src_global generation:  0.0010192394256591797
r_  generation:  0.00867915153503418
local_output_nid generation:  0.0002760887145996094
local_in_edges_tensor generation:  0.0013391971588134766
mini_batch_src_global generation:  0.0012276172637939453
r_  generation:  0.010428428649902344
local_output_nid generation:  0.00021910667419433594
local_in_edges_tensor generation:  0.0004868507385253906
mini_batch_src_global generation:  0.0008070468902587891
r_  generation:  0.0071659088134765625
local_output_nid generation:  0.00021314620971679688
local_in_edges_tensor generation:  0.0004775524139404297
mini_batch_src_global generation:  0.0007755756378173828
r_  generation:  0.008097410202026367
----------------------check_connections_block total spend ----------------------------- 0.05234479904174805
generate_one_block  0.012824296951293945
generate_one_block  0.013825178146362305
generate_one_block  0.011141538619995117
generate_one_block  0.012695789337158203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001967906951904297
gen group dst list time:  0.0008366107940673828
time for parepare:  0.0018227100372314453
local_output_nid generation:  0.0009510517120361328
local_in_edges_tensor generation:  0.0023033618927001953
mini_batch_src_global generation:  0.0018558502197265625
r_  generation:  0.019191265106201172
local_output_nid generation:  0.0009005069732666016
local_in_edges_tensor generation:  0.0016858577728271484
mini_batch_src_global generation:  0.0023403167724609375
r_  generation:  0.020320892333984375
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0015027523040771484
mini_batch_src_global generation:  0.001802206039428711
r_  generation:  0.018830537796020508
local_output_nid generation:  0.0008249282836914062
local_in_edges_tensor generation:  0.0012204647064208984
mini_batch_src_global generation:  0.0016493797302246094
r_  generation:  0.018359899520874023
----------------------check_connections_block total spend ----------------------------- 0.11375665664672852
generate_one_block  0.024394989013671875
generate_one_block  0.02753305435180664
generate_one_block  0.026050329208374023
generate_one_block  0.025336503982543945
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019991397857666016
gen group dst list time:  0.0013973712921142578
time for parepare:  0.0016787052154541016
local_output_nid generation:  0.0013997554779052734
local_in_edges_tensor generation:  0.0027375221252441406
mini_batch_src_global generation:  0.0024106502532958984
r_  generation:  0.025608062744140625
local_output_nid generation:  0.0015070438385009766
local_in_edges_tensor generation:  0.002763032913208008
mini_batch_src_global generation:  0.00269317626953125
r_  generation:  0.025246858596801758
local_output_nid generation:  0.001596212387084961
local_in_edges_tensor generation:  0.0022459030151367188
mini_batch_src_global generation:  0.0021119117736816406
r_  generation:  0.024995088577270508
local_output_nid generation:  0.0015594959259033203
local_in_edges_tensor generation:  0.002246379852294922
mini_batch_src_global generation:  0.0021593570709228516
r_  generation:  0.024095535278320312
----------------------check_connections_block total spend ----------------------------- 0.14806509017944336
generate_one_block  0.030011892318725586
generate_one_block  0.03177976608276367
generate_one_block  0.030339479446411133
generate_one_block  0.029333829879760742
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003743171691894531  GigaBytes
Max Memory Allocated: 0.0003743171691894531  GigaBytes

connection checking time:  0.33052730560302734
block generation total time  0.29898691177368164
average batch blocks generation time:  0.07474672794342041
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03734254837036133  GigaBytes
Max Memory Allocated: 0.03734254837036133  GigaBytes

torch.Size([19135, 500])
torch.Size([16512, 64])
torch.Size([11239, 64])
torch.Size([3605, 64])
torch.Size([849, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.06886434555053711  GigaBytes
Max Memory Allocated: 0.06891489028930664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.03731584548950195  GigaBytes
Max Memory Allocated: 0.07154226303100586  GigaBytes

torch.Size([18807, 500])
torch.Size([15861, 64])
torch.Size([10987, 64])
torch.Size([3380, 64])
torch.Size([870, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.06748342514038086  GigaBytes
Max Memory Allocated: 0.07154226303100586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.03711080551147461  GigaBytes
Max Memory Allocated: 0.07154226303100586  GigaBytes

torch.Size([18840, 500])
torch.Size([16227, 64])
torch.Size([9388, 64])
torch.Size([2801, 64])
torch.Size([501, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.0647435188293457  GigaBytes
Max Memory Allocated: 0.07154226303100586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.037206172943115234  GigaBytes
Max Memory Allocated: 0.07154226303100586  GigaBytes

torch.Size([18621, 500])
torch.Size([14702, 64])
torch.Size([9495, 64])
torch.Size([2735, 64])
torch.Size([672, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.06327056884765625  GigaBytes
Max Memory Allocated: 0.07154226303100586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.019768059253692627 |0.08622318506240845 |0.19603341817855835 |0.00018149614334106445 |0.006681263446807861 |0.004218578338623047 |
----------------------------------------------------------pseudo_mini_loss sum 2.762619972229004
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  195584
Number of first layer input nodes during this epoch:  75403
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.0408320426940918  GigaBytes
Max Memory Allocated: 0.07154226303100586  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0004980564117431641
random selection method range initialization spend 0.00011658668518066406
time for parepare:  5.316734313964844e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.3882598876953125e-05
----------------------check_connections_block total spend ----------------------------- 0.001016378402709961
generate_one_block  0.0011036396026611328
generate_one_block  0.0010457038879394531
generate_one_block  0.0011403560638427734
generate_one_block  0.0010788440704345703
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005295276641845703
gen group dst list time:  3.409385681152344e-05
time for parepare:  0.0002651214599609375
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0003237724304199219
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00026488304138183594
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0002663135528564453
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0004601478576660156
----------------------check_connections_block total spend ----------------------------- 0.002828836441040039
generate_one_block  0.0014557838439941406
generate_one_block  0.0013403892517089844
generate_one_block  0.0013623237609863281
generate_one_block  0.0015871524810791016
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0009965896606445312
gen group dst list time:  8.726119995117188e-05
time for parepare:  0.0007703304290771484
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.0003228187561035156
mini_batch_src_global generation:  0.00020623207092285156
r_  generation:  0.0018582344055175781
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  0.0002446174621582031
r_  generation:  0.0018775463104248047
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  0.00021219253540039062
r_  generation:  0.0018246173858642578
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.0002396106719970703
mini_batch_src_global generation:  0.00030517578125
r_  generation:  0.003039121627807617
----------------------check_connections_block total spend ----------------------------- 0.013921260833740234
generate_one_block  0.0040891170501708984
generate_one_block  0.0031702518463134766
generate_one_block  0.003155946731567383
generate_one_block  0.0046956539154052734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020415782928466797
gen group dst list time:  0.00023603439331054688
time for parepare:  0.0014035701751708984
local_output_nid generation:  0.00025010108947753906
local_in_edges_tensor generation:  0.0008616447448730469
mini_batch_src_global generation:  0.0007615089416503906
r_  generation:  0.00946044921875
local_output_nid generation:  0.00022339820861816406
local_in_edges_tensor generation:  0.0006101131439208984
mini_batch_src_global generation:  0.0009167194366455078
r_  generation:  0.007536411285400391
local_output_nid generation:  0.00024080276489257812
local_in_edges_tensor generation:  0.0005133152008056641
mini_batch_src_global generation:  0.0008232593536376953
r_  generation:  0.008401870727539062Using backend: pytorch

local_output_nid generation:  0.0003027915954589844
local_in_edges_tensor generation:  0.0007455348968505859
mini_batch_src_global generation:  0.0011951923370361328
r_  generation:  0.011693954467773438
----------------------check_connections_block total spend ----------------------------- 0.05494189262390137
generate_one_block  0.014043807983398438
generate_one_block  0.011702775955200195
generate_one_block  0.012375593185424805
generate_one_block  0.015136003494262695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020418167114257812
gen group dst list time:  0.0008084774017333984
time for parepare:  0.0015630722045898438
local_output_nid generation:  0.001049041748046875
local_in_edges_tensor generation:  0.0021784305572509766
mini_batch_src_global generation:  0.0018205642700195312
r_  generation:  0.021153688430786133
local_output_nid generation:  0.0008068084716796875
local_in_edges_tensor generation:  0.00164031982421875
mini_batch_src_global generation:  0.0021414756774902344
r_  generation:  0.017942190170288086
local_output_nid generation:  0.0010268688201904297
local_in_edges_tensor generation:  0.0016472339630126953
mini_batch_src_global generation:  0.0018563270568847656
r_  generation:  0.020707130432128906
local_output_nid generation:  0.0010135173797607422
local_in_edges_tensor generation:  0.0015561580657958984
mini_batch_src_global generation:  0.0020952224731445312
r_  generation:  0.020896196365356445
----------------------check_connections_block total spend ----------------------------- 0.12099528312683105
generate_one_block  0.025934219360351562
generate_one_block  0.02387070655822754
generate_one_block  0.02604389190673828
generate_one_block  0.029823780059814453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017888545989990234
gen group dst list time:  0.0013353824615478516
time for parepare:  0.0015795230865478516
local_output_nid generation:  0.0014655590057373047
local_in_edges_tensor generation:  0.002760648727416992
mini_batch_src_global generation:  0.002057790756225586
r_  generation:  0.02514171600341797
local_output_nid generation:  0.0014545917510986328
local_in_edges_tensor generation:  0.00251007080078125
mini_batch_src_global generation:  0.002613544464111328
r_  generation:  0.02404499053955078
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.0021131038665771484
mini_batch_src_global generation:  0.0037622451782226562
r_  generation:  0.025692224502563477
local_output_nid generation:  0.0016238689422607422
local_in_edges_tensor generation:  0.0023965835571289062
mini_batch_src_global generation:  0.0020394325256347656
r_  generation:  0.025591611862182617
----------------------check_connections_block total spend ----------------------------- 0.14957189559936523
generate_one_block  0.02996349334716797
generate_one_block  0.032099246978759766
generate_one_block  0.030646800994873047
generate_one_block  0.030844688415527344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.0408320426940918  GigaBytes
Max Memory Allocated: 0.07154226303100586  GigaBytes

connection checking time:  0.34225916862487793
block generation total time  0.3033416271209717
average batch blocks generation time:  0.07583540678024292
block dataloader generation time/epoch 0.6977996826171875
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.03835439682006836  GigaBytes
Max Memory Allocated: 0.0721282958984375  GigaBytes

torch.Size([19056, 500])
torch.Size([16373, 64])
torch.Size([11715, 64])
torch.Size([2904, 64])
torch.Size([780, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.06899213790893555  GigaBytes
Max Memory Allocated: 0.0721282958984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.03789567947387695  GigaBytes
Max Memory Allocated: 0.0721292495727539  GigaBytes

torch.Size([18468, 500])
torch.Size([14754, 64])
torch.Size([8809, 64])
torch.Size([2477, 64])
torch.Size([577, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.06309127807617188  GigaBytes
Max Memory Allocated: 0.0721292495727539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.03806591033935547  GigaBytes
Max Memory Allocated: 0.0721292495727539  GigaBytes

torch.Size([18917, 500])
torch.Size([16481, 64])
torch.Size([10822, 64])
torch.Size([3157, 64])
torch.Size([648, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.06879568099975586  GigaBytes
Max Memory Allocated: 0.0721292495727539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.038222312927246094  GigaBytes
Max Memory Allocated: 0.0721292495727539  GigaBytes

torch.Size([18940, 500])
torch.Size([16759, 64])
torch.Size([10975, 64])
torch.Size([4130, 64])
torch.Size([859, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.07068204879760742  GigaBytes
Max Memory Allocated: 0.0721292495727539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014873206615447998 |0.0018996596336364746 |0.007351279258728027 |0.00013309717178344727 |0.0057334303855896 |0.0030341148376464844 |
----------------------------------------------------------pseudo_mini_loss sum 2.0964648723602295
Total (block generation + training)time/epoch 0.8286893367767334
Training time/epoch 0.13033771514892578
Training time without block to device /epoch 0.12273907661437988
Training time without total dataloading part /epoch 0.05590534210205078
load block tensor time/epoch 0.05949282646179199
block to device time/epoch 0.0075986385345458984
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  197958
Number of first layer input nodes during this epoch:  75381
