main start at this time 1648533238.2635593
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003743171691894531  GigaBytes
Max Memory Allocated: 0.0003743171691894531  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0017266273498535156
random selection method range initialization spend 0.00019359588623046875
time for parepare:  4.506111145019531e-05
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0011775493621826172
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.8835067749023438e-05
----------------------check_connections_block total spend ----------------------------- 0.002887248992919922
generate_one_block  0.0012028217315673828
generate_one_block  0.0010571479797363281
generate_one_block  0.0010342597961425781
generate_one_block  0.0010502338409423828
generate_one_block  0.0010426044464111328
generate_one_block  0.001088857650756836
generate_one_block  0.0010335445404052734
generate_one_block  0.0010309219360351562
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011134147644042969
gen group dst list time:  4.9591064453125e-05
time for parepare:  0.0002460479736328125
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00029087066650390625
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001289844512939453
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00012159347534179688
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00028252601623535156
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00017595291137695312
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.961822509765625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  9.560585021972656e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00019860267639160156
----------------------check_connections_block total spend ----------------------------- 0.003429889678955078
generate_one_block  0.0014719963073730469
generate_one_block  0.0011742115020751953
generate_one_block  0.0011773109436035156
generate_one_block  0.0014541149139404297
generate_one_block  0.0012454986572265625
generate_one_block  0.0010988712310791016
generate_one_block  0.0011320114135742188
generate_one_block  0.0012891292572021484
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011615753173828125
gen group dst list time:  9.131431579589844e-05
time for parepare:  0.0007567405700683594
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00032258033752441406
mini_batch_src_global generation:  0.00015401840209960938
r_  generation:  0.0018613338470458984
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  9.942054748535156e-05
r_  generation:  0.0004799365997314453
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0006885528564453125
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  0.00019407272338867188
r_  generation:  0.0021462440490722656
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  0.00016236305236816406
r_  generation:  0.0012888908386230469
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0002970695495605469
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0006425380706787109
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  0.00015091896057128906
r_  generation:  0.0016155242919921875
----------------------check_connections_block total spend ----------------------------- 0.01506495475769043
generate_one_block  0.0038175582885742188
generate_one_block  0.0014770030975341797
generate_one_block  0.0018165111541748047
generate_one_block  0.003538370132446289
generate_one_block  0.0025610923767089844
generate_one_block  0.0012590885162353516
generate_one_block  0.0016951560974121094
generate_one_block  0.0028960704803466797
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002097606658935547
gen group dst list time:  0.0002589225769042969
time for parepare:  0.001623392105102539
local_output_nid generation:  0.00023698806762695312
local_in_edges_tensor generation:  0.000843048095703125
mini_batch_src_global generation:  0.0009288787841796875
r_  generation:  0.007838010787963867
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  0.0003769397735595703
r_  generation:  0.0022592544555664062
local_output_nid generation:  0.00010466575622558594
local_in_edges_tensor generation:  0.00029730796813964844
mini_batch_src_global generation:  0.0003533363342285156
r_  generation:  0.0038259029388427734
local_output_nid generation:  0.0002117156982421875
local_in_edges_tensor generation:  0.0005266666412353516
mini_batch_src_global generation:  0.0009479522705078125
r_  generation:  0.008261680603027344
local_output_nid generation:  0.0001933574676513672
local_in_edges_tensor generation:  0.0005476474761962891
mini_batch_src_global generation:  0.0007288455963134766
r_  generation:  0.006712436676025391
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.00029921531677246094
r_  generation:  0.001651763916015625
local_output_nid generation:  0.00010943412780761719
local_in_edges_tensor generation:  0.00028824806213378906
mini_batch_src_global generation:  0.0003578662872314453
r_  generation:  0.004277944564819336
local_output_nid generation:  0.0001277923583984375
local_in_edges_tensor generation:  0.0003571510314941406
mini_batch_src_global generation:  0.0006058216094970703
r_  generation:  0.00606989860534668
----------------------check_connections_block total spend ----------------------------- 0.06222057342529297
generate_one_block  0.012054920196533203
generate_one_block  0.0038864612579345703
generate_one_block  0.006120443344116211
generate_one_block  0.012395143508911133
generate_one_block  0.009679317474365234
generate_one_block  0.0031328201293945312
generate_one_block  0.006501436233520508
generate_one_block  0.009972333908081055
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022814273834228516
gen group dst list time:  0.0012404918670654297
time for parepare:  0.0018703937530517578
local_output_nid generation:  0.0008847713470458984
local_in_edges_tensor generation:  0.0020401477813720703
mini_batch_src_global generation:  0.0017750263214111328
r_  generation:  0.018578290939331055
local_output_nid generation:  0.00034356117248535156
local_in_edges_tensor generation:  0.0009217262268066406
mini_batch_src_global generation:  0.0011706352233886719
r_  generation:  0.008942127227783203
local_output_nid generation:  0.0005810260772705078
local_in_edges_tensor generation:  0.0009434223175048828
mini_batch_src_global generation:  0.0012309551239013672
r_  generation:  0.013965845108032227
local_output_nid generation:  0.0008499622344970703
local_in_edges_tensor generation:  0.0013780593872070312
mini_batch_src_global generation:  0.001622915267944336
r_  generation:  0.017960548400878906
local_output_nid generation:  0.0007197856903076172
local_in_edges_tensor generation:  0.0014262199401855469
mini_batch_src_global generation:  0.0016598701477050781
r_  generation:  0.01831674575805664
local_output_nid generation:  0.0003864765167236328
local_in_edges_tensor generation:  0.0006203651428222656
mini_batch_src_global generation:  0.0009326934814453125
r_  generation:  0.007761478424072266
local_output_nid generation:  0.0005080699920654297
local_in_edges_tensor generation:  0.0008094310760498047
mini_batch_src_global generation:  0.001096487045288086
r_  generation:  0.013238906860351562
local_output_nid generation:  0.0006361007690429688
local_in_edges_tensor generation:  0.0009794235229492188
mini_batch_src_global generation:  0.0011701583862304688
r_  generation:  0.014914989471435547
----------------------check_connections_block total spend ----------------------------- 0.16739964485168457
generate_one_block  0.024845123291015625
generate_one_block  0.013681411743164062
generate_one_block  0.01877880096435547
generate_one_block  0.024388790130615234
generate_one_block  0.024005651473999023
generate_one_block  0.011394500732421875
generate_one_block  0.016707181930541992
generate_one_block  0.019834041595458984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018651485443115234
gen group dst list time:  0.00252532958984375
time for parepare:  0.0016520023345947266
local_output_nid generation:  0.0014586448669433594
local_in_edges_tensor generation:  0.0028100013732910156
mini_batch_src_global generation:  0.002439737319946289
r_  generation:  0.02448558807373047
local_output_nid generation:  0.0010318756103515625
local_in_edges_tensor generation:  0.0017852783203125
mini_batch_src_global generation:  0.0022902488708496094
r_  generation:  0.02028369903564453
local_output_nid generation:  0.0012238025665283203
local_in_edges_tensor generation:  0.001833200454711914
mini_batch_src_global generation:  0.001916646957397461
r_  generation:  0.022179603576660156
local_output_nid generation:  0.0013718605041503906
local_in_edges_tensor generation:  0.0046503543853759766
mini_batch_src_global generation:  0.0023119449615478516
r_  generation:  0.02343606948852539
local_output_nid generation:  0.0015134811401367188
local_in_edges_tensor generation:  0.002211332321166992
mini_batch_src_global generation:  0.0018429756164550781
r_  generation:  0.02472400665283203
local_output_nid generation:  0.0009634494781494141
local_in_edges_tensor generation:  0.0013341903686523438
mini_batch_src_global generation:  0.0017161369323730469
r_  generation:  0.019457101821899414
local_output_nid generation:  0.0011379718780517578
local_in_edges_tensor generation:  0.0016429424285888672
mini_batch_src_global generation:  0.0016520023345947266
r_  generation:  0.0213625431060791
local_output_nid generation:  0.0010874271392822266
local_in_edges_tensor generation:  0.0019283294677734375
mini_batch_src_global generation:  0.0017325878143310547
r_  generation:  0.0213620662689209
----------------------check_connections_block total spend ----------------------------- 0.2607264518737793
generate_one_block  0.029897212982177734
generate_one_block  0.026891708374023438
generate_one_block  0.0282590389251709
generate_one_block  0.02950143814086914
generate_one_block  0.030092239379882812
generate_one_block  0.024783849716186523
generate_one_block  0.027019739151000977
generate_one_block  0.027448177337646484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003743171691894531  GigaBytes
Max Memory Allocated: 0.0003743171691894531  GigaBytes

connection checking time:  0.5088415145874023
block generation total time  0.47037577629089355
average batch blocks generation time:  0.058796972036361694
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.037011146545410156  GigaBytes
Max Memory Allocated: 0.037011146545410156  GigaBytes

torch.Size([18991, 500])
torch.Size([15924, 64])
torch.Size([10373, 64])
torch.Size([3081, 64])
torch.Size([666, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.06597042083740234  GigaBytes
Max Memory Allocated: 0.06603670120239258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.03311443328857422  GigaBytes
Max Memory Allocated: 0.06769323348999023  GigaBytes

torch.Size([16952, 500])
torch.Size([11097, 64])
torch.Size([3799, 64])
torch.Size([814, 64])
torch.Size([202, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.0475764274597168  GigaBytes
Max Memory Allocated: 0.06769323348999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.0352015495300293  GigaBytes
Max Memory Allocated: 0.06769323348999023  GigaBytes

torch.Size([17965, 500])
torch.Size([12819, 64])
torch.Size([6283, 64])
torch.Size([1156, 64])
torch.Size([286, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.054800987243652344  GigaBytes
Max Memory Allocated: 0.06769323348999023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.035868167877197266  GigaBytes
Max Memory Allocated: 0.06804180145263672  GigaBytes

torch.Size([18165, 500])
torch.Size([14341, 64])
torch.Size([9349, 64])
torch.Size([2773, 64])
torch.Size([630, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.06146240234375  GigaBytes
Max Memory Allocated: 0.06804180145263672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.036622047424316406  GigaBytes
Max Memory Allocated: 0.06922292709350586  GigaBytes

torch.Size([18599, 500])
torch.Size([15816, 64])
torch.Size([8471, 64])
torch.Size([2485, 64])
torch.Size([380, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.062273502349853516  GigaBytes
Max Memory Allocated: 0.06922292709350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.033600807189941406  GigaBytes
Max Memory Allocated: 0.06922292709350586  GigaBytes

torch.Size([17254, 500])
torch.Size([9568, 64])
torch.Size([3611, 64])
torch.Size([504, 64])
torch.Size([139, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.046183109283447266  GigaBytes
Max Memory Allocated: 0.06922292709350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.033573150634765625  GigaBytes
Max Memory Allocated: 0.06922292709350586  GigaBytes

torch.Size([17105, 500])
torch.Size([11731, 64])
torch.Size([5418, 64])
torch.Size([1312, 64])
torch.Size([201, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.051552772521972656  GigaBytes
Max Memory Allocated: 0.06922292709350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03504514694213867  GigaBytes
Max Memory Allocated: 0.06922292709350586  GigaBytes

torch.Size([17397, 500])
torch.Size([11982, 64])
torch.Size([7145, 64])
torch.Size([1719, 64])
torch.Size([407, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.05557060241699219  GigaBytes
Max Memory Allocated: 0.06922292709350586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016194820404052734 |0.044556379318237305 |0.10257115960121155 |0.00016477704048156738 |0.005235254764556885 |0.007544517517089844 |
----------------------------------------------------------pseudo_mini_loss sum 2.024113655090332
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  317267
Number of first layer input nodes during this epoch:  142428
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.038202762603759766  GigaBytes
Max Memory Allocated: 0.06922292709350586  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005044937133789062
random selection method range initialization spend 0.00011277198791503906
time for parepare:  4.8160552978515625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.1219253540039062e-05
----------------------check_connections_block total spend ----------------------------- 0.001600027084350586
generate_one_block  0.0011103153228759766
generate_one_block  0.001035928726196289
generate_one_block  0.0010306835174560547
generate_one_block  0.0010175704956054688
generate_one_block  0.001012563705444336
generate_one_block  0.0011916160583496094
generate_one_block  0.0010533332824707031
generate_one_block  0.0010135173797607422
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005257129669189453
gen group dst list time:  5.245208740234375e-05
time for parepare:  0.0002799034118652344
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00020599365234375
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001308917999267578
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001900196075439453
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00013566017150878906
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  9.870529174804688e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00019550323486328125
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.000232696533203125
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00018477439880371094
----------------------check_connections_block total spend ----------------------------- 0.0035135746002197266
generate_one_block  0.0013191699981689453
generate_one_block  0.0011687278747558594
generate_one_block  0.001238107681274414
generate_one_block  0.0011882781982421875
generate_one_block  0.0011222362518310547
generate_one_block  0.0012395381927490234
generate_one_block  0.001302957534790039
generate_one_block  0.0012500286102294922
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011811256408691406
gen group dst list time:  0.00010728836059570312
time for parepare:  0.0007863044738769531
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.0002880096435546875
mini_batch_src_global generation:  0.000141143798828125
r_  generation:  0.0012598037719726562
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0006999969482421875
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.0001556873321533203
r_  generation:  0.0014095306396484375
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  0.00013637542724609375
r_  generation:  0.0010120868682861328
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0005207061767578125
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.0009927749633789062
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.00015115737915039062
r_  generation:  0.0015704631805419922
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.0015163421630859375
----------------------check_connections_block total spend ----------------------------- 0.015204906463623047
generate_one_block  0.0033202171325683594
generate_one_block  0.0018532276153564453
generate_one_block  0.0026504993438720703
generate_one_block  0.002252340316772461
generate_one_block  0.0015003681182861328
generate_one_block  0.0021343231201171875
generate_one_block  0.0028367042541503906
generate_one_block  0.002693653106689453
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001956939697265625
gen group dst list time:  0.00028896331787109375
time for parepare:  0.0014798641204833984
local_output_nid generation:  0.0002009868621826172
local_in_edges_tensor generation:  0.0007531642913818359
mini_batch_src_global generation:  0.0007171630859375
r_  generation:  0.0069580078125
local_output_nid generation:  0.00011491775512695312
local_in_edges_tensor generation:  0.000362396240234375
mini_batch_src_global generation:  0.0005347728729248047
r_  generation:  0.004403114318847656
local_output_nid generation:  0.00017023086547851562
local_in_edges_tensor generation:  0.00045752525329589844
mini_batch_src_global generation:  0.0006542205810546875
r_  generation:  0.005988597869873047
local_output_nid generation:  0.00017642974853515625
local_in_edges_tensor generation:  0.0005452632904052734
mini_batch_src_global generation:  0.0006158351898193359
r_  generation:  0.005826234817504883
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.00023674964904785156
mini_batch_src_global generation:  0.00041031837463378906
r_  generation:  0.0033206939697265625
local_output_nid generation:  0.0001366138458251953
local_in_edges_tensor generation:  0.0003116130828857422
mini_batch_src_global generation:  0.00040078163146972656
r_  generation:  0.0042192935943603516
local_output_nid generation:  0.0002288818359375
local_in_edges_tensor generation:  0.0004711151123046875
mini_batch_src_global generation:  0.0006890296936035156
r_  generation:  0.007566928863525391
local_output_nid generation:  0.00013065338134765625
local_in_edges_tensor generation:  0.0003857612609863281
mini_batch_src_global generation:  0.0019502639770507812
r_  generation:  0.005507707595825195
----------------------check_connections_block total spend ----------------------------- 0.0669546127319336
generate_one_block  0.01079106330871582
generate_one_block  0.0064465999603271484
generate_one_block  0.008857488632202148
generate_one_block  0.008693933486938477
generate_one_block  0.00540924072265625
generate_one_block  0.0064046382904052734
generate_one_block  0.012244462966918945
generate_one_block  0.008046150207519531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023043155670166016
gen group dst list time:  0.0011494159698486328
time for parepare:  0.0016453266143798828
local_output_nid generation:  0.0009462833404541016
local_in_edges_tensor generation:  0.0020487308502197266
mini_batch_src_global generation:  0.0016126632690429688
r_  generation:  0.020186185836791992
local_output_nid generation:  0.0005662441253662109
local_in_edges_tensor generation:  0.0011894702911376953
mini_batch_src_global generation:  0.0017626285552978516
r_  generation:  0.013825654983520508
local_output_nid generation:  0.0006489753723144531
local_in_edges_tensor generation:  0.0011444091796875
mini_batch_src_global generation:  0.0011641979217529297
r_  generation:  0.015275001525878906
local_output_nid generation:  0.0007817745208740234
local_in_edges_tensor generation:  0.0013818740844726562
mini_batch_src_global generation:  0.0017514228820800781
r_  generation:  0.017144441604614258
local_output_nid generation:  0.0005412101745605469
local_in_edges_tensor generation:  0.0007839202880859375
mini_batch_src_global generation:  0.0012171268463134766
r_  generation:  0.012884855270385742
local_output_nid generation:  0.0006291866302490234
local_in_edges_tensor generation:  0.0009028911590576172
mini_batch_src_global generation:  0.0009822845458984375
r_  generation:  0.013782501220703125
local_output_nid generation:  0.0008828639984130859
local_in_edges_tensor generation:  0.0012743473052978516
mini_batch_src_global generation:  0.001646280288696289
r_  generation:  0.01899099349975586
local_output_nid generation:  0.0005192756652832031
local_in_edges_tensor generation:  0.0007781982421875
mini_batch_src_global generation:  0.0013186931610107422
r_  generation:  0.013195037841796875
----------------------check_connections_block total spend ----------------------------- 0.1828153133392334
generate_one_block  0.023186683654785156
generate_one_block  0.018656015396118164
generate_one_block  0.021249771118164062
generate_one_block  0.023194313049316406
generate_one_block  0.01743769645690918
generate_one_block  0.016276121139526367
generate_one_block  0.024796009063720703
generate_one_block  0.018064498901367188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017435550689697266
gen group dst list time:  0.0026979446411132812
time for parepare:  0.0018279552459716797
local_output_nid generation:  0.0014586448669433594
local_in_edges_tensor generation:  0.0026514530181884766
mini_batch_src_global generation:  0.002097606658935547
r_  generation:  0.024311542510986328
local_output_nid generation:  0.0011088848114013672
local_in_edges_tensor generation:  0.001753091812133789
mini_batch_src_global generation:  0.0021812915802001953
r_  generation:  0.020779848098754883
local_output_nid generation:  0.0012924671173095703
local_in_edges_tensor generation:  0.002129793167114258
mini_batch_src_global generation:  0.0016827583312988281
r_  generation:  0.022550582885742188
local_output_nid generation:  0.0025196075439453125
local_in_edges_tensor generation:  0.0024771690368652344
mini_batch_src_global generation:  0.001928567886352539
r_  generation:  0.023956298828125
local_output_nid generation:  0.0012369155883789062
local_in_edges_tensor generation:  0.0014717578887939453
mini_batch_src_global generation:  0.0017466545104980469
r_  generation:  0.020998716354370117
local_output_nid generation:  0.0013432502746582031
local_in_edges_tensor generation:  0.0018248558044433594
mini_batch_src_global generation:  0.001790761947631836
r_  generation:  0.021869182586669922
local_output_nid generation:  0.0015397071838378906
local_in_edges_tensor generation:  0.0022995471954345703
mini_batch_src_global generation: Using backend: pytorch
 0.002185344696044922
r_  generation:  0.026259660720825195
local_output_nid generation:  0.0010228157043457031
local_in_edges_tensor generation:  0.0015974044799804688
mini_batch_src_global generation:  0.0016927719116210938
r_  generation:  0.020082712173461914
----------------------check_connections_block total spend ----------------------------- 0.26378750801086426
generate_one_block  0.0296018123626709
generate_one_block  0.027579784393310547
generate_one_block  0.031029462814331055
generate_one_block  0.031247615814208984
generate_one_block  0.026891708374023438
generate_one_block  0.029310226440429688
generate_one_block  0.03166985511779785
generate_one_block  0.02656269073486328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.038202762603759766  GigaBytes
Max Memory Allocated: 0.06922292709350586  GigaBytes

connection checking time:  0.532275915145874
block generation total time  0.4927182197570801
average batch blocks generation time:  0.06158977746963501
block dataloader generation time/epoch 1.0959272384643555
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03786611557006836  GigaBytes
Max Memory Allocated: 0.06983661651611328  GigaBytes

torch.Size([18870, 500])
torch.Size([15347, 64])
torch.Size([9847, 64])
torch.Size([2095, 64])
torch.Size([513, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.06427574157714844  GigaBytes
Max Memory Allocated: 0.06983661651611328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03391075134277344  GigaBytes
Max Memory Allocated: 0.06983661651611328  GigaBytes

torch.Size([16893, 500])
torch.Size([11691, 64])
torch.Size([6139, 64])
torch.Size([1122, 64])
torch.Size([293, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.05205059051513672  GigaBytes
Max Memory Allocated: 0.06983661651611328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03554582595825195  GigaBytes
Max Memory Allocated: 0.06983661651611328  GigaBytes

torch.Size([17690, 500])
torch.Size([13257, 64])
torch.Size([6651, 64])
torch.Size([1893, 64])
torch.Size([390, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.05683279037475586  GigaBytes
Max Memory Allocated: 0.06983661651611328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03689098358154297  GigaBytes
Max Memory Allocated: 0.06983661651611328  GigaBytes

torch.Size([18383, 500])
torch.Size([15109, 64])
torch.Size([7960, 64])
torch.Size([2051, 64])
torch.Size([319, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.06180095672607422  GigaBytes
Max Memory Allocated: 0.06983661651611328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.03452301025390625  GigaBytes
Max Memory Allocated: 0.06983661651611328  GigaBytes

torch.Size([17248, 500])
torch.Size([11338, 64])
torch.Size([5334, 64])
torch.Size([862, 64])
torch.Size([225, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.050898075103759766  GigaBytes
Max Memory Allocated: 0.06983661651611328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.036002159118652344  GigaBytes
Max Memory Allocated: 0.06983661651611328  GigaBytes

torch.Size([18025, 500])
torch.Size([12716, 64])
torch.Size([6285, 64])
torch.Size([1688, 64])
torch.Size([373, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.05558300018310547  GigaBytes
Max Memory Allocated: 0.06983661651611328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.037720680236816406  GigaBytes
Max Memory Allocated: 0.07000160217285156  GigaBytes

torch.Size([18763, 500])
torch.Size([15968, 64])
torch.Size([9259, 64])
torch.Size([2886, 64])
torch.Size([486, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.06515741348266602  GigaBytes
Max Memory Allocated: 0.07000160217285156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.03254842758178711  GigaBytes
Max Memory Allocated: 0.07000160217285156  GigaBytes

torch.Size([16138, 500])
torch.Size([11321, 64])
torch.Size([5445, 64])
torch.Size([1643, 64])
torch.Size([319, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4119873046875 GB
    Memory Allocated: 0.05057096481323242  GigaBytes
Max Memory Allocated: 0.07000160217285156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014203488826751709 |0.002359062433242798 |0.008005619049072266 |0.0001411139965057373 |0.006255894899368286 |0.00374603271484375 |
----------------------------------------------------------pseudo_mini_loss sum 2.006197452545166
Total (block generation + training)time/epoch 1.362048625946045
Training time/epoch 0.2655930519104004
Training time without block to device /epoch 0.246720552444458
Training time without total dataloading part /epoch 0.11896705627441406
load block tensor time/epoch 0.11362791061401367
block to device time/epoch 0.018872499465942383
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  323192
Number of first layer input nodes during this epoch:  142010
