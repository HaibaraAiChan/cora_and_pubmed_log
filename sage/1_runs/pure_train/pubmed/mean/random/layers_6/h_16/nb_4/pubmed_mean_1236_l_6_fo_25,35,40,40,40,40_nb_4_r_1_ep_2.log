main start at this time 1648533096.5108895
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0015571117401123047
random selection method range initialization spend 0.00022220611572265625
time for parepare:  4.57763671875e-05
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0022280216217041016
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  8.344650268554688e-05
----------------------check_connections_block total spend ----------------------------- 0.003023386001586914
generate_one_block  0.0013608932495117188
generate_one_block  0.0011947154998779297
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009777545928955078
gen group dst list time:  2.5510787963867188e-05
time for parepare:  0.00023603439331054688
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0005064010620117188
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  0.0001163482666015625
r_  generation:  0.0008165836334228516
----------------------check_connections_block total spend ----------------------------- 0.002490520477294922
generate_one_block  0.00177764892578125
generate_one_block  0.002111196517944336
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001051187515258789
gen group dst list time:  6.628036499023438e-05
time for parepare:  0.0007321834564208984
local_output_nid generation:  8.511543273925781e-05
local_in_edges_tensor generation:  0.0003612041473388672
mini_batch_src_global generation:  0.00023484230041503906
r_  generation:  0.0030167102813720703
local_output_nid generation:  0.00011801719665527344
local_in_edges_tensor generation:  0.0003337860107421875
mini_batch_src_global generation:  0.0005931854248046875
r_  generation:  0.004990339279174805
----------------------check_connections_block total spend ----------------------------- 0.012644767761230469
generate_one_block  0.005555868148803711
generate_one_block  0.006856679916381836
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002044200897216797
gen group dst list time:  0.00019478797912597656
time for parepare:  0.001432180404663086
local_output_nid generation:  0.00035262107849121094
local_in_edges_tensor generation:  0.0011677742004394531
mini_batch_src_global generation:  0.001374959945678711
r_  generation:  0.012778282165527344
local_output_nid generation:  0.0004191398620605469
local_in_edges_tensor generation:  0.0008971691131591797
mini_batch_src_global generation:  0.0016078948974609375
r_  generation:  0.01499032974243164
----------------------check_connections_block total spend ----------------------------- 0.0421907901763916
generate_one_block  0.01678323745727539
generate_one_block  0.020922422409057617
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016956329345703125
gen group dst list time:  0.00049591064453125
time for parepare:  0.0016765594482421875
local_output_nid generation:  0.0010669231414794922
local_in_edges_tensor generation:  0.002119302749633789
mini_batch_src_global generation:  0.002155303955078125
r_  generation:  0.02337503433227539
local_output_nid generation:  0.0010771751403808594
local_in_edges_tensor generation:  0.0024042129516601562
mini_batch_src_global generation:  0.002665281295776367
r_  generation:  0.023984909057617188
----------------------check_connections_block total spend ----------------------------- 0.07151412963867188
generate_one_block  0.0284271240234375
generate_one_block  0.031101226806640625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018651485443115234
gen group dst list time:  0.0007512569427490234
time for parepare:  0.0017006397247314453
local_output_nid generation:  0.0014789104461669922
local_in_edges_tensor generation:  0.0027146339416503906
mini_batch_src_global generation:  0.002207040786743164
r_  generation:  0.026361465454101562
local_output_nid generation:  0.001331329345703125
local_in_edges_tensor generation:  0.002427816390991211
mini_batch_src_global generation:  0.002796649932861328
r_  generation:  0.02677154541015625
----------------------check_connections_block total spend ----------------------------- 0.07950758934020996
generate_one_block  0.031052112579345703
generate_one_block  0.03474926948547363
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

connection checking time:  0.20834779739379883
block generation total time  0.1793367862701416
average batch blocks generation time:  0.0896683931350708
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03754758834838867  GigaBytes
Max Memory Allocated: 0.03754758834838867  GigaBytes

torch.Size([19282, 500])
torch.Size([17631, 16])
torch.Size([13536, 16])
torch.Size([4524, 16])
torch.Size([1142, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.047841548919677734  GigaBytes
Max Memory Allocated: 0.04785871505737305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03785514831542969  GigaBytes
Max Memory Allocated: 0.07210159301757812  GigaBytes

torch.Size([19343, 500])
torch.Size([17906, 16])
torch.Size([13947, 16])
torch.Size([5822, 16])
torch.Size([1612, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.04887056350708008  GigaBytes
Max Memory Allocated: 0.07210159301757812  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021302461624145508 |0.1723155975341797 |0.38426291942596436 |0.00020003318786621094 |0.009113430976867676 |0.008311986923217773 |
----------------------------------------------------------pseudo_mini_loss sum 2.1881344318389893
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  115101
Number of first layer input nodes during this epoch:  38625
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.04170989990234375  GigaBytes
Max Memory Allocated: 0.07210159301757812  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005071163177490234
random selection method range initialization spend 0.00011301040649414062
time for parepare:  4.792213439941406e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.508827209472656e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00011348724365234375
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  6.794929504394531e-05
----------------------check_connections_block total spend ----------------------------- 0.0007672309875488281
generate_one_block  0.0012018680572509766
generate_one_block  0.0010912418365478516
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000518798828125
gen group dst list time:  2.574920654296875e-05
time for parepare:  0.00026917457580566406
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0005400180816650391
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0006403923034667969
----------------------check_connections_block total spend ----------------------------- 0.0023741722106933594
generate_one_block  0.0017278194427490234
generate_one_block  0.0019214153289794922
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0009462833404541016
gen group dst list time:  6.771087646484375e-05
time for parepare:  0.0007183551788330078
local_output_nid generation:  9.822845458984375e-05
local_in_edges_tensor generation:  0.00040149688720703125
mini_batch_src_global generation:  0.0003256797790527344
r_  generation:  0.003220796585083008
local_output_nid generation:  0.0001125335693359375
local_in_edges_tensor generation:  0.0003085136413574219
mini_batch_src_global generation:  0.0004563331604003906
r_  generation:  0.004247426986694336
----------------------check_connections_block total spend ----------------------------- 0.011865854263305664
generate_one_block  0.0052356719970703125
generate_one_block  0.0062215328216552734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0021355152130126953
gen group dst list time:  0.00019598007202148438
time for parepare:  0.0012323856353759766
local_output_nid generation:  0.00036525726318359375
local_in_edges_tensor generation:  0.0011620521545410156
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.013401031494140625
local_output_nid generation:  0.00039196014404296875
local_in_edges_tensor generation:  0.0007848739624023438
mini_batch_src_global generation:  0.0014910697937011719
r_  generation:  0.01335763931274414
----------------------check_connections_block total spend ----------------------------- 0.040015459060668945
generate_one_block  0.018460988998413086
generate_one_block  0.018470048904418945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018684864044189453
gen group dst list time:  0.0004787445068359375
time for parepare:  0.0014369487762451172
local_output_nid generation:  0.001085042953491211
local_in_edges_tensor generation:  0.002285003662109375
mini_batch_src_global generation:  0.0019507408142089844
r_  generation:  0.02286386489868164
local_output_nid generation:  0.0010974407196044922
local_in_edges_tensor generation:  0.0023255348205566406
mini_batch_src_global generation:  0.0024394989013671875
r_  generation:  0.022345781326293945
----------------------check_connections_block total spend ----------------------------- 0.06840944290161133
generate_one_block  0.028496503829956055
generate_one_block  0.03059220314025879
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002273082733154297
gen group dst list time:  0.0007345676422119141
time for parepare:  0.0015728473663330078
local_output_nid generation:  0.0014488697052001953
local_in_edges_tensor generation:  0.0029349327087402344
mini_batch_src_global generation:  0.001965761184692383
r_  generation:  0.02586078643798828
local_output_nid generation:  0.001508951187133789
local_in_edges_tensor generation:  0.0025224685668945312
mini_batch_src_global generation:  0.0025641918182373047
r_  generation:  0.025780439376831055
----------------------check_connections_block total spend ----------------------------- 0.07763099670410156
generate_one_block  0.031206846237182617
generate_one_block  0.03386354446411133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.04170989990234375  GigaBytes
Max Memory Allocated: 0.07210159301757812  GigaBytes

connection checking time:  0.20029592514038086
block generation total time  0.17619657516479492
average batch blocks generation time:  0.08809828758239746
block dataloader generation time/epoch 0.45433735847473145
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03793001174926758  GigaBytes
Max Memory Allocated: 0.07234621047973633  GigaBytes

torch.Size([19335, 500])
torch.Size([17971, 16])
torch.Size([14191, 16])
torch.Size([5217, 16])
torch.Size([1337, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.048732757568359375  GigaBytes
Max Memory Allocated: 0.07234621047973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03774404525756836  GigaBytes
Max Memory Allocated: 0.07234621047973633  GigaBytes

torch.Size([19224, 500])
torch.Size([17627, 16])
torch.Size([13524, 16])
torch.Size([5343, 16])
torch.Size([1428, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.04852867126464844  GigaBytes
Max Memory Allocated: 0.07234621047973633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013816356658935547 |0.0019092559814453125 |0.0063838958740234375 |0.00013649463653564453 |0.004555225372314453 |0.003387451171875 |
----------------------------------------------------------pseudo_mini_loss sum 2.497593879699707
Total (block generation + training)time/epoch 0.5145833492279053
Training time/epoch 0.05991053581237793
Training time without block to device /epoch 0.056092023849487305
Training time without total dataloading part /epoch 0.02553868293762207
load block tensor time/epoch 0.027632713317871094
block to device time/epoch 0.003818511962890625
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  115553
Number of first layer input nodes during this epoch:  38559
