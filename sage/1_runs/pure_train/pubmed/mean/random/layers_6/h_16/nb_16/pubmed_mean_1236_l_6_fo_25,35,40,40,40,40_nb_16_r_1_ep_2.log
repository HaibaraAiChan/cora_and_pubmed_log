main start at this time 1648533119.254746
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00054931640625
random selection method range initialization spend 0.00016498565673828125
time for parepare:  4.7206878662109375e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.0009002685546875
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2411346435546875e-05
----------------------check_connections_block total spend ----------------------------- 0.0026776790618896484
generate_one_block  0.0011715888977050781
generate_one_block  0.0010533332824707031
generate_one_block  0.0010519027709960938
generate_one_block  0.0010361671447753906
generate_one_block  0.0010638236999511719
generate_one_block  0.0010743141174316406
generate_one_block  0.0010578632354736328
generate_one_block  0.0010330677032470703
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005431175231933594
gen group dst list time:  5.245208740234375e-05
time for parepare:  0.000255584716796875
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00012111663818359375
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00023746490478515625
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001246929168701172
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.130073547363281e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0003898143768310547
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00011777877807617188
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0002193450927734375
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00010275840759277344
----------------------check_connections_block total spend ----------------------------- 0.0035436153411865234
generate_one_block  0.0011980533599853516
generate_one_block  0.0013532638549804688
generate_one_block  0.001172780990600586
generate_one_block  0.0011594295501708984
generate_one_block  0.001529693603515625
generate_one_block  0.001168966293334961
generate_one_block  0.0013256072998046875
generate_one_block  0.0011425018310546875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012323856353759766
gen group dst list time:  9.250640869140625e-05
time for parepare:  0.0007734298706054688
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00029087066650390625
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0008776187896728516
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  0.00016832351684570312
r_  generation:  0.0013833045959472656
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  0.00010848045349121094
r_  generation:  0.0008547306060791016
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0003998279571533203
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  0.00025582313537597656
r_  generation:  0.002616405487060547
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.0005915164947509766
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.001371145248413086
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.0006878376007080078
----------------------check_connections_block total spend ----------------------------- 0.014849424362182617
generate_one_block  0.0025179386138916016
generate_one_block  0.0025482177734375
generate_one_block  0.002108335494995117
generate_one_block  0.0013134479522705078
generate_one_block  0.0040585994720458984
generate_one_block  0.004628658294677734
generate_one_block  0.0028150081634521484
generate_one_block  0.0017712116241455078
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0029392242431640625
gen group dst list time:  0.0002560615539550781
time for parepare:  0.0016503334045410156
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.0006411075592041016
mini_batch_src_global generation:  0.0006535053253173828
r_  generation:  0.0053365230560302734
local_output_nid generation:  0.00018596649169921875
local_in_edges_tensor generation:  0.00044274330139160156
mini_batch_src_global generation:  0.0008339881896972656
r_  generation:  0.006392717361450195
local_output_nid generation:  0.0001583099365234375
local_in_edges_tensor generation:  0.00038743019104003906
mini_batch_src_global generation:  0.0005314350128173828
r_  generation:  0.0051119327545166016
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  0.0002579689025878906
r_  generation:  0.0018808841705322266
local_output_nid generation:  0.0002193450927734375
local_in_edges_tensor generation:  0.0004942417144775391
mini_batch_src_global generation:  0.0006225109100341797
r_  generation:  0.007552385330200195
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.00023674964904785156
mini_batch_src_global generation:  0.00039458274841308594
r_  generation:  0.0026624202728271484
local_output_nid generation:  0.0001678466796875
local_in_edges_tensor generation:  0.00037860870361328125
mini_batch_src_global generation:  0.0005257129669189453
r_  generation:  0.00611424446105957
local_output_nid generation:  0.00012040138244628906
local_in_edges_tensor generation:  0.00029921531677246094
mini_batch_src_global generation:  0.0004878044128417969
r_  generation:  0.004512310028076172
----------------------check_connections_block total spend ----------------------------- 0.060208797454833984
generate_one_block  0.008329153060913086
generate_one_block  0.00966334342956543
generate_one_block  0.007642269134521484
generate_one_block  0.00321197509765625
generate_one_block  0.011835098266601562
generate_one_block  0.004554033279418945
generate_one_block  0.009241819381713867
generate_one_block  0.006981372833251953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023615360260009766
gen group dst list time:  0.001256704330444336
time for parepare:  0.001834869384765625
local_output_nid generation:  0.0005688667297363281
local_in_edges_tensor generation:  0.001547098159790039
mini_batch_src_global generation:  0.0014421939849853516
r_  generation:  0.013991355895996094
local_output_nid generation:  0.0009069442749023438
local_in_edges_tensor generation:  0.001943349838256836
mini_batch_src_global generation:  0.001958131790161133
r_  generation:  0.017440080642700195
local_output_nid generation:  0.0007345676422119141
local_in_edges_tensor generation:  0.0014071464538574219
mini_batch_src_global generation:  0.0016248226165771484
r_  generation:  0.017057180404663086
local_output_nid generation:  0.000347137451171875
local_in_edges_tensor generation:  0.0005931854248046875
mini_batch_src_global generation:  0.0008258819580078125
r_  generation:  0.007254123687744141
local_output_nid generation:  0.0006973743438720703
local_in_edges_tensor generation:  0.0010492801666259766
mini_batch_src_global generation:  0.0012738704681396484
r_  generation:  0.017755508422851562
local_output_nid generation:  0.0004210472106933594
local_in_edges_tensor generation:  0.0006897449493408203
mini_batch_src_global generation:  0.0009665489196777344
r_  generation:  0.008968830108642578
local_output_nid generation:  0.0007367134094238281
local_in_edges_tensor generation:  0.0011377334594726562
mini_batch_src_global generation:  0.0014810562133789062
r_  generation:  0.01834273338317871
local_output_nid generation:  0.0006244182586669922
local_in_edges_tensor generation:  0.0012657642364501953
mini_batch_src_global generation:  0.001514434814453125
r_  generation:  0.015616178512573242
----------------------check_connections_block total spend ----------------------------- 0.17183446884155273
generate_one_block  0.019016027450561523
generate_one_block  0.0237119197845459
generate_one_block  0.02257251739501953
generate_one_block  0.011249542236328125
generate_one_block  0.02227020263671875
generate_one_block  0.013535022735595703
generate_one_block  0.02346515655517578
generate_one_block  0.02142500877380371
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017638206481933594
gen group dst list time:  0.0027365684509277344
time for parepare:  0.0018155574798583984
local_output_nid generation:  0.001230001449584961
local_in_edges_tensor generation:  0.002237558364868164
mini_batch_src_global generation:  0.001973390579223633
r_  generation:  0.021498918533325195
local_output_nid generation:  0.0013947486877441406
local_in_edges_tensor generation:  0.002201080322265625
mini_batch_src_global generation:  0.002683401107788086
r_  generation:  0.024557828903198242
local_output_nid generation:  0.0015590190887451172
local_in_edges_tensor generation:  0.0025014877319335938
mini_batch_src_global generation:  0.0019464492797851562
r_  generation:  0.02445197105407715
local_output_nid generation:  0.0010528564453125
local_in_edges_tensor generation:  0.0036830902099609375
mini_batch_src_global generation:  0.001581430435180664
r_  generation:  0.017967939376831055
local_output_nid generation:  0.0015234947204589844
local_in_edges_tensor generation:  0.0018658638000488281
mini_batch_src_global generation:  0.0018367767333984375
r_  generation:  0.023952484130859375
local_output_nid generation:  0.0009953975677490234
local_in_edges_tensor generation:  0.0014908313751220703
mini_batch_src_global generation:  0.0015587806701660156
r_  generation:  0.01917409896850586
local_output_nid generation:  0.0014927387237548828
local_in_edges_tensor generation:  0.0025081634521484375
mini_batch_src_global generation:  0.002003908157348633
r_  generation:  0.024687528610229492
local_output_nid generation:  0.0013959407806396484
local_in_edges_tensor generation:  0.001909017562866211
mini_batch_src_global generation:  0.001913309097290039
r_  generation:  0.023408174514770508
----------------------check_connections_block total spend ----------------------------- 0.26462221145629883
generate_one_block  0.026347875595092773
generate_one_block  0.03126382827758789
generate_one_block  0.030065059661865234
generate_one_block  0.022520065307617188
generate_one_block  0.02942657470703125
generate_one_block  0.02430129051208496
generate_one_block  0.030815601348876953
generate_one_block  0.02939915657043457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

connection checking time:  0.5150585174560547
block generation total time  0.4746556282043457
average batch blocks generation time:  0.05933195352554321
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03289794921875  GigaBytes
Max Memory Allocated: 0.03289794921875  GigaBytes

torch.Size([17073, 500])
torch.Size([12231, 16])
torch.Size([5683, 16])
torch.Size([1468, 16])
torch.Size([246, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03832387924194336  GigaBytes
Max Memory Allocated: 0.038324832916259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.036481380462646484  GigaBytes
Max Memory Allocated: 0.06711387634277344  GigaBytes

torch.Size([18739, 500])
torch.Size([14741, 16])
torch.Size([9174, 16])
torch.Size([2032, 16])
torch.Size([582, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.04371356964111328  GigaBytes
Max Memory Allocated: 0.06711387634277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03642988204956055  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([18438, 500])
torch.Size([14847, 16])
torch.Size([7521, 16])
torch.Size([1830, 16])
torch.Size([263, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.04306459426879883  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03002309799194336  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([15684, 500])
torch.Size([8939, 16])
torch.Size([3239, 16])
torch.Size([603, 16])
torch.Size([146, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.033538818359375  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03540849685668945  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([18244, 500])
torch.Size([14609, 16])
torch.Size([8123, 16])
torch.Size([2754, 16])
torch.Size([680, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.042670249938964844  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.0323491096496582  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([16881, 500])
torch.Size([10440, 16])
torch.Size([4906, 16])
torch.Size([923, 16])
torch.Size([244, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03680419921875  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03650999069213867  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([18745, 500])
torch.Size([14989, 16])
torch.Size([8812, 16])
torch.Size([2186, 16])
torch.Size([490, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.04374980926513672  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.034935951232910156  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([18102, 500])
torch.Size([13934, 16])
torch.Size([6464, 16])
torch.Size([1478, 16])
torch.Size([205, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.04094505310058594  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011851400136947632 |0.044626712799072266 |0.10283181071281433 |0.00016096234321594238 |0.005783647298812866 |0.0039212703704833984 |
----------------------------------------------------------pseudo_mini_loss sum 2.76405930519104
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  317045
Number of first layer input nodes during this epoch:  141906
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03744220733642578  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005092620849609375
random selection method range initialization spend 0.0001220703125
time for parepare:  4.8160552978515625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.09808349609375e-05
----------------------check_connections_block total spend ----------------------------- 0.0016531944274902344
generate_one_block  0.0012209415435791016
generate_one_block  0.0010902881622314453
generate_one_block  0.0010838508605957031
generate_one_block  0.001062631607055664
generate_one_block  0.0010919570922851562
generate_one_block  0.0012176036834716797
generate_one_block  0.001077413558959961
generate_one_block  0.0010669231414794922
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005345344543457031
gen group dst list time:  5.316734313964844e-05
time for parepare:  0.00028014183044433594
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.000152587890625
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00025081634521484375
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001342296600341797
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00010633468627929688
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.0002949237823486328
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00012969970703125
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00013756752014160156
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00015997886657714844
----------------------check_connections_block total spend ----------------------------- 0.003537893295288086
generate_one_block  0.0012640953063964844
generate_one_block  0.0013737678527832031
generate_one_block  0.001233816146850586
generate_one_block  0.0012030601501464844
generate_one_block  0.0014505386352539062
generate_one_block  0.0012078285217285156
generate_one_block  0.0012402534484863281
generate_one_block  0.001283407211303711
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010845661163330078
gen group dst list time:  0.00010704994201660156
time for parepare:  0.0008022785186767578
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0002815723419189453
mini_batch_src_global generation:  0.0001316070556640625
r_  generation:  0.0009753704071044922
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  0.0001850128173828125
r_  generation:  0.0014374256134033203
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0008473396301269531
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0005922317504882812
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  0.00020813941955566406
r_  generation:  0.0021314620971679688
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0006396770477294922
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0009822845458984375
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  0.0001380443572998047
r_  generation:  0.0012669563293457031
----------------------check_connections_block total spend ----------------------------- 0.015104532241821289
generate_one_block  0.0022118091583251953
generate_one_block  0.002779722213745117
generate_one_block  0.001958608627319336
generate_one_block  0.0016453266143798828
generate_one_block  0.003499746322631836
generate_one_block  0.0016436576843261719
generate_one_block  0.002150297164916992
generate_one_block  0.0024118423461914062
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018131732940673828
gen group dst list time:  0.0002791881561279297
time for parepare:  0.001477956771850586
local_output_nid generation:  0.0001633167266845703
local_in_edges_tensor generation:  0.0006895065307617188
mini_batch_src_global generation:  0.0005395412445068359
r_  generation:  0.005651950836181641
local_output_nid generation:  0.00019979476928710938
local_in_edges_tensor generation:  0.0004589557647705078
mini_batch_src_global generation:  0.0007355213165283203
r_  generation:  0.006633758544921875
local_output_nid generation:  0.0001227855682373047
local_in_edges_tensor generation:  0.00032138824462890625
mini_batch_src_global generation:  0.0005290508270263672
r_  generation:  0.004464864730834961
local_output_nid generation:  9.965896606445312e-05
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  0.00040030479431152344
r_  generation:  0.0036525726318359375
local_output_nid generation:  0.00021195411682128906
local_in_edges_tensor generation:  0.00045371055603027344
mini_batch_src_global generation:  0.0006792545318603516
r_  generation:  0.0075228214263916016
local_output_nid generation:  9.608268737792969e-05
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  0.00044465065002441406
r_  generation:  0.0032570362091064453
local_output_nid generation:  0.00015306472778320312
local_in_edges_tensor generation:  0.00034332275390625
mini_batch_src_global generation:  0.0004703998565673828
r_  generation:  0.006501197814941406
local_output_nid generation:  0.0001246929168701172
local_in_edges_tensor generation:  0.00032067298889160156
mini_batch_src_global generation:  0.0005271434783935547
r_  generation:  0.0049664974212646484
----------------------check_connections_block total spend ----------------------------- 0.06313538551330566
generate_one_block  0.00857996940612793
generate_one_block  0.009419679641723633
generate_one_block  0.00685429573059082
generate_one_block  0.0060307979583740234
generate_one_block  0.011483907699584961
generate_one_block  0.005220174789428711
generate_one_block  0.008178472518920898
generate_one_block  0.0076465606689453125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002209901809692383
gen group dst list time:  0.0011265277862548828
time for parepare:  0.0016202926635742188
local_output_nid generation:  0.0005645751953125
local_in_edges_tensor generation:  0.001500844955444336
mini_batch_src_global generation:  0.0011227130889892578
r_  generation:  0.013885974884033203
local_output_nid generation:  0.0008528232574462891
local_in_edges_tensor generation:  0.0017724037170410156
mini_batch_src_global generation:  0.003287792205810547
r_  generation:  0.01720738410949707
local_output_nid generation:  0.0005788803100585938
local_in_edges_tensor generation:  0.0010652542114257812
mini_batch_src_global generation:  0.0012829303741455078
r_  generation:  0.014213800430297852
local_output_nid generation:  0.0007021427154541016
local_in_edges_tensor generation:  0.001148223876953125
mini_batch_src_global generation:  0.001161813735961914
r_  generation:  0.014597654342651367
local_output_nid generation:  0.0008213520050048828
local_in_edges_tensor generation:  0.0015311241149902344
mini_batch_src_global generation:  0.001537322998046875
r_  generation:  0.017398357391357422
local_output_nid generation:  0.0005393028259277344
local_in_edges_tensor generation:  0.0007984638214111328
mini_batch_src_global generation:  0.0012013912200927734
r_  generation:  0.012887001037597656
local_output_nid generation:  0.0007431507110595703
local_in_edges_tensor generation:  0.0024421215057373047
mini_batch_src_global generation:  0.0012977123260498047
r_  generation:  0.01499319076538086
local_output_nid generation:  0.0004923343658447266
local_in_edges_tensor generation:  0.0007338523864746094
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.011774539947509766
----------------------check_connections_block total spend ----------------------------- 0.17458295822143555
generate_one_block  0.018167972564697266
generate_one_block  0.02347564697265625
generate_one_block  0.018756628036499023
generate_one_block  0.02036428451538086
generate_one_block  0.023233652114868164
generate_one_block  0.017020702362060547
generate_one_block  0.01932382583618164
generate_one_block  0.01607823371887207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017232894897460938
gen group dst list time:  0.0026459693908691406
time for parepare:  0.0018057823181152344
local_output_nid generation:  0.001264333724975586
local_in_edges_tensor generation:  0.0022203922271728516
mini_batch_src_global generation:  0.0018362998962402344
r_  generation:  0.020933866500854492
local_output_nid generation:  0.0013866424560546875
local_in_edges_tensor generation:  0.0026154518127441406
mini_batch_src_global generation:  0.0026884078979492188
r_  generation:  0.024136781692504883
local_output_nid generation:  0.0012748241424560547
local_in_edges_tensor generation:  0.002141237258911133
mini_batch_src_global generation:  0.001783609390258789
r_  generation:  0.021824121475219727
local_output_nid generation:  0.0014557838439941406
local_in_edges_tensor generation:  0.0018458366394042969
mini_batch_src_global generation:  0.002156496047973633
r_  generation:  0.022589683532714844
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0022499561309814453
mini_batch_src_global generation:  0.0019457340240478516
r_  generation:  0.024001121520996094
local_output_nid generation:  0.0013620853424072266
local_in_edges_tensor generation:  0.0015413761138916016
mini_batch_src_global generation:  0.0018150806427001953
r_  generation:  0.021407365798950195
local_output_nid generation:  0.0013201236724853516
local_in_edges_tensor generation:  0.002076864242553711Using backend: pytorch

mini_batch_src_global generation:  0.002152681350708008
r_  generation:  0.02449822425842285
local_output_nid generation:  0.0010495185852050781
local_in_edges_tensor generation:  0.0014111995697021484
mini_batch_src_global generation:  0.0017764568328857422
r_  generation:  0.019482135772705078
----------------------check_connections_block total spend ----------------------------- 0.2641725540161133
generate_one_block  0.026109933853149414
generate_one_block  0.031111955642700195
generate_one_block  0.030346393585205078
generate_one_block  0.029145240783691406
generate_one_block  0.030336380004882812
generate_one_block  0.0279541015625
generate_one_block  0.029510498046875
generate_one_block  0.024944067001342773
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03744220733642578  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

connection checking time:  0.5205333232879639
block generation total time  0.47785115242004395
average batch blocks generation time:  0.05973139405250549
block dataloader generation time/epoch 1.0701878070831299
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03271055221557617  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([16855, 500])
torch.Size([12092, 16])
torch.Size([5680, 16])
torch.Size([1774, 16])
torch.Size([273, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03820085525512695  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.03665876388549805  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([18882, 500])
torch.Size([15200, 16])
torch.Size([9343, 16])
torch.Size([2330, 16])
torch.Size([553, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.04411888122558594  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.03332042694091797  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([17190, 500])
torch.Size([12431, 16])
torch.Size([6366, 16])
torch.Size([1423, 16])
torch.Size([308, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.03895378112792969  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.0351862907409668  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([18184, 500])
torch.Size([13186, 16])
torch.Size([6784, 16])
torch.Size([1061, 16])
torch.Size([255, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.04098224639892578  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.03671979904174805  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([18368, 500])
torch.Size([14839, 16])
torch.Size([8425, 16])
torch.Size([2615, 16])
torch.Size([582, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.04402875900268555  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.03289318084716797  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([17000, 500])
torch.Size([11920, 16])
torch.Size([5183, 16])
torch.Size([1027, 16])
torch.Size([235, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.03792238235473633  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.035459041595458984  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([18306, 500])
torch.Size([14147, 16])
torch.Size([7546, 16])
torch.Size([1903, 16])
torch.Size([352, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.04193878173828125  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.031348228454589844  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

torch.Size([16162, 500])
torch.Size([10421, 16])
torch.Size([5065, 16])
torch.Size([1551, 16])
torch.Size([322, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.03622007369995117  GigaBytes
Max Memory Allocated: 0.07046890258789062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013323605060577393 |0.001832813024520874 |0.00706830620765686 |0.00014004111289978027 |0.005355864763259888 |0.0031585693359375 |
----------------------------------------------------------pseudo_mini_loss sum 2.0834813117980957
Total (block generation + training)time/epoch 1.3081395626068115
Training time/epoch 0.2375168800354004
Training time without block to device /epoch 0.2228543758392334
Training time without total dataloading part /epoch 0.10367226600646973
load block tensor time/epoch 0.10658884048461914
block to device time/epoch 0.014662504196166992
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  316495
Number of first layer input nodes during this epoch:  140947
