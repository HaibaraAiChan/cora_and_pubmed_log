main start at this time 1648533131.7531533
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0014972686767578125
random selection method range initialization spend 0.00018715858459472656
time for parepare:  4.9114227294921875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.001077413558959961
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.193450927734375e-05
----------------------check_connections_block total spend ----------------------------- 0.003937244415283203
generate_one_block  0.0012006759643554688
generate_one_block  0.0010592937469482422
generate_one_block  0.0010695457458496094
generate_one_block  0.0010838508605957031
generate_one_block  0.0010387897491455078
generate_one_block  0.0010364055633544922
generate_one_block  0.001041412353515625
generate_one_block  0.0010437965393066406
generate_one_block  0.0010499954223632812
generate_one_block  0.0010523796081542969
generate_one_block  0.0010454654693603516
generate_one_block  0.000990152359008789
generate_one_block  0.0009593963623046875
generate_one_block  0.0009660720825195312
generate_one_block  0.0009663105010986328
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0008475780487060547
gen group dst list time:  8.058547973632812e-05
time for parepare:  0.0002875328063964844
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  8.940696716308594e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.125999450683594e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00018858909606933594
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.723403930664062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  8.177757263183594e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.626678466796875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.724761962890625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.0003268718719482422
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  8.893013000488281e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00016927719116210938
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00010156631469726562
----------------------check_connections_block total spend ----------------------------- 0.004755973815917969
generate_one_block  0.0011751651763916016
generate_one_block  0.0010879039764404297
generate_one_block  0.0013833045959472656
generate_one_block  0.0011265277862548828
generate_one_block  0.0010967254638671875
generate_one_block  0.0011403560638427734
generate_one_block  0.0010728836059570312
generate_one_block  0.0010879039764404297
generate_one_block  0.0011136531829833984
generate_one_block  0.0015039443969726562
generate_one_block  0.0010766983032226562
generate_one_block  0.0009913444519042969
generate_one_block  0.0010325908660888672
generate_one_block  0.0012485980987548828
generate_one_block  0.0010669231414794922
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010538101196289062
gen group dst list time:  0.0001239776611328125
time for parepare:  0.0007345676422119141
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00025534629821777344
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0006337165832519531
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00029397010803222656
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  0.00010561943054199219
r_  generation:  0.0011339187622070312
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0003001689910888672
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00015807151794433594
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0006761550903320312
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00018310546875
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.000209808349609375
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00037169456481933594
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  0.00021886825561523438
r_  generation:  0.002269268035888672
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0004038810729980469
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0002143383026123047
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0003402233123779297
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.0010747909545898438
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  9.274482727050781e-05
r_  generation:  0.0006859302520751953
----------------------check_connections_block total spend ----------------------------- 0.01617717742919922
generate_one_block  0.002443552017211914
generate_one_block  0.0014476776123046875
generate_one_block  0.0022673606872558594
generate_one_block  0.0012974739074707031
generate_one_block  0.001165628433227539
generate_one_block  0.0018563270568847656
generate_one_block  0.0012111663818359375
generate_one_block  0.0012271404266357422
generate_one_block  0.0013599395751953125
generate_one_block  0.004006862640380859
generate_one_block  0.0014235973358154297
generate_one_block  0.0011799335479736328
generate_one_block  0.0013363361358642578
generate_one_block  0.0021805763244628906
generate_one_block  0.0017249584197998047
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020940303802490234
gen group dst list time:  0.0003085136413574219
time for parepare:  0.0017192363739013672
local_output_nid generation:  0.00010728836059570312
local_in_edges_tensor generation:  0.0005850791931152344
mini_batch_src_global generation:  0.0005292892456054688
r_  generation:  0.004088163375854492
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  0.0003380775451660156
r_  generation:  0.0021877288818359375
local_output_nid generation:  0.000156402587890625
local_in_edges_tensor generation:  0.000408172607421875
mini_batch_src_global generation:  0.0006411075592041016
r_  generation:  0.005744218826293945
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  0.00025582313537597656
r_  generation:  0.001264333724975586
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.0007715225219726562
local_output_nid generation:  0.00013065338134765625
local_in_edges_tensor generation:  0.0003185272216796875
mini_batch_src_global generation:  0.00034880638122558594
r_  generation:  0.004410982131958008
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  0.00018978118896484375
r_  generation:  0.0009098052978515625
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.000982522964477539
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  0.0002281665802001953
r_  generation:  0.0024063587188720703
local_output_nid generation:  0.0001690387725830078
local_in_edges_tensor generation:  0.00046634674072265625
mini_batch_src_global generation:  0.0008137226104736328
r_  generation:  0.006942033767700195
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  0.00030422210693359375
r_  generation:  0.0017096996307373047
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  0.00014734268188476562
r_  generation:  0.0012352466583251953
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.0001747608184814453
r_  generation:  0.00162506103515625
local_output_nid generation:  0.000141143798828125
local_in_edges_tensor generation:  0.00033593177795410156
mini_batch_src_global generation:  0.0004432201385498047
r_  generation:  0.005228519439697266
local_output_nid generation:  0.000141143798828125
local_in_edges_tensor generation:  0.00042748451232910156
mini_batch_src_global generation:  0.0006315708160400391
r_  generation:  0.004430055618286133
----------------------check_connections_block total spend ----------------------------- 0.06831145286560059
generate_one_block  0.0074689388275146484
generate_one_block  0.0035469532012939453
generate_one_block  0.008477449417114258
generate_one_block  0.002345561981201172
generate_one_block  0.002107858657836914
generate_one_block  0.007111310958862305
generate_one_block  0.0021114349365234375
generate_one_block  0.002273082733154297
generate_one_block  0.004335880279541016
generate_one_block  0.010707616806030273
generate_one_block  0.00318145751953125
generate_one_block  0.0026192665100097656
generate_one_block  0.003189563751220703
generate_one_block  0.008354425430297852
generate_one_block  0.0070078372955322266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002349376678466797
gen group dst list time:  0.0014994144439697266
time for parepare:  0.0019049644470214844
local_output_nid generation:  0.0004913806915283203
local_in_edges_tensor generation:  0.0013611316680908203
mini_batch_src_global generation:  0.0014617443084716797
r_  generation:  0.01291966438293457
local_output_nid generation:  0.0002524852752685547
local_in_edges_tensor generation:  0.0007061958312988281
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.006948947906494141
local_output_nid generation:  0.0008213520050048828
local_in_edges_tensor generation:  0.0012698173522949219
mini_batch_src_global generation:  0.0015110969543457031
r_  generation:  0.016787290573120117
local_output_nid generation:  0.00020384788513183594
local_in_edges_tensor generation:  0.0003829002380371094
mini_batch_src_global generation:  0.0006461143493652344
r_  generation:  0.0048902034759521484
local_output_nid generation:  0.00016450881958007812
local_in_edges_tensor generation:  0.00034546852111816406
mini_batch_src_global generation:  0.0004267692565917969
r_  generation:  0.0035157203674316406
local_output_nid generation:  0.0006337165832519531
local_in_edges_tensor generation:  0.0009806156158447266
mini_batch_src_global generation:  0.001140594482421875
r_  generation:  0.0162961483001709
local_output_nid generation:  0.0001881122589111328
local_in_edges_tensor generation:  0.0003609657287597656
mini_batch_src_global generation:  0.0006716251373291016
r_  generation:  0.003947257995605469
local_output_nid generation:  0.0002002716064453125
local_in_edges_tensor generation:  0.0004017353057861328
mini_batch_src_global generation:  0.0004703998565673828
r_  generation:  0.00497126579284668
local_output_nid generation:  0.0002865791320800781
local_in_edges_tensor generation:  0.0005006790161132812
mini_batch_src_global generation:  0.0006883144378662109
r_  generation:  0.007497549057006836
local_output_nid generation:  0.0006191730499267578
local_in_edges_tensor generation:  0.0010771751403808594
mini_batch_src_global generation:  0.0014443397521972656
r_  generation:  0.016788005828857422
local_output_nid generation:  0.0003228187561035156
local_in_edges_tensor generation:  0.0005471706390380859
mini_batch_src_global generation:  0.0008411407470703125
r_  generation:  0.006463527679443359
local_output_nid generation:  0.00022530555725097656
local_in_edges_tensor generation:  0.00044035911560058594
mini_batch_src_global generation:  0.0005695819854736328
r_  generation:  0.005198240280151367
local_output_nid generation:  0.00024390220642089844
local_in_edges_tensor generation:  0.00044608116149902344
mini_batch_src_global generation:  0.0006701946258544922
r_  generation:  0.006970405578613281
local_output_nid generation:  0.0006313323974609375
local_in_edges_tensor generation:  0.0010428428649902344
mini_batch_src_global generation:  0.0013086795806884766
r_  generation:  0.017130374908447266
local_output_nid generation:  0.0005815029144287109
local_in_edges_tensor generation:  0.0013206005096435547
mini_batch_src_global generation:  0.0015358924865722656
r_  generation:  0.015657901763916016
----------------------check_connections_block total spend ----------------------------- 0.21625089645385742
generate_one_block  0.01644134521484375
generate_one_block  0.012140274047851562
generate_one_block  0.020696401596069336
generate_one_block  0.008798599243164062
generate_one_block  0.005990743637084961
generate_one_block  0.020440340042114258
generate_one_block  0.006530284881591797
generate_one_block  0.00826263427734375
generate_one_block  0.011187314987182617
generate_one_block  0.020755290985107422
generate_one_block  0.009811878204345703
generate_one_block  0.008381366729736328
generate_one_block  0.010596752166748047
generate_one_block  0.0217130184173584
generate_one_block  0.021524429321289062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018668174743652344
gen group dst list time:  0.00401759147644043
time for parepare:  0.0016942024230957031
local_output_nid generation:  0.0011298656463623047
local_in_edges_tensor generation:  0.0021555423736572266
mini_batch_src_global generation:  0.001912832260131836
r_  generation:  0.020567893981933594
local_output_nid generation:  0.0006070137023925781
local_in_edges_tensor generation:  0.0013027191162109375
mini_batch_src_global generation:  0.0016832351684570312
r_  generation:  0.013995885848999023
local_output_nid generation:  0.0014183521270751953
local_in_edges_tensor generation:  0.0025823116302490234
mini_batch_src_global generation:  0.0018396377563476562
r_  generation:  0.023332834243774414
local_output_nid generation:  0.0006892681121826172
local_in_edges_tensor generation:  0.0010962486267089844
mini_batch_src_global generation:  0.0014755725860595703
r_  generation:  0.015105009078979492
local_output_nid generation:  0.000644683837890625
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.0011148452758789062
r_  generation:  0.012856245040893555
local_output_nid generation:  0.0015301704406738281
local_in_edges_tensor generation:  0.0020096302032470703
mini_batch_src_global generation:  0.0017442703247070312
r_  generation:  0.023819446563720703
local_output_nid generation:  0.0005376338958740234
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.0012760162353515625
r_  generation:  0.011176347732543945
local_output_nid generation:  0.0007240772247314453
local_in_edges_tensor generation:  0.0010874271392822266
mini_batch_src_global generation:  0.0011494159698486328
r_  generation:  0.015175104141235352
local_output_nid generation:  0.0006759166717529297
local_in_edges_tensor generation:  0.001232147216796875
mini_batch_src_global generation:  0.0014019012451171875
r_  generation:  0.015339136123657227
local_output_nid generation:  0.0011816024780273438
local_in_edges_tensor generation:  0.001967906951904297
mini_batch_src_global generation:  0.002130746841430664
r_  generation:  0.02353954315185547
local_output_nid generation:  0.000850677490234375
local_in_edges_tensor generation:  0.0012671947479248047
mini_batch_src_global generation:  0.0015177726745605469
r_  generation:  0.016644716262817383
local_output_nid generation:  0.0007245540618896484
local_in_edges_tensor generation:  0.0009968280792236328
mini_batch_src_global generation:  0.001163482666015625
r_  generation:  0.01367950439453125
local_output_nid generation:  0.0008563995361328125
local_in_edges_tensor generation:  0.001093149185180664
mini_batch_src_global generation:  0.0013959407806396484
r_  generation:  0.016431093215942383
local_output_nid generation:  0.001333475112915039
local_in_edges_tensor generation:  0.0020873546600341797
mini_batch_src_global generation:  0.0019838809967041016
r_  generation:  0.024187564849853516
local_output_nid generation:  0.0012998580932617188
local_in_edges_tensor generation:  0.0023856163024902344
mini_batch_src_global generation:  0.0021207332611083984
r_  generation:  0.023398399353027344
----------------------check_connections_block total spend ----------------------------- 0.39355897903442383
generate_one_block  0.025552034378051758
generate_one_block  0.019532203674316406
generate_one_block  0.029290437698364258
generate_one_block  0.020872116088867188
generate_one_block  0.017064332962036133
generate_one_block  0.030637502670288086
generate_one_block  0.014736175537109375
generate_one_block  0.01957988739013672
generate_one_block  0.020077943801879883
generate_one_block  0.030075550079345703
generate_one_block  0.021944284439086914
generate_one_block  0.020122766494750977
generate_one_block  0.021425247192382812
generate_one_block  0.030753374099731445
generate_one_block  0.029341459274291992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

connection checking time:  0.699054479598999
block generation total time  0.672447681427002
average batch blocks generation time:  0.0448298454284668
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.03226280212402344  GigaBytes
Max Memory Allocated: 0.03226280212402344  GigaBytes

torch.Size([16348, 500])
torch.Size([11588, 16])
torch.Size([4850, 16])
torch.Size([1147, 16])
torch.Size([152, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.037148475646972656  GigaBytes
Max Memory Allocated: 0.03714942932128906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.024184703826904297  GigaBytes
Max Memory Allocated: 0.054843902587890625  GigaBytes

torch.Size([12550, 500])
torch.Size([6268, 16])
torch.Size([2620, 16])
torch.Size([488, 16])
torch.Size([93, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.026885032653808594  GigaBytes
Max Memory Allocated: 0.054843902587890625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.0364232063293457  GigaBytes
Max Memory Allocated: 0.058750152587890625  GigaBytes

torch.Size([18548, 500])
torch.Size([14154, 16])
torch.Size([8656, 16])
torch.Size([1765, 16])
torch.Size([465, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.0432438850402832  GigaBytes
Max Memory Allocated: 0.058750152587890625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.026439189910888672  GigaBytes
Max Memory Allocated: 0.06106758117675781  GigaBytes

torch.Size([13827, 500])
torch.Size([6591, 16])
torch.Size([1900, 16])
torch.Size([384, 16])
torch.Size([120, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.028934478759765625  GigaBytes
Max Memory Allocated: 0.06106758117675781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.025142192840576172  GigaBytes
Max Memory Allocated: 0.06106758117675781  GigaBytes

torch.Size([13192, 500])
torch.Size([5691, 16])
torch.Size([1547, 16])
torch.Size([253, 16])
torch.Size([76, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.027209758758544922  GigaBytes
Max Memory Allocated: 0.06106758117675781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.035361289978027344  GigaBytes
Max Memory Allocated: 0.06106758117675781  GigaBytes

torch.Size([18316, 500])
torch.Size([14531, 16])
torch.Size([7102, 16])
torch.Size([1596, 16])
torch.Size([188, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.04170989990234375  GigaBytes
Max Memory Allocated: 0.06106758117675781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.02230358123779297  GigaBytes
Max Memory Allocated: 0.06106758117675781  GigaBytes

torch.Size([11688, 500])
torch.Size([5424, 16])
torch.Size([1727, 16])
torch.Size([279, 16])
torch.Size([59, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.024325847625732422  GigaBytes
Max Memory Allocated: 0.06106758117675781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.026909351348876953  GigaBytes
Max Memory Allocated: 0.06106758117675781  GigaBytes

torch.Size([14083, 500])
torch.Size([7068, 16])
torch.Size([2040, 16])
torch.Size([367, 16])
torch.Size([88, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.02951955795288086  GigaBytes
Max Memory Allocated: 0.06106758117675781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.02559947967529297  GigaBytes
Max Memory Allocated: 0.06106758117675781  GigaBytes

torch.Size([13310, 500])
torch.Size([7041, 16])
torch.Size([3142, 16])
torch.Size([656, 16])
torch.Size([112, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.028709888458251953  GigaBytes
Max Memory Allocated: 0.06106758117675781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03490257263183594  GigaBytes
Max Memory Allocated: 0.06106758117675781  GigaBytes

torch.Size([18002, 500])
torch.Size([13987, 16])
torch.Size([7451, 16])
torch.Size([2377, 16])
torch.Size([578, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.04167509078979492  GigaBytes
Max Memory Allocated: 0.06106758117675781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.030004024505615234  GigaBytes
Max Memory Allocated: 0.06293916702270508  GigaBytes

torch.Size([15704, 500])
torch.Size([8183, 16])
torch.Size([3300, 16])
torch.Size([545, 16])
torch.Size([175, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03331279754638672  GigaBytes
Max Memory Allocated: 0.06293916702270508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.025653839111328125  GigaBytes
Max Memory Allocated: 0.06293916702270508  GigaBytes

torch.Size([13430, 500])
torch.Size([7015, 16])
torch.Size([2378, 16])
torch.Size([396, 16])
torch.Size([67, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.028308868408203125  GigaBytes
Max Memory Allocated: 0.06293916702270508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.02713775634765625  GigaBytes
Max Memory Allocated: 0.06293916702270508  GigaBytes

torch.Size([14142, 500])
torch.Size([7574, 16])
torch.Size([2625, 16])
torch.Size([511, 16])
torch.Size([110, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.030164241790771484  GigaBytes
Max Memory Allocated: 0.06293916702270508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03644227981567383  GigaBytes
Max Memory Allocated: 0.06293916702270508  GigaBytes

torch.Size([18500, 500])
torch.Size([14480, 16])
torch.Size([8022, 16])
torch.Size([1858, 16])
torch.Size([385, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.043189048767089844  GigaBytes
Max Memory Allocated: 0.06293916702270508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03493499755859375  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

torch.Size([18102, 500])
torch.Size([13796, 16])
torch.Size([6448, 16])
torch.Size([1470, 16])
torch.Size([205, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.040909767150878906  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010203218460083008 |0.024425538380940755 |0.0590825080871582 |0.00015606880187988282 |0.005031426747639974 |0.0035486221313476562 |
----------------------------------------------------------pseudo_mini_loss sum 2.6218347549438477
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  454263
Number of first layer input nodes during this epoch:  229742
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.037438392639160156  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005159378051757812
random selection method range initialization spend 0.00011849403381347656
time for parepare:  5.412101745605469e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.193450927734375e-05
----------------------check_connections_block total spend ----------------------------- 0.0027899742126464844
generate_one_block  0.0016667842864990234
generate_one_block  0.001119852066040039
generate_one_block  0.0010428428649902344
generate_one_block  0.001088857650756836
generate_one_block  0.0010325908660888672
generate_one_block  0.0010442733764648438
generate_one_block  0.0010454654693603516
generate_one_block  0.0010349750518798828
generate_one_block  0.0010581016540527344
generate_one_block  0.0010616779327392578
generate_one_block  0.0009593963623046875
generate_one_block  0.000949859619140625
generate_one_block  0.0009758472442626953
generate_one_block  0.0009598731994628906
generate_one_block  0.0010178089141845703
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006129741668701172
gen group dst list time:  8.368492126464844e-05
time for parepare:  0.0002830028533935547
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  9.942054748535156e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  7.62939453125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  7.581710815429688e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00020003318786621094
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  5.9604644775390625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.000274658203125
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.343292236328125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00010848045349121094
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0001628398895263672
----------------------check_connections_block total spend ----------------------------- 0.004901885986328125
generate_one_block  0.0022859573364257812
generate_one_block  0.0011260509490966797
generate_one_block  0.0011365413665771484
generate_one_block  0.0012722015380859375
generate_one_block  0.0010895729064941406
generate_one_block  0.0011568069458007812
generate_one_block  0.0010673999786376953
generate_one_block  0.0011334419250488281
generate_one_block  0.0014450550079345703
generate_one_block  0.0009865760803222656
generate_one_block  0.0010139942169189453
generate_one_block  0.0018129348754882812
generate_one_block  0.0010921955108642578
generate_one_block  0.0009906291961669922
generate_one_block  0.0011441707611083984
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011639595031738281
gen group dst list time:  0.00014066696166992188
time for parepare:  0.0008637905120849609
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0002396106719970703
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00033736228942871094
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.0006957054138183594
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0004489421844482422
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  0.0001220703125
r_  generation:  0.001089334487915039
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.0003428459167480469
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0005576610565185547
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0001780986785888672
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0004570484161376953
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.00022149085998535156
r_  generation:  0.0021162033081054688
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.0002613067626953125
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0002853870391845703
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.0003650188446044922
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0008232593536376953
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.00024580955505371094
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  0.000125885009765625
r_  generation:  0.001336812973022461
----------------------check_connections_block total spend ----------------------------- 0.01728963851928711
generate_one_block  0.0015532970428466797
generate_one_block  0.0018057823181152344
generate_one_block  0.0014383792877197266
generate_one_block  0.002209901809692383
generate_one_block  0.001359701156616211
generate_one_block  0.0016350746154785156
generate_one_block  0.0011458396911621094
generate_one_block  0.0015015602111816406
generate_one_block  0.003476858139038086
generate_one_block  0.0012326240539550781
generate_one_block  0.0012602806091308594
generate_one_block  0.0013630390167236328
generate_one_block  0.0019483566284179688
generate_one_block  0.0011935234069824219
generate_one_block  0.002480030059814453
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019390583038330078
gen group dst list time:  0.0003314018249511719
time for parepare:  0.0015981197357177734
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.00039839744567871094
mini_batch_src_global generation:  0.00019788742065429688
r_  generation:  0.0017457008361816406
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.00034880638122558594
mini_batch_src_global generation:  0.0005037784576416016
r_  generation:  0.004575490951538086
local_output_nid generation:  8.416175842285156e-05
local_in_edges_tensor generation:  0.0002715587615966797
mini_batch_src_global generation:  0.00032591819763183594
r_  generation:  0.0025787353515625
local_output_nid generation:  0.00016808509826660156
local_in_edges_tensor generation:  0.0004177093505859375
mini_batch_src_global generation:  0.0005125999450683594
r_  generation:  0.005462646484375
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.00024700164794921875
mini_batch_src_global generation:  0.0003879070281982422
r_  generation:  0.0026273727416992188
local_output_nid generation:  8.320808410644531e-05
local_in_edges_tensor generation:  0.00027179718017578125
mini_batch_src_global generation:  0.0002872943878173828
r_  generation:  0.0026772022247314453
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.00020122528076171875
r_  generation:  0.0013484954833984375
local_output_nid generation:  9.131431579589844e-05
local_in_edges_tensor generation:  0.0002551078796386719
mini_batch_src_global generation:  0.00029754638671875
r_  generation:  0.003380298614501953
local_output_nid generation:  0.0002562999725341797
local_in_edges_tensor generation:  0.0005335807800292969
mini_batch_src_global generation:  0.001964569091796875
r_  generation:  0.008428812026977539
local_output_nid generation:  7.581710815429688e-05
local_in_edges_tensor generation:  0.000255584716796875
mini_batch_src_global generation:  0.0004696846008300781
r_  generation:  0.0021843910217285156
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.00022840499877929688
mini_batch_src_global generation:  0.00022721290588378906
r_  generation:  0.0018987655639648438
local_output_nid generation:  0.00010371208190917969
local_in_edges_tensor generation:  0.00024318695068359375
mini_batch_src_global generation:  0.00021982192993164062
r_  generation:  0.002020597457885742
local_output_nid generation:  0.00020766258239746094
local_in_edges_tensor generation:  0.0003895759582519531
mini_batch_src_global generation:  0.0005576610565185547
r_  generation:  0.004956722259521484
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.00020933151245117188
mini_batch_src_global generation:  0.0002338886260986328
r_  generation:  0.0012695789337158203
local_output_nid generation:  0.00018739700317382812
local_in_edges_tensor generation:  0.00035500526428222656
mini_batch_src_global generation:  0.0004646778106689453
r_  generation:  0.005467891693115234
----------------------check_connections_block total spend ----------------------------- 0.07888007164001465
generate_one_block  0.0055963993072509766
generate_one_block  0.009312629699707031
generate_one_block  0.004415750503540039
generate_one_block  0.008474111557006836
generate_one_block  0.004358768463134766
generate_one_block  0.0045092105865478516
generate_one_block  0.0031807422637939453
generate_one_block  0.005166292190551758
generate_one_block  0.011022806167602539
generate_one_block  0.0035495758056640625
generate_one_block  0.0033159255981445312
generate_one_block  0.0067789554595947266
generate_one_block  0.009158611297607422
generate_one_block  0.0026578903198242188
generate_one_block  0.00844573974609375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.004824638366699219
gen group dst list time:  0.0026750564575195312
time for parepare:  0.0028769969940185547
local_output_nid generation:  0.0003376007080078125
local_in_edges_tensor generation:  0.0012192726135253906
mini_batch_src_global generation:  0.0014069080352783203
r_  generation:  0.007902860641479492
local_output_nid generation:  0.0004611015319824219
local_in_edges_tensor generation:  0.0007469654083251953
mini_batch_src_global generation:  0.0012612342834472656
r_  generation:  0.01056051254272461
local_output_nid generation:  0.000423431396484375
local_in_edges_tensor generation:  0.0007174015045166016
mini_batch_src_global generation:  0.0008969306945800781
r_  generation:  0.01035928726196289
local_output_nid generation:  0.0008342266082763672
local_in_edges_tensor generation:  0.0011744499206542969
mini_batch_src_global generation:  0.0011513233184814453
r_  generation:  0.015050411224365234
local_output_nid generation:  0.00035691261291503906
local_in_edges_tensor generation:  0.0005397796630859375
mini_batch_src_global generation:  0.0008757114410400391
r_  generation:  0.009903907775878906
local_output_nid generation:  0.0005824565887451172
local_in_edges_tensor generation:  0.0007801055908203125
mini_batch_src_global generation:  0.0008540153503417969
r_  generation:  0.00836801528930664
local_output_nid generation:  0.00037670135498046875
local_in_edges_tensor generation:  0.0006129741668701172
mini_batch_src_global generation:  0.0006854534149169922
r_  generation:  0.006659507751464844
local_output_nid generation:  0.0006222724914550781
local_in_edges_tensor generation:  0.0009043216705322266
mini_batch_src_global generation:  0.002176523208618164
r_  generation:  0.01476907730102539
local_output_nid generation:  0.00091552734375
local_in_edges_tensor generation:  0.002164125442504883
mini_batch_src_global generation:  0.0022618770599365234
r_  generation:  0.017347335815429688
local_output_nid generation:  0.0003025531768798828
local_in_edges_tensor generation:  0.0004627704620361328
mini_batch_src_global generation:  0.0008709430694580078
r_  generation:  0.0069925785064697266
local_output_nid generation:  0.00040602684020996094
local_in_edges_tensor generation:  0.0005893707275390625
mini_batch_src_global generation:  0.0008170604705810547
r_  generation:  0.008252620697021484
local_output_nid generation:  0.000377655029296875
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.0007863044738769531
r_  generation:  0.009574413299560547
local_output_nid generation:  0.0007193088531494141
local_in_edges_tensor generation:  0.0011317729949951172
mini_batch_src_global generation:  0.0012090206146240234
r_  generation:  0.013870000839233398
local_output_nid generation:  0.00030732154846191406
local_in_edges_tensor generation:  0.0004372596740722656
mini_batch_src_global generation:  0.0006794929504394531
r_  generation:  0.00525975227355957
local_output_nid generation:  0.0005519390106201172
local_in_edges_tensor generation:  0.0007686614990234375
mini_batch_src_global generation:  0.00099945068359375
r_  generation:  0.012187957763671875
----------------------check_connections_block total spend ----------------------------- 0.23442530632019043
generate_one_block  0.012339353561401367
generate_one_block  0.014104366302490234
generate_one_block  0.014899492263793945
generate_one_block  0.021497488021850586
generate_one_block  0.012633085250854492
generate_one_block  0.011789321899414062
generate_one_block  0.009719371795654297
generate_one_block  0.016074180603027344
generate_one_block  0.02353668212890625
generate_one_block  0.010585784912109375
generate_one_block  0.012192726135253906
generate_one_block  0.010828495025634766
generate_one_block  0.016816139221191406
generate_one_block  0.00730586051940918
generate_one_block  0.016328811645507812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.003931999206542969
gen group dst list time:  0.004237651824951172
time for parepare:  0.0019044876098632812
local_output_nid generation:  0.0008928775787353516
local_in_edges_tensor generation:  0.0023076534271240234
mini_batch_src_global generation:  0.0015804767608642578
r_  generation:  0.017438173294067383
local_output_nid generation:  0.0008692741394042969
local_in_edges_tensor generation:  0.0017535686492919922
mini_batch_src_global generation:  0.002071857452392578
r_  generation:  0.017464160919189453
local_output_nid generation:  0.0011293888092041016
local_in_edges_tensor generation:  0.0017271041870117188
mini_batch_src_global generation:  0.0020651817321777344
r_  generation:  0.020423412322998047
local_output_nid generation:  0.0013628005981445312
local_in_edges_tensor generation:  0.0016543865203857422
mini_batch_src_global generation:  0.001978635787963867
r_  generation:  0.02276611328125
local_output_nid generation:  0.0009534358978271484
local_in_edges_tensor generation:  0.0011439323425292969
mini_batch_src_global generation:  0.0015316009521484375
r_  generation:  0.0170900821685791
local_output_nid generation:  0.0010077953338623047
local_in_edges_tensor generation:  0.001251220703125
mini_batch_src_global generation:  0.0015141963958740234
r_  generation:  0.018088340759277344
local_output_nid generation:  0.00092315673828125
local_in_edges_tensor generation:  0.0012061595916748047
mini_batch_src_global generation:  0.0017113685607910156
r_  generation:  0.018302202224731445
local_output_nid generation:  0.0011756420135498047
local_in_edges_tensor generation:  0.0018651485443115234
mini_batch_src_global generation:  0.0017993450164794922
r_  generation:  0.021681785583496094
local_output_nid generation:  0.0013227462768554688
local_in_edges_tensor generation:  0.0019130706787109375
mini_batch_src_global generation:  0.0021343231201171875
r_  generation:  0.024127960205078125
local_output_nid generation:  0.0007162094116210938
local_in_edges_tensor generation:  0.0009591579437255859
mini_batch_src_global generation:  0.0014758110046386719
r_  generation:  0.014833688735961914
local_output_nid generation:  0.0010008811950683594
local_in_edges_tensor generation:  0.0012788772583007812
mini_batch_src_global generation:  0.001455545425415039
r_  generation:  0.018269777297973633
local_output_nid generation:  0.00083160400390625
local_in_edges_tensor generation:  0.0013806819915771484
mini_batch_src_global generation:  0.0015180110931396484
r_  generation:  0.01798081398010254
local_output_nid generation:  0.001249551773071289
local_in_edges_tensor generation:  0.0017864704132080078
mini_batch_src_global generation:  0.0017156600952148438
r_  generation:  0.02221989631652832
local_output_nid generation:  0.0006399154663085938
local_in_edges_tensor generation:  0.0009505748748779297
mini_batch_src_global generation:  0.0013380050659179688
r_  generation:  0.013371944427490234
local_output_nid generation:  0.0010640621185302734
local_in_edges_tensor generation:  0.0014472007751464844
mini_batch_src_global generation:  0.0014739036560058594
r_  generation:  0.019383907318115234
----------------------check_connections_block total spend ----------------------------- 0.41340160369873047
generate_one_block  0.02242565155029297
generate_one_block  0.025506258010864258
generate_one_block  0.027004718780517578
generate_one_block  0.029353857040405273
generate_one_block  0.02175617218017578
generate_one_block  0.0231473445892334
generate_one_block  0.023831844329833984
generate_one_block  0.02809000015258789
generate_one_block  0.029939889907836914
generate_one_block  0.019701242446899414
generate_one_block  0.023595094680786133
generate_one_block  0.023766040802001953
generate_one_block  0.028461694717407227
generate_one_block  0.01767134666442871
generate_one_block  0.025373458862304688
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.037438392639160156  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

connection checking time:  0.7488985061645508
block generation total time  0.7145769596099854
average batch blocks generation time:  0.047638463973999026
block dataloader generation time/epoch 1.552896499633789
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.029248714447021484  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

torch.Size([15190, 500])
torch.Size([8432, 16])
torch.Size([2667, 16])
torch.Size([568, 16])
torch.Size([129, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.032498836517333984  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.027639389038085938  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

torch.Size([14240, 500])
torch.Size([8935, 16])
torch.Size([4094, 16])
torch.Size([1282, 16])
torch.Size([145, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03170919418334961  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03236818313598633  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

torch.Size([16759, 500])
torch.Size([10795, 16])
torch.Size([3913, 16])
torch.Size([743, 16])
torch.Size([141, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03662443161010742  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03545188903808594  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

torch.Size([18321, 500])
torch.Size([13441, 16])
torch.Size([8169, 16])
torch.Size([1803, 16])
torch.Size([429, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.041919708251953125  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.027222633361816406  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

torch.Size([14078, 500])
torch.Size([7994, 16])
torch.Size([3141, 16])
torch.Size([570, 16])
torch.Size([100, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.030539989471435547  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.030852317810058594  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

torch.Size([16014, 500])
torch.Size([9714, 16])
torch.Size([4261, 16])
torch.Size([921, 16])
torch.Size([208, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.034952640533447266  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.031056880950927734  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

torch.Size([16159, 500])
torch.Size([8664, 16])
torch.Size([3022, 16])
torch.Size([328, 16])
torch.Size([79, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.034361839294433594  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03373003005981445  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

torch.Size([17460, 500])
torch.Size([11640, 16])
torch.Size([5354, 16])
torch.Size([806, 16])
torch.Size([178, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.038646697998046875  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03533935546875  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

torch.Size([18151, 500])
torch.Size([14307, 16])
torch.Size([8156, 16])
torch.Size([2476, 16])
torch.Size([531, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.04238605499267578  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.024812698364257812  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

torch.Size([12835, 500])
torch.Size([6593, 16])
torch.Size([2587, 16])
torch.Size([426, 16])
torch.Size([60, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.027562618255615234  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.02879047393798828  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

torch.Size([14909, 500])
torch.Size([9276, 16])
torch.Size([3223, 16])
torch.Size([518, 16])
torch.Size([112, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.032398223876953125  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.02939319610595703  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

torch.Size([15247, 500])
torch.Size([8395, 16])
torch.Size([3049, 16])
torch.Size([565, 16])
torch.Size([124, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.03276491165161133  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.034252166748046875  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes
Using backend: pytorch

torch.Size([17702, 500])
torch.Size([13055, 16])
torch.Size([6462, 16])
torch.Size([1610, 16])
torch.Size([253, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.04004335403442383  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.026932716369628906  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

torch.Size([14050, 500])
torch.Size([6117, 16])
torch.Size([2399, 16])
torch.Size([348, 16])
torch.Size([100, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.02937936782836914  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.031133174896240234  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

torch.Size([16051, 500])
torch.Size([10213, 16])
torch.Size([5080, 16])
torch.Size([1558, 16])
torch.Size([324, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.035958290100097656  GigaBytes
Max Memory Allocated: 0.0690302848815918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010906600952148437 |0.002106968561808268 |0.007506354649861654 |0.00014031728108723958 |0.005473168690999349 |0.00270843505859375 |
----------------------------------------------------------pseudo_mini_loss sum 2.4863381385803223
Total (block generation + training)time/epoch 1.9729557037353516
Training time/epoch 0.41950273513793945
Training time without block to device /epoch 0.38789820671081543
Training time without total dataloading part /epoch 0.19950604438781738
load block tensor time/epoch 0.16359901428222656
block to device time/epoch 0.03160452842712402
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  468105
Number of first layer input nodes during this epoch:  237166
