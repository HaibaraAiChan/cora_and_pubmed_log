main start at this time 1648533107.4946978
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0008502006530761719
random selection method range initialization spend 0.0002090930938720703
time for parepare:  5.435943603515625e-05
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0016851425170898438
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.459785461425781e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.7206878662109375e-05
----------------------check_connections_block total spend ----------------------------- 0.0029594898223876953
generate_one_block  0.0015244483947753906
generate_one_block  0.001310586929321289
generate_one_block  0.0013315677642822266
generate_one_block  0.0013132095336914062
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006892681121826172
gen group dst list time:  4.076957702636719e-05
time for parepare:  0.0002930164337158203
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0003936290740966797
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00020742416381835938
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0005860328674316406
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004010200500488281
----------------------check_connections_block total spend ----------------------------- 0.0033173561096191406
generate_one_block  0.0018389225006103516
generate_one_block  0.0015583038330078125
generate_one_block  0.002000093460083008
generate_one_block  0.0017635822296142578
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011889934539794922
gen group dst list time:  9.942054748535156e-05
time for parepare:  0.0009446144104003906
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.0003533363342285156
mini_batch_src_global generation:  0.000217437744140625
r_  generation:  0.0025131702423095703
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.0011806488037109375
local_output_nid generation:  9.202957153320312e-05
local_in_edges_tensor generation:  0.0002887248992919922
mini_batch_src_global generation:  0.0003342628479003906
r_  generation:  0.0037393569946289062
local_output_nid generation:  7.891654968261719e-05
local_in_edges_tensor generation:  0.00026154518127441406
mini_batch_src_global generation:  0.0003139972686767578
r_  generation:  0.0023403167724609375
----------------------check_connections_block total spend ----------------------------- 0.01590704917907715
generate_one_block  0.0036983489990234375
generate_one_block  0.0021800994873046875
generate_one_block  0.0046274662017822266
generate_one_block  0.0033936500549316406
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018258094787597656
gen group dst list time:  0.0002911090850830078
time for parepare:  0.0017845630645751953
local_output_nid generation:  0.0003509521484375
local_in_edges_tensor generation:  0.0009272098541259766
mini_batch_src_global generation:  0.0013680458068847656
r_  generation:  0.010141134262084961
local_output_nid generation:  0.0001785755157470703
local_in_edges_tensor generation:  0.0009856224060058594
mini_batch_src_global generation:  0.0008134841918945312
r_  generation:  0.00595402717590332
local_output_nid generation:  0.00027632713317871094
local_in_edges_tensor generation:  0.0006165504455566406
mini_batch_src_global generation:  0.0009500980377197266
r_  generation:  0.010369300842285156
local_output_nid generation:  0.0002758502960205078
local_in_edges_tensor generation:  0.0005927085876464844
mini_batch_src_global generation:  0.0009214878082275391
r_  generation:  0.010267019271850586
----------------------check_connections_block total spend ----------------------------- 0.05566716194152832
generate_one_block  0.014499902725219727
generate_one_block  0.008972883224487305
generate_one_block  0.014688968658447266
generate_one_block  0.014533281326293945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016086101531982422
gen group dst list time:  0.0008139610290527344
time for parepare:  0.0018851757049560547
local_output_nid generation:  0.0010671615600585938
local_in_edges_tensor generation:  0.0017774105072021484
mini_batch_src_global generation:  0.002056121826171875
r_  generation:  0.021271944046020508
local_output_nid generation:  0.0008268356323242188
local_in_edges_tensor generation:  0.0015404224395751953
mini_batch_src_global generation:  0.0020036697387695312
r_  generation:  0.01765275001525879
local_output_nid generation:  0.0010712146759033203
local_in_edges_tensor generation:  0.0014712810516357422
mini_batch_src_global generation:  0.0018317699432373047
r_  generation:  0.020313739776611328
local_output_nid generation:  0.0010788440704345703
local_in_edges_tensor generation:  0.0016961097717285156
mini_batch_src_global generation:  0.0019021034240722656
r_  generation:  0.02139878273010254
----------------------check_connections_block total spend ----------------------------- 0.11928200721740723
generate_one_block  0.026077985763549805
generate_one_block  0.023904085159301758
generate_one_block  0.026067733764648438
generate_one_block  0.028897762298583984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017511844635009766
gen group dst list time:  0.0015113353729248047
time for parepare:  0.0017304420471191406
local_output_nid generation:  0.0015175342559814453
local_in_edges_tensor generation:  0.002523183822631836
mini_batch_src_global generation:  0.002185821533203125
r_  generation:  0.025476932525634766
local_output_nid generation:  0.0015437602996826172
local_in_edges_tensor generation:  0.0024487972259521484
mini_batch_src_global generation:  0.002637624740600586
r_  generation:  0.026919841766357422
local_output_nid generation:  0.0015780925750732422
local_in_edges_tensor generation:  0.002271413803100586
mini_batch_src_global generation:  0.002686023712158203
r_  generation:  0.025806903839111328
local_output_nid generation:  0.001505136489868164
local_in_edges_tensor generation:  0.0026695728302001953
mini_batch_src_global generation:  0.002082347869873047
r_  generation:  0.025916099548339844
----------------------check_connections_block total spend ----------------------------- 0.1542677879333496
generate_one_block  0.02960205078125
generate_one_block  0.03168368339538574
generate_one_block  0.031057357788085938
generate_one_block  0.03149843215942383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

connection checking time:  0.34844136238098145
block generation total time  0.30254459381103516
average batch blocks generation time:  0.07563614845275879
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.036910057067871094  GigaBytes
Max Memory Allocated: 0.036910057067871094  GigaBytes

torch.Size([19014, 500])
torch.Size([16508, 16])
torch.Size([11753, 16])
torch.Size([3155, 16])
torch.Size([810, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.04648399353027344  GigaBytes
Max Memory Allocated: 0.04650163650512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.03647470474243164  GigaBytes
Max Memory Allocated: 0.07072925567626953  GigaBytes

torch.Size([18722, 500])
torch.Size([15538, 16])
torch.Size([8155, 16])
torch.Size([2025, 16])
torch.Size([357, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.04354095458984375  GigaBytes
Max Memory Allocated: 0.07072925567626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.036609649658203125  GigaBytes
Max Memory Allocated: 0.07072925567626953  GigaBytes

torch.Size([18811, 500])
torch.Size([16036, 16])
torch.Size([10636, 16])
torch.Size([3569, 16])
torch.Size([931, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.04524564743041992  GigaBytes
Max Memory Allocated: 0.07072925567626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.03710126876831055  GigaBytes
Max Memory Allocated: 0.07073640823364258  GigaBytes

torch.Size([19081, 500])
torch.Size([16787, 16])
torch.Size([11284, 16])
torch.Size([3487, 16])
torch.Size([742, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.046534061431884766  GigaBytes
Max Memory Allocated: 0.07073640823364258  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0194588303565979 |0.08810144662857056 |0.1967335343360901 |0.00018596649169921875 |0.008341729640960693 |0.004050016403198242 |
----------------------------------------------------------pseudo_mini_loss sum 2.3272132873535156
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  197758
Number of first layer input nodes during this epoch:  75628
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.04037141799926758  GigaBytes
Max Memory Allocated: 0.07073640823364258  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005013942718505859
random selection method range initialization spend 0.00011801719665527344
time for parepare:  5.054473876953125e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.482269287109375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.361701965332031e-05
----------------------check_connections_block total spend ----------------------------- 0.0010111331939697266
generate_one_block  0.0012392997741699219
generate_one_block  0.0010495185852050781
generate_one_block  0.0011670589447021484
generate_one_block  0.0010404586791992188
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005426406860351562
gen group dst list time:  3.4809112548828125e-05
time for parepare:  0.00027251243591308594
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0003387928009033203
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0002601146697998047
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003705024719238281
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0003333091735839844
----------------------check_connections_block total spend ----------------------------- 0.0028133392333984375
generate_one_block  0.0014624595642089844
generate_one_block  0.0013375282287597656
generate_one_block  0.0014760494232177734
generate_one_block  0.0014865398406982422
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010073184967041016
gen group dst list time:  8.106231689453125e-05
time for parepare:  0.0007600784301757812
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.0003223419189453125
mini_batch_src_global generation:  0.00021719932556152344
r_  generation:  0.0021033287048339844
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  0.0002002716064453125
r_  generation:  0.0015387535095214844
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  0.000240325927734375
r_  generation:  0.0024940967559814453
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  0.00027561187744140625
r_  generation:  0.0026285648345947266
----------------------check_connections_block total spend ----------------------------- 0.013983964920043945
generate_one_block  0.004306793212890625
generate_one_block  0.0027396678924560547
generate_one_block  0.0038268566131591797
generate_one_block  0.004158973693847656
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020155906677246094
gen group dst list time:  0.0002429485321044922
time for parepare:  0.0014026165008544922
local_output_nid generation:  0.00028514862060546875
local_in_edges_tensor generation:  0.0009300708770751953
mini_batch_src_global generation:  0.0007874965667724609
r_  generation:  0.010749578475952148
local_output_nid generation:  0.0002410411834716797
local_in_edges_tensor generation:  0.0004973411560058594
mini_batch_src_global generation:  0.0009157657623291016
r_  generation:  0.0076177120208740234
local_output_nid generation:  0.00025343894958496094
local_in_edges_tensor generation:  0.0005056858062744141
mini_batch_src_global generation:  0.0008800029754638672
r_  generation: Using backend: pytorch
 0.008558988571166992
local_output_nid generation:  0.0002830028533935547
local_in_edges_tensor generation:  0.00057220458984375
mini_batch_src_global generation:  0.001058340072631836
r_  generation:  0.011217355728149414
----------------------check_connections_block total spend ----------------------------- 0.05638909339904785
generate_one_block  0.0159759521484375
generate_one_block  0.012163639068603516
generate_one_block  0.013117313385009766
generate_one_block  0.01453256607055664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001993894577026367
gen group dst list time:  0.0008294582366943359
time for parepare:  0.0016660690307617188
local_output_nid generation:  0.0010547637939453125
local_in_edges_tensor generation:  0.0022208690643310547
mini_batch_src_global generation:  0.001859426498413086
r_  generation:  0.021830320358276367
local_output_nid generation:  0.0009150505065917969
local_in_edges_tensor generation:  0.0014374256134033203
mini_batch_src_global generation:  0.002116680145263672
r_  generation:  0.01962590217590332
local_output_nid generation:  0.0010008811950683594
local_in_edges_tensor generation:  0.0013937950134277344
mini_batch_src_global generation:  0.0016717910766601562
r_  generation:  0.019533395767211914
local_output_nid generation:  0.0010902881622314453
local_in_edges_tensor generation:  0.001486063003540039
mini_batch_src_global generation:  0.0019860267639160156
r_  generation:  0.020985126495361328
----------------------check_connections_block total spend ----------------------------- 0.12063288688659668
generate_one_block  0.026810884475708008
generate_one_block  0.026328325271606445
generate_one_block  0.02511739730834961
generate_one_block  0.02875995635986328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002111196517944336
gen group dst list time:  0.0013797283172607422
time for parepare:  0.0016636848449707031
local_output_nid generation:  0.0015473365783691406
local_in_edges_tensor generation:  0.0029144287109375
mini_batch_src_global generation:  0.0020630359649658203
r_  generation:  0.025728702545166016
local_output_nid generation:  0.0015189647674560547
local_in_edges_tensor generation:  0.002824068069458008
mini_batch_src_global generation:  0.002694845199584961
r_  generation:  0.0255434513092041
local_output_nid generation:  0.0016531944274902344
local_in_edges_tensor generation:  0.002500772476196289
mini_batch_src_global generation:  0.0020728111267089844
r_  generation:  0.025496244430541992
local_output_nid generation:  0.0016560554504394531
local_in_edges_tensor generation:  0.0022139549255371094
mini_batch_src_global generation:  0.0023288726806640625
r_  generation:  0.025646448135375977
----------------------check_connections_block total spend ----------------------------- 0.15202832221984863
generate_one_block  0.029920101165771484
generate_one_block  0.0321810245513916
generate_one_block  0.031047582626342773
generate_one_block  0.03101181983947754
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.04037141799926758  GigaBytes
Max Memory Allocated: 0.07073640823364258  GigaBytes

connection checking time:  0.34584760665893555
block generation total time  0.30776143074035645
average batch blocks generation time:  0.07694035768508911
block dataloader generation time/epoch 0.7053916454315186
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.03735971450805664  GigaBytes
Max Memory Allocated: 0.07146167755126953  GigaBytes

torch.Size([19122, 500])
torch.Size([16859, 16])
torch.Size([11906, 16])
torch.Size([3575, 16])
torch.Size([735, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.04694509506225586  GigaBytes
Max Memory Allocated: 0.07146167755126953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.036753177642822266  GigaBytes
Max Memory Allocated: 0.07146167755126953  GigaBytes

torch.Size([18838, 500])
torch.Size([16032, 16])
torch.Size([10211, 16])
torch.Size([2580, 16])
torch.Size([626, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.04480314254760742  GigaBytes
Max Memory Allocated: 0.07146167755126953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.036386966705322266  GigaBytes
Max Memory Allocated: 0.07146167755126953  GigaBytes

torch.Size([18646, 500])
torch.Size([15884, 16])
torch.Size([9692, 16])
torch.Size([3108, 16])
torch.Size([722, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.044504642486572266  GigaBytes
Max Memory Allocated: 0.07146167755126953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.03698253631591797  GigaBytes
Max Memory Allocated: 0.07146167755126953  GigaBytes

torch.Size([18916, 500])
torch.Size([16517, 16])
torch.Size([11319, 16])
torch.Size([3693, 16])
torch.Size([780, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.046793460845947266  GigaBytes
Max Memory Allocated: 0.07146167755126953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015706419944763184 |0.002143681049346924 |0.007421731948852539 |0.00014340877532958984 |0.006826281547546387 |0.006160259246826172 |
----------------------------------------------------------pseudo_mini_loss sum 2.716872215270996
Total (block generation + training)time/epoch 0.8482732772827148
Training time/epoch 0.1422562599182129
Training time without block to device /epoch 0.1336815357208252
Training time without total dataloading part /epoch 0.06372594833374023
load block tensor time/epoch 0.06282567977905273
block to device time/epoch 0.008574724197387695
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  200117
Number of first layer input nodes during this epoch:  75522
