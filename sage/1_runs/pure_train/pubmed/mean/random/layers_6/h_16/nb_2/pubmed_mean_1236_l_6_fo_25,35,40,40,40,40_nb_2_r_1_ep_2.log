main start at this time 1648533085.7972574
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0013728141784667969
random selection method range initialization spend 0.0001995563507080078
time for parepare:  4.506111145019531e-05
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0015261173248291016
----------------------check_connections_block total spend ----------------------------- 0.0020160675048828125
generate_one_block  0.0015208721160888672
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009024143218994141
gen group dst list time:  2.0503997802734375e-05
time for parepare:  0.00024199485778808594
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0002276897430419922
mini_batch_src_global generation:  0.00013589859008789062
r_  generation:  0.0012078285217285156
----------------------check_connections_block total spend ----------------------------- 0.002198934555053711
generate_one_block  0.002828836441040039
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010318756103515625
gen group dst list time:  5.435943603515625e-05
time for parepare:  0.0007297992706298828
local_output_nid generation:  0.0002143383026123047
local_in_edges_tensor generation:  0.0005397796630859375
mini_batch_src_global generation:  0.0005917549133300781
r_  generation:  0.0070073604583740234
----------------------check_connections_block total spend ----------------------------- 0.011224985122680664
generate_one_block  0.010670185089111328
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018603801727294922
gen group dst list time:  0.00015044212341308594
time for parepare:  0.0014088153839111328
local_output_nid generation:  0.0005793571472167969
local_in_edges_tensor generation:  0.0013501644134521484
mini_batch_src_global generation:  0.0018084049224853516
r_  generation:  0.018447399139404297
----------------------check_connections_block total spend ----------------------------- 0.028905391693115234
generate_one_block  0.0239713191986084
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019252300262451172
gen group dst list time:  0.0003070831298828125
time for parepare:  0.0015435218811035156
local_output_nid generation:  0.0011620521545410156
local_in_edges_tensor generation:  0.0025768280029296875
mini_batch_src_global generation:  0.0025031566619873047
r_  generation:  0.026114225387573242
----------------------check_connections_block total spend ----------------------------- 0.040691375732421875
generate_one_block  0.03148007392883301
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0019068717956542969
gen group dst list time:  0.0003886222839355469
time for parepare:  0.0015735626220703125
local_output_nid generation:  0.0013751983642578125
local_in_edges_tensor generation:  0.002676248550415039
mini_batch_src_global generation:  0.002190828323364258
r_  generation:  0.02704024314880371
----------------------check_connections_block total spend ----------------------------- 0.04184579849243164
generate_one_block  0.03218865394592285
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.058547973632812e-05  GigaBytes
Max Memory Allocated: 8.058547973632812e-05  GigaBytes

connection checking time:  0.12486648559570312
block generation total time  0.10113906860351562
average batch blocks generation time:  0.10113906860351562
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.039058685302734375  GigaBytes
Max Memory Allocated: 0.039058685302734375  GigaBytes

torch.Size([19490, 500])
torch.Size([18734, 16])
torch.Size([16309, 16])
torch.Size([8123, 16])
torch.Size([2579, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.05189323425292969  GigaBytes
Max Memory Allocated: 0.05191755294799805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01445150375366211 |0.34137845039367676 |0.7680718898773193 |0.00027871131896972656 |0.012844085693359375 |0.00834202766418457 |
----------------------------------------------------------pseudo_mini_loss sum 1.6626836061477661
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  65589
Number of first layer input nodes during this epoch:  19490
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.043436527252197266  GigaBytes
Max Memory Allocated: 0.05235767364501953  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005178451538085938
random selection method range initialization spend 0.00011086463928222656
time for parepare:  4.982948303222656e-05
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00011396408081054688
----------------------check_connections_block total spend ----------------------------- 0.0005037784576416016
generate_one_block  0.001478433609008789
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005588531494140625
gen group dst list time:  2.0265579223632812e-05
time for parepare:  0.00026726722717285156
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.0011932849884033203
----------------------check_connections_block total spend ----------------------------- 0.0021839141845703125
generate_one_block  0.0027403831481933594
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010113716125488281
gen group dst list time:  5.841255187988281e-05
time for parepare:  0.0007312297821044922
local_output_nid generation:  0.00018835067749023438
local_in_edges_tensor generation:  0.0005564689636230469
mini_batch_src_global generation:  0.0006697177886962891
r_  generation:  0.007180929183959961
----------------------check_connections_block total spend ----------------------------- 0.011321544647216797
generate_one_block  0.009773731231689453
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001764535903930664
gen group dst list time:  0.00015115737915039062
time for parepare:  0.001344919204711914
local_output_nid generation:  0.0005753040313720703
local_in_edges_tensor generation:  0.001287698745727539
mini_batch_src_global generation:  0.0015721321105957031
r_  generation:  0.01881122589111328
----------------------check_connections_block total spend ----------------------------- 0.02889537811279297
generate_one_block  0.023409605026245117
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001893758773803711
gen group dst list time:  0.00032067298889160156
time for parepare:  0.0014982223510742188
local_output_nid generation:  0.0011754035949707031
local_in_edges_tensor generation:  0.002553701400756836
mini_batch_src_global generation:  0.002194643020629883Using backend: pytorch

r_  generation:  0.025980234146118164
----------------------check_connections_block total spend ----------------------------- 0.04036235809326172
generate_one_block  0.031131744384765625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020079612731933594
gen group dst list time:  0.00042700767517089844
time for parepare:  0.0015537738800048828
local_output_nid generation:  0.0013537406921386719
local_in_edges_tensor generation:  0.002669095993041992
mini_batch_src_global generation:  0.0019931793212890625
r_  generation:  0.027099132537841797
----------------------check_connections_block total spend ----------------------------- 0.04165792465209961
generate_one_block  0.0316314697265625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.043436527252197266  GigaBytes
Max Memory Allocated: 0.05235767364501953  GigaBytes

connection checking time:  0.1244211196899414
block generation total time  0.09868693351745605
average batch blocks generation time:  0.09868693351745605
block dataloader generation time/epoch 0.26541566848754883
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.039277076721191406  GigaBytes
Max Memory Allocated: 0.07452154159545898  GigaBytes

torch.Size([19513, 500])
torch.Size([18703, 16])
torch.Size([16282, 16])
torch.Size([8097, 16])
torch.Size([2581, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.0520930290222168  GigaBytes
Max Memory Allocated: 0.07452154159545898  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014498710632324219 |0.0020444393157958984 |0.007035493850708008 |0.00014710426330566406 |0.004224300384521484 |0.0053920745849609375 |
----------------------------------------------------------pseudo_mini_loss sum 1.9305256605148315
Total (block generation + training)time/epoch 0.3010883331298828
Training time/epoch 0.03526139259338379
Training time without block to device /epoch 0.03321695327758789
Training time without total dataloading part /epoch 0.016798973083496094
load block tensor time/epoch 0.014498710632324219
block to device time/epoch 0.0020444393157958984
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.1920928955078125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  65530
Number of first layer input nodes during this epoch:  19513
