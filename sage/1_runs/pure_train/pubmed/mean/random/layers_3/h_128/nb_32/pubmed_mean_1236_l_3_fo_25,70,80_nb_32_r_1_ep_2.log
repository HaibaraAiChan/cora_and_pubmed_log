main start at this time 1648526603.4515824
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007531642913818359
random selection method range initialization spend 0.0001938343048095703
time for parepare:  5.7697296142578125e-05
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0013756752014160156
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.6226043701171875e-05
----------------------check_connections_block total spend ----------------------------- 0.004631757736206055
generate_one_block  0.001428842544555664
generate_one_block  0.0012340545654296875
generate_one_block  0.001249551773071289
generate_one_block  0.0012319087982177734
generate_one_block  0.0012311935424804688
generate_one_block  0.0012443065643310547
generate_one_block  0.0012502670288085938
generate_one_block  0.0010638236999511719
generate_one_block  0.0011031627655029297
generate_one_block  0.0010437965393066406
generate_one_block  0.0010378360748291016
generate_one_block  0.001031637191772461
generate_one_block  0.0010180473327636719
generate_one_block  0.0009665489196777344
generate_one_block  0.0009706020355224609
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005998611450195312
gen group dst list time:  0.0001068115234375
time for parepare:  0.0002994537353515625
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00021457672119140625
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  9.751319885253906e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  0.00010585784912109375
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00013518333435058594
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.771087646484375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.128715515136719e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00020647048950195312
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001342296600341797
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00011014938354492188
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.224082946777344e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0002124309539794922
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00019669532775878906
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00022649765014648438
----------------------check_connections_block total spend ----------------------------- 0.0056116580963134766
generate_one_block  0.001383066177368164
generate_one_block  0.0012695789337158203
generate_one_block  0.001341104507446289
generate_one_block  0.00141143798828125
generate_one_block  0.0012967586517333984
generate_one_block  0.0012946128845214844
generate_one_block  0.0011103153228759766
generate_one_block  0.0012748241424560547
generate_one_block  0.001096963882446289
generate_one_block  0.0010554790496826172
generate_one_block  0.0011303424835205078
generate_one_block  0.0012235641479492188
generate_one_block  0.0011763572692871094
generate_one_block  0.0012385845184326172
generate_one_block  0.0011887550354003906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009918212890625
gen group dst list time:  0.00016427040100097656
time for parepare:  0.0009200572967529297
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00025177001953125
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0003790855407714844
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0001678466796875
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00036835670471191406
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0007226467132568359
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00032448768615722656
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0004291534423828125
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00021004676818847656
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00023746490478515625
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0012018680572509766
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.00016188621520996094
r_  generation:  0.0011796951293945312
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  9.489059448242188e-05
r_  generation:  0.0006196498870849609
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.00048041343688964844
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0003917217254638672
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  0.00015306472778320312
r_  generation:  0.001474618911743164
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  0.00014543533325195312
r_  generation:  0.0012204647064208984
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.00013303756713867188
r_  generation:  0.0011997222900390625
----------------------check_connections_block total spend ----------------------------- 0.018772363662719727
generate_one_block  0.0013387203216552734
generate_one_block  0.0011832714080810547
generate_one_block  0.001302957534790039
generate_one_block  0.0016682147979736328
generate_one_block  0.0013759136199951172
generate_one_block  0.0011365413665771484
generate_one_block  0.0012230873107910156
generate_one_block  0.0021011829376220703
generate_one_block  0.0022706985473632812
generate_one_block  0.0015053749084472656
generate_one_block  0.0013895034790039062
generate_one_block  0.0013060569763183594
generate_one_block  0.002408742904663086
generate_one_block  0.0031468868255615234
generate_one_block  0.0026683807373046875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

connection checking time:  0.024384021759033203
block generation total time  0.04451727867126465
average batch blocks generation time:  0.0029678185780843097
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0014243125915527344  GigaBytes
Max Memory Allocated: 0.0014243125915527344  GigaBytes

torch.Size([433, 500])
torch.Size([138, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.0016903877258300781  GigaBytes
Max Memory Allocated: 0.0018377304077148438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2440185546875 GB
    Memory Allocated: 0.0016698837280273438  GigaBytes
Max Memory Allocated: 0.002472400665283203  GigaBytes

torch.Size([243, 500])
torch.Size([61, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2440185546875 GB
    Memory Allocated: 0.0017933845520019531  GigaBytes
Max Memory Allocated: 0.002472400665283203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.0021944046020507812  GigaBytes
Max Memory Allocated: 0.0026383399963378906  GigaBytes

torch.Size([522, 500])
torch.Size([134, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.002495288848876953  GigaBytes
Max Memory Allocated: 0.002643585205078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0029087066650390625  GigaBytes
Max Memory Allocated: 0.003863811492919922  GigaBytes

torch.Size([901, 500])
torch.Size([238, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.003348827362060547  GigaBytes
Max Memory Allocated: 0.003863811492919922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0026960372924804688  GigaBytes
Max Memory Allocated: 0.004364490509033203  GigaBytes

torch.Size([791, 500])
torch.Size([97, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0028929710388183594  GigaBytes
Max Memory Allocated: 0.004364490509033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0017414093017578125  GigaBytes
Max Memory Allocated: 0.004364490509033203  GigaBytes

torch.Size([281, 500])
torch.Size([87, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0019402503967285156  GigaBytes
Max Memory Allocated: 0.004364490509033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00186920166015625  GigaBytes
Max Memory Allocated: 0.004364490509033203  GigaBytes

torch.Size([349, 500])
torch.Size([96, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0020503997802734375  GigaBytes
Max Memory Allocated: 0.004364490509033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004401683807373047  GigaBytes
Max Memory Allocated: 0.005023956298828125  GigaBytes

torch.Size([1697, 500])
torch.Size([394, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00513458251953125  GigaBytes
Max Memory Allocated: 0.005802154541015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005095005035400391  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

torch.Size([2069, 500])
torch.Size([285, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005617618560791016  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0028433799743652344  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

torch.Size([868, 500])
torch.Size([167, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0031633377075195312  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0025119781494140625  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

torch.Size([691, 500])
torch.Size([134, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0027608871459960938  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0028395652770996094  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

torch.Size([607, 500])
torch.Size([103, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003055572509765625  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003818988800048828  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

torch.Size([1379, 500])
torch.Size([348, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004454612731933594  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003939151763916016  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

torch.Size([1445, 500])
torch.Size([334, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004570484161376953  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005431175231933594  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

torch.Size([2047, 500])
torch.Size([482, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006309032440185547  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0007456938425699869 |0.023453760147094726 |0.0544711430867513 |0.00014875729878743488 |0.002258857091267904 |0.002336740493774414 |
----------------------------------------------------------pseudo_mini_loss sum 2.207552909851074
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17778
Number of first layer input nodes during this epoch:  14323
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006717681884765625  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005786418914794922
random selection method range initialization spend 0.0001423358917236328
time for parepare:  5.984306335449219e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.193450927734375e-05
----------------------check_connections_block total spend ----------------------------- 0.003228425979614258
generate_one_block  0.001337289810180664
generate_one_block  0.0012364387512207031
generate_one_block  0.0012311935424804688
generate_one_block  0.0012273788452148438
generate_one_block  0.0012428760528564453
generate_one_block  0.0015673637390136719
generate_one_block  0.0012428760528564453
generate_one_block  0.0011785030364990234
generate_one_block  0.0010263919830322266
generate_one_block  0.0009520053863525391
generate_one_block  0.0009572505950927734
generate_one_block  0.0009701251983642578
generate_one_block  0.000946044921875
generate_one_block  0.000957489013671875
generate_one_block  0.0009598731994628906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006768703460693359
gen group dst list time:  0.00011801719665527344
time for parepare:  0.0003612041473388672
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  9.608268737792969e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  7.2479248046875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010895729064941406
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.00025343894958496094
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00012230873107910156
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0002467632293701172
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  7.82012939453125e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0002186298370361328
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  7.367134094238281e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00012302398681640625
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00021195411682128906
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.699562072753906e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.462501525878906e-05
----------------------check_connections_block total spend ----------------------------- 0.005707740783691406
generate_one_block  0.0013473033905029297
generate_one_block  0.0013053417205810547
generate_one_block  0.00133514404296875
generate_one_block  0.0013606548309326172
generate_one_block  0.0015439987182617188
generate_one_block  0.0013120174407958984
generate_one_block  0.001332998275756836
generate_one_block  0.001093149185180664
generate_one_block  0.0012514591217041016
generate_one_block  0.0010442733764648438
generate_one_block  0.0010676383972167969
generate_one_block  0.0011661052703857422
generate_one_block  0.0009951591491699219
generate_one_block  0.0010101795196533203
generate_one_block  0.001007080078125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011608600616455078
gen group dst list time:  0.0001704692840576172
time for parepare:  0.000995635986328125
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0003006458282470703
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0004642009735107422
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00029397010803222656
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00015544891357421875
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0005927085876464844
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.0002315044403076172
r_  generation:  0.0016701221466064453
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0005357265472412109
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.001949310302734375
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0003590583801269531
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.0013582706451416016
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0003783702850341797
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0005638599395751953
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  0.0011589527130126953
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.00021195411682128906
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00019288063049316406
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.00036716461181640625
----------------------check_connections_block total spend ----------------------------- 0.018970251083374023
generate_one_block  0.0016794204711914062
generate_one_block  0.0012826919555664062
generate_one_block  0.0010950565338134766
generate_one_block  0.0015099048614501953
generate_one_block  0.0025877952575683594
generate_one_block  0.0014743804931640625
generate_one_block  0.003045320510864258
generate_one_block  0.0012557506561279297
generate_one_block  0.002297639846801758
generate_one_block  0.0012974739074707031
generate_one_block  0.0015301704406738281
generate_one_block  0.0032172203063964844
generate_one_block  0.0011713504791259766
generate_one_block  0.001226186752319336
generate_one_block  0.0013735294342041016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006717681884765625  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

connection checking time:  0.02467799186706543
block generation total time  0.04421639442443848
average batch blocks generation time:  0.0029477596282958983
block dataloader generation time/epoch 0.10764479637145996
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0038328170776367188  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

torch.Size([753, 500])
torch.Size([153, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004124641418457031  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0031185150146484375  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

torch.Size([371, 500])
torch.Size([115, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003330230712890625  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0028753280639648438  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

torch.Size([242, 500])
torch.Size([47, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0029807090759277344  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004004001617431641  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

torch.Size([843, 500])
torch.Size([209, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0043792724609375  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005826473236083984  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

torch.Size([1807, 500])
torch.Size([419, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0066165924072265625  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004003047943115234  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

torch.Size([827, 500])
torch.Size([150, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004342555999755859  GigaBytes
Max Memory Allocated: 0.008227825164794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007034778594970703  GigaBytes
Max Memory Allocated: 0.008555889129638672  GigaBytes

torch.Size([2451, 500])
torch.Size([420, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007814407348632812  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0032057762145996094  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

torch.Size([417, 500])
torch.Size([104, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.003418445587158203  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006270408630371094  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

torch.Size([2050, 500])
torch.Size([392, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0070037841796875  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.003262042999267578  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

torch.Size([447, 500])
torch.Size([126, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0034990310668945312  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0038814544677734375  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

torch.Size([776, 500])
torch.Size([212, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.004275321960449219  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006062030792236328  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

torch.Size([1938, 500])
torch.Size([471, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00688934326171875  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0029768943786621094  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

torch.Size([296, 500])
torch.Size([91, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0031533241271972656  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.003055095672607422  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

torch.Size([338, 500])
torch.Size([86, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0032444000244140625  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0039463043212890625  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes
Using backend: pytorch

torch.Size([814, 500])
torch.Size([98, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.004162788391113281  GigaBytes
Max Memory Allocated: 0.009252548217773438  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0007390022277832031 |0.0005153814951578776 |0.003636296590169271 |0.000130462646484375 |0.0019332249959309897 |0.001508474349975586 |
----------------------------------------------------------pseudo_mini_loss sum 0.9264762997627258
Total (block generation + training)time/epoch 0.234452486038208
Training time/epoch 0.1263120174407959
Training time without block to device /epoch 0.11858129501342773
Training time without total dataloading part /epoch 0.08700823783874512
load block tensor time/epoch 0.011085033416748047
block to device time/epoch 0.007730722427368164
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17820
Number of first layer input nodes during this epoch:  14370
