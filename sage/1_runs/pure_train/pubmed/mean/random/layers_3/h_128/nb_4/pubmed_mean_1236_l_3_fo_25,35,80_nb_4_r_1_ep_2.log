main start at this time 1648526523.3257353
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012874603271484375
random selection method range initialization spend 0.0001914501190185547
time for parepare:  5.4836273193359375e-05
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0013878345489501953
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  8.535385131835938e-05
----------------------check_connections_block total spend ----------------------------- 0.0021691322326660156
generate_one_block  0.0017240047454833984
generate_one_block  0.0014307498931884766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008213520050048828
gen group dst list time:  3.0040740966796875e-05
time for parepare:  0.0002799034118652344
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0002257823944091797
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.00046634674072265625
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  0.00013685226440429688
r_  generation:  0.0009887218475341797
----------------------check_connections_block total spend ----------------------------- 0.0028150081634521484
generate_one_block  0.0020215511322021484
generate_one_block  0.002655506134033203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011687278747558594
gen group dst list time:  7.843971252441406e-05
time for parepare:  0.0009069442749023438
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.0003590583801269531
mini_batch_src_global generation:  0.00019979476928710938
r_  generation:  0.0022568702697753906
local_output_nid generation:  0.00017452239990234375
local_in_edges_tensor generation:  0.0004203319549560547
mini_batch_src_global generation:  0.00058746337890625
r_  generation:  0.006040096282958984
----------------------check_connections_block total spend ----------------------------- 0.013477802276611328
generate_one_block  0.003755331039428711
generate_one_block  0.00692439079284668
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

connection checking time:  0.016292810440063477
block generation total time  0.015356779098510742
average batch blocks generation time:  0.007678389549255371
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0064868927001953125  GigaBytes
Max Memory Allocated: 0.0064868927001953125  GigaBytes

torch.Size([3128, 500])
torch.Size([846, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008152008056640625  GigaBytes
Max Memory Allocated: 0.00923919677734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012911319732666016  GigaBytes
Max Memory Allocated: 0.018593311309814453  GigaBytes

torch.Size([6203, 500])
torch.Size([1820, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.016330242156982422  GigaBytes
Max Memory Allocated: 0.018610000610351562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003036022186279297 |0.17210936546325684 |0.38420605659484863 |0.00020396709442138672 |0.005695462226867676 |0.0027496814727783203 |
----------------------------------------------------------pseudo_mini_loss sum 1.9400570392608643
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12353
Number of first layer input nodes during this epoch:  9331
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014448165893554688  GigaBytes
Max Memory Allocated: 0.018610000610351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006961822509765625
random selection method range initialization spend 0.00015878677368164062
time for parepare:  6.461143493652344e-05
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002541542053222656
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  9.679794311523438e-05
----------------------check_connections_block total spend ----------------------------- 0.0009791851043701172
generate_one_block  0.0015876293182373047
generate_one_block  0.0011093616485595703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005316734313964844
gen group dst list time:  2.5510787963867188e-05
time for parepare:  0.00029397010803222656
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  9.107589721679688e-05
r_  generation:  0.0006585121154785156
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0005774497985839844
----------------------check_connections_block total spend ----------------------------- 0.0024750232696533203
generate_one_block  0.0018613338470458984
generate_one_block  0.0017485618591308594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009281635284423828
gen group dst list time:  6.866455078125e-05
time for parepare:  0.0007419586181640625
local_output_nid generation:  0.00010704994201660156
local_in_edges_tensor generation:  0.00041103363037109375
mini_batch_src_global generation:  0.000354766845703125
r_  generation:  0.0037369728088378906
local_output_nid generation:  0.00010609626770019531
local_in_edges_tensor generation:  0.00028014183044433594
mini_batch_src_global generation:  0.0004172325134277344
r_  generation:  0.003113269805908203
----------------------check_connections_block total spend ----------------------------- 0.01134943962097168
generate_one_block  0.006220340728759766
generate_one_block  0.00498652458190918
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014448165893554688  GigaBytes
Max Memory Allocated: 0.018610000610351562  GigaBytes

connection checking time:  0.013824462890625
block generation total time  0.014816761016845703
average batch blocks generation time:  0.0074083805084228516
block dataloader generation time/epoch 0.044510602951049805
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011948585510253906  GigaBytes
Max Memory Allocated: 0.023390769958496094  GigaBytes
Using backend: pytorch

torch.Size([5056, 500])
torch.Size([1371, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014568805694580078  GigaBytes
Max Memory Allocated: 0.023390769958496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011540412902832031  GigaBytes
Max Memory Allocated: 0.023390769958496094  GigaBytes

torch.Size([4847, 500])
torch.Size([1336, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014073848724365234  GigaBytes
Max Memory Allocated: 0.023390769958496094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0021522045135498047 |0.0004221200942993164 |0.003162860870361328 |0.00012791156768798828 |0.0032552480697631836 |0.0015027523040771484 |
----------------------------------------------------------pseudo_mini_loss sum 0.9493566751480103
Total (block generation + training)time/epoch 0.0668940544128418
Training time/epoch 0.022222042083740234
Training time without block to device /epoch 0.0213778018951416
Training time without total dataloading part /epoch 0.014594793319702148
load block tensor time/epoch 0.004304409027099609
block to device time/epoch 0.0008442401885986328
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  12966
Number of first layer input nodes during this epoch:  9903
