main start at this time 1648526483.4137082
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012502670288085938
random selection method range initialization spend 0.00018405914306640625
time for parepare:  4.696846008300781e-05
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0014510154724121094
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.696846008300781e-05
----------------------check_connections_block total spend ----------------------------- 0.002513408660888672
generate_one_block  0.0013234615325927734
generate_one_block  0.001148223876953125
generate_one_block  0.001216888427734375
generate_one_block  0.00116729736328125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008025169372558594
gen group dst list time:  3.457069396972656e-05
time for parepare:  0.00023746490478515625
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00023603439331054688
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00019073486328125
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0003523826599121094
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0005168914794921875
----------------------check_connections_block total spend ----------------------------- 0.002773761749267578
generate_one_block  0.0014290809631347656
generate_one_block  0.0013759136199951172
generate_one_block  0.00159454345703125
generate_one_block  0.0018007755279541016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010118484497070312
gen group dst list time:  7.343292236328125e-05
time for parepare:  0.0007462501525878906
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00026607513427734375
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.0009543895721435547
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  0.00012755393981933594
r_  generation:  0.0009937286376953125
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.0022661685943603516
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.00026345252990722656
mini_batch_src_global generation:  0.00037741661071777344
r_  generation:  0.0031461715698242188
----------------------check_connections_block total spend ----------------------------- 0.01222085952758789
generate_one_block  0.0031893253326416016
generate_one_block  0.002155303955078125
generate_one_block  0.0036759376525878906
generate_one_block  0.004706859588623047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

connection checking time:  0.014994621276855469
block generation total time  0.0199277400970459
average batch blocks generation time:  0.004981935024261475
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0033655166625976562  GigaBytes
Max Memory Allocated: 0.0033655166625976562  GigaBytes

torch.Size([1466, 500])
torch.Size([416, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004212856292724609  GigaBytes
Max Memory Allocated: 0.004685401916503906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004678249359130859  GigaBytes
Max Memory Allocated: 0.007381916046142578  GigaBytes

torch.Size([1846, 500])
torch.Size([428, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0054988861083984375  GigaBytes
Max Memory Allocated: 0.007381916046142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00809621810913086  GigaBytes
Max Memory Allocated: 0.011472225189208984  GigaBytes

torch.Size([3662, 500])
torch.Size([818, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00962686538696289  GigaBytes
Max Memory Allocated: 0.011472225189208984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.008601665496826172  GigaBytes
Max Memory Allocated: 0.015331745147705078  GigaBytes

torch.Size([3918, 500])
torch.Size([1068, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.010606765747070312  GigaBytes
Max Memory Allocated: 0.015331745147705078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011760175228118896 |0.0868578553199768 |0.1970190405845642 |0.00018417835235595703 |0.0034667253494262695 |0.002840280532836914 |
----------------------------------------------------------pseudo_mini_loss sum 2.0567803382873535
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13978
Number of first layer input nodes during this epoch:  10892
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010016441345214844  GigaBytes
Max Memory Allocated: 0.015331745147705078  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005705356597900391
random selection method range initialization spend 0.00012564659118652344
time for parepare:  5.650520324707031e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00013518333435058594
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.482269287109375e-05
----------------------check_connections_block total spend ----------------------------- 0.0013458728790283203
generate_one_block  0.0013895034790039062
generate_one_block  0.0011379718780517578
generate_one_block  0.0011782646179199219
generate_one_block  0.0010352134704589844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005035400390625
gen group dst list time:  3.337860107421875e-05
time for parepare:  0.00023674964904785156
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00020003318786621094
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004494190216064453
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0003533363342285156
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.0002880096435546875
----------------------check_connections_block total spend ----------------------------- 0.0027675628662109375
generate_one_block  0.0016722679138183594
generate_one_block  0.0016341209411621094
generate_one_block  0.001444101333618164
generate_one_block  0.001344919204711914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009996891021728516
gen group dst list time:  7.557868957519531e-05
time for parepare:  0.0006966590881347656
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.0002961158752441406
mini_batch_src_global generation:  0.0001125335693359375
r_  generation:  0.0011134147644042969
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.00024390220642089844
mini_batch_src_global generation:  0.00037217140197753906
r_  generation:  0.002750396728515625
local_output_nid generation:  6.866455078125e-05
local_in_edges_tensor generation:  0.000244140625
mini_batch_src_global generation:  0.00021886825561523438
r_  generation:  0.0019626617431640625
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00016379356384277344
r_  generation:  0.0016021728515625
----------------------check_connections_block total spend ----------------------------- 0.012354135513305664
generate_one_block  0.0024890899658203125
generate_one_block  0.004710197448730469
generate_one_block  0.0033369064331054688
generate_one_block  0.002885103225708008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010016441345214844  GigaBytes
Max Memory Allocated: 0.015331745147705078  GigaBytes

connection checking time:  0.015121698379516602
block generation total time  0.019516706466674805
average batch blocks generation time:  0.004879176616668701
block dataloader generation time/epoch 0.05239510536193848
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006065845489501953  GigaBytes
Max Memory Allocated: 0.015331745147705078  GigaBytes

torch.Size([1941, 500])
torch.Size([503, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0069904327392578125  GigaBytes
Max Memory Allocated: 0.015331745147705078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009801387786865234  GigaBytes
Max Memory Allocated: 0.015331745147705078  GigaBytes

torch.Size([3739, 500])
torch.Size([892, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011541366577148438  GigaBytes
Max Memory Allocated: 0.015331745147705078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008071422576904297  GigaBytes
Max Memory Allocated: 0.015331745147705078  GigaBytes

torch.Size([3005, 500])
torch.Size([738, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009468555450439453  GigaBytes
Max Memory Allocated: 0.015331745147705078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007756233215332031  GigaBytes
Max Memory Allocated: 0.015331745147705078  GigaBytes

torch.Size([2841, 500])
torch.Size([650, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008986949920654297  GigaBytes
Max Memory Allocated: 0.015331745147705078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0017285346984863281 |0.0004112124443054199 |0.0032291412353515625 |0.00011599063873291016 |0.0026845335960388184 |0.0014493465423583984 |
----------------------------------------------------------pseudo_mini_loss sum 1.0561549663543701
Total (block generation + training)time/epoch 0.09133172035217285
Training time/epoch 0.0387115478515625
Training time without block to device /epoch 0.03706669807434082
Training time without total dataloading part /epoch 0.025568008422851562
load block tensor time/epoch 0.0069141387939453125
block to device time/epoch 0.0016448497772216797
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14666
Number of first layer input nodes during this epoch:  11526
