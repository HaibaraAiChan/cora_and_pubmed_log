main start at this time 1648526583.3719974
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001444101333618164
random selection method range initialization spend 0.00019359588623046875
time for parepare:  4.696846008300781e-05
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.0011708736419677734
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.9591064453125e-05
----------------------check_connections_block total spend ----------------------------- 0.0022258758544921875
generate_one_block  0.0012311935424804688
generate_one_block  0.0010919570922851562
generate_one_block  0.0011394023895263672
generate_one_block  0.001112222671508789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009176731109619141
gen group dst list time:  3.457069396972656e-05
time for parepare:  0.00025081634521484375
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00023889541625976562
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00020194053649902344
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0003800392150878906
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.000568389892578125
----------------------check_connections_block total spend ----------------------------- 0.0029120445251464844
generate_one_block  0.0013761520385742188
generate_one_block  0.0013322830200195312
generate_one_block  0.0015721321105957031
generate_one_block  0.0018084049224853516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010385513305664062
gen group dst list time:  7.486343383789062e-05
time for parepare:  0.0007560253143310547
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0002722740173339844
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.0009553432464599609
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0010602474212646484
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.00023818016052246094
mini_batch_src_global generation:  0.00024175643920898438
r_  generation:  0.002464771270751953
local_output_nid generation:  8.797645568847656e-05
local_in_edges_tensor generation:  0.0002779960632324219
mini_batch_src_global generation:  0.00038623809814453125
r_  generation:  0.0033903121948242188
----------------------check_connections_block total spend ----------------------------- 0.012973308563232422
generate_one_block  0.0023813247680664062
generate_one_block  0.0023131370544433594
generate_one_block  0.004101276397705078
generate_one_block  0.005717754364013672
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

connection checking time:  0.015885353088378906
block generation total time  0.02060246467590332
average batch blocks generation time:  0.00515061616897583
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.003356456756591797  GigaBytes
Max Memory Allocated: 0.003356456756591797  GigaBytes

torch.Size([1461, 500])
torch.Size([416, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00420379638671875  GigaBytes
Max Memory Allocated: 0.004673957824707031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004840373992919922  GigaBytes
Max Memory Allocated: 0.007533073425292969  GigaBytes

torch.Size([1932, 500])
torch.Size([466, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0057220458984375  GigaBytes
Max Memory Allocated: 0.007533073425292969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008724212646484375  GigaBytes
Max Memory Allocated: 0.012254714965820312  GigaBytes

torch.Size([3996, 500])
torch.Size([881, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010358333587646484  GigaBytes
Max Memory Allocated: 0.012254714965820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.008919715881347656  GigaBytes
Max Memory Allocated: 0.016265392303466797  GigaBytes

torch.Size([4085, 500])
torch.Size([1174, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011096954345703125  GigaBytes
Max Memory Allocated: 0.016265392303466797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0050452351570129395 |0.08622521162033081 |0.19434839487075806 |0.0001818537712097168 |0.005215346813201904 |0.002300262451171875 |
----------------------------------------------------------pseudo_mini_loss sum 2.015160083770752
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14767
Number of first layer input nodes during this epoch:  11474
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010349273681640625  GigaBytes
Max Memory Allocated: 0.016265392303466797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005729198455810547
random selection method range initialization spend 0.00013566017150878906
time for parepare:  5.936622619628906e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00012612342834472656
mini_batch_src_global generation:  0.00010704994201660156
r_  generation:  0.000141143798828125
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0003116130828857422
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  9.083747863769531e-05
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  8.082389831542969e-05
----------------------check_connections_block total spend ----------------------------- 0.002177715301513672
generate_one_block  0.0027070045471191406
generate_one_block  0.002207040786743164
generate_one_block  0.002458810806274414
generate_one_block  0.002101898193359375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011217594146728516
gen group dst list time:  7.295608520507812e-05
time for parepare:  0.0005533695220947266
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00033164024353027344
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0004520416259765625
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0002727508544921875
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0010764598846435547
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0005304813385009766
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0004444122314453125
----------------------check_connections_block total spend ----------------------------- 0.005211353302001953
generate_one_block  0.0017955303192138672
generate_one_block  0.0022957324981689453
generate_one_block  0.0020301342010498047
generate_one_block  0.0018198490142822266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012171268463134766
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.0007343292236328125
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00030612945556640625
mini_batch_src_global generation:  0.00011277198791503906
r_  generation:  0.0011091232299804688
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.00025153160095214844
mini_batch_src_global generation:  0.0003826618194580078
r_  generation:  0.0030527114868164062
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.00022482872009277344
mini_batch_src_global generation:  0.000240325927734375
r_  generation:  0.002038717269897461
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  0.00017786026000976562
r_  generation:  0.001734018325805664
----------------------check_connections_block total spend ----------------------------- 0.013066291809082031
generate_one_block  0.002572774887084961
generate_one_block  0.004938602447509766
generate_one_block  0.003610849380493164
generate_one_block  0.0031332969665527344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010349273681640625  GigaBytes
Max Memory Allocated: 0.016265392303466797  GigaBytes

connection checking time:  0.018277645111083984
block generation total time  0.02219676971435547
average batch blocks generation time:  0.005549192428588867
block dataloader generation time/epoch 0.0655207633972168
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006035804748535156  GigaBytes
Max Memory Allocated: 0.016265392303466797  GigaBytes

torch.Size([1925, 500])
torch.Size([504, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006961822509765625  GigaBytes
Max Memory Allocated: 0.016265392303466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010848045349121094  GigaBytes
Max Memory Allocated: 0.016265392303466797  GigaBytes

torch.Size([4188, 500])
torch.Size([964, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01270914077758789  GigaBytes
Max Memory Allocated: 0.016265392303466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.008191585540771484  GigaBytes
Max Memory Allocated: 0.016470909118652344  GigaBytes

torch.Size([3068, 500])
torch.Size([789, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.009671688079833984  GigaBytes
Max Memory Allocated: 0.016470909118652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.008049964904785156  GigaBytes
Max Memory Allocated: 0.016470909118652344  GigaBytes

torch.Size([2996, 500])
torch.Size([732, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.009412288665771484  GigaBytes
Max Memory Allocated: 0.016470909118652344  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001839280128479004 |0.00041621923446655273 |0.003214895725250244 |0.00012421607971191406 |0.003676116466522217 |0.0014438629150390625 |
----------------------------------------------------------pseudo_mini_loss sum 1.0505727529525757
Total (block generation + training)time/epoch 0.1089324951171875
Training time/epoch 0.04311776161193848
Training time without block to device /epoch 0.041452884674072266
Training time without total dataloading part /epoch 0.029504776000976562
load block tensor time/epoch 0.007357120513916016
block to device time/epoch 0.001664876937866211
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15523
Number of first layer input nodes during this epoch:  12177
