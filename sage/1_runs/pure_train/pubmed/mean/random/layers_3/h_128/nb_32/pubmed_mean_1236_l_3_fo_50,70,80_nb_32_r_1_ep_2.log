main start at this time 1648526653.417681
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.003023386001586914
random selection method range initialization spend 0.00018644332885742188
time for parepare:  4.029273986816406e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.0015208721160888672
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.702278137207031e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.678436279296875e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.7738037109375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.3603439331054688e-05
----------------------check_connections_block total spend ----------------------------- 0.004179954528808594
generate_one_block  0.0013346672058105469
generate_one_block  0.0010044574737548828
generate_one_block  0.0009908676147460938
generate_one_block  0.001016855239868164
generate_one_block  0.001020193099975586
generate_one_block  0.0009794235229492188
generate_one_block  0.000972747802734375
generate_one_block  0.001043558120727539
generate_one_block  0.0010342597961425781
generate_one_block  0.0009717941284179688
generate_one_block  0.0009789466857910156
generate_one_block  0.0009701251983642578
generate_one_block  0.0009794235229492188
generate_one_block  0.0009846687316894531
generate_one_block  0.0009908676147460938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002198457717895508
gen group dst list time:  7.939338684082031e-05
time for parepare:  0.0002493858337402344
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  8.440017700195312e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  9.489059448242188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00011324882507324219
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.7206878662109375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00015878677368164062
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00010514259338378906
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.626678466796875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  5.745887756347656e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.000171661376953125
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.000152587890625
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.000179290771484375
----------------------check_connections_block total spend ----------------------------- 0.0046045780181884766
generate_one_block  0.0011408329010009766
generate_one_block  0.001024484634399414
generate_one_block  0.0010671615600585938
generate_one_block  0.0011513233184814453
generate_one_block  0.001074075698852539
generate_one_block  0.0010294914245605469
generate_one_block  0.0010209083557128906
generate_one_block  0.0013039112091064453
generate_one_block  0.0011138916015625
generate_one_block  0.0011165142059326172
generate_one_block  0.00104522705078125
generate_one_block  0.0010111331939697266
generate_one_block  0.001176595687866211
generate_one_block  0.0011606216430664062
generate_one_block  0.001196146011352539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011394023895263672
gen group dst list time:  0.00011539459228515625
time for parepare:  0.0007507801055908203
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0002484321594238281
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.0003094673156738281
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00014472007751464844
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00029468536376953125
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0005979537963867188
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00025200843811035156
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.0003714561462402344
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00016951560974121094
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00021982192993164062
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00015783309936523438
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.001043558120727539
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.0011191368103027344
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0005824565887451172
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0004184246063232422
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00031280517578125
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  0.0001304149627685547
r_  generation:  0.0013821125030517578
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  0.00015997886657714844
r_  generation:  0.0012822151184082031
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  0.00014019012451171875
r_  generation:  0.0013422966003417969
----------------------check_connections_block total spend ----------------------------- 0.016965389251708984
generate_one_block  0.0014636516571044922
generate_one_block  0.0011987686157226562
generate_one_block  0.0013642311096191406
generate_one_block  0.0017120838165283203
generate_one_block  0.0014750957489013672
generate_one_block  0.0011644363403320312
generate_one_block  0.0012621879577636719
generate_one_block  0.0022132396697998047
generate_one_block  0.002428293228149414
generate_one_block  0.0016360282897949219
generate_one_block  0.0014617443084716797
generate_one_block  0.0013623237609863281
generate_one_block  0.0026814937591552734
generate_one_block  0.002535104751586914
generate_one_block  0.002886533737182617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

connection checking time:  0.02156996726989746
block generation total time  0.043477535247802734
average batch blocks generation time:  0.002898502349853516
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0014390945434570312  GigaBytes
Max Memory Allocated: 0.0014390945434570312  GigaBytes

torch.Size([441, 500])
torch.Size([138, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.001705169677734375  GigaBytes
Max Memory Allocated: 0.0018563270568847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2440185546875 GB
    Memory Allocated: 0.0017375946044921875  GigaBytes
Max Memory Allocated: 0.0025539398193359375  GigaBytes

torch.Size([279, 500])
torch.Size([61, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2440185546875 GB
    Memory Allocated: 0.0018620491027832031  GigaBytes
Max Memory Allocated: 0.0025539398193359375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002247333526611328  GigaBytes
Max Memory Allocated: 0.0027570724487304688  GigaBytes

torch.Size([550, 500])
torch.Size([134, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0025491714477539062  GigaBytes
Max Memory Allocated: 0.0027570724487304688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0031194686889648438  GigaBytes
Max Memory Allocated: 0.004124641418457031  GigaBytes

torch.Size([1013, 500])
torch.Size([238, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0035614967346191406  GigaBytes
Max Memory Allocated: 0.004124641418457031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0029449462890625  GigaBytes
Max Memory Allocated: 0.004821300506591797  GigaBytes

torch.Size([924, 500])
torch.Size([97, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003142833709716797  GigaBytes
Max Memory Allocated: 0.004821300506591797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0017619132995605469  GigaBytes
Max Memory Allocated: 0.004821300506591797  GigaBytes

torch.Size([292, 500])
torch.Size([87, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00196075439453125  GigaBytes
Max Memory Allocated: 0.004821300506591797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0019769668579101562  GigaBytes
Max Memory Allocated: 0.004821300506591797  GigaBytes

torch.Size([407, 500])
torch.Size([96, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0021581649780273438  GigaBytes
Max Memory Allocated: 0.004821300506591797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004651546478271484  GigaBytes
Max Memory Allocated: 0.005379676818847656  GigaBytes

torch.Size([1830, 500])
torch.Size([394, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0053863525390625  GigaBytes
Max Memory Allocated: 0.006117343902587891  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005738258361816406  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

torch.Size([2412, 500])
torch.Size([284, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00626373291015625  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0031890869140625  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

torch.Size([1052, 500])
torch.Size([167, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0035119056701660156  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.002678394317626953  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

torch.Size([780, 500])
torch.Size([134, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0029282569885253906  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0031833648681640625  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

torch.Size([657, 500])
torch.Size([103, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0034003257751464844  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0040988922119140625  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

torch.Size([1525, 500])
torch.Size([348, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004742145538330078  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004170417785644531  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

torch.Size([1566, 500])
torch.Size([334, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004807472229003906  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0060520172119140625  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

torch.Size([2307, 500])
torch.Size([482, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006935596466064453  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0015165328979492188 |0.02357176144917806 |0.054847399393717446 |0.00013715426127115885 |0.0027022679646809896 |0.0019078254699707031 |
----------------------------------------------------------pseudo_mini_loss sum 2.210178852081299
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  19489
Number of first layer input nodes during this epoch:  16035
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007351398468017578  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004291534423828125
random selection method range initialization spend 0.00010085105895996094
time for parepare:  4.076957702636719e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.821487426757812e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.654594421386719e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.678436279296875e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.678436279296875e-05
mini_batch_src_global generation:  1.2636184692382812e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.58306884765625e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.606910705566406e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.630752563476562e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  1.8596649169921875e-05
----------------------check_connections_block total spend ----------------------------- 0.00250244140625
generate_one_block  0.001073598861694336
generate_one_block  0.0010025501251220703
generate_one_block  0.0009737014770507812
generate_one_block  0.0009505748748779297
generate_one_block  0.0009593963623046875
generate_one_block  0.00116729736328125
generate_one_block  0.0009548664093017578
generate_one_block  0.0009474754333496094
generate_one_block  0.0010008811950683594
generate_one_block  0.0010211467742919922
generate_one_block  0.0009474754333496094
generate_one_block  0.0009486675262451172
generate_one_block  0.0009436607360839844
generate_one_block  0.0009484291076660156
generate_one_block  0.0009450912475585938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006110668182373047
gen group dst list time:  7.462501525878906e-05
time for parepare:  0.00024819374084472656
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.2479248046875e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.726119995117188e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00020837783813476562
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  9.298324584960938e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00018525123596191406
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00015664100646972656
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  9.417533874511719e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0001633167266845703
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.127357482910156e-05
----------------------check_connections_block total spend ----------------------------- 0.004454374313354492
generate_one_block  0.0011055469512939453
generate_one_block  0.001024484634399414
generate_one_block  0.0010805130004882812
generate_one_block  0.0010623931884765625
generate_one_block  0.0011870861053466797
generate_one_block  0.001049041748046875
generate_one_block  0.001239776611328125
generate_one_block  0.0010361671447753906
generate_one_block  0.0011487007141113281
generate_one_block  0.0010056495666503906
generate_one_block  0.0010683536529541016
generate_one_block  0.0011668205261230469
generate_one_block  0.000995635986328125
generate_one_block  0.0010228157043457031
generate_one_block  0.0010309219360351562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012307167053222656
gen group dst list time:  0.00012111663818359375
time for parepare:  0.0008728504180908203
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00028443336486816406
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.00038743019104003906
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.000247955322265625
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0001385211944580078
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00047326087951660156
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  0.0001964569091796875
r_  generation:  0.0014309883117675781
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.00046062469482421875
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0018658638000488281
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.00033164024353027344
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.0011966228485107422
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.00033783912658691406
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0005452632904052734
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  0.00011920928955078125
r_  generation:  0.0012602806091308594
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.00019884109497070312
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00019812583923339844
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0003848075866699219
----------------------check_connections_block total spend ----------------------------- 0.01709747314453125
generate_one_block  0.0016071796417236328
generate_one_block  0.0012362003326416016
generate_one_block  0.0011777877807617188
generate_one_block  0.001550436019897461
generate_one_block  0.002784252166748047
generate_one_block  0.0015137195587158203
generate_one_block  0.0033636093139648438
generate_one_block  0.0012888908386230469
generate_one_block  0.0024344921112060547
generate_one_block  0.0013298988342285156
generate_one_block  0.0015451908111572266
generate_one_block  0.0027472972869873047
generate_one_block  0.0011625289916992188
generate_one_block  0.0012309551239013672
generate_one_block  0.001447439193725586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007351398468017578  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

connection checking time:  0.021551847457885742
block generation total time  0.04264378547668457
average batch blocks generation time:  0.0028429190317789716
block dataloader generation time/epoch 0.0966942310333252
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.003941535949707031  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

torch.Size([811, 500])
torch.Size([153, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00423431396484375  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0032439231872558594  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

torch.Size([438, 500])
torch.Size([115, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.003456592559814453  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0029582977294921875  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

torch.Size([286, 500])
torch.Size([47, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0030646324157714844  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004127979278564453  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

torch.Size([909, 500])
torch.Size([209, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004504203796386719  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006103992462158203  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

torch.Size([1953, 500])
torch.Size([419, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006899833679199219  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004207134246826172  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

torch.Size([952, 500])
torch.Size([150, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004547595977783203  GigaBytes
Max Memory Allocated: 0.009114265441894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0078105926513671875  GigaBytes
Max Memory Allocated: 0.009524345397949219  GigaBytes

torch.Size([2797, 500])
torch.Size([421, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.008602619171142578  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0033121109008789062  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

torch.Size([474, 500])
torch.Size([104, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0035247802734375  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0066375732421875  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

torch.Size([2245, 500])
torch.Size([392, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007374763488769531  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.003376483917236328  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

torch.Size([508, 500])
torch.Size([126, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0036144256591796875  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.004008769989013672  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

torch.Size([844, 500])
torch.Size([212, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.004403591156005859  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006425380706787109  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

torch.Size([2130, 500])
torch.Size([471, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007258415222167969  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0030221939086914062  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

torch.Size([320, 500])
torch.Size([91, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0031995773315429688  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0031752586364746094  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

torch.Size([402, 500])
torch.Size([86, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0033655166625976562  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.004180908203125  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes
Using backend: pytorch

torch.Size([939, 500])
torch.Size([98, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.004399299621582031  GigaBytes
Max Memory Allocated: 0.00980377197265625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0008146762847900391 |0.0004078865051269531 |0.0032532374064127606 |0.00011852582295735677 |0.0031232357025146483 |0.0014774799346923828 |
----------------------------------------------------------pseudo_mini_loss sum 0.8994462490081787
Total (block generation + training)time/epoch 0.2315843105316162
Training time/epoch 0.1346585750579834
Training time without block to device /epoch 0.1285402774810791
Training time without total dataloading part /epoch 0.09890246391296387
load block tensor time/epoch 0.012220144271850586
block to device time/epoch 0.006118297576904297
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  19459
Number of first layer input nodes during this epoch:  16008
