main start at this time 1648526573.4177203
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002053976058959961
random selection method range initialization spend 0.0001773834228515625
time for parepare:  4.1484832763671875e-05
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.0014107227325439453
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  7.2479248046875e-05
----------------------check_connections_block total spend ----------------------------- 0.002101421356201172
generate_one_block  0.0012803077697753906
generate_one_block  0.0010821819305419922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010151863098144531
gen group dst list time:  2.2649765014648438e-05
time for parepare:  0.00023889541625976562
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0003871917724609375
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  0.0001251697540283203
r_  generation:  0.0008330345153808594
----------------------check_connections_block total spend ----------------------------- 0.0023899078369140625
generate_one_block  0.001634836196899414
generate_one_block  0.002157926559448242
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009343624114990234
gen group dst list time:  5.888938903808594e-05
time for parepare:  0.0007259845733642578
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.00033164024353027344
mini_batch_src_global generation:  0.0001628398895263672
r_  generation:  0.0017447471618652344
local_output_nid generation:  0.00012636184692382812
local_in_edges_tensor generation:  0.00034117698669433594
mini_batch_src_global generation:  0.0006587505340576172
r_  generation:  0.004939079284667969
----------------------check_connections_block total spend ----------------------------- 0.01118779182434082
generate_one_block  0.0035142898559570312
generate_one_block  0.007688045501708984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

connection checking time:  0.013577699661254883
block generation total time  0.014995098114013672
average batch blocks generation time:  0.007497549057006836
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.006615638732910156  GigaBytes
Max Memory Allocated: 0.006615638732910156  GigaBytes

torch.Size([3196, 500])
torch.Size([878, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008332252502441406  GigaBytes
Max Memory Allocated: 0.009447097778320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.013583183288574219  GigaBytes
Max Memory Allocated: 0.019379615783691406  GigaBytes

torch.Size([6557, 500])
torch.Size([1984, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.017269611358642578  GigaBytes
Max Memory Allocated: 0.019696712493896484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004631519317626953 |0.17087066173553467 |0.3826174736022949 |0.0002338886260986328 |0.005023360252380371 |0.004307270050048828 |
----------------------------------------------------------pseudo_mini_loss sum 1.9509122371673584
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12971
Number of first layer input nodes during this epoch:  9753
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015147209167480469  GigaBytes
Max Memory Allocated: 0.019696712493896484  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007710456848144531
random selection method range initialization spend 0.0001595020294189453
time for parepare:  7.534027099609375e-05
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0002651214599609375
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00011086463928222656
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00010204315185546875
----------------------check_connections_block total spend ----------------------------- 0.0010824203491210938
generate_one_block  0.0018994808197021484
generate_one_block  0.00152587890625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005996227264404297
gen group dst list time:  2.8371810913085938e-05
time for parepare:  0.0003056526184082031
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0002257823944091797
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0008261203765869141
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0007486343383789062
----------------------check_connections_block total spend ----------------------------- 0.00293731689453125
generate_one_block  0.0022187232971191406
generate_one_block  0.002076387405395508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001146554946899414
gen group dst list time:  9.655952453613281e-05
time for parepare:  0.0007405281066894531
local_output_nid generation:  0.00011110305786132812
local_in_edges_tensor generation:  0.0004303455352783203
mini_batch_src_global generation:  0.0004527568817138672
r_  generation:  0.004069805145263672
local_output_nid generation:  0.00011515617370605469
local_in_edges_tensor generation:  0.00030422210693359375
mini_batch_src_global generation:  0.0004801750183105469
r_  generation:  0.0033440589904785156
----------------------check_connections_block total spend ----------------------------- 0.01233220100402832
generate_one_block  0.006183624267578125
generate_one_block  0.0052950382232666016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015147209167480469  GigaBytes
Max Memory Allocated: 0.019696712493896484  GigaBytes

connection checking time:  0.01526951789855957
block generation total time  0.015773773193359375
average batch blocks generation time:  0.007886886596679688
block dataloader generation time/epoch 0.050375938415527344
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.012504100799560547  GigaBytes
Max Memory Allocated: 0.024598121643066406  GigaBytes
Using backend: pytorch

torch.Size([5350, 500])
torch.Size([1443, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.015244483947753906  GigaBytes
Max Memory Allocated: 0.024598121643066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011896133422851562  GigaBytes
Max Memory Allocated: 0.024598121643066406  GigaBytes

torch.Size([5035, 500])
torch.Size([1442, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.014600753784179688  GigaBytes
Max Memory Allocated: 0.024598121643066406  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0031992197036743164 |0.00043952465057373047 |0.0032410621643066406 |0.00012922286987304688 |0.0028274059295654297 |0.0014617443084716797 |
----------------------------------------------------------pseudo_mini_loss sum 0.9517662525177002
Total (block generation + training)time/epoch 0.07427620887756348
Training time/epoch 0.0236358642578125
Training time without block to device /epoch 0.02275681495666504
Training time without total dataloading part /epoch 0.013857126235961914
load block tensor time/epoch 0.006398439407348633
block to device time/epoch 0.0008790493011474609
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13626
Number of first layer input nodes during this epoch:  10385
