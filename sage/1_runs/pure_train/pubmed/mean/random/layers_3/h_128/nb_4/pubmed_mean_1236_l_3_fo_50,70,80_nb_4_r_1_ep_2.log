main start at this time 1648526623.395647
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0026242733001708984
random selection method range initialization spend 0.00019240379333496094
time for parepare:  4.57763671875e-05
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.001260995864868164
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  7.796287536621094e-05
----------------------check_connections_block total spend ----------------------------- 0.001981496810913086
generate_one_block  0.0013980865478515625
generate_one_block  0.001195669174194336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012664794921875
gen group dst list time:  2.5033950805664062e-05
time for parepare:  0.0002346038818359375
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0004146099090576172
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  0.00012755393981933594
r_  generation:  0.0008764266967773438
----------------------check_connections_block total spend ----------------------------- 0.0024383068084716797
generate_one_block  0.0016734600067138672
generate_one_block  0.002338409423828125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010869503021240234
gen group dst list time:  6.103515625e-05
time for parepare:  0.0007507801055908203
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.00036907196044921875
mini_batch_src_global generation:  0.0001723766326904297
r_  generation:  0.0021533966064453125
local_output_nid generation:  0.00013494491577148438
local_in_edges_tensor generation:  0.00038695335388183594
mini_batch_src_global generation:  0.0006911754608154297
r_  generation:  0.005848407745361328
----------------------check_connections_block total spend ----------------------------- 0.012923955917358398
generate_one_block  0.0037755966186523438
generate_one_block  0.008312463760375977
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

connection checking time:  0.015362262725830078
block generation total time  0.016099929809570312
average batch blocks generation time:  0.008049964904785156
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.007168769836425781  GigaBytes
Max Memory Allocated: 0.007168769836425781  GigaBytes

torch.Size([3490, 500])
torch.Size([878, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008891105651855469  GigaBytes
Max Memory Allocated: 0.010146141052246094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015061378479003906  GigaBytes
Max Memory Allocated: 0.02138519287109375  GigaBytes

torch.Size([7080, 500])
torch.Size([1985, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01876974105834961  GigaBytes
Max Memory Allocated: 0.021445751190185547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00631403923034668 |0.17065465450286865 |0.3864412307739258 |0.00023651123046875 |0.005232334136962891 |0.004182100296020508 |
----------------------------------------------------------pseudo_mini_loss sum 1.961005687713623
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13789
Number of first layer input nodes during this epoch:  10570
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01666736602783203  GigaBytes
Max Memory Allocated: 0.021445751190185547  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00046825408935546875
random selection method range initialization spend 0.00010132789611816406
time for parepare:  4.172325134277344e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  6.151199340820312e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.793571472167969e-05
----------------------check_connections_block total spend ----------------------------- 0.0006258487701416016
generate_one_block  0.0011658668518066406
generate_one_block  0.001016378402709961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005235671997070312
gen group dst list time:  2.4080276489257812e-05
time for parepare:  0.0002665519714355469
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.0006392002105712891
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.0006189346313476562
----------------------check_connections_block total spend ----------------------------- 0.00241851806640625
generate_one_block  0.0018465518951416016
generate_one_block  0.0017156600952148438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010247230529785156
gen group dst list time:  6.651878356933594e-05
time for parepare:  0.0007343292236328125
local_output_nid generation:  0.0001087188720703125
local_in_edges_tensor generation:  0.00040650367736816406
mini_batch_src_global generation:  0.00037932395935058594
r_  generation:  0.004277944564819336
local_output_nid generation:  0.00010752677917480469
local_in_edges_tensor generation:  0.00028967857360839844
mini_batch_src_global generation:  0.00045371055603027344
r_  generation:  0.0036537647247314453
----------------------check_connections_block total spend ----------------------------- 0.012735366821289062
generate_one_block  0.006775617599487305
generate_one_block  0.0057604312896728516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01666736602783203  GigaBytes
Max Memory Allocated: 0.021445751190185547  GigaBytes

connection checking time:  0.015153884887695312
block generation total time  0.0160982608795166
average batch blocks generation time:  0.0080491304397583
block dataloader generation time/epoch 0.08665299415588379
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013286590576171875  GigaBytes
Max Memory Allocated: 0.02682352066040039  GigaBytes
Using backend: pytorch

torch.Size([5762, 500])
torch.Size([1442, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016040802001953125  GigaBytes
Max Memory Allocated: 0.02682352066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012728214263916016  GigaBytes
Max Memory Allocated: 0.02682352066040039  GigaBytes

torch.Size([5475, 500])
torch.Size([1441, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015443801879882812  GigaBytes
Max Memory Allocated: 0.02682352066040039  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003091096878051758 |0.000767827033996582 |0.00426638126373291 |0.00016319751739501953 |0.0031162500381469727 |0.0030434131622314453 |
----------------------------------------------------------pseudo_mini_loss sum 0.8823671340942383
Total (block generation + training)time/epoch 0.11682009696960449
Training time/epoch 0.029804706573486328
Training time without block to device /epoch 0.028269052505493164
Training time without total dataloading part /epoch 0.01813507080078125
load block tensor time/epoch 0.006182193756103516
block to device time/epoch 0.001535654067993164
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14476
Number of first layer input nodes during this epoch:  11237
