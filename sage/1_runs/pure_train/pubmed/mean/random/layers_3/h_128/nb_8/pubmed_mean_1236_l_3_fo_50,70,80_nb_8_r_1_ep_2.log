main start at this time 1648526633.417636
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0019702911376953125
random selection method range initialization spend 0.00018668174743652344
time for parepare:  4.220008850097656e-05
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.0014903545379638672
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  4.553794860839844e-05
----------------------check_connections_block total spend ----------------------------- 0.0024924278259277344
generate_one_block  0.0012674331665039062
generate_one_block  0.0010123252868652344
generate_one_block  0.001077890396118164
generate_one_block  0.0010259151458740234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009539127349853516
gen group dst list time:  3.0279159545898438e-05
time for parepare:  0.0002257823944091797
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00020956993103027344
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00018024444580078125
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0003554821014404297
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0005271434783935547
----------------------check_connections_block total spend ----------------------------- 0.002713441848754883
generate_one_block  0.0012676715850830078
generate_one_block  0.0012619495391845703
generate_one_block  0.0014834403991699219
generate_one_block  0.001703023910522461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001069784164428711
gen group dst list time:  6.771087646484375e-05
time for parepare:  0.000728607177734375
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.000274658203125
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0009095668792724609
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  0.00012063980102539062
r_  generation:  0.0011372566223144531
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.00023865699768066406
mini_batch_src_global generation:  0.00027370452880859375
r_  generation:  0.0024764537811279297
local_output_nid generation:  8.058547973632812e-05
local_in_edges_tensor generation:  0.0002608299255371094
mini_batch_src_global generation:  0.00040459632873535156
r_  generation:  0.003549337387084961
----------------------check_connections_block total spend ----------------------------- 0.013233184814453125
generate_one_block  0.0023369789123535156
generate_one_block  0.002368450164794922
generate_one_block  0.004436016082763672
generate_one_block  0.00556492805480957
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000606536865234375  GigaBytes
Max Memory Allocated: 0.000606536865234375  GigaBytes

connection checking time:  0.015946626663208008
block generation total time  0.02042245864868164
average batch blocks generation time:  0.00510561466217041
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0036411285400390625  GigaBytes
Max Memory Allocated: 0.0036411285400390625  GigaBytes

torch.Size([1613, 500])
torch.Size([416, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004490375518798828  GigaBytes
Max Memory Allocated: 0.005033016204833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0052280426025390625  GigaBytes
Max Memory Allocated: 0.008199691772460938  GigaBytes

torch.Size([2138, 500])
torch.Size([466, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006113529205322266  GigaBytes
Max Memory Allocated: 0.008199691772460938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009484291076660156  GigaBytes
Max Memory Allocated: 0.013389110565185547  GigaBytes

torch.Size([4399, 500])
torch.Size([884, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011132240295410156  GigaBytes
Max Memory Allocated: 0.013389110565185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009591102600097656  GigaBytes
Max Memory Allocated: 0.017673015594482422  GigaBytes

torch.Size([4438, 500])
torch.Size([1174, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011782646179199219  GigaBytes
Max Memory Allocated: 0.017673015594482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007498383522033691 |0.08630597591400146 |0.19376420974731445 |0.0001735091209411621 |0.0034804344177246094 |0.002337217330932617 |
----------------------------------------------------------pseudo_mini_loss sum 2.0435261726379395
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15884
Number of first layer input nodes during this epoch:  12588
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011050701141357422  GigaBytes
Max Memory Allocated: 0.017673015594482422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005795955657958984
random selection method range initialization spend 0.00014138221740722656
time for parepare:  6.67572021484375e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00012731552124023438
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  5.9604644775390625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.0531158447265625e-05
----------------------check_connections_block total spend ----------------------------- 0.0012798309326171875
generate_one_block  0.0013327598571777344
generate_one_block  0.001314401626586914
generate_one_block  0.0014603137969970703
generate_one_block  0.0012590885162353516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000621795654296875
gen group dst list time:  4.506111145019531e-05
time for parepare:  0.000347137451171875
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0002524852752685547
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  9.942054748535156e-05
r_  generation:  0.0006008148193359375
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0004260540008544922
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.00037384033203125
----------------------check_connections_block total spend ----------------------------- 0.003529071807861328
generate_one_block  0.0015671253204345703
generate_one_block  0.0019960403442382812
generate_one_block  0.001758575439453125
generate_one_block  0.0017037391662597656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012352466583251953
gen group dst list time:  0.00010895729064941406
time for parepare:  0.0010211467742919922
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.0003032684326171875
mini_batch_src_global generation:  0.00018405914306640625
r_  generation:  0.0014595985412597656
local_output_nid generation:  0.00010395050048828125
local_in_edges_tensor generation:  0.0003037452697753906
mini_batch_src_global generation:  0.0005671977996826172
r_  generation:  0.004229545593261719
local_output_nid generation:  9.34600830078125e-05
local_in_edges_tensor generation:  0.00027108192443847656
mini_batch_src_global generation:  0.0003390312194824219
r_  generation:  0.0027112960815429688
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.00025725364685058594
mini_batch_src_global generation:  0.00026679039001464844
r_  generation:  0.0020084381103515625
----------------------check_connections_block total spend ----------------------------- 0.01742863655090332
generate_one_block  0.0027005672454833984
generate_one_block  0.00542449951171875
generate_one_block  0.0035524368286132812
generate_one_block  0.0033843517303466797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011050701141357422  GigaBytes
Max Memory Allocated: 0.017673015594482422  GigaBytes

connection checking time:  0.02095770835876465
block generation total time  0.02208733558654785
average batch blocks generation time:  0.005521833896636963
block dataloader generation time/epoch 0.061544179916381836
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.006375789642333984  GigaBytes
Max Memory Allocated: 0.017673015594482422  GigaBytes

torch.Size([2106, 500])
torch.Size([504, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.007304668426513672  GigaBytes
Max Memory Allocated: 0.017673015594482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.010918617248535156  GigaBytes
Max Memory Allocated: 0.017673015594482422  GigaBytes

torch.Size([4506, 500])
torch.Size([964, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01279306411743164  GigaBytes
Max Memory Allocated: 0.017673015594482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.008781909942626953  GigaBytes
Max Memory Allocated: 0.017673015594482422  GigaBytes

torch.Size([3382, 500])
torch.Size([789, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01026773452758789  GigaBytes
Max Memory Allocated: 0.017673015594482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.008683204650878906  GigaBytes
Max Memory Allocated: 0.017673015594482422  GigaBytes

torch.Size([3332, 500])
torch.Size([732, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.010053157806396484  GigaBytes
Max Memory Allocated: 0.017673015594482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0024144649505615234 |0.0007147789001464844 |0.004500627517700195 |0.00014328956604003906 |0.003260970115661621 |0.001760721206665039 |
----------------------------------------------------------pseudo_mini_loss sum 1.057436466217041
Total (block generation + training)time/epoch 0.11502408981323242
Training time/epoch 0.0528717041015625
Training time without block to device /epoch 0.05001258850097656
Training time without total dataloading part /epoch 0.03338027000427246
load block tensor time/epoch 0.009657859802246094
block to device time/epoch 0.0028591156005859375
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16672
Number of first layer input nodes during this epoch:  13326
