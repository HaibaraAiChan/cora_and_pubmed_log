main start at this time 1648526683.4058359
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0017571449279785156
random selection method range initialization spend 0.00021147727966308594
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.001134634017944336
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.6464462280273438e-05
----------------------check_connections_block total spend ----------------------------- 0.0020895004272460938
generate_one_block  0.0012271404266357422
generate_one_block  0.0011188983917236328
generate_one_block  0.0011234283447265625
generate_one_block  0.0011036396026611328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008642673492431641
gen group dst list time:  3.337860107421875e-05
time for parepare:  0.00022792816162109375
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00040721893310546875
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00019741058349609375
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0004038810729980469
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00019121170043945312
----------------------check_connections_block total spend ----------------------------- 0.002559185028076172
generate_one_block  0.0016169548034667969
generate_one_block  0.001312255859375
generate_one_block  0.0015633106231689453
generate_one_block  0.0013904571533203125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009844303131103516
gen group dst list time:  6.985664367675781e-05
time for parepare:  0.0007190704345703125
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.0003151893615722656
mini_batch_src_global generation:  0.00017881393432617188
r_  generation:  0.002263784408569336
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.0014107227325439453
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.00024247169494628906
mini_batch_src_global generation:  0.0002262592315673828
r_  generation:  0.002555370330810547
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  0.00015878677368164062
r_  generation:  0.0011487007141113281
----------------------check_connections_block total spend ----------------------------- 0.011868476867675781
generate_one_block  0.005082368850708008
generate_one_block  0.002797365188598633
generate_one_block  0.004158735275268555
generate_one_block  0.0024232864379882812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

connection checking time:  0.014427661895751953
block generation total time  0.02034473419189453
average batch blocks generation time:  0.005086183547973633
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.008656024932861328  GigaBytes
Max Memory Allocated: 0.008656024932861328  GigaBytes

torch.Size([3827, 500])
torch.Size([885, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01205587387084961  GigaBytes
Max Memory Allocated: 0.014904499053955078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0077686309814453125  GigaBytes
Max Memory Allocated: 0.014904499053955078  GigaBytes

torch.Size([2586, 500])
torch.Size([507, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.009639739990234375  GigaBytes
Max Memory Allocated: 0.014904499053955078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.010115623474121094  GigaBytes
Max Memory Allocated: 0.014904499053955078  GigaBytes

torch.Size([3443, 500])
torch.Size([961, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013574600219726562  GigaBytes
Max Memory Allocated: 0.016222000122070312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006999015808105469  GigaBytes
Max Memory Allocated: 0.016222000122070312  GigaBytes

torch.Size([2177, 500])
torch.Size([476, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008753776550292969  GigaBytes
Max Memory Allocated: 0.016222000122070312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0024881958961486816 |0.08615434169769287 |0.1947687864303589 |0.00019931793212890625 |0.0036266446113586426 |0.004404783248901367 |
----------------------------------------------------------pseudo_mini_loss sum 2.9681637287139893
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15218
Number of first layer input nodes during this epoch:  12033
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009984016418457031  GigaBytes
Max Memory Allocated: 0.016222000122070312  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009412765502929688
random selection method range initialization spend 0.00018930435180664062
time for parepare:  9.512901306152344e-05
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00030612945556640625
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  1.4066696166992188e-05Using backend: pytorch

local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  6.127357482910156e-05
----------------------check_connections_block total spend ----------------------------- 0.0017216205596923828
generate_one_block  0.0016200542449951172
generate_one_block  0.0015866756439208984
generate_one_block  0.0017936229705810547
generate_one_block  0.0015902519226074219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007178783416748047
gen group dst list time:  4.839897155761719e-05
time for parepare:  0.0003342628479003906
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0003495216369628906
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00034308433532714844
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00032711029052734375
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0003337860107421875
----------------------check_connections_block total spend ----------------------------- 0.002979755401611328
generate_one_block  0.0013988018035888672
generate_one_block  0.0014772415161132812
generate_one_block  0.0014705657958984375
generate_one_block  0.0014698505401611328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009121894836425781
gen group dst list time:  7.319450378417969e-05
time for parepare:  0.0006692409515380859
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.0002925395965576172
mini_batch_src_global generation:  0.00018262863159179688
r_  generation:  0.0015668869018554688
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.0002601146697998047
r_  generation:  0.0020568370819091797
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  0.00020456314086914062
r_  generation:  0.001990079879760742
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  0.00018453598022460938
r_  generation:  0.0016922950744628906
----------------------check_connections_block total spend ----------------------------- 0.011893510818481445
generate_one_block  0.0031189918518066406
generate_one_block  0.003646373748779297
generate_one_block  0.003747224807739258
generate_one_block  0.0030183792114257812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009984016418457031  GigaBytes
Max Memory Allocated: 0.016222000122070312  GigaBytes

connection checking time:  0.014873266220092773
block generation total time  0.019347429275512695
average batch blocks generation time:  0.004836857318878174
block dataloader generation time/epoch 0.05893278121948242
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01097249984741211  GigaBytes
Max Memory Allocated: 0.016222000122070312  GigaBytes

torch.Size([2745, 500])
torch.Size([596, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013154029846191406  GigaBytes
Max Memory Allocated: 0.016222000122070312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01186513900756836  GigaBytes
Max Memory Allocated: 0.016916751861572266  GigaBytes

torch.Size([3216, 500])
torch.Size([741, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.014621257781982422  GigaBytes
Max Memory Allocated: 0.017110347747802734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.011385440826416016  GigaBytes
Max Memory Allocated: 0.017315387725830078  GigaBytes

torch.Size([2959, 500])
torch.Size([709, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.014004707336425781  GigaBytes
Max Memory Allocated: 0.017315387725830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.011210918426513672  GigaBytes
Max Memory Allocated: 0.017315387725830078  GigaBytes

torch.Size([2872, 500])
torch.Size([774, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01410531997680664  GigaBytes
Max Memory Allocated: 0.017315387725830078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0017123222351074219 |0.0004023313522338867 |0.003242790699005127 |0.00011962652206420898 |0.00288468599319458 |0.0014009475708007812 |
----------------------------------------------------------pseudo_mini_loss sum 1.0103145837783813
Total (block generation + training)time/epoch 0.09843802452087402
Training time/epoch 0.039241790771484375
Training time without block to device /epoch 0.03763246536254883
Training time without total dataloading part /epoch 0.026389360427856445
load block tensor time/epoch 0.0068492889404296875
block to device time/epoch 0.0016093254089355469
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14968
Number of first layer input nodes during this epoch:  11792
