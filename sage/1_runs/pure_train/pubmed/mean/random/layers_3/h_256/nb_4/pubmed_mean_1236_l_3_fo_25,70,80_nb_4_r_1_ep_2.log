main start at this time 1648526773.424901
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0016684532165527344
random selection method range initialization spend 0.0002703666687011719
time for parepare:  8.678436279296875e-05
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00032138824462890625
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.002187967300415039
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0002560615539550781
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00010895729064941406
----------------------check_connections_block total spend ----------------------------- 0.0033795833587646484
generate_one_block  0.0021507740020751953
generate_one_block  0.0015811920166015625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009682178497314453
gen group dst list time:  3.2901763916015625e-05
time for parepare:  0.00034618377685546875
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0002562999725341797
mini_batch_src_global generation:  9.34600830078125e-05
r_  generation:  0.0008990764617919922
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.000141143798828125
r_  generation:  0.0009310245513916016
----------------------check_connections_block total spend ----------------------------- 0.0033888816833496094
generate_one_block  0.002660512924194336
generate_one_block  0.002386331558227539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011706352233886719
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.0008985996246337891
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.0004677772521972656
mini_batch_src_global generation:  0.00041747093200683594
r_  generation:  0.004839897155761719
local_output_nid generation:  0.0001506805419921875
local_in_edges_tensor generation:  0.0003826618194580078
mini_batch_src_global generation:  0.0005891323089599609
r_  generation:  0.00471806526184082
----------------------check_connections_block total spend ----------------------------- 0.015384912490844727
generate_one_block  0.006194353103637695
generate_one_block  0.005612850189208984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

connection checking time:  0.018773794174194336
block generation total time  0.016854047775268555
average batch blocks generation time:  0.008427023887634277
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.013290882110595703  GigaBytes
Max Memory Allocated: 0.013290882110595703  GigaBytes

torch.Size([5785, 500])
torch.Size([1456, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.018756866455078125  GigaBytes
Max Memory Allocated: 0.023083209991455078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012012481689453125  GigaBytes
Max Memory Allocated: 0.023620128631591797  GigaBytes

torch.Size([4827, 500])
torch.Size([1512, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017621994018554688  GigaBytes
Max Memory Allocated: 0.023620128631591797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.022551536560058594 |0.17052686214447021 |0.3855307102203369 |0.0002307891845703125 |0.005218982696533203 |0.003908872604370117 |
----------------------------------------------------------pseudo_mini_loss sum 2.9393625259399414
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13936
Number of first layer input nodes during this epoch:  10612
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015170097351074219  GigaBytes
Max Memory Allocated: 0.023620128631591797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005819797515869141
random selection method range initialization spend 0.00013399124145507812
time for parepare:  5.269050598144531e-05
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  7.605552673339844e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.319450378417969e-05
----------------------check_connections_block total spend ----------------------------- 0.0007796287536621094
generate_one_block  0.0013608932495117188
generate_one_block  0.0013282299041748047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006158351898193359
gen group dst list time:  3.147125244140625e-05
time for parepare:  0.0003490447998046875
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  0.00010228157043457031
r_  generation:  0.0007781982421875
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  0.00012755393981933594
r_  generation:  0.0008597373962402344
----------------------check_connections_block total spend ----------------------------- 0.0031251907348632812
generate_one_block  0.002211332321166992
generate_one_block  0.0023317337036132812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021500587463378906
gen group dst list time:  0.00021028518676757812
time for parepare:  0.0016312599182128906
local_output_nid generation:  0.00023317337036132812
local_in_edges_tensor generation:  0.0007722377777099609
mini_batch_src_global generation:  0.0007693767547607422
r_  generation:  0.006876945495605469
local_output_nid generation:  0.0001926422119140625
local_in_edges_tensor generation:  0.00046944618225097656
mini_batch_src_global generation:  0.0007557868957519531
r_  generation:  0.005261898040771484
----------------------check_connections_block total spend ----------------------------- 0.02093958854675293
generate_one_block  0.0066318511962890625
generate_one_block  0.006299734115600586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015170097351074219  GigaBytes
Max Memory Allocated: 0.023620128631591797  GigaBytes

connection checking time:  0.02406477928161621
block generation total time  0.017474651336669922
average batch blocks generation time:  0.008737325668334961
block dataloader generation time/epoch 0.10729670524597168
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01646137237548828  GigaBytes
Max Memory Allocated: 0.02534341812133789  GigaBytes
Using backend: pytorch

torch.Size([5153, 500])
torch.Size([1382, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021656036376953125  GigaBytes
Max Memory Allocated: 0.025556564331054688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01600170135498047  GigaBytes
Max Memory Allocated: 0.026424884796142578  GigaBytes

torch.Size([5407, 500])
torch.Size([1552, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021893978118896484  GigaBytes
Max Memory Allocated: 0.026424884796142578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0032881498336791992 |0.00045990943908691406 |0.0034793615341186523 |0.00013339519500732422 |0.002842426300048828 |0.0014727115631103516 |
----------------------------------------------------------pseudo_mini_loss sum 0.6820113658905029
Total (block generation + training)time/epoch 0.1319444179534912
Training time/epoch 0.02443408966064453
Training time without block to device /epoch 0.023514270782470703
Training time without total dataloading part /epoch 0.014383077621459961
load block tensor time/epoch 0.0065762996673583984
block to device time/epoch 0.0009198188781738281
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13849
Number of first layer input nodes during this epoch:  10560
