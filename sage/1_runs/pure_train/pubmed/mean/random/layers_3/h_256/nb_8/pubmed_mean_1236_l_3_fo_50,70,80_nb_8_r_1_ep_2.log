main start at this time 1648526833.4193523
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013089179992675781
random selection method range initialization spend 0.0001823902130126953
time for parepare:  4.57763671875e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0010986328125
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.956390380859375e-05
----------------------check_connections_block total spend ----------------------------- 0.0021371841430664062
generate_one_block  0.0013744831085205078
generate_one_block  0.0011746883392333984
generate_one_block  0.0012192726135253906
generate_one_block  0.0011551380157470703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008673667907714844
gen group dst list time:  3.4332275390625e-05
time for parepare:  0.000255584716796875
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0004467964172363281
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00023412704467773438
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00048613548278808594
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0002319812774658203
----------------------check_connections_block total spend ----------------------------- 0.002918720245361328
generate_one_block  0.0017518997192382812
generate_one_block  0.0014414787292480469
generate_one_block  0.001764059066772461
generate_one_block  0.001416921615600586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010843276977539062
gen group dst list time:  8.0108642578125e-05
time for parepare:  0.0008206367492675781
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.0003390312194824219
mini_batch_src_global generation:  0.0002429485321044922
r_  generation:  0.002931833267211914
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  0.00026535987854003906
r_  generation:  0.0019953250885009766
local_output_nid generation:  8.177757263183594e-05
local_in_edges_tensor generation:  0.0002605915069580078
mini_batch_src_global generation:  0.00029468536376953125
r_  generation:  0.003237009048461914
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  0.00020051002502441406
r_  generation:  0.0016121864318847656
----------------------check_connections_block total spend ----------------------------- 0.015377998352050781
generate_one_block  0.004977703094482422
generate_one_block  0.003426790237426758
generate_one_block  0.005152463912963867
generate_one_block  0.002791881561279297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

connection checking time:  0.01829671859741211
block generation total time  0.02272319793701172
average batch blocks generation time:  0.00568079948425293
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009429931640625  GigaBytes
Max Memory Allocated: 0.009429931640625  GigaBytes

torch.Size([4235, 500])
torch.Size([925, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012969017028808594  GigaBytes
Max Memory Allocated: 0.016196250915527344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009383678436279297  GigaBytes
Max Memory Allocated: 0.017217159271240234  GigaBytes

torch.Size([3446, 500])
torch.Size([571, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011467456817626953  GigaBytes
Max Memory Allocated: 0.017217159271240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010890483856201172  GigaBytes
Max Memory Allocated: 0.017217159271240234  GigaBytes

torch.Size([3842, 500])
torch.Size([1021, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01455068588256836  GigaBytes
Max Memory Allocated: 0.017563343048095703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.007747173309326172  GigaBytes
Max Memory Allocated: 0.017563343048095703  GigaBytes

torch.Size([2574, 500])
torch.Size([535, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.009694576263427734  GigaBytes
Max Memory Allocated: 0.017563343048095703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007532238960266113 |0.08649289608001709 |0.19409435987472534 |0.00016510486602783203 |0.003555893898010254 |0.002248048782348633 |
----------------------------------------------------------pseudo_mini_loss sum 2.861569881439209
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17505
Number of first layer input nodes during this epoch:  14097
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.010751724243164062  GigaBytes
Max Memory Allocated: 0.017563343048095703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005326271057128906
random selection method range initialization spend 0.00011515617370605469
time for parepare:  5.269050598144531e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.5299530029296875e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00012230873107910156
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.649162292480469e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.792213439941406e-05
----------------------check_connections_block total spend ----------------------------- 0.0012018680572509766
generate_one_block  0.0013093948364257812
generate_one_block  0.0012514591217041016
generate_one_block  0.0013818740844726562
generate_one_block  0.0012502670288085938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006086826324462891
gen group dst list time:  3.981590270996094e-05
time for parepare:  0.0003082752227783203
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00030994415283203125
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.00044226646423339844
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00042700767517089844
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00043129920959472656
----------------------check_connections_block total spend ----------------------------- 0.0033783912658691406
generate_one_block  0.0016350746154785156
generate_one_block  0.0017502307891845703
generate_one_block  0.0017538070678710938
generate_one_block  0.0017268657684326172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012576580047607422
gen group dst list time:  0.00010323524475097656
time for parepare:  0.0008921623229980469
local_output_nid generation:  6.628036499023438e-05
local_in_edges_tensor generation:  0.00035953521728515625
mini_batch_src_global generation:  0.0002465248107910156
r_  generation:  0.0022945404052734375
local_output_nid generation:  8.845329284667969e-05
local_in_edges_tensor generation:  0.00027823448181152344
mini_batch_src_global generation:  0.00043129920959472656
r_  generation:  0.003092527389526367
local_output_nid generation:  9.322166442871094e-05
local_in_edges_tensor generation:  0.0002796649932861328
mini_batch_src_global generation:  0.00038933753967285156
r_  generation:  0.0033614635467529297
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.0002722740173339844
mini_batch_src_global generation:  0.00022149085998535156
r_  generation:  0.002004384994506836
----------------------check_connections_block total spend ----------------------------- 0.01757359504699707
generate_one_block  0.0036280155181884766
generate_one_block  0.004188060760498047
generate_one_block  0.004471302032470703
generate_one_block  0.0033464431762695312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.010751724243164062  GigaBytes
Max Memory Allocated: 0.017563343048095703  GigaBytes

connection checking time:  0.02095198631286621
block generation total time  0.022499799728393555
average batch blocks generation time:  0.005624949932098389
block dataloader generation time/epoch 0.06171894073486328
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.011677742004394531  GigaBytes
Max Memory Allocated: 0.017563343048095703  GigaBytes

torch.Size([3119, 500])
torch.Size([619, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.013939380645751953  GigaBytes
Max Memory Allocated: 0.017563343048095703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.012723922729492188  GigaBytes
Max Memory Allocated: 0.018458843231201172  GigaBytes

torch.Size([3670, 500])
torch.Size([801, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015680313110351562  GigaBytes
Max Memory Allocated: 0.01858806610107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01293182373046875  GigaBytes
Max Memory Allocated: 0.019684314727783203  GigaBytes

torch.Size([3777, 500])
torch.Size([799, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.0158538818359375  GigaBytes
Max Memory Allocated: 0.019684314727783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.012705802917480469  GigaBytes
Max Memory Allocated: 0.019684314727783203  GigaBytes

torch.Size([3206, 500])
torch.Size([825, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01576709747314453  GigaBytes
Max Memory Allocated: 0.019684314727783203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002126753330230713 |0.0004423856735229492 |0.0032828450202941895 |0.00011813640594482422 |0.002509474754333496 |0.001451253890991211 |
----------------------------------------------------------pseudo_mini_loss sum 1.0694398880004883
Total (block generation + training)time/epoch 0.10202670097351074
Training time/epoch 0.040038108825683594
Training time without block to device /epoch 0.0382685661315918
Training time without total dataloading part /epoch 0.02509307861328125
load block tensor time/epoch 0.008507013320922852
block to device time/epoch 0.0017695426940917969
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17172
Number of first layer input nodes during this epoch:  13772
