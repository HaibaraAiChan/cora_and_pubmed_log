main start at this time 1648526753.4052804
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002992391586303711
random selection method range initialization spend 0.00022125244140625
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.001171112060546875
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.1444091796875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.4781951904296875e-05
----------------------check_connections_block total spend ----------------------------- 0.0038738250732421875
generate_one_block  0.0012271404266357422
generate_one_block  0.0010302066802978516
generate_one_block  0.001047372817993164
generate_one_block  0.0010523796081542969
generate_one_block  0.001003265380859375
generate_one_block  0.0010137557983398438
generate_one_block  0.001007080078125
generate_one_block  0.0010001659393310547
generate_one_block  0.0010418891906738281
generate_one_block  0.0010378360748291016
generate_one_block  0.0010347366333007812
generate_one_block  0.0010116100311279297
generate_one_block  0.001039266586303711
generate_one_block  0.0010230541229248047
generate_one_block  0.0009620189666748047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002002239227294922
gen group dst list time:  7.891654968261719e-05
time for parepare:  0.0002346038818359375
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0001087188720703125
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.082389831542969e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0002753734588623047
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.14984130859375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  8.58306884765625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00029468536376953125
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00010061264038085938
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.937980651855469e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  8.106231689453125e-05
----------------------check_connections_block total spend ----------------------------- 0.004502296447753906
generate_one_block  0.0011403560638427734
generate_one_block  0.0010998249053955078
generate_one_block  0.0010569095611572266
generate_one_block  0.0013918876647949219
generate_one_block  0.001065969467163086
generate_one_block  0.0010712146759033203
generate_one_block  0.0011157989501953125
generate_one_block  0.0011560916900634766
generate_one_block  0.0010008811950683594
generate_one_block  0.0009942054748535156
generate_one_block  0.0013453960418701172
generate_one_block  0.0010826587677001953
generate_one_block  0.0010480880737304688
generate_one_block  0.00098419189453125
generate_one_block  0.0010569095611572266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011048316955566406
gen group dst list time:  0.0001220703125
time for parepare:  0.0007238388061523438
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0002455711364746094
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0005147457122802734
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0002532005310058594
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00015211105346679688
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.00016760826110839844
r_  generation:  0.0019233226776123047
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0003540515899658203
mini_batch_src_global generation:  8.20159912109375e-05
r_  generation:  0.0002186298370361328
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00029206275939941406
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004494190216064453
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.000453948974609375
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.000125885009765625
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00018095970153808594
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.00016379356384277344
r_  generation:  0.0018467903137207031
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0005068778991699219
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.00031447410583496094
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  9.72747802734375e-05
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.0005176067352294922
----------------------check_connections_block total spend ----------------------------- 0.014510154724121094
generate_one_block  0.001847982406616211
generate_one_block  0.0012810230255126953
generate_one_block  0.0011401176452636719
generate_one_block  0.003495454788208008
generate_one_block  0.0011835098266601562
generate_one_block  0.0012943744659423828
generate_one_block  0.0015227794647216797
generate_one_block  0.0014693737030029297
generate_one_block  0.001073598861694336
generate_one_block  0.0011394023895263672
generate_one_block  0.0032732486724853516
generate_one_block  0.0015342235565185547
generate_one_block  0.0013186931610107422
generate_one_block  0.0010385513305664062
generate_one_block  0.0018815994262695312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

connection checking time:  0.019012451171875
block generation total time  0.04110431671142578
average batch blocks generation time:  0.002740287780761719
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.003658294677734375  GigaBytes
Max Memory Allocated: 0.003658294677734375  GigaBytes

torch.Size([1173, 500])
torch.Size([181, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004370212554931641  GigaBytes
Max Memory Allocated: 0.00531005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0037527084350585938  GigaBytes
Max Memory Allocated: 0.006270408630371094  GigaBytes

torch.Size([448, 500])
torch.Size([105, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004264354705810547  GigaBytes
Max Memory Allocated: 0.006270408630371094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0033617019653320312  GigaBytes
Max Memory Allocated: 0.006270408630371094  GigaBytes

torch.Size([240, 500])
torch.Size([84, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0036787986755371094  GigaBytes
Max Memory Allocated: 0.006270408630371094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.009139060974121094  GigaBytes
Max Memory Allocated: 0.009528636932373047  GigaBytes

torch.Size([3313, 500])
torch.Size([618, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011403560638427734  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003455638885498047  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([290, 500])
torch.Size([105, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0038309097290039062  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003906726837158203  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([530, 500])
torch.Size([104, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004294395446777344  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004384517669677734  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([784, 500])
torch.Size([139, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0049190521240234375  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004290580749511719  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([734, 500])
torch.Size([197, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0049877166748046875  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0033283233642578125  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([222, 500])
torch.Size([54, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0035886764526367188  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0035338401794433594  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([332, 500])
torch.Size([77, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0038385391235351562  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007681369781494141  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([2531, 500])
torch.Size([649, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.009953022003173828  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004475593566894531  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([832, 500])
torch.Size([162, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.005095481872558594  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003933429718017578  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([544, 500])
torch.Size([151, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004485130310058594  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0032100677490234375  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([159, 500])
torch.Size([49, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0034055709838867188  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004878044128417969  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([1048, 500])
torch.Size([184, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.005553722381591797  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0012434005737304687 |0.023291603724161784 |0.05443909962972005 |0.0001423199971516927 |0.0023143609364827474 |0.002340078353881836 |
----------------------------------------------------------pseudo_mini_loss sum 2.6762237548828125
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16396
Number of first layer input nodes during this epoch:  13180
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007820606231689453  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00046515464782714844
random selection method range initialization spend 0.00010657310485839844
time for parepare:  4.4345855712890625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.7881393432617188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2172927856445312e-05
----------------------check_connections_block total spend ----------------------------- 0.002701997756958008
generate_one_block  0.001157999038696289
generate_one_block  0.0010139942169189453
generate_one_block  0.0010247230529785156
generate_one_block  0.0010051727294921875
generate_one_block  0.0009899139404296875
generate_one_block  0.0012021064758300781
generate_one_block  0.0010056495666503906
generate_one_block  0.0009865760803222656
generate_one_block  0.0009946823120117188
generate_one_block  0.0010085105895996094
generate_one_block  0.0009424686431884766
generate_one_block  0.0009429454803466797
generate_one_block  0.0009391307830810547
generate_one_block  0.0010039806365966797
generate_one_block  0.0009779930114746094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006020069122314453
gen group dst list time:  7.534027099609375e-05
time for parepare:  0.00023651123046875
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.2479248046875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  5.459785461425781e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  9.584426879882812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00016236305236816406
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00013399124145507812
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.9604644775390625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00016641616821289062
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.459785461425781e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.677078247070312e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.677078247070312e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  0.00010943412780761719
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00011587142944335938
----------------------check_connections_block total spend ----------------------------- 0.0044362545013427734
generate_one_block  0.0011479854583740234
generate_one_block  0.0010716915130615234
generate_one_block  0.0011587142944335938
generate_one_block  0.0011069774627685547
generate_one_block  0.001251220703125
generate_one_block  0.0011591911315917969
generate_one_block  0.0010304450988769531
generate_one_block  0.0010914802551269531
generate_one_block  0.0012443065643310547
generate_one_block  0.0010869503021240234
generate_one_block  0.0010259151458740234
generate_one_block  0.0010952949523925781
generate_one_block  0.0011022090911865234
generate_one_block  0.0011146068572998047
generate_one_block  0.0011932849884033203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011229515075683594
gen group dst list time:  0.00013303756713867188
time for parepare:  0.0007307529449462891
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0002684593200683594
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0003788471221923828
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0003762245178222656
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0005946159362792969
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0004558563232421875
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  0.0001366138458251953
r_  generation:  0.0012295246124267578
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.0007655620574951172
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.00016951560974121094
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00046825408935546875
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.0012776851654052734
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0003345012664794922
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00020503997802734375
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0003478527069091797
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.00039505958557128906
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.000469207763671875
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0007042884826660156
----------------------check_connections_block total spend ----------------------------- 0.01525259017944336
generate_one_block  0.002033710479736328
generate_one_block  0.0016560554504394531
generate_one_block  0.0017518997192382812
generate_one_block  0.001529693603515625
generate_one_block  0.0024580955505371094
generate_one_block  0.002007722854614258
generate_one_block  0.0011637210845947266
generate_one_block  0.0016791820526123047
generate_one_block  0.002541065216064453
generate_one_block  0.0013878345489501953
generate_one_block  0.0011715888977050781
generate_one_block  0.001398324966430664
generate_one_block  0.0014312267303466797
generate_one_block  0.001512765884399414
generate_one_block  0.0018851757049560547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007820606231689453  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

connection checking time:  0.019688844680786133
block generation total time  0.04248833656311035
average batch blocks generation time:  0.0028325557708740235
block dataloader generation time/epoch 0.09552478790283203
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006955146789550781  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([607, 500])
torch.Size([130, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007443428039550781  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0077762603759765625  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([857, 500])
torch.Size([99, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008162975311279297  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007916927337646484  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([1120, 500])
torch.Size([195, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008645057678222656  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007779121398925781  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([702, 500])
torch.Size([200, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008490562438964844  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00889730453491211  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([1637, 500])
torch.Size([320, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010079383850097656  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008393287658691406  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([1373, 500])
torch.Size([305, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009524822235107422  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00634002685546875  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([280, 500])
torch.Size([87, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00667572021484375  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007900238037109375  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([1113, 500])
torch.Size([121, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008369922637939453  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008329391479492188  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([1330, 500])
torch.Size([331, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009529590606689453  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006765842437744141  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([506, 500])
torch.Size([169, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007397651672363281  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006486415863037109  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([358, 500])
torch.Size([97, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006862163543701172  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006850719451904297  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([551, 500])
torch.Size([137, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007372379302978516  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007055759429931641  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([661, 500])
torch.Size([181, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007689476013183594  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007435321807861328  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

torch.Size([864, 500])
torch.Size([175, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008210182189941406  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008203983306884766  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes
Using backend: pytorch

torch.Size([1273, 500])
torch.Size([307, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009294509887695312  GigaBytes
Max Memory Allocated: 0.01412200927734375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0006805578867594401 |0.00041605631510416665 |0.0032819430033365887 |0.00012057622273763021 |0.0031180381774902344 |0.0016248226165771484 |
----------------------------------------------------------pseudo_mini_loss sum 0.8752540349960327
Total (block generation + training)time/epoch 0.22946596145629883
Training time/epoch 0.13361859321594238
Training time without block to device /epoch 0.12737774848937988
Training time without total dataloading part /epoch 0.09943318367004395
load block tensor time/epoch 0.010208368301391602
block to device time/epoch 0.0062408447265625
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16442
Number of first layer input nodes during this epoch:  13232
