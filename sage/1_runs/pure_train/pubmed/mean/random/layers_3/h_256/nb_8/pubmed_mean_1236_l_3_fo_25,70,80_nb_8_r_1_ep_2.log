main start at this time 1648526783.4107437
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0016732215881347656
random selection method range initialization spend 0.00017881393432617188
time for parepare:  4.410743713378906e-05
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0016770362854003906
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.765655517578125e-05
----------------------check_connections_block total spend ----------------------------- 0.00270843505859375
generate_one_block  0.0013358592987060547
generate_one_block  0.0011103153228759766
generate_one_block  0.0011665821075439453
generate_one_block  0.00109100341796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009233951568603516
gen group dst list time:  3.910064697265625e-05
time for parepare:  0.00024628639221191406
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0004401206970214844
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00023245811462402344
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004706382751464844
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00022411346435546875
----------------------check_connections_block total spend ----------------------------- 0.0028591156005859375
generate_one_block  0.0016796588897705078
generate_one_block  0.0013756752014160156
generate_one_block  0.001680612564086914
generate_one_block  0.00136566162109375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009875297546386719
gen group dst list time:  7.43865966796875e-05
time for parepare:  0.0007596015930175781
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.0003452301025390625
mini_batch_src_global generation:  0.0002040863037109375
r_  generation:  0.002552509307861328
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  0.00021314620971679688
r_  generation:  0.0016858577728271484
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.0002503395080566406
mini_batch_src_global generation:  0.00023484230041503906
r_  generation:  0.0027680397033691406
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.00017571449279785156
r_  generation:  0.0013957023620605469
----------------------check_connections_block total spend ----------------------------- 0.013380765914916992
generate_one_block  0.004649639129638672
generate_one_block  0.0030705928802490234
generate_one_block  0.0050928592681884766
generate_one_block  0.0026330947875976562
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

connection checking time:  0.01623988151550293
block generation total time  0.021547794342041016
average batch blocks generation time:  0.005386948585510254
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.008740901947021484  GigaBytes
Max Memory Allocated: 0.008740901947021484  GigaBytes

torch.Size([3870, 500])
torch.Size([925, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012270450592041016  GigaBytes
Max Memory Allocated: 0.015149593353271484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008458137512207031  GigaBytes
Max Memory Allocated: 0.015619754791259766  GigaBytes

torch.Size([2953, 500])
torch.Size([568, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.010524749755859375  GigaBytes
Max Memory Allocated: 0.015619754791259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0098114013671875  GigaBytes
Max Memory Allocated: 0.015619754791259766  GigaBytes

torch.Size([3540, 500])
torch.Size([1021, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013459205627441406  GigaBytes
Max Memory Allocated: 0.016183853149414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.007428646087646484  GigaBytes
Max Memory Allocated: 0.016183853149414062  GigaBytes

torch.Size([2405, 500])
torch.Size([536, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.00937509536743164  GigaBytes
Max Memory Allocated: 0.016183853149414062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009564816951751709 |0.08720964193344116 |0.19198912382125854 |0.00017189979553222656 |0.0035909414291381836 |0.002028226852416992 |
----------------------------------------------------------pseudo_mini_loss sum 2.918471574783325
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16174
Number of first layer input nodes during this epoch:  12768
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.010424613952636719  GigaBytes
Max Memory Allocated: 0.016183853149414062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004642009735107422
random selection method range initialization spend 0.00010156631469726562
time for parepare:  4.267692565917969e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00010275840759277344
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.0531158447265625e-05
----------------------check_connections_block total spend ----------------------------- 0.0010347366333007812
generate_one_block  0.0011029243469238281
generate_one_block  0.0010590553283691406
generate_one_block  0.0011641979217529297
generate_one_block  0.0010328292846679688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000514984130859375
gen group dst list time:  3.147125244140625e-05
time for parepare:  0.00024580955505371094
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.0002562999725341797
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0003604888916015625
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0003497600555419922
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.00034999847412109375
----------------------check_connections_block total spend ----------------------------- 0.002791166305541992
generate_one_block  0.0013549327850341797
generate_one_block  0.0014486312866210938
generate_one_block  0.0014510154724121094
generate_one_block  0.0014300346374511719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009784698486328125
gen group dst list time:  8.20159912109375e-05
time for parepare:  0.0007014274597167969
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00030875205993652344
mini_batch_src_global generation:  0.0001780986785888672
r_  generation:  0.0016713142395019531
local_output_nid generation:  6.532669067382812e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.00030541419982910156
r_  generation:  0.002260446548461914
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  0.00023937225341796875
r_  generation:  0.0024003982543945312
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  0.00019407272338867188
r_  generation:  0.0018336772918701172
----------------------check_connections_block total spend ----------------------------- 0.013246774673461914
generate_one_block  0.003320932388305664
generate_one_block  0.0038933753967285156
generate_one_block  0.004721879959106445
generate_one_block  0.003129243850708008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.010424613952636719  GigaBytes
Max Memory Allocated: 0.016183853149414062  GigaBytes

connection checking time:  0.016037940979003906
block generation total time  0.020750045776367188
average batch blocks generation time:  0.005187511444091797
block dataloader generation time/epoch 0.05256056785583496
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.011046886444091797  GigaBytes
Max Memory Allocated: 0.016183853149414062  GigaBytes

torch.Size([2784, 500])
torch.Size([619, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.013301849365234375  GigaBytes
Max Memory Allocated: 0.016183853149414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.012167930603027344  GigaBytes
Max Memory Allocated: 0.017287254333496094  GigaBytes

torch.Size([3376, 500])
torch.Size([801, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.015115737915039062  GigaBytes
Max Memory Allocated: 0.018100738525390625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.012446403503417969  GigaBytes
Max Memory Allocated: 0.018663883209228516  GigaBytes

torch.Size([3523, 500])
torch.Size([795, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.015343666076660156  GigaBytes
Max Memory Allocated: 0.018663883209228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.011417865753173828  GigaBytes
Max Memory Allocated: 0.018663883209228516  GigaBytes

torch.Size([2981, 500])
torch.Size([825, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01447439193725586  GigaBytes
Max Memory Allocated: 0.018663883209228516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001976490020751953 |0.0004162788391113281 |0.0032012462615966797 |0.00011539459228515625 |0.0025129318237304688 |0.0014619827270507812 |
----------------------------------------------------------pseudo_mini_loss sum 1.0779743194580078
Total (block generation + training)time/epoch 0.09163331985473633
Training time/epoch 0.03882765769958496
Training time without block to device /epoch 0.03716254234313965
Training time without total dataloading part /epoch 0.0247802734375
load block tensor time/epoch 0.007905960083007812
block to device time/epoch 0.0016651153564453125
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16060
Number of first layer input nodes during this epoch:  12664
