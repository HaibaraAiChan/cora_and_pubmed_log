main start at this time 1648526703.405907
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002032041549682617
random selection method range initialization spend 0.000186920166015625
time for parepare:  5.054473876953125e-05
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.0013859272003173828
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.2159347534179688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5974044799804688e-05
----------------------check_connections_block total spend ----------------------------- 0.004475593566894531
generate_one_block  0.0014293193817138672
generate_one_block  0.0012233257293701172
generate_one_block  0.0011606216430664062
generate_one_block  0.0011968612670898438
generate_one_block  0.001157999038696289
generate_one_block  0.0011637210845947266
generate_one_block  0.0011594295501708984
generate_one_block  0.0010097026824951172
generate_one_block  0.001024484634399414
generate_one_block  0.0009801387786865234
generate_one_block  0.001005411148071289
generate_one_block  0.0009918212890625
generate_one_block  0.000989675521850586
generate_one_block  0.0009758472442626953
generate_one_block  0.0009794235229492188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001119375228881836
gen group dst list time:  0.00010037422180175781
time for parepare:  0.00027489662170410156
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00011420249938964844
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  9.584426879882812e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.839897155761719e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0003371238708496094
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.91278076171875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  7.557868957519531e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  9.751319885253906e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.364418029785156e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.14984130859375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0003299713134765625
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00011539459228515625
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  9.34600830078125e-05
----------------------check_connections_block total spend ----------------------------- 0.005162954330444336
generate_one_block  0.0013484954833984375
generate_one_block  0.0012576580047607422
generate_one_block  0.0012078285217285156
generate_one_block  0.0016477108001708984
generate_one_block  0.0012221336364746094
generate_one_block  0.0012004375457763672
generate_one_block  0.0010764598846435547
generate_one_block  0.0010864734649658203
generate_one_block  0.0009713172912597656
generate_one_block  0.0009882450103759766
generate_one_block  0.0013134479522705078
generate_one_block  0.0010654926300048828
generate_one_block  0.00102996826171875
generate_one_block  0.0009644031524658203
generate_one_block  0.00103759765625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011091232299804688
gen group dst list time:  0.00015473365783691406
time for parepare:  0.0008802413940429688
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0003135204315185547
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0006067752838134766
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.00029730796813964844
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00017333030700683594
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.0002315044403076172
mini_batch_src_global generation:  0.0002281665802001953
r_  generation:  0.0023932456970214844
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00041556358337402344
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0002655982971191406
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.0003478527069091797
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0005202293395996094
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0005571842193603516
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0001506805419921875
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0002090930938720703
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.00022602081298828125
r_  generation:  0.002254962921142578
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  0.00011515617370605469
r_  generation:  0.0005083084106445312
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0003211498260498047
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  9.632110595703125e-05
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0005290508270263672
----------------------check_connections_block total spend ----------------------------- 0.017119407653808594
generate_one_block  0.0017273426055908203
generate_one_block  0.0012848377227783203
generate_one_block  0.00110626220703125
generate_one_block  0.003568410873413086
generate_one_block  0.0011942386627197266
generate_one_block  0.0012969970703125
generate_one_block  0.001528024673461914
generate_one_block  0.0014793872833251953
generate_one_block  0.0010838508605957031
generate_one_block  0.0011441707611083984
generate_one_block  0.003266572952270508
generate_one_block  0.0015232563018798828
generate_one_block  0.0013196468353271484
generate_one_block  0.0010325908660888672
generate_one_block  0.0018992424011230469
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014562606811523438  GigaBytes
Max Memory Allocated: 0.0014562606811523438  GigaBytes

connection checking time:  0.02228236198425293
block generation total time  0.041872501373291016
average batch blocks generation time:  0.0027915000915527343
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.003673076629638672  GigaBytes
Max Memory Allocated: 0.003673076629638672  GigaBytes

torch.Size([1181, 500])
torch.Size([181, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0043849945068359375  GigaBytes
Max Memory Allocated: 0.005332469940185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0037474632263183594  GigaBytes
Max Memory Allocated: 0.006292819976806641  GigaBytes

torch.Size([445, 500])
torch.Size([105, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0042591094970703125  GigaBytes
Max Memory Allocated: 0.006292819976806641  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0033712387084960938  GigaBytes
Max Memory Allocated: 0.006292819976806641  GigaBytes

torch.Size([245, 500])
torch.Size([84, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003688335418701172  GigaBytes
Max Memory Allocated: 0.006292819976806641  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.009105682373046875  GigaBytes
Max Memory Allocated: 0.00950479507446289  GigaBytes

torch.Size([3295, 500])
torch.Size([621, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011379718780517578  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0034661293029785156  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([295, 500])
torch.Size([105, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0038423538208007812  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003902912139892578  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([528, 500])
torch.Size([104, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004290580749511719  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004378795623779297  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([781, 500])
torch.Size([138, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004909992218017578  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004335880279541016  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([758, 500])
torch.Size([196, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.005030632019042969  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003333568572998047  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([225, 500])
torch.Size([54, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003593921661376953  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003543376922607422  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([337, 500])
torch.Size([77, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0038480758666992188  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007700920104980469  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([2542, 500])
torch.Size([646, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.009962081909179688  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004472255706787109  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([830, 500])
torch.Size([162, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.005092144012451172  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003916740417480469  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([535, 500])
torch.Size([150, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0044651031494140625  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003211498260498047  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([160, 500])
torch.Size([49, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003407001495361328  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004961967468261719  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([1093, 500])
torch.Size([184, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.005637645721435547  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0024676163991292316 |0.024345604578653972 |0.054376649856567386 |0.00014400482177734375 |0.003158378601074219 |0.002288818359375 |
----------------------------------------------------------pseudo_mini_loss sum 2.672069549560547
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16463
Number of first layer input nodes during this epoch:  13250
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007904529571533203  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00045228004455566406
random selection method range initialization spend 0.00010275840759277344
time for parepare:  4.506111145019531e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.3126602172851562e-05
----------------------check_connections_block total spend ----------------------------- 0.0026628971099853516
generate_one_block  0.0010762214660644531
generate_one_block  0.0010178089141845703
generate_one_block  0.0009889602661132812
generate_one_block  0.0010247230529785156
generate_one_block  0.0010178089141845703
generate_one_block  0.0011904239654541016
generate_one_block  0.0010099411010742188
generate_one_block  0.0010075569152832031
generate_one_block  0.0009949207305908203
generate_one_block  0.0009899139404296875
generate_one_block  0.0010006427764892578
generate_one_block  0.0009686946868896484
generate_one_block  0.0009405612945556641
generate_one_block  0.0009636878967285156
generate_one_block  0.0010218620300292969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006160736083984375
gen group dst list time:  7.62939453125e-05
time for parepare:  0.0002357959747314453
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.364418029785156e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  9.369850158691406e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0001621246337890625
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001327991485595703
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001647472381591797
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.677078247070312e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.653236389160156e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  0.00011038780212402344
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0001163482666015625
----------------------check_connections_block total spend ----------------------------- 0.0044019222259521484
generate_one_block  0.0010836124420166016
generate_one_block  0.0010731220245361328
generate_one_block  0.0011911392211914062
generate_one_block  0.0011069774627685547
generate_one_block  0.0012204647064208984
generate_one_block  0.0011796951293945312
generate_one_block  0.001026153564453125
generate_one_block  0.0010478496551513672
generate_one_block  0.0012471675872802734
generate_one_block  0.0010933876037597656
generate_one_block  0.0009944438934326172
generate_one_block  0.0010399818420410156
generate_one_block  0.0010330677032470703
generate_one_block  0.0010519027709960938
generate_one_block  0.0011148452758789062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010437965393066406
gen group dst list time:  0.0001220703125
time for parepare:  0.0007288455963134766
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0002491474151611328
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0003674030303955078
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0003695487976074219
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0006206035614013672
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0004546642303466797
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0011475086212158203
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.000728607177734375
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00016927719116210938
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.0004558563232421875
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  0.00011920928955078125
r_  generation:  0.0012583732604980469
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0003361701965332031
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.0002090930938720703
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0003390312194824219
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.00037670135498046875
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0004658699035644531
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0007116794586181641
----------------------check_connections_block total spend ----------------------------- 0.014853954315185547
generate_one_block  0.0016758441925048828
generate_one_block  0.0014438629150390625
generate_one_block  0.001806020736694336
generate_one_block  0.001443624496459961
generate_one_block  0.0023679733276367188
generate_one_block  0.0018055438995361328
generate_one_block  0.0011379718780517578
generate_one_block  0.0015788078308105469
generate_one_block  0.002410888671875
generate_one_block  0.0013093948364257812
generate_one_block  0.0011742115020751953
generate_one_block  0.001333475112915039
generate_one_block  0.0013818740844726562
generate_one_block  0.0015225410461425781
generate_one_block  0.0023369789123535156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007904529571533203  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

connection checking time:  0.019255876541137695
block generation total time  0.04123282432556152
average batch blocks generation time:  0.0027488549550374348
block dataloader generation time/epoch 0.09300422668457031
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006956577301025391  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([608, 500])
torch.Size([130, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007444858551025391  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007860183715820312  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([866, 500])
torch.Size([99, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008246898651123047  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007924556732177734  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([1124, 500])
torch.Size([196, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008655548095703125  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007863044738769531  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([703, 500])
torch.Size([199, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008571624755859375  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008946895599365234  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([1663, 500])
torch.Size([316, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010117530822753906  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008317947387695312  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([1333, 500])
torch.Size([305, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009448528289794922  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00634765625  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([284, 500])
torch.Size([87, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006683349609375  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007948875427246094  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([1139, 500])
torch.Size([121, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008418560028076172  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008301258087158203  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([1315, 500])
torch.Size([335, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00951385498046875  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006762027740478516  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([504, 500])
torch.Size([169, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007393836975097656  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006505012512207031  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([368, 500])
torch.Size([98, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0068836212158203125  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006841182708740234  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([546, 500])
torch.Size([137, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007362842559814453  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0070667266845703125  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([667, 500])
torch.Size([183, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007706642150878906  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007437229156494141  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

torch.Size([865, 500])
torch.Size([175, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008212089538574219  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00815725326538086  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes
Using backend: pytorch

torch.Size([1248, 500])
torch.Size([307, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009247779846191406  GigaBytes
Max Memory Allocated: 0.014080047607421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0006837685902913412 |0.00040532747904459634 |0.0031908512115478515 |0.00011644363403320312 |0.0030662218729654946 |0.0016350746154785156 |
----------------------------------------------------------pseudo_mini_loss sum 0.9145223498344421
Total (block generation + training)time/epoch 0.22394251823425293
Training time/epoch 0.13068556785583496
Training time without block to device /epoch 0.12460565567016602
Training time without total dataloading part /epoch 0.09723782539367676
load block tensor time/epoch 0.010256528854370117
block to device time/epoch 0.006079912185668945
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16446
Number of first layer input nodes during this epoch:  13233
