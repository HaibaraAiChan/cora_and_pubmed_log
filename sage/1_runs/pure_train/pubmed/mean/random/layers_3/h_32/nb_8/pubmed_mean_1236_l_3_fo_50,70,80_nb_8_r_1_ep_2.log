main start at this time 1648526233.439821
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.003235340118408203
random selection method range initialization spend 0.00017690658569335938
time for parepare:  5.125999450683594e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.001065969467163086
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.601478576660156e-05
----------------------check_connections_block total spend ----------------------------- 0.0021016597747802734
generate_one_block  0.0013015270233154297
generate_one_block  0.0010843276977539062
generate_one_block  0.0011174678802490234
generate_one_block  0.0010848045349121094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016155242919921875
gen group dst list time:  3.170967102050781e-05
time for parepare:  0.00023889541625976562
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.0001964569091796875
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002849102020263672
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  9.107589721679688e-05
r_  generation:  0.000492095947265625
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00034499168395996094
----------------------check_connections_block total spend ----------------------------- 0.0028107166290283203
generate_one_block  0.001318216323852539
generate_one_block  0.0014231204986572266
generate_one_block  0.0017058849334716797
generate_one_block  0.0015025138854980469
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010790824890136719
gen group dst list time:  7.62939453125e-05
time for parepare:  0.0007956027984619141
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00028967857360839844
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0014722347259521484
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  0.00020575523376464844
r_  generation:  0.0016074180603027344
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.000263214111328125
mini_batch_src_global generation:  0.00037169456481933594
r_  generation:  0.003298044204711914
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  0.0003249645233154297
r_  generation:  0.002420663833618164
----------------------check_connections_block total spend ----------------------------- 0.014308452606201172
generate_one_block  0.0029709339141845703
generate_one_block  0.0028595924377441406
generate_one_block  0.005100727081298828
generate_one_block  0.003937244415283203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

connection checking time:  0.017119169235229492
block generation total time  0.020818233489990234
average batch blocks generation time:  0.005204558372497559
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005395412445068359  GigaBytes
Max Memory Allocated: 0.005395412445068359  GigaBytes

torch.Size([2803, 500])
torch.Size([474, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005660057067871094  GigaBytes
Max Memory Allocated: 0.005939006805419922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0051288604736328125  GigaBytes
Max Memory Allocated: 0.010304927825927734  GigaBytes

torch.Size([2587, 500])
torch.Size([648, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005484580993652344  GigaBytes
Max Memory Allocated: 0.010304927825927734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007501125335693359  GigaBytes
Max Memory Allocated: 0.012219429016113281  GigaBytes

torch.Size([3831, 500])
torch.Size([1008, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008061408996582031  GigaBytes
Max Memory Allocated: 0.012219429016113281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007418632507324219  GigaBytes
Max Memory Allocated: 0.014486312866210938  GigaBytes

torch.Size([3804, 500])
torch.Size([830, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00786733627319336  GigaBytes
Max Memory Allocated: 0.014486312866210938  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00863957405090332 |0.08730244636535645 |0.1932295560836792 |0.00018835067749023438 |0.0031748414039611816 |0.0022711753845214844 |
----------------------------------------------------------pseudo_mini_loss sum 2.2730932235717773
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16340
Number of first layer input nodes during this epoch:  13025
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007837295532226562  GigaBytes
Max Memory Allocated: 0.014486312866210938  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005702972412109375
random selection method range initialization spend 0.0001327991485595703
time for parepare:  6.508827209472656e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00012683868408203125
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.457069396972656e-05
----------------------check_connections_block total spend ----------------------------- 0.0012707710266113281
generate_one_block  0.0013568401336669922
generate_one_block  0.0012471675872802734
generate_one_block  0.0014410018920898438
generate_one_block  0.0012538433074951172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006108283996582031
gen group dst list time:  4.4345855712890625e-05
time for parepare:  0.00033926963806152344
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  9.131431579589844e-05
r_  generation:  0.0006363391876220703
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0003609657287597656
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0004086494445800781
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0002627372741699219
----------------------check_connections_block total spend ----------------------------- 0.003509521484375
generate_one_block  0.0020575523376464844
generate_one_block  0.001634836196899414
generate_one_block  0.0017242431640625
generate_one_block  0.001539468765258789
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012369155883789062
gen group dst list time:  0.00010943412780761719
time for parepare:  0.0009980201721191406
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.0004413127899169922
mini_batch_src_global generation:  0.0005462169647216797
r_  generation:  0.004895687103271484
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  0.00036644935607910156
r_  generation:  0.0024247169494628906
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00025463104248046875
mini_batch_src_global generation:  0.00029540061950683594
r_  generation:  0.0024003982543945312
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  0.00015401840209960938
r_  generation:  0.0011403560638427734
----------------------check_connections_block total spend ----------------------------- 0.017851829528808594
generate_one_block  0.0059583187103271484
generate_one_block  0.003450155258178711
generate_one_block  0.0036668777465820312
generate_one_block  0.002329587936401367
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007837295532226562  GigaBytes
Max Memory Allocated: 0.014486312866210938  GigaBytes

connection checking time:  0.021361351013183594
block generation total time  0.022361040115356445
average batch blocks generation time:  0.005590260028839111
block dataloader generation time/epoch 0.062399864196777344
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010146141052246094  GigaBytes
Max Memory Allocated: 0.017116069793701172  GigaBytes

torch.Size([5104, 500])
torch.Size([1216, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010808467864990234  GigaBytes
Max Memory Allocated: 0.017116069793701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007664680480957031  GigaBytes
Max Memory Allocated: 0.017117023468017578  GigaBytes

torch.Size([3422, 500])
torch.Size([705, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008039474487304688  GigaBytes
Max Memory Allocated: 0.017117023468017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005741596221923828  GigaBytes
Max Memory Allocated: 0.017117023468017578  GigaBytes

torch.Size([2766, 500])
torch.Size([660, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00612640380859375  GigaBytes
Max Memory Allocated: 0.017117023468017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004287242889404297  GigaBytes
Max Memory Allocated: 0.017117023468017578  GigaBytes

torch.Size([2002, 500])
torch.Size([462, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004546165466308594  GigaBytes
Max Memory Allocated: 0.017117023468017578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0022200942039489746 |0.0006595253944396973 |0.004557192325592041 |0.00013887882232666016 |0.003260970115661621 |0.0016756057739257812 |
----------------------------------------------------------pseudo_mini_loss sum 1.880913496017456
Total (block generation + training)time/epoch 0.11478137969970703
Training time/epoch 0.051850318908691406
Training time without block to device /epoch 0.04921221733093262
Training time without total dataloading part /epoch 0.03350377082824707
load block tensor time/epoch 0.008880376815795898
block to device time/epoch 0.002638101577758789
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16694
Number of first layer input nodes during this epoch:  13294
