Using backend: pytorch
main start at this time 1648526163.3371844
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0017778873443603516
random selection method range initialization spend 0.00021791458129882812
time for parepare:  4.673004150390625e-05
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0026884078979492188
----------------------check_connections_block total spend ----------------------------- 0.0031261444091796875
generate_one_block  0.0015473365783691406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009379386901855469
gen group dst list time:  2.0503997802734375e-05
time for parepare:  0.0002472400665283203
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00024366378784179688
mini_batch_src_global generation:  0.00012540817260742188
r_  generation:  0.0013005733489990234
----------------------check_connections_block total spend ----------------------------- 0.00229644775390625
generate_one_block  0.0029077529907226562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009949207305908203
gen group dst list time:  5.745887756347656e-05
time for parepare:  0.0007338523864746094
local_output_nid generation:  0.00018262863159179688
local_in_edges_tensor generation:  0.0005590915679931641
mini_batch_src_global generation:  0.0005338191986083984
r_  generation:  0.006703615188598633
----------------------check_connections_block total spend ----------------------------- 0.010747671127319336
generate_one_block  0.010220527648925781
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

connection checking time:  0.013044118881225586
block generation total time  0.013128280639648438
average batch blocks generation time:  0.013128280639648438
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.015956401824951172  GigaBytes
Max Memory Allocated: 0.015956401824951172  GigaBytes

torch.Size([7929, 500])
torch.Size([2706, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.017413616180419922  GigaBytes
Max Memory Allocated: 0.018056392669677734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005427122116088867 |0.33515048027038574 |0.7633347511291504 |0.0002579689025878906 |0.008800506591796875 |0.004152774810791016 |
----------------------------------------------------------pseudo_mini_loss sum 2.082359790802002
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10989
Number of first layer input nodes during this epoch:  7929
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.016797542572021484  GigaBytes
Max Memory Allocated: 0.01813030242919922  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008060932159423828
random selection method range initialization spend 0.00017261505126953125
time for parepare:  7.772445678710938e-05
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.0003333091735839844
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0001842975616455078
----------------------check_connections_block total spend ----------------------------- 0.0008473396301269531
generate_one_block  0.0020973682403564453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007262229919433594
gen group dst list time:  2.6226043701171875e-05
time for parepare:  0.0003762245178222656
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00029397010803222656
mini_batch_src_global generation:  0.00021457672119140625
r_  generation:  0.0015168190002441406
----------------------check_connections_block total spend ----------------------------- 0.003164529800415039
generate_one_block  0.004944324493408203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0013990402221679688
gen group dst list time:  0.000118255615234375
time for parepare:  0.0009562969207763672
local_output_nid generation:  0.000263214111328125
local_in_edges_tensor generation:  0.0007536411285400391
mini_batch_src_global generation:  0.0008273124694824219
r_  generation:  0.0069255828857421875
----------------------check_connections_block total spend ----------------------------- 0.012189626693725586
generate_one_block  0.010497570037841797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.016797542572021484  GigaBytes
Max Memory Allocated: 0.01813030242919922  GigaBytes

connection checking time:  0.015354156494140625
block generation total time  0.01544189453125
average batch blocks generation time:  0.01544189453125
block dataloader generation time/epoch 0.05019855499267578
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.016346454620361328  GigaBytes
Max Memory Allocated: 0.03177356719970703  GigaBytes

torch.Size([7941, 500])
torch.Size([2703, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01780080795288086  GigaBytes
Max Memory Allocated: 0.03177356719970703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005463361740112305 |0.0005741119384765625 |0.0035390853881835938 |0.00014495849609375 |0.0054738521575927734 |0.0015194416046142578 |
----------------------------------------------------------pseudo_mini_loss sum 1.4742120504379272
Total (block generation + training)time/epoch 0.06860041618347168
Training time/epoch 0.018221616744995117
Training time without block to device /epoch 0.017647504806518555
Training time without total dataloading part /epoch 0.010677337646484375
load block tensor time/epoch 0.005463361740112305
block to device time/epoch 0.0005741119384765625
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10998
Number of first layer input nodes during this epoch:  7941
