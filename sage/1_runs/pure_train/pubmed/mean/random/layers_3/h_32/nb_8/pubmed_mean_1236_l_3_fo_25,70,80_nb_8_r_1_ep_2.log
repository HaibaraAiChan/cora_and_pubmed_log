main start at this time 1648526183.3328056
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0026934146881103516
random selection method range initialization spend 0.00018262863159179688
time for parepare:  4.00543212890625e-05
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  0.0010673999786376953
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.361701965332031e-05
----------------------check_connections_block total spend ----------------------------- 0.0020134449005126953
generate_one_block  0.0011515617370605469
generate_one_block  0.0010190010070800781
generate_one_block  0.0010602474212646484
generate_one_block  0.0010399818420410156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011320114135742188
gen group dst list time:  3.0994415283203125e-05
time for parepare:  0.00022482872009277344
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001862049102783203
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0002684593200683594
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.00045943260192871094
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.00031757354736328125
----------------------check_connections_block total spend ----------------------------- 0.0026092529296875
generate_one_block  0.0012385845184326172
generate_one_block  0.0013284683227539062
generate_one_block  0.0016524791717529297
generate_one_block  0.0013937950134277344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009477138519287109
gen group dst list time:  6.914138793945312e-05
time for parepare:  0.0007381439208984375
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00028133392333984375
mini_batch_src_global generation:  0.00011396408081054688
r_  generation:  0.0011444091796875
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00015878677368164062
r_  generation:  0.0014276504516601562
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.00024700164794921875
mini_batch_src_global generation:  0.00032401084899902344
r_  generation:  0.002718210220336914
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  0.0002117156982421875
r_  generation:  0.0019893646240234375
----------------------check_connections_block total spend ----------------------------- 0.012080669403076172
generate_one_block  0.0028839111328125
generate_one_block  0.0027382373809814453
generate_one_block  0.004638195037841797
generate_one_block  0.0035800933837890625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

connection checking time:  0.014689922332763672
block generation total time  0.019453763961791992
average batch blocks generation time:  0.004863440990447998
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0049591064453125  GigaBytes
Max Memory Allocated: 0.0049591064453125  GigaBytes

torch.Size([2571, 500])
torch.Size([473, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005219936370849609  GigaBytes
Max Memory Allocated: 0.005471229553222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004708766937255859  GigaBytes
Max Memory Allocated: 0.009455204010009766  GigaBytes

torch.Size([2363, 500])
torch.Size([648, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005061626434326172  GigaBytes
Max Memory Allocated: 0.009455204010009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0070018768310546875  GigaBytes
Max Memory Allocated: 0.01131439208984375  GigaBytes

torch.Size([3569, 500])
torch.Size([1008, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007550716400146484  GigaBytes
Max Memory Allocated: 0.01131439208984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006757259368896484  GigaBytes
Max Memory Allocated: 0.013344764709472656  GigaBytes

torch.Size([3453, 500])
torch.Size([830, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007198333740234375  GigaBytes
Max Memory Allocated: 0.013344764709472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0037700533866882324 |0.08551037311553955 |0.19455039501190186 |0.0001984238624572754 |0.003321230411529541 |0.0023050308227539062 |
----------------------------------------------------------pseudo_mini_loss sum 2.2711801528930664
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15270
Number of first layer input nodes during this epoch:  11956
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007159233093261719  GigaBytes
Max Memory Allocated: 0.013344764709472656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005736351013183594
random selection method range initialization spend 0.0001385211944580078
time for parepare:  5.91278076171875e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  8.106231689453125e-06
Using backend: pytorch
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.4809112548828125e-05
----------------------check_connections_block total spend ----------------------------- 0.0012748241424560547
generate_one_block  0.0013532638549804688
generate_one_block  0.0012595653533935547
generate_one_block  0.0014252662658691406
generate_one_block  0.0012507438659667969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006241798400878906
gen group dst list time:  4.458427429199219e-05
time for parepare:  0.0003368854522705078
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0006268024444580078
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0003440380096435547
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00040602684020996094
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00026226043701171875
----------------------check_connections_block total spend ----------------------------- 0.003462076187133789
generate_one_block  0.0020728111267089844
generate_one_block  0.0016448497772216797
generate_one_block  0.0017311573028564453
generate_one_block  0.001535654067993164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011830329895019531
gen group dst list time:  0.00010848045349121094
time for parepare:  0.0009036064147949219
local_output_nid generation:  0.00012087821960449219
local_in_edges_tensor generation:  0.00042319297790527344
mini_batch_src_global generation:  0.0005209445953369141
r_  generation:  0.0042078495025634766
local_output_nid generation:  7.915496826171875e-05
local_in_edges_tensor generation:  0.0002593994140625
mini_batch_src_global generation:  0.0002930164337158203
r_  generation:  0.0021181106567382812
local_output_nid generation:  7.152557373046875e-05
local_in_edges_tensor generation:  0.0002593994140625
mini_batch_src_global generation:  0.00023627281188964844
r_  generation:  0.0023860931396484375
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  0.00017213821411132812
r_  generation:  0.0011420249938964844
----------------------check_connections_block total spend ----------------------------- 0.016453027725219727
generate_one_block  0.005640268325805664
generate_one_block  0.003172636032104492
generate_one_block  0.003286600112915039
generate_one_block  0.0022246837615966797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007159233093261719  GigaBytes
Max Memory Allocated: 0.013344764709472656  GigaBytes

connection checking time:  0.019915103912353516
block generation total time  0.02130866050720215
average batch blocks generation time:  0.005327165126800537
block dataloader generation time/epoch 0.05994701385498047
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00946664810180664  GigaBytes
Max Memory Allocated: 0.015797138214111328  GigaBytes

torch.Size([4747, 500])
torch.Size([1214, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010114669799804688  GigaBytes
Max Memory Allocated: 0.015797138214111328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007004261016845703  GigaBytes
Max Memory Allocated: 0.015798091888427734  GigaBytes

torch.Size([3113, 500])
torch.Size([706, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007372379302978516  GigaBytes
Max Memory Allocated: 0.015798091888427734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0053234100341796875  GigaBytes
Max Memory Allocated: 0.015798091888427734  GigaBytes

torch.Size([2546, 500])
torch.Size([660, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005699634552001953  GigaBytes
Max Memory Allocated: 0.015798091888427734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0038390159606933594  GigaBytes
Max Memory Allocated: 0.015798091888427734  GigaBytes

torch.Size([1763, 500])
torch.Size([462, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0040950775146484375  GigaBytes
Max Memory Allocated: 0.015798091888427734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003720104694366455 |0.0006710290908813477 |0.004253208637237549 |0.00014024972915649414 |0.0035625100135803223 |0.0017523765563964844 |
----------------------------------------------------------pseudo_mini_loss sum 1.8332529067993164
Total (block generation + training)time/epoch 0.11833572387695312
Training time/epoch 0.05784940719604492
Training time without block to device /epoch 0.05516529083251953
Training time without total dataloading part /epoch 0.033576250076293945
load block tensor time/epoch 0.01488041877746582
block to device time/epoch 0.0026841163635253906
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15568
Number of first layer input nodes during this epoch:  12169
