main start at this time 1648526203.4218132
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002554655075073242
random selection method range initialization spend 0.00022268295288085938
time for parepare:  4.792213439941406e-05
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.002623319625854492
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.9087066650390625e-05
----------------------check_connections_block total spend ----------------------------- 0.005542278289794922
generate_one_block  0.0014102458953857422
generate_one_block  0.0011196136474609375
generate_one_block  0.0011234283447265625
generate_one_block  0.0010497570037841797
generate_one_block  0.0010535717010498047
generate_one_block  0.0010662078857421875
generate_one_block  0.0010650157928466797
generate_one_block  0.0010709762573242188
generate_one_block  0.001027822494506836
generate_one_block  0.000985860824584961
generate_one_block  0.0009970664978027344
generate_one_block  0.0009844303131103516
generate_one_block  0.000982046127319336
generate_one_block  0.000989675521850586
generate_one_block  0.000993490219116211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010216236114501953
gen group dst list time:  7.891654968261719e-05
time for parepare:  0.0002460479736328125
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00012350082397460938
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.649162292480469e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.58306884765625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001246929168701172
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001246929168701172
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00019550323486328125
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  7.414817810058594e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00019431114196777344
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00012183189392089844
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00014591217041015625
----------------------check_connections_block total spend ----------------------------- 0.0047283172607421875
generate_one_block  0.0012841224670410156
generate_one_block  0.001092672348022461
generate_one_block  0.0011048316955566406
generate_one_block  0.0011076927185058594
generate_one_block  0.0012104511260986328
generate_one_block  0.0011222362518310547
generate_one_block  0.0012347698211669922
generate_one_block  0.0012996196746826172
generate_one_block  0.0013775825500488281
generate_one_block  0.0011532306671142578
generate_one_block  0.0013184547424316406
generate_one_block  0.0011858940124511719
generate_one_block  0.001108407974243164
generate_one_block  0.001071929931640625
generate_one_block  0.0011627674102783203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011518001556396484
gen group dst list time:  0.00012612342834472656
time for parepare:  0.0007739067077636719
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0008089542388916016
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.00015997886657714844
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0002067089080810547
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00020432472229003906
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00024390220642089844
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0003993511199951172
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00021076202392578125
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0006222724914550781
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0008442401885986328
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.0001742839813232422
r_  generation:  0.0012896060943603516
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0003743171691894531
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.0013561248779296875
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.0006952285766601562
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.0004677772521972656
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00044417381286621094
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  8.845329284667969e-05
r_  generation:  0.0008568763732910156
----------------------check_connections_block total spend ----------------------------- 0.016377925872802734
generate_one_block  0.0022389888763427734
generate_one_block  0.0011527538299560547
generate_one_block  0.001219034194946289
generate_one_block  0.001226663589477539
generate_one_block  0.0014560222625732422
generate_one_block  0.001209259033203125
generate_one_block  0.0017554759979248047
generate_one_block  0.0020062923431396484
generate_one_block  0.002524137496948242
generate_one_block  0.0013306140899658203
generate_one_block  0.003349781036376953
generate_one_block  0.0017638206481933594
generate_one_block  0.0014989376068115234
generate_one_block  0.001499176025390625
generate_one_block  0.002290964126586914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

connection checking time:  0.021106243133544922
block generation total time  0.044356584548950195
average batch blocks generation time:  0.0029571056365966797
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0035424232482910156  GigaBytes
Max Memory Allocated: 0.0035424232482910156  GigaBytes

torch.Size([1817, 500])
torch.Size([240, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003685474395751953  GigaBytes
Max Memory Allocated: 0.00386810302734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0007405281066894531  GigaBytes
Max Memory Allocated: 0.004120826721191406  GigaBytes

torch.Size([253, 500])
torch.Size([58, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0007781982421875  GigaBytes
Max Memory Allocated: 0.004120826721191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0009675025939941406  GigaBytes
Max Memory Allocated: 0.004120826721191406  GigaBytes

torch.Size([374, 500])
torch.Size([90, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0010213851928710938  GigaBytes
Max Memory Allocated: 0.004120826721191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010533332824707031  GigaBytes
Max Memory Allocated: 0.004120826721191406  GigaBytes

torch.Size([420, 500])
torch.Size([98, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011105537414550781  GigaBytes
Max Memory Allocated: 0.004120826721191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0014967918395996094  GigaBytes
Max Memory Allocated: 0.004120826721191406  GigaBytes

torch.Size([655, 500])
torch.Size([158, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015878677368164062  GigaBytes
Max Memory Allocated: 0.004120826721191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.000949859619140625  GigaBytes
Max Memory Allocated: 0.004120826721191406  GigaBytes

torch.Size([364, 500])
torch.Size([86, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0010156631469726562  GigaBytes
Max Memory Allocated: 0.004120826721191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0019941329956054688  GigaBytes
Max Memory Allocated: 0.004120826721191406  GigaBytes

torch.Size([919, 500])
torch.Size([300, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002148151397705078  GigaBytes
Max Memory Allocated: 0.004120826721191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0034203529357910156  GigaBytes
Max Memory Allocated: 0.005107879638671875  GigaBytes

torch.Size([1681, 500])
torch.Size([288, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00357818603515625  GigaBytes
Max Memory Allocated: 0.005107879638671875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0028944015502929688  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

torch.Size([1391, 500])
torch.Size([344, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003090381622314453  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0011839866638183594  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

torch.Size([488, 500])
torch.Size([146, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0012664794921875  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003670215606689453  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

torch.Size([1807, 500])
torch.Size([397, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0038976669311523438  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0025510787963867188  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

torch.Size([1217, 500])
torch.Size([320, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0027146339416503906  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0017838478088378906  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

torch.Size([808, 500])
torch.Size([122, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0018620491027832031  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0017046928405761719  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

torch.Size([766, 500])
torch.Size([137, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0017867088317871094  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003017902374267578  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

torch.Size([1465, 500])
torch.Size([324, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003196239471435547  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0017685413360595704 |0.024065685272216798 |0.05392538706461589 |0.00013821919759114584 |0.0022502581278483072 |0.0019829273223876953 |
----------------------------------------------------------pseudo_mini_loss sum 2.9365828037261963
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17890
Number of first layer input nodes during this epoch:  14425
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0033364295959472656  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004546642303466797
random selection method range initialization spend 0.00010466575622558594
time for parepare:  4.076957702636719e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.1920928955078125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3828277587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  1.8358230590820312e-05
----------------------check_connections_block total spend ----------------------------- 0.0026993751525878906
generate_one_block  0.0011453628540039062
generate_one_block  0.001102447509765625
generate_one_block  0.00110626220703125
generate_one_block  0.0011043548583984375
generate_one_block  0.0010900497436523438
generate_one_block  0.0013363361358642578
generate_one_block  0.0010533332824707031
generate_one_block  0.0010461807250976562
generate_one_block  0.00110626220703125
generate_one_block  0.0010635852813720703
generate_one_block  0.0010116100311279297
generate_one_block  0.0010082721710205078
generate_one_block  0.0010592937469482422
generate_one_block  0.0010013580322265625
generate_one_block  0.001009225845336914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006439685821533203
gen group dst list time:  7.891654968261719e-05
time for parepare:  0.00025463104248046875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00016188621520996094
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00010204315185546875
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0002052783966064453
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001595020294189453
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00011777877807617188
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.127357482910156e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  8.20159912109375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.367134094238281e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00022840499877929688
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  7.510185241699219e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  6.246566772460938e-05
----------------------check_connections_block total spend ----------------------------- 0.004651546478271484
generate_one_block  0.0012693405151367188
generate_one_block  0.001215219497680664
generate_one_block  0.0014514923095703125
generate_one_block  0.0012607574462890625
generate_one_block  0.0011074542999267578
generate_one_block  0.0012836456298828125
generate_one_block  0.0011320114135742188
generate_one_block  0.0010788440704345703
generate_one_block  0.0012009143829345703
generate_one_block  0.0010988712310791016
generate_one_block  0.0012404918670654297
generate_one_block  0.0011401176452636719
generate_one_block  0.001102447509765625
generate_one_block  0.0010564327239990234
generate_one_block  0.0010788440704345703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010061264038085938
gen group dst list time:  0.00012564659118652344
time for parepare:  0.0008089542388916016
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0002734661102294922
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.0009336471557617188
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0006062984466552734
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  0.00016927719116210938
r_  generation:  0.0016057491302490234
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  0.00015616416931152344
r_  generation:  0.0010766983032226562
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.0002148151397705078
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0007269382476806641
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0002803802490234375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  8.654594421386719e-05
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0004112720489501953
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002288818359375
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0012977123260498047
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0003459453582763672
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0003616809844970703
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.0002522468566894531
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002601146697998047
----------------------check_connections_block total spend ----------------------------- 0.015935897827148438
generate_one_block  0.0024313926696777344
generate_one_block  0.0016674995422363281
generate_one_block  0.002986907958984375
generate_one_block  0.002285003662109375
generate_one_block  0.0012593269348144531
generate_one_block  0.0018277168273925781
generate_one_block  0.001295328140258789
generate_one_block  0.001069784164428711
generate_one_block  0.001417398452758789
generate_one_block  0.001188516616821289
generate_one_block  0.002460002899169922
generate_one_block  0.001360177993774414
generate_one_block  0.0013637542724609375
generate_one_block  0.001277923583984375
generate_one_block  0.0012404918670654297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0033364295959472656  GigaBytes
Max Memory Allocated: 0.0059871673583984375  GigaBytes

connection checking time:  0.020587444305419922
block generation total time  0.04284811019897461
average batch blocks generation time:  0.002856540679931641
block dataloader generation time/epoch 0.0975649356842041
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004000186920166016  GigaBytes
Max Memory Allocated: 0.006701946258544922  GigaBytes

torch.Size([1852, 500])
torch.Size([320, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004183292388916016  GigaBytes
Max Memory Allocated: 0.006701946258544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0022406578063964844  GigaBytes
Max Memory Allocated: 0.006701946258544922  GigaBytes

torch.Size([912, 500])
torch.Size([219, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002360820770263672  GigaBytes
Max Memory Allocated: 0.006701946258544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004501819610595703  GigaBytes
Max Memory Allocated: 0.006701946258544922  GigaBytes

torch.Size([2109, 500])
torch.Size([463, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004759788513183594  GigaBytes
Max Memory Allocated: 0.006701946258544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004239559173583984  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

torch.Size([1978, 500])
torch.Size([360, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004434108734130859  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0013146400451660156  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

torch.Size([421, 500])
torch.Size([104, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0013751983642578125  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0031571388244628906  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

torch.Size([1402, 500])
torch.Size([329, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0033292770385742188  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0012950897216796875  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

torch.Size([409, 500])
torch.Size([138, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0013713836669921875  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0007901191711425781  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

torch.Size([141, 500])
torch.Size([47, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0008220672607421875  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.001957416534423828  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

torch.Size([763, 500])
torch.Size([172, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0020570755004882812  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0011906623840332031  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

torch.Size([354, 500])
torch.Size([111, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0012655258178710938  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.003143787384033203  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

torch.Size([1385, 500])
torch.Size([355, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0033478736877441406  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.001689910888671875  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

torch.Size([620, 500])
torch.Size([137, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0017681121826171875  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0017943382263183594  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

torch.Size([676, 500])
torch.Size([124, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0018734931945800781  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0013155937194824219  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

torch.Size([421, 500])
torch.Size([105, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0013785362243652344  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.001255035400390625  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes
Using backend: pytorch

torch.Size([388, 500])
torch.Size([112, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0013227462768554688  GigaBytes
Max Memory Allocated: 0.008137226104736328  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.000615692138671875 |0.0004127661387125651 |0.003198671340942383 |0.00011850992838541667 |0.002913697560628255 |0.0014088153839111328 |
----------------------------------------------------------pseudo_mini_loss sum 1.9396922588348389
Total (block generation + training)time/epoch 0.22542977333068848
Training time/epoch 0.1275317668914795
Training time without block to device /epoch 0.12134027481079102
Training time without total dataloading part /epoch 0.09487199783325195
load block tensor time/epoch 0.009235382080078125
block to device time/epoch 0.0061914920806884766
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17284
Number of first layer input nodes during this epoch:  13831
