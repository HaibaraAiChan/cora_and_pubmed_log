main start at this time 1648526133.4479568
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001987934112548828
random selection method range initialization spend 0.00015854835510253906
time for parepare:  3.9577484130859375e-05
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.001085042953491211
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.2901763916015625e-05
----------------------check_connections_block total spend ----------------------------- 0.0020351409912109375
generate_one_block  0.0011811256408691406
generate_one_block  0.001047372817993164
generate_one_block  0.0010623931884765625
generate_one_block  0.0009970664978027344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008890628814697266
gen group dst list time:  2.9325485229492188e-05
time for parepare:  0.00020956993103027344
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00017213821411132812
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00026154518127441406
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00042247772216796875
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.00030159950256347656
----------------------check_connections_block total spend ----------------------------- 0.0024917125701904297
generate_one_block  0.0012543201446533203
generate_one_block  0.001344919204711914
generate_one_block  0.001544952392578125
generate_one_block  0.0013899803161621094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009417533874511719
gen group dst list time:  6.937980651855469e-05
time for parepare:  0.0006911754608154297
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0010197162628173828
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  0.00015616416931152344
r_  generation:  0.0013320446014404297
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  0.00023889541625976562
r_  generation:  0.0025963783264160156
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.0019497871398925781
----------------------check_connections_block total spend ----------------------------- 0.011170625686645508
generate_one_block  0.0031867027282714844
generate_one_block  0.0026540756225585938
generate_one_block  0.004383563995361328
generate_one_block  0.0033864974975585938
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00013256072998046875  GigaBytes
Max Memory Allocated: 0.00013256072998046875  GigaBytes

connection checking time:  0.013662338256835938
block generation total time  0.01914501190185547
average batch blocks generation time:  0.004786252975463867
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.004030704498291016  GigaBytes
Max Memory Allocated: 0.004030704498291016  GigaBytes

torch.Size([2076, 500])
torch.Size([411, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004260063171386719  GigaBytes
Max Memory Allocated: 0.004455089569091797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0046558380126953125  GigaBytes
Max Memory Allocated: 0.008481502532958984  GigaBytes

torch.Size([2335, 500])
torch.Size([622, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00499725341796875  GigaBytes
Max Memory Allocated: 0.008481502532958984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0067577362060546875  GigaBytes
Max Memory Allocated: 0.011023998260498047  GigaBytes

torch.Size([3441, 500])
torch.Size([942, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007276058197021484  GigaBytes
Max Memory Allocated: 0.011023998260498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006509304046630859  GigaBytes
Max Memory Allocated: 0.012862205505371094  GigaBytes

torch.Size([3322, 500])
torch.Size([774, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006925106048583984  GigaBytes
Max Memory Allocated: 0.012862205505371094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003026425838470459 |0.08534389734268188 |0.19519871473312378 |0.00021272897720336914 |0.0038524270057678223 |0.003032684326171875 |
----------------------------------------------------------pseudo_mini_loss sum 2.3654704093933105
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14278
Number of first layer input nodes during this epoch:  11174
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006903171539306641  GigaBytes
Max Memory Allocated: 0.012862205505371094  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005156993865966797
random selection method range initialization spend 0.00011420249938964844
time for parepare:  5.1975250244140625e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  8.344650268554688e-06Using backend: pytorch

local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.839897155761719e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.552436828613281e-05
----------------------check_connections_block total spend ----------------------------- 0.0011911392211914062
generate_one_block  0.0012934207916259766
generate_one_block  0.0011754035949707031
generate_one_block  0.0013332366943359375
generate_one_block  0.001172780990600586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005867481231689453
gen group dst list time:  3.7670135498046875e-05
time for parepare:  0.000278472900390625
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0004904270172119141
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0002231597900390625
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.00030517578125
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00019431114196777344
----------------------check_connections_block total spend ----------------------------- 0.0026853084564208984
generate_one_block  0.0015540122985839844
generate_one_block  0.0012125968933105469
generate_one_block  0.001394510269165039
generate_one_block  0.0011820793151855469
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008814334869384766
gen group dst list time:  7.224082946777344e-05
time for parepare:  0.0006442070007324219
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.00034809112548828125
mini_batch_src_global generation:  0.00027441978454589844
r_  generation:  0.0030088424682617188
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  0.0002288818359375
r_  generation:  0.0013353824615478516
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  0.00016450881958007812
r_  generation:  0.001735687255859375
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  0.00012040138244628906
r_  generation:  0.0010082721710205078
----------------------check_connections_block total spend ----------------------------- 0.011536121368408203
generate_one_block  0.0057299137115478516
generate_one_block  0.0027875900268554688
generate_one_block  0.003179311752319336
generate_one_block  0.0022025108337402344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006903171539306641  GigaBytes
Max Memory Allocated: 0.012862205505371094  GigaBytes

connection checking time:  0.014221429824829102
block generation total time  0.019242525100708008
average batch blocks generation time:  0.004810631275177002
block dataloader generation time/epoch 0.05209684371948242
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009164810180664062  GigaBytes
Max Memory Allocated: 0.0152587890625  GigaBytes

torch.Size([4589, 500])
torch.Size([1119, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00976705551147461  GigaBytes
Max Memory Allocated: 0.0152587890625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005532264709472656  GigaBytes
Max Memory Allocated: 0.0152587890625  GigaBytes

torch.Size([2667, 500])
torch.Size([599, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0058498382568359375  GigaBytes
Max Memory Allocated: 0.0152587890625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005268573760986328  GigaBytes
Max Memory Allocated: 0.0152587890625  GigaBytes

torch.Size([2517, 500])
torch.Size([645, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005639076232910156  GigaBytes
Max Memory Allocated: 0.0152587890625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0038280487060546875  GigaBytes
Max Memory Allocated: 0.0152587890625  GigaBytes

torch.Size([1757, 500])
torch.Size([462, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004084110260009766  GigaBytes
Max Memory Allocated: 0.0152587890625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001827538013458252 |0.000376284122467041 |0.003021717071533203 |0.00010561943054199219 |0.0031582117080688477 |0.0013065338134765625 |
----------------------------------------------------------pseudo_mini_loss sum 1.9030998945236206
Total (block generation + training)time/epoch 0.09177160263061523
Training time/epoch 0.039441585540771484
Training time without block to device /epoch 0.03793644905090332
Training time without total dataloading part /epoch 0.026448726654052734
load block tensor time/epoch 0.007310152053833008
block to device time/epoch 0.001505136489868164
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14712
Number of first layer input nodes during this epoch:  11530
