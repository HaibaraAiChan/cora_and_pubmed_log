main start at this time 1648525953.2115738
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002726316452026367
random selection method range initialization spend 0.0002503395080566406
time for parepare:  4.172325134277344e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0028111934661865234
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.239776611328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.4066696166992188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.4543533325195312e-05
----------------------check_connections_block total spend ----------------------------- 0.00554966926574707
generate_one_block  0.00135040283203125
generate_one_block  0.0010225772857666016
generate_one_block  0.001012563705444336
generate_one_block  0.0010123252868652344
generate_one_block  0.0009992122650146484
generate_one_block  0.0009984970092773438
generate_one_block  0.0010097026824951172
generate_one_block  0.0010025501251220703
generate_one_block  0.0010333061218261719
generate_one_block  0.0009543895721435547
generate_one_block  0.0009648799896240234
generate_one_block  0.0009524822235107422
generate_one_block  0.0009577274322509766
generate_one_block  0.0009715557098388672
generate_one_block  0.0009696483612060547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001264810562133789
gen group dst list time:  7.939338684082031e-05
time for parepare:  0.0002205371856689453
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00015306472778320312
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00011515617370605469
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00017380714416503906
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  7.581710815429688e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.673004150390625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  9.608268737792969e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00014448165893554688
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  6.556510925292969e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00011873245239257812
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.556510925292969e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  5.1975250244140625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0001430511474609375
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.866455078125e-05
----------------------check_connections_block total spend ----------------------------- 0.00456547737121582
generate_one_block  0.0011637210845947266
generate_one_block  0.0011398792266845703
generate_one_block  0.001252889633178711
generate_one_block  0.0011005401611328125
generate_one_block  0.001046895980834961
generate_one_block  0.0011157989501953125
generate_one_block  0.0011780261993408203
generate_one_block  0.0012743473052978516
generate_one_block  0.00106048583984375
generate_one_block  0.0010142326354980469
generate_one_block  0.001165151596069336
generate_one_block  0.0010890960693359375
generate_one_block  0.0018384456634521484
generate_one_block  0.0012013912200927734
generate_one_block  0.0010325908660888672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010676383972167969
gen group dst list time:  0.00013017654418945312
time for parepare:  0.0007185935974121094
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002512931823730469
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0005965232849121094
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.00045228004455566406
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  0.00011849403381347656
r_  generation:  0.0011615753173828125
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.00033855438232421875
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00024318695068359375
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.0001990795135498047
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0005161762237548828
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0006680488586425781
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  0.00011682510375976562
r_  generation:  0.0011715888977050781
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0003952980041503906
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001010894775390625
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0006759166717529297
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0003485679626464844
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00016736984252929688
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0008721351623535156
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0003376007080078125
----------------------check_connections_block total spend ----------------------------- 0.014778375625610352
generate_one_block  0.0018584728240966797
generate_one_block  0.0015499591827392578
generate_one_block  0.002475261688232422
generate_one_block  0.0013556480407714844
generate_one_block  0.0011866092681884766
generate_one_block  0.0015785694122314453
generate_one_block  0.0018544197082519531
generate_one_block  0.0023818016052246094
generate_one_block  0.0014073848724365234
generate_one_block  0.001051187515258789
generate_one_block  0.0017676353454589844
generate_one_block  0.001361846923828125
generate_one_block  0.0011410713195800781
generate_one_block  0.0020046234130859375
generate_one_block  0.0016050338745117188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

connection checking time:  0.019343852996826172
block generation total time  0.04225301742553711
average batch blocks generation time:  0.0028168678283691405
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.002250194549560547  GigaBytes
Max Memory Allocated: 0.002250194549560547  GigaBytes

torch.Size([1161, 500])
torch.Size([198, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002323150634765625  GigaBytes
Max Memory Allocated: 0.0023851394653320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0015778541564941406  GigaBytes
Max Memory Allocated: 0.003726959228515625  GigaBytes

torch.Size([767, 500])
torch.Size([194, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0016498565673828125  GigaBytes
Max Memory Allocated: 0.003726959228515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0026788711547851562  GigaBytes
Max Memory Allocated: 0.004071235656738281  GigaBytes

torch.Size([1346, 500])
torch.Size([341, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002800464630126953  GigaBytes
Max Memory Allocated: 0.004071235656738281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0013818740844726562  GigaBytes
Max Memory Allocated: 0.004071235656738281  GigaBytes

torch.Size([664, 500])
torch.Size([140, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0014348030090332031  GigaBytes
Max Memory Allocated: 0.004071235656738281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0008101463317871094  GigaBytes
Max Memory Allocated: 0.004071235656738281  GigaBytes

torch.Size([359, 500])
torch.Size([102, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0008449554443359375  GigaBytes
Max Memory Allocated: 0.004071235656738281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0018048286437988281  GigaBytes
Max Memory Allocated: 0.004071235656738281  GigaBytes

torch.Size([888, 500])
torch.Size([192, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0018706321716308594  GigaBytes
Max Memory Allocated: 0.004071235656738281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0028295516967773438  GigaBytes
Max Memory Allocated: 0.004464149475097656  GigaBytes

torch.Size([1436, 500])
torch.Size([220, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002907276153564453  GigaBytes
Max Memory Allocated: 0.004464149475097656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002838134765625  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

torch.Size([1433, 500])
torch.Size([315, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0029497146606445312  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0015106201171875  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

torch.Size([732, 500])
torch.Size([108, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.001556396484375  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00039577484130859375  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

torch.Size([138, 500])
torch.Size([53, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0004200935363769531  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0026154518127441406  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

torch.Size([1321, 500])
torch.Size([303, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0027098655700683594  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0012292861938476562  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

torch.Size([582, 500])
torch.Size([159, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0012812614440917969  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0006546974182128906  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

torch.Size([276, 500])
torch.Size([89, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0006885528564453125  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0033054351806640625  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

torch.Size([1688, 500])
torch.Size([320, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003413677215576172  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0012011528015136719  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

torch.Size([567, 500])
torch.Size([140, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0012502670288085938  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0018390973409016928 |0.02417451540629069 |0.05425588289896647 |0.0001445929209391276 |0.002677663167317708 |0.002262115478515625 |
----------------------------------------------------------pseudo_mini_loss sum 2.067837715148926
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16589
Number of first layer input nodes during this epoch:  13358
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0013570785522460938  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004553794860839844
random selection method range initialization spend 0.00010609626770019531
time for parepare:  4.1961669921875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.8835067749023438e-05
----------------------check_connections_block total spend ----------------------------- 0.0026781558990478516
generate_one_block  0.0011098384857177734
generate_one_block  0.001069784164428711
generate_one_block  0.0010437965393066406
generate_one_block  0.0010461807250976562
generate_one_block  0.0010342597961425781
generate_one_block  0.0012924671173095703
generate_one_block  0.0010564327239990234
generate_one_block  0.0010418891906738281
generate_one_block  0.001077413558959961
generate_one_block  0.0010557174682617188
generate_one_block  0.0009906291961669922
generate_one_block  0.0010106563568115234
generate_one_block  0.001009225845336914
generate_one_block  0.0010139942169189453
generate_one_block  0.0009980201721191406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006301403045654297
gen group dst list time:  8.678436279296875e-05
time for parepare:  0.00023746490478515625
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00015234947204589844
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  6.198883056640625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00016427040100097656
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.1975250244140625e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00010967254638671875
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.557868957519531e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0001633167266845703
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  9.131431579589844e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00017142295837402344
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.888938903808594e-05
----------------------check_connections_block total spend ----------------------------- 0.004456281661987305
generate_one_block  0.0012590885162353516
generate_one_block  0.0011181831359863281
generate_one_block  0.0011806488037109375
generate_one_block  0.0012624263763427734
generate_one_block  0.0010745525360107422
generate_one_block  0.0011296272277832031
generate_one_block  0.0011587142944335938
generate_one_block  0.0010843276977539062
generate_one_block  0.0011363029479980469
generate_one_block  0.0011391639709472656
generate_one_block  0.0010581016540527344
generate_one_block  0.0011909008026123047
generate_one_block  0.0011053085327148438
generate_one_block  0.001192331314086914
generate_one_block  0.0010483264923095703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00103759765625
gen group dst list time:  0.00012230873107910156
time for parepare:  0.0007431507110595703
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.0002727508544921875
mini_batch_src_global generation:  0.00014019012451171875
r_  generation:  0.001055002212524414
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.00046253204345703125
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.00043511390686035156
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  0.00012230873107910156
r_  generation:  0.0011591911315917969
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00015878677368164062
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0002887248992919922
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.00045490264892578125
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.0002262592315673828
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0006139278411865234
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0003154277801513672
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0002505779266357422
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0009031295776367188
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0005209445953369141
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.0009348392486572266
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0003108978271484375
----------------------check_connections_block total spend ----------------------------- 0.014983415603637695
generate_one_block  0.002517223358154297
generate_one_block  0.0016131401062011719
generate_one_block  0.0015213489532470703
generate_one_block  0.0024046897888183594
generate_one_block  0.0011696815490722656
generate_one_block  0.0013251304626464844
generate_one_block  0.0015153884887695312
generate_one_block  0.0012652873992919922
generate_one_block  0.0017371177673339844
generate_one_block  0.0013642311096191406
generate_one_block  0.001270294189453125
generate_one_block  0.002044677734375
generate_one_block  0.0016202926635742188
generate_one_block  0.0022499561309814453
generate_one_block  0.0013463497161865234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0013570785522460938  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

connection checking time:  0.019439697265625
block generation total time  0.042102813720703125
average batch blocks generation time:  0.002806854248046875
block dataloader generation time/epoch 0.09601736068725586
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0034399032592773438  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

torch.Size([1427, 500])
torch.Size([321, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003551483154296875  GigaBytes
Max Memory Allocated: 0.005479335784912109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0024023056030273438  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

torch.Size([1140, 500])
torch.Size([136, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0024557113647460938  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0019989013671875  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

torch.Size([924, 500])
torch.Size([103, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002044200897216797  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002762317657470703  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

torch.Size([1321, 500])
torch.Size([337, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0028815269470214844  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.000759124755859375  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

torch.Size([263, 500])
torch.Size([69, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0007877349853515625  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0012035369873046875  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

torch.Size([499, 500])
torch.Size([143, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0012536048889160156  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0018477439880371094  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

torch.Size([843, 500])
torch.Size([123, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0018954277038574219  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0009174346923828125  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

torch.Size([347, 500])
torch.Size([89, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0009522438049316406  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0022726058959960938  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

torch.Size([1068, 500])
torch.Size([288, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0023589134216308594  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0011353492736816406  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

torch.Size([462, 500])
torch.Size([120, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0011806488037109375  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0009546279907226562  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

torch.Size([366, 500])
torch.Size([117, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0009961128234863281  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0031604766845703125  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

torch.Size([1541, 500])
torch.Size([371, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0032787322998046875  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002155303955078125  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

torch.Size([1007, 500])
torch.Size([199, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002223968505859375  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003551483154296875  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

torch.Size([1750, 500])
torch.Size([364, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003674030303955078  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0014233589172363281  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes
Using backend: pytorch

torch.Size([617, 500])
torch.Size([97, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0014629364013671875  GigaBytes
Max Memory Allocated: 0.005532741546630859  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0007304032643636068 |0.00041780471801757815 |0.003369903564453125 |0.00011898676554361979 |0.0030953566233317058 |0.0023937225341796875 |
----------------------------------------------------------pseudo_mini_loss sum 2.013516426086426
Total (block generation + training)time/epoch 0.23276638984680176
Training time/epoch 0.13639307022094727
Training time without block to device /epoch 0.1301259994506836
Training time without total dataloading part /epoch 0.10115742683410645
load block tensor time/epoch 0.010956048965454102
block to device time/epoch 0.006267070770263672
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16809
Number of first layer input nodes during this epoch:  13575
