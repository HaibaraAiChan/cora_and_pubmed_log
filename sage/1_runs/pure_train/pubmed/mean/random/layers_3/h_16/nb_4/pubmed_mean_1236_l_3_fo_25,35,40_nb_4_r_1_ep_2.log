main start at this time 1648525871.5568218
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020339488983154297
random selection method range initialization spend 0.00018167495727539062
time for parepare:  4.267692565917969e-05
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0014734268188476562
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  5.602836608886719e-05
----------------------check_connections_block total spend ----------------------------- 0.0021483898162841797
generate_one_block  0.0013153553009033203
generate_one_block  0.0011222362518310547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011675357818603516
gen group dst list time:  2.4557113647460938e-05
time for parepare:  0.0002262592315673828
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0007398128509521484
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0004742145538330078
----------------------check_connections_block total spend ----------------------------- 0.002318859100341797
generate_one_block  0.002070188522338867
generate_one_block  0.0016543865203857422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009739398956298828
gen group dst list time:  5.91278076171875e-05
time for parepare:  0.0007007122039794922
local_output_nid generation:  0.00010609626770019531
local_in_edges_tensor generation:  0.00042366981506347656
mini_batch_src_global generation:  0.0003323554992675781
r_  generation:  0.003990650177001953
local_output_nid generation:  8.678436279296875e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  0.0003314018249511719
r_  generation:  0.002646923065185547
----------------------check_connections_block total spend ----------------------------- 0.010724782943725586
generate_one_block  0.007232666015625
generate_one_block  0.004225492477416992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

connection checking time:  0.013043642044067383
block generation total time  0.015182733535766602
average batch blocks generation time:  0.007591366767883301
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.010045051574707031  GigaBytes
Max Memory Allocated: 0.010045051574707031  GigaBytes

torch.Size([5289, 500])
torch.Size([1538, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.010540485382080078  GigaBytes
Max Memory Allocated: 0.010822296142578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008280754089355469  GigaBytes
Max Memory Allocated: 0.01805591583251953  GigaBytes

torch.Size([4332, 500])
torch.Size([1151, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008633613586425781  GigaBytes
Max Memory Allocated: 0.01805591583251953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009186744689941406 |0.17332816123962402 |0.3825162649154663 |0.00021719932556152344 |0.005049705505371094 |0.0028302669525146484 |
----------------------------------------------------------pseudo_mini_loss sum 1.5326951742172241
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12665
Number of first layer input nodes during this epoch:  9621
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008591651916503906  GigaBytes
Max Memory Allocated: 0.01805591583251953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005636215209960938
random selection method range initialization spend 0.00011730194091796875
time for parepare:  5.221366882324219e-05
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  8.487701416015625e-05
----------------------check_connections_block total spend ----------------------------- 0.0007836818695068359
generate_one_block  0.0016002655029296875
generate_one_block  0.0013575553894042969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006163120269775391
gen group dst list time:  2.9325485229492188e-05
time for parepare:  0.0003056526184082031
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  7.581710815429688e-05
r_  generation:  0.0005438327789306641
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0006422996520996094
----------------------check_connections_block total spend ----------------------------- 0.00244140625
generate_one_block  0.0017719268798828125
generate_one_block  0.0017843246459960938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009450912475585938
gen group dst list time:  6.67572021484375e-05
time for parepare:  0.0006415843963623047
local_output_nid generation:  8.654594421386719e-05
local_in_edges_tensor generation:  0.0003628730773925781
mini_batch_src_global generation:  0.00033020973205566406
r_  generation:  0.003317594528198242
local_output_nid generation:  0.0001163482666015625
local_in_edges_tensor generation:  0.0003097057342529297
mini_batch_src_global generation:  0.0004010200500488281
r_  generation:  0.003239870071411133
----------------------check_connections_block total spend ----------------------------- 0.01082468032836914
generate_one_block  0.005452871322631836
generate_one_block  0.005243539810180664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008591651916503906  GigaBytes
Max Memory Allocated: 0.01805591583251953  GigaBytes

connection checking time:  0.01326608657836914
block generation total time  0.014252662658691406
average batch blocks generation time:  0.007126331329345703
block dataloader generation time/epoch 0.042452335357666016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008750438690185547  GigaBytes
Max Memory Allocated: 0.01805591583251953  GigaBytes
Using backend: pytorch

torch.Size([4501, 500])
torch.Size([1190, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.009138107299804688  GigaBytes
Max Memory Allocated: 0.01805591583251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.009876251220703125  GigaBytes
Max Memory Allocated: 0.018161773681640625  GigaBytes

torch.Size([5107, 500])
torch.Size([1504, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01033639907836914  GigaBytes
Max Memory Allocated: 0.018161773681640625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003192424774169922 |0.00043833255767822266 |0.0031304359436035156 |0.0001308917999267578 |0.0037899017333984375 |0.001520395278930664 |
----------------------------------------------------------pseudo_mini_loss sum 1.6910929679870605
Total (block generation + training)time/epoch 0.06809830665588379
Training time/epoch 0.025363445281982422
Training time without block to device /epoch 0.024486780166625977
Training time without total dataloading part /epoch 0.015622854232788086
load block tensor time/epoch 0.006384849548339844
block to device time/epoch 0.0008766651153564453
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  12658
Number of first layer input nodes during this epoch:  9608
