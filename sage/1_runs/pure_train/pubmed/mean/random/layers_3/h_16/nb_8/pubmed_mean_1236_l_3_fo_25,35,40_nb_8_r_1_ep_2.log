main start at this time 1648525881.6431196
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002526521682739258
random selection method range initialization spend 0.00017762184143066406
time for parepare:  4.00543212890625e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.0014002323150634766
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.0517578125e-05
----------------------check_connections_block total spend ----------------------------- 0.0023603439331054688
generate_one_block  0.0012366771697998047
generate_one_block  0.0010344982147216797
generate_one_block  0.0010459423065185547
generate_one_block  0.001069784164428711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0013277530670166016
gen group dst list time:  3.0994415283203125e-05
time for parepare:  0.0002105236053466797
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00036454200744628906
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00037479400634765625
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00023651123046875
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0002810955047607422
----------------------check_connections_block total spend ----------------------------- 0.002643585205078125
generate_one_block  0.001537322998046875
generate_one_block  0.001440286636352539
generate_one_block  0.0013053417205810547
generate_one_block  0.0013582706451416016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009377002716064453
gen group dst list time:  6.747245788574219e-05
time for parepare:  0.0007405281066894531
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00032711029052734375
mini_batch_src_global generation:  0.0002014636993408203
r_  generation:  0.002087831497192383
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.00025153160095214844
mini_batch_src_global generation:  0.0002598762512207031
r_  generation:  0.0022916793823242188
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  0.00015044212341308594
r_  generation:  0.0013537406921386719
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  0.00014710426330566406
r_  generation:  0.0014650821685791016
----------------------check_connections_block total spend ----------------------------- 0.011694192886352539
generate_one_block  0.0048675537109375
generate_one_block  0.004122495651245117
generate_one_block  0.0025300979614257812
generate_one_block  0.0028944015502929688
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

connection checking time:  0.014337778091430664
block generation total time  0.020055770874023438
average batch blocks generation time:  0.005013942718505859
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005633831024169922  GigaBytes
Max Memory Allocated: 0.005633831024169922  GigaBytes

torch.Size([2951, 500])
torch.Size([777, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005894660949707031  GigaBytes
Max Memory Allocated: 0.006059169769287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007262706756591797  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

torch.Size([3789, 500])
torch.Size([855, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007534503936767578  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004493236541748047  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

torch.Size([2320, 500])
torch.Size([509, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004656314849853516  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005259037017822266  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

torch.Size([2727, 500])
torch.Size([677, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0054683685302734375  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004857659339904785 |0.08653968572616577 |0.1948351263999939 |0.0002192854881286621 |0.00412362813949585 |0.003253459930419922 |
----------------------------------------------------------pseudo_mini_loss sum 2.0204615592956543
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14961
Number of first layer input nodes during this epoch:  11787
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005495548248291016  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006089210510253906
random selection method range initialization spend 0.00013136863708496094
time for parepare:  6.127357482910156e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00014281272888183594
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.890296936035156e-05
----------------------check_connections_block total spend ----------------------------- 0.0014126300811767578
generate_one_block  0.0011301040649414062
generate_one_block  0.0010693073272705078
generate_one_block  0.001140594482421875
generate_one_block  0.0010592937469482422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005364418029785156
gen group dst list time:  3.4332275390625e-05
time for parepare:  0.00023889541625976562
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0002799034118652344
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00029349327087402344
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00025272369384765625
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0004296302795410156
----------------------check_connections_block total spend ----------------------------- 0.0027070045471191406
generate_one_block  0.0014286041259765625
generate_one_block  0.0013942718505859375
generate_one_block  0.001322031021118164
generate_one_block  0.0015625953674316406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009913444519042969
gen group dst list time:  7.486343383789062e-05
time for parepare:  0.0007007122039794922
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00031566619873046875
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.0020093917846679688
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  0.00027060508728027344
r_  generation:  0.0019121170043945312
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.00014448165893554688
r_  generation:  0.0012359619140625
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.0002377033233642578
mini_batch_src_global generation:  0.00019979476928710938
r_  generation:  0.002346038818359375
----------------------check_connections_block total spend ----------------------------- 0.012324333190917969
generate_one_block  0.0039751529693603516
generate_one_block  0.003503084182739258
generate_one_block  0.002508878707885742
generate_one_block  0.00397038459777832
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005495548248291016  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

connection checking time:  0.01503133773803711
block generation total time  0.019665002822875977
average batch blocks generation time:  0.004916250705718994
block dataloader generation time/epoch 0.05250883102416992
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006411552429199219  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

torch.Size([3269, 500])
torch.Size([637, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006626129150390625  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004939079284667969  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

torch.Size([2479, 500])
torch.Size([623, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005145072937011719  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003837108612060547  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

torch.Size([1898, 500])
torch.Size([593, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004015922546386719  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007840633392333984  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

torch.Size([4031, 500])
torch.Size([961, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008145809173583984  GigaBytes
Max Memory Allocated: 0.012689590454101562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0018470287322998047 |0.00040709972381591797 |0.0031570792198181152 |0.00011610984802246094 |0.002633213996887207 |0.0014574527740478516 |
----------------------------------------------------------pseudo_mini_loss sum 1.9081506729125977
Total (block generation + training)time/epoch 0.09136176109313965
Training time/epoch 0.038567304611206055
Training time without block to device /epoch 0.03693890571594238
Training time without total dataloading part /epoch 0.025083065032958984
load block tensor time/epoch 0.007388114929199219
block to device time/epoch 0.0016283988952636719
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14847
Number of first layer input nodes during this epoch:  11677
