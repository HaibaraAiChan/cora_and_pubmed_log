main start at this time 1648526053.4498646
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014481544494628906
random selection method range initialization spend 0.0001881122589111328
time for parepare:  4.458427429199219e-05
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.0011897087097167969
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.2636184692382812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.621246337890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3828277587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.00397491455078125
generate_one_block  0.0012347698211669922
generate_one_block  0.0010459423065185547
generate_one_block  0.0010459423065185547
generate_one_block  0.0010275840759277344
generate_one_block  0.0010192394256591797
generate_one_block  0.0010385513305664062
generate_one_block  0.0010302066802978516
generate_one_block  0.0010328292846679688
generate_one_block  0.0010671615600585938
generate_one_block  0.0010325908660888672
generate_one_block  0.0010330677032470703
generate_one_block  0.0010328292846679688
generate_one_block  0.0009815692901611328
generate_one_block  0.0009899139404296875
generate_one_block  0.0009377002716064453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007226467132568359
gen group dst list time:  8.20159912109375e-05
time for parepare:  0.0002570152282714844
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00020265579223632812
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00012350082397460938
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00012111663818359375
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001995563507080078
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.459785461425781e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  9.083747863769531e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00010943412780761719
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00018024444580078125
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00012922286987304688
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  8.153915405273438e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00015854835510253906
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  7.176399230957031e-05
----------------------check_connections_block total spend ----------------------------- 0.004856109619140625
generate_one_block  0.0012176036834716797
generate_one_block  0.0011737346649169922
generate_one_block  0.0013175010681152344
generate_one_block  0.0011222362518310547
generate_one_block  0.0010881423950195312
generate_one_block  0.001157999038696289
generate_one_block  0.0011718273162841797
generate_one_block  0.0013034343719482422
generate_one_block  0.0010025501251220703
generate_one_block  0.0009632110595703125
generate_one_block  0.0011005401611328125
generate_one_block  0.0011355876922607422
generate_one_block  0.0009937286376953125
generate_one_block  0.0011208057403564453
generate_one_block  0.0010139942169189453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011701583862304688
gen group dst list time:  0.00012922286987304688
time for parepare:  0.0007846355438232422
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0002856254577636719
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.000751495361328125
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0005156993865966797
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  0.00015401840209960938
r_  generation:  0.0015723705291748047
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.00038242340087890625
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00026226043701171875
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0002713203430175781
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.0006465911865234375
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  0.00010371208190917969
r_  generation:  0.0009360313415527344
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  0.0001671314239501953
r_  generation:  0.0016508102416992188
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  9.369850158691406e-05
r_  generation:  0.0004634857177734375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00010728836059570312
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.000911712646484375
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.000461578369140625
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00019288063049316406
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  8.726119995117188e-05
r_  generation:  0.0009696483612060547
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.00039124488830566406
----------------------check_connections_block total spend ----------------------------- 0.018007993698120117
generate_one_block  0.0021049976348876953
generate_one_block  0.0015063285827636719
generate_one_block  0.0027992725372314453
generate_one_block  0.0013425350189208984
generate_one_block  0.0012309551239013672
generate_one_block  0.0016620159149169922
generate_one_block  0.002159595489501953
generate_one_block  0.002808094024658203
generate_one_block  0.0014634132385253906
generate_one_block  0.001031637191772461
generate_one_block  0.0019655227661132812
generate_one_block  0.0014214515686035156
generate_one_block  0.001127004623413086
generate_one_block  0.0020911693572998047
generate_one_block  0.0016176700592041016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

connection checking time:  0.022864103317260742
block generation total time  0.04321455955505371
average batch blocks generation time:  0.0028809706370035806
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0025992393493652344  GigaBytes
Max Memory Allocated: 0.0025992393493652344  GigaBytes

torch.Size([1347, 500])
torch.Size([225, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002681255340576172  GigaBytes
Max Memory Allocated: 0.0027570724487304688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0017647743225097656  GigaBytes
Max Memory Allocated: 0.0042591094970703125  GigaBytes

torch.Size([867, 500])
torch.Size([194, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0018377304077148438  GigaBytes
Max Memory Allocated: 0.0042591094970703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003143787384033203  GigaBytes
Max Memory Allocated: 0.004711627960205078  GigaBytes

torch.Size([1590, 500])
torch.Size([365, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0032806396484375  GigaBytes
Max Memory Allocated: 0.004711627960205078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0014395713806152344  GigaBytes
Max Memory Allocated: 0.004711627960205078  GigaBytes

torch.Size([695, 500])
torch.Size([140, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0014925003051757812  GigaBytes
Max Memory Allocated: 0.004711627960205078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0009860992431640625  GigaBytes
Max Memory Allocated: 0.004711627960205078  GigaBytes

torch.Size([453, 500])
torch.Size([127, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.001026153564453125  GigaBytes
Max Memory Allocated: 0.004711627960205078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002140045166015625  GigaBytes
Max Memory Allocated: 0.004711627960205078  GigaBytes

torch.Size([1067, 500])
torch.Size([192, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0022077560424804688  GigaBytes
Max Memory Allocated: 0.004711627960205078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003807544708251953  GigaBytes
Max Memory Allocated: 0.005767822265625  GigaBytes

torch.Size([1957, 500])
torch.Size([255, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003899097442626953  GigaBytes
Max Memory Allocated: 0.005767822265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003306865692138672  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

torch.Size([1677, 500])
torch.Size([377, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003445148468017578  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0017156600952148438  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

torch.Size([841, 500])
torch.Size([108, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00039577484130859375  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

torch.Size([138, 500])
torch.Size([53, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0004200935363769531  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0030999183654785156  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

torch.Size([1578, 500])
torch.Size([326, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003204822540283203  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0014295578002929688  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

torch.Size([688, 500])
torch.Size([185, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0014905929565429688  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0006546974182128906  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

torch.Size([276, 500])
torch.Size([90, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0006885528564453125  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0035562515258789062  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

torch.Size([1822, 500])
torch.Size([320, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003665447235107422  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0013418197631835938  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

torch.Size([642, 500])
torch.Size([140, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0013918876647949219  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005561733245849609 |0.023406203587849936 |0.053886095682779946 |0.00013594627380371095 |0.00339964230855306 |0.001971721649169922 |
----------------------------------------------------------pseudo_mini_loss sum 2.0206687450408936
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  19092
Number of first layer input nodes during this epoch:  15638
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004830360412597656
random selection method range initialization spend 0.00012230873107910156
time for parepare:  4.553794860839844e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.4543533325195312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3589859008789062e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.9073486328125e-05
----------------------check_connections_block total spend ----------------------------- 0.0026895999908447266
generate_one_block  0.001102447509765625
generate_one_block  0.0010104179382324219
generate_one_block  0.0009987354278564453
generate_one_block  0.0010008811950683594
generate_one_block  0.0009932518005371094
generate_one_block  0.0012102127075195312
generate_one_block  0.000993967056274414
generate_one_block  0.0010027885437011719
generate_one_block  0.000997304916381836
generate_one_block  0.0010006427764892578
generate_one_block  0.0009737014770507812
generate_one_block  0.0009589195251464844
generate_one_block  0.0009391307830810547
generate_one_block  0.0009539127349853516
generate_one_block  0.0009436607360839844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006489753723144531
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.00028133392333984375
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00017595291137695312
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  8.654594421386719e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.437301635742188e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0001888275146484375
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  4.649162292480469e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.316734313964844e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.0001277923583984375
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.82012939453125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001690387725830078
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00010347366333007812
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00018477439880371094
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.008148193359375e-05
----------------------check_connections_block total spend ----------------------------- 0.004736900329589844
generate_one_block  0.001241922378540039
generate_one_block  0.0010974407196044922
generate_one_block  0.0011334419250488281
generate_one_block  0.0012488365173339844
generate_one_block  0.0010333061218261719
generate_one_block  0.0010881423950195312
generate_one_block  0.001077413558959961
generate_one_block  0.0010535717010498047
generate_one_block  0.0011675357818603516
generate_one_block  0.0010204315185546875
generate_one_block  0.0010077953338623047
generate_one_block  0.0011451244354248047
generate_one_block  0.0010585784912109375
generate_one_block  0.0011479854583740234
generate_one_block  0.0009851455688476562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012555122375488281
gen group dst list time:  0.000133514404296875
time for parepare:  0.0009672641754150391
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0003216266632080078
mini_batch_src_global generation:  0.00020432472229003906
r_  generation:  0.0013859272003173828
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  0.0001068115234375
r_  generation:  0.0007431507110595703
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.000522613525390625
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.0001430511474609375
r_  generation:  0.0015368461608886719
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0001747608184814453
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0003306865692138672
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004942417144775391
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00023126602172851562
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  7.462501525878906e-05
r_  generation:  0.0007936954498291016
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0003299713134765625
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0002694129943847656
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0009562969207763672
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  8.7738037109375e-05
r_  generation:  0.0006840229034423828
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.0011858940124511719
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.00034165382385253906
----------------------check_connections_block total spend ----------------------------- 0.018053770065307617
generate_one_block  0.0028655529022216797
generate_one_block  0.0019731521606445312
generate_one_block  0.001573801040649414
generate_one_block  0.0027539730072021484
generate_one_block  0.0011284351348876953
generate_one_block  0.0013010501861572266
generate_one_block  0.0015494823455810547
generate_one_block  0.0011878013610839844
generate_one_block  0.0018544197082519531
generate_one_block  0.0013058185577392578
generate_one_block  0.0012195110321044922
generate_one_block  0.0020568370819091797
generate_one_block  0.0017733573913574219
generate_one_block  0.0024318695068359375
generate_one_block  0.0013170242309570312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

connection checking time:  0.02279067039489746
block generation total time  0.042798757553100586
average batch blocks generation time:  0.002853250503540039
block dataloader generation time/epoch 0.09971380233764648
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00370025634765625  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

torch.Size([1649, 500])
torch.Size([354, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0038285255432128906  GigaBytes
Max Memory Allocated: 0.006904125213623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0036597251892089844  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

torch.Size([1811, 500])
torch.Size([172, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0037283897399902344  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0022792816162109375  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

torch.Size([1073, 500])
torch.Size([103, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002327442169189453  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0031638145446777344  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

torch.Size([1531, 500])
torch.Size([375, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003299713134765625  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0008459091186523438  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

torch.Size([309, 500])
torch.Size([69, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0008754730224609375  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0013346672058105469  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

torch.Size([569, 500])
torch.Size([144, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0013856887817382812  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0021533966064453125  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

torch.Size([1006, 500])
torch.Size([129, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0022058486938476562  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0009436607360839844  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

torch.Size([361, 500])
torch.Size([89, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0009784698486328125  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0026464462280273438  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

torch.Size([1266, 500])
torch.Size([338, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0027484893798828125  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0011429786682128906  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

torch.Size([466, 500])
torch.Size([120, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0011882781982421875  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0010013580322265625  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

torch.Size([391, 500])
torch.Size([118, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0010428428649902344  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0033693313598632812  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

torch.Size([1652, 500])
torch.Size([371, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0034894943237304688  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002494335174560547  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

torch.Size([1186, 500])
torch.Size([234, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0025763511657714844  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0042400360107421875  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

torch.Size([2116, 500])
torch.Size([390, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004374980926513672  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0015254020690917969  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes
Using backend: pytorch

torch.Size([672, 500])
torch.Size([97, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0015649795532226562  GigaBytes
Max Memory Allocated: 0.0070323944091796875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0006205081939697265 |0.00042290687561035155 |0.0033350149790445966 |0.00012269020080566407 |0.0031187057495117186 |0.0015721321105957031 |
----------------------------------------------------------pseudo_mini_loss sum 1.9805904626846313
Total (block generation + training)time/epoch 0.23395252227783203
Training time/epoch 0.13406968116760254
Training time without block to device /epoch 0.12772607803344727
Training time without total dataloading part /epoch 0.10021829605102539
load block tensor time/epoch 0.009307622909545898
block to device time/epoch 0.0063436031341552734
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  19518
Number of first layer input nodes during this epoch:  16058
