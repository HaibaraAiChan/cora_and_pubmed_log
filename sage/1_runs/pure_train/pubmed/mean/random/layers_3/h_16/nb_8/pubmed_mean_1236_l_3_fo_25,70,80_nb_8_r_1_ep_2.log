main start at this time 1648525983.3292563
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008687973022460938
random selection method range initialization spend 0.0001971721649169922
time for parepare:  5.245208740234375e-05
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0013883113861083984
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.00543212890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0025565624237060547
generate_one_block  0.0014390945434570312
generate_one_block  0.001306295394897461
generate_one_block  0.0013248920440673828
generate_one_block  0.0012841224670410156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007052421569824219
gen group dst list time:  4.00543212890625e-05
time for parepare:  0.000316619873046875
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0004951953887939453
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0004799365997314453
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.00028061866760253906
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0003712177276611328
----------------------check_connections_block total spend ----------------------------- 0.0034008026123046875
generate_one_block  0.0019104480743408203
generate_one_block  0.0018961429595947266
generate_one_block  0.0015959739685058594
generate_one_block  0.0017039775848388672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011394023895263672
gen group dst list time:  9.608268737792969e-05
time for parepare:  0.0009472370147705078
local_output_nid generation:  8.320808410644531e-05
local_in_edges_tensor generation:  0.0003535747528076172
mini_batch_src_global generation:  0.00025653839111328125
r_  generation:  0.002900838851928711
local_output_nid generation:  9.751319885253906e-05
local_in_edges_tensor generation:  0.0002944469451904297
mini_batch_src_global generation:  0.0004525184631347656
r_  generation:  0.0034940242767333984
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.0002334117889404297
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.001806497573852539
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.00024628639221191406
mini_batch_src_global generation:  0.0001983642578125
r_  generation:  0.001795053482055664
----------------------check_connections_block total spend ----------------------------- 0.016443729400634766
generate_one_block  0.004119157791137695
generate_one_block  0.005475759506225586
generate_one_block  0.002710580825805664
generate_one_block  0.0028831958770751953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

connection checking time:  0.019844532012939453
block generation total time  0.022295236587524414
average batch blocks generation time:  0.0055738091468811035
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005794048309326172  GigaBytes
Max Memory Allocated: 0.005794048309326172  GigaBytes

torch.Size([3036, 500])
torch.Size([824, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006064414978027344  GigaBytes
Max Memory Allocated: 0.006234645843505859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008107662200927734  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

torch.Size([4237, 500])
torch.Size([950, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008409500122070312  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004779338836669922  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

torch.Size([2471, 500])
torch.Size([568, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0049591064453125  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005304813385009766  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

torch.Size([2751, 500])
torch.Size([704, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005519390106201172  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002359926700592041 |0.08620232343673706 |0.19590473175048828 |0.00019115209579467773 |0.004346370697021484 |0.0025916099548339844 |
----------------------------------------------------------pseudo_mini_loss sum 1.9959907531738281
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15897
Number of first layer input nodes during this epoch:  12495
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005543231964111328  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005643367767333984
random selection method range initialization spend 0.00012993812561035156
time for parepare:  5.888938903808594e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.0001308917999267578
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.318092346191406e-05
----------------------check_connections_block total spend ----------------------------- 0.0013015270233154297
generate_one_block  0.00131988525390625
generate_one_block  0.0012967586517333984
generate_one_block  0.001306295394897461
generate_one_block  0.001074075698852539
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000522613525390625
gen group dst list time:  3.361701965332031e-05
time for parepare:  0.0002579689025878906
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.000324249267578125
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0003135204315185547
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0002696514129638672
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0004341602325439453
----------------------check_connections_block total spend ----------------------------- 0.002919912338256836
generate_one_block  0.001443624496459961
generate_one_block  0.0014679431915283203
generate_one_block  0.0013675689697265625
generate_one_block  0.001588582992553711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010135173797607422
gen group dst list time:  7.939338684082031e-05
time for parepare:  0.0007526874542236328
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.0003190040588378906
mini_batch_src_global generation:  0.00028777122497558594
r_  generation:  0.002321958541870117
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00021457672119140625
mini_batch_src_global generation:  0.0002956390380859375
r_  generation:  0.002036571502685547
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.00015306472778320312
r_  generation:  0.0013275146484375
local_output_nid generation:  7.796287536621094e-05
local_in_edges_tensor generation:  0.00024199485778808594
mini_batch_src_global generation:  0.0002465248107910156
r_  generation:  0.002569913864135742
----------------------check_connections_block total spend ----------------------------- 0.01357412338256836
generate_one_block  0.004395008087158203
generate_one_block  0.003367900848388672
generate_one_block  0.002496480941772461
generate_one_block  0.0041217803955078125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005543231964111328  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

connection checking time:  0.016494035720825195
block generation total time  0.020248889923095703
average batch blocks generation time:  0.005062222480773926
block dataloader generation time/epoch 0.054525136947631836
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0071392059326171875  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

torch.Size([3655, 500])
torch.Size([726, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007380485534667969  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0050716400146484375  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

torch.Size([2549, 500])
torch.Size([642, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0052852630615234375  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0039653778076171875  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

torch.Size([1966, 500])
torch.Size([642, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004156589508056641  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008205413818359375  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

torch.Size([4224, 500])
torch.Size([1021, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008526802062988281  GigaBytes
Max Memory Allocated: 0.013682365417480469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0018891096115112305 |0.0004373788833618164 |0.0033028125762939453 |0.00011920928955078125 |0.002868354320526123 |0.0015006065368652344 |
----------------------------------------------------------pseudo_mini_loss sum 1.865267276763916
Total (block generation + training)time/epoch 0.09549617767333984
Training time/epoch 0.040699005126953125
Training time without block to device /epoch 0.03894948959350586
Training time without total dataloading part /epoch 0.026662111282348633
load block tensor time/epoch 0.007556438446044922
block to device time/epoch 0.0017495155334472656
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15781
Number of first layer input nodes during this epoch:  12394
