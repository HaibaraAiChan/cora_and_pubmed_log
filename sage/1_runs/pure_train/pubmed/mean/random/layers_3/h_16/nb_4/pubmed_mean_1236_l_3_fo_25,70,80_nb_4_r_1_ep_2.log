main start at this time 1648525973.3705993
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0017812252044677734
random selection method range initialization spend 0.00021648406982421875
time for parepare:  5.2928924560546875e-05
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.001804351806640625
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  6.651878356933594e-05
----------------------check_connections_block total spend ----------------------------- 0.002598285675048828
generate_one_block  0.001600503921508789
generate_one_block  0.0013685226440429688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010142326354980469
gen group dst list time:  3.0517578125e-05
time for parepare:  0.0003058910369873047
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.000247955322265625
mini_batch_src_global generation:  9.584426879882812e-05
r_  generation:  0.0009605884552001953
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0006344318389892578
----------------------check_connections_block total spend ----------------------------- 0.0030355453491210938
generate_one_block  0.0026471614837646484
generate_one_block  0.002084493637084961
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011737346649169922
gen group dst list time:  8.177757263183594e-05
time for parepare:  0.0009100437164306641
local_output_nid generation:  0.00015974044799804688
local_in_edges_tensor generation:  0.0005257129669189453
mini_batch_src_global generation:  0.0004520416259765625
r_  generation:  0.005780220031738281
local_output_nid generation:  0.0001285076141357422
local_in_edges_tensor generation:  0.00033354759216308594
mini_batch_src_global generation:  0.0004715919494628906
r_  generation:  0.0036525726318359375
----------------------check_connections_block total spend ----------------------------- 0.014988183975219727
generate_one_block  0.007534503936767578
generate_one_block  0.004469156265258789
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.771087646484375e-05  GigaBytes
Max Memory Allocated: 6.771087646484375e-05  GigaBytes

connection checking time:  0.01802372932434082
block generation total time  0.016735315322875977
average batch blocks generation time:  0.008367657661437988
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.010650634765625  GigaBytes
Max Memory Allocated: 0.010650634765625  GigaBytes

torch.Size([5609, 500])
torch.Size([1656, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.01117706298828125  GigaBytes
Max Memory Allocated: 0.011481285095214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008617401123046875  GigaBytes
Max Memory Allocated: 0.018983840942382812  GigaBytes

torch.Size([4510, 500])
torch.Size([1234, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008993148803710938  GigaBytes
Max Memory Allocated: 0.018983840942382812  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011937975883483887 |0.1720411777496338 |0.3844873905181885 |0.00021958351135253906 |0.004324436187744141 |0.0022470951080322266 |
----------------------------------------------------------pseudo_mini_loss sum 1.6315176486968994
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13364
Number of first layer input nodes during this epoch:  10119
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008939743041992188  GigaBytes
Max Memory Allocated: 0.018983840942382812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005064010620117188
random selection method range initialization spend 0.00011086463928222656
time for parepare:  4.696846008300781e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  6.318092346191406e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.842613220214844e-05
----------------------check_connections_block total spend ----------------------------- 0.0007171630859375
generate_one_block  0.0011496543884277344
generate_one_block  0.0011413097381591797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005223751068115234
gen group dst list time:  2.4318695068359375e-05
time for parepare:  0.0002701282501220703
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0005815029144287109
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.0006992816925048828
----------------------check_connections_block total spend ----------------------------- 0.0024652481079101562
generate_one_block  0.0018305778503417969
generate_one_block  0.0019402503967285156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009751319885253906
gen group dst list time:  8.440017700195312e-05
time for parepare:  0.0006983280181884766
local_output_nid generation:  9.846687316894531e-05
local_in_edges_tensor generation:  0.0003859996795654297
mini_batch_src_global generation:  0.0003108978271484375
r_  generation:  0.003801584243774414
local_output_nid generation:  0.0001270771026611328
local_in_edges_tensor generation:  0.00033974647521972656
mini_batch_src_global generation:  0.0004639625549316406
r_  generation:  0.0037224292755126953
----------------------check_connections_block total spend ----------------------------- 0.012129783630371094
generate_one_block  0.00630497932434082
generate_one_block  0.005558013916015625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008939743041992188  GigaBytes
Max Memory Allocated: 0.018983840942382812  GigaBytes

connection checking time:  0.01459503173828125
block generation total time  0.015633821487426758
average batch blocks generation time:  0.007816910743713379
block dataloader generation time/epoch 0.04353928565979004
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.009372711181640625  GigaBytes
Max Memory Allocated: 0.018983840942382812  GigaBytes
Using backend: pytorch

torch.Size([4830, 500])
torch.Size([1287, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.009789466857910156  GigaBytes
Max Memory Allocated: 0.018983840942382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.010327816009521484  GigaBytes
Max Memory Allocated: 0.019219398498535156  GigaBytes

torch.Size([5346, 500])
torch.Size([1615, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.010817527770996094  GigaBytes
Max Memory Allocated: 0.019219398498535156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0031501054763793945 |0.00044715404510498047 |0.003239274024963379 |0.00012493133544921875 |0.002869248390197754 |0.0023651123046875 |
----------------------------------------------------------pseudo_mini_loss sum 1.6437424421310425
Total (block generation + training)time/epoch 0.06844425201416016
Training time/epoch 0.024687767028808594
Training time without block to device /epoch 0.023793458938598633
Training time without total dataloading part /epoch 0.014832019805908203
load block tensor time/epoch 0.006300210952758789
block to device time/epoch 0.0008943080902099609
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13434
Number of first layer input nodes during this epoch:  10176
