Using backend: pytorch
main start at this time 1648526413.337287
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0028374195098876953
random selection method range initialization spend 0.00019097328186035156
time for parepare:  4.38690185546875e-05
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0012195110321044922
----------------------check_connections_block total spend ----------------------------- 0.0016398429870605469
generate_one_block  0.0014727115631103516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0014374256134033203
gen group dst list time:  2.002716064453125e-05
time for parepare:  0.0002570152282714844
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00022840499877929688
mini_batch_src_global generation:  0.00012755393981933594
r_  generation:  0.0012323856353759766
----------------------check_connections_block total spend ----------------------------- 0.002224445343017578
generate_one_block  0.002844572067260742
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010526180267333984
gen group dst list time:  5.245208740234375e-05
time for parepare:  0.0007565021514892578
local_output_nid generation:  0.0001780986785888672
local_in_edges_tensor generation:  0.0005922317504882812
mini_batch_src_global generation:  0.0007221698760986328
r_  generation:  0.007243156433105469
----------------------check_connections_block total spend ----------------------------- 0.011723518371582031
generate_one_block  0.010492563247680664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

connection checking time:  0.01394796371459961
block generation total time  0.013337135314941406
average batch blocks generation time:  0.013337135314941406
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.016396045684814453  GigaBytes
Max Memory Allocated: 0.016396045684814453  GigaBytes

torch.Size([8535, 500])
torch.Size([2706, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.019103050231933594  GigaBytes
Max Memory Allocated: 0.02057647705078125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005808353424072266 |0.33732032775878906 |0.7642264366149902 |0.0002582073211669922 |0.00835871696472168 |0.004118204116821289 |
----------------------------------------------------------pseudo_mini_loss sum 2.6306955814361572
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  11595
Number of first layer input nodes during this epoch:  8535
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017716407775878906  GigaBytes
Max Memory Allocated: 0.02057647705078125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007550716400146484
random selection method range initialization spend 0.0001690387725830078
time for parepare:  8.58306884765625e-05
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.0002815723419189453
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.000171661376953125
----------------------check_connections_block total spend ----------------------------- 0.0007688999176025391
generate_one_block  0.002061128616333008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008060932159423828
gen group dst list time:  3.0517578125e-05
time for parepare:  0.0004558563232421875
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.00033974647521972656
mini_batch_src_global generation:  0.00022912025451660156
r_  generation:  0.001918792724609375
----------------------check_connections_block total spend ----------------------------- 0.003566265106201172
generate_one_block  0.003513336181640625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012888908386230469
gen group dst list time:  8.296966552734375e-05
time for parepare:  0.0009670257568359375
local_output_nid generation:  0.0002627372741699219
local_in_edges_tensor generation:  0.0006632804870605469
mini_batch_src_global generation:  0.0010492801666259766
r_  generation:  0.00911402702331543
----------------------check_connections_block total spend ----------------------------- 0.01495981216430664
generate_one_block  0.010532855987548828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017716407775878906  GigaBytes
Max Memory Allocated: 0.02057647705078125  GigaBytes

connection checking time:  0.018526077270507812
block generation total time  0.014046192169189453
average batch blocks generation time:  0.014046192169189453
block dataloader generation time/epoch 0.054543256759643555
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01717519760131836  GigaBytes
Max Memory Allocated: 0.0328521728515625  GigaBytes

torch.Size([8514, 500])
torch.Size([2704, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019878387451171875  GigaBytes
Max Memory Allocated: 0.0328521728515625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0037021636962890625 |0.0006830692291259766 |0.004178285598754883 |0.000164031982421875 |0.0024247169494628906 |0.002093076705932617 |
----------------------------------------------------------pseudo_mini_loss sum 1.3828835487365723
Total (block generation + training)time/epoch 0.06978511810302734
Training time/epoch 0.01505422592163086
Training time without block to device /epoch 0.014371156692504883
Training time without total dataloading part /epoch 0.008860111236572266
load block tensor time/epoch 0.0037021636962890625
block to device time/epoch 0.0006830692291259766
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  11572
Number of first layer input nodes during this epoch:  8514
