main start at this time 1648526333.3873582
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011839866638183594
random selection method range initialization spend 0.00018310546875
time for parepare:  4.76837158203125e-05
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0012128353118896484
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.982948303222656e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.457069396972656e-05
----------------------check_connections_block total spend ----------------------------- 0.0022673606872558594
generate_one_block  0.001291513442993164
generate_one_block  0.0011212825775146484
generate_one_block  0.00115203857421875
generate_one_block  0.0011026859283447266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008165836334228516
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.00023627281188964844
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00022673606872558594
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0003955364227294922
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.00028228759765625
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0004374980926513672
----------------------check_connections_block total spend ----------------------------- 0.0028498172760009766
generate_one_block  0.0013775825500488281
generate_one_block  0.001566171646118164
generate_one_block  0.0014379024505615234
generate_one_block  0.0016369819641113281
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010142326354980469
gen group dst list time:  7.414817810058594e-05
time for parepare:  0.0007648468017578125
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.0002880096435546875
mini_batch_src_global generation:  0.00011205673217773438
r_  generation:  0.0012080669403076172
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.0002346038818359375
mini_batch_src_global generation:  0.0002124309539794922
r_  generation:  0.0021817684173583984
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  0.00020384788513183594
r_  generation:  0.00180816650390625
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.00023365020751953125
r_  generation:  0.0025985240936279297
----------------------check_connections_block total spend ----------------------------- 0.012551069259643555
generate_one_block  0.0029320716857910156
generate_one_block  0.003688812255859375
generate_one_block  0.0032749176025390625
generate_one_block  0.00481724739074707
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

connection checking time:  0.015400886535644531
block generation total time  0.020731687545776367
average batch blocks generation time:  0.005182921886444092
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.004330158233642578  GigaBytes
Max Memory Allocated: 0.004330158233642578  GigaBytes

torch.Size([2158, 500])
torch.Size([427, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004794120788574219  GigaBytes
Max Memory Allocated: 0.005183219909667969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007158756256103516  GigaBytes
Max Memory Allocated: 0.011117935180664062  GigaBytes

torch.Size([3515, 500])
torch.Size([809, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007970333099365234  GigaBytes
Max Memory Allocated: 0.011117935180664062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005616188049316406  GigaBytes
Max Memory Allocated: 0.012112617492675781  GigaBytes

torch.Size([2692, 500])
torch.Size([602, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006222724914550781  GigaBytes
Max Memory Allocated: 0.012112617492675781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006484508514404297  GigaBytes
Max Memory Allocated: 0.012112617492675781  GigaBytes

torch.Size([3147, 500])
torch.Size([960, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007398128509521484  GigaBytes
Max Memory Allocated: 0.012112617492675781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0022217631340026855 |0.0871734619140625 |0.1950598955154419 |0.00017189979553222656 |0.0030915141105651855 |0.0022690296173095703 |
----------------------------------------------------------pseudo_mini_loss sum 2.8231124877929688
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14667
Number of first layer input nodes during this epoch:  11512
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007195472717285156  GigaBytes
Max Memory Allocated: 0.012112617492675781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005626678466796875
random selection method range initialization spend 0.00013780593872070312
time for parepare:  6.079673767089844e-05
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.0001251697540283203
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.054473876953125e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.412101745605469e-05
----------------------check_connections_block total spend ----------------------------- 0.0012714862823486328
generate_one_block  0.0013294219970703125
generate_one_block  0.0012519359588623047
generate_one_block  0.0014238357543945312
generate_one_block  0.0012750625610351562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006153583526611328
gen group dst list time:  4.1961669921875e-05
time for parepare:  0.00032639503479003906
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.0005197525024414062
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.00022745132446289062
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0005173683166503906
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0003147125244140625
----------------------check_connections_block total spend ----------------------------- 0.0033791065216064453
generate_one_block  0.0019011497497558594
generate_one_block  0.0014889240264892578
generate_one_block  0.0019001960754394531
generate_one_block  0.0015666484832763672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011768341064453125
gen group dst list time:  0.0001087188720703125
time for parepare:  0.0009176731109619141
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.0003800392150878906
mini_batch_src_global generation:  0.0003981590270996094
r_  generation:  0.0033435821533203125
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  0.00022864341735839844
r_  generation:  0.0012280941009521484
local_output_nid generation:  0.00010657310485839844
local_in_edges_tensor generation:  0.0002949237823486328
mini_batch_src_global generation:  0.00032830238342285156
r_  generation:  0.003390789031982422
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  0.00020885467529296875
r_  generation:  0.0014333724975585938
----------------------check_connections_block total spend ----------------------------- 0.015742063522338867
generate_one_block  0.004386425018310547
generate_one_block  0.002120494842529297
generate_one_block  0.004398822784423828
generate_one_block  0.002440214157104492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007195472717285156  GigaBytes
Max Memory Allocated: 0.012112617492675781  GigaBytes

connection checking time:  0.019121170043945312
block generation total time  0.0202028751373291
average batch blocks generation time:  0.005050718784332275
block dataloader generation time/epoch 0.05778360366821289
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007807254791259766  GigaBytes
Max Memory Allocated: 0.013590335845947266  GigaBytes

torch.Size([3561, 500])
torch.Size([907, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008693695068359375  GigaBytes
Max Memory Allocated: 0.013590335845947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.003978252410888672  GigaBytes
Max Memory Allocated: 0.013590335845947266  GigaBytes

torch.Size([1533, 500])
torch.Size([441, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004404544830322266  GigaBytes
Max Memory Allocated: 0.013590335845947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008622169494628906  GigaBytes
Max Memory Allocated: 0.013590335845947266  GigaBytes

torch.Size([3997, 500])
torch.Size([983, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009589195251464844  GigaBytes
Max Memory Allocated: 0.013590335845947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00547027587890625  GigaBytes
Max Memory Allocated: 0.013590335845947266  GigaBytes

torch.Size([2329, 500])
torch.Size([473, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005993843078613281  GigaBytes
Max Memory Allocated: 0.013590335845947266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001216888427734375 |0.0005041360855102539 |0.003692030906677246 |0.00013649463653564453 |0.002326488494873047 |0.0014433860778808594 |
----------------------------------------------------------pseudo_mini_loss sum 1.656125783920288
Total (block generation + training)time/epoch 0.0961310863494873
Training time/epoch 0.03816795349121094
Training time without block to device /epoch 0.03615140914916992
Training time without total dataloading part /epoch 0.02606344223022461
load block tensor time/epoch 0.0048675537109375
block to device time/epoch 0.0020165443420410156
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14580
Number of first layer input nodes during this epoch:  11420
