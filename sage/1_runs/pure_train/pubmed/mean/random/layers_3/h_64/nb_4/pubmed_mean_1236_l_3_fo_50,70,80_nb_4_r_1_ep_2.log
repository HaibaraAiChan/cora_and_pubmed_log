main start at this time 1648526423.4125407
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0017976760864257812
random selection method range initialization spend 0.00018858909606933594
time for parepare:  4.2438507080078125e-05
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0016751289367675781
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  5.7697296142578125e-05
----------------------check_connections_block total spend ----------------------------- 0.002336740493774414
generate_one_block  0.0013501644134521484
generate_one_block  0.0011184215545654297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009472370147705078
gen group dst list time:  2.3603439331054688e-05
time for parepare:  0.00022721290588378906
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0005147457122802734
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0006740093231201172
----------------------check_connections_block total spend ----------------------------- 0.0022797584533691406
generate_one_block  0.0018286705017089844
generate_one_block  0.0019290447235107422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010197162628173828
gen group dst list time:  5.8650970458984375e-05
time for parepare:  0.0007050037384033203
local_output_nid generation:  9.059906005859375e-05
local_in_edges_tensor generation:  0.0003883838653564453
mini_batch_src_global generation:  0.0002605915069580078
r_  generation:  0.0033342838287353516
local_output_nid generation:  0.00011110305786132812
local_in_edges_tensor generation:  0.0003275871276855469
mini_batch_src_global generation:  0.0005559921264648438
r_  generation:  0.004297018051147461
----------------------check_connections_block total spend ----------------------------- 0.01227712631225586
generate_one_block  0.0055446624755859375
generate_one_block  0.006559610366821289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

connection checking time:  0.014556884765625
block generation total time  0.015861988067626953
average batch blocks generation time:  0.007930994033813477
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.012099742889404297  GigaBytes
Max Memory Allocated: 0.012099742889404297  GigaBytes

torch.Size([5917, 500])
torch.Size([1232, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013373374938964844  GigaBytes
Max Memory Allocated: 0.014491081237792969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.010221004486083984  GigaBytes
Max Memory Allocated: 0.021800994873046875  GigaBytes

torch.Size([5117, 500])
torch.Size([1604, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.011783123016357422  GigaBytes
Max Memory Allocated: 0.021800994873046875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012818098068237305 |0.18578803539276123 |0.3886939287185669 |0.0002532005310058594 |0.00481414794921875 |0.003314495086669922 |
----------------------------------------------------------pseudo_mini_loss sum 2.913381576538086
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14225
Number of first layer input nodes during this epoch:  11034
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.011078357696533203  GigaBytes
Max Memory Allocated: 0.021800994873046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006453990936279297
random selection method range initialization spend 0.00014901161193847656
time for parepare:  5.793571472167969e-05
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00010895729064941406
----------------------check_connections_block total spend ----------------------------- 0.0008916854858398438
generate_one_block  0.0015163421630859375
generate_one_block  0.001493692398071289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006649494171142578
gen group dst list time:  2.4557113647460938e-05
time for parepare:  0.00026798248291015625
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0005924701690673828
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0006768703460693359
----------------------check_connections_block total spend ----------------------------- 0.0024268627166748047
generate_one_block  0.0017642974853515625
generate_one_block  0.0018286705017089844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010726451873779297
gen group dst list time:  6.937980651855469e-05
time for parepare:  0.0007333755493164062
local_output_nid generation:  0.00010275840759277344
local_in_edges_tensor generation:  0.000400543212890625
mini_batch_src_global generation:  0.0003306865692138672
r_  generation:  0.0038056373596191406
local_output_nid generation:  0.00011754035949707031
local_in_edges_tensor generation:  0.0003094673156738281
mini_batch_src_global generation:  0.0005848407745361328
r_  generation:  0.0045702457427978516
----------------------check_connections_block total spend ----------------------------- 0.013477325439453125
generate_one_block  0.005913972854614258
generate_one_block  0.0071642398834228516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.011078357696533203  GigaBytes
Max Memory Allocated: 0.021800994873046875  GigaBytes

connection checking time:  0.01590418815612793
block generation total time  0.016671180725097656
average batch blocks generation time:  0.008335590362548828
block dataloader generation time/epoch 0.04926753044128418
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.011211872100830078  GigaBytes
Max Memory Allocated: 0.021800994873046875  GigaBytes
Using backend: pytorch

torch.Size([4964, 500])
torch.Size([1377, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.012553215026855469  GigaBytes
Max Memory Allocated: 0.021800994873046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01345968246459961  GigaBytes
Max Memory Allocated: 0.023318767547607422  GigaBytes

torch.Size([6562, 500])
torch.Size([1580, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015066146850585938  GigaBytes
Max Memory Allocated: 0.023318767547607422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0038216114044189453 |0.0004405975341796875 |0.003166794776916504 |0.0001304149627685547 |0.003398895263671875 |0.0015368461608886719 |
----------------------------------------------------------pseudo_mini_loss sum 1.2097125053405762
Total (block generation + training)time/epoch 0.07539057731628418
Training time/epoch 0.025961637496948242
Training time without block to device /epoch 0.025080442428588867
Training time without total dataloading part /epoch 0.014929056167602539
load block tensor time/epoch 0.007643222808837891
block to device time/epoch 0.000881195068359375
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14839
Number of first layer input nodes during this epoch:  11526
