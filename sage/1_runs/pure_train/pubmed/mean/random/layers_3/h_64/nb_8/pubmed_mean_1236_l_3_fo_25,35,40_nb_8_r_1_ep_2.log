main start at this time 1648526283.4530785
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0016217231750488281
random selection method range initialization spend 0.0002048015594482422
time for parepare:  4.2438507080078125e-05
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.001169443130493164
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.266334533691406e-05
----------------------check_connections_block total spend ----------------------------- 0.0021779537200927734
generate_one_block  0.0012569427490234375
generate_one_block  0.001077890396118164
generate_one_block  0.0010709762573242188
generate_one_block  0.0009975433349609375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008614063262939453
gen group dst list time:  3.1948089599609375e-05
time for parepare:  0.00022363662719726562
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00021028518676757812
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0003352165222167969
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00025153160095214844
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.00039005279541015625
----------------------check_connections_block total spend ----------------------------- 0.002585887908935547
generate_one_block  0.0013136863708496094
generate_one_block  0.0014958381652832031
generate_one_block  0.001299142837524414
generate_one_block  0.0015583038330078125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000934600830078125
gen group dst list time:  6.580352783203125e-05
time for parepare:  0.0007007122039794922
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00027179718017578125
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0011281967163085938
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00022292137145996094
mini_batch_src_global generation:  0.00019025802612304688
r_  generation:  0.0020508766174316406
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  0.0001823902130126953
r_  generation:  0.001703023910522461
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  0.00022292137145996094
r_  generation:  0.0024564266204833984
----------------------check_connections_block total spend ----------------------------- 0.011766195297241211
generate_one_block  0.003482341766357422
generate_one_block  0.0036215782165527344
generate_one_block  0.0030684471130371094
generate_one_block  0.0039348602294921875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

connection checking time:  0.014352083206176758
block generation total time  0.019774198532104492
average batch blocks generation time:  0.004943549633026123
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.004307746887207031  GigaBytes
Max Memory Allocated: 0.004307746887207031  GigaBytes

torch.Size([2146, 500])
torch.Size([427, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004771709442138672  GigaBytes
Max Memory Allocated: 0.005157947540283203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007225990295410156  GigaBytes
Max Memory Allocated: 0.011162757873535156  GigaBytes

torch.Size([3551, 500])
torch.Size([811, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008038997650146484  GigaBytes
Max Memory Allocated: 0.011162757873535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005585670471191406  GigaBytes
Max Memory Allocated: 0.012150287628173828  GigaBytes

torch.Size([2676, 500])
torch.Size([597, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006187915802001953  GigaBytes
Max Memory Allocated: 0.012150287628173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006548881530761719  GigaBytes
Max Memory Allocated: 0.012150287628173828  GigaBytes

torch.Size([3181, 500])
torch.Size([959, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0074634552001953125  GigaBytes
Max Memory Allocated: 0.012150287628173828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0038469433784484863 |0.08665502071380615 |0.1940673589706421 |0.00017005205154418945 |0.0031426548957824707 |0.003683328628540039 |
----------------------------------------------------------pseudo_mini_loss sum 2.8125522136688232
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14705
Number of first layer input nodes during this epoch:  11554
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007261753082275391  GigaBytes
Max Memory Allocated: 0.012150287628173828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009357929229736328
random selection method range initialization spend 0.0001938343048095703
time for parepare:  9.584426879882812e-05
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0003070831298828125
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  8.654594421386719e-05
local_output_nid generation:  1.4543533325195312e-05Using backend: pytorch

local_in_edges_tensor generation:  0.0002486705780029297
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  9.250640869140625e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0002262592315673828
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  6.413459777832031e-05
----------------------check_connections_block total spend ----------------------------- 0.0020914077758789062
generate_one_block  0.0015153884887695312
generate_one_block  0.0014314651489257812
generate_one_block  0.001676797866821289
generate_one_block  0.0014607906341552734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007326602935791016
gen group dst list time:  4.649162292480469e-05
time for parepare:  0.0003361701965332031
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0006103515625
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0002665519714355469
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.0004055500030517578
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0002512931823730469
----------------------check_connections_block total spend ----------------------------- 0.003362894058227539
generate_one_block  0.0015714168548583984
generate_one_block  0.00124359130859375
generate_one_block  0.0015909671783447266
generate_one_block  0.0012907981872558594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00093841552734375
gen group dst list time:  7.677078247070312e-05
time for parepare:  0.0007016658782958984
local_output_nid generation:  7.05718994140625e-05
local_in_edges_tensor generation:  0.00035262107849121094
mini_batch_src_global generation:  0.0002636909484863281
r_  generation:  0.0025827884674072266
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00017595291137695312
r_  generation:  0.0009808540344238281
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.00024509429931640625
mini_batch_src_global generation:  0.00022602081298828125
r_  generation:  0.0027337074279785156
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  0.00016498565673828125
r_  generation:  0.0012319087982177734
----------------------check_connections_block total spend ----------------------------- 0.012410163879394531
generate_one_block  0.0044171810150146484
generate_one_block  0.0021164417266845703
generate_one_block  0.004355907440185547
generate_one_block  0.002437591552734375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007261753082275391  GigaBytes
Max Memory Allocated: 0.012150287628173828  GigaBytes

connection checking time:  0.01577305793762207
block generation total time  0.019023895263671875
average batch blocks generation time:  0.004755973815917969
block dataloader generation time/epoch 0.05884194374084473
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007823944091796875  GigaBytes
Max Memory Allocated: 0.01367044448852539  GigaBytes

torch.Size([3570, 500])
torch.Size([906, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008708953857421875  GigaBytes
Max Memory Allocated: 0.01367044448852539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.003963470458984375  GigaBytes
Max Memory Allocated: 0.01367044448852539  GigaBytes

torch.Size([1525, 500])
torch.Size([440, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004387855529785156  GigaBytes
Max Memory Allocated: 0.01367044448852539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008624076843261719  GigaBytes
Max Memory Allocated: 0.01367044448852539  GigaBytes

torch.Size([3998, 500])
torch.Size([984, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009591102600097656  GigaBytes
Max Memory Allocated: 0.01367044448852539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005494594573974609  GigaBytes
Max Memory Allocated: 0.01367044448852539  GigaBytes

torch.Size([2342, 500])
torch.Size([474, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006018161773681641  GigaBytes
Max Memory Allocated: 0.01367044448852539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001744687557220459 |0.00041240453720092773 |0.003277122974395752 |0.00011867284774780273 |0.002794325351715088 |0.0014488697052001953 |
----------------------------------------------------------pseudo_mini_loss sum 1.6478958129882812
Total (block generation + training)time/epoch 0.09846854209899902
Training time/epoch 0.03937792778015137
Training time without block to device /epoch 0.037728309631347656
Training time without total dataloading part /epoch 0.026209354400634766
load block tensor time/epoch 0.006978750228881836
block to device time/epoch 0.001649618148803711
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14595
Number of first layer input nodes during this epoch:  11435
