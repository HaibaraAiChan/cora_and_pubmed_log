main start at this time 1648526303.3887258
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002475261688232422
random selection method range initialization spend 0.0001983642578125
time for parepare:  4.291534423828125e-05
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.0011320114135742188
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6689300537109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.1920928955078125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.5497207641601562e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.33514404296875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4781951904296875e-05
----------------------check_connections_block total spend ----------------------------- 0.003796100616455078
generate_one_block  0.001325845718383789
generate_one_block  0.001010894775390625
generate_one_block  0.0010056495666503906
generate_one_block  0.0010471343994140625
generate_one_block  0.001012563705444336
generate_one_block  0.0009882450103759766
generate_one_block  0.0010423660278320312
generate_one_block  0.0010402202606201172
generate_one_block  0.0010447502136230469
generate_one_block  0.000993490219116211
generate_one_block  0.0010004043579101562
generate_one_block  0.001001596450805664
generate_one_block  0.0009753704071044922
generate_one_block  0.0010516643524169922
generate_one_block  0.0010061264038085938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010559558868408203
gen group dst list time:  7.987022399902344e-05
time for parepare:  0.0002281665802001953
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  7.128715515136719e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  7.82012939453125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00011181831359863281
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.0001251697540283203
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0001437664031982422
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00017380714416503906
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.054473876953125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00012683868408203125
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0001614093780517578
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  9.393692016601562e-05
----------------------check_connections_block total spend ----------------------------- 0.004521846771240234
generate_one_block  0.0010950565338134766
generate_one_block  0.0010933876037597656
generate_one_block  0.0010535717010498047
generate_one_block  0.001079559326171875
generate_one_block  0.0011477470397949219
generate_one_block  0.0010230541229248047
generate_one_block  0.0011668205261230469
generate_one_block  0.0012390613555908203
generate_one_block  0.0011906623840332031
generate_one_block  0.000990152359008789
generate_one_block  0.0010216236114501953
generate_one_block  0.001116037368774414
generate_one_block  0.0010406970977783203
generate_one_block  0.0011644363403320312
generate_one_block  0.0010707378387451172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001077413558959961
gen group dst list time:  0.000125885009765625
time for parepare:  0.0007050037384033203
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0002689361572265625
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0003483295440673828
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.00038552284240722656
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0003325939178466797
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00025200843811035156
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0005114078521728516
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0001957416534423828
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0008423328399658203
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.0007541179656982422
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.001237630844116211
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.00019931793212890625
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.000244140625
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0006735324859619141
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00037550926208496094
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0011186599731445312
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0005042552947998047
----------------------check_connections_block total spend ----------------------------- 0.014684200286865234
generate_one_block  0.0014858245849609375
generate_one_block  0.00147247314453125
generate_one_block  0.0014257431030273438
generate_one_block  0.0012311935424804688
generate_one_block  0.001561880111694336
generate_one_block  0.0012078285217285156
generate_one_block  0.0021514892578125
generate_one_block  0.002607107162475586
generate_one_block  0.0025453567504882812
generate_one_block  0.0011620521545410156
generate_one_block  0.0012364387512207031
generate_one_block  0.0017545223236083984
generate_one_block  0.0014209747314453125
generate_one_block  0.0022401809692382812
generate_one_block  0.001789093017578125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

connection checking time:  0.01920604705810547
block generation total time  0.04178476333618164
average batch blocks generation time:  0.002785650889078776
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0017557144165039062  GigaBytes
Max Memory Allocated: 0.0017557144165039062  GigaBytes

torch.Size([788, 500])
torch.Size([107, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0018835067749023438  GigaBytes
Max Memory Allocated: 0.0020303726196289062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0017719268798828125  GigaBytes
Max Memory Allocated: 0.0032281875610351562  GigaBytes

torch.Size([649, 500])
torch.Size([146, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.001922607421875  GigaBytes
Max Memory Allocated: 0.0032281875610351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002028942108154297  GigaBytes
Max Memory Allocated: 0.0032281875610351562  GigaBytes

torch.Size([622, 500])
torch.Size([93, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0021300315856933594  GigaBytes
Max Memory Allocated: 0.0032281875610351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.001369476318359375  GigaBytes
Max Memory Allocated: 0.0032281875610351562  GigaBytes

torch.Size([435, 500])
torch.Size([113, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0015087127685546875  GigaBytes
Max Memory Allocated: 0.0032281875610351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0019116401672363281  GigaBytes
Max Memory Allocated: 0.0032281875610351562  GigaBytes

torch.Size([722, 500])
torch.Size([208, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002117633819580078  GigaBytes
Max Memory Allocated: 0.0032281875610351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0011754035949707031  GigaBytes
Max Memory Allocated: 0.0032281875610351562  GigaBytes

torch.Size([332, 500])
torch.Size([73, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0012531280517578125  GigaBytes
Max Memory Allocated: 0.0032281875610351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004149913787841797  GigaBytes
Max Memory Allocated: 0.004744052886962891  GigaBytes

torch.Size([1919, 500])
torch.Size([276, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004440784454345703  GigaBytes
Max Memory Allocated: 0.004828929901123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003075122833251953  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

torch.Size([1343, 500])
torch.Size([311, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003395557403564453  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004164218902587891  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

torch.Size([1855, 500])
torch.Size([360, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0045261383056640625  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0012102127075195312  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

torch.Size([351, 500])
torch.Size([64, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00128936767578125  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0013666152954101562  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

torch.Size([434, 500])
torch.Size([113, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0014786720275878906  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002869129180908203  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

torch.Size([1234, 500])
torch.Size([312, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0031685829162597656  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.001804351806640625  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

torch.Size([667, 500])
torch.Size([159, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0019583702087402344  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002884387969970703  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

torch.Size([1186, 500])
torch.Size([309, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0031938552856445312  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0019927024841308594  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

torch.Size([766, 500])
torch.Size([227, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0022096633911132812  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001752297083536784 |0.02345590591430664 |0.054891713460286456 |0.00015257199605305988 |0.002938079833984375 |0.0021796226501464844 |
----------------------------------------------------------pseudo_mini_loss sum 2.31623911857605
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16531
Number of first layer input nodes during this epoch:  13303
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002574443817138672  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004837512969970703
random selection method range initialization spend 0.00011014938354492188
time for parepare:  4.458427429199219e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.430511474609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.3113021850585938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.4781951904296875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.0028162002563476562
generate_one_block  0.001070261001586914
generate_one_block  0.0009775161743164062
generate_one_block  0.000995635986328125
generate_one_block  0.0009715557098388672
generate_one_block  0.0009453296661376953
generate_one_block  0.0011408329010009766
generate_one_block  0.0009567737579345703
generate_one_block  0.0010204315185546875
generate_one_block  0.0009565353393554688
generate_one_block  0.0009663105010986328
generate_one_block  0.0009672641754150391
generate_one_block  0.0009884834289550781
generate_one_block  0.0009696483612060547
generate_one_block  0.0009572505950927734
generate_one_block  0.0009965896606445312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006225109100341797
gen group dst list time:  7.414817810058594e-05
time for parepare:  0.00023436546325683594
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  6.866455078125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0002605915069580078
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  7.128715515136719e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  9.083747863769531e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00014162063598632812
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00018095970153808594
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  0.0001327991485595703
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.389617919921875e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.910064697265625e-05
----------------------check_connections_block total spend ----------------------------- 0.004338741302490234
generate_one_block  0.0010411739349365234
generate_one_block  0.001394510269165039
generate_one_block  0.001161813735961914
generate_one_block  0.0009851455688476562
generate_one_block  0.000989675521850586
generate_one_block  0.0010411739349365234
generate_one_block  0.0010390281677246094
generate_one_block  0.0010685920715332031
generate_one_block  0.0010547637939453125
generate_one_block  0.0011625289916992188
generate_one_block  0.0011668205261230469
generate_one_block  0.0010120868682861328
generate_one_block  0.0011410713195800781
generate_one_block  0.0010225772857666016
generate_one_block  0.0009875297546386719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000995635986328125
gen group dst list time:  0.00012540817260742188
time for parepare:  0.0007300376892089844
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00024366378784179688
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0003933906555175781
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.0002377033233642578
r_  generation:  0.0018184185028076172
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.00042366981506347656
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00014281272888183594
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00015974044799804688
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  9.131431579589844e-05
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00032520294189453125
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.0006136894226074219
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.00043845176696777344
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0007550716400146484
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  0.00012159347534179688
r_  generation:  0.0012280941009521484
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0001819133758544922
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0005331039428710938
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00043010711669921875
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.000186920166015625
----------------------check_connections_block total spend ----------------------------- 0.014307260513305664
generate_one_block  0.0016682147979736328
generate_one_block  0.003234386444091797
generate_one_block  0.0014557838439941406
generate_one_block  0.0011091232299804688
generate_one_block  0.0011854171752929688
generate_one_block  0.0010576248168945312
generate_one_block  0.0013463497161865234
generate_one_block  0.0016887187957763672
generate_one_block  0.0015437602996826172
generate_one_block  0.0019681453704833984
generate_one_block  0.0032706260681152344
generate_one_block  0.0011487007141113281
generate_one_block  0.0016007423400878906
generate_one_block  0.0016474723815917969
generate_one_block  0.001135110855102539
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002574443817138672  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

connection checking time:  0.0186460018157959
block generation total time  0.04132866859436035
average batch blocks generation time:  0.002755244572957357
block dataloader generation time/epoch 0.09347677230834961
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003407001495361328  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

torch.Size([862, 500])
torch.Size([127, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003543376922607422  GigaBytes
Max Memory Allocated: 0.006627559661865234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0060100555419921875  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

torch.Size([2608, 500])
torch.Size([608, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00659942626953125  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0024170875549316406  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

torch.Size([702, 500])
torch.Size([155, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0025739669799804688  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0015554428100585938  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

torch.Size([244, 500])
torch.Size([75, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0016350746154785156  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0015916824340820312  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

torch.Size([263, 500])
torch.Size([98, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0016870498657226562  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0014033317565917969  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

torch.Size([163, 500])
torch.Size([52, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0014672279357910156  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0020723342895507812  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

torch.Size([518, 500])
torch.Size([177, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.002242565155029297  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00322723388671875  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

torch.Size([1134, 500])
torch.Size([231, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0034508705139160156  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0029196739196777344  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

torch.Size([971, 500])
torch.Size([117, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.003052234649658203  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.003928661346435547  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

torch.Size([1508, 500])
torch.Size([330, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004264354705810547  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005054950714111328  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

torch.Size([1745, 500])
torch.Size([411, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005455493927001953  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0016922950744628906  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

torch.Size([317, 500])
torch.Size([55, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0017690658569335938  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0029592514038085938  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

torch.Size([991, 500])
torch.Size([227, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0032205581665039062  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0031499862670898438  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

torch.Size([1095, 500])
torch.Size([142, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0033011436462402344  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0016789436340332031  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes
Using backend: pytorch

torch.Size([310, 500])
torch.Size([75, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0017614364624023438  GigaBytes
Max Memory Allocated: 0.008253097534179688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0007101217905680339 |0.00039761861165364584 |0.003166532516479492 |0.00011653900146484375 |0.003112904230753581 |0.0013802051544189453 |
----------------------------------------------------------pseudo_mini_loss sum 2.2782974243164062
Total (block generation + training)time/epoch 0.22478103637695312
Training time/epoch 0.13104701042175293
Training time without block to device /epoch 0.12508273124694824
Training time without total dataloading part /epoch 0.0973198413848877
load block tensor time/epoch 0.010651826858520508
block to device time/epoch 0.0059642791748046875
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16668
Number of first layer input nodes during this epoch:  13431
