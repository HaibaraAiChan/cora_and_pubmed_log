Using backend: pytorch
main start at this time 1648526363.4116256
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002415895462036133
random selection method range initialization spend 0.0001652240753173828
time for parepare:  4.267692565917969e-05
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0012521743774414062
----------------------check_connections_block total spend ----------------------------- 0.001661062240600586
generate_one_block  0.0014204978942871094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012793540954589844
gen group dst list time:  1.8358230590820312e-05
time for parepare:  0.00022268295288085938
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  0.0001266002655029297
r_  generation:  0.0011279582977294922
----------------------check_connections_block total spend ----------------------------- 0.002056121826171875
generate_one_block  0.002827167510986328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009756088256835938
gen group dst list time:  4.982948303222656e-05
time for parepare:  0.0006909370422363281
local_output_nid generation:  0.00017547607421875
local_in_edges_tensor generation:  0.0005557537078857422
mini_batch_src_global generation:  0.00049591064453125
r_  generation:  0.006203413009643555
----------------------check_connections_block total spend ----------------------------- 0.010036945343017578
generate_one_block  0.01006174087524414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

connection checking time:  0.012093067169189453
block generation total time  0.012888908386230469
average batch blocks generation time:  0.012888908386230469
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.01609945297241211  GigaBytes
Max Memory Allocated: 0.01609945297241211  GigaBytes

torch.Size([7885, 500])
torch.Size([2703, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01878070831298828  GigaBytes
Max Memory Allocated: 0.020099639892578125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0053102970123291016 |0.33886194229125977 |0.7650845050811768 |0.000240325927734375 |0.008232593536376953 |0.004145383834838867 |
----------------------------------------------------------pseudo_mini_loss sum 2.6312050819396973
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10942
Number of first layer input nodes during this epoch:  7885
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017369747161865234  GigaBytes
Max Memory Allocated: 0.020099639892578125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007004737854003906
random selection method range initialization spend 0.0001552104949951172
time for parepare:  7.128715515136719e-05
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00023627281188964844
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.000164031982421875
----------------------check_connections_block total spend ----------------------------- 0.0006868839263916016
generate_one_block  0.0017466545104980469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007433891296386719
gen group dst list time:  2.7179718017578125e-05
time for parepare:  0.0004019737243652344
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00030112266540527344
mini_batch_src_global generation:  0.00018668174743652344
r_  generation:  0.0017867088317871094
----------------------check_connections_block total spend ----------------------------- 0.0032215118408203125
generate_one_block  0.003327608108520508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010063648223876953
gen group dst list time:  7.05718994140625e-05
time for parepare:  0.0007538795471191406
local_output_nid generation:  0.00019097328186035156
local_in_edges_tensor generation:  0.0005555152893066406
mini_batch_src_global generation:  0.0007255077362060547
r_  generation:  0.006812334060668945
----------------------check_connections_block total spend ----------------------------- 0.011148214340209961
generate_one_block  0.00971364974975586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017369747161865234  GigaBytes
Max Memory Allocated: 0.020099639892578125  GigaBytes

connection checking time:  0.014369726181030273
block generation total time  0.013041257858276367
average batch blocks generation time:  0.013041257858276367
block dataloader generation time/epoch 0.04718494415283203
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.016047954559326172  GigaBytes
Max Memory Allocated: 0.031475067138671875  GigaBytes

torch.Size([7921, 500])
torch.Size([2705, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01873016357421875  GigaBytes
Max Memory Allocated: 0.031475067138671875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00289154052734375 |0.0005517005920410156 |0.004024505615234375 |0.00014925003051757812 |0.003144502639770508 |0.0015685558319091797 |
----------------------------------------------------------pseudo_mini_loss sum 1.4514257907867432
Total (block generation + training)time/epoch 0.061269283294677734
Training time/epoch 0.013892173767089844
Training time without block to device /epoch 0.013340473175048828
Training time without total dataloading part /epoch 0.00888681411743164
load block tensor time/epoch 0.00289154052734375
block to device time/epoch 0.0005517005920410156
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10980
Number of first layer input nodes during this epoch:  7921
