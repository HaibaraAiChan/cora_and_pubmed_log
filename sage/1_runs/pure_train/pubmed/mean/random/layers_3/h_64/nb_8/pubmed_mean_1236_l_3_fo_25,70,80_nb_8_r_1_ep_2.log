main start at this time 1648526383.3405535
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018191337585449219
random selection method range initialization spend 0.0001811981201171875
time for parepare:  4.601478576660156e-05
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00119781494140625
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  5.078315734863281e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.457069396972656e-05
----------------------check_connections_block total spend ----------------------------- 0.0022635459899902344
generate_one_block  0.0013051033020019531
generate_one_block  0.0011134147644042969
generate_one_block  0.001148223876953125
generate_one_block  0.0011055469512939453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009143352508544922
gen group dst list time:  3.361701965332031e-05
time for parepare:  0.00026416778564453125
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00022220611572265625
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00039267539978027344
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0003075599670410156
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004754066467285156
----------------------check_connections_block total spend ----------------------------- 0.002961874008178711
generate_one_block  0.0013751983642578125
generate_one_block  0.0015716552734375
generate_one_block  0.0014503002166748047
generate_one_block  0.0016851425170898438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010066032409667969
gen group dst list time:  7.581710815429688e-05
time for parepare:  0.0007760524749755859
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.0002799034118652344
mini_batch_src_global generation:  0.00010848045349121094
r_  generation:  0.00119781494140625
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.00023698806762695312
mini_batch_src_global generation:  0.0002410411834716797
r_  generation:  0.00231170654296875
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  0.00020885467529296875
r_  generation:  0.002008676528930664
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.000255584716796875
mini_batch_src_global generation:  0.00025200843811035156
r_  generation:  0.0027976036071777344
----------------------check_connections_block total spend ----------------------------- 0.013471364974975586
generate_one_block  0.002797365188598633
generate_one_block  0.003880023956298828
generate_one_block  0.003301382064819336
generate_one_block  0.0049724578857421875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

connection checking time:  0.016433238983154297
block generation total time  0.021033525466918945
average batch blocks generation time:  0.005258381366729736
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0042743682861328125  GigaBytes
Max Memory Allocated: 0.0042743682861328125  GigaBytes

torch.Size([2128, 500])
torch.Size([427, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004738330841064453  GigaBytes
Max Memory Allocated: 0.005120277404785156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007838726043701172  GigaBytes
Max Memory Allocated: 0.011738300323486328  GigaBytes

torch.Size([3878, 500])
torch.Size([845, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008681774139404297  GigaBytes
Max Memory Allocated: 0.011738300323486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005841732025146484  GigaBytes
Max Memory Allocated: 0.013008594512939453  GigaBytes

torch.Size([2810, 500])
torch.Size([665, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006504535675048828  GigaBytes
Max Memory Allocated: 0.013008594512939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006920814514160156  GigaBytes
Max Memory Allocated: 0.013008594512939453  GigaBytes

torch.Size([3377, 500])
torch.Size([1063, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007923603057861328  GigaBytes
Max Memory Allocated: 0.013008594512939453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00721663236618042 |0.08690249919891357 |0.19291269779205322 |0.00016456842422485352 |0.0031930208206176758 |0.0019369125366210938 |
----------------------------------------------------------pseudo_mini_loss sum 2.7977547645568848
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15550
Number of first layer input nodes during this epoch:  12193
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007648944854736328  GigaBytes
Max Memory Allocated: 0.013008594512939453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004596710205078125
random selection method range initialization spend 0.00010347366333007812
time for parepare:  4.458427429199219e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  6.9141387939453125e-06Using backend: pytorch

local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.363059997558594e-05
----------------------check_connections_block total spend ----------------------------- 0.0010540485382080078
generate_one_block  0.0011446475982666016
generate_one_block  0.0010273456573486328
generate_one_block  0.0011813640594482422
generate_one_block  0.0010662078857421875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005183219909667969
gen group dst list time:  3.218650817871094e-05
time for parepare:  0.000255584716796875
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0004239082336425781
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00018906593322753906
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00044918060302734375
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.0002646446228027344
----------------------check_connections_block total spend ----------------------------- 0.002810955047607422
generate_one_block  0.0016014575958251953
generate_one_block  0.0012545585632324219
generate_one_block  0.0016345977783203125
generate_one_block  0.0013153553009033203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010075569152832031
gen group dst list time:  7.987022399902344e-05
time for parepare:  0.0007061958312988281
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00037097930908203125
mini_batch_src_global generation:  0.0003261566162109375
r_  generation:  0.0027387142181396484
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  0.0001685619354248047
r_  generation:  0.0009913444519042969
local_output_nid generation:  8.392333984375e-05
local_in_edges_tensor generation:  0.0002655982971191406
mini_batch_src_global generation:  0.0003001689910888672
r_  generation:  0.0029811859130859375
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  0.00018358230590820312
r_  generation:  0.0014221668243408203
----------------------check_connections_block total spend ----------------------------- 0.013357877731323242
generate_one_block  0.004947185516357422
generate_one_block  0.002158641815185547
generate_one_block  0.004704475402832031
generate_one_block  0.002669811248779297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007648944854736328  GigaBytes
Max Memory Allocated: 0.013008594512939453  GigaBytes

connection checking time:  0.016168832778930664
block generation total time  0.020286083221435547
average batch blocks generation time:  0.005071520805358887
block dataloader generation time/epoch 0.05228829383850098
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00792837142944336  GigaBytes
Max Memory Allocated: 0.014138221740722656  GigaBytes

torch.Size([3625, 500])
torch.Size([946, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008846282958984375  GigaBytes
Max Memory Allocated: 0.014138221740722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004023075103759766  GigaBytes
Max Memory Allocated: 0.014138221740722656  GigaBytes

torch.Size([1556, 500])
torch.Size([467, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004471302032470703  GigaBytes
Max Memory Allocated: 0.014138221740722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008968830108642578  GigaBytes
Max Memory Allocated: 0.014138221740722656  GigaBytes

torch.Size([4179, 500])
torch.Size([1092, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010028362274169922  GigaBytes
Max Memory Allocated: 0.014138221740722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00618743896484375  GigaBytes
Max Memory Allocated: 0.014138221740722656  GigaBytes

torch.Size([2712, 500])
torch.Size([509, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0067424774169921875  GigaBytes
Max Memory Allocated: 0.014138221740722656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001911461353302002 |0.00041306018829345703 |0.0032761693000793457 |0.00011843442916870117 |0.0026990175247192383 |0.0015115737915039062 |
----------------------------------------------------------pseudo_mini_loss sum 1.6003191471099854
Total (block generation + training)time/epoch 0.09232497215270996
Training time/epoch 0.0397794246673584
Training time without block to device /epoch 0.03812718391418457
Training time without total dataloading part /epoch 0.025886058807373047
load block tensor time/epoch 0.007645845413208008
block to device time/epoch 0.0016522407531738281
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15442
Number of first layer input nodes during this epoch:  12072
