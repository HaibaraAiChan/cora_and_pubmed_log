main start at this time 1648526453.422512
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007164478302001953
random selection method range initialization spend 0.0002079010009765625
time for parepare:  4.553794860839844e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0013225078582763672
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.52587890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.1920928955078125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5974044799804688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.2874603271484375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.5974044799804688e-05
----------------------check_connections_block total spend ----------------------------- 0.003979206085205078
generate_one_block  0.001276254653930664
generate_one_block  0.0010139942169189453
generate_one_block  0.000982522964477539
generate_one_block  0.001001596450805664
generate_one_block  0.0009856224060058594
generate_one_block  0.0009794235229492188
generate_one_block  0.0010039806365966797
generate_one_block  0.001051187515258789
generate_one_block  0.0010309219360351562
generate_one_block  0.000978708267211914
generate_one_block  0.0009827613830566406
generate_one_block  0.0009908676147460938
generate_one_block  0.001010894775390625
generate_one_block  0.0009691715240478516
generate_one_block  0.0009720325469970703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006015300750732422
gen group dst list time:  7.605552673339844e-05
time for parepare:  0.0002396106719970703
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  6.937980651855469e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  7.462501525878906e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00010061264038085938
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.0001289844512939453
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00014495849609375
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00018215179443359375
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.887580871582031e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.00013566017150878906
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0001575946807861328
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  9.870529174804688e-05
----------------------check_connections_block total spend ----------------------------- 0.0045163631439208984
generate_one_block  0.0010466575622558594
generate_one_block  0.0010595321655273438
generate_one_block  0.0010132789611816406
generate_one_block  0.0010404586791992188
generate_one_block  0.0011019706726074219
generate_one_block  0.0009903907775878906
generate_one_block  0.0011303424835205078
generate_one_block  0.0011868476867675781
generate_one_block  0.0012145042419433594
generate_one_block  0.000989675521850586
generate_one_block  0.0010173320770263672
generate_one_block  0.001153707504272461
generate_one_block  0.0010557174682617188
generate_one_block  0.001173257827758789
generate_one_block  0.0010950565338134766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012226104736328125
gen group dst list time:  0.00011730194091796875
time for parepare:  0.0007181167602539062
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0003604888916015625
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0004172325134277344
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0003955364227294922
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0002522468566894531
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0005099773406982422
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0002110004425048828
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.0010144710540771484
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  0.0008037090301513672
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.0014958381652832031
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.00023055076599121094
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00025153160095214844
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0008182525634765625
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0005581378936767578
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  0.00013113021850585938
r_  generation:  0.0013120174407958984
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0005536079406738281
----------------------check_connections_block total spend ----------------------------- 0.0164339542388916
generate_one_block  0.001544952392578125
generate_one_block  0.0014786720275878906
generate_one_block  0.0014920234680175781
generate_one_block  0.0013093948364257812
generate_one_block  0.0016512870788574219
generate_one_block  0.00122833251953125
generate_one_block  0.002470254898071289
generate_one_block  0.001903533935546875
generate_one_block  0.0029478073120117188
generate_one_block  0.0012400150299072266
generate_one_block  0.001275777816772461
generate_one_block  0.0019884109497070312
generate_one_block  0.0016901493072509766
generate_one_block  0.0025904178619384766
generate_one_block  0.0019354820251464844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

connection checking time:  0.0209503173828125
block generation total time  0.043015241622924805
average batch blocks generation time:  0.0028676827748616534
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0020079612731933594  GigaBytes
Max Memory Allocated: 0.0020079612731933594  GigaBytes

torch.Size([923, 500])
torch.Size([107, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002136707305908203  GigaBytes
Max Memory Allocated: 0.002315998077392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0019145011901855469  GigaBytes
Max Memory Allocated: 0.0036211013793945312  GigaBytes

torch.Size([725, 500])
torch.Size([146, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0020661354064941406  GigaBytes
Max Memory Allocated: 0.0036211013793945312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0022821426391601562  GigaBytes
Max Memory Allocated: 0.0036211013793945312  GigaBytes

torch.Size([801, 500])
torch.Size([93, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0023851394653320312  GigaBytes
Max Memory Allocated: 0.0036211013793945312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0014104843139648438  GigaBytes
Max Memory Allocated: 0.0036211013793945312  GigaBytes

torch.Size([457, 500])
torch.Size([113, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0015497207641601562  GigaBytes
Max Memory Allocated: 0.0036211013793945312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0020112991333007812  GigaBytes
Max Memory Allocated: 0.0036211013793945312  GigaBytes

torch.Size([775, 500])
torch.Size([208, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0022182464599609375  GigaBytes
Max Memory Allocated: 0.0036211013793945312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0012955665588378906  GigaBytes
Max Memory Allocated: 0.0036211013793945312  GigaBytes

torch.Size([396, 500])
torch.Size([73, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0013742446899414062  GigaBytes
Max Memory Allocated: 0.0036211013793945312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005228519439697266  GigaBytes
Max Memory Allocated: 0.005934238433837891  GigaBytes

torch.Size([2494, 500])
torch.Size([312, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005554676055908203  GigaBytes
Max Memory Allocated: 0.006077766418457031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0032472610473632812  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

torch.Size([1435, 500])
torch.Size([311, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0035686492919921875  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005245685577392578  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

torch.Size([2184, 500])
torch.Size([415, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005662441253662109  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0013728141784667969  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

torch.Size([438, 500])
torch.Size([64, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0014529228210449219  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0014495849609375  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

torch.Size([478, 500])
torch.Size([119, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0015668869018554688  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0032863616943359375  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

torch.Size([1455, 500])
torch.Size([357, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003627300262451172  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0023398399353027344  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

torch.Size([951, 500])
torch.Size([193, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0025272369384765625  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0033054351806640625  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

torch.Size([1347, 500])
torch.Size([325, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0036368370056152344  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0022525787353515625  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

torch.Size([904, 500])
torch.Size([253, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0024924278259277344  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0027696927388509113 |0.02386624018351237 |0.05430787404378255 |0.00014657974243164061 |0.002626355489095052 |0.0034706592559814453 |
----------------------------------------------------------pseudo_mini_loss sum 2.3160390853881836
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  19209
Number of first layer input nodes during this epoch:  15763
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0028409957885742188  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005862712860107422
random selection method range initialization spend 0.0001327991485595703
time for parepare:  5.316734313964844e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.6450881958007812e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  1.9073486328125e-05
----------------------check_connections_block total spend ----------------------------- 0.003359556198120117
generate_one_block  0.0013132095336914062
generate_one_block  0.0011277198791503906
generate_one_block  0.001007080078125
generate_one_block  0.0010023117065429688
generate_one_block  0.0010333061218261719
generate_one_block  0.0012409687042236328
generate_one_block  0.0010035037994384766
generate_one_block  0.0010302066802978516
generate_one_block  0.001035451889038086
generate_one_block  0.0010595321655273438
generate_one_block  0.0009984970092773438
generate_one_block  0.0009534358978271484
generate_one_block  0.0009601116180419922
generate_one_block  0.0009462833404541016
generate_one_block  0.0010018348693847656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006318092346191406
gen group dst list time:  7.939338684082031e-05
time for parepare:  0.0002684593200683594
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0002982616424560547
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  8.106231689453125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  4.57763671875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  8.20159912109375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  9.942054748535156e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0001838207244873047
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0002155303955078125
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0001571178436279297
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.106231689453125e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.315376281738281e-05
----------------------check_connections_block total spend ----------------------------- 0.004755258560180664
generate_one_block  0.001102447509765625
generate_one_block  0.0014066696166992188
generate_one_block  0.0011627674102783203
generate_one_block  0.0010373592376708984
generate_one_block  0.0010390281677246094
generate_one_block  0.0010371208190917969
generate_one_block  0.0011093616485595703
generate_one_block  0.0011341571807861328
generate_one_block  0.0010929107666015625
generate_one_block  0.00121307373046875
generate_one_block  0.0012006759643554688
generate_one_block  0.0009746551513671875
generate_one_block  0.001093149185180664
generate_one_block  0.0010256767272949219
generate_one_block  0.0009772777557373047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012454986572265625
gen group dst list time:  0.0001266002655029297
time for parepare:  0.0008494853973388672
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0002849102020263672
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0004949569702148438
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  0.0003325939178466797
r_  generation:  0.0023932456970214844
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  0.00010538101196289062
r_  generation:  0.0004916191101074219
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00015807151794433594
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00018405914306640625
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.00010704994201660156
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0004239082336425781
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  7.748603820800781e-05
r_  generation:  0.0007309913635253906
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0006930828094482422
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  9.894371032714844e-05
r_  generation:  0.0009274482727050781
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.00015974044799804688
r_  generation:  0.001680612564086914
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  7.462501525878906e-05
r_  generation:  0.0002071857452392578
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0006036758422851562
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0007243156433105469
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.00021386146545410156
----------------------check_connections_block total spend ----------------------------- 0.017913103103637695
generate_one_block  0.0018477439880371094
generate_one_block  0.0037653446197509766
generate_one_block  0.0016219615936279297
generate_one_block  0.0011484622955322266
generate_one_block  0.0011785030364990234
generate_one_block  0.0010502338409423828
generate_one_block  0.0014297962188720703
generate_one_block  0.0018029212951660156
generate_one_block  0.0017819404602050781
generate_one_block  0.0020258426666259766
generate_one_block  0.002923250198364258
generate_one_block  0.0011696815490722656
generate_one_block  0.0016303062438964844
generate_one_block  0.0019693374633789062
generate_one_block  0.0011599063873291016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0028409957885742188  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

connection checking time:  0.02266836166381836
block generation total time  0.043111562728881836
average batch blocks generation time:  0.0028741041819254558
block dataloader generation time/epoch 0.10503268241882324
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0038204193115234375  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

torch.Size([1007, 500])
torch.Size([133, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003964424133300781  GigaBytes
Max Memory Allocated: 0.007869720458984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006730079650878906  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

torch.Size([2987, 500])
torch.Size([649, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007367610931396484  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0025277137756347656  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

torch.Size([761, 500])
torch.Size([155, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.002685546875  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0016026496887207031  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

torch.Size([269, 500])
torch.Size([75, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0016832351684570312  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0015916824340820312  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

torch.Size([263, 500])
torch.Size([99, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0016884803771972656  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0014424324035644531  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

torch.Size([184, 500])
torch.Size([52, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0015063285827636719  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.002215862274169922  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

torch.Size([594, 500])
torch.Size([203, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0024080276489257812  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0036063194274902344  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

torch.Size([1336, 500])
torch.Size([231, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0038328170776367188  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00339508056640625  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

torch.Size([1223, 500])
torch.Size([150, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.003559112548828125  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004717826843261719  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

torch.Size([1695, 500])
torch.Size([355, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005076408386230469  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004875659942626953  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

torch.Size([2002, 500])
torch.Size([469, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005333423614501953  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0018291473388671875  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

torch.Size([390, 500])
torch.Size([55, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0019068717956542969  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.003055095672607422  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

torch.Size([1042, 500])
torch.Size([227, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0033173561096191406  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004390716552734375  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

torch.Size([1757, 500])
torch.Size([179, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004579067230224609  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0017900466918945312  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes
Using backend: pytorch

torch.Size([369, 500])
torch.Size([75, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0018734931945800781  GigaBytes
Max Memory Allocated: 0.00937032699584961  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0007861773173014323 |0.0004069010416666667 |0.0032077312469482424 |0.00011553764343261719 |0.003098726272583008 |0.0016846656799316406 |
----------------------------------------------------------pseudo_mini_loss sum 2.217066526412964
Total (block generation + training)time/epoch 0.2384934425354004
Training time/epoch 0.13314604759216309
Training time without block to device /epoch 0.12704253196716309
Training time without total dataloading part /epoch 0.09801459312438965
load block tensor time/epoch 0.011792659759521484
block to device time/epoch 0.006103515625
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  19343
Number of first layer input nodes during this epoch:  15879
