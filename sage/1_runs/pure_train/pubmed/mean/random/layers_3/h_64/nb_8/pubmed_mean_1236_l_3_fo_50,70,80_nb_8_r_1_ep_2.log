main start at this time 1648526433.434354
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010006427764892578
random selection method range initialization spend 0.0002014636993408203
time for parepare:  5.340576171875e-05
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0014414787292480469
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  5.555152893066406e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.029273986816406e-05
----------------------check_connections_block total spend ----------------------------- 0.0026335716247558594
generate_one_block  0.0014889240264892578
generate_one_block  0.001361846923828125
generate_one_block  0.0013880729675292969
generate_one_block  0.0013206005096435547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007598400115966797
gen group dst list time:  4.220008850097656e-05
time for parepare:  0.0003044605255126953
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.0002646446228027344
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00044727325439453125
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.00035071372985839844
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0005609989166259766
----------------------check_connections_block total spend ----------------------------- 0.0033974647521972656
generate_one_block  0.001636505126953125
generate_one_block  0.0018613338470458984
generate_one_block  0.00173187255859375
generate_one_block  0.0020089149475097656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012524127960205078
gen group dst list time:  0.00010466575622558594
time for parepare:  0.0009708404541015625
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.0003085136413574219
mini_batch_src_global generation:  0.0001621246337890625
r_  generation:  0.0016169548034667969
local_output_nid generation:  9.703636169433594e-05
local_in_edges_tensor generation:  0.0002846717834472656
mini_batch_src_global generation:  0.0003628730773925781
r_  generation:  0.0029861927032470703
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.00026416778564453125
mini_batch_src_global generation:  0.0003044605255126953
r_  generation:  0.0027608871459960938
local_output_nid generation:  0.00011110305786132812
local_in_edges_tensor generation:  0.0003159046173095703
mini_batch_src_global generation:  0.00036907196044921875
r_  generation:  0.003275156021118164
----------------------check_connections_block total spend ----------------------------- 0.01749134063720703
generate_one_block  0.0029671192169189453
generate_one_block  0.0040454864501953125
generate_one_block  0.003621816635131836
generate_one_block  0.004748344421386719
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00027561187744140625  GigaBytes
Max Memory Allocated: 0.00027561187744140625  GigaBytes

connection checking time:  0.020888805389404297
block generation total time  0.02262139320373535
average batch blocks generation time:  0.005655348300933838
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.004926204681396484  GigaBytes
Max Memory Allocated: 0.004926204681396484  GigaBytes

torch.Size([2475, 500])
torch.Size([427, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0053958892822265625  GigaBytes
Max Memory Allocated: 0.005860805511474609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008548259735107422  GigaBytes
Max Memory Allocated: 0.013088226318359375  GigaBytes

torch.Size([4256, 500])
torch.Size([848, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009398460388183594  GigaBytes
Max Memory Allocated: 0.013088226318359375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006399631500244141  GigaBytes
Max Memory Allocated: 0.014261722564697266  GigaBytes

torch.Size([3105, 500])
torch.Size([665, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007071018218994141  GigaBytes
Max Memory Allocated: 0.014261722564697266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007393360137939453  GigaBytes
Max Memory Allocated: 0.014261722564697266  GigaBytes

torch.Size([3624, 500])
torch.Size([1062, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008407115936279297  GigaBytes
Max Memory Allocated: 0.014261722564697266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0043582916259765625 |0.08643871545791626 |0.19392770528793335 |0.0001589059829711914 |0.003445267677307129 |0.0022706985473632812 |
----------------------------------------------------------pseudo_mini_loss sum 2.7634308338165283
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16819
Number of first layer input nodes during this epoch:  13460
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008147239685058594  GigaBytes
Max Memory Allocated: 0.014261722564697266  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005202293395996094
random selection method range initialization spend 0.00011706352233886719
time for parepare:  5.340576171875e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00011968612670898438
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.863739013671875e-05
----------------------check_connections_block total spend ----------------------------- 0.0011875629425048828
generate_one_block  0.001332998275756836
generate_one_block  0.0012278556823730469
generate_one_block  0.0013806819915771484
generate_one_block  0.0012366771697998047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006248950958251953
gen group dst list time:  4.124641418457031e-05
time for parepare:  0.0003235340118408203
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0002224445343017578
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0005006790161132812
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0002193450927734375
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0005338191986083984
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00031256675720214844
----------------------check_connections_block total spend ----------------------------- 0.0033326148986816406
generate_one_block  0.0018665790557861328
generate_one_block  0.001470804214477539
generate_one_block  0.001909494400024414
generate_one_block  0.0015366077423095703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012934207916259766
gen group dst list time:  0.00010848045349121094
time for parepare:  0.0009191036224365234
local_output_nid generation:  9.608268737792969e-05
local_in_edges_tensor generation:  0.0004127025604248047
mini_batch_src_global generation:  0.00047516822814941406
r_  generation:  0.003741741180419922
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  0.00023293495178222656
r_  generation:  0.0013842582702636719
local_output_nid generation:  0.00011587142944335938
local_in_edges_tensor generation:  0.0003113746643066406
mini_batch_src_global generation:  0.00034999847412109375
r_  generation:  0.007487058639526367
local_output_nid generation:  9.107589721679688e-05
local_in_edges_tensor generation:  0.00040650367736816406
mini_batch_src_global generation:  0.0004940032958984375
r_  generation:  0.003596067428588867
----------------------check_connections_block total spend ----------------------------- 0.024356842041015625
generate_one_block  0.009164571762084961
generate_one_block  0.0035545825958251953
generate_one_block  0.006080150604248047
generate_one_block  0.0030677318572998047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008147239685058594  GigaBytes
Max Memory Allocated: 0.014261722564697266  GigaBytes

connection checking time:  0.027689456939697266
block generation total time  0.028650522232055664
average batch blocks generation time:  0.007162630558013916
block dataloader generation time/epoch 0.07483577728271484
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008559226989746094  GigaBytes
Max Memory Allocated: 0.015216827392578125  GigaBytes

torch.Size([3957, 500])
torch.Size([946, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00948953628540039  GigaBytes
Max Memory Allocated: 0.015216827392578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004375934600830078  GigaBytes
Max Memory Allocated: 0.015216827392578125  GigaBytes

torch.Size([1744, 500])
torch.Size([467, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004827022552490234  GigaBytes
Max Memory Allocated: 0.015216827392578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009595870971679688  GigaBytes
Max Memory Allocated: 0.015216827392578125  GigaBytes

torch.Size([4509, 500])
torch.Size([1093, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010669231414794922  GigaBytes
Max Memory Allocated: 0.015216827392578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006877899169921875  GigaBytes
Max Memory Allocated: 0.015232563018798828  GigaBytes

torch.Size([3080, 500])
torch.Size([510, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007437705993652344  GigaBytes
Max Memory Allocated: 0.015232563018798828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002032458782196045 |0.0004303455352783203 |0.003241896629333496 |0.00011545419692993164 |0.00251692533493042 |0.0014863014221191406 |
----------------------------------------------------------pseudo_mini_loss sum 1.5163581371307373
Total (block generation + training)time/epoch 0.11448383331298828
Training time/epoch 0.039483070373535156
Training time without block to device /epoch 0.037761688232421875
Training time without total dataloading part /epoch 0.02498340606689453
load block tensor time/epoch 0.00812983512878418
block to device time/epoch 0.0017213821411132812
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16662
Number of first layer input nodes during this epoch:  13290
