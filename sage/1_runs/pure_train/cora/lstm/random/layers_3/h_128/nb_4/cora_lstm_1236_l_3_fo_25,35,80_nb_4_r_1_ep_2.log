main start at this time 1648429488.3818967
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011985301971435547
random selection method range initialization spend 0.00021839141845703125
time for parepare:  7.891654968261719e-05
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00022721290588378906
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.002746105194091797
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  8.153915405273438e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.772445678710938e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.413459777832031e-05
----------------------check_connections_block total spend ----------------------------- 0.0041735172271728516
generate_one_block  0.001603841781616211
generate_one_block  0.0013325214385986328
generate_one_block  0.001318216323852539
generate_one_block  0.0013051033020019531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005927085876464844
gen group dst list time:  5.245208740234375e-05
time for parepare:  0.0001785755157470703
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00025153160095214844
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0005891323089599609
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0004706382751464844
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00047588348388671875
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.00047850608825683594
----------------------check_connections_block total spend ----------------------------- 0.0039386749267578125
generate_one_block  0.0019290447235107422
generate_one_block  0.0017724037170410156
generate_one_block  0.0017740726470947266
generate_one_block  0.0017859935760498047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006923675537109375
gen group dst list time:  0.0001049041748046875
time for parepare:  0.00022268295288085938
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.0003561973571777344
mini_batch_src_global generation:  0.00017690658569335938
r_  generation:  0.0017101764678955078
local_output_nid generation:  7.534027099609375e-05
local_in_edges_tensor generation:  0.00025153160095214844
mini_batch_src_global generation:  0.0001595020294189453
r_  generation:  0.0014564990997314453
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.0002503395080566406
mini_batch_src_global generation:  0.0001499652862548828
r_  generation:  0.0014543533325195312
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.00024700164794921875
mini_batch_src_global generation:  0.0001552104949951172
r_  generation:  0.0015134811401367188
----------------------check_connections_block total spend ----------------------------- 0.009940862655639648
generate_one_block  0.003207683563232422
generate_one_block  0.002523660659790039
generate_one_block  0.0022974014282226562
generate_one_block  0.00226593017578125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

connection checking time:  0.013879537582397461
block generation total time  0.017556190490722656
average batch blocks generation time:  0.004389047622680664
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.07390785217285156  GigaBytes
Max Memory Allocated: 0.07390785217285156  GigaBytes

torch.Size([1655, 1433])
torch.Size([803, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.44324779510498047  GigaBytes
Max Memory Allocated: 0.460512638092041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.13788557052612305  GigaBytes
Max Memory Allocated: 0.5507621765136719  GigaBytes

torch.Size([1460, 1433])
torch.Size([684, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.44510555267333984  GigaBytes
Max Memory Allocated: 0.5507621765136719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.1378321647644043  GigaBytes
Max Memory Allocated: 0.5540318489074707  GigaBytes

torch.Size([1450, 1433])
torch.Size([672, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.4472050666809082  GigaBytes
Max Memory Allocated: 0.5540318489074707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.13797712326049805  GigaBytes
Max Memory Allocated: 0.5560450553894043  GigaBytes

torch.Size([1477, 1433])
torch.Size([710, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.45616912841796875  GigaBytes
Max Memory Allocated: 0.5560450553894043  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0473865270614624 |0.08657199144363403 |0.22879570722579956 |0.00014024972915649414 |0.16239136457443237 |0.013290882110595703 |
----------------------------------------------------------pseudo_mini_loss sum 3.091691255569458
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9650
Number of first layer input nodes during this epoch:  6042
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.2680821418762207  GigaBytes
Max Memory Allocated: 0.564906120300293  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004830360412597656
random selection method range initialization spend 0.00011754035949707031
time for parepare:  6.723403930664062e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00011038780212402344
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.700920104980469e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.081031799316406e-05
----------------------check_connections_block total spend ----------------------------- 0.0013415813446044922
generate_one_block  0.0011970996856689453
generate_one_block  0.0010745525360107422
generate_one_block  0.0010838508605957031
generate_one_block  0.0010750293731689453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005002021789550781
gen group dst list time:  4.172325134277344e-05
time for parepare:  0.00014448165893554688
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0003979206085205078
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0003333091735839844
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004410743713378906
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004341602325439453
----------------------check_connections_block total spend ----------------------------- 0.0031766891479492188
generate_one_block  0.0015139579772949219
generate_one_block  0.0013971328735351562
generate_one_block  0.0015366077423095703
generate_one_block  0.0015058517456054688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005450248718261719
gen group dst list time:  8.034706115722656e-05
time for parepare:  0.00018787384033203125
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.00028705596923828125
mini_batch_src_global generation:  9.942054748535156e-05
r_  generation:  0.0011293888092041016
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00014400482177734375
r_  generation:  0.001035928726196289
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.00014448165893554688
r_  generation:  0.0012898445129394531
local_output_nid generation:  6.222724914550781e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  0.00012636184692382812
r_  generation:  0.0012516975402832031
----------------------check_connections_block total spend ----------------------------- 0.007777690887451172
generate_one_block  0.0024383068084716797
generate_one_block  0.0022673606872558594
generate_one_block  0.0026891231536865234
generate_one_block  0.0036230087280273438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.2680821418762207  GigaBytes
Max Memory Allocated: 0.564906120300293  GigaBytes

connection checking time:  0.01095438003540039
block generation total time  0.016971349716186523
average batch blocks generation time:  0.004242837429046631
block dataloader generation time/epoch 0.051512718200683594
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.267880916595459  GigaBytes
Max Memory Allocated: 0.564906120300293  GigaBytes

torch.Size([1440, 1433])
torch.Size([683, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.5776638984680176  GigaBytes
Max Memory Allocated: 0.5937905311584473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.26772117614746094  GigaBytes
Max Memory Allocated: 0.6859917640686035  GigaBytes

torch.Size([1421, 1433])
torch.Size([604, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.5484938621520996  GigaBytes
Max Memory Allocated: 0.6859917640686035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.2687191963195801  GigaBytes
Max Memory Allocated: 0.6859917640686035  GigaBytes

torch.Size([1606, 1433])
torch.Size([779, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.6232414245605469  GigaBytes
Max Memory Allocated: 0.6859917640686035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.268251895904541  GigaBytes
Max Memory Allocated: 0.729649543762207  GigaBytes

torch.Size([1519, 1433])
torch.Size([757, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.6063156127929688  GigaBytes
Max Memory Allocated: 0.729649543762207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.047010719776153564 |0.0004044175148010254 |0.11118143796920776 |0.00011038780212402344 |0.16839361190795898 |0.010963678359985352 |
----------------------------------------------------------pseudo_mini_loss sum 2.345895290374756
Total (block generation + training)time/epoch 1.4281344413757324
Training time/epoch 1.376392126083374
Training time without block to device /epoch 1.37477445602417
Training time without total dataloading part /epoch 1.1297054290771484
load block tensor time/epoch 0.18804287910461426
block to device time/epoch 0.0016176700592041016
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9531
Number of first layer input nodes during this epoch:  5986
