main start at this time 1648429435.5956829
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0015106201171875
random selection method range initialization spend 0.0002429485321044922
time for parepare:  7.772445678710938e-05
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.004038572311401367
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  7.557868957519531e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  6.341934204101562e-05
----------------------check_connections_block total spend ----------------------------- 0.005448818206787109
generate_one_block  0.0015888214111328125
generate_one_block  0.0012998580932617188
generate_one_block  0.0012862682342529297
generate_one_block  0.0012574195861816406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005815029144287109
gen group dst list time:  5.054473876953125e-05
time for parepare:  0.0001811981201171875
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.000579833984375
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0004417896270751953
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00015783309936523438
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004532337188720703
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00046753883361816406
----------------------check_connections_block total spend ----------------------------- 0.003826618194580078
generate_one_block  0.0018718242645263672
generate_one_block  0.0017085075378417969
generate_one_block  0.0017216205596923828
generate_one_block  0.0017213821411132812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006735324859619141
gen group dst list time:  0.00010251998901367188
time for parepare:  0.00022482872009277344
local_output_nid generation:  7.05718994140625e-05
local_in_edges_tensor generation:  0.0003440380096435547
mini_batch_src_global generation:  0.0001685619354248047
r_  generation:  0.0016415119171142578
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  0.00015425682067871094
r_  generation:  0.0014090538024902344
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  0.00014352798461914062
r_  generation:  0.0013935565948486328
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.00023508071899414062
mini_batch_src_global generation:  0.00015044212341308594
r_  generation:  0.0014564990997314453
----------------------check_connections_block total spend ----------------------------- 0.009610176086425781
generate_one_block  0.003117084503173828
generate_one_block  0.002460956573486328
generate_one_block  0.0022733211517333984
generate_one_block  0.002252817153930664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

connection checking time:  0.01343679428100586
block generation total time  0.017127513885498047
average batch blocks generation time:  0.004281878471374512
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.07388114929199219  GigaBytes
Max Memory Allocated: 0.07388114929199219  GigaBytes

torch.Size([1650, 1433])
torch.Size([801, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.4447898864746094  GigaBytes
Max Memory Allocated: 0.46202659606933594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.13784265518188477  GigaBytes
Max Memory Allocated: 0.5523176193237305  GigaBytes

torch.Size([1452, 1433])
torch.Size([679, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.44510650634765625  GigaBytes
Max Memory Allocated: 0.5523176193237305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.13782691955566406  GigaBytes
Max Memory Allocated: 0.5540671348571777  GigaBytes

torch.Size([1449, 1433])
torch.Size([666, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4464840888977051  GigaBytes
Max Memory Allocated: 0.5540671348571777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.1379718780517578  GigaBytes
Max Memory Allocated: 0.5553650856018066  GigaBytes

torch.Size([1476, 1433])
torch.Size([709, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.4574747085571289  GigaBytes
Max Memory Allocated: 0.5553650856018066  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04929959774017334 |0.08601135015487671 |0.23250967264175415 |0.00014901161193847656 |0.1720573902130127 |0.013361454010009766 |
----------------------------------------------------------pseudo_mini_loss sum 3.093632459640503
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9621
Number of first layer input nodes during this epoch:  6027
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.26807689666748047  GigaBytes
Max Memory Allocated: 0.566218376159668  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004937648773193359
random selection method range initialization spend 0.00012111663818359375
time for parepare:  7.224082946777344e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  7.414817810058594e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00010967254638671875Using backend: pytorch

mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  8.082389831542969e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.867813110351562e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.200241088867188e-05
----------------------check_connections_block total spend ----------------------------- 0.0014545917510986328
generate_one_block  0.0011813640594482422
generate_one_block  0.00104522705078125
generate_one_block  0.001096963882446289
generate_one_block  0.001079559326171875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00048089027404785156
gen group dst list time:  3.9577484130859375e-05
time for parepare:  0.0001437664031982422
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00037407875061035156
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0003173351287841797
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.00046443939208984375
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.000431060791015625
----------------------check_connections_block total spend ----------------------------- 0.003163576126098633
generate_one_block  0.001514434814453125
generate_one_block  0.0025124549865722656
generate_one_block  0.001528024673461914
generate_one_block  0.0015099048614501953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005972385406494141
gen group dst list time:  8.606910705566406e-05
time for parepare:  0.00017642974853515625
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.0002906322479248047
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.0010788440704345703
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.008075475692749023
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.0012464523315429688
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.0013079643249511719
----------------------check_connections_block total spend ----------------------------- 0.014714956283569336
generate_one_block  0.0024683475494384766
generate_one_block  0.0021686553955078125
generate_one_block  0.0025908946990966797
generate_one_block  0.002393007278442383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.26807689666748047  GigaBytes
Max Memory Allocated: 0.566218376159668  GigaBytes

connection checking time:  0.01787853240966797
block generation total time  0.01668572425842285
average batch blocks generation time:  0.004171431064605713
block dataloader generation time/epoch 0.059537649154663086
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.26787567138671875  GigaBytes
Max Memory Allocated: 0.566218376159668  GigaBytes

torch.Size([1432, 1433])
torch.Size([682, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.577735424041748  GigaBytes
Max Memory Allocated: 0.5938186645507812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.26757192611694336  GigaBytes
Max Memory Allocated: 0.6860699653625488  GigaBytes

torch.Size([1393, 1433])
torch.Size([604, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.5440797805786133  GigaBytes
Max Memory Allocated: 0.6860699653625488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.2687087059020996  GigaBytes
Max Memory Allocated: 0.6860699653625488  GigaBytes

torch.Size([1604, 1433])
torch.Size([783, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.6211099624633789  GigaBytes
Max Memory Allocated: 0.6860699653625488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.2681293487548828  GigaBytes
Max Memory Allocated: 0.7274909019470215  GigaBytes

torch.Size([1496, 1433])
torch.Size([750, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.605250358581543  GigaBytes
Max Memory Allocated: 0.7274909019470215  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04700404405593872 |0.00041615962982177734 |0.10945266485214233 |0.00011587142944335938 |0.15716701745986938 |0.01051187515258789 |
----------------------------------------------------------pseudo_mini_loss sum 2.3391292095184326
Total (block generation + training)time/epoch 1.3857500553131104
Training time/epoch 1.3258755207061768
Training time without block to device /epoch 1.3242108821868896
Training time without total dataloading part /epoch 1.0774540901184082
load block tensor time/epoch 0.18801617622375488
block to device time/epoch 0.0016646385192871094
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9466
Number of first layer input nodes during this epoch:  5925
