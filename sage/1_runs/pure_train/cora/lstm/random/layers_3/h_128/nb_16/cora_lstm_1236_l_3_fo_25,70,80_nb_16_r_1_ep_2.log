main start at this time 1648429567.0399961
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012660026550292969
random selection method range initialization spend 0.00020360946655273438
time for parepare:  6.651878356933594e-05
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00308990478515625
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  6.4849853515625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.8596649169921875e-05
----------------------check_connections_block total spend ----------------------------- 0.006288290023803711
generate_one_block  0.0013363361358642578
generate_one_block  0.0012099742889404297
generate_one_block  0.0011398792266845703
generate_one_block  0.0011188983917236328
generate_one_block  0.0011136531829833984
generate_one_block  0.001117706298828125
generate_one_block  0.0011267662048339844
generate_one_block  0.0011134147644042969
generate_one_block  0.001131296157836914
generate_one_block  0.0011587142944335938
generate_one_block  0.0011243820190429688
generate_one_block  0.000997304916381836
generate_one_block  0.001039266586303711
generate_one_block  0.001056671142578125
generate_one_block  0.0010097026824951172
generate_one_block  0.0009965896606445312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006394386291503906
gen group dst list time:  9.34600830078125e-05
time for parepare:  0.0001552104949951172
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00012731552124023438
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0002372264862060547
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00018525123596191406
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00011801719665527344
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00012540817260742188
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00013685226440429688
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00015807151794433594
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  9.512901306152344e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001957416534423828
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00014066696166992188
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00010418891906738281
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00013399124145507812
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00014352798461914062
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00013637542724609375
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00015425682067871094
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.389617919921875e-05
----------------------check_connections_block total spend ----------------------------- 0.0060558319091796875
generate_one_block  0.00127410888671875
generate_one_block  0.0013992786407470703
generate_one_block  0.001329660415649414
generate_one_block  0.0012428760528564453
generate_one_block  0.001251220703125
generate_one_block  0.0012738704681396484
generate_one_block  0.001306295394897461
generate_one_block  0.0011546611785888672
generate_one_block  0.0011982917785644531
generate_one_block  0.0011851787567138672
generate_one_block  0.0011372566223144531
generate_one_block  0.001154184341430664
generate_one_block  0.0011625289916992188
generate_one_block  0.0011410713195800781
generate_one_block  0.0011641979217529297
generate_one_block  0.0010783672332763672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007493495941162109
gen group dst list time:  0.00017213821411132812
time for parepare:  0.00023102760314941406
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.00048160552978515625
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.0007162094116210938
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0006933212280273438
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0003521442413330078
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0004324913024902344
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0005311965942382812
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0005891323089599609
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.00028014183044433594
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.000591278076171875
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0005121231079101562
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003573894500732422
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0005748271942138672
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.0005240440368652344
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00045180320739746094
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0005159378051757812
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00020503997802734375
----------------------check_connections_block total spend ----------------------------- 0.014273881912231445
generate_one_block  0.0017473697662353516
generate_one_block  0.0019097328186035156
generate_one_block  0.0017888545989990234
generate_one_block  0.001352548599243164
generate_one_block  0.0014607906341552734
generate_one_block  0.0018322467803955078
generate_one_block  0.0016324520111083984
generate_one_block  0.0012738704681396484
generate_one_block  0.0016107559204101562
generate_one_block  0.0015594959259033203
generate_one_block  0.0013957023620605469
generate_one_block  0.0016033649444580078
generate_one_block  0.0015552043914794922
generate_one_block  0.0014672279357910156
generate_one_block  0.001583099365234375
generate_one_block  0.001199483871459961
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

connection checking time:  0.020329713821411133
block generation total time  0.044425249099731445
average batch blocks generation time:  0.0027765780687332153
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.06943559646606445  GigaBytes
Max Memory Allocated: 0.06943559646606445  GigaBytes

torch.Size([823, 1433])
torch.Size([269, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.19119977951049805  GigaBytes
Max Memory Allocated: 0.19829320907592773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.13505220413208008  GigaBytes
Max Memory Allocated: 0.31308984756469727  GigaBytes

torch.Size([932, 1433])
torch.Size([384, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5526123046875 GB
    Memory Allocated: 0.31885194778442383  GigaBytes
Max Memory Allocated: 0.32781362533569336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13537025451660156  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([992, 1433])
torch.Size([380, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.311892032623291  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13303852081298828  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([557, 1433])
torch.Size([166, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.21764755249023438  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.1331315040588379  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([574, 1433])
torch.Size([215, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.24170589447021484  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.1343088150024414  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([794, 1433])
torch.Size([282, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27072668075561523  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13482284545898438  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([890, 1433])
torch.Size([331, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.283724308013916  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13216543197631836  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([394, 1433])
torch.Size([140, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.1953449249267578  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13429021835327148  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([790, 1433])
torch.Size([295, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.28685903549194336  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13381671905517578  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([702, 1433])
torch.Size([276, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2623767852783203  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13329410552978516  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([605, 1433])
torch.Size([191, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2203826904296875  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13430309295654297  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([793, 1433])
torch.Size([315, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2773427963256836  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13414239883422852  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([763, 1433])
torch.Size([273, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2673072814941406  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.1332712173461914  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([600, 1433])
torch.Size([228, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.24585723876953125  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13406848907470703  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([749, 1433])
torch.Size([308, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.26116085052490234  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13153362274169922  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([276, 1433])
torch.Size([92, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.17804908752441406  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.052406251430511475 |0.022272393107414246 |0.1071678102016449 |0.0001172870397567749 |0.10984738171100616 |0.014948129653930664 |
----------------------------------------------------------pseudo_mini_loss sum 3.2092909812927246
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16147
Number of first layer input nodes during this epoch:  11234
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.2615928649902344  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005390644073486328
random selection method range initialization spend 0.00013780593872070312
time for parepare:  8.320808410644531e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6927719116210938e-05
----------------------check_connections_block total spend ----------------------------- 0.0033392906188964844
generate_one_block  0.0011837482452392578
generate_one_block  0.0010383129119873047
generate_one_block  0.0010428428649902344
generate_one_block  0.0013997554779052734
generate_one_block  0.001033782958984375
generate_one_block  0.001027822494506836
generate_one_block  0.0010242462158203125
generate_one_block  0.0010318756103515625
generate_one_block  0.001039266586303711
generate_one_block  0.0010280609130859375
generate_one_block  0.0010433197021484375
generate_one_block  0.0010292530059814453
generate_one_block  0.0010373592376708984
generate_one_block  0.001020193099975586
generate_one_block  0.0010089874267578125
generate_one_block  0.0009670257568359375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005762577056884766
gen group dst list time:  0.0001049041748046875
time for parepare:  0.00019478797912597656
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00010752677917480469
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00017333030700683594
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00022339820861816406
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00011420249938964844
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001533031463623047
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0001201629638671875
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001266002655029297
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00022745132446289062
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00011968612670898438
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00017547607421875
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00014352798461914062
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00017595291137695312
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00019359588623046875
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  7.987022399902344e-05
----------------------check_connections_block total spend ----------------------------- 0.0061130523681640625
generate_one_block  0.0011742115020751953
generate_one_block  0.0011417865753173828
generate_one_block  0.001253366470336914
generate_one_block  0.0012874603271484375
generate_one_block  0.001153707504272461
generate_one_block  0.001230478286743164
generate_one_block  0.0011489391326904297
generate_one_block  0.0011141300201416016
generate_one_block  0.0012423992156982422
generate_one_block  0.0010714530944824219
generate_one_block  0.001157999038696289
generate_one_block  0.0011205673217773438
generate_one_block  0.001165628433227539
generate_one_block  0.0012829303741455078
generate_one_block  0.0010409355163574219
generate_one_block  0.0010442733764648438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008482933044433594
gen group dst list time:  0.00020265579223632812
time for parepare:  0.00022673606872558594
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0002627372741699219
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001392364501953125
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.00039386749267578125
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0006153583526611328
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0006647109985351562
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0004642009735107422
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0005743503570556641
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.00034117698669433594
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.00046944618225097656
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0008070468902587891
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0004208087921142578
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0006380081176757812
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0005550384521484375
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0006256103515625
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0006902217864990234
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.00030732154846191406
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00027632713317871094
----------------------check_connections_block total spend ----------------------------- 0.015146255493164062
generate_one_block  0.0012078285217285156
generate_one_block  0.0015463829040527344
generate_one_block  0.0018203258514404297
generate_one_block  0.0018177032470703125
generate_one_block  0.0015163421630859375
generate_one_block  0.0016336441040039062
generate_one_block  0.0013580322265625
generate_one_block  0.0015358924865722656
generate_one_block  0.0019235610961914062
generate_one_block  0.0015461444854736328
generate_one_block  0.0016875267028808594
generate_one_block  0.0016040802001953125
generate_one_block  0.0016930103302001953
generate_one_block  0.00174713134765625
generate_one_block  0.0013070106506347656
generate_one_block  0.0012841224670410156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.2615928649902344  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

connection checking time:  0.021259307861328125
block generation total time  0.043859004974365234
average batch blocks generation time:  0.002741187810897827
block dataloader generation time/epoch 0.13440442085266113
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.2610616683959961  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([179, 1433])
torch.Size([67, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.2902803421020508  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.26370668411254883  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

torch.Size([673, 1433])
torch.Size([207, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.36274147033691406  GigaBytes
Max Memory Allocated: 0.4344005584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.2646965980529785  GigaBytes
Max Memory Allocated: 0.4832897186279297  GigaBytes

torch.Size([857, 1433])
torch.Size([332, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.4262580871582031  GigaBytes
Max Memory Allocated: 0.4832897186279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.26474666595458984  GigaBytes
Max Memory Allocated: 0.5437726974487305  GigaBytes

torch.Size([866, 1433])
torch.Size([354, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.4349689483642578  GigaBytes
Max Memory Allocated: 0.5437726974487305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2640724182128906  GigaBytes
Max Memory Allocated: 0.5508832931518555  GigaBytes

torch.Size([741, 1433])
torch.Size([225, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.37926244735717773  GigaBytes
Max Memory Allocated: 0.5508832931518555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2645888328552246  GigaBytes
Max Memory Allocated: 0.5508832931518555  GigaBytes

torch.Size([837, 1433])
torch.Size([310, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.41329240798950195  GigaBytes
Max Memory Allocated: 0.5508832931518555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2626805305480957  GigaBytes
Max Memory Allocated: 0.5508832931518555  GigaBytes

torch.Size([481, 1433])
torch.Size([195, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3412742614746094  GigaBytes
Max Memory Allocated: 0.5508832931518555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.264585018157959  GigaBytes
Max Memory Allocated: 0.5508832931518555  GigaBytes

torch.Size([821, 1433])
torch.Size([243, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.38332223892211914  GigaBytes
Max Memory Allocated: 0.5508832931518555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2660636901855469  GigaBytes
Max Memory Allocated: 0.5508832931518555  GigaBytes

torch.Size([1112, 1433])
torch.Size([469, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7811279296875 GB
    Memory Allocated: 0.47626209259033203  GigaBytes
Max Memory Allocated: 0.5508832931518555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.2635526657104492  GigaBytes
Max Memory Allocated: 0.5913000106811523  GigaBytes

torch.Size([644, 1433])
torch.Size([203, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.36023378372192383  GigaBytes
Max Memory Allocated: 0.5913000106811523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.2648301124572754  GigaBytes
Max Memory Allocated: 0.5913000106811523  GigaBytes

torch.Size([882, 1433])
torch.Size([320, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.42934608459472656  GigaBytes
Max Memory Allocated: 0.5913000106811523  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.26490259170532227  GigaBytes
Max Memory Allocated: 0.5913000106811523  GigaBytes

torch.Size([896, 1433])
torch.Size([304, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.4070911407470703  GigaBytes
Max Memory Allocated: 0.5913000106811523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.26531028747558594  GigaBytes
Max Memory Allocated: 0.5913000106811523  GigaBytes

torch.Size([972, 1433])
torch.Size([330, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.4277653694152832  GigaBytes
Max Memory Allocated: 0.5913000106811523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.26490116119384766  GigaBytes
Max Memory Allocated: 0.5913000106811523  GigaBytes

torch.Size([895, 1433])
torch.Size([363, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.4402933120727539  GigaBytes
Max Memory Allocated: 0.5913000106811523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.26279735565185547  GigaBytes
Max Memory Allocated: 0.5913000106811523  GigaBytes

torch.Size([503, 1433])
torch.Size([150, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.33318519592285156  GigaBytes
Max Memory Allocated: 0.5913000106811523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.2623476982116699  GigaBytes
Max Memory Allocated: 0.5913000106811523  GigaBytes

torch.Size([419, 1433])
torch.Size([139, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.32863330841064453  GigaBytes
Max Memory Allocated: 0.5913000106811523  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.050425782799720764 |0.00039429962635040283 |0.07752136886119843 |0.0001042485237121582 |0.114145427942276 |0.009560346603393555 |
----------------------------------------------------------pseudo_mini_loss sum 2.9066689014434814
Total (block generation + training)time/epoch 4.090825796127319
Training time/epoch 3.9560749530792236
Training time without block to device /epoch 3.949766159057617
Training time without total dataloading part /epoch 3.077897071838379
load block tensor time/epoch 0.8068125247955322
block to device time/epoch 0.006308794021606445
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16755
Number of first layer input nodes during this epoch:  11778
