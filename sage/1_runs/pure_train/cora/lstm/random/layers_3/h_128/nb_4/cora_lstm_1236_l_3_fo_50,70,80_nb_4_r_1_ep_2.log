main start at this time 1648429595.3509068
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011906623840332031
random selection method range initialization spend 0.00019216537475585938
time for parepare:  5.984306335449219e-05
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0024290084838867188
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  6.890296936035156e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.6743621826171875e-05
----------------------check_connections_block total spend ----------------------------- 0.003687143325805664
generate_one_block  0.0015017986297607422
generate_one_block  0.001119852066040039
generate_one_block  0.0010516643524169922
generate_one_block  0.0010218620300292969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004799365997314453
gen group dst list time:  3.814697265625e-05
time for parepare:  0.00015401840209960938
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004913806915283203
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0003845691680908203
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00038433074951171875
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.000385284423828125
----------------------check_connections_block total spend ----------------------------- 0.003261089324951172
generate_one_block  0.001596689224243164
generate_one_block  0.0014319419860839844
generate_one_block  0.0014259815216064453
generate_one_block  0.001512765884399414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005691051483154297
gen group dst list time:  7.82012939453125e-05
time for parepare:  0.00017309188842773438
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.0002930164337158203
mini_batch_src_global generation:  0.0001544952392578125
r_  generation:  0.001453399658203125
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  0.00014257431030273438
r_  generation:  0.0012006759643554688
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.0012493133544921875
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.00013899803161621094
r_  generation:  0.0012333393096923828
----------------------check_connections_block total spend ----------------------------- 0.008260726928710938
generate_one_block  0.0027124881744384766
generate_one_block  0.002357006072998047
generate_one_block  0.002490997314453125
generate_one_block  0.0024156570434570312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

connection checking time:  0.01152181625366211
block generation total time  0.015943527221679688
average batch blocks generation time:  0.003985881805419922
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.07438135147094727  GigaBytes
Max Memory Allocated: 0.07438135147094727  GigaBytes

torch.Size([1743, 1433])
torch.Size([876, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.48735761642456055  GigaBytes
Max Memory Allocated: 0.5074577331542969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.13835906982421875  GigaBytes
Max Memory Allocated: 0.59503173828125  GigaBytes

torch.Size([1548, 1433])
torch.Size([751, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.4872112274169922  GigaBytes
Max Memory Allocated: 0.59503173828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.13829469680786133  GigaBytes
Max Memory Allocated: 0.5961513519287109  GigaBytes

torch.Size([1536, 1433])
torch.Size([737, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.48593854904174805  GigaBytes
Max Memory Allocated: 0.5961513519287109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.13846158981323242  GigaBytes
Max Memory Allocated: 0.5961513519287109  GigaBytes

torch.Size([1567, 1433])
torch.Size([779, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.4966263771057129  GigaBytes
Max Memory Allocated: 0.5961513519287109  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04691892862319946 |0.08561241626739502 |0.29414063692092896 |0.00016200542449951172 |0.38496387004852295 |0.00976872444152832 |
----------------------------------------------------------pseudo_mini_loss sum 3.0945422649383545
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10276
Number of first layer input nodes during this epoch:  6394
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.2685723304748535  GigaBytes
Max Memory Allocated: 0.6052122116088867  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006089210510253906
random selection method range initialization spend 0.00014638900756835938
time for parepare:  9.298324584960938e-05
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0002243518829345703
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  9.250640869140625e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00014090538024902344Using backend: pytorch

mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  9.322166442871094e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  8.749961853027344e-05
----------------------check_connections_block total spend ----------------------------- 0.0016636848449707031
generate_one_block  0.001519918441772461
generate_one_block  0.0013604164123535156
generate_one_block  0.0013904571533203125
generate_one_block  0.0013985633850097656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006275177001953125
gen group dst list time:  5.745887756347656e-05
time for parepare:  0.0001933574676513672
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0002684593200683594
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0005583763122558594
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.000499725341796875
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0006322860717773438
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.0005748271942138672
----------------------check_connections_block total spend ----------------------------- 0.0043849945068359375
generate_one_block  0.003904581069946289
generate_one_block  0.0018877983093261719
generate_one_block  0.002063274383544922
generate_one_block  0.0019173622131347656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006270408630371094
gen group dst list time:  0.00011777877807617188
time for parepare:  0.00024437904357910156
local_output_nid generation:  9.72747802734375e-05
local_in_edges_tensor generation:  0.0003552436828613281
mini_batch_src_global generation:  0.00015044212341308594
r_  generation:  0.0016782283782958984
local_output_nid generation:  8.058547973632812e-05
local_in_edges_tensor generation:  0.0002560615539550781
mini_batch_src_global generation:  0.0001800060272216797
r_  generation:  0.0015628337860107422
local_output_nid generation:  0.00010371208190917969
local_in_edges_tensor generation:  0.00027298927307128906
mini_batch_src_global generation:  0.00018215179443359375
r_  generation:  0.0019049644470214844
local_output_nid generation:  9.34600830078125e-05
local_in_edges_tensor generation:  0.0002703666687011719
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.0018048286437988281
----------------------check_connections_block total spend ----------------------------- 0.011076688766479492
generate_one_block  0.003302335739135742
generate_one_block  0.0024695396423339844
generate_one_block  0.002826213836669922
generate_one_block  0.002571582794189453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.2685723304748535  GigaBytes
Max Memory Allocated: 0.6052122116088867  GigaBytes

connection checking time:  0.01546168327331543
block generation total time  0.02094268798828125
average batch blocks generation time:  0.0052356719970703125
block dataloader generation time/epoch 0.07175564765930176
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.2683553695678711  GigaBytes
Max Memory Allocated: 0.6052122116088867  GigaBytes

torch.Size([1538, 1433])
torch.Size([761, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.6187119483947754  GigaBytes
Max Memory Allocated: 0.6357636451721191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.26817989349365234  GigaBytes
Max Memory Allocated: 0.7268614768981934  GigaBytes

torch.Size([1506, 1433])
torch.Size([701, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.593991756439209  GigaBytes
Max Memory Allocated: 0.7268614768981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.26926326751708984  GigaBytes
Max Memory Allocated: 0.7268614768981934  GigaBytes

torch.Size([1707, 1433])
torch.Size([867, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.6660275459289551  GigaBytes
Max Memory Allocated: 0.7268614768981934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.26852893829345703  GigaBytes
Max Memory Allocated: 0.7720894813537598  GigaBytes

torch.Size([1570, 1433])
torch.Size([813, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.642676830291748  GigaBytes
Max Memory Allocated: 0.7720894813537598  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.047152817249298096 |0.0007338523864746094 |0.1761581301689148 |0.00012767314910888672 |0.3747428059577942 |0.010922670364379883 |
----------------------------------------------------------pseudo_mini_loss sum 2.2714927196502686
Total (block generation + training)time/epoch 2.541198253631592
Training time/epoch 2.469080924987793
Training time without block to device /epoch 2.4661455154418945
Training time without total dataloading part /epoch 2.2150371074676514
load block tensor time/epoch 0.18861126899719238
block to device time/epoch 0.0029354095458984375
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10185
Number of first layer input nodes during this epoch:  6321
