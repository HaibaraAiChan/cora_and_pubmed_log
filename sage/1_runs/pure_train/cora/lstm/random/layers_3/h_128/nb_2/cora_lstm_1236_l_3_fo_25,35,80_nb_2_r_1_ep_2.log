main start at this time 1648429477.70568
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011479854583740234
random selection method range initialization spend 0.00021409988403320312
time for parepare:  6.318092346191406e-05
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0024542808532714844
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00010752677917480469
----------------------check_connections_block total spend ----------------------------- 0.003250598907470703
generate_one_block  0.0014023780822753906
generate_one_block  0.0011410713195800781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00047087669372558594
gen group dst list time:  2.86102294921875e-05
time for parepare:  0.0001366138458251953
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0006589889526367188
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.000644683837890625
----------------------check_connections_block total spend ----------------------------- 0.0024361610412597656
generate_one_block  0.0017888545989990234
generate_one_block  0.0018014907836914062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005707740783691406
gen group dst list time:  5.53131103515625e-05
time for parepare:  0.0001678466796875
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.00030517578125
mini_batch_src_global generation:  0.00015044212341308594
r_  generation:  0.0017898082733154297
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.00024962425231933594
mini_batch_src_global generation:  0.00018668174743652344
r_  generation:  0.0016598701477050781
----------------------check_connections_block total spend ----------------------------- 0.005518436431884766
generate_one_block  0.003153085708618164
generate_one_block  0.0029807090759277344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

connection checking time:  0.007954597473144531
block generation total time  0.009724140167236328
average batch blocks generation time:  0.004862070083618164
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07530784606933594  GigaBytes
Max Memory Allocated: 0.07530784606933594  GigaBytes

torch.Size([1914, 1433])
torch.Size([1153, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.5708451271057129  GigaBytes
Max Memory Allocated: 0.5912013053894043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.13994073867797852  GigaBytes
Max Memory Allocated: 0.6686840057373047  GigaBytes

torch.Size([1841, 1433])
torch.Size([1067, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9393310546875 GB
    Memory Allocated: 0.6038169860839844  GigaBytes
Max Memory Allocated: 0.6686840057373047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03973698616027832 |0.1733466386795044 |0.3708306550979614 |0.0001804828643798828 |0.19268429279327393 |0.011189460754394531 |
----------------------------------------------------------pseudo_mini_loss sum 3.2855567932128906
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6672
Number of first layer input nodes during this epoch:  3755
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.27007627487182617  GigaBytes
Max Memory Allocated: 0.7020320892333984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004858970642089844
random selection method range initialization spend 0.00011658668518066406
time for parepare:  7.557868957519531e-05
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00011229515075683594
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00012993812561035156
----------------------check_connections_block total spend ----------------------------- 0.0008568763732910156
generate_one_block  0.001209259033203125
generate_one_block  0.0012104511260986328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000507354736328125
gen group dst list time:  2.9802322387695312e-05
time for parepare:  0.00014257431030273438
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0006041526794433594
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  9.632110595703125e-05
r_  generation:  0.0007576942443847656
----------------------check_connections_block total spend ----------------------------- 0.0025053024291992188
generate_one_block  0.001791238784790039
generate_one_block  0.001867055892944336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000568389892578125
gen group dst list time:  6.079673767089844e-05
time for parepare:  0.0001914501190185547
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.000308990478515625
mini_batch_src_global generation:  0.0001513957977294922
r_  generation:  0.0016062259674072266
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  0.00023174285888671875
r_  generation:  0.001842498779296875
----------------------check_connections_block total spend ----------------------------- 0.0056078433990478516
generate_one_block  0.0031299591064453125
generate_one_block  0.003055095672607422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.27007627487182617  GigaBytes
Max Memory Allocated: 0.7020320892333984  GigaBytes

connection checking time:  0.00811314582824707
block generation total time  0.00984334945678711
average batch blocks generation time:  0.004921674728393555
block dataloader generation time/epoch 0.033472537994384766
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.26996946334838867  GigaBytes
Max Memory Allocated: 0.7020320892333984  GigaBytes
Using backend: pytorch

torch.Size([1838, 1433])
torch.Size([1009, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.711308479309082  GigaBytes
Max Memory Allocated: 0.7303400039672852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1268310546875 GB
    Memory Allocated: 0.2706475257873535  GigaBytes
Max Memory Allocated: 0.8107647895812988  GigaBytes

torch.Size([1963, 1433])
torch.Size([1208, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1268310546875 GB
    Memory Allocated: 0.7845578193664551  GigaBytes
Max Memory Allocated: 0.8107647895812988  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03403139114379883 |0.0004292726516723633 |0.12902235984802246 |0.00012695789337158203 |0.1842198371887207 |0.010801553726196289 |
----------------------------------------------------------pseudo_mini_loss sum 2.442800521850586
Total (block generation + training)time/epoch 0.8007991313934326
Training time/epoch 0.7668793201446533
Training time without block to device /epoch 0.7660207748413086
Training time without total dataloading part /epoch 0.6375398635864258
load block tensor time/epoch 0.06806278228759766
block to device time/epoch 0.0008585453033447266
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6709
Number of first layer input nodes during this epoch:  3801
