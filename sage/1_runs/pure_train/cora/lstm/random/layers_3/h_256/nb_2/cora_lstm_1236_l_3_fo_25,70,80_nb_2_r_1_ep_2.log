main start at this time 1648429752.8006668
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012235641479492188
random selection method range initialization spend 0.00015664100646972656
time for parepare:  6.365776062011719e-05
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0013124942779541016
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00012111663818359375
----------------------check_connections_block total spend ----------------------------- 0.002130746841430664
generate_one_block  0.0013461112976074219
generate_one_block  0.0011663436889648438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005033016204833984
gen group dst list time:  2.9325485229492188e-05
time for parepare:  0.00014925003051757812
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0007429122924804688
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0006902217864990234
----------------------check_connections_block total spend ----------------------------- 0.0025959014892578125
generate_one_block  0.0019378662109375
generate_one_block  0.0018842220306396484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005929470062255859
gen group dst list time:  5.7697296142578125e-05
time for parepare:  0.00017642974853515625
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.0003459453582763672
mini_batch_src_global generation:  0.0001742839813232422
r_  generation:  0.0018222332000732422
local_output_nid generation:  8.058547973632812e-05
local_in_edges_tensor generation:  0.0002548694610595703
mini_batch_src_global generation:  0.00017714500427246094
r_  generation:  0.0017597675323486328
----------------------check_connections_block total spend ----------------------------- 0.005757808685302734
generate_one_block  0.0031774044036865234
generate_one_block  0.0030851364135742188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.008353710174560547
block generation total time  0.01008462905883789
average batch blocks generation time:  0.005042314529418945
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.08020401000976562  GigaBytes
Max Memory Allocated: 0.08020401000976562  GigaBytes

torch.Size([1954, 1433])
torch.Size([1215, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.6160049438476562  GigaBytes
Max Memory Allocated: 0.616480827331543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.15018320083618164  GigaBytes
Max Memory Allocated: 0.6933269500732422  GigaBytes

torch.Size([1961, 1433])
torch.Size([1167, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.6715602874755859  GigaBytes
Max Memory Allocated: 0.6933269500732422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037711143493652344 |0.17107069492340088 |0.38922417163848877 |0.0001881122589111328 |0.2348942756652832 |0.010210037231445312 |
----------------------------------------------------------pseudo_mini_loss sum 3.0868520736694336
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6999
Number of first layer input nodes during this epoch:  3915
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.28968381881713867  GigaBytes
Max Memory Allocated: 0.7466244697570801  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00048232078552246094
random selection method range initialization spend 0.00011444091796875
time for parepare:  6.508827209472656e-05
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0001342296600341797
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00012540817260742188
----------------------check_connections_block total spend ----------------------------- 0.0009124279022216797
generate_one_block  0.0013184547424316406
generate_one_block  0.0011970996856689453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005021095275878906
gen group dst list time:  3.075599670410156e-05
time for parepare:  0.00015306472778320312
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00023818016052246094
mini_batch_src_global generation:  8.177757263183594e-05
r_  generation:  0.0007271766662597656
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  9.369850158691406e-05
r_  generation:  0.0006706714630126953
----------------------check_connections_block total spend ----------------------------- 0.002596616744995117
generate_one_block  0.001976490020751953
generate_one_block  0.0018477439880371094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005679130554199219
gen group dst list time:  5.7697296142578125e-05
time for parepare:  0.00018978118896484375
local_output_nid generation:  9.799003601074219e-05
local_in_edges_tensor generation:  0.0003349781036376953
mini_batch_src_global generation:  0.00015664100646972656
r_  generation:  0.0018215179443359375
local_output_nid generation:  8.821487426757812e-05
local_in_edges_tensor generation:  0.00023937225341796875
mini_batch_src_global generation:  0.00021648406982421875
r_  generation:  0.0016908645629882812
----------------------check_connections_block total spend ----------------------------- 0.005730628967285156
generate_one_block  0.003238677978515625
generate_one_block  0.003015756607055664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.28968381881713867  GigaBytes
Max Memory Allocated: 0.7466244697570801  GigaBytes

connection checking time:  0.008327245712280273
block generation total time  0.010078668594360352
average batch blocks generation time:  0.005039334297180176
block dataloader generation time/epoch 0.03522920608520508
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.28922080993652344  GigaBytes
Max Memory Allocated: 0.7466244697570801  GigaBytes
Using backend: pytorch

torch.Size([1892, 1433])
torch.Size([1157, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.8129620552062988  GigaBytes
Max Memory Allocated: 0.8134312629699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.28958559036254883  GigaBytes
Max Memory Allocated: 0.8852181434631348  GigaBytes

torch.Size([1876, 1433])
torch.Size([1089, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.7668132781982422  GigaBytes
Max Memory Allocated: 0.8852181434631348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03241705894470215 |0.0004260540008544922 |0.1458977460861206 |0.0001220703125 |0.22463786602020264 |0.008017778396606445 |
----------------------------------------------------------pseudo_mini_loss sum 2.709167003631592
Total (block generation + training)time/epoch 0.9093220233917236
Training time/epoch 0.873828649520874
Training time without block to device /epoch 0.872976541519165
Training time without total dataloading part /epoch 0.7493331432342529
load block tensor time/epoch 0.0648341178894043
block to device time/epoch 0.0008521080017089844
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6705
Number of first layer input nodes during this epoch:  3768
