main start at this time 1648429763.3673215
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011506080627441406
random selection method range initialization spend 0.00020599365234375
time for parepare:  6.270408630371094e-05
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.002084970474243164
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  8.463859558105469e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  5.507469177246094e-05
----------------------check_connections_block total spend ----------------------------- 0.003317117691040039
generate_one_block  0.0014832019805908203
generate_one_block  0.0010638236999511719
generate_one_block  0.0010259151458740234
generate_one_block  0.0010612010955810547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005314350128173828
gen group dst list time:  4.00543212890625e-05
time for parepare:  0.0001399517059326172
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00036787986755371094
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0004608631134033203
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00042819976806640625
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0003662109375
----------------------check_connections_block total spend ----------------------------- 0.003175020217895508
generate_one_block  0.0014362335205078125
generate_one_block  0.0015594959259033203
generate_one_block  0.0015490055084228516
generate_one_block  0.0013551712036132812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005605220794677734
gen group dst list time:  7.987022399902344e-05
time for parepare:  0.0001742839813232422
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.00027441978454589844
mini_batch_src_global generation:  0.00011396408081054688
r_  generation:  0.0011212825775146484
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  0.00014352798461914062
r_  generation:  0.001241445541381836
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.001361846923828125
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0010728836059570312
----------------------check_connections_block total spend ----------------------------- 0.007870197296142578
generate_one_block  0.002340555191040039
generate_one_block  0.002457141876220703
generate_one_block  0.002599000930786133
generate_one_block  0.002234220504760742
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.011045217514038086
block generation total time  0.015530824661254883
average batch blocks generation time:  0.0038827061653137207
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07751941680908203  GigaBytes
Max Memory Allocated: 0.07751941680908203  GigaBytes

torch.Size([1456, 1433])
torch.Size([711, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.4032878875732422  GigaBytes
Max Memory Allocated: 0.40833473205566406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.14879083633422852  GigaBytes
Max Memory Allocated: 0.5081863403320312  GigaBytes

torch.Size([1594, 1433])
torch.Size([812, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7791748046875 GB
    Memory Allocated: 0.5268154144287109  GigaBytes
Max Memory Allocated: 0.5292887687683105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.1489276885986328  GigaBytes
Max Memory Allocated: 0.6175441741943359  GigaBytes

torch.Size([1716, 1433])
torch.Size([866, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.5410909652709961  GigaBytes
Max Memory Allocated: 0.6175441741943359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.14765357971191406  GigaBytes
Max Memory Allocated: 0.6325697898864746  GigaBytes

torch.Size([1479, 1433])
torch.Size([689, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.4695463180541992  GigaBytes
Max Memory Allocated: 0.6325697898864746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0480579137802124 |0.0853891372680664 |0.24432432651519775 |0.00016033649444580078 |0.20087271928787231 |0.012303352355957031 |
----------------------------------------------------------pseudo_mini_loss sum 3.002180576324463
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10061
Number of first layer input nodes during this epoch:  6245
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.28731298446655273  GigaBytes
Max Memory Allocated: 0.6325697898864746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004923343658447266
random selection method range initialization spend 0.00012373924255371094
time for parepare:  7.009506225585938e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.867813110351562e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011467933654785156Using backend: pytorch

mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  6.127357482910156e-05
----------------------check_connections_block total spend ----------------------------- 0.0013544559478759766
generate_one_block  0.0013430118560791016
generate_one_block  0.001140594482421875
generate_one_block  0.0010821819305419922
generate_one_block  0.0011208057403564453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005147457122802734
gen group dst list time:  4.267692565917969e-05
time for parepare:  0.00016355514526367188
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0004277229309082031
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0004601478576660156
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0004124641418457031
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.00045871734619140625
----------------------check_connections_block total spend ----------------------------- 0.0034286975860595703
generate_one_block  0.0016126632690429688
generate_one_block  0.0016050338745117188
generate_one_block  0.0015506744384765625
generate_one_block  0.0015559196472167969
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005843639373779297
gen group dst list time:  8.7738037109375e-05
time for parepare:  0.00019288063049316406
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.0002880096435546875
mini_batch_src_global generation:  0.00010633468627929688
r_  generation:  0.0011935234069824219
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  0.0001475811004638672
r_  generation:  0.0014026165008544922
local_output_nid generation:  6.628036499023438e-05
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0012466907501220703
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.0001232624053955078
r_  generation:  0.0012295246124267578
----------------------check_connections_block total spend ----------------------------- 0.008235931396484375
generate_one_block  0.002529144287109375
generate_one_block  0.0027365684509277344
generate_one_block  0.002588033676147461
generate_one_block  0.002373933792114258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.28731298446655273  GigaBytes
Max Memory Allocated: 0.6325697898864746  GigaBytes

connection checking time:  0.011664628982543945
block generation total time  0.016551971435546875
average batch blocks generation time:  0.004137992858886719
block dataloader generation time/epoch 0.056767940521240234
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.28707313537597656  GigaBytes
Max Memory Allocated: 0.6325697898864746  GigaBytes

torch.Size([1444, 1433])
torch.Size([706, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.6221809387207031  GigaBytes
Max Memory Allocated: 0.6325697898864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.2881941795349121  GigaBytes
Max Memory Allocated: 0.7171039581298828  GigaBytes

torch.Size([1653, 1433])
torch.Size([838, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.6742920875549316  GigaBytes
Max Memory Allocated: 0.7171039581298828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.28761816024780273  GigaBytes
Max Memory Allocated: 0.7664651870727539  GigaBytes

torch.Size([1546, 1433])
torch.Size([770, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.6371240615844727  GigaBytes
Max Memory Allocated: 0.7664651870727539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.28790903091430664  GigaBytes
Max Memory Allocated: 0.7664651870727539  GigaBytes

torch.Size([1522, 1433])
torch.Size([741, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.625058650970459  GigaBytes
Max Memory Allocated: 0.7664651870727539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04700404405593872 |0.00045180320739746094 |0.12401342391967773 |0.00012052059173583984 |0.1906765103340149 |0.01400613784790039 |
----------------------------------------------------------pseudo_mini_loss sum 2.7893989086151123
Total (block generation + training)time/epoch 1.5743277072906494
Training time/epoch 1.5171663761138916
Training time without block to device /epoch 1.5153591632843018
Training time without total dataloading part /epoch 1.2732479572296143
load block tensor time/epoch 0.18801617622375488
block to device time/epoch 0.0018072128295898438
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9954
Number of first layer input nodes during this epoch:  6165
