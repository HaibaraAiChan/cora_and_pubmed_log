main start at this time 1648429657.824903
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001157999038696289
random selection method range initialization spend 0.0001735687255859375
time for parepare:  6.079673767089844e-05
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0012359619140625
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  8.106231689453125e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.316734313964844e-05
----------------------check_connections_block total spend ----------------------------- 0.0024034976959228516
generate_one_block  0.001188039779663086
generate_one_block  0.0011425018310546875
generate_one_block  0.0010313987731933594
generate_one_block  0.0010066032409667969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004780292510986328
gen group dst list time:  3.981590270996094e-05
time for parepare:  0.00014019012451171875
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0003578662872314453
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.00043272972106933594
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0003991127014160156
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.00032448768615722656
----------------------check_connections_block total spend ----------------------------- 0.0030405521392822266
generate_one_block  0.0014243125915527344
generate_one_block  0.0014834403991699219
generate_one_block  0.00142669677734375
generate_one_block  0.0014216899871826172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005862712860107422
gen group dst list time:  7.62939453125e-05
time for parepare:  0.00017333030700683594
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.0002808570861816406
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0010561943054199219
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  0.0001499652862548828
r_  generation:  0.0012242794036865234
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.0001513957977294922
r_  generation:  0.001329660415649414
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0010259151458740234
----------------------check_connections_block total spend ----------------------------- 0.007645845413208008
generate_one_block  0.0021779537200927734
generate_one_block  0.002402067184448242
generate_one_block  0.0024690628051757812
generate_one_block  0.002122640609741211
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.010686397552490234
block generation total time  0.014927864074707031
average batch blocks generation time:  0.003731966018676758
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07734107971191406  GigaBytes
Max Memory Allocated: 0.07734107971191406  GigaBytes

torch.Size([1423, 1433])
torch.Size([661, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5916748046875 GB
    Memory Allocated: 0.38591670989990234  GigaBytes
Max Memory Allocated: 0.3903827667236328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.1483922004699707  GigaBytes
Max Memory Allocated: 0.49295663833618164  GigaBytes

torch.Size([1525, 1433])
torch.Size([750, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.50653076171875  GigaBytes
Max Memory Allocated: 0.5090804100036621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.14899539947509766  GigaBytes
Max Memory Allocated: 0.5993995666503906  GigaBytes

torch.Size([1638, 1433])
torch.Size([775, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.511474609375  GigaBytes
Max Memory Allocated: 0.5993995666503906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.14769601821899414  GigaBytes
Max Memory Allocated: 0.605616569519043  GigaBytes

torch.Size([1396, 1433])
torch.Size([629, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.44985389709472656  GigaBytes
Max Memory Allocated: 0.605616569519043  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04795944690704346 |0.08525484800338745 |0.22976571321487427 |0.00012880563735961914 |0.16685038805007935 |0.01450490951538086 |
----------------------------------------------------------pseudo_mini_loss sum 3.00125789642334
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9535
Number of first layer input nodes during this epoch:  5982
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9432373046875 GB
    Memory Allocated: 0.2875704765319824  GigaBytes
Max Memory Allocated: 0.605616569519043  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00048089027404785156
random selection method range initialization spend 0.00011992454528808594
time for parepare:  6.341934204101562e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  7.581710815429688e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010991096496582031Using backend: pytorch

mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  5.888938903808594e-05
----------------------check_connections_block total spend ----------------------------- 0.0012969970703125
generate_one_block  0.0012137889862060547
generate_one_block  0.0010828971862792969
generate_one_block  0.0010411739349365234
generate_one_block  0.0010869503021240234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005114078521728516
gen group dst list time:  4.267692565917969e-05
time for parepare:  0.0001544952392578125
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003795623779296875
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0004146099090576172
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0003509521484375
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0015492439270019531
----------------------check_connections_block total spend ----------------------------- 0.004285097122192383
generate_one_block  0.0014829635620117188
generate_one_block  0.0015492439270019531
generate_one_block  0.001430511474609375
generate_one_block  0.001428365707397461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005750656127929688
gen group dst list time:  8.320808410644531e-05
time for parepare:  0.00018358230590820312
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.0002918243408203125
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.0010383129119873047
local_output_nid generation:  7.152557373046875e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  0.00017333030700683594
r_  generation:  0.0012843608856201172
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.00013637542724609375
r_  generation:  0.0010821819305419922
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.00012135505676269531
r_  generation:  0.0010731220245361328
----------------------check_connections_block total spend ----------------------------- 0.007548093795776367
generate_one_block  0.002363443374633789
generate_one_block  0.003144502639770508
generate_one_block  0.0024216175079345703
generate_one_block  0.0022597312927246094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9432373046875 GB
    Memory Allocated: 0.2875704765319824  GigaBytes
Max Memory Allocated: 0.605616569519043  GigaBytes

connection checking time:  0.01183319091796875
block generation total time  0.016080379486083984
average batch blocks generation time:  0.004020094871520996
block dataloader generation time/epoch 0.05208015441894531
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9432373046875 GB
    Memory Allocated: 0.28804826736450195  GigaBytes
Max Memory Allocated: 0.605616569519043  GigaBytes

torch.Size([1361, 1433])
torch.Size([646, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9432373046875 GB
    Memory Allocated: 0.6025667190551758  GigaBytes
Max Memory Allocated: 0.605616569519043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.2887139320373535  GigaBytes
Max Memory Allocated: 0.6992983818054199  GigaBytes

torch.Size([1618, 1433])
torch.Size([776, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.6563329696655273  GigaBytes
Max Memory Allocated: 0.6992983818054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.28804922103881836  GigaBytes
Max Memory Allocated: 0.7502608299255371  GigaBytes

torch.Size([1455, 1433])
torch.Size([677, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.6089940071105957  GigaBytes
Max Memory Allocated: 0.7502608299255371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.2877354621887207  GigaBytes
Max Memory Allocated: 0.7502608299255371  GigaBytes

torch.Size([1436, 1433])
torch.Size([671, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.6031265258789062  GigaBytes
Max Memory Allocated: 0.7502608299255371  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04634124040603638 |0.0004151463508605957 |0.11135077476501465 |0.00012367963790893555 |0.16529762744903564 |0.010733842849731445 |
----------------------------------------------------------pseudo_mini_loss sum 2.8959274291992188
Total (block generation + training)time/epoch 1.4167351722717285
Training time/epoch 1.364380121231079
Training time without block to device /epoch 1.3627195358276367
Training time without total dataloading part /epoch 1.1178221702575684
load block tensor time/epoch 0.1853649616241455
block to device time/epoch 0.0016605854034423828
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9374
Number of first layer input nodes during this epoch:  5870
