main start at this time 1648429647.2955906
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010237693786621094
random selection method range initialization spend 0.00016736984252929688
time for parepare:  6.508827209472656e-05
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0013782978057861328
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00011754035949707031
----------------------check_connections_block total spend ----------------------------- 0.002248525619506836
generate_one_block  0.0015022754669189453
generate_one_block  0.0011806488037109375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00048828125
gen group dst list time:  3.0040740966796875e-05
time for parepare:  0.0001392364501953125
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0007102489471435547
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0006937980651855469
----------------------check_connections_block total spend ----------------------------- 0.0025386810302734375
generate_one_block  0.0019023418426513672
generate_one_block  0.0018553733825683594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005924701690673828
gen group dst list time:  5.5789947509765625e-05
time for parepare:  0.0001704692840576172
local_output_nid generation:  7.343292236328125e-05
local_in_edges_tensor generation:  0.0003180503845214844
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.0017549991607666016
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.0002484321594238281
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.0016798973083496094
----------------------check_connections_block total spend ----------------------------- 0.005530118942260742
generate_one_block  0.003042936325073242
generate_one_block  0.002995729446411133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.00806879997253418
block generation total time  0.009796380996704102
average batch blocks generation time:  0.004898190498352051
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07970476150512695  GigaBytes
Max Memory Allocated: 0.07970476150512695  GigaBytes

torch.Size([1861, 1433])
torch.Size([1130, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8240966796875 GB
    Memory Allocated: 0.5889339447021484  GigaBytes
Max Memory Allocated: 0.5894098281860352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.15032625198364258  GigaBytes
Max Memory Allocated: 0.6700940132141113  GigaBytes

torch.Size([1892, 1433])
torch.Size([1089, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.643488883972168  GigaBytes
Max Memory Allocated: 0.6700940132141113  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.038614749908447266 |0.17035460472106934 |0.3674309253692627 |0.0001837015151977539 |0.19112169742584229 |0.011129617691040039 |
----------------------------------------------------------pseudo_mini_loss sum 3.1760811805725098
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6674
Number of first layer input nodes during this epoch:  3753
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.28982019424438477  GigaBytes
Max Memory Allocated: 0.7210440635681152  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00045871734619140625
random selection method range initialization spend 0.000110626220703125
time for parepare:  6.103515625e-05
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001246929168701172
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00011730194091796875
----------------------check_connections_block total spend ----------------------------- 0.0008368492126464844
generate_one_block  0.0012438297271728516
generate_one_block  0.0011439323425292969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004603862762451172
gen group dst list time:  3.0517578125e-05
time for parepare:  0.0001392364501953125
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00020265579223632812
mini_batch_src_global generation:  7.581710815429688e-05
r_  generation:  0.0006635189056396484
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.000598907470703125
----------------------check_connections_block total spend ----------------------------- 0.0023539066314697266
generate_one_block  0.0018527507781982422
generate_one_block  0.0016922950744628906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005340576171875
gen group dst list time:  5.7220458984375e-05
time for parepare:  0.0001811981201171875
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.0002989768981933594
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0016088485717773438
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  0.00016736984252929688
r_  generation:  0.0015282630920410156
----------------------check_connections_block total spend ----------------------------- 0.005060911178588867
generate_one_block  0.003048419952392578
generate_one_block  0.0027475357055664062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.28982019424438477  GigaBytes
Max Memory Allocated: 0.7210440635681152  GigaBytes

connection checking time:  0.007414817810058594
block generation total time  0.009341001510620117
average batch blocks generation time:  0.004670500755310059
block dataloader generation time/epoch 0.05877542495727539
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.28943443298339844  GigaBytes
Max Memory Allocated: 0.7210440635681152  GigaBytes
Using backend: pytorch

torch.Size([1836, 1433])
torch.Size([1080, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1502685546875 GB
    Memory Allocated: 0.7887859344482422  GigaBytes
Max Memory Allocated: 0.7892551422119141  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.28972864151000977  GigaBytes
Max Memory Allocated: 0.8635244369506836  GigaBytes

torch.Size([1787, 1433])
torch.Size([1011, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.7445859909057617  GigaBytes
Max Memory Allocated: 0.8635244369506836  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03342616558074951 |0.00042068958282470703 |0.13249683380126953 |0.00012445449829101562 |0.19285428524017334 |0.008754730224609375 |
----------------------------------------------------------pseudo_mini_loss sum 2.7454729080200195
Total (block generation + training)time/epoch 0.8448097705841064
Training time/epoch 0.7858104705810547
Training time without block to device /epoch 0.7849690914154053
Training time without total dataloading part /epoch 0.6597058773040771
load block tensor time/epoch 0.06685233116149902
block to device time/epoch 0.0008413791656494141
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6405
Number of first layer input nodes during this epoch:  3623
