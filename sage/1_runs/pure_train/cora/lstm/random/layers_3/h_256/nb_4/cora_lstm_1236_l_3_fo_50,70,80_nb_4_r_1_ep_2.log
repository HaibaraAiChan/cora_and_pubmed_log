main start at this time 1648429819.1903424
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010886192321777344
random selection method range initialization spend 0.0001685619354248047
time for parepare:  6.246566772460938e-05
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0015850067138671875
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.435943603515625e-05
----------------------check_connections_block total spend ----------------------------- 0.0027763843536376953
generate_one_block  0.0012447834014892578
generate_one_block  0.0010955333709716797
generate_one_block  0.0010192394256591797
generate_one_block  0.001001596450805664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005173683166503906
gen group dst list time:  4.0531158447265625e-05
time for parepare:  0.00014662742614746094
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0003795623779296875
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0004532337188720703
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0004298686981201172
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0003476142883300781
----------------------check_connections_block total spend ----------------------------- 0.0031385421752929688
generate_one_block  0.0014801025390625
generate_one_block  0.0014815330505371094
generate_one_block  0.0015072822570800781
generate_one_block  0.0013954639434814453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00055694580078125
gen group dst list time:  7.62939453125e-05
time for parepare:  0.00017261505126953125
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.000270843505859375
mini_batch_src_global generation:  0.00011205673217773438
r_  generation:  0.0011975765228271484
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  0.00015020370483398438
r_  generation:  0.0013675689697265625
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.00013685226440429688
r_  generation:  0.001432657241821289
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.0011260509490966797
----------------------check_connections_block total spend ----------------------------- 0.008180618286132812
generate_one_block  0.0023691654205322266
generate_one_block  0.0024759769439697266
generate_one_block  0.0026755332946777344
generate_one_block  0.002273082733154297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.011319160461425781
block generation total time  0.015658140182495117
average batch blocks generation time:  0.003914535045623779
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07776165008544922  GigaBytes
Max Memory Allocated: 0.07776165008544922  GigaBytes

torch.Size([1501, 1433])
torch.Size([711, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.4210968017578125  GigaBytes
Max Memory Allocated: 0.42667531967163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.14824390411376953  GigaBytes
Max Memory Allocated: 0.5274667739868164  GigaBytes

torch.Size([1626, 1433])
torch.Size([820, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8006591796875 GB
    Memory Allocated: 0.5483407974243164  GigaBytes
Max Memory Allocated: 0.5521965026855469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.14863252639770508  GigaBytes
Max Memory Allocated: 0.6403508186340332  GigaBytes

torch.Size([1718, 1433])
torch.Size([864, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.5604209899902344  GigaBytes
Max Memory Allocated: 0.6403508186340332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.14742803573608398  GigaBytes
Max Memory Allocated: 0.6535134315490723  GigaBytes

torch.Size([1494, 1433])
torch.Size([686, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.4854722023010254  GigaBytes
Max Memory Allocated: 0.6535134315490723  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04683810472488403 |0.08466851711273193 |0.2951488494873047 |0.00013875961303710938 |0.3986549377441406 |0.01086735725402832 |
----------------------------------------------------------pseudo_mini_loss sum 2.9976983070373535
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10158
Number of first layer input nodes during this epoch:  6339
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.28689146041870117  GigaBytes
Max Memory Allocated: 0.6535134315490723  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004897117614746094
random selection method range initialization spend 0.00012612342834472656
time for parepare:  6.604194641113281e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  7.557868957519531e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.000110626220703125Using backend: pytorch

mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  6.723403930664062e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.8650970458984375e-05
----------------------check_connections_block total spend ----------------------------- 0.0013167858123779297
generate_one_block  0.0012936592102050781
generate_one_block  0.0011191368103027344
generate_one_block  0.0010759830474853516
generate_one_block  0.0011093616485595703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005307197570800781
gen group dst list time:  4.172325134277344e-05
time for parepare:  0.00015044212341308594
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.000408172607421875
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0004394054412841797
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0003936290740966797
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.00043129920959472656
----------------------check_connections_block total spend ----------------------------- 0.003347635269165039
generate_one_block  0.0016353130340576172
generate_one_block  0.0016491413116455078
generate_one_block  0.0015311241149902344
generate_one_block  0.0014886856079101562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005810260772705078
gen group dst list time:  8.463859558105469e-05
time for parepare:  0.00019693374633789062
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.0002830028533935547
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0011720657348632812
local_output_nid generation:  8.058547973632812e-05
local_in_edges_tensor generation:  0.00020933151245117188
mini_batch_src_global generation:  0.00019049644470214844
r_  generation:  0.001398324966430664
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  0.0001342296600341797
r_  generation:  0.0012347698211669922
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  0.00012040138244628906
r_  generation:  0.0026700496673583984
----------------------check_connections_block total spend ----------------------------- 0.009754419326782227
generate_one_block  0.0025207996368408203
generate_one_block  0.0027723312377929688
generate_one_block  0.002632617950439453
generate_one_block  0.002453327178955078
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.28689146041870117  GigaBytes
Max Memory Allocated: 0.6535134315490723  GigaBytes

connection checking time:  0.013102054595947266
block generation total time  0.016683340072631836
average batch blocks generation time:  0.004170835018157959
block dataloader generation time/epoch 0.06269311904907227
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.28675079345703125  GigaBytes
Max Memory Allocated: 0.6535134315490723  GigaBytes

torch.Size([1478, 1433])
torch.Size([706, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.6392951011657715  GigaBytes
Max Memory Allocated: 0.6535134315490723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.28788185119628906  GigaBytes
Max Memory Allocated: 0.7355670928955078  GigaBytes

torch.Size([1689, 1433])
torch.Size([839, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.6931028366088867  GigaBytes
Max Memory Allocated: 0.7355670928955078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.287168025970459  GigaBytes
Max Memory Allocated: 0.7868638038635254  GigaBytes

torch.Size([1556, 1433])
torch.Size([772, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.6525225639343262  GigaBytes
Max Memory Allocated: 0.7868638038635254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.2878761291503906  GigaBytes
Max Memory Allocated: 0.7868638038635254  GigaBytes

torch.Size([1554, 1433])
torch.Size([741, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.6411800384521484  GigaBytes
Max Memory Allocated: 0.7868638038635254  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04411041736602783 |0.0006560087203979492 |0.17498093843460083 |0.00012916326522827148 |0.3862917423248291 |0.009914159774780273 |
----------------------------------------------------------pseudo_mini_loss sum 2.782864570617676
Total (block generation + training)time/epoch 2.5590739250183105
Training time/epoch 2.4961040019989014
Training time without block to device /epoch 2.4934799671173096
Training time without total dataloading part /epoch 2.255521535873413
load block tensor time/epoch 0.17644166946411133
block to device time/epoch 0.002624034881591797
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10069
Number of first layer input nodes during this epoch:  6277
