main start at this time 1648429699.821459
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013384819030761719
random selection method range initialization spend 0.000164031982421875
time for parepare:  6.365776062011719e-05
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.0017824172973632812
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00011873245239257812
----------------------check_connections_block total spend ----------------------------- 0.002626657485961914
generate_one_block  0.0015490055084228516
generate_one_block  0.0011692047119140625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00049591064453125
gen group dst list time:  2.956390380859375e-05
time for parepare:  0.0001468658447265625
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0007107257843017578
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  8.20159912109375e-05
r_  generation:  0.0006542205810546875
----------------------check_connections_block total spend ----------------------------- 0.0025148391723632812
generate_one_block  0.0018916130065917969
generate_one_block  0.0018243789672851562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000579833984375
gen group dst list time:  5.507469177246094e-05
time for parepare:  0.00017905235290527344
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.0003256797790527344
mini_batch_src_global generation:  0.00015687942504882812
r_  generation:  0.0017552375793457031
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.00025081634521484375
mini_batch_src_global generation:  0.00017595291137695312
r_  generation:  0.0017104148864746094
----------------------check_connections_block total spend ----------------------------- 0.005574226379394531
generate_one_block  0.003020048141479492
generate_one_block  0.002969980239868164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.008089065551757812
block generation total time  0.00970602035522461
average batch blocks generation time:  0.004853010177612305
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07977962493896484  GigaBytes
Max Memory Allocated: 0.07977962493896484  GigaBytes

torch.Size([1875, 1433])
torch.Size([1146, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.5948834419250488  GigaBytes
Max Memory Allocated: 0.5953593254089355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.15092086791992188  GigaBytes
Max Memory Allocated: 0.6759881973266602  GigaBytes

torch.Size([1918, 1433])
torch.Size([1102, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.6535334587097168  GigaBytes
Max Memory Allocated: 0.6759881973266602  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03851056098937988 |0.1722348928451538 |0.3687431812286377 |0.0001811981201171875 |0.19165515899658203 |0.011043787002563477 |
----------------------------------------------------------pseudo_mini_loss sum 3.1805317401885986
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6743
Number of first layer input nodes during this epoch:  3793
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1424560546875 GB
    Memory Allocated: 0.2910304069519043  GigaBytes
Max Memory Allocated: 0.7315068244934082  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004830360412597656
random selection method range initialization spend 0.0001163482666015625
time for parepare:  6.389617919921875e-05
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00012969970703125
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00011706352233886719
----------------------check_connections_block total spend ----------------------------- 0.0008637905120849609
generate_one_block  0.0012221336364746094
generate_one_block  0.0011644363403320312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000484466552734375
gen group dst list time:  3.147125244140625e-05
time for parepare:  0.00014591217041015625
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.000701904296875
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  9.34600830078125e-05
r_  generation:  0.0006234645843505859
----------------------check_connections_block total spend ----------------------------- 0.0024597644805908203
generate_one_block  0.0019233226776123047
generate_one_block  0.0018668174743652344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005676746368408203
gen group dst list time:  6.079673767089844e-05
time for parepare:  0.0001914501190185547
local_output_nid generation:  8.606910705566406e-05
local_in_edges_tensor generation:  0.0003154277801513672
mini_batch_src_global generation:  0.00015044212341308594
r_  generation:  0.0016241073608398438
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.0002079010009765625
r_  generation:  0.0016067028045654297
----------------------check_connections_block total spend ----------------------------- 0.005307912826538086
generate_one_block  0.003192901611328125
generate_one_block  0.002726316452026367
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1424560546875 GB
    Memory Allocated: 0.2910304069519043  GigaBytes
Max Memory Allocated: 0.7315068244934082  GigaBytes

connection checking time:  0.007767677307128906
block generation total time  0.009709358215332031
average batch blocks generation time:  0.004854679107666016
block dataloader generation time/epoch 0.036612749099731445
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1424560546875 GB
    Memory Allocated: 0.2900829315185547  GigaBytes
Max Memory Allocated: 0.7315068244934082  GigaBytes
Using backend: pytorch

torch.Size([1844, 1433])
torch.Size([1092, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.7920222282409668  GigaBytes
Max Memory Allocated: 0.7924914360046387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1502685546875 GB
    Memory Allocated: 0.2897834777832031  GigaBytes
Max Memory Allocated: 0.866814136505127  GigaBytes

torch.Size([1789, 1433])
torch.Size([1017, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1502685546875 GB
    Memory Allocated: 0.745326042175293  GigaBytes
Max Memory Allocated: 0.866814136505127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0345003604888916 |0.0004124641418457031 |0.1300511360168457 |0.00011670589447021484 |0.18682527542114258 |0.008239030838012695 |
----------------------------------------------------------pseudo_mini_loss sum 2.7672080993652344
Total (block generation + training)time/epoch 0.8073446750640869
Training time/epoch 0.7704586982727051
Training time without block to device /epoch 0.7696337699890137
Training time without total dataloading part /epoch 0.6422252655029297
load block tensor time/epoch 0.0690007209777832
block to device time/epoch 0.0008249282836914062
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6433
Number of first layer input nodes during this epoch:  3633
