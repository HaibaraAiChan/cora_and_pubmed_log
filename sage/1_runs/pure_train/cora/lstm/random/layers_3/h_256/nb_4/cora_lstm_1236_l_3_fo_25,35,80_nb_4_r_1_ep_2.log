main start at this time 1648429710.366387
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001256704330444336
random selection method range initialization spend 0.00022172927856445312
time for parepare:  6.580352783203125e-05
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0033168792724609375
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  9.250640869140625e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.651878356933594e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.0558319091796875e-05
----------------------check_connections_block total spend ----------------------------- 0.004629850387573242
generate_one_block  0.0014269351959228516
generate_one_block  0.001172780990600586
generate_one_block  0.0011415481567382812
generate_one_block  0.0011022090911865234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005202293395996094
gen group dst list time:  4.363059997558594e-05
time for parepare:  0.00014925003051757812
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.00037980079650878906
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0004839897155761719
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00044655799865722656
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.00035953521728515625
----------------------check_connections_block total spend ----------------------------- 0.0033080577850341797
generate_one_block  0.001512765884399414
generate_one_block  0.0016028881072998047
generate_one_block  0.0015714168548583984
generate_one_block  0.0014755725860595703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005991458892822266
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.00018405914306640625
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00027871131896972656
mini_batch_src_global generation:  0.00010371208190917969
r_  generation:  0.0011637210845947266
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  0.00015997886657714844
r_  generation:  0.0013325214385986328
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  0.00013899803161621094
r_  generation:  0.0013573169708251953
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.00012183189392089844
r_  generation:  0.001116037368774414
----------------------check_connections_block total spend ----------------------------- 0.008098840713500977
generate_one_block  0.002421140670776367
generate_one_block  0.0025947093963623047
generate_one_block  0.0026845932006835938
generate_one_block  0.0021600723266601562
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.011406898498535156
block generation total time  0.01602315902709961
average batch blocks generation time:  0.004005789756774902
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.0773305892944336  GigaBytes
Max Memory Allocated: 0.0773305892944336  GigaBytes

torch.Size([1421, 1433])
torch.Size([663, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5916748046875 GB
    Memory Allocated: 0.38686418533325195  GigaBytes
Max Memory Allocated: 0.39134979248046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.14841365814208984  GigaBytes
Max Memory Allocated: 0.4938979148864746  GigaBytes

torch.Size([1527, 1433])
torch.Size([749, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.5064244270324707  GigaBytes
Max Memory Allocated: 0.5089621543884277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.14902210235595703  GigaBytes
Max Memory Allocated: 0.5993013381958008  GigaBytes

torch.Size([1641, 1433])
torch.Size([778, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.513239860534668  GigaBytes
Max Memory Allocated: 0.5993013381958008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.14765310287475586  GigaBytes
Max Memory Allocated: 0.6075935363769531  GigaBytes

torch.Size([1386, 1433])
torch.Size([630, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.45165300369262695  GigaBytes
Max Memory Allocated: 0.6075935363769531  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04777336120605469 |0.08813053369522095 |0.23237895965576172 |0.00015300512313842773 |0.17163288593292236 |0.01375126838684082 |
----------------------------------------------------------pseudo_mini_loss sum 3.003573179244995
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9533
Number of first layer input nodes during this epoch:  5975
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.2876138687133789  GigaBytes
Max Memory Allocated: 0.6075935363769531  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004906654357910156
random selection method range initialization spend 0.00012445449829101562
time for parepare:  6.508827209472656e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  7.605552673339844e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00010991096496582031
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  6.723403930664062e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.198883056640625e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.984306335449219e-05
----------------------check_connections_block total spend ----------------------------- 0.0013959407806396484
generate_one_block  0.0012035369873046875
generate_one_block  0.0011065006256103516
generate_one_block  0.0010900497436523438
generate_one_block  0.0010907649993896484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005066394805908203
gen group dst list time:  4.2438507080078125e-05
time for parepare:  0.0001468658447265625
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.000400543212890625
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.00043654441833496094
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0003674030303955078
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00039124488830566406
----------------------check_connections_block total spend ----------------------------- 0.003227710723876953
generate_one_block  0.0015344619750976562
generate_one_block  0.0015668869018554688
generate_one_block  0.0014672279357910156
generate_one_block  0.0014910697937011719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005631446838378906
gen group dst list time:  7.748603820800781e-05
time for parepare:  0.00018668174743652344
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.0002894401550292969
mini_batch_src_global generation:  9.417533874511719e-05
r_  generation:  0.0010890960693359375
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  0.0001430511474609375
r_  generation:  0.0012984275817871094
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  0.00012755393981933594
r_  generation:  0.0011568069458007812
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.00011539459228515625
r_  generation:  0.0011780261993408203
----------------------check_connections_block total spend ----------------------------- 0.0077190399169921875
generate_one_block  0.0023758411407470703
generate_one_block  0.0031108856201171875
generate_one_block  0.0024819374084472656
generate_one_block  0.0022513866424560547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.2876138687133789  GigaBytes
Max Memory Allocated: 0.6075935363769531  GigaBytes

connection checking time:  0.01094675064086914
block generation total time  0.01627969741821289
average batch blocks generation time:  0.004069924354553223
block dataloader generation time/epoch 0.0529172420501709
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.28819847106933594  GigaBytes
Max Memory Allocated: 0.6075935363769531  GigaBytes

torch.Size([1376, 1433])
torch.Size([647, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.6014351844787598  GigaBytes
Max Memory Allocated: 0.6075935363769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.28868770599365234  GigaBytes
Max Memory Allocated: 0.6981582641601562  GigaBytes

torch.Size([1595, 1433])
torch.Size([780, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9490966796875 GB
    Memory Allocated: 0.6561198234558105  GigaBytes
Max Memory Allocated: 0.6981582641601562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.28819942474365234  GigaBytes
Max Memory Allocated: 0.7500138282775879  GigaBytes

torch.Size([1468, 1433])
torch.Size([683, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.610511302947998  GigaBytes
Max Memory Allocated: 0.7500138282775879  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.2878694534301758  GigaBytes
Max Memory Allocated: 0.7500138282775879  GigaBytes

torch.Size([1443, 1433])
torch.Size([671, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.6021456718444824  GigaBytes
Max Memory Allocated: 0.7500138282775879  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04627370834350586 |0.00044482946395874023 |0.11251240968704224 |0.00011903047561645508 |0.16223156452178955 |0.010746479034423828 |
----------------------------------------------------------pseudo_mini_loss sum 2.857052803039551
Total (block generation + training)time/epoch 1.407170295715332
Training time/epoch 1.3538706302642822
Training time without block to device /epoch 1.3520913124084473
Training time without total dataloading part /epoch 1.1101984977722168
load block tensor time/epoch 0.18509483337402344
block to device time/epoch 0.001779317855834961
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9397
Number of first layer input nodes during this epoch:  5882
