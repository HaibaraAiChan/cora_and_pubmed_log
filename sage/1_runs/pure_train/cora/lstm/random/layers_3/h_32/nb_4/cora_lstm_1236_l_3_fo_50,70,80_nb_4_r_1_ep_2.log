main start at this time 1648429148.0235438
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011529922485351562
random selection method range initialization spend 0.00019097328186035156
time for parepare:  6.723403930664062e-05
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0024666786193847656
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  7.319450378417969e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.365776062011719e-05
----------------------check_connections_block total spend ----------------------------- 0.0037953853607177734
generate_one_block  0.001550436019897461
generate_one_block  0.0011467933654785156
generate_one_block  0.0011317729949951172
generate_one_block  0.001096487045288086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005168914794921875
gen group dst list time:  4.029273986816406e-05
time for parepare:  0.000156402587890625
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.0004105567932128906
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0005116462707519531
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00048160552978515625
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.00035953521728515625
----------------------check_connections_block total spend ----------------------------- 0.003451824188232422
generate_one_block  0.001539468765258789
generate_one_block  0.0016407966613769531
generate_one_block  0.0016133785247802734
generate_one_block  0.0014634132385253906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006084442138671875
gen group dst list time:  8.225440979003906e-05
time for parepare:  0.0001900196075439453
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.0002789497375488281
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0012516975402832031
local_output_nid generation:  6.628036499023438e-05
local_in_edges_tensor generation:  0.00022482872009277344
mini_batch_src_global generation:  0.0001513957977294922
r_  generation:  0.0014865398406982422
local_output_nid generation:  6.628036499023438e-05
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  0.0001480579376220703
r_  generation:  0.0014483928680419922
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0011594295501708984
----------------------check_connections_block total spend ----------------------------- 0.00857996940612793
generate_one_block  0.0025548934936523438
generate_one_block  0.0027625560760498047
generate_one_block  0.002661466598510742
generate_one_block  0.0022428035736083984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

connection checking time:  0.012031793594360352
block generation total time  0.016478776931762695
average batch blocks generation time:  0.004119694232940674
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07088184356689453  GigaBytes
Max Memory Allocated: 0.07088184356689453  GigaBytes

torch.Size([1476, 1433])
torch.Size([707, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.38902997970581055  GigaBytes
Max Memory Allocated: 0.4132351875305176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.13469457626342773  GigaBytes
Max Memory Allocated: 0.5071220397949219  GigaBytes

torch.Size([1634, 1433])
torch.Size([844, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7674560546875 GB
    Memory Allocated: 0.5174813270568848  GigaBytes
Max Memory Allocated: 0.546318531036377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.1348099708557129  GigaBytes
Max Memory Allocated: 0.6335468292236328  GigaBytes

torch.Size([1656, 1433])
torch.Size([833, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.5024023056030273  GigaBytes
Max Memory Allocated: 0.6335468292236328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.13341760635375977  GigaBytes
Max Memory Allocated: 0.6335468292236328  GigaBytes

torch.Size([1397, 1433])
torch.Size([641, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.42288732528686523  GigaBytes
Max Memory Allocated: 0.6335468292236328  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04510921239852905 |0.08592194318771362 |0.28563636541366577 |0.00015246868133544922 |0.3866432309150696 |0.010354995727539062 |
----------------------------------------------------------pseudo_mini_loss sum 3.0187673568725586
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9916
Number of first layer input nodes during this epoch:  6163
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.25938940048217773  GigaBytes
Max Memory Allocated: 0.6335468292236328  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005214214324951172
random selection method range initialization spend 0.00012636184692382812
time for parepare:  7.486343383789062e-05
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  8.58306884765625e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00011920928955078125Using backend: pytorch

mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  9.584426879882812e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.961822509765625e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.817413330078125e-05
----------------------check_connections_block total spend ----------------------------- 0.001466512680053711
generate_one_block  0.0013051033020019531
generate_one_block  0.0011897087097167969
generate_one_block  0.0011434555053710938
generate_one_block  0.001130819320678711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005269050598144531
gen group dst list time:  4.410743713378906e-05
time for parepare:  0.0001614093780517578
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0005114078521728516
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0005142688751220703
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0004057884216308594
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0003757476806640625
----------------------check_connections_block total spend ----------------------------- 0.0035734176635742188
generate_one_block  0.001753091812133789
generate_one_block  0.0017371177673339844
generate_one_block  0.0015637874603271484
generate_one_block  0.0015337467193603516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006098747253417969
gen group dst list time:  8.96453857421875e-05
time for parepare:  0.00019741058349609375
local_output_nid generation:  8.058547973632812e-05
local_in_edges_tensor generation:  0.00031113624572753906
mini_batch_src_global generation:  0.000125885009765625
r_  generation:  0.0015077590942382812
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  0.00019860267639160156
r_  generation:  0.0015294551849365234
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.0001347064971923828
r_  generation:  0.0013000965118408203
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  0.00012826919555664062
r_  generation:  0.001210927963256836
----------------------check_connections_block total spend ----------------------------- 0.00908350944519043
generate_one_block  0.002916097640991211
generate_one_block  0.002962350845336914
generate_one_block  0.0025522708892822266
generate_one_block  0.002288818359375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.25938940048217773  GigaBytes
Max Memory Allocated: 0.6335468292236328  GigaBytes

connection checking time:  0.012656927108764648
block generation total time  0.017307281494140625
average batch blocks generation time:  0.004326820373535156
block dataloader generation time/epoch 0.06252384185791016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.26097583770751953  GigaBytes
Max Memory Allocated: 0.6335468292236328  GigaBytes

torch.Size([1702, 1433])
torch.Size([842, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.6381721496582031  GigaBytes
Max Memory Allocated: 0.6666965484619141  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.2609562873840332  GigaBytes
Max Memory Allocated: 0.75433349609375  GigaBytes

torch.Size([1698, 1433])
torch.Size([861, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.6496124267578125  GigaBytes
Max Memory Allocated: 0.75433349609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.25977325439453125  GigaBytes
Max Memory Allocated: 0.7655682563781738  GigaBytes

torch.Size([1478, 1433])
torch.Size([705, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.5810375213623047  GigaBytes
Max Memory Allocated: 0.7655682563781738  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.25975465774536133  GigaBytes
Max Memory Allocated: 0.7655682563781738  GigaBytes

torch.Size([1475, 1433])
torch.Size([682, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.5612077713012695  GigaBytes
Max Memory Allocated: 0.7655682563781738  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04574787616729736 |0.0006886720657348633 |0.17333465814590454 |0.00013387203216552734 |0.39599066972732544 |0.00774383544921875 |
----------------------------------------------------------pseudo_mini_loss sum 2.285301685333252
Total (block generation + training)time/epoch 2.590879440307617
Training time/epoch 2.527982711791992
Training time without block to device /epoch 2.5252280235290527
Training time without total dataloading part /epoch 2.285580635070801
load block tensor time/epoch 0.18299150466918945
block to device time/epoch 0.002754688262939453
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10170
Number of first layer input nodes during this epoch:  6353
