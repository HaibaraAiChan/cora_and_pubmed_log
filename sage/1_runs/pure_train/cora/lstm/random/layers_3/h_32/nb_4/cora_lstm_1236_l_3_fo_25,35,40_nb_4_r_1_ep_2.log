main start at this time 1648428987.151023
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014328956604003906
random selection method range initialization spend 0.00021004676818847656
time for parepare:  6.508827209472656e-05
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0028228759765625
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  7.605552673339844e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.67572021484375e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.936622619628906e-05
----------------------check_connections_block total spend ----------------------------- 0.004071712493896484
generate_one_block  0.0015077590942382812
generate_one_block  0.0011093616485595703
generate_one_block  0.001168966293334961
generate_one_block  0.0010786056518554688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00046539306640625
gen group dst list time:  3.719329833984375e-05
time for parepare:  0.00012826919555664062
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.0003230571746826172
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004487037658691406
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0004284381866455078
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0002968311309814453
----------------------check_connections_block total spend ----------------------------- 0.0029904842376708984
generate_one_block  0.0014133453369140625
generate_one_block  0.0015871524810791016
generate_one_block  0.0014982223510742188
generate_one_block  0.0013206005096435547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005643367767333984
gen group dst list time:  7.414817810058594e-05
time for parepare:  0.0001742839813232422
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00025534629821777344
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0009531974792480469
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.0001418590545654297
r_  generation:  0.0012464523315429688
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00020265579223632812
mini_batch_src_global generation:  0.00014138221740722656
r_  generation:  0.001165628433227539
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0008873939514160156
----------------------check_connections_block total spend ----------------------------- 0.007027387619018555
generate_one_block  0.002175569534301758
generate_one_block  0.0023784637451171875
generate_one_block  0.002422332763671875
generate_one_block  0.0019948482513427734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

connection checking time:  0.010017871856689453
block generation total time  0.014790534973144531
average batch blocks generation time:  0.003697633743286133
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07028436660766602  GigaBytes
Max Memory Allocated: 0.07028436660766602  GigaBytes

torch.Size([1365, 1433])
torch.Size([617, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5623779296875 GB
    Memory Allocated: 0.3442072868347168  GigaBytes
Max Memory Allocated: 0.3656892776489258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6873779296875 GB
    Memory Allocated: 0.13417720794677734  GigaBytes
Max Memory Allocated: 0.46182727813720703  GigaBytes

torch.Size([1538, 1433])
torch.Size([769, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.4736337661743164  GigaBytes
Max Memory Allocated: 0.49941444396972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.13437366485595703  GigaBytes
Max Memory Allocated: 0.5889420509338379  GigaBytes

torch.Size([1575, 1433])
torch.Size([766, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.46514320373535156  GigaBytes
Max Memory Allocated: 0.5889420509338379  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.13282155990600586  GigaBytes
Max Memory Allocated: 0.5889420509338379  GigaBytes

torch.Size([1286, 1433])
torch.Size([565, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.38126707077026367  GigaBytes
Max Memory Allocated: 0.5889420509338379  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04734867811203003 |0.08448219299316406 |0.22504740953445435 |0.0001379251480102539 |0.15642201900482178 |0.013637065887451172 |
----------------------------------------------------------pseudo_mini_loss sum 3.0208451747894287
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9209
Number of first layer input nodes during this epoch:  5764
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.2587885856628418  GigaBytes
Max Memory Allocated: 0.5889420509338379  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004987716674804688
random selection method range initialization spend 0.00012302398681640625
time for parepare:  6.580352783203125e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00011467933654785156
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  8.821487426757812e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.221366882324219e-05
----------------------check_connections_block total spend ----------------------------- 0.0014126300811767578
generate_one_block  0.001180887222290039
generate_one_block  0.0012373924255371094
generate_one_block  0.0010845661163330078
generate_one_block  0.001027822494506836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004956722259521484
gen group dst list time:  4.220008850097656e-05
time for parepare:  0.00014734268188476562
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004534721374511719
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.00047016143798828125
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00045013427734375
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.00030803680419921875
----------------------check_connections_block total spend ----------------------------- 0.0032951831817626953
generate_one_block  0.00154876708984375
generate_one_block  0.0015642642974853516
generate_one_block  0.001386404037475586
generate_one_block  0.00139617919921875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005505084991455078
gen group dst list time:  7.724761962890625e-05
time for parepare:  0.0001723766326904297
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.0002715587615966797
mini_batch_src_global generation:  0.00010442733764648438
r_  generation:  0.0011904239654541016
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0012812614440917969
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.00011563301086425781
r_  generation:  0.0010442733764648438
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0009832382202148438
----------------------check_connections_block total spend ----------------------------- 0.007534503936767578
generate_one_block  0.0024950504302978516
generate_one_block  0.0025877952575683594
generate_one_block  0.0024003982543945312
generate_one_block  0.0022249221801757812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.2587885856628418  GigaBytes
Max Memory Allocated: 0.5889420509338379  GigaBytes

connection checking time:  0.010829687118530273
block generation total time  0.015603780746459961
average batch blocks generation time:  0.0039009451866149902
block dataloader generation time/epoch 0.05094265937805176
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.26043701171875  GigaBytes
Max Memory Allocated: 0.5889420509338379  GigaBytes

torch.Size([1602, 1433])
torch.Size([759, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.5965743064880371  GigaBytes
Max Memory Allocated: 0.6220579147338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9373779296875 GB
    Memory Allocated: 0.2604389190673828  GigaBytes
Max Memory Allocated: 0.7123570442199707  GigaBytes

torch.Size([1602, 1433])
torch.Size([784, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.609410285949707  GigaBytes
Max Memory Allocated: 0.7123570442199707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.2594289779663086  GigaBytes
Max Memory Allocated: 0.7246890068054199  GigaBytes

torch.Size([1414, 1433])
torch.Size([646, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.5480031967163086  GigaBytes
Max Memory Allocated: 0.7246890068054199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.25913572311401367  GigaBytes
Max Memory Allocated: 0.7246890068054199  GigaBytes

torch.Size([1360, 1433])
torch.Size([595, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.5195322036743164  GigaBytes
Max Memory Allocated: 0.7246890068054199  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04609256982803345 |0.0004137754440307617 |0.11114192008972168 |0.00011271238327026367 |0.1558733582496643 |0.008540153503417969 |
----------------------------------------------------------pseudo_mini_loss sum 2.3049564361572266
Total (block generation + training)time/epoch 1.368952751159668
Training time/epoch 1.3177194595336914
Training time without block to device /epoch 1.3160643577575684
Training time without total dataloading part /epoch 1.077052116394043
load block tensor time/epoch 0.1843702793121338
block to device time/epoch 0.0016551017761230469
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9489
Number of first layer input nodes during this epoch:  5978
