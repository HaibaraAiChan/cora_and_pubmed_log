main start at this time 1648429012.3105457
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001148223876953125
random selection method range initialization spend 0.00019240379333496094
time for parepare:  6.389617919921875e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.002407550811767578
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.8358230590820312e-05
----------------------check_connections_block total spend ----------------------------- 0.00556635856628418
generate_one_block  0.0012586116790771484
generate_one_block  0.001112222671508789
generate_one_block  0.0010581016540527344
generate_one_block  0.001047372817993164
generate_one_block  0.00103759765625
generate_one_block  0.0010406970977783203
generate_one_block  0.0010409355163574219
generate_one_block  0.0010666847229003906
generate_one_block  0.0010416507720947266
generate_one_block  0.0011229515075683594
generate_one_block  0.001039266586303711
generate_one_block  0.0010347366333007812
generate_one_block  0.0010306835174560547
generate_one_block  0.0010495185852050781
generate_one_block  0.0009465217590332031
generate_one_block  0.0009438991546630859
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005724430084228516
gen group dst list time:  9.512901306152344e-05
time for parepare:  0.0001583099365234375
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00011038780212402344
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00012159347534179688
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00014829635620117188
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.000125885009765625
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00010466575622558594
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0001277923583984375
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00010204315185546875
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0002484321594238281
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00013494491577148438
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00018978118896484375
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001361370086669922
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  8.821487426757812e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00012946128845214844
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00011849403381347656
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.557868957519531e-05
----------------------check_connections_block total spend ----------------------------- 0.0057370662689208984
generate_one_block  0.0011703968048095703
generate_one_block  0.0011754035949707031
generate_one_block  0.0012073516845703125
generate_one_block  0.0011675357818603516
generate_one_block  0.0011546611785888672
generate_one_block  0.0011699199676513672
generate_one_block  0.001131296157836914
generate_one_block  0.0013592243194580078
generate_one_block  0.001077890396118164
generate_one_block  0.001611948013305664
generate_one_block  0.0010943412780761719
generate_one_block  0.0010187625885009766
generate_one_block  0.0010190010070800781
generate_one_block  0.0010695457458496094
generate_one_block  0.0010623931884765625
generate_one_block  0.0010406970977783203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006628036499023438
gen group dst list time:  0.00015211105346679688
time for parepare:  0.00022220611572265625
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0002396106719970703
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004222393035888672
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0004658699035644531
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.00048279762268066406
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004494190216064453
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0003955364227294922
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0004477500915527344
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00036263465881347656
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0007364749908447266
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.00042366981506347656
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0006196498870849609
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0004985332489013672
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.00028014183044433594
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0003056526184082031
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00043845176696777344
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.0003323554992675781
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0002522468566894531
----------------------check_connections_block total spend ----------------------------- 0.012867212295532227
generate_one_block  0.0015780925750732422
generate_one_block  0.0015676021575927734
generate_one_block  0.0015916824340820312
generate_one_block  0.001459360122680664
generate_one_block  0.0013606548309326172
generate_one_block  0.0016338825225830078
generate_one_block  0.0013327598571777344
generate_one_block  0.0017271041870117188
generate_one_block  0.001378774642944336
generate_one_block  0.00159454345703125
generate_one_block  0.001453399658203125
generate_one_block  0.0012328624725341797
generate_one_block  0.0012688636779785156
generate_one_block  0.0014066696166992188
generate_one_block  0.0013186931610107422
generate_one_block  0.0012085437774658203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

connection checking time:  0.018604278564453125
block generation total time  0.04164385795593262
average batch blocks generation time:  0.0026027411222457886
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06655311584472656  GigaBytes
Max Memory Allocated: 0.06655311584472656  GigaBytes

torch.Size([670, 1433])
torch.Size([210, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.1708087921142578  GigaBytes
Max Memory Allocated: 0.17895793914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.12963294982910156  GigaBytes
Max Memory Allocated: 0.29346513748168945  GigaBytes

torch.Size([692, 1433])
torch.Size([220, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.24229097366333008  GigaBytes
Max Memory Allocated: 0.29346513748168945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5623779296875 GB
    Memory Allocated: 0.1295161247253418  GigaBytes
Max Memory Allocated: 0.3640933036804199  GigaBytes

torch.Size([623, 1433])
torch.Size([272, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5623779296875 GB
    Memory Allocated: 0.2472362518310547  GigaBytes
Max Memory Allocated: 0.3640933036804199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.12953662872314453  GigaBytes
Max Memory Allocated: 0.36852598190307617  GigaBytes

torch.Size([674, 1433])
torch.Size([217, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.23950576782226562  GigaBytes
Max Memory Allocated: 0.36852598190307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.12951231002807617  GigaBytes
Max Memory Allocated: 0.36852598190307617  GigaBytes

torch.Size([621, 1433])
torch.Size([201, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.2234354019165039  GigaBytes
Max Memory Allocated: 0.36852598190307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.12966394424438477  GigaBytes
Max Memory Allocated: 0.36852598190307617  GigaBytes

torch.Size([698, 1433])
torch.Size([204, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.23414325714111328  GigaBytes
Max Memory Allocated: 0.36852598190307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.12951231002807617  GigaBytes
Max Memory Allocated: 0.36852598190307617  GigaBytes

torch.Size([591, 1433])
torch.Size([175, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.2171192169189453  GigaBytes
Max Memory Allocated: 0.36852598190307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.1308274269104004  GigaBytes
Max Memory Allocated: 0.36852598190307617  GigaBytes

torch.Size([914, 1433])
torch.Size([384, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.31700849533081055  GigaBytes
Max Memory Allocated: 0.36852598190307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.12951421737670898  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

torch.Size([631, 1433])
torch.Size([213, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.2300705909729004  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1307539939880371  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

torch.Size([901, 1433])
torch.Size([312, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.28496456146240234  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.12988901138305664  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

torch.Size([740, 1433])
torch.Size([267, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2487025260925293  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.1283564567565918  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

torch.Size([454, 1433])
torch.Size([142, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.19230079650878906  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.1285710334777832  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

torch.Size([494, 1433])
torch.Size([154, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.20028209686279297  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.12931251525878906  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

torch.Size([632, 1433])
torch.Size([218, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2389669418334961  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.12856245040893555  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

torch.Size([492, 1433])
torch.Size([182, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2055349349975586  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.12803077697753906  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

torch.Size([393, 1433])
torch.Size([114, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.1859726905822754  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.052220627665519714 |0.02181181311607361 |0.10425224900245667 |0.00011515617370605469 |0.10678310692310333 |0.013765811920166016 |
----------------------------------------------------------pseudo_mini_loss sum 3.13039231300354
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14469
Number of first layer input nodes during this epoch:  10220
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.2539634704589844  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005357265472412109
random selection method range initialization spend 0.00013136863708496094
time for parepare:  7.796287536621094e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.702278137207031e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.7738037109375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.58306884765625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.726119995117188e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.3113021850585938e-05
----------------------check_connections_block total spend ----------------------------- 0.0030198097229003906
generate_one_block  0.0011527538299560547
generate_one_block  0.0010402202606201172
generate_one_block  0.0010223388671875
generate_one_block  0.0013647079467773438
generate_one_block  0.0010542869567871094
generate_one_block  0.001012563705444336
generate_one_block  0.0010066032409667969
generate_one_block  0.0010700225830078125
generate_one_block  0.0009982585906982422
generate_one_block  0.0010042190551757812
generate_one_block  0.001054525375366211
generate_one_block  0.0010347366333007812
generate_one_block  0.0009953975677490234
generate_one_block  0.0009932518005371094
generate_one_block  0.0010657310485839844
generate_one_block  0.0009856224060058594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005943775177001953
gen group dst list time:  9.417533874511719e-05
time for parepare:  0.0001709461212158203
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00012254714965820312
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0001678466796875
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00017762184143066406
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00010228157043457031
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00014901161193847656
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00011348724365234375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0001289844512939453
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0001761913299560547
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  8.940696716308594e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00011110305786132812
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00012373924255371094
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00011754035949707031
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.581710815429688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00010776519775390625
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00013828277587890625
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.9577484130859375e-05
----------------------check_connections_block total spend ----------------------------- 0.00545191764831543
generate_one_block  0.0013377666473388672
generate_one_block  0.0011920928955078125
generate_one_block  0.0012552738189697266
generate_one_block  0.0011451244354248047
generate_one_block  0.001180887222290039
generate_one_block  0.0011305809020996094
generate_one_block  0.0011548995971679688
generate_one_block  0.0012004375457763672
generate_one_block  0.0010943412780761719
generate_one_block  0.0011289119720458984
generate_one_block  0.0011446475982666016
generate_one_block  0.0011377334594726562
generate_one_block  0.0010826587677001953
generate_one_block  0.0011761188507080078
generate_one_block  0.00115966796875
generate_one_block  0.0010209083557128906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006985664367675781
gen group dst list time:  0.00017070770263671875
time for parepare:  0.00021195411682128906
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00029587745666503906
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.00046944618225097656
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.0005142688751220703
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.0006220340728759766
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00036835670471191406
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0004680156707763672
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0003917217254638672
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0005228519439697266
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0006439685821533203
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0002906322479248047
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0003685951232910156
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0004353523254394531
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0004413127899169922
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.0002644062042236328
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0004029273986816406
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004906654357910156
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00011658668518066406
----------------------check_connections_block total spend ----------------------------- 0.013091087341308594
generate_one_block  0.0016434192657470703
generate_one_block  0.0016052722930908203
generate_one_block  0.0017855167388916016
generate_one_block  0.0014963150024414062
generate_one_block  0.0015587806701660156
generate_one_block  0.0015497207641601562
generate_one_block  0.0016200542449951172
generate_one_block  0.0017812252044677734
generate_one_block  0.0013437271118164062
generate_one_block  0.0015730857849121094
generate_one_block  0.0015380382537841797
generate_one_block  0.0014963150024414062
generate_one_block  0.0013012886047363281
generate_one_block  0.0015168190002441406
generate_one_block  0.0016019344329833984
generate_one_block  0.0011208057403564453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.2539634704589844  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

connection checking time:  0.018543004989624023
block generation total time  0.04307436943054199
average batch blocks generation time:  0.0026921480894088745
block dataloader generation time/epoch 0.12588763236999512
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.25540685653686523  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

torch.Size([665, 1433])
torch.Size([252, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.3707304000854492  GigaBytes
Max Memory Allocated: 0.4366168975830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.2557835578918457  GigaBytes
Max Memory Allocated: 0.4923825263977051  GigaBytes

torch.Size([735, 1433])
torch.Size([267, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.3840317726135254  GigaBytes
Max Memory Allocated: 0.4923825263977051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.25751161575317383  GigaBytes
Max Memory Allocated: 0.505401611328125  GigaBytes

torch.Size([932, 1433])
torch.Size([332, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.4186897277832031  GigaBytes
Max Memory Allocated: 0.505401611328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2547121047973633  GigaBytes
Max Memory Allocated: 0.5390825271606445  GigaBytes

torch.Size([535, 1433])
torch.Size([196, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.35045337677001953  GigaBytes
Max Memory Allocated: 0.5390825271606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2558741569519043  GigaBytes
Max Memory Allocated: 0.5390825271606445  GigaBytes

torch.Size([752, 1433])
torch.Size([266, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3781094551086426  GigaBytes
Max Memory Allocated: 0.5390825271606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.25545501708984375  GigaBytes
Max Memory Allocated: 0.5390825271606445  GigaBytes

torch.Size([674, 1433])
torch.Size([190, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3577094078063965  GigaBytes
Max Memory Allocated: 0.5390825271606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2561197280883789  GigaBytes
Max Memory Allocated: 0.5390825271606445  GigaBytes

torch.Size([798, 1433])
torch.Size([267, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3904714584350586  GigaBytes
Max Memory Allocated: 0.5390825271606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2570152282714844  GigaBytes
Max Memory Allocated: 0.5390825271606445  GigaBytes

torch.Size([965, 1433])
torch.Size([349, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.4235191345214844  GigaBytes
Max Memory Allocated: 0.5390825271606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.25439977645874023  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes

torch.Size([477, 1433])
torch.Size([157, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3251614570617676  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.25489377975463867  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes

torch.Size([569, 1433])
torch.Size([212, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.35140275955200195  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2558937072753906  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes

torch.Size([756, 1433])
torch.Size([234, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.371640682220459  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.25563669204711914  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes

torch.Size([708, 1433])
torch.Size([220, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.35964250564575195  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.25419044494628906  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes

torch.Size([438, 1433])
torch.Size([129, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3148026466369629  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2555351257324219  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes

torch.Size([689, 1433])
torch.Size([237, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3642768859863281  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2559652328491211  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes

torch.Size([769, 1433])
torch.Size([293, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.37984132766723633  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.25279855728149414  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes

torch.Size([178, 1433])
torch.Size([45, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.27568864822387695  GigaBytes
Max Memory Allocated: 0.5439701080322266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05230587720870972 |0.00041472911834716797 |0.07230652868747711 |0.00010593235492706299 |0.09880341589450836 |0.006174325942993164 |
----------------------------------------------------------pseudo_mini_loss sum 2.330716133117676
Total (block generation + training)time/epoch 3.781189441680908
Training time/epoch 3.654954671859741
Training time without block to device /epoch 3.6483190059661865
Training time without total dataloading part /epoch 2.7456283569335938
load block tensor time/epoch 0.8368940353393555
block to device time/epoch 0.0066356658935546875
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15060
Number of first layer input nodes during this epoch:  10640
