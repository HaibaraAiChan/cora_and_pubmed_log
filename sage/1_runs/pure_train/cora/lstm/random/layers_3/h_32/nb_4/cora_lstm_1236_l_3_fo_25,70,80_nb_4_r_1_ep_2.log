main start at this time 1648429092.6192534
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012602806091308594
random selection method range initialization spend 0.00019931793212890625
time for parepare:  6.842613220214844e-05
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0020706653594970703
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.389617919921875e-05
----------------------check_connections_block total spend ----------------------------- 0.0033724308013916016
generate_one_block  0.0014753341674804688
generate_one_block  0.0011334419250488281
generate_one_block  0.001115560531616211
generate_one_block  0.0010800361633300781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005102157592773438
gen group dst list time:  4.100799560546875e-05
time for parepare:  0.00014925003051757812
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0004107952117919922
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0005035400390625
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.00047516822814941406
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0003590583801269531
----------------------check_connections_block total spend ----------------------------- 0.003390073776245117
generate_one_block  0.001544952392578125
generate_one_block  0.0016217231750488281
generate_one_block  0.0015878677368164062
generate_one_block  0.0014562606811523438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005774497985839844
gen group dst list time:  8.177757263183594e-05
time for parepare:  0.00018310546875
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.0002722740173339844
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0011878013610839844
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  0.00016260147094726562
r_  generation:  0.0014214515686035156
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  0.0001430511474609375
r_  generation:  0.0014023780822753906
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  0.0001232624053955078
r_  generation:  0.0011031627655029297
----------------------check_connections_block total spend ----------------------------- 0.008273601531982422
generate_one_block  0.0024547576904296875
generate_one_block  0.0026645660400390625
generate_one_block  0.0026464462280273438
generate_one_block  0.002148866653442383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

connection checking time:  0.011663675308227539
block generation total time  0.01612544059753418
average batch blocks generation time:  0.004031360149383545
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07069921493530273  GigaBytes
Max Memory Allocated: 0.07069921493530273  GigaBytes

torch.Size([1442, 1433])
torch.Size([705, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.37142419815063477  GigaBytes
Max Memory Allocated: 0.3954024314880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.13447904586791992  GigaBytes
Max Memory Allocated: 0.4881782531738281  GigaBytes

torch.Size([1594, 1433])
torch.Size([842, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7459716796875 GB
    Memory Allocated: 0.49845361709594727  GigaBytes
Max Memory Allocated: 0.5259742736816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.13460540771484375  GigaBytes
Max Memory Allocated: 0.6129331588745117  GigaBytes

torch.Size([1618, 1433])
torch.Size([829, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.4857668876647949  GigaBytes
Max Memory Allocated: 0.6129331588745117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.13328886032104492  GigaBytes
Max Memory Allocated: 0.6129331588745117  GigaBytes

torch.Size([1373, 1433])
torch.Size([641, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.4101376533508301  GigaBytes
Max Memory Allocated: 0.6129331588745117  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04707592725753784 |0.08574056625366211 |0.23952096700668335 |0.00014346837997436523 |0.18495941162109375 |0.013479948043823242 |
----------------------------------------------------------pseudo_mini_loss sum 3.0196166038513184
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9772
Number of first layer input nodes during this epoch:  6027
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.2592597007751465  GigaBytes
Max Memory Allocated: 0.6129331588745117  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004935264587402344
random selection method range initialization spend 0.00012183189392089844
time for parepare:  6.866455078125e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011348724365234375Using backend: pytorch

mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  9.512901306152344e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  8.58306884765625e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.793571472167969e-05
----------------------check_connections_block total spend ----------------------------- 0.001550436019897461
generate_one_block  0.0012857913970947266
generate_one_block  0.0011246204376220703
generate_one_block  0.0010979175567626953
generate_one_block  0.0010831356048583984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004966259002685547
gen group dst list time:  4.2438507080078125e-05
time for parepare:  0.0001518726348876953
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00048089027404785156
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0004892349243164062
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0003960132598876953
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.000362396240234375
----------------------check_connections_block total spend ----------------------------- 0.003442525863647461
generate_one_block  0.0016467571258544922
generate_one_block  0.0016696453094482422
generate_one_block  0.0014789104461669922
generate_one_block  0.0014615058898925781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005664825439453125
gen group dst list time:  9.393692016601562e-05
time for parepare:  0.0001995563507080078
local_output_nid generation:  7.414817810058594e-05
local_in_edges_tensor generation:  0.0002942085266113281
mini_batch_src_global generation:  0.00011444091796875
r_  generation:  0.0014679431915283203
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  0.00022101402282714844
r_  generation:  0.0014410018920898438
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  0.0001232624053955078
r_  generation:  0.0011761188507080078
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00014209747314453125
r_  generation:  0.0011298656463623047
----------------------check_connections_block total spend ----------------------------- 0.008577585220336914
generate_one_block  0.0038652420043945312
generate_one_block  0.00307464599609375
generate_one_block  0.002424001693725586
generate_one_block  0.002240896224975586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.2592597007751465  GigaBytes
Max Memory Allocated: 0.6129331588745117  GigaBytes

connection checking time:  0.012020111083984375
block generation total time  0.017861604690551758
average batch blocks generation time:  0.0044654011726379395
block dataloader generation time/epoch 0.05730295181274414
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.26080322265625  GigaBytes
Max Memory Allocated: 0.6129331588745117  GigaBytes

torch.Size([1670, 1433])
torch.Size([839, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.6205615997314453  GigaBytes
Max Memory Allocated: 0.6479063034057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9647216796875 GB
    Memory Allocated: 0.2608914375305176  GigaBytes
Max Memory Allocated: 0.7355146408081055  GigaBytes

torch.Size([1686, 1433])
torch.Size([864, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.635643482208252  GigaBytes
Max Memory Allocated: 0.7355146408081055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.2596430778503418  GigaBytes
Max Memory Allocated: 0.7501101493835449  GigaBytes

torch.Size([1454, 1433])
torch.Size([697, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.5650348663330078  GigaBytes
Max Memory Allocated: 0.7501101493835449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.2596626281738281  GigaBytes
Max Memory Allocated: 0.7501101493835449  GigaBytes

torch.Size([1458, 1433])
torch.Size([681, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.5492916107177734  GigaBytes
Max Memory Allocated: 0.7501101493835449  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04733443260192871 |0.00046706199645996094 |0.12965863943099976 |0.00011676549911499023 |0.19440573453903198 |0.004626274108886719 |
----------------------------------------------------------pseudo_mini_loss sum 2.35917329788208
Total (block generation + training)time/epoch 1.6024169921875
Training time/epoch 1.5447638034820557
Training time without block to device /epoch 1.5428955554962158
Training time without total dataloading part /epoch 1.3013508319854736
load block tensor time/epoch 0.18933773040771484
block to device time/epoch 0.0018682479858398438
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10076
Number of first layer input nodes during this epoch:  6268
