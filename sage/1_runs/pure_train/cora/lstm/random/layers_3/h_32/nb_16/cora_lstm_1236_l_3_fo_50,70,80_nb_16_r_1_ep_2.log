main start at this time 1648429179.183812
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008499622344970703
random selection method range initialization spend 0.0001990795135498047
time for parepare:  8.0108642578125e-05
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0014905929565429688
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.316734313964844e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.9311904907226562e-05
----------------------check_connections_block total spend ----------------------------- 0.005167245864868164
generate_one_block  0.0014269351959228516
generate_one_block  0.0013132095336914062
generate_one_block  0.001245737075805664
generate_one_block  0.0012450218200683594
generate_one_block  0.001233816146850586
generate_one_block  0.0012357234954833984
generate_one_block  0.0011556148529052734
generate_one_block  0.0010712146759033203
generate_one_block  0.0010504722595214844
generate_one_block  0.0011227130889892578
generate_one_block  0.001054525375366211
generate_one_block  0.0009572505950927734
generate_one_block  0.0010907649993896484
generate_one_block  0.0010280609130859375
generate_one_block  0.0009715557098388672
generate_one_block  0.0009510517120361328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006103515625
gen group dst list time:  0.00013136863708496094
time for parepare:  0.00018072128295898438
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00015926361083984375
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00015306472778320312
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0002048015594482422
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00016117095947265625
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00013375282287597656
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001480579376220703
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0001347064971923828
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00030422210693359375
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00017452239990234375
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00022482872009277344
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00016427040100097656
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00011420249938964844
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00011777877807617188
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00017404556274414062
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00014638900756835938
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  9.894371032714844e-05
----------------------check_connections_block total spend ----------------------------- 0.006953001022338867
generate_one_block  0.001434326171875
generate_one_block  0.0014052391052246094
generate_one_block  0.0014719963073730469
generate_one_block  0.001413583755493164
generate_one_block  0.0013263225555419922
generate_one_block  0.001188039779663086
generate_one_block  0.0010709762573242188
generate_one_block  0.0012652873992919922
generate_one_block  0.0010921955108642578
generate_one_block  0.0011570453643798828
generate_one_block  0.001100301742553711
generate_one_block  0.0010433197021484375
generate_one_block  0.0010476112365722656
generate_one_block  0.0011086463928222656
generate_one_block  0.0010793209075927734
generate_one_block  0.0010724067687988281
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006470680236816406
gen group dst list time:  0.000217437744140625
time for parepare:  0.0002651214599609375
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.000274658203125
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0006895065307617188
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  8.559226989746094e-05
r_  generation:  0.0006759166717529297
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0007364749908447266
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0006549358367919922
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0005757808685302734
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0005807876586914062
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0005991458892822266
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0009682178497314453
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0005881786346435547
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  9.131431579589844e-05
r_  generation:  0.0007841587066650391
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0006890296936035156
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0004220008850097656
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0003724098205566406
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0005514621734619141
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.00039649009704589844
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.00032520294189453125
----------------------check_connections_block total spend ----------------------------- 0.01718306541442871
generate_one_block  0.001743316650390625
generate_one_block  0.001659393310546875
generate_one_block  0.0016169548034667969
generate_one_block  0.0015726089477539062
generate_one_block  0.0014450550079345703
generate_one_block  0.0017066001892089844
generate_one_block  0.0014622211456298828
generate_one_block  0.0018048286437988281
generate_one_block  0.0014467239379882812
generate_one_block  0.001628875732421875
generate_one_block  0.0015332698822021484
generate_one_block  0.00133514404296875
generate_one_block  0.0013616085052490234
generate_one_block  0.0015256404876708984
generate_one_block  0.0013880729675292969
generate_one_block  0.0012972354888916016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

connection checking time:  0.024136066436767578
block generation total time  0.043804168701171875
average batch blocks generation time:  0.002737760543823242
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06726694107055664  GigaBytes
Max Memory Allocated: 0.06726694107055664  GigaBytes

torch.Size([803, 1433])
torch.Size([294, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4217529296875 GB
    Memory Allocated: 0.21233320236206055  GigaBytes
Max Memory Allocated: 0.2235560417175293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.1303553581237793  GigaBytes
Max Memory Allocated: 0.33483314514160156  GigaBytes

torch.Size([827, 1433])
torch.Size([259, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.2713627815246582  GigaBytes
Max Memory Allocated: 0.33483314514160156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.13022994995117188  GigaBytes
Max Memory Allocated: 0.3935356140136719  GigaBytes

torch.Size([719, 1433])
torch.Size([332, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.27971887588500977  GigaBytes
Max Memory Allocated: 0.3935356140136719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.12998723983764648  GigaBytes
Max Memory Allocated: 0.4012184143066406  GigaBytes

torch.Size([758, 1433])
torch.Size([243, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.26528310775756836  GigaBytes
Max Memory Allocated: 0.4012184143066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.13022518157958984  GigaBytes
Max Memory Allocated: 0.4012184143066406  GigaBytes

torch.Size([729, 1433])
torch.Size([237, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2432389259338379  GigaBytes
Max Memory Allocated: 0.4012184143066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.1301131248474121  GigaBytes
Max Memory Allocated: 0.4012184143066406  GigaBytes

torch.Size([782, 1433])
torch.Size([210, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.24707841873168945  GigaBytes
Max Memory Allocated: 0.4012184143066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.13022613525390625  GigaBytes
Max Memory Allocated: 0.4012184143066406  GigaBytes

torch.Size([713, 1433])
torch.Size([233, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2512025833129883  GigaBytes
Max Memory Allocated: 0.4012184143066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.13128232955932617  GigaBytes
Max Memory Allocated: 0.4012184143066406  GigaBytes

torch.Size([999, 1433])
torch.Size([396, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.3365459442138672  GigaBytes
Max Memory Allocated: 0.4012184143066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6776123046875 GB
    Memory Allocated: 0.13022518157958984  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

torch.Size([696, 1433])
torch.Size([244, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6776123046875 GB
    Memory Allocated: 0.24607229232788086  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6776123046875 GB
    Memory Allocated: 0.13118219375610352  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

torch.Size([981, 1433])
torch.Size([312, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.2946343421936035  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.13022804260253906  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

torch.Size([800, 1433])
torch.Size([310, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.26821231842041016  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.12891912460327148  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

torch.Size([559, 1433])
torch.Size([177, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.21280670166015625  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.12910127639770508  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

torch.Size([593, 1433])
torch.Size([185, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.2186141014099121  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.12969970703125  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

torch.Size([704, 1433])
torch.Size([273, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.26854419708251953  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.12910223007202148  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

torch.Size([574, 1433])
torch.Size([211, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.22102737426757812  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.12860918045043945  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

torch.Size([501, 1433])
torch.Size([151, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.20605707168579102  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05150514841079712 |0.021913066506385803 |0.1321759819984436 |0.00011780858039855957 |0.22113002836704254 |0.01343989372253418 |
----------------------------------------------------------pseudo_mini_loss sum 3.1282618045806885
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16569
Number of first layer input nodes during this epoch:  11738
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7791748046875 GB
    Memory Allocated: 0.254544734954834  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007090568542480469
random selection method range initialization spend 0.00015687942504882812
time for parepare:  9.059906005859375e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  5.125999450683594e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.430511474609375e-05
----------------------check_connections_block total spend ----------------------------- 0.0034596920013427734
generate_one_block  0.0012249946594238281
generate_one_block  0.0011138916015625
generate_one_block  0.0011012554168701172
generate_one_block  0.0014109611511230469
generate_one_block  0.0010907649993896484
generate_one_block  0.0010821819305419922
generate_one_block  0.001058340072631836
generate_one_block  0.001070261001586914
generate_one_block  0.001062154769897461
generate_one_block  0.0010619163513183594
generate_one_block  0.001064300537109375
generate_one_block  0.0010695457458496094
generate_one_block  0.001054525375366211
generate_one_block  0.0010578632354736328
generate_one_block  0.0009684562683105469
generate_one_block  0.0009636878967285156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006067752838134766
gen group dst list time:  0.00010776519775390625
time for parepare:  0.00020599365234375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00016689300537109375
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00019431114196777344
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00022268295288085938
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00012874603271484375
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00017642974853515625
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00013113021850585938
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00016641616821289062
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00021910667419433594
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001049041748046875
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001475811004638672
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0001494884490966797
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001418590545654297
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00014162063598632812
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00017571449279785156
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.38690185546875e-05
----------------------check_connections_block total spend ----------------------------- 0.006328105926513672
generate_one_block  0.0013790130615234375
generate_one_block  0.0012760162353515625
generate_one_block  0.0013279914855957031
generate_one_block  0.0012125968933105469
generate_one_block  0.001276254653930664
generate_one_block  0.0011897087097167969
generate_one_block  0.0012619495391845703
generate_one_block  0.0012111663818359375
generate_one_block  0.0010592937469482422
generate_one_block  0.001188516616821289
generate_one_block  0.0011379718780517578
generate_one_block  0.001180410385131836
generate_one_block  0.001138448715209961
generate_one_block  0.0011775493621826172
generate_one_block  0.0011663436889648438
generate_one_block  0.0009899139404296875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007450580596923828
gen group dst list time:  0.00020837783813476562
time for parepare:  0.00023484230041503906
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00026988983154296875
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0006473064422607422
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0006277561187744141
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  0.00010752677917480469
r_  generation:  0.0008146762847900391
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0005147457122802734
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0005841255187988281
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.00047326087951660156
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0006837844848632812
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  0.00010943412780761719
r_  generation:  0.0008215904235839844
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.00037789344787597656
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0005481243133544922
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0005643367767333984
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0005290508270263672
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0003275871276855469
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0006010532379150391
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0006542205810546875
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0001354217529296875
----------------------check_connections_block total spend ----------------------------- 0.01663827896118164
generate_one_block  0.0018854141235351562
generate_one_block  0.0018062591552734375
generate_one_block  0.001991748809814453
generate_one_block  0.0014984607696533203
generate_one_block  0.001611948013305664
generate_one_block  0.0014896392822265625
generate_one_block  0.0017604827880859375
generate_one_block  0.0019004344940185547
generate_one_block  0.0013394355773925781
generate_one_block  0.0017077922821044922
generate_one_block  0.001615285873413086
generate_one_block  0.0015883445739746094
generate_one_block  0.0013203620910644531
generate_one_block  0.001659393310546875
generate_one_block  0.0017313957214355469
generate_one_block  0.0010919570922851562
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7791748046875 GB
    Memory Allocated: 0.254544734954834  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

connection checking time:  0.022966384887695312
block generation total time  0.045171499252319336
average batch blocks generation time:  0.0028232187032699585
block dataloader generation time/epoch 0.1532597541809082
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7791748046875 GB
    Memory Allocated: 0.25612735748291016  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

torch.Size([799, 1433])
torch.Size([329, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7791748046875 GB
    Memory Allocated: 0.41147375106811523  GigaBytes
Max Memory Allocated: 0.4569268226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7791748046875 GB
    Memory Allocated: 0.2563033103942871  GigaBytes
Max Memory Allocated: 0.533045768737793  GigaBytes

torch.Size([832, 1433])
torch.Size([296, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7791748046875 GB
    Memory Allocated: 0.40292835235595703  GigaBytes
Max Memory Allocated: 0.533045768737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7791748046875 GB
    Memory Allocated: 0.2576327323913574  GigaBytes
Max Memory Allocated: 0.533045768737793  GigaBytes

torch.Size([1080, 1433])
torch.Size([386, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7791748046875 GB
    Memory Allocated: 0.45827722549438477  GigaBytes
Max Memory Allocated: 0.533045768737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.2551412582397461  GigaBytes
Max Memory Allocated: 0.5791525840759277  GigaBytes

torch.Size([615, 1433])
torch.Size([220, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.3701300621032715  GigaBytes
Max Memory Allocated: 0.5791525840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.2562704086303711  GigaBytes
Max Memory Allocated: 0.5791525840759277  GigaBytes

torch.Size([826, 1433])
torch.Size([292, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.3956642150878906  GigaBytes
Max Memory Allocated: 0.5791525840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.25569629669189453  GigaBytes
Max Memory Allocated: 0.5791525840759277  GigaBytes

torch.Size([719, 1433])
torch.Size([190, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.3657717704772949  GigaBytes
Max Memory Allocated: 0.5791525840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.2570047378540039  GigaBytes
Max Memory Allocated: 0.5791525840759277  GigaBytes

torch.Size([963, 1433])
torch.Size([322, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.42757129669189453  GigaBytes
Max Memory Allocated: 0.5791525840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.2575688362121582  GigaBytes
Max Memory Allocated: 0.5791525840759277  GigaBytes

torch.Size([1068, 1433])
torch.Size([410, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.4609222412109375  GigaBytes
Max Memory Allocated: 0.5791525840759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.25464630126953125  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes

torch.Size([523, 1433])
torch.Size([162, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.3316049575805664  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.2556295394897461  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes

torch.Size([706, 1433])
torch.Size([270, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.38736486434936523  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.2565898895263672  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes

torch.Size([886, 1433])
torch.Size([263, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.3941669464111328  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.2563486099243164  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes

torch.Size([841, 1433])
torch.Size([250, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.38356876373291016  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.2546505928039551  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes

torch.Size([524, 1433])
torch.Size([138, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.32692432403564453  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.25643062591552734  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes

torch.Size([856, 1433])
torch.Size([298, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.40129661560058594  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.25666189193725586  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes

torch.Size([899, 1433])
torch.Size([366, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.41481494903564453  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.2529482841491699  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes

torch.Size([206, 1433])
torch.Size([45, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.27829790115356445  GigaBytes
Max Memory Allocated: 0.5819411277770996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.051856279373168945 |0.000470578670501709 |0.1063544899225235 |0.00011667609214782715 |0.22843389213085175 |0.011175394058227539 |
----------------------------------------------------------pseudo_mini_loss sum 2.3438258171081543
Total (block generation + training)time/epoch 6.42707633972168
Training time/epoch 6.2735254764556885
Training time without block to device /epoch 6.265996217727661
Training time without total dataloading part /epoch 5.369656324386597
load block tensor time/epoch 0.8297004699707031
block to device time/epoch 0.007529258728027344
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17354
Number of first layer input nodes during this epoch:  12343
