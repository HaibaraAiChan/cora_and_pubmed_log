main start at this time 1648428976.3651733
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011353492736816406
random selection method range initialization spend 0.00022411346435546875
time for parepare:  8.177757263183594e-05
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0036933422088623047
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00014257431030273438
----------------------check_connections_block total spend ----------------------------- 0.00467991828918457
generate_one_block  0.0018846988677978516
generate_one_block  0.0015180110931396484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005855560302734375
gen group dst list time:  3.695487976074219e-05
time for parepare:  0.00017070770263671875
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00024080276489257812
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0008304119110107422
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.0008268356323242188
----------------------check_connections_block total spend ----------------------------- 0.003027677536010742
generate_one_block  0.002305746078491211
generate_one_block  0.002367258071899414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006709098815917969
gen group dst list time:  7.081031799316406e-05
time for parepare:  0.00022339820861816406
local_output_nid generation:  9.5367431640625e-05
local_in_edges_tensor generation:  0.000347137451171875
mini_batch_src_global generation:  0.00017571449279785156
r_  generation:  0.0017046928405761719
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0018033981323242188
----------------------check_connections_block total spend ----------------------------- 0.005792379379272461
generate_one_block  0.003531932830810547
generate_one_block  0.003091096878051758
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

connection checking time:  0.008820056915283203
block generation total time  0.01129603385925293
average batch blocks generation time:  0.005648016929626465
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07276439666748047  GigaBytes
Max Memory Allocated: 0.07276439666748047  GigaBytes

torch.Size([1825, 1433])
torch.Size([1051, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7459716796875 GB
    Memory Allocated: 0.5167422294616699  GigaBytes
Max Memory Allocated: 0.5499920845031738  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.1361541748046875  GigaBytes
Max Memory Allocated: 0.6291179656982422  GigaBytes

torch.Size([1905, 1433])
torch.Size([1113, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.5975885391235352  GigaBytes
Max Memory Allocated: 0.6335124969482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03668773174285889 |0.17268848419189453 |0.36498963832855225 |0.0002129077911376953 |0.18020951747894287 |0.012763023376464844 |
----------------------------------------------------------pseudo_mini_loss sum 2.9685330390930176
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6591
Number of first layer input nodes during this epoch:  3730
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.2621612548828125  GigaBytes
Max Memory Allocated: 0.7094464302062988  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005424022674560547
random selection method range initialization spend 0.00014448165893554688
time for parepare:  7.367134094238281e-05
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00015735626220703125
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001163482666015625
----------------------check_connections_block total spend ----------------------------- 0.0009760856628417969
generate_one_block  0.0014185905456542969
generate_one_block  0.0012407302856445312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000522613525390625
gen group dst list time:  3.4809112548828125e-05
time for parepare:  0.00015687942504882812
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00024127960205078125
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0007996559143066406
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  9.417533874511719e-05
r_  generation:  0.0006225109100341797
----------------------check_connections_block total spend ----------------------------- 0.0026674270629882812
generate_one_block  0.0022516250610351562
generate_one_block  0.001848459243774414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005908012390136719
gen group dst list time:  6.008148193359375e-05
time for parepare:  0.00018548965454101562
local_output_nid generation:  9.989738464355469e-05
local_in_edges_tensor generation:  0.0003418922424316406
mini_batch_src_global generation:  0.0001552104949951172
r_  generation:  0.0019032955169677734
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  0.00018525123596191406
r_  generation:  0.001699686050415039
----------------------check_connections_block total spend ----------------------------- 0.005768775939941406
generate_one_block  0.003388643264770508
generate_one_block  0.0030536651611328125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.2621612548828125  GigaBytes
Max Memory Allocated: 0.7094464302062988  GigaBytes

connection checking time:  0.008436203002929688
block generation total time  0.01054239273071289
average batch blocks generation time:  0.005271196365356445
block dataloader generation time/epoch 0.036351919174194336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.26225948333740234  GigaBytes
Max Memory Allocated: 0.7094464302062988  GigaBytes
Using backend: pytorch

torch.Size([1939, 1433])
torch.Size([1165, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.7520675659179688  GigaBytes
Max Memory Allocated: 0.7885894775390625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.2615499496459961  GigaBytes
Max Memory Allocated: 0.8627009391784668  GigaBytes

torch.Size([1808, 1433])
torch.Size([1017, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.6918330192565918  GigaBytes
Max Memory Allocated: 0.8627009391784668  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033913612365722656 |0.0004545450210571289 |0.12987148761749268 |0.00013065338134765625 |0.18577194213867188 |0.008598804473876953 |
----------------------------------------------------------pseudo_mini_loss sum 2.2685389518737793
Total (block generation + training)time/epoch 0.8038978576660156
Training time/epoch 0.7671878337860107
Training time without block to device /epoch 0.7662787437438965
Training time without total dataloading part /epoch 0.6401469707489014
load block tensor time/epoch 0.06782722473144531
block to device time/epoch 0.0009090900421142578
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6620
Number of first layer input nodes during this epoch:  3747
