main start at this time 1648429237.3604543
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00135040283203125
random selection method range initialization spend 0.0001595020294189453
time for parepare:  5.936622619628906e-05
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.0012400150299072266
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.821487426757812e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.8596649169921875e-05
----------------------check_connections_block total spend ----------------------------- 0.004186868667602539
generate_one_block  0.0012919902801513672
generate_one_block  0.0010449886322021484
generate_one_block  0.0010004043579101562
generate_one_block  0.0009722709655761719
generate_one_block  0.0009744167327880859
generate_one_block  0.000982522964477539
generate_one_block  0.0009694099426269531
generate_one_block  0.0009775161743164062
generate_one_block  0.000995635986328125
generate_one_block  0.0010132789611816406
generate_one_block  0.0010106563568115234
generate_one_block  0.0009703636169433594
generate_one_block  0.0009758472442626953
generate_one_block  0.0010328292846679688
generate_one_block  0.0010008811950683594
generate_one_block  0.000972747802734375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005936622619628906
gen group dst list time:  9.441375732421875e-05
time for parepare:  0.000141143798828125
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.106231689453125e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0001327991485595703
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001399517059326172
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00010991096496582031
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0001277923583984375
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00010442733764648438
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.00010538101196289062
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  0.00011181831359863281
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.000202178955078125
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.4849853515625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.0001285076141357422
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00014543533325195312
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.000110626220703125
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.0001652240753173828
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.153915405273438e-05
----------------------check_connections_block total spend ----------------------------- 0.005318403244018555
generate_one_block  0.0010528564453125
generate_one_block  0.0011148452758789062
generate_one_block  0.0011820793151855469
generate_one_block  0.001100301742553711
generate_one_block  0.0011203289031982422
generate_one_block  0.0011157989501953125
generate_one_block  0.001104593276977539
generate_one_block  0.001123189926147461
generate_one_block  0.0012056827545166016
generate_one_block  0.0010106563568115234
generate_one_block  0.0010521411895751953
generate_one_block  0.0011162757873535156
generate_one_block  0.0011417865753173828
generate_one_block  0.0010838508605957031
generate_one_block  0.0011518001556396484
generate_one_block  0.001094818115234375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006649494171142578
gen group dst list time:  0.0001437664031982422
time for parepare:  0.0001976490020751953
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00021696090698242188
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0004734992980957031
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.0005059242248535156
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0003826618194580078
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004951953887939453
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0003249645233154297
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0003726482391357422
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00042176246643066406
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0006127357482910156
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00016045570373535156
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0003018379211425781
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.000461578369140625
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004820823669433594
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00037980079650878906
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0005447864532470703
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0002753734588623047
----------------------check_connections_block total spend ----------------------------- 0.01196432113647461
generate_one_block  0.0016949176788330078
generate_one_block  0.0015406608581542969
generate_one_block  0.0015399456024169922
generate_one_block  0.0014035701751708984
generate_one_block  0.0015463829040527344
generate_one_block  0.0015909671783447266
generate_one_block  0.0014100074768066406
generate_one_block  0.0014591217041015625
generate_one_block  0.0016620159149169922
generate_one_block  0.0011341571807861328
generate_one_block  0.0013141632080078125
generate_one_block  0.0015170574188232422
generate_one_block  0.0015201568603515625
generate_one_block  0.0014045238494873047
generate_one_block  0.0016453266143798828
generate_one_block  0.0012586116790771484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

connection checking time:  0.017282724380493164
block generation total time  0.0414125919342041
average batch blocks generation time:  0.0025882869958877563
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06524085998535156  GigaBytes
Max Memory Allocated: 0.06524085998535156  GigaBytes

torch.Size([322, 1433])
torch.Size([120, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.12004423141479492  GigaBytes
Max Memory Allocated: 0.12383031845092773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.13163280487060547  GigaBytes
Max Memory Allocated: 0.2442488670349121  GigaBytes

torch.Size([860, 1433])
torch.Size([277, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.26315975189208984  GigaBytes
Max Memory Allocated: 0.27235937118530273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1311650276184082  GigaBytes
Max Memory Allocated: 0.3837003707885742  GigaBytes

torch.Size([772, 1433])
torch.Size([290, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.2662057876586914  GigaBytes
Max Memory Allocated: 0.3837003707885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1300830841064453  GigaBytes
Max Memory Allocated: 0.3865489959716797  GigaBytes

torch.Size([570, 1433])
torch.Size([228, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6131591796875 GB
    Memory Allocated: 0.23117351531982422  GigaBytes
Max Memory Allocated: 0.3865489959716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6131591796875 GB
    Memory Allocated: 0.1312389373779297  GigaBytes
Max Memory Allocated: 0.3865489959716797  GigaBytes

torch.Size([786, 1433])
torch.Size([285, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.26938533782958984  GigaBytes
Max Memory Allocated: 0.3865489959716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.1300811767578125  GigaBytes
Max Memory Allocated: 0.39016199111938477  GigaBytes

torch.Size([546, 1433])
torch.Size([180, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.2166118621826172  GigaBytes
Max Memory Allocated: 0.39016199111938477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.13041400909423828  GigaBytes
Max Memory Allocated: 0.39016199111938477  GigaBytes

torch.Size([632, 1433])
torch.Size([199, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.2337813377380371  GigaBytes
Max Memory Allocated: 0.39016199111938477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.13082075119018555  GigaBytes
Max Memory Allocated: 0.39016199111938477  GigaBytes

torch.Size([708, 1433])
torch.Size([219, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.24539756774902344  GigaBytes
Max Memory Allocated: 0.39016199111938477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.1318202018737793  GigaBytes
Max Memory Allocated: 0.39016199111938477  GigaBytes

torch.Size([894, 1433])
torch.Size([358, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.3028101921081543  GigaBytes
Max Memory Allocated: 0.39016199111938477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.12871503829956055  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

torch.Size([315, 1433])
torch.Size([72, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.1668691635131836  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.12972784042358398  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

torch.Size([504, 1433])
torch.Size([187, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.20943975448608398  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.13110971450805664  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

torch.Size([762, 1433])
torch.Size([258, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.25927734375  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.13135719299316406  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

torch.Size([808, 1433])
torch.Size([274, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.26458215713500977  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.13059568405151367  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

torch.Size([666, 1433])
torch.Size([205, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.23129796981811523  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.1316680908203125  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

torch.Size([866, 1433])
torch.Size([307, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.28667593002319336  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.12909698486328125  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

torch.Size([386, 1433])
torch.Size([144, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.2003159523010254  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05216991901397705 |0.022373154759407043 |0.1033111959695816 |0.00011055171489715576 |0.10026273131370544 |0.011792659759521484 |
----------------------------------------------------------pseudo_mini_loss sum 2.9960246086120605
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14773
Number of first layer input nodes during this epoch:  10397
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.256134033203125  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005083084106445312
random selection method range initialization spend 0.0001251697540283203
time for parepare:  8.106231689453125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.71661376953125e-05
----------------------check_connections_block total spend ----------------------------- 0.0031976699829101562
generate_one_block  0.0010783672332763672
generate_one_block  0.0010318756103515625
generate_one_block  0.0010237693786621094
generate_one_block  0.001363515853881836
generate_one_block  0.001012563705444336
generate_one_block  0.001013040542602539
generate_one_block  0.0010404586791992188
generate_one_block  0.0010099411010742188
generate_one_block  0.0010116100311279297
generate_one_block  0.001024007797241211
generate_one_block  0.0010075569152832031
generate_one_block  0.0010101795196533203
generate_one_block  0.001001596450805664
generate_one_block  0.0010256767272949219
generate_one_block  0.0010159015655517578
generate_one_block  0.0009927749633789062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005671977996826172
gen group dst list time:  9.965896606445312e-05
time for parepare:  0.00017523765563964844
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0002536773681640625
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00018930435180664062
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00017905235290527344
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00011777877807617188
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00013947486877441406
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.965896606445312e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00010943412780761719
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00018835067749023438
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00014209747314453125
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  9.417533874511719e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00012755393981933594
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00012302398681640625
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001163482666015625
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.000118255615234375
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00012731552124023438
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001246929168701172
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.176399230957031e-05
----------------------check_connections_block total spend ----------------------------- 0.005756855010986328
generate_one_block  0.0013396739959716797
generate_one_block  0.001214742660522461
generate_one_block  0.0011472702026367188
generate_one_block  0.0011680126190185547
generate_one_block  0.0011324882507324219
generate_one_block  0.0011298656463623047
generate_one_block  0.0012257099151611328
generate_one_block  0.0011408329010009766
generate_one_block  0.0010671615600585938
generate_one_block  0.00110626220703125
generate_one_block  0.0010867118835449219
generate_one_block  0.001108407974243164
generate_one_block  0.0010998249053955078
generate_one_block  0.0011508464813232422
generate_one_block  0.0011110305786132812
generate_one_block  0.0010313987731933594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007028579711914062
gen group dst list time:  0.00017642974853515625
time for parepare:  0.00022339820861816406
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00031304359436035156
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.0006220340728759766
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0005395412445068359
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.00043320655822753906
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0003941059112548828
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00033283233642578125
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0004146099090576172
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.00060272216796875
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0005490779876708984
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0002942085266113281
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004172325134277344
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.00038361549377441406
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00039196014404296875
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00043010711669921875
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004303455352783203
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0004432201385498047
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00024175643920898438
----------------------check_connections_block total spend ----------------------------- 0.013267993927001953
generate_one_block  0.001850128173828125
generate_one_block  0.0016531944274902344
generate_one_block  0.0015380382537841797
generate_one_block  0.0014772415161132812
generate_one_block  0.0013692378997802734
generate_one_block  0.0014629364013671875
generate_one_block  0.0016505718231201172
generate_one_block  0.001619577407836914
generate_one_block  0.0012736320495605469
generate_one_block  0.0015647411346435547
generate_one_block  0.00139617919921875
generate_one_block  0.0014123916625976562
generate_one_block  0.0014803409576416016
generate_one_block  0.0014424324035644531
generate_one_block  0.001489877700805664
generate_one_block  0.0012352466583251953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.256134033203125  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

connection checking time:  0.01902484893798828
block generation total time  0.042176008224487305
average batch blocks generation time:  0.0026360005140304565
block dataloader generation time/epoch 0.12269353866577148
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.2587432861328125  GigaBytes
Max Memory Allocated: 0.42179441452026367  GigaBytes

torch.Size([876, 1433])
torch.Size([349, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.4195895195007324  GigaBytes
Max Memory Allocated: 0.4309511184692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.258176326751709  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

torch.Size([770, 1433])
torch.Size([287, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.39164304733276367  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2574729919433594  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

torch.Size([639, 1433])
torch.Size([232, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.3635835647583008  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2568635940551758  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

torch.Size([525, 1433])
torch.Size([214, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.3534078598022461  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.25747013092041016  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

torch.Size([511, 1433])
torch.Size([191, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.3375988006591797  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.25786828994750977  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

torch.Size([713, 1433])
torch.Size([212, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.3604869842529297  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2584834098815918  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

torch.Size([827, 1433])
torch.Size([305, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.41400861740112305  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.25835227966308594  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

torch.Size([803, 1433])
torch.Size([303, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.39829301834106445  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2562246322631836  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

torch.Size([406, 1433])
torch.Size([145, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.32120323181152344  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2572007179260254  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

torch.Size([588, 1433])
torch.Size([199, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.36385440826416016  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.25681018829345703  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

torch.Size([515, 1433])
torch.Size([183, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.35073089599609375  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2574186325073242  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes
Using backend: pytorch

torch.Size([629, 1433])
torch.Size([229, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.3543128967285156  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2577829360961914  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

torch.Size([697, 1433])
torch.Size([225, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.3645491600036621  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2574462890625  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

torch.Size([634, 1433])
torch.Size([223, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.3634066581726074  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2577838897705078  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

torch.Size([638, 1433])
torch.Size([218, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.3696579933166504  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.25613927841186523  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

torch.Size([390, 1433])
torch.Size([116, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.3124427795410156  GigaBytes
Max Memory Allocated: 0.5391745567321777  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05195760726928711 |0.00041188299655914307 |0.07115556299686432 |0.00010496377944946289 |0.09252196550369263 |0.011018514633178711 |
----------------------------------------------------------pseudo_mini_loss sum 2.354663133621216
Total (block generation + training)time/epoch 3.6583023071289062
Training time/epoch 3.5353214740753174
Training time without block to device /epoch 3.528731346130371
Training time without total dataloading part /epoch 2.6315383911132812
load block tensor time/epoch 0.8313217163085938
block to device time/epoch 0.006590127944946289
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14565
Number of first layer input nodes during this epoch:  10161
