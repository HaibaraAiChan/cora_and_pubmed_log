main start at this time 1648429403.4203334
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010082721710205078
random selection method range initialization spend 0.00019502639770507812
time for parepare:  8.034706115722656e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0016689300537109375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.2649765014648438e-05
----------------------check_connections_block total spend ----------------------------- 0.0053403377532958984
generate_one_block  0.001439809799194336
generate_one_block  0.0013265609741210938
generate_one_block  0.0013289451599121094
generate_one_block  0.0012478828430175781
generate_one_block  0.0012390613555908203
generate_one_block  0.001232147216796875
generate_one_block  0.0010764598846435547
generate_one_block  0.0010097026824951172
generate_one_block  0.0009791851043701172
generate_one_block  0.0009915828704833984
generate_one_block  0.001055002212524414
generate_one_block  0.0009641647338867188
generate_one_block  0.0009675025939941406
generate_one_block  0.0009741783142089844
generate_one_block  0.0009784698486328125
generate_one_block  0.0009589195251464844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006401538848876953
gen group dst list time:  0.00013399124145507812
time for parepare:  0.0002009868621826172
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00010538101196289062
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00019693374633789062
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0002219676971435547
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00016379356384277344
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00019931793212890625
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001430511474609375
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001399517059326172
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0001652240753173828
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0002720355987548828
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  8.296966552734375e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00011897087097167969
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00019097328186035156
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.0002028942108154297
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00015354156494140625
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00024247169494628906
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00010776519775390625
----------------------check_connections_block total spend ----------------------------- 0.007138252258300781
generate_one_block  0.0013401508331298828
generate_one_block  0.0014467239379882812
generate_one_block  0.0014882087707519531
generate_one_block  0.001430511474609375
generate_one_block  0.001371145248413086
generate_one_block  0.0011990070343017578
generate_one_block  0.001157522201538086
generate_one_block  0.0012433528900146484
generate_one_block  0.0013344287872314453
generate_one_block  0.001058816909790039
generate_one_block  0.0010521411895751953
generate_one_block  0.0011324882507324219
generate_one_block  0.0011358261108398438
generate_one_block  0.0010864734649658203
generate_one_block  0.001168966293334961
generate_one_block  0.001079559326171875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006859302520751953
gen group dst list time:  0.00022554397583007812
time for parepare:  0.0002644062042236328
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0002593994140625
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00030994415283203125
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  9.107589721679688e-05
r_  generation:  0.0007703304290771484
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  0.0008587837219238281
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0006422996520996094
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.0009372234344482422
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.00030040740966796875
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0008044242858886719
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.0002522468566894531
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.0008933544158935547
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.0002651214599609375
mini_batch_src_global generation:  0.00012421607971191406
r_  generation:  0.0011010169982910156
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.0002872943878173828
mini_batch_src_global generation:  0.00014591217041015625
r_  generation:  0.0013570785522460938
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.000225067138671875
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0003867149353027344
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0007441043853759766
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.0002510547637939453
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.0008144378662109375
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0007607936859130859
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0006005764007568359
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  8.177757263183594e-05
r_  generation:  0.0007524490356445312
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.00034427642822265625
----------------------check_connections_block total spend ----------------------------- 0.021509170532226562
generate_one_block  0.001489400863647461
generate_one_block  0.0018928050994873047
generate_one_block  0.0018672943115234375
generate_one_block  0.0015065670013427734
generate_one_block  0.0017063617706298828
generate_one_block  0.0017154216766357422
generate_one_block  0.0014560222625732422
generate_one_block  0.0016148090362548828
generate_one_block  0.001711130142211914
generate_one_block  0.0011887550354003906
generate_one_block  0.0013780593872070312
generate_one_block  0.0016810894012451172
generate_one_block  0.0016214847564697266
generate_one_block  0.0014793872833251953
generate_one_block  0.0018239021301269531
generate_one_block  0.0012962818145751953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

connection checking time:  0.028647422790527344
block generation total time  0.04515409469604492
average batch blocks generation time:  0.0028221309185028076
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06547164916992188  GigaBytes
Max Memory Allocated: 0.06547164916992188  GigaBytes

torch.Size([365, 1433])
torch.Size([120, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.12431001663208008  GigaBytes
Max Memory Allocated: 0.12836313247680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.1324162483215332  GigaBytes
Max Memory Allocated: 0.24851465225219727  GigaBytes

torch.Size([1006, 1433])
torch.Size([334, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.2962474822998047  GigaBytes
Max Memory Allocated: 0.30771875381469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6209716796875 GB
    Memory Allocated: 0.13207721710205078  GigaBytes
Max Memory Allocated: 0.41687917709350586  GigaBytes

torch.Size([942, 1433])
torch.Size([375, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.3124680519104004  GigaBytes
Max Memory Allocated: 0.41687917709350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.13057184219360352  GigaBytes
Max Memory Allocated: 0.43259239196777344  GigaBytes

torch.Size([661, 1433])
torch.Size([287, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.26181793212890625  GigaBytes
Max Memory Allocated: 0.43259239196777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.13179254531860352  GigaBytes
Max Memory Allocated: 0.43259239196777344  GigaBytes

torch.Size([889, 1433])
torch.Size([348, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.30406999588012695  GigaBytes
Max Memory Allocated: 0.43259239196777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.13054752349853516  GigaBytes
Max Memory Allocated: 0.43259239196777344  GigaBytes

torch.Size([657, 1433])
torch.Size([209, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.23500680923461914  GigaBytes
Max Memory Allocated: 0.43259239196777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.1307992935180664  GigaBytes
Max Memory Allocated: 0.43259239196777344  GigaBytes

torch.Size([704, 1433])
torch.Size([208, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.24838924407958984  GigaBytes
Max Memory Allocated: 0.43259239196777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.1316518783569336  GigaBytes
Max Memory Allocated: 0.43259239196777344  GigaBytes

torch.Size([863, 1433])
torch.Size([280, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.28257274627685547  GigaBytes
Max Memory Allocated: 0.43259239196777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.13205623626708984  GigaBytes
Max Memory Allocated: 0.43259239196777344  GigaBytes

torch.Size([938, 1433])
torch.Size([363, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.31468820571899414  GigaBytes
Max Memory Allocated: 0.43259239196777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.12911081314086914  GigaBytes
Max Memory Allocated: 0.4346041679382324  GigaBytes

torch.Size([389, 1433])
torch.Size([72, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.17508792877197266  GigaBytes
Max Memory Allocated: 0.4346041679382324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.13010358810424805  GigaBytes
Max Memory Allocated: 0.4346041679382324  GigaBytes

torch.Size([574, 1433])
torch.Size([212, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.22476816177368164  GigaBytes
Max Memory Allocated: 0.4346041679382324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.13189935684204102  GigaBytes
Max Memory Allocated: 0.4346041679382324  GigaBytes

torch.Size([909, 1433])
torch.Size([329, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.301602840423584  GigaBytes
Max Memory Allocated: 0.4346041679382324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.13197851181030273  GigaBytes
Max Memory Allocated: 0.4346041679382324  GigaBytes

torch.Size([924, 1433])
torch.Size([306, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.28645896911621094  GigaBytes
Max Memory Allocated: 0.4346041679382324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.13189363479614258  GigaBytes
Max Memory Allocated: 0.4346041679382324  GigaBytes

torch.Size([774, 1433])
torch.Size([235, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.25108814239501953  GigaBytes
Max Memory Allocated: 0.4346041679382324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.13255882263183594  GigaBytes
Max Memory Allocated: 0.4346041679382324  GigaBytes

torch.Size([1032, 1433])
torch.Size([361, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.32465267181396484  GigaBytes
Max Memory Allocated: 0.4346041679382324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.12930059432983398  GigaBytes
Max Memory Allocated: 0.4445381164550781  GigaBytes

torch.Size([424, 1433])
torch.Size([147, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.20945358276367188  GigaBytes
Max Memory Allocated: 0.4445381164550781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05196768045425415 |0.022296488285064697 |0.1320968121290207 |0.00012978911399841309 |0.2076493501663208 |0.01153111457824707 |
----------------------------------------------------------pseudo_mini_loss sum 2.9869327545166016
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17010
Number of first layer input nodes during this epoch:  12051
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.25633859634399414  GigaBytes
Max Memory Allocated: 0.4445381164550781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010068416595458984
random selection method range initialization spend 0.00023317337036132812
time for parepare:  8.440017700195312e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00021767616271972656
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.7881393432617188e-05
----------------------check_connections_block total spend ----------------------------- 0.003693103790283203
generate_one_block  0.0014841556549072266
generate_one_block  0.0012366771697998047
generate_one_block  0.0011699199676513672
generate_one_block  0.0015354156494140625
generate_one_block  0.0010800361633300781
generate_one_block  0.0010628700256347656
generate_one_block  0.0010981559753417969
generate_one_block  0.0010738372802734375
generate_one_block  0.001068115234375
generate_one_block  0.0010547637939453125
generate_one_block  0.001046895980834961
generate_one_block  0.00104522705078125
generate_one_block  0.001051187515258789
generate_one_block  0.001077413558959961
generate_one_block  0.0010347366333007812
generate_one_block  0.0009605884552001953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006258487701416016
gen group dst list time:  0.00011277198791503906
time for parepare:  0.0001933574676513672
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0002567768096923828
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00024580955505371094
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.000194549560546875
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00014352798461914062
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.000156402587890625
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00011563301086425781
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00014162063598632812
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0002117156982421875
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00018787384033203125
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  9.942054748535156e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001437664031982422
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00013184547424316406
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.000141143798828125
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00013518333435058594
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001373291015625
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00014400482177734375
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  7.62939453125e-05
----------------------check_connections_block total spend ----------------------------- 0.006308555603027344
generate_one_block  0.0014481544494628906
generate_one_block  0.0012664794921875
generate_one_block  0.0012221336364746094
generate_one_block  0.0012319087982177734
generate_one_block  0.0011734962463378906
generate_one_block  0.0012083053588867188
generate_one_block  0.0012536048889160156
generate_one_block  0.0011763572692871094
generate_one_block  0.0010478496551513672
generate_one_block  0.0011165142059326172
generate_one_block  0.0011653900146484375
generate_one_block  0.0011222362518310547
generate_one_block  0.0011219978332519531
generate_one_block  0.0011484622955322266
generate_one_block  0.0011129379272460938
generate_one_block  0.001031637191772461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000789642333984375
gen group dst list time:  0.00020933151245117188
time for parepare:  0.0002353191375732422
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.0003199577331542969
mini_batch_src_global generation:  0.00010442733764648438
r_  generation:  0.0007846355438232422
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.0006833076477050781
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0005738735198974609
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.0005180835723876953
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.00043392181396484375
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0005936622619628906
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0007343292236328125
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  0.00010919570922851562
r_  generation:  0.0007472038269042969
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.000335693359375
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0005040168762207031
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0004582405090332031
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0005276203155517578
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0005438327789306641
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.0004801750183105469
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0005421638488769531
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0002777576446533203
----------------------check_connections_block total spend ----------------------------- 0.016158103942871094
generate_one_block  0.002067089080810547
generate_one_block  0.0017855167388916016
generate_one_block  0.0015711784362792969
generate_one_block  0.0016326904296875
generate_one_block  0.0014488697052001953
generate_one_block  0.0016520023345947266
generate_one_block  0.0017583370208740234
generate_one_block  0.0018513202667236328
generate_one_block  0.001299142837524414
generate_one_block  0.0016372203826904297
generate_one_block  0.0014770030975341797
generate_one_block  0.001523733139038086
generate_one_block  0.0015912055969238281
generate_one_block  0.0014591217041015625
generate_one_block  0.0015552043914794922
generate_one_block  0.0012514591217041016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.25633859634399414  GigaBytes
Max Memory Allocated: 0.4445381164550781  GigaBytes

connection checking time:  0.022466659545898438
block generation total time  0.044408559799194336
average batch blocks generation time:  0.002775534987449646
block dataloader generation time/epoch 0.1506805419921875
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.2595486640930176  GigaBytes
Max Memory Allocated: 0.4445381164550781  GigaBytes

torch.Size([1026, 1433])
torch.Size([425, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.45923566818237305  GigaBytes
Max Memory Allocated: 0.47329282760620117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.2589735984802246  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

torch.Size([919, 1433])
torch.Size([316, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.41995716094970703  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.2580900192260742  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

torch.Size([754, 1433])
torch.Size([290, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.39478349685668945  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.2579779624938965  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

torch.Size([733, 1433])
torch.Size([250, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.38303089141845703  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.257504940032959  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

torch.Size([645, 1433])
torch.Size([219, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.3606257438659668  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.2591209411621094  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

torch.Size([947, 1433])
torch.Size([283, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.4057159423828125  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.2590618133544922  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

torch.Size([935, 1433])
torch.Size([327, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.4391632080078125  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.2593502998352051  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

torch.Size([989, 1433])
torch.Size([380, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.44361305236816406  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.256284236907959  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

torch.Size([417, 1433])
torch.Size([145, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.32315540313720703  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.25760316848754883  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

torch.Size([663, 1433])
torch.Size([219, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.3822450637817383  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.25720739364624023  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

torch.Size([589, 1433])
torch.Size([206, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.36921119689941406  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.2580838203430176  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

torch.Size([753, 1433])
torch.Size([293, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.38098621368408203  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.2585330009460449  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

torch.Size([837, 1433])
torch.Size([259, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.39105987548828125  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.25760746002197266  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

torch.Size([664, 1433])
torch.Size([227, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.3689122200012207  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.2585320472717285  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

torch.Size([707, 1433])
torch.Size([242, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.3885498046875  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.2562727928161621  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

torch.Size([415, 1433])
torch.Size([120, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.31798887252807617  GigaBytes
Max Memory Allocated: 0.5787782669067383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.051026999950408936 |0.00047738850116729736 |0.10576850175857544 |0.00011947751045227051 |0.21278002858161926 |0.010457992553710938 |
----------------------------------------------------------pseudo_mini_loss sum 2.369049549102783
Total (block generation + training)time/epoch 6.149738788604736
Training time/epoch 5.998805284500122
Training time without block to device /epoch 5.991167068481445
Training time without total dataloading part /epoch 5.1091461181640625
load block tensor time/epoch 0.816431999206543
block to device time/epoch 0.007638216018676758
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16967
Number of first layer input nodes during this epoch:  11993
