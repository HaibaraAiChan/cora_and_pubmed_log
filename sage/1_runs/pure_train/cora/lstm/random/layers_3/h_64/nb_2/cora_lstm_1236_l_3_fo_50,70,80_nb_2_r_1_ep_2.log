main start at this time 1648429360.027129
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012640953063964844
random selection method range initialization spend 0.0002071857452392578
time for parepare:  8.106231689453125e-05
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.0002224445343017578
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.002779722213745117
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00017142295837402344
----------------------check_connections_block total spend ----------------------------- 0.003795623779296875
generate_one_block  0.0021927356719970703
generate_one_block  0.0015540122985839844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006031990051269531
gen group dst list time:  3.886222839355469e-05
time for parepare:  0.0001900196075439453
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.0002484321594238281
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0008769035339355469
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.00011968612670898438
r_  generation:  0.0009610652923583984
----------------------check_connections_block total spend ----------------------------- 0.0032825469970703125
generate_one_block  0.0023620128631591797
generate_one_block  0.0024967193603515625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007042884826660156
gen group dst list time:  7.605552673339844e-05
time for parepare:  0.00023436546325683594
local_output_nid generation:  0.0001125335693359375
local_in_edges_tensor generation:  0.0003724098205566406
mini_batch_src_global generation:  0.00021386146545410156
r_  generation:  0.0023589134216308594
local_output_nid generation:  0.00011658668518066406
local_in_edges_tensor generation:  0.0003037452697753906
mini_batch_src_global generation:  0.0002484321594238281
r_  generation:  0.0023469924926757812
----------------------check_connections_block total spend ----------------------------- 0.007443666458129883
generate_one_block  0.003975868225097656
generate_one_block  0.0032613277435302734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

connection checking time:  0.010726213455200195
block generation total time  0.012095928192138672
average batch blocks generation time:  0.006047964096069336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07418537139892578  GigaBytes
Max Memory Allocated: 0.07418537139892578  GigaBytes

torch.Size([1987, 1433])
torch.Size([1198, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.582308292388916  GigaBytes
Max Memory Allocated: 0.6157975196838379  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.13670778274536133  GigaBytes
Max Memory Allocated: 0.6908454895019531  GigaBytes

torch.Size([1923, 1433])
torch.Size([1168, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6457018852233887  GigaBytes
Max Memory Allocated: 0.6908454895019531  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03673696517944336 |0.16982877254486084 |0.4502253532409668 |0.00018644332885742188 |0.44183242321014404 |0.008380889892578125 |
----------------------------------------------------------pseudo_mini_loss sum 2.98502516746521
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6980
Number of first layer input nodes during this epoch:  3910
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1112060546875 GB
    Memory Allocated: 0.263826847076416  GigaBytes
Max Memory Allocated: 0.7523460388183594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005245208740234375
random selection method range initialization spend 0.00011944770812988281
time for parepare:  8.082389831542969e-05
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00014162063598632812
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00012540817260742188
----------------------check_connections_block total spend ----------------------------- 0.0009593963623046875
generate_one_block  0.0014085769653320312
generate_one_block  0.001260519027709961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005333423614501953
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.00016546249389648438
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00024318695068359375
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0009829998016357422
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  0.00011968612670898438
r_  generation:  0.0006952285766601562
----------------------check_connections_block total spend ----------------------------- 0.0030024051666259766
generate_one_block  0.002208232879638672
generate_one_block  0.0019378662109375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005974769592285156
gen group dst list time:  6.866455078125e-05
time for parepare:  0.00019431114196777344
local_output_nid generation:  0.00010132789611816406
local_in_edges_tensor generation:  0.0003528594970703125
mini_batch_src_global generation:  0.0001964569091796875
r_  generation:  0.0021212100982666016
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.0002536773681640625
mini_batch_src_global generation:  0.0002536773681640625
r_  generation:  0.0018358230590820312
----------------------check_connections_block total spend ----------------------------- 0.006440639495849609
generate_one_block  0.0037925243377685547
generate_one_block  0.004548549652099609
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1112060546875 GB
    Memory Allocated: 0.263826847076416  GigaBytes
Max Memory Allocated: 0.7523460388183594  GigaBytes

connection checking time:  0.009443044662475586
block generation total time  0.012487173080444336
average batch blocks generation time:  0.006243586540222168
block dataloader generation time/epoch 0.04137563705444336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1112060546875 GB
    Memory Allocated: 0.26410722732543945  GigaBytes
Max Memory Allocated: 0.7523460388183594  GigaBytes
Using backend: pytorch

torch.Size([1993, 1433])
torch.Size([1268, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1444091796875 GB
    Memory Allocated: 0.8064260482788086  GigaBytes
Max Memory Allocated: 0.8408322334289551  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1444091796875 GB
    Memory Allocated: 0.26364994049072266  GigaBytes
Max Memory Allocated: 0.91119384765625  GigaBytes

torch.Size([1909, 1433])
torch.Size([1068, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1444091796875 GB
    Memory Allocated: 0.7416520118713379  GigaBytes
Max Memory Allocated: 0.91119384765625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03247058391571045 |0.0005499124526977539 |0.20773959159851074 |0.00013113021850585938 |0.432966947555542 |0.00690007209777832 |
----------------------------------------------------------pseudo_mini_loss sum 2.3133537769317627
Total (block generation + training)time/epoch 1.4548375606536865
Training time/epoch 1.4130985736846924
Training time without block to device /epoch 1.4119987487792969
Training time without total dataloading part /epoch 1.2885754108428955
load block tensor time/epoch 0.0649411678314209
block to device time/epoch 0.0010998249053955078
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6941
Number of first layer input nodes during this epoch:  3902
