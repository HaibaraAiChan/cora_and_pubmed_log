main start at this time 1648429342.7254694
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001333475112915039
random selection method range initialization spend 0.000202178955078125
time for parepare:  6.532669067382812e-05
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.0028769969940185547
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9311904907226562e-05
----------------------check_connections_block total spend ----------------------------- 0.005965232849121094
generate_one_block  0.0014634132385253906
generate_one_block  0.0011029243469238281
generate_one_block  0.001001119613647461
generate_one_block  0.0010008811950683594
generate_one_block  0.0010237693786621094
generate_one_block  0.0009884834289550781
generate_one_block  0.0009942054748535156
generate_one_block  0.0010263919830322266
generate_one_block  0.0010311603546142578
generate_one_block  0.0010447502136230469
generate_one_block  0.001008749008178711
generate_one_block  0.0010170936584472656
generate_one_block  0.0009601116180419922
generate_one_block  0.0009543895721435547
generate_one_block  0.0010573863983154297
generate_one_block  0.0009434223175048828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006029605865478516
gen group dst list time:  8.869171142578125e-05
time for parepare:  0.0001506805419921875
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00012373924255371094
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00015473365783691406
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00017642974853515625
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00013303756713867188
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00016880035400390625
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00011944770812988281
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.0001163482666015625
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.000133514404296875
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0002143383026123047
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  9.584426879882812e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001533031463623047
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00016188621520996094
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00012254714965820312
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001933574676513672
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  9.131431579589844e-05
----------------------check_connections_block total spend ----------------------------- 0.006010293960571289
generate_one_block  0.0011086463928222656
generate_one_block  0.0011720657348632812
generate_one_block  0.0012235641479492188
generate_one_block  0.0011777877807617188
generate_one_block  0.0011715888977050781
generate_one_block  0.0011141300201416016
generate_one_block  0.0011484622955322266
generate_one_block  0.0011358261108398438
generate_one_block  0.0011796951293945312
generate_one_block  0.0010385513305664062
generate_one_block  0.001058340072631836
generate_one_block  0.0011255741119384766
generate_one_block  0.0011527538299560547
generate_one_block  0.0011093616485595703
generate_one_block  0.0011594295501708984
generate_one_block  0.0010750293731689453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007565021514892578
gen group dst list time:  0.00016880035400390625
time for parepare:  0.0002307891845703125
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0002510547637939453
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0002295970916748047
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0005941390991210938
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  9.34600830078125e-05
r_  generation:  0.0006737709045410156
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.00048542022705078125
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0006051063537597656
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.00042629241943359375
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0004258155822753906
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0005540847778320312
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0006742477416992188
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0001671314239501953
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0003616809844970703
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0006318092346191406
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0005843639373779297
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0004534721374511719
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.000667572021484375
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00029969215393066406
----------------------check_connections_block total spend ----------------------------- 0.014312982559204102
generate_one_block  0.0013225078582763672
generate_one_block  0.0016891956329345703
generate_one_block  0.001687765121459961
generate_one_block  0.0014655590057373047
generate_one_block  0.0016443729400634766
generate_one_block  0.001680135726928711
generate_one_block  0.0014083385467529297
generate_one_block  0.0021011829376220703
generate_one_block  0.0016727447509765625
generate_one_block  0.001127004623413086
generate_one_block  0.0013337135314941406
generate_one_block  0.0016181468963623047
generate_one_block  0.0015876293182373047
generate_one_block  0.0014195442199707031
generate_one_block  0.0017406940460205078
generate_one_block  0.0012505054473876953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

connection checking time:  0.02032327651977539
block generation total time  0.04289984703063965
average batch blocks generation time:  0.002681240439414978
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06521987915039062  GigaBytes
Max Memory Allocated: 0.06521987915039062  GigaBytes

torch.Size([318, 1433])
torch.Size([120, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.12002325057983398  GigaBytes
Max Memory Allocated: 0.1238093376159668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.13226699829101562  GigaBytes
Max Memory Allocated: 0.24422788619995117  GigaBytes

torch.Size([978, 1433])
torch.Size([333, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.28700971603393555  GigaBytes
Max Memory Allocated: 0.29791927337646484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.13202333450317383  GigaBytes
Max Memory Allocated: 0.4069094657897949  GigaBytes

torch.Size([932, 1433])
torch.Size([374, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.30487966537475586  GigaBytes
Max Memory Allocated: 0.4069094657897949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.13045310974121094  GigaBytes
Max Memory Allocated: 0.4242734909057617  GigaBytes

torch.Size([639, 1433])
torch.Size([287, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.2522850036621094  GigaBytes
Max Memory Allocated: 0.4242734909057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.13167953491210938  GigaBytes
Max Memory Allocated: 0.4242734909057617  GigaBytes

torch.Size([868, 1433])
torch.Size([342, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.29433393478393555  GigaBytes
Max Memory Allocated: 0.4242734909057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.13065433502197266  GigaBytes
Max Memory Allocated: 0.4242734909057617  GigaBytes

torch.Size([677, 1433])
torch.Size([210, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.23710966110229492  GigaBytes
Max Memory Allocated: 0.4242734909057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.13054752349853516  GigaBytes
Max Memory Allocated: 0.4242734909057617  GigaBytes

torch.Size([657, 1433])
torch.Size([208, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.23752975463867188  GigaBytes
Max Memory Allocated: 0.4242734909057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.1314702033996582  GigaBytes
Max Memory Allocated: 0.4242734909057617  GigaBytes

torch.Size([829, 1433])
torch.Size([282, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.2752518653869629  GigaBytes
Max Memory Allocated: 0.4242734909057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.13187360763549805  GigaBytes
Max Memory Allocated: 0.4242734909057617  GigaBytes

torch.Size([904, 1433])
torch.Size([363, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.3057737350463867  GigaBytes
Max Memory Allocated: 0.4242734909057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.12873125076293945  GigaBytes
Max Memory Allocated: 0.42470645904541016  GigaBytes

torch.Size([318, 1433])
torch.Size([72, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.1668853759765625  GigaBytes
Max Memory Allocated: 0.42470645904541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.12994766235351562  GigaBytes
Max Memory Allocated: 0.42470645904541016  GigaBytes

torch.Size([545, 1433])
torch.Size([212, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.21843576431274414  GigaBytes
Max Memory Allocated: 0.42470645904541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.1317596435546875  GigaBytes
Max Memory Allocated: 0.42470645904541016  GigaBytes

torch.Size([883, 1433])
torch.Size([328, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.28980445861816406  GigaBytes
Max Memory Allocated: 0.42470645904541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.1318492889404297  GigaBytes
Max Memory Allocated: 0.42470645904541016  GigaBytes

torch.Size([900, 1433])
torch.Size([305, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.28278017044067383  GigaBytes
Max Memory Allocated: 0.42470645904541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.13093805313110352  GigaBytes
Max Memory Allocated: 0.42470645904541016  GigaBytes

torch.Size([730, 1433])
torch.Size([235, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.24324417114257812  GigaBytes
Max Memory Allocated: 0.42470645904541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.1322484016418457  GigaBytes
Max Memory Allocated: 0.42470645904541016  GigaBytes

torch.Size([974, 1433])
torch.Size([358, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.30887746810913086  GigaBytes
Max Memory Allocated: 0.42470645904541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.12908601760864258  GigaBytes
Max Memory Allocated: 0.42780017852783203  GigaBytes

torch.Size([384, 1433])
torch.Size([147, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.2014479637145996  GigaBytes
Max Memory Allocated: 0.42780017852783203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05179262161254883 |0.021883666515350342 |0.10991625487804413 |0.00011456012725830078 |0.11500844359397888 |0.010167598724365234 |
----------------------------------------------------------pseudo_mini_loss sum 2.992467164993286
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16485
Number of first layer input nodes during this epoch:  11536
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.25612306594848633  GigaBytes
Max Memory Allocated: 0.42780017852783203  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005519390106201172
random selection method range initialization spend 0.00013756752014160156
time for parepare:  9.083747863769531e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  5.14984130859375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.003269195556640625
generate_one_block  0.0012669563293457031
generate_one_block  0.0010669231414794922
generate_one_block  0.0010080337524414062
generate_one_block  0.0014345645904541016
generate_one_block  0.001035928726196289
generate_one_block  0.0010116100311279297
generate_one_block  0.0010251998901367188
generate_one_block  0.00104522705078125
generate_one_block  0.001020669937133789
generate_one_block  0.0010061264038085938
generate_one_block  0.0009999275207519531
generate_one_block  0.0010306835174560547
generate_one_block  0.0009975433349609375
generate_one_block  0.000978708267211914
generate_one_block  0.0010056495666503906
generate_one_block  0.0009872913360595703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006644725799560547
gen group dst list time:  0.00011348724365234375
time for parepare:  0.0001990795135498047
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00024199485778808594
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0002167224884033203
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00018310546875
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001614093780517578
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00015306472778320312
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00011348724365234375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00014019012451171875
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00019979476928710938
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0001804828643798828
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  9.441375732421875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00013637542724609375
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00012493133544921875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001316070556640625
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001277923583984375
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00012874603271484375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00013828277587890625
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.462501525878906e-05
----------------------check_connections_block total spend ----------------------------- 0.0061359405517578125
generate_one_block  0.001516103744506836
generate_one_block  0.0012714862823486328
generate_one_block  0.0012104511260986328
generate_one_block  0.0012142658233642578
generate_one_block  0.0011301040649414062
generate_one_block  0.0012011528015136719
generate_one_block  0.0012505054473876953
generate_one_block  0.0011768341064453125
generate_one_block  0.001117706298828125
generate_one_block  0.0011494159698486328
generate_one_block  0.0010974407196044922
generate_one_block  0.0011749267578125
generate_one_block  0.001196146011352539
generate_one_block  0.001207113265991211
generate_one_block  0.0011756420135498047
generate_one_block  0.0010821819305419922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000820159912109375
gen group dst list time:  0.00020766258239746094
time for parepare:  0.00023055076599121094
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00033020973205566406
mini_batch_src_global generation:  0.00010633468627929688
r_  generation:  0.0007660388946533203
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.0006134510040283203
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  7.796287536621094e-05
r_  generation:  0.0005135536193847656
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.0004608631134033203
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00041103363037109375
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.0005326271057128906
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0006241798400878906
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.0006527900695800781
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00031280517578125
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0004558563232421875
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0003991127014160156
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00045609474182128906
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0004863739013671875
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0004570484161376953
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.00048041343688964844
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0002446174621582031
----------------------check_connections_block total spend ----------------------------- 0.014829397201538086
generate_one_block  0.0019898414611816406
generate_one_block  0.0018029212951660156
generate_one_block  0.0015761852264404297
generate_one_block  0.0015943050384521484
generate_one_block  0.0014243125915527344
generate_one_block  0.0016474723815917969
generate_one_block  0.0017242431640625
generate_one_block  0.0017805099487304688
generate_one_block  0.0013098716735839844
generate_one_block  0.0015850067138671875
generate_one_block  0.001478433609008789
generate_one_block  0.0014994144439697266
generate_one_block  0.0015780925750732422
generate_one_block  0.0014827251434326172
generate_one_block  0.0015034675598144531
generate_one_block  0.0012924671173095703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.25612306594848633  GigaBytes
Max Memory Allocated: 0.42780017852783203  GigaBytes

connection checking time:  0.0209653377532959
block generation total time  0.04444074630737305
average batch blocks generation time:  0.0027775466442108154
block dataloader generation time/epoch 0.14084339141845703
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.2596116065979004  GigaBytes
Max Memory Allocated: 0.42780017852783203  GigaBytes

torch.Size([1038, 1433])
torch.Size([435, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.45419740676879883  GigaBytes
Max Memory Allocated: 0.4681081771850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.2587270736694336  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

torch.Size([873, 1433])
torch.Size([319, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.4131441116333008  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.25794458389282227  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

torch.Size([727, 1433])
torch.Size([288, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.3863945007324219  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.2576460838317871  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

torch.Size([671, 1433])
torch.Size([247, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.3757743835449219  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.25794172286987305  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

torch.Size([619, 1433])
torch.Size([214, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.35271120071411133  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.25881052017211914  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

torch.Size([889, 1433])
torch.Size([282, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.39133644104003906  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.2585635185241699  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

torch.Size([842, 1433])
torch.Size([324, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.41951608657836914  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.25907182693481445  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

torch.Size([937, 1433])
torch.Size([378, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.4293851852416992  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.2562246322631836  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

torch.Size([406, 1433])
torch.Size([145, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.32120323181152344  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.25731372833251953  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

torch.Size([609, 1433])
torch.Size([219, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.3717350959777832  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.25688600540161133  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

torch.Size([529, 1433])
torch.Size([205, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.35736608505249023  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.2578849792480469  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

torch.Size([716, 1433])
torch.Size([292, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.3735990524291992  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.25827598571777344  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

torch.Size([789, 1433])
torch.Size([258, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.3837308883666992  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.25788402557373047  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

torch.Size([641, 1433])
torch.Size([227, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.36492156982421875  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.25755929946899414  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

torch.Size([655, 1433])
torch.Size([241, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.37700414657592773  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.25612831115722656  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

torch.Size([388, 1433])
torch.Size([120, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.31365537643432617  GigaBytes
Max Memory Allocated: 0.5728216171264648  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05209369957447052 |0.00040869414806365967 |0.07803022861480713 |0.00010563433170318604 |0.11242127418518066 |0.011114120483398438 |
----------------------------------------------------------pseudo_mini_loss sum 2.4343929290771484
Total (block generation + training)time/epoch 4.104409694671631
Training time/epoch 3.963261604309082
Training time without block to device /epoch 3.9567224979400635
Training time without total dataloading part /epoch 3.060028314590454
load block tensor time/epoch 0.8334991931915283
block to device time/epoch 0.006539106369018555
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16296
Number of first layer input nodes during this epoch:  11329
