main start at this time 1648429253.3447354
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00099945068359375
random selection method range initialization spend 0.00016021728515625
time for parepare:  6.461143493652344e-05
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0013484954833984375
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00013899803161621094
----------------------check_connections_block total spend ----------------------------- 0.0022020339965820312
generate_one_block  0.0013446807861328125
generate_one_block  0.001180410385131836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005311965942382812
gen group dst list time:  2.9325485229492188e-05
time for parepare:  0.0001513957977294922
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0002357959747314453
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.0006589889526367188
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  8.511543273925781e-05
r_  generation:  0.0007116794586181641
----------------------check_connections_block total spend ----------------------------- 0.002534151077270508
generate_one_block  0.0018453598022460938
generate_one_block  0.0019207000732421875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005729198455810547
gen group dst list time:  5.626678466796875e-05
time for parepare:  0.00017547607421875
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.0003533363342285156
mini_batch_src_global generation:  0.00014281272888183594
r_  generation:  0.0017380714416503906
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.0002384185791015625
mini_batch_src_global generation:  0.00016570091247558594
r_  generation:  0.0017490386962890625
----------------------check_connections_block total spend ----------------------------- 0.005574703216552734
generate_one_block  0.003011465072631836
generate_one_block  0.0036954879760742188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

connection checking time:  0.008108854293823242
block generation total time  0.010473012924194336
average batch blocks generation time:  0.005236506462097168
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07384490966796875  GigaBytes
Max Memory Allocated: 0.07384490966796875  GigaBytes

torch.Size([1924, 1433])
torch.Size([1121, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7830810546875 GB
    Memory Allocated: 0.5449638366699219  GigaBytes
Max Memory Allocated: 0.5771946907043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.1368846893310547  GigaBytes
Max Memory Allocated: 0.6531505584716797  GigaBytes

torch.Size([1835, 1433])
torch.Size([1100, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6018857955932617  GigaBytes
Max Memory Allocated: 0.6531505584716797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.040677428245544434 |0.17005860805511475 |0.3689396381378174 |0.0001544952392578125 |0.19109487533569336 |0.010976552963256836 |
----------------------------------------------------------pseudo_mini_loss sum 2.9803688526153564
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6684
Number of first layer input nodes during this epoch:  3759
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.26399803161621094  GigaBytes
Max Memory Allocated: 0.7078804969787598  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004763603210449219
random selection method range initialization spend 0.00011205673217773438
time for parepare:  6.628036499023438e-05
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00013184547424316406
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00012063980102539062
----------------------check_connections_block total spend ----------------------------- 0.0008881092071533203
generate_one_block  0.0013244152069091797
generate_one_block  0.0011751651763916016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004978179931640625
gen group dst list time:  3.123283386230469e-05
time for parepare:  0.00014662742614746094
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00023317337036132812
mini_batch_src_global generation:  8.20159912109375e-05
r_  generation:  0.0007567405700683594
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0006096363067626953
----------------------check_connections_block total spend ----------------------------- 0.0025398731231689453
generate_one_block  0.002002239227294922
generate_one_block  0.0018188953399658203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005624294281005859
gen group dst list time:  5.698204040527344e-05
time for parepare:  0.00018477439880371094
local_output_nid generation:  9.417533874511719e-05
local_in_edges_tensor generation:  0.0003414154052734375
mini_batch_src_global generation:  0.0001494884490966797
r_  generation:  0.0019059181213378906
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.00022840499877929688
mini_batch_src_global generation:  0.0001964569091796875
r_  generation:  0.0015747547149658203
----------------------check_connections_block total spend ----------------------------- 0.005697727203369141
generate_one_block  0.003553152084350586
generate_one_block  0.002980470657348633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.26399803161621094  GigaBytes
Max Memory Allocated: 0.7078804969787598  GigaBytes

connection checking time:  0.008237600326538086
block generation total time  0.010354757308959961
average batch blocks generation time:  0.0051773786544799805
block dataloader generation time/epoch 0.033646583557128906
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.264406681060791  GigaBytes
Max Memory Allocated: 0.7078804969787598  GigaBytes
Using backend: pytorch

torch.Size([1928, 1433])
torch.Size([1212, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.7711944580078125  GigaBytes
Max Memory Allocated: 0.8040471076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1268310546875 GB
    Memory Allocated: 0.26378870010375977  GigaBytes
Max Memory Allocated: 0.876011848449707  GigaBytes

torch.Size([1814, 1433])
torch.Size([985, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.6934847831726074  GigaBytes
Max Memory Allocated: 0.876011848449707  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03423774242401123 |0.00042891502380371094 |0.13100087642669678 |0.00011909008026123047 |0.18864738941192627 |0.0084991455078125 |
----------------------------------------------------------pseudo_mini_loss sum 2.284058094024658
Total (block generation + training)time/epoch 0.8097732067108154
Training time/epoch 0.7758734226226807
Training time without block to device /epoch 0.7750155925750732
Training time without total dataloading part /epoch 0.648033857345581
load block tensor time/epoch 0.06847548484802246
block to device time/epoch 0.0008578300476074219
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6642
Number of first layer input nodes during this epoch:  3742
