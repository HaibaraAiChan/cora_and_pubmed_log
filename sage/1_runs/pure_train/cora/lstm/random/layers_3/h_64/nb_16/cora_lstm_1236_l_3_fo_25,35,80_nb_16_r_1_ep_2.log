main start at this time 1648429288.8042245
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011951923370361328
random selection method range initialization spend 0.0001723766326904297
time for parepare:  6.365776062011719e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  0.002276182174682617
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9788742065429688e-05
----------------------check_connections_block total spend ----------------------------- 0.0052530765533447266
generate_one_block  0.0012888908386230469
generate_one_block  0.001130819320678711
generate_one_block  0.0010714530944824219
generate_one_block  0.001062154769897461
generate_one_block  0.0010747909545898438
generate_one_block  0.0010690689086914062
generate_one_block  0.0010645389556884766
generate_one_block  0.0010724067687988281
generate_one_block  0.0010833740234375
generate_one_block  0.0010941028594970703
generate_one_block  0.0010824203491210938
generate_one_block  0.0010941028594970703
generate_one_block  0.0010700225830078125
generate_one_block  0.0010690689086914062
generate_one_block  0.0010943412780761719
generate_one_block  0.0010118484497070312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005652904510498047
gen group dst list time:  8.988380432128906e-05
time for parepare:  0.00014495849609375
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.320808410644531e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00013756752014160156
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001552104949951172
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00011610984802246094
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00013518333435058594
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010824203491210938
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00010848045349121094
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00011658668518066406
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00021266937255859375
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.818771362304688e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0001323223114013672
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00015234947204589844
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00011563301086425781
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0001804828643798828
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  8.535385131835938e-05
----------------------check_connections_block total spend ----------------------------- 0.0055239200592041016
generate_one_block  0.0011496543884277344
generate_one_block  0.0012154579162597656
generate_one_block  0.0012388229370117188
generate_one_block  0.0011816024780273438
generate_one_block  0.0012197494506835938
generate_one_block  0.0011775493621826172
generate_one_block  0.0011620521545410156
generate_one_block  0.001165151596069336
generate_one_block  0.0012445449829101562
generate_one_block  0.0010480880737304688
generate_one_block  0.0010941028594970703
generate_one_block  0.001157522201538086
generate_one_block  0.0011780261993408203
generate_one_block  0.0011277198791503906
generate_one_block  0.0011935234069824219
generate_one_block  0.0011332035064697266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006890296936035156
gen group dst list time:  0.00014591217041015625
time for parepare:  0.00021123886108398438
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00023794174194335938
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00022792816162109375
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0004932880401611328
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0005307197570800781
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0003800392150878906
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0005228519439697266
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.0003387928009033203
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0004012584686279297
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.00043392181396484375
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0006439685821533203
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00016736984252929688
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0003147125244140625
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00048065185546875
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0005037784576416016
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0003924369812011719
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0005805492401123047
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.00028586387634277344
----------------------check_connections_block total spend ----------------------------- 0.012490987777709961
generate_one_block  0.0013282299041748047
generate_one_block  0.0017142295837402344
generate_one_block  0.0017218589782714844
generate_one_block  0.0014195442199707031
generate_one_block  0.0015480518341064453
generate_one_block  0.0016033649444580078
generate_one_block  0.0014312267303466797
generate_one_block  0.0014350414276123047
generate_one_block  0.001659393310546875
generate_one_block  0.0011150836944580078
generate_one_block  0.0012886524200439453
generate_one_block  0.0014920234680175781
generate_one_block  0.0015039443969726562
generate_one_block  0.0013985633850097656
generate_one_block  0.001623392105102539
generate_one_block  0.0012409687042236328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

connection checking time:  0.018014907836914062
block generation total time  0.04221034049987793
average batch blocks generation time:  0.0026381462812423706
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06524658203125  GigaBytes
Max Memory Allocated: 0.06524658203125  GigaBytes

torch.Size([323, 1433])
torch.Size([120, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.12004995346069336  GigaBytes
Max Memory Allocated: 0.12383604049682617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.13161706924438477  GigaBytes
Max Memory Allocated: 0.24425458908081055  GigaBytes

torch.Size([857, 1433])
torch.Size([278, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.2628140449523926  GigaBytes
Max Memory Allocated: 0.2720303535461426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.13125038146972656  GigaBytes
Max Memory Allocated: 0.3833494186401367  GigaBytes

torch.Size([788, 1433])
torch.Size([293, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.2691044807434082  GigaBytes
Max Memory Allocated: 0.3833494186401367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.12991666793823242  GigaBytes
Max Memory Allocated: 0.38942861557006836  GigaBytes

torch.Size([539, 1433])
torch.Size([224, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.22694826126098633  GigaBytes
Max Memory Allocated: 0.38942861557006836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.13129758834838867  GigaBytes
Max Memory Allocated: 0.38942861557006836  GigaBytes

torch.Size([797, 1433])
torch.Size([290, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27081871032714844  GigaBytes
Max Memory Allocated: 0.38942861557006836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.13013982772827148  GigaBytes
Max Memory Allocated: 0.39168834686279297  GigaBytes

torch.Size([581, 1433])
torch.Size([178, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21700334548950195  GigaBytes
Max Memory Allocated: 0.39168834686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.1304621696472168  GigaBytes
Max Memory Allocated: 0.39168834686279297  GigaBytes

torch.Size([641, 1433])
torch.Size([200, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.23493528366088867  GigaBytes
Max Memory Allocated: 0.39168834686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.1307830810546875  GigaBytes
Max Memory Allocated: 0.39168834686279297  GigaBytes

torch.Size([701, 1433])
torch.Size([220, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.24396610260009766  GigaBytes
Max Memory Allocated: 0.39168834686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.13185739517211914  GigaBytes
Max Memory Allocated: 0.39168834686279297  GigaBytes

torch.Size([901, 1433])
torch.Size([358, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.30385446548461914  GigaBytes
Max Memory Allocated: 0.39168834686279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.1287097930908203  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

torch.Size([314, 1433])
torch.Size([72, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.16686391830444336  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.12967443466186523  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

torch.Size([494, 1433])
torch.Size([184, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.2089829444885254  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.13108301162719727  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

torch.Size([757, 1433])
torch.Size([264, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.2581033706665039  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.13140535354614258  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

torch.Size([817, 1433])
torch.Size([272, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.26421308517456055  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.13057422637939453  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

torch.Size([662, 1433])
torch.Size([206, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.23226022720336914  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.13166236877441406  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

torch.Size([865, 1433])
torch.Size([307, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.2833824157714844  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.12908077239990234  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

torch.Size([383, 1433])
torch.Size([142, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.19985198974609375  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05169899761676788 |0.021898657083511353 |0.10034435987472534 |0.0001125037670135498 |0.09587448835372925 |0.010428190231323242 |
----------------------------------------------------------pseudo_mini_loss sum 2.979868173599243
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14801
Number of first layer input nodes during this epoch:  10420
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.2561178207397461  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005192756652832031
random selection method range initialization spend 0.0001327991485595703
time for parepare:  7.915496826171875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.0031719207763671875
generate_one_block  0.0011034011840820312
generate_one_block  0.0010225772857666016
generate_one_block  0.0010020732879638672
generate_one_block  0.0014410018920898438
generate_one_block  0.00101470947265625
generate_one_block  0.0010027885437011719
generate_one_block  0.0010280609130859375
generate_one_block  0.0010018348693847656
generate_one_block  0.0010013580322265625
generate_one_block  0.0010004043579101562
generate_one_block  0.0010027885437011719
generate_one_block  0.0009949207305908203
generate_one_block  0.0009562969207763672
generate_one_block  0.0009677410125732422
generate_one_block  0.0009639263153076172
generate_one_block  0.0009500980377197266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006000995635986328
gen group dst list time:  9.846687316894531e-05
time for parepare:  0.00017333030700683594
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0001842975616455078
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0001761913299560547
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00011920928955078125
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0001399517059326172
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00010061264038085938
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00010991096496582031
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001895427703857422
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001442432403564453
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  9.322166442871094e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00012564659118652344
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00011396408081054688
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00011372566223144531
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00012493133544921875
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0001277923583984375
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00012421607971191406
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.033348083496094e-05
----------------------check_connections_block total spend ----------------------------- 0.005670070648193359
generate_one_block  0.0013217926025390625
generate_one_block  0.0011959075927734375
generate_one_block  0.001149892807006836
generate_one_block  0.0011568069458007812
generate_one_block  0.0011096000671386719
generate_one_block  0.0011219978332519531
generate_one_block  0.0012295246124267578
generate_one_block  0.0011301040649414062
generate_one_block  0.001054525375366211
generate_one_block  0.0010874271392822266
generate_one_block  0.00107574462890625
generate_one_block  0.0010840892791748047
generate_one_block  0.0010869503021240234
generate_one_block  0.0011487007141113281
generate_one_block  0.0010902881622314453
generate_one_block  0.0010292530059814453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007157325744628906
gen group dst list time:  0.00017571449279785156
time for parepare:  0.00022530555725097656
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0003199577331542969
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0006170272827148438
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.0005586147308349609
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0004303455352783203
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004024505615234375
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0003330707550048828
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0004131793975830078
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0006015300750732422
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.0005397796630859375
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00028967857360839844
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0004029273986816406
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0003695487976074219
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.00039768218994140625
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0004246234893798828
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0004253387451171875
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0004329681396484375
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00024175643920898438
----------------------check_connections_block total spend ----------------------------- 0.013272285461425781
generate_one_block  0.0018398761749267578
generate_one_block  0.0016417503356933594
generate_one_block  0.0014755725860595703
generate_one_block  0.0014219284057617188
generate_one_block  0.0013585090637207031
generate_one_block  0.001470327377319336
generate_one_block  0.001638650894165039
generate_one_block  0.0015883445739746094
generate_one_block  0.0012671947479248047
generate_one_block  0.0015366077423095703
generate_one_block  0.0014009475708007812
generate_one_block  0.0014154911041259766
generate_one_block  0.0014698505401611328
generate_one_block  0.0015070438385009766
generate_one_block  0.0015099048614501953
generate_one_block  0.0012309551239013672
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.2561178207397461  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

connection checking time:  0.01894235610961914
block generation total time  0.04184556007385254
average batch blocks generation time:  0.0026153475046157837
block dataloader generation time/epoch 0.1331775188446045
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.25887632369995117  GigaBytes
Max Memory Allocated: 0.4228386878967285  GigaBytes

torch.Size([901, 1433])
torch.Size([349, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.42261362075805664  GigaBytes
Max Memory Allocated: 0.4341602325439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2582402229309082  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

torch.Size([782, 1433])
torch.Size([289, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.39557361602783203  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.257718563079834  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

torch.Size([685, 1433])
torch.Size([234, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.3654460906982422  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2571101188659668  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

torch.Size([571, 1433])
torch.Size([216, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.3582448959350586  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2568349838256836  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

torch.Size([520, 1433])
torch.Size([188, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.3379850387573242  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2581028938293457  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

torch.Size([757, 1433])
torch.Size([213, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.36333560943603516  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.25852537155151367  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

torch.Size([835, 1433])
torch.Size([300, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.41156005859375  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2583737373352051  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

torch.Size([807, 1433])
torch.Size([292, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.39577436447143555  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2562246322631836  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

torch.Size([406, 1433])
torch.Size([145, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.32120323181152344  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.25719547271728516  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

torch.Size([587, 1433])
torch.Size([194, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.36075448989868164  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2568850517272949  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

torch.Size([529, 1433])
torch.Size([182, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.35068273544311523  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.25751495361328125  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

torch.Size([647, 1433])
torch.Size([233, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.3541278839111328  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.257814884185791  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

torch.Size([703, 1433])
torch.Size([222, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.36532020568847656  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.25751590728759766  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

torch.Size([639, 1433])
torch.Size([224, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.3639082908630371  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.2574954032897949  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

torch.Size([643, 1433])
torch.Size([213, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.36722326278686523  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.25611257553100586  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

torch.Size([385, 1433])
torch.Size([116, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.3126497268676758  GigaBytes
Max Memory Allocated: 0.542198657989502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05226023495197296 |0.0003979802131652832 |0.07312965393066406 |0.00010392069816589355 |0.1001502126455307 |0.011127471923828125 |
----------------------------------------------------------pseudo_mini_loss sum 2.357326030731201
Total (block generation + training)time/epoch 3.824838638305664
Training time/epoch 3.691317319869995
Training time without block to device /epoch 3.6849496364593506
Training time without total dataloading part /epoch 2.7852680683135986
load block tensor time/epoch 0.8361637592315674
block to device time/epoch 0.006367683410644531
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14780
Number of first layer input nodes during this epoch:  10397
