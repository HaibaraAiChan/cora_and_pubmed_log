main start at this time 1648429211.6351073
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010290145874023438
random selection method range initialization spend 0.0002181529998779297
time for parepare:  6.628036499023438e-05
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.002547740936279297
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.440017700195312e-05
----------------------check_connections_block total spend ----------------------------- 0.0038640499114990234
generate_one_block  0.0013599395751953125
generate_one_block  0.001140594482421875
generate_one_block  0.0011248588562011719
generate_one_block  0.0011355876922607422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005075931549072266
gen group dst list time:  4.124641418457031e-05
time for parepare:  0.00015211105346679688
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00039649009704589844
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.00043129920959472656
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0004458427429199219
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.00046372413635253906
----------------------check_connections_block total spend ----------------------------- 0.003376007080078125
generate_one_block  0.0015184879302978516
generate_one_block  0.0015330314636230469
generate_one_block  0.0015490055084228516
generate_one_block  0.0015645027160644531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005962848663330078
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.00018024444580078125
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00025916099548339844
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.001172780990600586
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  0.0001544952392578125
r_  generation:  0.0012645721435546875
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  0.000133514404296875
r_  generation:  0.0012979507446289062
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.0001354217529296875
r_  generation:  0.0013020038604736328
----------------------check_connections_block total spend ----------------------------- 0.008136510848999023
generate_one_block  0.0024199485778808594
generate_one_block  0.002516508102416992
generate_one_block  0.0025587081909179688
generate_one_block  0.0023040771484375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

connection checking time:  0.011512517929077148
block generation total time  0.015964269638061523
average batch blocks generation time:  0.003991067409515381
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07111501693725586  GigaBytes
Max Memory Allocated: 0.07111501693725586  GigaBytes

torch.Size([1417, 1433])
torch.Size([696, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.36633920669555664  GigaBytes
Max Memory Allocated: 0.3865237236022949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.13500452041625977  GigaBytes
Max Memory Allocated: 0.4817824363708496  GigaBytes

torch.Size([1487, 1433])
torch.Size([706, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.4544215202331543  GigaBytes
Max Memory Allocated: 0.4817824363708496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.13512277603149414  GigaBytes
Max Memory Allocated: 0.5683431625366211  GigaBytes

torch.Size([1509, 1433])
torch.Size([736, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.45954370498657227  GigaBytes
Max Memory Allocated: 0.5683431625366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.13509178161621094  GigaBytes
Max Memory Allocated: 0.572512149810791  GigaBytes

torch.Size([1503, 1433])
torch.Size([731, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.46122217178344727  GigaBytes
Max Memory Allocated: 0.572512149810791  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04835009574890137 |0.08670002222061157 |0.22901952266693115 |0.0001551508903503418 |0.1610819697380066 |0.012828826904296875 |
----------------------------------------------------------pseudo_mini_loss sum 2.9382832050323486
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9528
Number of first layer input nodes during this epoch:  5916
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.2621746063232422  GigaBytes
Max Memory Allocated: 0.5739655494689941  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005035400390625
random selection method range initialization spend 0.00012063980102539062
time for parepare:  7.128715515136719e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  8.130073547363281e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00011944770812988281Using backend: pytorch

mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  8.058547973632812e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.890296936035156e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.580352783203125e-05
----------------------check_connections_block total spend ----------------------------- 0.0014066696166992188
generate_one_block  0.0012326240539550781
generate_one_block  0.0011553764343261719
generate_one_block  0.001119375228881836
generate_one_block  0.0011129379272460938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005135536193847656
gen group dst list time:  4.363059997558594e-05
time for parepare:  0.00015115737915039062
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.00048613548278808594
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0004611015319824219
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0003643035888671875
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00038814544677734375
----------------------check_connections_block total spend ----------------------------- 0.003383159637451172
generate_one_block  0.0016994476318359375
generate_one_block  0.0016129016876220703
generate_one_block  0.001489877700805664
generate_one_block  0.0015232563018798828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005817413330078125
gen group dst list time:  8.463859558105469e-05
time for parepare:  0.00018858909606933594
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.0003097057342529297
mini_batch_src_global generation:  0.00012063980102539062
r_  generation:  0.0014204978942871094
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  0.00015020370483398438
r_  generation:  0.0012896060943603516
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  0.00011944770812988281
r_  generation:  0.001041412353515625
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  0.0001227855682373047
r_  generation:  0.0011708736419677734
----------------------check_connections_block total spend ----------------------------- 0.008005380630493164
generate_one_block  0.002823352813720703
generate_one_block  0.002591848373413086
generate_one_block  0.002359628677368164
generate_one_block  0.002218484878540039
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.2621746063232422  GigaBytes
Max Memory Allocated: 0.5739655494689941  GigaBytes

connection checking time:  0.011388540267944336
block generation total time  0.016318798065185547
average batch blocks generation time:  0.004079699516296387
block dataloader generation time/epoch 0.05161333084106445
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.2624945640563965  GigaBytes
Max Memory Allocated: 0.5739655494689941  GigaBytes

torch.Size([1574, 1433])
torch.Size([815, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9217529296875 GB
    Memory Allocated: 0.6242237091064453  GigaBytes
Max Memory Allocated: 0.6483883857727051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.2620048522949219  GigaBytes
Max Memory Allocated: 0.7363467216491699  GigaBytes

torch.Size([1483, 1433])
torch.Size([729, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.5779814720153809  GigaBytes
Max Memory Allocated: 0.7363467216491699  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.26092004776000977  GigaBytes
Max Memory Allocated: 0.7363467216491699  GigaBytes

torch.Size([1281, 1433])
torch.Size([571, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.5207910537719727  GigaBytes
Max Memory Allocated: 0.7363467216491699  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.2615642547607422  GigaBytes
Max Memory Allocated: 0.7363467216491699  GigaBytes

torch.Size([1401, 1433])
torch.Size([640, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.5556855201721191  GigaBytes
Max Memory Allocated: 0.7363467216491699  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04633903503417969 |0.0004252195358276367 |0.11206424236297607 |0.00012153387069702148 |0.15874987840652466 |0.010787725448608398 |
----------------------------------------------------------pseudo_mini_loss sum 2.292799472808838
Total (block generation + training)time/epoch 1.3906974792480469
Training time/epoch 1.338731288909912
Training time without block to device /epoch 1.3370304107666016
Training time without total dataloading part /epoch 1.0945303440093994
load block tensor time/epoch 0.18535614013671875
block to device time/epoch 0.0017008781433105469
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9229
Number of first layer input nodes during this epoch:  5739
