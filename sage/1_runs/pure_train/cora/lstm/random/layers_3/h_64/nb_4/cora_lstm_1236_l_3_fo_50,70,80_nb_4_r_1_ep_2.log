main start at this time 1648429372.0954418
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001283884048461914
random selection method range initialization spend 0.00021338462829589844
time for parepare:  7.2479248046875e-05
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0027391910552978516
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  8.893013000488281e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.320808410644531e-05
----------------------check_connections_block total spend ----------------------------- 0.004108428955078125
generate_one_block  0.001528024673461914
generate_one_block  0.0013589859008789062
generate_one_block  0.0012907981872558594
generate_one_block  0.0012731552124023438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006005764007568359
gen group dst list time:  4.9591064453125e-05
time for parepare:  0.00018024444580078125
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.00045418739318847656
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.00048041343688964844
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0004994869232177734
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0005574226379394531
----------------------check_connections_block total spend ----------------------------- 0.003844738006591797
generate_one_block  0.0017898082733154297
generate_one_block  0.0017566680908203125
generate_one_block  0.001809835433959961
generate_one_block  0.0017864704132080078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006833076477050781
gen group dst list time:  0.000102996826171875
time for parepare:  0.00021409988403320312
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.00032639503479003906
mini_batch_src_global generation:  0.0001404285430908203
r_  generation:  0.0014388561248779297
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.00023889541625976562
mini_batch_src_global generation:  0.00018596649169921875
r_  generation:  0.0015435218811035156
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  0.00016117095947265625
r_  generation:  0.001584768295288086
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.0002491474151611328
mini_batch_src_global generation:  0.0001659393310546875
r_  generation:  0.0015573501586914062
----------------------check_connections_block total spend ----------------------------- 0.009866476058959961
generate_one_block  0.0029430389404296875
generate_one_block  0.0024862289428710938
generate_one_block  0.002577066421508789
generate_one_block  0.0024504661560058594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

connection checking time:  0.013711214065551758
block generation total time  0.01759958267211914
average batch blocks generation time:  0.004399895668029785
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07188844680786133  GigaBytes
Max Memory Allocated: 0.07188844680786133  GigaBytes

torch.Size([1561, 1433])
torch.Size([794, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.41504573822021484  GigaBytes
Max Memory Allocated: 0.43894052505493164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.13547897338867188  GigaBytes
Max Memory Allocated: 0.5302224159240723  GigaBytes

torch.Size([1575, 1433])
torch.Size([774, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.4927639961242676  GigaBytes
Max Memory Allocated: 0.5302224159240723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.13580036163330078  GigaBytes
Max Memory Allocated: 0.6068611145019531  GigaBytes

torch.Size([1635, 1433])
torch.Size([809, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.503697395324707  GigaBytes
Max Memory Allocated: 0.6068611145019531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.13579034805297852  GigaBytes
Max Memory Allocated: 0.6172356605529785  GigaBytes

torch.Size([1633, 1433])
torch.Size([808, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.5055384635925293  GigaBytes
Max Memory Allocated: 0.6172356605529785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04712939262390137 |0.08571887016296387 |0.2917061448097229 |0.00015038251876831055 |0.4018908143043518 |0.009393930435180664 |
----------------------------------------------------------pseudo_mini_loss sum 2.94960618019104
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10332
Number of first layer input nodes during this epoch:  6404
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.2628798484802246  GigaBytes
Max Memory Allocated: 0.6187748908996582  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00049591064453125
random selection method range initialization spend 0.000125885009765625
time for parepare:  6.771087646484375e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00011301040649414062Using backend: pytorch

mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  7.677078247070312e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  6.198883056640625e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  6.699562072753906e-05
----------------------check_connections_block total spend ----------------------------- 0.0013473033905029297
generate_one_block  0.001260995864868164
generate_one_block  0.00109100341796875
generate_one_block  0.0010745525360107422
generate_one_block  0.0010843276977539062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005092620849609375
gen group dst list time:  4.1961669921875e-05
time for parepare:  0.0001461505889892578
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.00045990943908691406
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0004417896270751953
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.00035572052001953125
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0003809928894042969
----------------------check_connections_block total spend ----------------------------- 0.0032939910888671875
generate_one_block  0.0016627311706542969
generate_one_block  0.0016334056854248047
generate_one_block  0.0014781951904296875
generate_one_block  0.0014767646789550781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005714893341064453
gen group dst list time:  8.916854858398438e-05
time for parepare:  0.00017881393432617188
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.0002899169921875
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0014081001281738281
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.00017023086547851562
r_  generation:  0.0023109912872314453
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.00011444091796875
r_  generation:  0.0010230541229248047
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  0.00012612342834472656
r_  generation:  0.0012128353118896484
----------------------check_connections_block total spend ----------------------------- 0.009146690368652344
generate_one_block  0.0027539730072021484
generate_one_block  0.0025475025177001953
generate_one_block  0.0023627281188964844
generate_one_block  0.002488374710083008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.2628798484802246  GigaBytes
Max Memory Allocated: 0.6187748908996582  GigaBytes

connection checking time:  0.012440681457519531
block generation total time  0.016403675079345703
average batch blocks generation time:  0.004100918769836426
block dataloader generation time/epoch 0.06093788146972656
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.26310253143310547  GigaBytes
Max Memory Allocated: 0.6187748908996582  GigaBytes

torch.Size([1687, 1433])
torch.Size([877, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.6635861396789551  GigaBytes
Max Memory Allocated: 0.6903605461120605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9998779296875 GB
    Memory Allocated: 0.26263952255249023  GigaBytes
Max Memory Allocated: 0.776115894317627  GigaBytes

torch.Size([1601, 1433])
torch.Size([815, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9998779296875 GB
    Memory Allocated: 0.6221742630004883  GigaBytes
Max Memory Allocated: 0.776115894317627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9998779296875 GB
    Memory Allocated: 0.2613978385925293  GigaBytes
Max Memory Allocated: 0.776115894317627  GigaBytes

torch.Size([1370, 1433])
torch.Size([616, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9998779296875 GB
    Memory Allocated: 0.5479955673217773  GigaBytes
Max Memory Allocated: 0.776115894317627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9998779296875 GB
    Memory Allocated: 0.2624506950378418  GigaBytes
Max Memory Allocated: 0.776115894317627  GigaBytes

torch.Size([1566, 1433])
torch.Size([722, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9998779296875 GB
    Memory Allocated: 0.6057558059692383  GigaBytes
Max Memory Allocated: 0.776115894317627  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.045041561126708984 |0.0005968809127807617 |0.17494142055511475 |0.00012767314910888672 |0.3974790573120117 |0.009283304214477539 |
----------------------------------------------------------pseudo_mini_loss sum 2.306952953338623
Total (block generation + training)time/epoch 2.6056125164031982
Training time/epoch 2.544351577758789
Training time without block to device /epoch 2.541964054107666
Training time without total dataloading part /epoch 2.299475908279419
load block tensor time/epoch 0.18016624450683594
block to device time/epoch 0.002387523651123047
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9989
Number of first layer input nodes during this epoch:  6224
