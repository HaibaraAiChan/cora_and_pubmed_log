main start at this time 1648428857.920318
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001569986343383789
random selection method range initialization spend 0.00021123886108398438
time for parepare:  7.43865966796875e-05
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.004270792007446289
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0001323223114013672
----------------------check_connections_block total spend ----------------------------- 0.0052225589752197266
generate_one_block  0.0016486644744873047
generate_one_block  0.0013966560363769531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005831718444824219
gen group dst list time:  3.528594970703125e-05
time for parepare:  0.0001761913299560547
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00026154518127441406
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0008521080017089844
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0008711814880371094
----------------------check_connections_block total spend ----------------------------- 0.0031173229217529297
generate_one_block  0.002298593521118164
generate_one_block  0.0022916793823242188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006880760192871094
gen group dst list time:  7.295608520507812e-05
time for parepare:  0.0002193450927734375
local_output_nid generation:  9.942054748535156e-05
local_in_edges_tensor generation:  0.0004067420959472656
mini_batch_src_global generation:  0.0001938343048095703
r_  generation:  0.0021431446075439453
local_output_nid generation:  0.00012373924255371094
local_in_edges_tensor generation:  0.0003197193145751953
mini_batch_src_global generation:  0.00022363662719726562
r_  generation:  0.0022988319396972656
----------------------check_connections_block total spend ----------------------------- 0.007117748260498047
generate_one_block  0.003631114959716797
generate_one_block  0.003560781478881836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.010235071182250977
block generation total time  0.011782169342041016
average batch blocks generation time:  0.005891084671020508
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07299995422363281  GigaBytes
Max Memory Allocated: 0.07299995422363281  GigaBytes

torch.Size([1910, 1433])
torch.Size([1183, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.5538134574890137  GigaBytes
Max Memory Allocated: 0.5923104286193848  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.13633346557617188  GigaBytes
Max Memory Allocated: 0.6669416427612305  GigaBytes

torch.Size([2021, 1433])
torch.Size([1246, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.6492481231689453  GigaBytes
Max Memory Allocated: 0.6902470588684082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03891432285308838 |0.1736290454864502 |0.3917076587677002 |0.00018358230590820312 |0.22438418865203857 |0.010022878646850586 |
----------------------------------------------------------pseudo_mini_loss sum 2.6403446197509766
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7063
Number of first layer input nodes during this epoch:  3931
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0760498046875 GB
    Memory Allocated: 0.2619037628173828  GigaBytes
Max Memory Allocated: 0.7619743347167969  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00048470497131347656
random selection method range initialization spend 0.00011086463928222656
time for parepare:  6.985664367675781e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00014400482177734375
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00011682510375976562
----------------------check_connections_block total spend ----------------------------- 0.0009179115295410156
generate_one_block  0.0012998580932617188
generate_one_block  0.0012230873107910156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005147457122802734
gen group dst list time:  3.24249267578125e-05
time for parepare:  0.0001552104949951172
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  9.989738464355469e-05
r_  generation:  0.0007834434509277344
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  0.0002262592315673828
r_  generation:  0.0006725788116455078
----------------------check_connections_block total spend ----------------------------- 0.002839803695678711
generate_one_block  0.0020978450775146484
generate_one_block  0.0018754005432128906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005834102630615234
gen group dst list time:  6.151199340820312e-05
time for parepare:  0.00020432472229003906
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.00034332275390625
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.001986980438232422
local_output_nid generation:  9.560585021972656e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  0.0001971721649169922
r_  generation:  0.0016968250274658203
----------------------check_connections_block total spend ----------------------------- 0.005892038345336914
generate_one_block  0.003577709197998047
generate_one_block  0.003078460693359375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0760498046875 GB
    Memory Allocated: 0.2619037628173828  GigaBytes
Max Memory Allocated: 0.7619743347167969  GigaBytes

connection checking time:  0.008731842041015625
block generation total time  0.010629415512084961
average batch blocks generation time:  0.0053147077560424805
block dataloader generation time/epoch 0.038947343826293945
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0760498046875 GB
    Memory Allocated: 0.2627382278442383  GigaBytes
Max Memory Allocated: 0.7619743347167969  GigaBytes
Using backend: pytorch

torch.Size([2029, 1433])
torch.Size([1304, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0760498046875 GB
    Memory Allocated: 0.7921695709228516  GigaBytes
Max Memory Allocated: 0.8351821899414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.26105690002441406  GigaBytes
Max Memory Allocated: 0.9035024642944336  GigaBytes

torch.Size([1882, 1433])
torch.Size([1076, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1424560546875 GB
    Memory Allocated: 0.7081985473632812  GigaBytes
Max Memory Allocated: 0.9035024642944336  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03566610813140869 |0.0005321502685546875 |0.15631675720214844 |0.00013208389282226562 |0.2221313714981079 |0.010388374328613281 |
----------------------------------------------------------pseudo_mini_loss sum 2.281712293624878
Total (block generation + training)time/epoch 0.9387359619140625
Training time/epoch 0.8992431163787842
Training time without block to device /epoch 0.8981788158416748
Training time without total dataloading part /epoch 0.7675487995147705
load block tensor time/epoch 0.07133221626281738
block to device time/epoch 0.001064300537109375
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6996
Number of first layer input nodes during this epoch:  3911
