main start at this time 1648428763.1297143
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013225078582763672
random selection method range initialization spend 0.00019431114196777344
time for parepare:  6.4849853515625e-05
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.002529621124267578
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.462501525878906e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.745887756347656e-05
----------------------check_connections_block total spend ----------------------------- 0.003800630569458008
generate_one_block  0.0015106201171875
generate_one_block  0.0011103153228759766
generate_one_block  0.0011065006256103516
generate_one_block  0.0010917186737060547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004992485046386719
gen group dst list time:  4.00543212890625e-05
time for parepare:  0.00013756752014160156
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0003886222839355469
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004444122314453125
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00043272972106933594
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00037217140197753906
----------------------check_connections_block total spend ----------------------------- 0.0032219886779785156
generate_one_block  0.001493692398071289
generate_one_block  0.0015530586242675781
generate_one_block  0.001522064208984375
generate_one_block  0.0014603137969970703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00057220458984375
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.0001773834228515625
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00026416778564453125
mini_batch_src_global generation:  9.417533874511719e-05
r_  generation:  0.00101470947265625
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.000156402587890625
r_  generation:  0.0012974739074707031
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  0.0001361370086669922
r_  generation:  0.0012841224670410156
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0011174678802490234
----------------------check_connections_block total spend ----------------------------- 0.0077037811279296875
generate_one_block  0.0023374557495117188
generate_one_block  0.002530336380004883
generate_one_block  0.002588987350463867
generate_one_block  0.002177000045776367
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.010925769805908203
block generation total time  0.01566290855407715
average batch blocks generation time:  0.003915727138519287
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06975173950195312  GigaBytes
Max Memory Allocated: 0.06975173950195312  GigaBytes

torch.Size([1307, 1433])
torch.Size([616, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5506591796875 GB
    Memory Allocated: 0.33752870559692383  GigaBytes
Max Memory Allocated: 0.3598747253417969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6756591796875 GB
    Memory Allocated: 0.133453369140625  GigaBytes
Max Memory Allocated: 0.456052303314209  GigaBytes

torch.Size([1486, 1433])
torch.Size([785, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.46944665908813477  GigaBytes
Max Memory Allocated: 0.49668407440185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.13402366638183594  GigaBytes
Max Memory Allocated: 0.5864048004150391  GigaBytes

torch.Size([1593, 1433])
torch.Size([742, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.4671645164489746  GigaBytes
Max Memory Allocated: 0.5864048004150391  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.13315916061401367  GigaBytes
Max Memory Allocated: 0.5864048004150391  GigaBytes

torch.Size([1432, 1433])
torch.Size([673, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.42177867889404297  GigaBytes
Max Memory Allocated: 0.5864048004150391  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04759186506271362 |0.08595597743988037 |0.2270323634147644 |0.00014466047286987305 |0.15262115001678467 |0.01340341567993164 |
----------------------------------------------------------pseudo_mini_loss sum 2.5961196422576904
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9373
Number of first layer input nodes during this epoch:  5818
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.25868654251098633  GigaBytes
Max Memory Allocated: 0.5864048004150391  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004990100860595703
random selection method range initialization spend 0.00012564659118652344
time for parepare:  6.890296936035156e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  8.130073547363281e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011181831359863281Using backend: pytorch

mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  8.130073547363281e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  6.556510925292969e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.151199340820312e-05
----------------------check_connections_block total spend ----------------------------- 0.0014417171478271484
generate_one_block  0.0012373924255371094
generate_one_block  0.0011606216430664062
generate_one_block  0.0011191368103027344
generate_one_block  0.0011074542999267578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005254745483398438
gen group dst list time:  4.124641418457031e-05
time for parepare:  0.00014781951904296875
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0003864765167236328
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0004658699035644531
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00042700767517089844
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0003407001495361328
----------------------check_connections_block total spend ----------------------------- 0.003253459930419922
generate_one_block  0.001539468765258789
generate_one_block  0.0016028881072998047
generate_one_block  0.0016019344329833984
generate_one_block  0.0014050006866455078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005578994750976562
gen group dst list time:  8.487701416015625e-05
time for parepare:  0.0002124309539794922
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.0002810955047607422
mini_batch_src_global generation:  9.894371032714844e-05
r_  generation:  0.0011439323425292969
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  0.00014400482177734375
r_  generation:  0.0012950897216796875
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.00013399124145507812
r_  generation:  0.0012753009796142578
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.001001596450805664
----------------------check_connections_block total spend ----------------------------- 0.007801532745361328
generate_one_block  0.0024576187133789062
generate_one_block  0.003187894821166992
generate_one_block  0.002645254135131836
generate_one_block  0.0021529197692871094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.25868654251098633  GigaBytes
Max Memory Allocated: 0.5864048004150391  GigaBytes

connection checking time:  0.01105499267578125
block generation total time  0.016592979431152344
average batch blocks generation time:  0.004148244857788086
block dataloader generation time/epoch 0.05311083793640137
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.259490966796875  GigaBytes
Max Memory Allocated: 0.5864048004150391  GigaBytes

torch.Size([1431, 1433])
torch.Size([664, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.5531754493713379  GigaBytes
Max Memory Allocated: 0.5864048004150391  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.2600669860839844  GigaBytes
Max Memory Allocated: 0.6709027290344238  GigaBytes

torch.Size([1550, 1433])
torch.Size([795, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.5982980728149414  GigaBytes
Max Memory Allocated: 0.6709027290344238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.25949573516845703  GigaBytes
Max Memory Allocated: 0.7153429985046387  GigaBytes

torch.Size([1517, 1433])
torch.Size([734, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.5805730819702148  GigaBytes
Max Memory Allocated: 0.7153429985046387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.25824832916259766  GigaBytes
Max Memory Allocated: 0.7153429985046387  GigaBytes

torch.Size([1361, 1433])
torch.Size([569, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.5170021057128906  GigaBytes
Max Memory Allocated: 0.7153429985046387  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046343445777893066 |0.00041347742080688477 |0.11299645900726318 |0.00011837482452392578 |0.1660597324371338 |0.010662317276000977 |
----------------------------------------------------------pseudo_mini_loss sum 2.2602319717407227
Total (block generation + training)time/epoch 1.4237754344940186
Training time/epoch 1.3703691959381104
Training time without block to device /epoch 1.3687152862548828
Training time without total dataloading part /epoch 1.1273605823516846
load block tensor time/epoch 0.18537378311157227
block to device time/epoch 0.001653909683227539
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9358
Number of first layer input nodes during this epoch:  5859
