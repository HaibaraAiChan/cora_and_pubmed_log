main start at this time 1648428805.518259
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012798309326171875
random selection method range initialization spend 0.00023126602172851562
time for parepare:  7.653236389160156e-05
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.0002684593200683594
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.004209756851196289
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0001366138458251953
----------------------check_connections_block total spend ----------------------------- 0.005219459533691406
generate_one_block  0.001739501953125
generate_one_block  0.0014312267303466797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005934238433837891
gen group dst list time:  3.6716461181640625e-05
time for parepare:  0.00017023086547851562
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0002846717834472656
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0008351802825927734
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.0008389949798583984
----------------------check_connections_block total spend ----------------------------- 0.003084421157836914
generate_one_block  0.002252817153930664
generate_one_block  0.0022840499877929688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007071495056152344
gen group dst list time:  7.43865966796875e-05
time for parepare:  0.0002124309539794922
local_output_nid generation:  9.679794311523438e-05
local_in_edges_tensor generation:  0.00040030479431152344
mini_batch_src_global generation:  0.00017833709716796875
r_  generation:  0.002099752426147461
local_output_nid generation:  0.00011992454528808594
local_in_edges_tensor generation:  0.0003139972686767578
mini_batch_src_global generation:  0.0002281665802001953
r_  generation:  0.0022203922271728516
----------------------check_connections_block total spend ----------------------------- 0.006954193115234375
generate_one_block  0.0036172866821289062
generate_one_block  0.003629922866821289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.010038614273071289
block generation total time  0.011784076690673828
average batch blocks generation time:  0.005892038345336914
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07262229919433594  GigaBytes
Max Memory Allocated: 0.07262229919433594  GigaBytes

torch.Size([1840, 1433])
torch.Size([1109, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7635498046875 GB
    Memory Allocated: 0.5290818214416504  GigaBytes
Max Memory Allocated: 0.5659584999084473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.13596677780151367  GigaBytes
Max Memory Allocated: 0.6432099342346191  GigaBytes

torch.Size([1953, 1433])
torch.Size([1163, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.6197781562805176  GigaBytes
Max Memory Allocated: 0.6587963104248047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037304043769836426 |0.17390811443328857 |0.3714190721511841 |0.00019538402557373047 |0.18848633766174316 |0.011017084121704102 |
----------------------------------------------------------pseudo_mini_loss sum 2.629909038543701
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6768
Number of first layer input nodes during this epoch:  3793
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0760498046875 GB
    Memory Allocated: 0.2615323066711426  GigaBytes
Max Memory Allocated: 0.7332978248596191  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004901885986328125
random selection method range initialization spend 0.00010895729064941406
time for parepare:  6.794929504394531e-05
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0001513957977294922
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00012040138244628906
----------------------check_connections_block total spend ----------------------------- 0.0009386539459228516
generate_one_block  0.0013065338134765625
generate_one_block  0.0011966228485107422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005075931549072266
gen group dst list time:  3.266334533691406e-05
time for parepare:  0.000156402587890625
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00024127960205078125
mini_batch_src_global generation:  9.512901306152344e-05
r_  generation:  0.0007696151733398438
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  9.989738464355469e-05
r_  generation:  0.0006551742553710938
----------------------check_connections_block total spend ----------------------------- 0.0026628971099853516
generate_one_block  0.0020554065704345703
generate_one_block  0.0018146038055419922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005791187286376953
gen group dst list time:  6.127357482910156e-05
time for parepare:  0.00018525123596191406
local_output_nid generation:  9.72747802734375e-05
local_in_edges_tensor generation:  0.0003657341003417969
mini_batch_src_global generation:  0.00016117095947265625
r_  generation:  0.0019385814666748047
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.0002391338348388672
mini_batch_src_global generation:  0.00021409988403320312
r_  generation:  0.001682281494140625
----------------------check_connections_block total spend ----------------------------- 0.005888700485229492
generate_one_block  0.0033109188079833984
generate_one_block  0.0029544830322265625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0760498046875 GB
    Memory Allocated: 0.2615323066711426  GigaBytes
Max Memory Allocated: 0.7332978248596191  GigaBytes

connection checking time:  0.008551597595214844
block generation total time  0.010135412216186523
average batch blocks generation time:  0.005067706108093262
block dataloader generation time/epoch 0.03380870819091797
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0760498046875 GB
    Memory Allocated: 0.26155996322631836  GigaBytes
Max Memory Allocated: 0.7332978248596191  GigaBytes
Using backend: pytorch

torch.Size([1975, 1433])
torch.Size([1235, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1092529296875 GB
    Memory Allocated: 0.7666501998901367  GigaBytes
Max Memory Allocated: 0.8076629638671875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1092529296875 GB
    Memory Allocated: 0.2606163024902344  GigaBytes
Max Memory Allocated: 0.8796920776367188  GigaBytes

torch.Size([1800, 1433])
torch.Size([1003, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1131591796875 GB
    Memory Allocated: 0.6831765174865723  GigaBytes
Max Memory Allocated: 0.8796920776367188  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03504037857055664 |0.00043213367462158203 |0.13029742240905762 |0.0001266002655029297 |0.1813678741455078 |0.010529041290283203 |
----------------------------------------------------------pseudo_mini_loss sum 2.2625391483306885
Total (block generation + training)time/epoch 0.79750657081604
Training time/epoch 0.7632195949554443
Training time without block to device /epoch 0.7623553276062012
Training time without total dataloading part /epoch 0.6341128349304199
load block tensor time/epoch 0.07008075714111328
block to device time/epoch 0.0008642673492431641
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6718
Number of first layer input nodes during this epoch:  3775
