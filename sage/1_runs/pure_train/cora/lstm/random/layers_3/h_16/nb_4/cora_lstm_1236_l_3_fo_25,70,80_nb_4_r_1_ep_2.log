main start at this time 1648428868.8620222
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009806156158447266
random selection method range initialization spend 0.00016236305236816406
time for parepare:  6.198883056640625e-05
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0013158321380615234
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  7.581710815429688e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  5.53131103515625e-05
----------------------check_connections_block total spend ----------------------------- 0.002565622329711914
generate_one_block  0.0014371871948242188
generate_one_block  0.0010833740234375
generate_one_block  0.0011105537414550781
generate_one_block  0.0010852813720703125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00048351287841796875
gen group dst list time:  3.933906555175781e-05
time for parepare:  0.00013828277587890625
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0004057884216308594
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0004570484161376953
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.00045108795166015625
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00040411949157714844
----------------------check_connections_block total spend ----------------------------- 0.003320455551147461
generate_one_block  0.0014944076538085938
generate_one_block  0.0015964508056640625
generate_one_block  0.0015325546264648438
generate_one_block  0.001462697982788086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005927085876464844
gen group dst list time:  7.748603820800781e-05
time for parepare:  0.00017309188842773438
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.0002799034118652344
mini_batch_src_global generation:  0.00010037422180175781
r_  generation:  0.0010998249053955078
local_output_nid generation:  6.151199340820312e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  0.00014734268188476562
r_  generation:  0.0013804435729980469
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.0013086795806884766
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  0.0001220703125
r_  generation:  0.0012395381927490234
----------------------check_connections_block total spend ----------------------------- 0.008101224899291992
generate_one_block  0.0025696754455566406
generate_one_block  0.002625703811645508
generate_one_block  0.0025665760040283203
generate_one_block  0.0023009777069091797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.011421680450439453
block generation total time  0.016149044036865234
average batch blocks generation time:  0.004037261009216309
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07029914855957031  GigaBytes
Max Memory Allocated: 0.07029914855957031  GigaBytes

torch.Size([1409, 1433])
torch.Size([687, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.36275768280029297  GigaBytes
Max Memory Allocated: 0.38622045516967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.13398456573486328  GigaBytes
Max Memory Allocated: 0.48059940338134766  GigaBytes

torch.Size([1585, 1433])
torch.Size([849, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.49451160430908203  GigaBytes
Max Memory Allocated: 0.523322582244873  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8514404296875 GB
    Memory Allocated: 0.13435745239257812  GigaBytes
Max Memory Allocated: 0.610626220703125  GigaBytes

torch.Size([1655, 1433])
torch.Size([789, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8572998046875 GB
    Memory Allocated: 0.4857935905456543  GigaBytes
Max Memory Allocated: 0.610626220703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8572998046875 GB
    Memory Allocated: 0.13372802734375  GigaBytes
Max Memory Allocated: 0.610626220703125  GigaBytes

torch.Size([1538, 1433])
torch.Size([757, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8572998046875 GB
    Memory Allocated: 0.45055103302001953  GigaBytes
Max Memory Allocated: 0.610626220703125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04789376258850098 |0.08552610874176025 |0.24286311864852905 |0.0001468062400817871 |0.18869918584823608 |0.010644912719726562 |
----------------------------------------------------------pseudo_mini_loss sum 2.5916569232940674
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10008
Number of first layer input nodes during this epoch:  6187
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.2592592239379883  GigaBytes
Max Memory Allocated: 0.610626220703125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004961490631103516
random selection method range initialization spend 0.00012040138244628906
time for parepare:  6.747245788574219e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  8.106231689453125e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011324882507324219Using backend: pytorch

mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.008148193359375e-05
----------------------check_connections_block total spend ----------------------------- 0.001352548599243164
generate_one_block  0.0012938976287841797
generate_one_block  0.001142740249633789
generate_one_block  0.0010960102081298828
generate_one_block  0.001110076904296875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005259513854980469
gen group dst list time:  4.124641418457031e-05
time for parepare:  0.00015211105346679688
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0004115104675292969
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0004987716674804688
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0004532337188720703
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0012595653533935547
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0003509521484375
----------------------check_connections_block total spend ----------------------------- 0.004522085189819336
generate_one_block  0.0015637874603271484
generate_one_block  0.0017125606536865234
generate_one_block  0.0015881061553955078
generate_one_block  0.0014781951904296875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005843639373779297
gen group dst list time:  8.463859558105469e-05
time for parepare:  0.00019097328186035156
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.0002837181091308594
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.001184225082397461
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  0.00018453598022460938
r_  generation:  0.0014123916625976562
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  0.00014328956604003906
r_  generation:  0.0013239383697509766
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.0011048316955566406
----------------------check_connections_block total spend ----------------------------- 0.008211851119995117
generate_one_block  0.0025277137756347656
generate_one_block  0.002711057662963867
generate_one_block  0.0026633739471435547
generate_one_block  0.002220630645751953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.2592592239379883  GigaBytes
Max Memory Allocated: 0.610626220703125  GigaBytes

connection checking time:  0.012733936309814453
block generation total time  0.016465425491333008
average batch blocks generation time:  0.004116356372833252
block dataloader generation time/epoch 0.0562136173248291
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.25881052017211914  GigaBytes
Max Memory Allocated: 0.610626220703125  GigaBytes

torch.Size([1465, 1433])
torch.Size([716, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.5717291831970215  GigaBytes
Max Memory Allocated: 0.610626220703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.25970935821533203  GigaBytes
Max Memory Allocated: 0.6887898445129395  GigaBytes

torch.Size([1632, 1433])
torch.Size([867, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.6243185997009277  GigaBytes
Max Memory Allocated: 0.6887898445129395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.2594928741455078  GigaBytes
Max Memory Allocated: 0.7405080795288086  GigaBytes

torch.Size([1592, 1433])
torch.Size([801, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.6084909439086914  GigaBytes
Max Memory Allocated: 0.7405080795288086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.25862932205200195  GigaBytes
Max Memory Allocated: 0.7405080795288086  GigaBytes

torch.Size([1432, 1433])
torch.Size([621, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.5407962799072266  GigaBytes
Max Memory Allocated: 0.7405080795288086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.044921040534973145 |0.0004830360412597656 |0.12752509117126465 |0.00012189149856567383 |0.19412380456924438 |0.010263681411743164 |
----------------------------------------------------------pseudo_mini_loss sum 2.2534170150756836
Total (block generation + training)time/epoch 1.593571424484253
Training time/epoch 1.537062644958496
Training time without block to device /epoch 1.535130500793457
Training time without total dataloading part /epoch 1.297346830368042
load block tensor time/epoch 0.17968416213989258
block to device time/epoch 0.0019321441650390625
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9863
Number of first layer input nodes during this epoch:  6121
