main start at this time 1648428752.5238929
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009052753448486328
random selection method range initialization spend 0.0002200603485107422
time for parepare:  7.82012939453125e-05
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00023317337036132812
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00200653076171875
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00014162063598632812
----------------------check_connections_block total spend ----------------------------- 0.0029993057250976562
generate_one_block  0.0017430782318115234
generate_one_block  0.001476287841796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005919933319091797
gen group dst list time:  3.933906555175781e-05
time for parepare:  0.0001704692840576172
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00024890899658203125
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0008618831634521484
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.00010228157043457031
r_  generation:  0.0008721351623535156
----------------------check_connections_block total spend ----------------------------- 0.0031125545501708984
generate_one_block  0.0023107528686523438
generate_one_block  0.002362489700317383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006697177886962891
gen group dst list time:  7.390975952148438e-05
time for parepare:  0.00021839141845703125
local_output_nid generation:  9.942054748535156e-05
local_in_edges_tensor generation:  0.000362396240234375
mini_batch_src_global generation:  0.00017833709716796875
r_  generation:  0.002197265625
local_output_nid generation:  0.00011134147644042969
local_in_edges_tensor generation:  0.00030875205993652344
mini_batch_src_global generation:  0.00022554397583007812
r_  generation:  0.0023589134216308594
----------------------check_connections_block total spend ----------------------------- 0.007164716720581055
generate_one_block  0.0037109851837158203
generate_one_block  0.003760814666748047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.010277271270751953
block generation total time  0.012145042419433594
average batch blocks generation time:  0.006072521209716797
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07256364822387695  GigaBytes
Max Memory Allocated: 0.07256364822387695  GigaBytes

torch.Size([1829, 1433])
torch.Size([1100, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.5284552574157715  GigaBytes
Max Memory Allocated: 0.5650444030761719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.13606929779052734  GigaBytes
Max Memory Allocated: 0.6426329612731934  GigaBytes

torch.Size([1972, 1433])
torch.Size([1165, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.6239638328552246  GigaBytes
Max Memory Allocated: 0.6633448600769043  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03566563129425049 |0.17006754875183105 |0.3693113327026367 |0.00017750263214111328 |0.1857471466064453 |0.010978937149047852 |
----------------------------------------------------------pseudo_mini_loss sum 2.6315293312072754
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6769
Number of first layer input nodes during this epoch:  3801
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0643310546875 GB
    Memory Allocated: 0.26163578033447266  GigaBytes
Max Memory Allocated: 0.7374730110168457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004990100860595703
random selection method range initialization spend 0.00011348724365234375
time for parepare:  7.200241088867188e-05
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00014400482177734375
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00011992454528808594
----------------------check_connections_block total spend ----------------------------- 0.0009326934814453125
generate_one_block  0.001352071762084961
generate_one_block  0.0012462139129638672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005290508270263672
gen group dst list time:  3.170967102050781e-05
time for parepare:  0.00015783309936523438
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0002446174621582031
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.0008039474487304688
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0006611347198486328
----------------------check_connections_block total spend ----------------------------- 0.002780437469482422
generate_one_block  0.002124786376953125
generate_one_block  0.005998849868774414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007913112640380859
gen group dst list time:  9.202957153320312e-05
time for parepare:  0.0002942085266113281
local_output_nid generation:  0.0001614093780517578
local_in_edges_tensor generation:  0.0004448890686035156
mini_batch_src_global generation:  0.00022721290588378906
r_  generation:  0.0023276805877685547
local_output_nid generation:  9.751319885253906e-05
local_in_edges_tensor generation:  0.00023818016052246094
mini_batch_src_global generation:  0.00018334388732910156
r_  generation:  0.0017697811126708984
----------------------check_connections_block total spend ----------------------------- 0.006800174713134766
generate_one_block  0.0036432743072509766
generate_one_block  0.0030722618103027344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0643310546875 GB
    Memory Allocated: 0.26163578033447266  GigaBytes
Max Memory Allocated: 0.7374730110168457  GigaBytes

connection checking time:  0.009580612182617188
block generation total time  0.01483917236328125
average batch blocks generation time:  0.007419586181640625
block dataloader generation time/epoch 0.04044914245605469
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0643310546875 GB
    Memory Allocated: 0.2615494728088379  GigaBytes
Max Memory Allocated: 0.7374730110168457  GigaBytes
Using backend: pytorch

torch.Size([1973, 1433])
torch.Size([1235, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.7701659202575684  GigaBytes
Max Memory Allocated: 0.8111891746520996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.2607765197753906  GigaBytes
Max Memory Allocated: 0.8832182884216309  GigaBytes

torch.Size([1830, 1433])
torch.Size([1011, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1014404296875 GB
    Memory Allocated: 0.6860775947570801  GigaBytes
Max Memory Allocated: 0.8832182884216309  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03464400768280029 |0.0004411935806274414 |0.1333146095275879 |0.0001220703125 |0.18537890911102295 |0.010818004608154297 |
----------------------------------------------------------pseudo_mini_loss sum 2.260631799697876
Total (block generation + training)time/epoch 0.8177521228790283
Training time/epoch 0.7770657539367676
Training time without block to device /epoch 0.7761833667755127
Training time without total dataloading part /epoch 0.648449182510376
load block tensor time/epoch 0.06928801536560059
block to device time/epoch 0.0008823871612548828
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6754
Number of first layer input nodes during this epoch:  3803
