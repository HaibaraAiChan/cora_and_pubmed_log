main start at this time 1648428816.1603944
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001397848129272461
random selection method range initialization spend 0.0001919269561767578
time for parepare:  6.270408630371094e-05
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0021331310272216797
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.412101745605469e-05
----------------------check_connections_block total spend ----------------------------- 0.003353118896484375
generate_one_block  0.0013186931610107422
generate_one_block  0.0010809898376464844
generate_one_block  0.0010895729064941406
generate_one_block  0.001062631607055664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004870891571044922
gen group dst list time:  4.172325134277344e-05
time for parepare:  0.00013399124145507812
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00037407875061035156
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0004286766052246094
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0004208087921142578
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00035452842712402344
----------------------check_connections_block total spend ----------------------------- 0.003124237060546875
generate_one_block  0.0014581680297851562
generate_one_block  0.0015304088592529297
generate_one_block  0.001491546630859375
generate_one_block  0.0014257431030273438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005676746368408203
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.0001723766326904297
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.00026226043701171875
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0010025501251220703
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.0001506805419921875
r_  generation:  0.0012810230255126953
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  0.00013017654418945312
r_  generation:  0.0012614727020263672
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.00011491775512695312
r_  generation:  0.0010955333709716797
----------------------check_connections_block total spend ----------------------------- 0.007555246353149414
generate_one_block  0.002666950225830078
generate_one_block  0.0024652481079101562
generate_one_block  0.0025153160095214844
generate_one_block  0.002166271209716797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.010679483413696289
block generation total time  0.01571965217590332
average batch blocks generation time:  0.00392991304397583
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06978368759155273  GigaBytes
Max Memory Allocated: 0.06978368759155273  GigaBytes

torch.Size([1313, 1433])
torch.Size([620, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5545654296875 GB
    Memory Allocated: 0.3399643898010254  GigaBytes
Max Memory Allocated: 0.3623523712158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6795654296875 GB
    Memory Allocated: 0.13340520858764648  GigaBytes
Max Memory Allocated: 0.4584650993347168  GigaBytes

torch.Size([1477, 1433])
torch.Size([776, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.46748971939086914  GigaBytes
Max Memory Allocated: 0.49441957473754883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.13402366638183594  GigaBytes
Max Memory Allocated: 0.5844988822937012  GigaBytes

torch.Size([1593, 1433])
torch.Size([743, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.46979379653930664  GigaBytes
Max Memory Allocated: 0.5844988822937012  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.13311100006103516  GigaBytes
Max Memory Allocated: 0.5869827270507812  GigaBytes

torch.Size([1423, 1433])
torch.Size([667, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.4225349426269531  GigaBytes
Max Memory Allocated: 0.5869827270507812  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.047794878482818604 |0.08646589517593384 |0.2307179570198059 |0.00014346837997436523 |0.15509694814682007 |0.012957334518432617 |
----------------------------------------------------------pseudo_mini_loss sum 2.594398260116577
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9351
Number of first layer input nodes during this epoch:  5806
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.2586383819580078  GigaBytes
Max Memory Allocated: 0.5869827270507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004889965057373047
random selection method range initialization spend 0.00011897087097167969
time for parepare:  6.699562072753906e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  8.106231689453125e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010991096496582031Using backend: pytorch

mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  7.82012939453125e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.031990051269531e-05
----------------------check_connections_block total spend ----------------------------- 0.0013208389282226562
generate_one_block  0.0011909008026123047
generate_one_block  0.0011050701141357422
generate_one_block  0.0010802745819091797
generate_one_block  0.0010704994201660156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004990100860595703
gen group dst list time:  4.315376281738281e-05
time for parepare:  0.0001468658447265625
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00039124488830566406
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.00046634674072265625
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.00042366981506347656
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0003268718719482422
----------------------check_connections_block total spend ----------------------------- 0.003207683563232422
generate_one_block  0.0015034675598144531
generate_one_block  0.0015778541564941406
generate_one_block  0.0015168190002441406
generate_one_block  0.0014019012451171875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005567073822021484
gen group dst list time:  8.749961853027344e-05
time for parepare:  0.00018739700317382812
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0002713203430175781
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.0011327266693115234
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.00022745132446289062
mini_batch_src_global generation:  0.00017833709716796875
r_  generation:  0.0013015270233154297
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.0001316070556640625
r_  generation:  0.0012102127075195312
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.0013394355773925781
mini_batch_src_global generation:  0.00011754035949707031
r_  generation:  0.0010075569152832031
----------------------check_connections_block total spend ----------------------------- 0.008877277374267578
generate_one_block  0.002489328384399414
generate_one_block  0.0031821727752685547
generate_one_block  0.0025238990783691406
generate_one_block  0.0020961761474609375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.2586383819580078  GigaBytes
Max Memory Allocated: 0.5869827270507812  GigaBytes

connection checking time:  0.0120849609375
block generation total time  0.01629161834716797
average batch blocks generation time:  0.004072904586791992
block dataloader generation time/epoch 0.051971435546875
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.2585148811340332  GigaBytes
Max Memory Allocated: 0.5869827270507812  GigaBytes

torch.Size([1410, 1433])
torch.Size([669, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.5530328750610352  GigaBytes
Max Memory Allocated: 0.5869827270507812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.25920915603637695  GigaBytes
Max Memory Allocated: 0.6707320213317871  GigaBytes

torch.Size([1539, 1433])
torch.Size([798, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.6007752418518066  GigaBytes
Max Memory Allocated: 0.6707320213317871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.25887012481689453  GigaBytes
Max Memory Allocated: 0.7178044319152832  GigaBytes

torch.Size([1476, 1433])
torch.Size([727, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.5755367279052734  GigaBytes
Max Memory Allocated: 0.7178044319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.2581472396850586  GigaBytes
Max Memory Allocated: 0.7178044319152832  GigaBytes

torch.Size([1342, 1433])
torch.Size([568, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.5165691375732422  GigaBytes
Max Memory Allocated: 0.7178044319152832  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04659146070480347 |0.00041615962982177734 |0.11099117994308472 |0.00011491775512695312 |0.1579243540763855 |0.01145792007446289 |
----------------------------------------------------------pseudo_mini_loss sum 2.1916913986206055
Total (block generation + training)time/epoch 1.3842644691467285
Training time/epoch 1.3319549560546875
Training time without block to device /epoch 1.3302903175354004
Training time without total dataloading part /epoch 1.0875797271728516
load block tensor time/epoch 0.18636584281921387
block to device time/epoch 0.0016646385192871094
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9266
Number of first layer input nodes during this epoch:  5767
