main start at this time 1648428912.6147738
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012912750244140625
random selection method range initialization spend 0.0001995563507080078
time for parepare:  6.747245788574219e-05
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.002471923828125
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0001239776611328125
----------------------check_connections_block total spend ----------------------------- 0.0033168792724609375
generate_one_block  0.0019490718841552734
generate_one_block  0.0013399124145507812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005202293395996094
gen group dst list time:  3.0279159545898438e-05
time for parepare:  0.0001468658447265625
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0007536411285400391
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.0007622241973876953
----------------------check_connections_block total spend ----------------------------- 0.00270843505859375
generate_one_block  0.0020673274993896484
generate_one_block  0.0021088123321533203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005908012390136719
gen group dst list time:  6.175041198730469e-05
time for parepare:  0.000186920166015625
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.00032138824462890625
mini_batch_src_global generation:  0.00016641616821289062
r_  generation:  0.0019347667694091797
local_output_nid generation:  9.131431579589844e-05
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  0.0002086162567138672
r_  generation:  0.00205230712890625
----------------------check_connections_block total spend ----------------------------- 0.006264925003051758
generate_one_block  0.0032656192779541016
generate_one_block  0.0035104751586914062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.008973360061645508
block generation total time  0.010952234268188477
average batch blocks generation time:  0.005476117134094238
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07298469543457031  GigaBytes
Max Memory Allocated: 0.07298469543457031  GigaBytes

torch.Size([1907, 1433])
torch.Size([1179, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.5667495727539062  GigaBytes
Max Memory Allocated: 0.6067924499511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9022216796875 GB
    Memory Allocated: 0.13639307022094727  GigaBytes
Max Memory Allocated: 0.6813726425170898  GigaBytes

torch.Size([2032, 1433])
torch.Size([1247, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.6619992256164551  GigaBytes
Max Memory Allocated: 0.7047195434570312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03575742244720459 |0.17219758033752441 |0.4487333297729492 |0.00019025802612304688 |0.44296765327453613 |0.009378910064697266 |
----------------------------------------------------------pseudo_mini_loss sum 2.63753080368042
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7068
Number of first layer input nodes during this epoch:  3939
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.2619643211364746  GigaBytes
Max Memory Allocated: 0.7754092216491699  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000598907470703125
random selection method range initialization spend 0.00014019012451171875
time for parepare:  9.489059448242188e-05
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00017690658569335938
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0001480579376220703
----------------------check_connections_block total spend ----------------------------- 0.0011188983917236328
generate_one_block  0.0015914440155029297
generate_one_block  0.0014731884002685547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006079673767089844
gen group dst list time:  4.100799560546875e-05
time for parepare:  0.00019621849060058594
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.0002741813659667969
mini_batch_src_global generation:  0.000110626220703125
r_  generation:  0.0009770393371582031
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  0.00013875961303710938
r_  generation:  0.0008516311645507812
----------------------check_connections_block total spend ----------------------------- 0.0033919811248779297
generate_one_block  0.0027704238891601562
generate_one_block  0.002306699752807617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006957054138183594
gen group dst list time:  8.749961853027344e-05
time for parepare:  0.0002627372741699219
local_output_nid generation:  0.00014543533325195312
local_in_edges_tensor generation:  0.00042366981506347656
mini_batch_src_global generation:  0.00023818016052246094
r_  generation:  0.0025930404663085938
local_output_nid generation:  0.0001227855682373047
local_in_edges_tensor generation:  0.00030231475830078125
mini_batch_src_global generation:  0.00029969215393066406
r_  generation:  0.0022373199462890625
----------------------check_connections_block total spend ----------------------------- 0.007883310317993164
generate_one_block  0.004402637481689453
generate_one_block  0.0035991668701171875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.2619643211364746  GigaBytes
Max Memory Allocated: 0.7754092216491699  GigaBytes

connection checking time:  0.011275291442871094
block generation total time  0.013078927993774414
average batch blocks generation time:  0.006539463996887207
block dataloader generation time/epoch 0.04709196090698242
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.2627401351928711  GigaBytes
Max Memory Allocated: 0.7754092216491699  GigaBytes
Using backend: pytorch

torch.Size([2036, 1433])
torch.Size([1302, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1268310546875 GB
    Memory Allocated: 0.8097901344299316  GigaBytes
Max Memory Allocated: 0.8532886505126953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1580810546875 GB
    Memory Allocated: 0.2612137794494629  GigaBytes
Max Memory Allocated: 0.9219565391540527  GigaBytes

torch.Size([1911, 1433])
torch.Size([1078, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.7305154800415039  GigaBytes
Max Memory Allocated: 0.9219565391540527  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03255724906921387 |0.0005782842636108398 |0.21368646621704102 |0.00017142295837402344 |0.44499099254608154 |0.006319761276245117 |
----------------------------------------------------------pseudo_mini_loss sum 2.2629058361053467
Total (block generation + training)time/epoch 1.497387170791626
Training time/epoch 1.4499845504760742
Training time without block to device /epoch 1.4488279819488525
Training time without total dataloading part /epoch 1.3240175247192383
load block tensor time/epoch 0.06511449813842773
block to device time/epoch 0.0011565685272216797
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7032
Number of first layer input nodes during this epoch:  3947
