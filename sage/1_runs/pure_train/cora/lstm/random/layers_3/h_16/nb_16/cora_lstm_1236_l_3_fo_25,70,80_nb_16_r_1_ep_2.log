main start at this time 1648428895.3566291
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013322830200195312
random selection method range initialization spend 0.0002276897430419922
time for parepare:  6.628036499023438e-05
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0035202503204345703
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5497207641601562e-05
----------------------check_connections_block total spend ----------------------------- 0.0067577362060546875
generate_one_block  0.001478433609008789
generate_one_block  0.0011241436004638672
generate_one_block  0.0010638236999511719
generate_one_block  0.0010695457458496094
generate_one_block  0.0010416507720947266
generate_one_block  0.001043081283569336
generate_one_block  0.0010564327239990234
generate_one_block  0.0010662078857421875
generate_one_block  0.0010731220245361328
generate_one_block  0.0011000633239746094
generate_one_block  0.0010788440704345703
generate_one_block  0.0009622573852539062
generate_one_block  0.0009653568267822266
generate_one_block  0.0009672641754150391
generate_one_block  0.0009849071502685547
generate_one_block  0.0009562969207763672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005910396575927734
gen group dst list time:  9.512901306152344e-05
time for parepare:  0.00014662742614746094
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.000213623046875
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00012040138244628906
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  9.72747802734375e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00019359588623046875
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00011658668518066406
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00014281272888183594
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00016546249389648438
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00013947486877441406
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001990795135498047
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00017404556274414062
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00012755393981933594
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00012373924255371094
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.942054748535156e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00010895729064941406
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00019097328186035156
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.198883056640625e-05
----------------------check_connections_block total spend ----------------------------- 0.006072521209716797
generate_one_block  0.0013647079467773438
generate_one_block  0.0011749267578125
generate_one_block  0.0011448860168457031
generate_one_block  0.0012717247009277344
generate_one_block  0.001180887222290039
generate_one_block  0.0012171268463134766
generate_one_block  0.001232147216796875
generate_one_block  0.0012447834014892578
generate_one_block  0.001233816146850586
generate_one_block  0.0011355876922607422
generate_one_block  0.0010819435119628906
generate_one_block  0.001092672348022461
generate_one_block  0.0010447502136230469
generate_one_block  0.001056671142578125
generate_one_block  0.0011692047119140625
generate_one_block  0.0010306835174560547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007252693176269531
gen group dst list time:  0.00017142295837402344
time for parepare:  0.00022363662719726562
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0007078647613525391
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0004851818084716797
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0003027915954589844
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0006124973297119141
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0004875659942626953
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0005021095275878906
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0006155967712402344
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0004723072052001953
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0006041526794433594
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0006613731384277344
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0005173683166503906
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0005118846893310547
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.00033664703369140625
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0003066062927246094
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0007185935974121094
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.0001842975616455078
----------------------check_connections_block total spend ----------------------------- 0.014550924301147461
generate_one_block  0.0019080638885498047
generate_one_block  0.0016181468963623047
generate_one_block  0.0013573169708251953
generate_one_block  0.001607656478881836
generate_one_block  0.0014739036560058594
generate_one_block  0.0017268657684326172
generate_one_block  0.001634359359741211
generate_one_block  0.0014376640319824219
generate_one_block  0.0015740394592285156
generate_one_block  0.0016758441925048828
generate_one_block  0.001537322998046875
generate_one_block  0.0015439987182617188
generate_one_block  0.0013000965118408203
generate_one_block  0.001268625259399414
generate_one_block  0.0018320083618164062
generate_one_block  0.0019426345825195312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.020623445510864258
block generation total time  0.04411506652832031
average batch blocks generation time:  0.0027571916580200195
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06795072555541992  GigaBytes
Max Memory Allocated: 0.06795072555541992  GigaBytes

torch.Size([972, 1433])
torch.Size([356, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.24835538864135742  GigaBytes
Max Memory Allocated: 0.26243114471435547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.12913846969604492  GigaBytes
Max Memory Allocated: 0.36914539337158203  GigaBytes

torch.Size([683, 1433])
torch.Size([245, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.2465991973876953  GigaBytes
Max Memory Allocated: 0.36914539337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.12798070907592773  GigaBytes
Max Memory Allocated: 0.36914539337158203  GigaBytes

torch.Size([467, 1433])
torch.Size([147, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.19725799560546875  GigaBytes
Max Memory Allocated: 0.36914539337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.12959671020507812  GigaBytes
Max Memory Allocated: 0.36914539337158203  GigaBytes

torch.Size([768, 1433])
torch.Size([341, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.28197479248046875  GigaBytes
Max Memory Allocated: 0.36914539337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.12959766387939453  GigaBytes
Max Memory Allocated: 0.4028196334838867  GigaBytes

torch.Size([769, 1433])
torch.Size([252, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.24922418594360352  GigaBytes
Max Memory Allocated: 0.4028196334838867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.12891626358032227  GigaBytes
Max Memory Allocated: 0.4028196334838867  GigaBytes

torch.Size([641, 1433])
torch.Size([261, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.25124502182006836  GigaBytes
Max Memory Allocated: 0.4028196334838867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.1299281120300293  GigaBytes
Max Memory Allocated: 0.4028196334838867  GigaBytes

torch.Size([830, 1433])
torch.Size([329, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2855648994445801  GigaBytes
Max Memory Allocated: 0.4028196334838867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.12918663024902344  GigaBytes
Max Memory Allocated: 0.4069070816040039  GigaBytes

torch.Size([692, 1433])
torch.Size([259, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.24440670013427734  GigaBytes
Max Memory Allocated: 0.4069070816040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.130157470703125  GigaBytes
Max Memory Allocated: 0.4069070816040039  GigaBytes

torch.Size([873, 1433])
torch.Size([311, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.28069639205932617  GigaBytes
Max Memory Allocated: 0.4069070816040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13042545318603516  GigaBytes
Max Memory Allocated: 0.4069070816040039  GigaBytes

torch.Size([923, 1433])
torch.Size([344, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.29622316360473633  GigaBytes
Max Memory Allocated: 0.4069070816040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13015365600585938  GigaBytes
Max Memory Allocated: 0.41742372512817383  GigaBytes

torch.Size([766, 1433])
torch.Size([266, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2565937042236328  GigaBytes
Max Memory Allocated: 0.41742372512817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.12964630126953125  GigaBytes
Max Memory Allocated: 0.41742372512817383  GigaBytes

torch.Size([778, 1433])
torch.Size([267, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2560997009277344  GigaBytes
Max Memory Allocated: 0.41742372512817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.12818431854248047  GigaBytes
Max Memory Allocated: 0.41742372512817383  GigaBytes

torch.Size([505, 1433])
torch.Size([153, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.20717620849609375  GigaBytes
Max Memory Allocated: 0.41742372512817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.1279439926147461  GigaBytes
Max Memory Allocated: 0.41742372512817383  GigaBytes

torch.Size([460, 1433])
torch.Size([162, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.19811630249023438  GigaBytes
Max Memory Allocated: 0.41742372512817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13155889511108398  GigaBytes
Max Memory Allocated: 0.41742372512817383  GigaBytes

torch.Size([1135, 1433])
torch.Size([413, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.3158245086669922  GigaBytes
Max Memory Allocated: 0.41742372512817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.1268024444580078  GigaBytes
Max Memory Allocated: 0.4360489845275879  GigaBytes

torch.Size([247, 1433])
torch.Size([88, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.16393184661865234  GigaBytes
Max Memory Allocated: 0.4360489845275879  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05318930745124817 |0.022092550992965698 |0.10894645750522614 |0.00011767446994781494 |0.11353445053100586 |0.013914346694946289 |
----------------------------------------------------------pseudo_mini_loss sum 2.8410518169403076
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16466
Number of first layer input nodes during this epoch:  11509
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2522850036621094  GigaBytes
Max Memory Allocated: 0.4360489845275879  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005509853363037109
random selection method range initialization spend 0.00014591217041015625
time for parepare:  8.392333984375e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  4.982948303222656e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.7642974853515625e-05
----------------------check_connections_block total spend ----------------------------- 0.0033397674560546875
generate_one_block  0.0011856555938720703
generate_one_block  0.0010538101196289062
generate_one_block  0.0010440349578857422
generate_one_block  0.0014264583587646484
generate_one_block  0.00106048583984375
generate_one_block  0.0010461807250976562
generate_one_block  0.0010325908660888672
generate_one_block  0.0010373592376708984
generate_one_block  0.0010311603546142578
generate_one_block  0.001027822494506836
generate_one_block  0.0010418891906738281
generate_one_block  0.0010342597961425781
generate_one_block  0.0010304450988769531
generate_one_block  0.0010349750518798828
generate_one_block  0.0010297298431396484
generate_one_block  0.0010094642639160156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006222724914550781
gen group dst list time:  0.00010275840759277344
time for parepare:  0.00017833709716796875
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0002315044403076172
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  7.772445678710938e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001838207244873047
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00012612342834472656
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00014400482177734375
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00025773048400878906
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00010752677917480469
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00016880035400390625
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00019240379333496094
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  8.296966552734375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00012254714965820312
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001823902130126953
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0001659393310546875
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.915496826171875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00012922286987304688
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00013685226440429688
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.604194641113281e-05
----------------------check_connections_block total spend ----------------------------- 0.005949735641479492
generate_one_block  0.00119781494140625
generate_one_block  0.0012557506561279297
generate_one_block  0.0011823177337646484
generate_one_block  0.0011968612670898438
generate_one_block  0.0013575553894042969
generate_one_block  0.0011425018310546875
generate_one_block  0.0012061595916748047
generate_one_block  0.0011701583862304688
generate_one_block  0.0010323524475097656
generate_one_block  0.0011043548583984375
generate_one_block  0.001176595687866211
generate_one_block  0.0011572837829589844
generate_one_block  0.0010445117950439453
generate_one_block  0.0011477470397949219
generate_one_block  0.0011320114135742188
generate_one_block  0.0010707378387451172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007402896881103516
gen group dst list time:  0.00018525123596191406
time for parepare:  0.00023317337036132812
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00029659271240234375
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00023698806762695312
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0006732940673828125
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0004520416259765625
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0004620552062988281
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0007407665252685547
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0003032684326171875
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  7.748603820800781e-05
r_  generation:  0.0006563663482666016
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0006415843963623047
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.00023818016052246094
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.0004744529724121094
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.00060272216796875
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0005996227264404297
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0002903938293457031
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00040435791015625
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0005419254302978516
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.00018095970153808594
----------------------check_connections_block total spend ----------------------------- 0.014346599578857422
generate_one_block  0.001354217529296875
generate_one_block  0.0018701553344726562
generate_one_block  0.0015497207641601562
generate_one_block  0.0015387535095214844
generate_one_block  0.001810312271118164
generate_one_block  0.0013625621795654297
generate_one_block  0.001913309097290039
generate_one_block  0.0027437210083007812
generate_one_block  0.0016493797302246094
generate_one_block  0.0022678375244140625
generate_one_block  0.002274751663208008
generate_one_block  0.002225160598754883
generate_one_block  0.0012979507446289062
generate_one_block  0.0013773441314697266
generate_one_block  0.0015690326690673828
generate_one_block  0.001138925552368164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2522850036621094  GigaBytes
Max Memory Allocated: 0.4360489845275879  GigaBytes

connection checking time:  0.020296335220336914
block generation total time  0.04651784896850586
average batch blocks generation time:  0.002907365560531616
block dataloader generation time/epoch 0.13433122634887695
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2532167434692383  GigaBytes
Max Memory Allocated: 0.4360489845275879  GigaBytes

torch.Size([423, 1433])
torch.Size([98, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.30724382400512695  GigaBytes
Max Memory Allocated: 0.4360489845275879  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2558717727661133  GigaBytes
Max Memory Allocated: 0.4360489845275879  GigaBytes

torch.Size([918, 1433])
torch.Size([365, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.4263296127319336  GigaBytes
Max Memory Allocated: 0.4401888847351074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.25455713272094727  GigaBytes
Max Memory Allocated: 0.5469555854797363  GigaBytes

torch.Size([673, 1433])
torch.Size([246, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3624086380004883  GigaBytes
Max Memory Allocated: 0.5469555854797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.25464773178100586  GigaBytes
Max Memory Allocated: 0.5469555854797363  GigaBytes

torch.Size([690, 1433])
torch.Size([227, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.36246776580810547  GigaBytes
Max Memory Allocated: 0.5469555854797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2559547424316406  GigaBytes
Max Memory Allocated: 0.5469555854797363  GigaBytes

torch.Size([933, 1433])
torch.Size([436, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.4423675537109375  GigaBytes
Max Memory Allocated: 0.5469555854797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2532463073730469  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

torch.Size([428, 1433])
torch.Size([160, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.323028564453125  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.255950927734375  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

torch.Size([892, 1433])
torch.Size([375, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.4203372001647949  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2551722526550293  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

torch.Size([787, 1433])
torch.Size([326, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.4114189147949219  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2529287338256836  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

torch.Size([369, 1433])
torch.Size([107, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3037295341491699  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2553372383117676  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

torch.Size([819, 1433])
torch.Size([265, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3754615783691406  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2555708885192871  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

torch.Size([862, 1433])
torch.Size([304, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.4050865173339844  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2552347183227539  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

torch.Size([799, 1433])
torch.Size([314, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.40392255783081055  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.253507137298584  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

torch.Size([477, 1433])
torch.Size([143, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.32181787490844727  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2539100646972656  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

torch.Size([552, 1433])
torch.Size([193, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.34950971603393555  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.25482797622680664  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

torch.Size([723, 1433])
torch.Size([291, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3887805938720703  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.2522711753845215  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

torch.Size([246, 1433])
torch.Size([85, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.29148006439208984  GigaBytes
Max Memory Allocated: 0.5619316101074219  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.051138073205947876 |0.0004073679447174072 |0.07671970129013062 |0.00010442733764648438 |0.10830971598625183 |0.006018877029418945 |
----------------------------------------------------------pseudo_mini_loss sum 2.667970895767212
Total (block generation + training)time/epoch 3.9817540645599365
Training time/epoch 3.8470587730407715
Training time without block to device /epoch 3.840540885925293
Training time without total dataloading part /epoch 2.968160390853882
load block tensor time/epoch 0.818209171295166
block to device time/epoch 0.006517887115478516
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15289
Number of first layer input nodes during this epoch:  10591
