main start at this time 1648432698.073457
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.0746145248413086  GigaBytes
Max Memory Allocated: 0.0746145248413086  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012822151184082031
random selection method range initialization spend 0.00022268295288085938
time for parepare:  6.4849853515625e-05
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0019867420196533203
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  5.1975250244140625e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.075599670410156e-05
----------------------check_connections_block total spend ----------------------------- 0.003989219665527344
generate_one_block  0.0015170574188232422
generate_one_block  0.0010762214660644531
generate_one_block  0.0010406970977783203
generate_one_block  0.0010526180267333984
generate_one_block  0.0010623931884765625
generate_one_block  0.0010263919830322266
generate_one_block  0.001043558120727539
generate_one_block  0.0010628700256347656
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005269050598144531
gen group dst list time:  5.7220458984375e-05
time for parepare:  0.00014257431030273438
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00024199485778808594
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00020766258239746094
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00023221969604492188
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00023412704467773438
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001728534698486328
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0002837181091308594
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0002052783966064453
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00028824806213378906
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0002117156982421875
----------------------check_connections_block total spend ----------------------------- 0.0041656494140625
generate_one_block  0.001245737075805664
generate_one_block  0.0013036727905273438
generate_one_block  0.0012927055358886719
generate_one_block  0.0011992454528808594
generate_one_block  0.0013804435729980469
generate_one_block  0.0012390613555908203
generate_one_block  0.0013954639434814453
generate_one_block  0.0012869834899902344
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006818771362304688
gen group dst list time:  0.00010275840759277344
time for parepare:  0.0001983642578125
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0002956390380859375
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0006761550903320312
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.0007281303405761719
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.000751495361328125
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0006487369537353516
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  9.72747802734375e-05
r_  generation:  0.0009806156158447266
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  9.512901306152344e-05
r_  generation:  0.0007178783416748047
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  0.0009937286376953125
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0007328987121582031
----------------------check_connections_block total spend ----------------------------- 0.010732889175415039
generate_one_block  0.0018472671508789062
generate_one_block  0.0018877983093261719
generate_one_block  0.0018067359924316406
generate_one_block  0.0016841888427734375
generate_one_block  0.0020220279693603516
generate_one_block  0.0018794536590576172
generate_one_block  0.0020945072174072266
generate_one_block  0.0017592906951904297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007567405700683594
gen group dst list time:  0.00019431114196777344
time for parepare:  0.00018835067749023438
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.00040221214294433594
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.0016255378723144531
local_output_nid generation:  8.749961853027344e-05
local_in_edges_tensor generation:  0.00026869773864746094
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.0017478466033935547
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.00023889541625976562
mini_batch_src_global generation:  0.00020074844360351562
r_  generation:  0.0017163753509521484
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.00022673606872558594
mini_batch_src_global generation:  0.00016021728515625
r_  generation:  0.0016372203826904297
local_output_nid generation:  9.632110595703125e-05
local_in_edges_tensor generation:  0.0002841949462890625
mini_batch_src_global generation:  0.00019979476928710938
r_  generation:  0.0020122528076171875
local_output_nid generation:  8.678436279296875e-05
local_in_edges_tensor generation:  0.0002682209014892578
mini_batch_src_global generation:  0.00018095970153808594
r_  generation:  0.0017783641815185547
local_output_nid generation:  9.703636169433594e-05
local_in_edges_tensor generation:  0.0002651214599609375
mini_batch_src_global generation:  0.00018668174743652344
r_  generation:  0.0020880699157714844
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  0.00016617774963378906
r_  generation:  0.0015630722045898438
----------------------check_connections_block total spend ----------------------------- 0.022162675857543945
generate_one_block  0.0027670860290527344
generate_one_block  0.00286865234375
generate_one_block  0.002827882766723633
generate_one_block  0.0026912689208984375
generate_one_block  0.003322124481201172
generate_one_block  0.002908945083618164
generate_one_block  0.0031843185424804688
generate_one_block  0.0027625560760498047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007884502410888672
gen group dst list time:  0.00032830238342285156
time for parepare:  0.00018835067749023438
local_output_nid generation:  0.00011587142944335938
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.00021982192993164062
r_  generation:  0.0025107860565185547
local_output_nid generation:  0.000133514404296875
local_in_edges_tensor generation:  0.0003323554992675781
mini_batch_src_global generation:  0.00028395652770996094
r_  generation:  0.002611875534057617
local_output_nid generation:  0.00013208389282226562
local_in_edges_tensor generation:  0.00031638145446777344
mini_batch_src_global generation:  0.00022912025451660156
r_  generation:  0.0026667118072509766
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.0003037452697753906
mini_batch_src_global generation:  0.0002186298370361328
r_  generation:  0.00257110595703125
local_output_nid generation:  0.00014138221740722656
local_in_edges_tensor generation:  0.0003304481506347656
mini_batch_src_global generation:  0.00023627281188964844
r_  generation:  0.0028574466705322266
local_output_nid generation:  0.00013947486877441406
local_in_edges_tensor generation:  0.00031638145446777344
mini_batch_src_global generation:  0.00024127960205078125
r_  generation:  0.0025033950805664062
local_output_nid generation:  0.00013136863708496094
local_in_edges_tensor generation:  0.0003094673156738281
mini_batch_src_global generation:  0.00022530555725097656
r_  generation:  0.0026056766510009766
local_output_nid generation:  0.0001201629638671875
local_in_edges_tensor generation:  0.0002899169921875
mini_batch_src_global generation:  0.0002148151397705078
r_  generation:  0.002385377883911133
----------------------check_connections_block total spend ----------------------------- 0.03137779235839844
generate_one_block  0.0037059783935546875
generate_one_block  0.0036497116088867188
generate_one_block  0.003677845001220703
generate_one_block  0.004135847091674805
generate_one_block  0.003844738006591797
generate_one_block  0.00372314453125
generate_one_block  0.0038094520568847656
generate_one_block  0.0036003589630126953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.0746145248413086  GigaBytes
Max Memory Allocated: 0.0746145248413086  GigaBytes

connection checking time:  0.06843900680541992
block generation total time  0.07880449295043945
average batch blocks generation time:  0.009850561618804932
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.0863800048828125  GigaBytes
Max Memory Allocated: 0.0863800048828125  GigaBytes

torch.Size([2182, 1433])
torch.Size([1727, 256])
torch.Size([998, 256])
torch.Size([364, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1170654296875 GB
    Memory Allocated: 0.8686361312866211  GigaBytes
Max Memory Allocated: 0.8687548637390137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.16121387481689453  GigaBytes
Max Memory Allocated: 0.8731064796447754  GigaBytes

torch.Size([2196, 1433])
torch.Size([1807, 256])
torch.Size([1106, 256])
torch.Size([415, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.9798436164855957  GigaBytes
Max Memory Allocated: 0.979978084564209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.16132736206054688  GigaBytes
Max Memory Allocated: 0.9836301803588867  GigaBytes

torch.Size([2217, 1433])
torch.Size([1842, 256])
torch.Size([1040, 256])
torch.Size([425, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.9891080856323242  GigaBytes
Max Memory Allocated: 0.9892311096191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.1611042022705078  GigaBytes
Max Memory Allocated: 0.9929060935974121  GigaBytes

torch.Size([2177, 1433])
torch.Size([1754, 256])
torch.Size([966, 256])
torch.Size([334, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.9552631378173828  GigaBytes
Max Memory Allocated: 0.9929060935974121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.16171789169311523  GigaBytes
Max Memory Allocated: 0.9929060935974121  GigaBytes

torch.Size([2287, 1433])
torch.Size([2004, 256])
torch.Size([1318, 256])
torch.Size([556, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4041748046875 GB
    Memory Allocated: 1.065711498260498  GigaBytes
Max Memory Allocated: 1.0658459663391113  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1614990234375  GigaBytes
Max Memory Allocated: 1.069502830505371  GigaBytes

torch.Size([2249, 1433])
torch.Size([1871, 256])
torch.Size([1105, 256])
torch.Size([383, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 1.0061917304992676  GigaBytes
Max Memory Allocated: 1.069502830505371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.16176176071166992  GigaBytes
Max Memory Allocated: 1.069502830505371  GigaBytes

torch.Size([2295, 1433])
torch.Size([1957, 256])
torch.Size([1347, 256])
torch.Size([559, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4139404296875 GB
    Memory Allocated: 1.062293529510498  GigaBytes
Max Memory Allocated: 1.069502830505371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4178466796875 GB
    Memory Allocated: 0.16100740432739258  GigaBytes
Max Memory Allocated: 1.069502830505371  GigaBytes

torch.Size([2158, 1433])
torch.Size([1759, 256])
torch.Size([1003, 256])
torch.Size([398, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4178466796875 GB
    Memory Allocated: 0.9605531692504883  GigaBytes
Max Memory Allocated: 1.069502830505371  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061918169260025024 |0.04314592480659485 |0.28287091851234436 |0.00014445185661315918 |0.32105934619903564 |0.017543792724609375 |
----------------------------------------------------------pseudo_mini_loss sum 3.0348048210144043
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  45557
Number of first layer input nodes during this epoch:  17761
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4803466796875 GB
    Memory Allocated: 0.3107900619506836  GigaBytes
Max Memory Allocated: 1.069502830505371  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006589889526367188
random selection method range initialization spend 0.0001690387725830078
time for parepare:  8.106231689453125e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  6.890296936035156e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.340576171875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.337860107421875e-05
----------------------check_connections_block total spend ----------------------------- 0.0021288394927978516
generate_one_block  0.001291036605834961
generate_one_block  0.001172780990600586
generate_one_block  0.0010988712310791016
generate_one_block  0.0011641979217529297
generate_one_block  0.0010988712310791016
generate_one_block  0.0010907649993896484
generate_one_block  0.0011200904846191406
generate_one_block  0.001096487045288086
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005719661712646484
gen group dst list time:  6.937980651855469e-05
time for parepare:  0.00020360946655273438
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00018596649169921875
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00021004676818847656
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00022912025451660156
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00031185150146484375
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0001995563507080078
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00022912025451660156
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00036334991455078125
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00016999244689941406
----------------------check_connections_block total spend ----------------------------- 0.0044498443603515625
generate_one_block  0.0013239383697509766
generate_one_block  0.0013327598571777344
generate_one_block  0.0013477802276611328
generate_one_block  0.001539468765258789
generate_one_block  0.0012984275817871094
generate_one_block  0.0013003349304199219
generate_one_block  0.0014767646789550781
generate_one_block  0.0012581348419189453
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007569789886474609
gen group dst list time:  0.00011301040649414062
time for parepare:  0.00022029876708984375
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.0002639293670654297
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0006146430969238281
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.00077056884765625
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.00011324882507324219
r_  generation:  0.0007855892181396484
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.00011777877807617188
r_  generation:  0.0009322166442871094
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.0006465911865234375
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  0.00010228157043457031
r_  generation:  0.0007905960083007812
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  0.00011944770812988281
r_  generation:  0.001102447509765625
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  8.7738037109375e-05
r_  generation:  0.0005567073822021484
----------------------check_connections_block total spend ----------------------------- 0.011054754257202148
generate_one_block  0.0017976760864257812
generate_one_block  0.0020024776458740234
generate_one_block  0.0019817352294921875
generate_one_block  0.002079010009765625
generate_one_block  0.0017423629760742188
generate_one_block  0.0019757747650146484
generate_one_block  0.0022547245025634766
generate_one_block  0.0016257762908935547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008292198181152344
gen group dst list time:  0.0002143383026123047
time for parepare:  0.00020623207092285156
local_output_nid generation:  7.581710815429688e-05
local_in_edges_tensor generation:  0.0003764629364013672
mini_batch_src_global generation:  0.00018906593322753906
r_  generation:  0.0014653205871582031
local_output_nid generation:  9.894371032714844e-05
local_in_edges_tensor generation:  0.0002624988555908203
mini_batch_src_global generation:  0.00023031234741210938
r_  generation:  0.0017995834350585938
local_output_nid generation:  0.00010323524475097656
local_in_edges_tensor generation:  0.0002677440643310547
mini_batch_src_global generation:  0.00019121170043945312
r_  generation:  0.0019078254699707031
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.00026917457580566406
mini_batch_src_global generation:  0.00018215179443359375
r_  generation:  0.0018851757049560547
local_output_nid generation:  8.726119995117188e-05
local_in_edges_tensor generation:  0.00023865699768066406
mini_batch_src_global generation:  0.00016069412231445312
r_  generation:  0.0016484260559082031
local_output_nid generation:  9.870529174804688e-05
local_in_edges_tensor generation:  0.0004642009735107422
mini_batch_src_global generation:  0.0001766681671142578
r_  generation:  0.0018596649169921875
local_output_nid generation:  0.00010967254638671875
local_in_edges_tensor generation:  0.00026798248291015625
mini_batch_src_global generation:  0.00019288063049316406
r_  generation:  0.002012491226196289
local_output_nid generation:  6.866455078125e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.0001404285430908203
r_  generation:  0.001237630844116211
----------------------check_connections_block total spend ----------------------------- 0.02220940589904785
generate_one_block  0.00283050537109375
generate_one_block  0.0030202865600585938
generate_one_block  0.0031576156616210938
generate_one_block  0.003141641616821289
generate_one_block  0.002823352813720703
generate_one_block  0.003101825714111328
generate_one_block  0.0033376216888427734
generate_one_block  0.002519845962524414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007958412170410156
gen group dst list time:  0.00038313865661621094
time for parepare:  0.00022077560424804688
local_output_nid generation:  0.00014495849609375
local_in_edges_tensor generation:  0.0004734992980957031
mini_batch_src_global generation:  0.00020503997802734375
r_  generation:  0.002374887466430664
local_output_nid generation:  0.00015854835510253906
local_in_edges_tensor generation:  0.0003514289855957031
mini_batch_src_global generation:  0.0002696514129638672
r_  generation:  0.0026345252990722656
local_output_nid generation:  0.0001659393310546875
local_in_edges_tensor generation:  0.0003559589385986328
mini_batch_src_global generation:  0.0002460479736328125
r_  generation:  0.0027785301208496094
local_output_nid generation:  0.00016164779663085938
local_in_edges_tensor generation:  0.0003457069396972656
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.002727031707763672
local_output_nid generation:  0.00015807151794433594
local_in_edges_tensor generation:  0.0003268718719482422
mini_batch_src_global generation:  0.00023031234741210938
r_  generation:  0.0026361942291259766
local_output_nid generation:  0.0001633167266845703
local_in_edges_tensor generation:  0.0003445148468017578
mini_batch_src_global generation:  0.0002357959747314453
r_  generation:  0.0026519298553466797
local_output_nid generation:  0.00017499923706054688
local_in_edges_tensor generation:  0.000324249267578125
mini_batch_src_global generation:  0.0002455711364746094
r_  generation:  0.0027303695678710938
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.0002865791320800781
mini_batch_src_global generation:  0.00021076202392578125
r_  generation:  0.0021810531616210938
----------------------check_connections_block total spend ----------------------------- 0.031737565994262695
generate_one_block  0.0038166046142578125
generate_one_block  0.004138946533203125
generate_one_block  0.0039348602294921875
generate_one_block  0.003876924514770508
generate_one_block  0.0040874481201171875
generate_one_block  0.003948211669921875
generate_one_block  0.004067182540893555
generate_one_block  0.0035867691040039062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4803466796875 GB
    Memory Allocated: 0.3107900619506836  GigaBytes
Max Memory Allocated: 1.069502830505371  GigaBytes

connection checking time:  0.06945157051086426
block generation total time  0.0817267894744873
average batch blocks generation time:  0.010215848684310913
block dataloader generation time/epoch 0.2355492115020752
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4803466796875 GB
    Memory Allocated: 0.31055450439453125  GigaBytes
Max Memory Allocated: 1.069502830505371  GigaBytes

torch.Size([2156, 1433])
torch.Size([1596, 256])
torch.Size([841, 256])
torch.Size([325, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4803466796875 GB
    Memory Allocated: 1.032649040222168  GigaBytes
Max Memory Allocated: 1.069502830505371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4803466796875 GB
    Memory Allocated: 0.3106417655944824  GigaBytes
Max Memory Allocated: 1.069502830505371  GigaBytes

torch.Size([2169, 1433])
torch.Size([1793, 256])
torch.Size([1068, 256])
torch.Size([396, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4803466796875 GB
    Memory Allocated: 1.111374855041504  GigaBytes
Max Memory Allocated: 1.1114768981933594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4803466796875 GB
    Memory Allocated: 0.3111991882324219  GigaBytes
Max Memory Allocated: 1.1151976585388184  GigaBytes

torch.Size([2272, 1433])
torch.Size([1891, 256])
torch.Size([1174, 256])
torch.Size([422, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4803466796875 GB
    Memory Allocated: 1.1645984649658203  GigaBytes
Max Memory Allocated: 1.1647100448608398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5428466796875 GB
    Memory Allocated: 0.3108997344970703  GigaBytes
Max Memory Allocated: 1.168409824371338  GigaBytes

torch.Size([2215, 1433])
torch.Size([1846, 256])
torch.Size([1188, 256])
torch.Size([458, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5447998046875 GB
    Memory Allocated: 1.1650667190551758  GigaBytes
Max Memory Allocated: 1.168409824371338  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 0.3107748031616211  GigaBytes
Max Memory Allocated: 1.1688284873962402  GigaBytes

torch.Size([2195, 1433])
torch.Size([1775, 256])
torch.Size([946, 256])
torch.Size([331, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 1.1048846244812012  GigaBytes
Max Memory Allocated: 1.1688284873962402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 0.31101322174072266  GigaBytes
Max Memory Allocated: 1.1688284873962402  GigaBytes

torch.Size([2237, 1433])
torch.Size([1873, 256])
torch.Size([1110, 256])
torch.Size([404, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 1.166175365447998  GigaBytes
Max Memory Allocated: 1.1688284873962402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 0.3116283416748047  GigaBytes
Max Memory Allocated: 1.1699838638305664  GigaBytes

torch.Size([2349, 1433])
torch.Size([2009, 256])
torch.Size([1320, 256])
torch.Size([585, 256])Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 1.2303829193115234  GigaBytes
Max Memory Allocated: 1.2305545806884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.3105611801147461  GigaBytes
Max Memory Allocated: 1.2341341972351074  GigaBytes

torch.Size([2070, 1433])
torch.Size([1536, 256])
torch.Size([768, 256])
torch.Size([295, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.005444049835205  GigaBytes
Max Memory Allocated: 1.2341341972351074  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06208488345146179 |0.0009611546993255615 |0.2172185182571411 |0.00012752413749694824 |0.312276691198349 |0.014475822448730469 |
----------------------------------------------------------pseudo_mini_loss sum 3.9945759773254395
Total (block generation + training)time/epoch 5.057271957397461
Training time/epoch 4.821405649185181
Training time without block to device /epoch 4.813716411590576
Training time without total dataloading part /epoch 4.251457691192627
load block tensor time/epoch 0.49667906761169434
block to device time/epoch 0.007689237594604492
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  44363
Number of first layer input nodes during this epoch:  17663
