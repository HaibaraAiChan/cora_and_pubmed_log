main start at this time 1648432683.355211
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.0746145248413086  GigaBytes
Max Memory Allocated: 0.0746145248413086  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012755393981933594
random selection method range initialization spend 0.00020933151245117188
time for parepare:  6.937980651855469e-05
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0028696060180664062
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.628036499023438e-05
----------------------check_connections_block total spend ----------------------------- 0.004122734069824219
generate_one_block  0.001413106918334961
generate_one_block  0.0011036396026611328
generate_one_block  0.0011014938354492188
generate_one_block  0.001094818115234375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005121231079101562
gen group dst list time:  4.100799560546875e-05
time for parepare:  0.0001475811004638672
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00023055076599121094
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00042247772216796875
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00034046173095703125
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0004200935363769531
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004601478576660156
----------------------check_connections_block total spend ----------------------------- 0.0032072067260742188
generate_one_block  0.0015316009521484375
generate_one_block  0.0014154911041259766
generate_one_block  0.001516580581665039
generate_one_block  0.0016243457794189453
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006105899810791016
gen group dst list time:  7.82012939453125e-05
time for parepare:  0.00017452239990234375
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.0003180503845214844
mini_batch_src_global generation:  0.00013709068298339844
r_  generation:  0.0012516975402832031
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.00103759765625
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  0.0001251697540283203
r_  generation:  0.0012810230255126953
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  0.00014710426330566406
r_  generation:  0.0013861656188964844
----------------------check_connections_block total spend ----------------------------- 0.008064746856689453
generate_one_block  0.0025031566619873047
generate_one_block  0.002248048782348633
generate_one_block  0.0024437904357910156
generate_one_block  0.0024564266204833984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007686614990234375
gen group dst list time:  0.0001347064971923828
time for parepare:  0.0001876354217529297
local_output_nid generation:  0.00010585784912109375
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.00018215179443359375
r_  generation:  0.0023331642150878906
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.0002741813659667969
mini_batch_src_global generation:  0.0002162456512451172
r_  generation:  0.002109050750732422
local_output_nid generation:  0.00011134147644042969
local_in_edges_tensor generation:  0.0002925395965576172
mini_batch_src_global generation:  0.00022268295288085938
r_  generation:  0.0023932456970214844
local_output_nid generation:  0.00011396408081054688
local_in_edges_tensor generation:  0.00029015541076660156
mini_batch_src_global generation:  0.0002193450927734375
r_  generation:  0.002476215362548828
----------------------check_connections_block total spend ----------------------------- 0.014280080795288086
generate_one_block  0.0035734176635742188
generate_one_block  0.0031414031982421875
generate_one_block  0.0035948753356933594
generate_one_block  0.0034792423248291016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007452964782714844
gen group dst list time:  0.0001888275146484375
time for parepare:  0.00019049644470214844
local_output_nid generation:  0.000141143798828125
local_in_edges_tensor generation:  0.0005574226379394531
mini_batch_src_global generation:  0.00020432472229003906
r_  generation:  0.002935171127319336
local_output_nid generation:  0.00014591217041015625
local_in_edges_tensor generation:  0.000347137451171875
mini_batch_src_global generation:  0.00029778480529785156
r_  generation:  0.0028524398803710938
local_output_nid generation:  0.00015425682067871094
local_in_edges_tensor generation:  0.000354766845703125
mini_batch_src_global generation:  0.0002779960632324219
r_  generation:  0.003077268600463867
local_output_nid generation:  0.000152587890625
local_in_edges_tensor generation:  0.00036263465881347656
mini_batch_src_global generation:  0.00025653839111328125
r_  generation:  0.0030264854431152344
----------------------check_connections_block total spend ----------------------------- 0.018139362335205078
generate_one_block  0.004173994064331055
generate_one_block  0.0038182735443115234
generate_one_block  0.0039937496185302734
generate_one_block  0.003974437713623047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.0746145248413086  GigaBytes
Max Memory Allocated: 0.0746145248413086  GigaBytes

connection checking time:  0.043691396713256836
block generation total time  0.045488834381103516
average batch blocks generation time:  0.011372208595275879
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.0871434211730957  GigaBytes
Max Memory Allocated: 0.0871434211730957  GigaBytes

torch.Size([2317, 1433])
torch.Size([2090, 256])
torch.Size([1541, 256])
torch.Size([723, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 1.0450634956359863  GigaBytes
Max Memory Allocated: 1.0453062057495117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3514404296875 GB
    Memory Allocated: 0.16136980056762695  GigaBytes
Max Memory Allocated: 1.048776626586914  GigaBytes

torch.Size([2285, 1433])
torch.Size([2013, 256])
torch.Size([1328, 256])
torch.Size([586, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3983154296875 GB
    Memory Allocated: 1.0722846984863281  GigaBytes
Max Memory Allocated: 1.0724873542785645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4295654296875 GB
    Memory Allocated: 0.16193866729736328  GigaBytes
Max Memory Allocated: 1.076028823852539  GigaBytes

torch.Size([2388, 1433])
torch.Size([2187, 256])
torch.Size([1553, 256])
torch.Size([732, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4959716796875 GB
    Memory Allocated: 1.1541566848754883  GigaBytes
Max Memory Allocated: 1.1543869972229004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 0.16186761856079102  GigaBytes
Max Memory Allocated: 1.1578798294067383  GigaBytes

torch.Size([2374, 1433])
torch.Size([2138, 256])
torch.Size([1586, 256])
torch.Size([790, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 1.1552329063415527  GigaBytes
Max Memory Allocated: 1.1578798294067383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.058776021003723145 |0.08614498376846313 |0.36526256799697876 |0.00016957521438598633 |0.34149593114852905 |0.017937898635864258 |
----------------------------------------------------------pseudo_mini_loss sum 3.1183433532714844
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27365
Number of first layer input nodes during this epoch:  9364
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6014404296875 GB
    Memory Allocated: 0.31167173385620117  GigaBytes
Max Memory Allocated: 1.1589341163635254  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005619525909423828
random selection method range initialization spend 0.00013709068298339844
time for parepare:  8.225440979003906e-05
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  8.440017700195312e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  8.0108642578125e-05
----------------------check_connections_block total spend ----------------------------- 0.0013508796691894531
generate_one_block  0.0012135505676269531
generate_one_block  0.0011637210845947266
generate_one_block  0.0011324882507324219
generate_one_block  0.0011444091796875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005147457122802734
gen group dst list time:  4.57763671875e-05
time for parepare:  0.00016260147094726562
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.00036454200744628906
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.00042629241943359375
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.00041413307189941406
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0004947185516357422
----------------------check_connections_block total spend ----------------------------- 0.0034646987915039062
generate_one_block  0.0017464160919189453
generate_one_block  0.0015633106231689453
generate_one_block  0.0015981197357177734
generate_one_block  0.0016710758209228516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005776882171630859
gen group dst list time:  9.250640869140625e-05
time for parepare:  0.00020003318786621094
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.00028586387634277344
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.0012149810791015625
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  0.00016069412231445312
r_  generation:  0.0012340545654296875
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  0.00015091896057128906
r_  generation:  0.001352071762084961
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  0.0001494884490966797
r_  generation:  0.0013854503631591797
----------------------check_connections_block total spend ----------------------------- 0.008477210998535156
generate_one_block  0.002581357955932617
generate_one_block  0.0025777816772460938
generate_one_block  0.0025315284729003906
generate_one_block  0.0025599002838134766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007474422454833984
gen group dst list time:  0.000141143798828125
time for parepare:  0.0001850128173828125
local_output_nid generation:  0.00012063980102539062
local_in_edges_tensor generation:  0.00037598609924316406
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.002222776412963867
local_output_nid generation:  0.00012230873107910156
local_in_edges_tensor generation:  0.00029158592224121094
mini_batch_src_global generation:  0.00024008750915527344
r_  generation:  0.002335786819458008
local_output_nid generation:  0.00012969970703125
local_in_edges_tensor generation:  0.00029158592224121094
mini_batch_src_global generation:  0.000217437744140625
r_  generation:  0.0024385452270507812
local_output_nid generation:  0.0001270771026611328
local_in_edges_tensor generation:  0.0002899169921875
mini_batch_src_global generation:  0.00021719932556152344
r_  generation:  0.002440929412841797
----------------------check_connections_block total spend ----------------------------- 0.014539957046508789
generate_one_block  0.0037391185760498047
generate_one_block  0.0035147666931152344
generate_one_block  0.003584146499633789
generate_one_block  0.0035932064056396484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007936954498291016
gen group dst list time:  0.00019168853759765625
time for parepare:  0.0002002716064453125
local_output_nid generation:  0.0001652240753173828
local_in_edges_tensor generation:  0.0005013942718505859
mini_batch_src_global generation:  0.0002689361572265625
r_  generation:  0.002974271774291992
local_output_nid generation:  0.00017380714416503906
local_in_edges_tensor generation:  0.0003459453582763672
mini_batch_src_global generation:  0.00032067298889160156
r_  generation:  0.002909421920776367
local_output_nid generation:  0.00017452239990234375
local_in_edges_tensor generation:  0.0003638267517089844
mini_batch_src_global generation:  0.0002474784851074219
r_  generation:  0.0029458999633789062
local_output_nid generation:  0.0001964569091796875
local_in_edges_tensor generation:  0.0003612041473388672
mini_batch_src_global generation:  0.0002586841583251953Using backend: pytorch

r_  generation:  0.003025531768798828
----------------------check_connections_block total spend ----------------------------- 0.018313169479370117
generate_one_block  0.004221677780151367
generate_one_block  0.0042989253997802734
generate_one_block  0.004094839096069336
generate_one_block  0.004190921783447266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6014404296875 GB
    Memory Allocated: 0.31167173385620117  GigaBytes
Max Memory Allocated: 1.1589341163635254  GigaBytes

connection checking time:  0.04479503631591797
block generation total time  0.04806709289550781
average batch blocks generation time:  0.012016773223876953
block dataloader generation time/epoch 0.1391158103942871
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6014404296875 GB
    Memory Allocated: 0.3113822937011719  GigaBytes
Max Memory Allocated: 1.1589341163635254  GigaBytes

torch.Size([2380, 1433])
torch.Size([2142, 256])
torch.Size([1457, 256])
torch.Size([674, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6014404296875 GB
    Memory Allocated: 1.277355670928955  GigaBytes
Max Memory Allocated: 1.2775506973266602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.3113560676574707  GigaBytes
Max Memory Allocated: 1.28110933303833  GigaBytes

torch.Size([2359, 1433])
torch.Size([2112, 256])
torch.Size([1534, 256])
torch.Size([681, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6424560546875 GB
    Memory Allocated: 1.2746601104736328  GigaBytes
Max Memory Allocated: 1.28110933303833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6463623046875 GB
    Memory Allocated: 0.31115198135375977  GigaBytes
Max Memory Allocated: 1.28110933303833  GigaBytes

torch.Size([2335, 1433])
torch.Size([2122, 256])
torch.Size([1573, 256])
torch.Size([744, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6463623046875 GB
    Memory Allocated: 1.2858057022094727  GigaBytes
Max Memory Allocated: 1.2860264778137207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6463623046875 GB
    Memory Allocated: 0.3115730285644531  GigaBytes
Max Memory Allocated: 1.2895221710205078  GigaBytes

torch.Size([2413, 1433])
torch.Size([2176, 256])
torch.Size([1590, 256])
torch.Size([813, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6463623046875 GB
    Memory Allocated: 1.3172049522399902  GigaBytes
Max Memory Allocated: 1.3174734115600586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05373716354370117 |0.001185297966003418 |0.24805337190628052 |0.00013381242752075195 |0.34038668870925903 |0.012769699096679688 |
----------------------------------------------------------pseudo_mini_loss sum 2.9650464057922363
Total (block generation + training)time/epoch 2.7927186489105225
Training time/epoch 2.6532368659973145
Training time without block to device /epoch 2.648495674133301
Training time without total dataloading part /epoch 2.367065191268921
load block tensor time/epoch 0.2149486541748047
block to device time/epoch 0.004741191864013672
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27847
Number of first layer input nodes during this epoch:  9487
