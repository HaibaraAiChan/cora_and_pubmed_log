main start at this time 1648432501.175417
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06304550170898438  GigaBytes
Max Memory Allocated: 0.06304550170898438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0014767646789550781
random selection method range initialization spend 0.00023627281188964844
time for parepare:  6.031990051269531e-05
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.0038030147552490234
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  8.7738037109375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.726119995117188e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  8.606910705566406e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.702278137207031e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.654594421386719e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.3126602172851562e-05
----------------------check_connections_block total spend ----------------------------- 0.006830453872680664
generate_one_block  0.0012536048889160156
generate_one_block  0.000978231430053711
generate_one_block  0.0009658336639404297
generate_one_block  0.0009739398956298828
generate_one_block  0.0009663105010986328
generate_one_block  0.0009703636169433594
generate_one_block  0.0010104179382324219
generate_one_block  0.0009753704071044922
generate_one_block  0.0009620189666748047
generate_one_block  0.0009818077087402344
generate_one_block  0.0009608268737792969
generate_one_block  0.0009701251983642578
generate_one_block  0.0009980201721191406
generate_one_block  0.0009844303131103516
generate_one_block  0.0009963512420654297
generate_one_block  0.0009615421295166016
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005903244018554688
gen group dst list time:  8.535385131835938e-05
time for parepare:  0.00012946128845214844
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.00010466575622558594
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00010156631469726562
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00015854835510253906
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00010156631469726562
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00013494491577148438
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00017452239990234375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00012373924255371094
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0001533031463623047
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.000217437744140625
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00011754035949707031
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  9.679794311523438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  9.202957153320312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  9.608268737792969e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00010251998901367188
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.416175842285156e-05
----------------------check_connections_block total spend ----------------------------- 0.0053598880767822266
generate_one_block  0.0010352134704589844
generate_one_block  0.0010793209075927734
generate_one_block  0.0010647773742675781
generate_one_block  0.0011472702026367188
generate_one_block  0.0011239051818847656
generate_one_block  0.0011093616485595703
generate_one_block  0.0011568069458007812
generate_one_block  0.0011000633239746094
generate_one_block  0.0011365413665771484
generate_one_block  0.0012097358703613281
generate_one_block  0.0010993480682373047
generate_one_block  0.0010662078857421875
generate_one_block  0.001088857650756836
generate_one_block  0.0010731220245361328
generate_one_block  0.001055002212524414
generate_one_block  0.00104522705078125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005617141723632812
gen group dst list time:  0.00016641616821289062
time for parepare:  0.00019121170043945312
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00017523765563964844
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.00038361549377441406
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0003972053527832031
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0005745887756347656
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0003972053527832031
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004553794860839844
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0005936622619628906
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0004305839538574219
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0005795955657958984
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  8.225440979003906e-05
r_  generation:  0.0007064342498779297
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0004730224609375
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0003693103790283203
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0003139972686767578
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.0003561973571777344
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0003516674041748047
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0002548694610595703
----------------------check_connections_block total spend ----------------------------- 0.012558698654174805
generate_one_block  0.0012483596801757812
generate_one_block  0.0014100074768066406
generate_one_block  0.0017061233520507812
generate_one_block  0.001645803451538086
generate_one_block  0.0014150142669677734
generate_one_block  0.0014739036560058594
generate_one_block  0.0016388893127441406
generate_one_block  0.0014691352844238281
generate_one_block  0.0018143653869628906
generate_one_block  0.0018227100372314453
generate_one_block  0.0015482902526855469
generate_one_block  0.0013916492462158203
generate_one_block  0.0013327598571777344
generate_one_block  0.0013613700866699219
generate_one_block  0.001399993896484375
generate_one_block  0.001264333724975586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007178783416748047
gen group dst list time:  0.0002567768096923828
time for parepare:  0.0001876354217529297
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0004892349243164062
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0009839534759521484
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.00011992454528808594
r_  generation:  0.0010716915130615234
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  0.00014925003051757812
r_  generation:  0.0014009475708007812
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.00012969970703125
r_  generation:  0.0012307167053222656
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.0001232624053955078
r_  generation:  0.0012133121490478516
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0013873577117919922
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.00013113021850585938
r_  generation:  0.0012707710266113281
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.001321554183959961
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.0002288818359375
mini_batch_src_global generation:  0.00017595291137695312
r_  generation:  0.0016927719116210938
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0013012886047363281
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0010657310485839844
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  0.00010919570922851562
r_  generation:  0.0009491443634033203
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.000102996826171875
r_  generation:  0.0009021759033203125
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  0.00011277198791503906
r_  generation:  0.0010771751403808594
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.0008034706115722656
----------------------check_connections_block total spend ----------------------------- 0.029035091400146484
generate_one_block  0.001544952392578125
generate_one_block  0.0021097660064697266
generate_one_block  0.0022017955780029297
generate_one_block  0.0026144981384277344
generate_one_block  0.002438068389892578
generate_one_block  0.002401590347290039
generate_one_block  0.0028345584869384766
generate_one_block  0.0025277137756347656
generate_one_block  0.0025606155395507812
generate_one_block  0.0037446022033691406
generate_one_block  0.002471923828125
generate_one_block  0.002208232879638672
generate_one_block  0.002073049545288086
generate_one_block  0.002007722854614258
generate_one_block  0.002209901809692383
generate_one_block  0.0018939971923828125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007498264312744141
gen group dst list time:  0.0006771087646484375
time for parepare:  0.00017642974853515625
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00032901763916015625
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0011713504791259766
local_output_nid generation:  0.00010561943054199219
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  0.00020360946655273438
r_  generation:  0.0018048286437988281
local_output_nid generation:  0.0001049041748046875
local_in_edges_tensor generation:  0.0002570152282714844
mini_batch_src_global generation:  0.00019669532775878906
r_  generation:  0.002003908157348633
local_output_nid generation:  0.00012564659118652344
local_in_edges_tensor generation:  0.0002849102020263672
mini_batch_src_global generation:  0.00022482872009277344
r_  generation:  0.002485513687133789
local_output_nid generation:  0.00011754035949707031
local_in_edges_tensor generation:  0.000274658203125
mini_batch_src_global generation:  0.0002014636993408203
r_  generation:  0.002223491668701172
local_output_nid generation:  0.00011515617370605469
local_in_edges_tensor generation:  0.0002727508544921875
mini_batch_src_global generation:  0.00019788742065429688
r_  generation:  0.0021963119506835938
local_output_nid generation:  0.0001285076141357422
local_in_edges_tensor generation:  0.0002791881561279297
mini_batch_src_global generation:  0.0002033710479736328
r_  generation:  0.002245664596557617
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.0002727508544921875
mini_batch_src_global generation:  0.0002028942108154297
r_  generation:  0.0022344589233398438
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.0002701282501220703
mini_batch_src_global generation:  0.00019931793212890625
r_  generation:  0.0021762847900390625
local_output_nid generation:  0.0001239776611328125
local_in_edges_tensor generation:  0.0002944469451904297
mini_batch_src_global generation:  0.00021338462829589844
r_  generation:  0.0024611949920654297
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.0002636909484863281
mini_batch_src_global generation:  0.0001952648162841797
r_  generation:  0.0021009445190429688
local_output_nid generation:  0.00010228157043457031
local_in_edges_tensor generation:  0.00025463104248046875
mini_batch_src_global generation:  0.00018405914306640625
r_  generation:  0.0019636154174804688
local_output_nid generation:  0.00010085105895996094
local_in_edges_tensor generation:  0.0002548694610595703
mini_batch_src_global generation:  0.00017762184143066406
r_  generation:  0.0018782615661621094
local_output_nid generation:  9.632110595703125e-05
local_in_edges_tensor generation:  0.00024247169494628906
mini_batch_src_global generation:  0.00017023086547851562
r_  generation:  0.00179290771484375
local_output_nid generation:  0.0001068115234375
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  0.00018095970153808594
r_  generation:  0.0019767284393310547
local_output_nid generation:  8.559226989746094e-05
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  0.00016355514526367188
r_  generation:  0.0016298294067382812
----------------------check_connections_block total spend ----------------------------- 0.0490262508392334
generate_one_block  0.003225088119506836
generate_one_block  0.0030324459075927734
generate_one_block  0.0035619735717773438
generate_one_block  0.0035979747772216797
generate_one_block  0.003432035446166992
generate_one_block  0.003400564193725586
generate_one_block  0.003524303436279297
generate_one_block  0.003560781478881836
generate_one_block  0.0034606456756591797
generate_one_block  0.004479408264160156
generate_one_block  0.0032966136932373047
generate_one_block  0.003168821334838867
generate_one_block  0.003068208694458008
generate_one_block  0.002959728240966797
generate_one_block  0.0031905174255371094
generate_one_block  0.0028765201568603516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06304550170898438  GigaBytes
Max Memory Allocated: 0.06304550170898438  GigaBytes

connection checking time:  0.09597992897033691
block generation total time  0.13321208953857422
average batch blocks generation time:  0.008325755596160889
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07138442993164062  GigaBytes
Max Memory Allocated: 0.07138442993164062  GigaBytes

torch.Size([1553, 1433])
torch.Size([776, 32])
torch.Size([283, 32])
torch.Size([85, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6131591796875 GB
    Memory Allocated: 0.4042024612426758  GigaBytes
Max Memory Allocated: 0.42913055419921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.13617467880249023  GigaBytes
Max Memory Allocated: 0.5189085006713867  GigaBytes

torch.Size([1874, 1433])
torch.Size([1273, 32])
torch.Size([585, 32])
torch.Size([211, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.6537027359008789  GigaBytes
Max Memory Allocated: 0.6883072853088379  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.13694000244140625  GigaBytes
Max Memory Allocated: 0.759765625  GigaBytes

torch.Size([2016, 1433])
torch.Size([1405, 32])
torch.Size([656, 32])
torch.Size([198, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.7113199234008789  GigaBytes
Max Memory Allocated: 0.759765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.1379709243774414  GigaBytes
Max Memory Allocated: 0.8143472671508789  GigaBytes

torch.Size([2205, 1433])
torch.Size([1728, 32])
torch.Size([927, 32])
torch.Size([358, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1502685546875 GB
    Memory Allocated: 0.8126425743103027  GigaBytes
Max Memory Allocated: 0.8570585250854492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.1374664306640625  GigaBytes
Max Memory Allocated: 0.9093756675720215  GigaBytes

torch.Size([2113, 1433])
torch.Size([1603, 32])
torch.Size([754, 32])
torch.Size([198, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.775759220123291  GigaBytes
Max Memory Allocated: 0.9093756675720215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.13775157928466797  GigaBytes
Max Memory Allocated: 0.9093756675720215  GigaBytes

torch.Size([2166, 1433])
torch.Size([1582, 32])
torch.Size([766, 32])
torch.Size([236, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.7651214599609375  GigaBytes
Max Memory Allocated: 0.9093756675720215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.13750553131103516  GigaBytes
Max Memory Allocated: 0.9093756675720215  GigaBytes

torch.Size([2118, 1433])
torch.Size([1637, 32])
torch.Size([880, 32])
torch.Size([332, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.7828011512756348  GigaBytes
Max Memory Allocated: 0.9093756675720215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.1374053955078125  GigaBytes
Max Memory Allocated: 0.9093756675720215  GigaBytes

torch.Size([2101, 1433])
torch.Size([1602, 32])
torch.Size([774, 32])
torch.Size([234, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.7772707939147949  GigaBytes
Max Memory Allocated: 0.9093756675720215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.1374349594116211  GigaBytes
Max Memory Allocated: 0.9093756675720215  GigaBytes

torch.Size([2106, 1433])
torch.Size([1580, 32])
torch.Size([862, 32])
torch.Size([351, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.7620258331298828  GigaBytes
Max Memory Allocated: 0.9093756675720215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.13803768157958984  GigaBytes
Max Memory Allocated: 0.9093756675720215  GigaBytes

torch.Size([2215, 1433])
torch.Size([1830, 32])
torch.Size([1147, 32])
torch.Size([401, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.8372268676757812  GigaBytes
Max Memory Allocated: 0.9093756675720215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.1368408203125  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

torch.Size([1996, 1433])
torch.Size([1509, 32])
torch.Size([828, 32])
torch.Size([253, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.7319488525390625  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.13652706146240234  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

torch.Size([1939, 1433])
torch.Size([1384, 32])
torch.Size([621, 32])
torch.Size([203, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.6979584693908691  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.13652467727661133  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

torch.Size([1940, 1433])
torch.Size([1333, 32])
torch.Size([580, 32])
torch.Size([171, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.6796126365661621  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.13625621795654297  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

torch.Size([1890, 1433])
torch.Size([1252, 32])
torch.Size([524, 32])
torch.Size([196, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.648289680480957  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.13674497604370117  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

torch.Size([1980, 1433])
torch.Size([1389, 32])
torch.Size([639, 32])
torch.Size([182, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.6995816230773926  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.13564348220825195  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

torch.Size([1777, 1433])
torch.Size([1096, 32])
torch.Size([490, 32])
torch.Size([130, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.603602409362793  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06097479164600372 |0.02202226221561432 |0.2205156832933426 |0.00012621283531188965 |0.264041543006897 |0.018323659896850586 |
----------------------------------------------------------pseudo_mini_loss sum 3.109760284423828
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  70792
Number of first layer input nodes during this epoch:  31989
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.2618374824523926  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006926059722900391
random selection method range initialization spend 0.00015974044799804688
time for parepare:  8.630752563476562e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.003459930419921875
generate_one_block  0.0011200904846191406
generate_one_block  0.0012886524200439453
generate_one_block  0.00103759765625
generate_one_block  0.000990152359008789
generate_one_block  0.0009989738464355469
generate_one_block  0.001032114028930664
generate_one_block  0.0009987354278564453
generate_one_block  0.0009908676147460938
generate_one_block  0.0010464191436767578
generate_one_block  0.0010101795196533203
generate_one_block  0.0009794235229492188
generate_one_block  0.0009703636169433594
generate_one_block  0.0010998249053955078
generate_one_block  0.0010137557983398438
generate_one_block  0.001081228256225586
generate_one_block  0.001049041748046875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006468296051025391
gen group dst list time:  9.1552734375e-05
time for parepare:  0.00020241737365722656
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  6.937980651855469e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  8.535385131835938e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0001819133758544922
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00013709068298339844
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001316070556640625
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00012445449829101562
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00014066696166992188
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00016546249389648438
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00022864341735839844
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.00011348724365234375
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00012493133544921875
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  9.72747802734375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  7.510185241699219e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0001480579376220703
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00015974044799804688
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  8.320808410644531e-05
----------------------check_connections_block total spend ----------------------------- 0.005865812301635742
generate_one_block  0.0011610984802246094
generate_one_block  0.001088857650756836
generate_one_block  0.001209259033203125
generate_one_block  0.0011496543884277344
generate_one_block  0.0011327266693115234
generate_one_block  0.0011138916015625
generate_one_block  0.0011425018310546875
generate_one_block  0.0011553764343261719
generate_one_block  0.0012233257293701172
generate_one_block  0.0010869503021240234
generate_one_block  0.001705169677734375
generate_one_block  0.0010776519775390625
generate_one_block  0.0010423660278320312
generate_one_block  0.0011589527130126953
generate_one_block  0.001157999038696289
generate_one_block  0.001058816909790039
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008013248443603516
gen group dst list time:  0.00015473365783691406
time for parepare:  0.00021338462829589844
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00035881996154785156
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.00023365020751953125
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0003256797790527344
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  9.584426879882812e-05
r_  generation:  0.0006868839263916016
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0005338191986083984
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.00047659873962402344
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0004405975341796875
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0005924701690673828
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.0005984306335449219
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.0007145404815673828
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.00038170814514160156
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.00052642822265625
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0003807544708251953
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0002989768981933594
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.0005950927734375
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0005822181701660156
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0003705024719238281
----------------------check_connections_block total spend ----------------------------- 0.01487421989440918
generate_one_block  0.0013730525970458984
generate_one_block  0.0013833045959472656
generate_one_block  0.0019183158874511719
generate_one_block  0.0016398429870605469
generate_one_block  0.001619577407836914
generate_one_block  0.0015268325805664062
generate_one_block  0.0018150806427001953
generate_one_block  0.0016584396362304688
generate_one_block  0.001873016357421875
generate_one_block  0.0014309883117675781
generate_one_block  0.0015757083892822266
generate_one_block  0.00141143798828125
generate_one_block  0.0013723373413085938
generate_one_block  0.0017132759094238281
generate_one_block  0.0016303062438964844
generate_one_block  0.0014209747314453125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008234977722167969
gen group dst list time:  0.00034737586975097656
time for parepare:  0.00019860267639160156
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0003464221954345703
mini_batch_src_global generation:  9.894371032714844e-05
r_  generation:  0.000743865966796875
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.00014901161193847656
r_  generation:  0.0010006427764892578
local_output_nid generation:  0.00010061264038085938
local_in_edges_tensor generation:  0.0002570152282714844
mini_batch_src_global generation:  0.0001957416534423828
r_  generation:  0.0016541481018066406
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.0002319812774658203
mini_batch_src_global generation:  0.00014734268188476562
r_  generation:  0.0012698173522949219
local_output_nid generation:  6.222724914550781e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  0.0001361370086669922
r_  generation:  0.001214742660522461
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00012922286987304688
r_  generation:  0.0010340213775634766
local_output_nid generation:  9.059906005859375e-05
local_in_edges_tensor generation:  0.000240325927734375
mini_batch_src_global generation:  0.00016760826110839844
r_  generation:  0.0015807151794433594
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  0.00015020370483398438
r_  generation:  0.0014495849609375
local_output_nid generation:  9.655952453613281e-05
local_in_edges_tensor generation:  0.0002593994140625
mini_batch_src_global generation:  0.00016427040100097656
r_  generation:  0.001705169677734375
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  0.0001506805419921875
r_  generation:  0.0010535717010498047
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.0011081695556640625
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0009884834289550781
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  0.00011587142944335938
r_  generation:  0.0008563995361328125
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  0.00014090538024902344
r_  generation:  0.0013885498046875
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  0.0001506805419921875
r_  generation:  0.001316070556640625
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.0010716915130615234
----------------------check_connections_block total spend ----------------------------- 0.0320286750793457
generate_one_block  0.002199888229370117
generate_one_block  0.0022096633911132812
generate_one_block  0.0029251575469970703
generate_one_block  0.0027120113372802734
generate_one_block  0.002445697784423828
generate_one_block  0.0022954940795898438
generate_one_block  0.0028755664825439453
generate_one_block  0.0026831626892089844
generate_one_block  0.0029456615447998047
generate_one_block  0.002281665802001953
generate_one_block  0.0023505687713623047
generate_one_block  0.002236604690551758
generate_one_block  0.0020771026611328125
generate_one_block  0.0027070045471191406
generate_one_block  0.0026111602783203125
generate_one_block  0.0023267269134521484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008864402770996094
gen group dst list time:  0.0007295608520507812
time for parepare:  0.0002162456512451172
local_output_nid generation:  9.107589721679688e-05
local_in_edges_tensor generation:  0.0003998279571533203
mini_batch_src_global generation:  0.00013113021850585938
r_  generation:  0.0016748905181884766
local_output_nid generation:  0.00012230873107910156
local_in_edges_tensor generation:  0.00030350685119628906
mini_batch_src_global generation:  0.00022363662719726562
r_  generation:  0.002027750015258789
local_output_nid generation:  0.00016689300537109375
local_in_edges_tensor generation:  0.0003476142883300781
mini_batch_src_global generation:  0.00027680397033691406
r_  generation:  0.002583742141723633
local_output_nid generation:  0.0001285076141357422
local_in_edges_tensor generation:  0.0003113746643066406
mini_batch_src_global generation:  0.0002193450927734375
r_  generation:  0.0022001266479492188
local_output_nid generation:  0.00012135505676269531
local_in_edges_tensor generation:  0.00030541419982910156
mini_batch_src_global generation:  0.00021719932556152344
r_  generation:  0.0022237300872802734
local_output_nid generation:  0.00010752677917480469
local_in_edges_tensor generation:  0.0002815723419189453
mini_batch_src_global generation:  0.00019097328186035156
r_  generation:  0.0020017623901367188
local_output_nid generation:  0.000148773193359375
local_in_edges_tensor generation:  0.00034046173095703125
mini_batch_src_global generation:  0.00024628639221191406
r_  generation:  0.0026292800903320312
local_output_nid generation:  0.00014066696166992188
local_in_edges_tensor generation:  0.0003345012664794922
mini_batch_src_global generation:  0.0002315044403076172
r_  generation:  0.0023102760314941406
local_output_nid generation:  0.00014472007751464844
local_in_edges_tensor generation:  0.0003268718719482422
mini_batch_src_global generation:  0.00022721290588378906
r_  generation:  0.002407550811767578
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.0006191730499267578
mini_batch_src_global generation:  0.00020503997802734375
r_  generation:  0.0019490718841552734
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.000278472900390625
mini_batch_src_global generation:  0.00019216537475585938
r_  generation:  0.0018072128295898438
local_output_nid generation:  0.00011396408081054688
local_in_edges_tensor generation:  0.0002815723419189453
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.0019693374633789062
local_output_nid generation:  9.512901306152344e-05
local_in_edges_tensor generation:  0.00025844573974609375
mini_batch_src_global generation:  0.00018525123596191406
r_  generation:  0.0016829967498779297
local_output_nid generation:  0.0001342296600341797
local_in_edges_tensor generation:  0.0003097057342529297
mini_batch_src_global generation:  0.00023293495178222656
r_  generation:  0.002273082733154297
local_output_nid generation:  0.0001304149627685547
local_in_edges_tensor generation:  0.0003190040588378906
mini_batch_src_global generation:  0.0002224445343017578
r_  generation:  0.0022420883178710938
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.0002911090850830078
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.0020482540130615234
----------------------check_connections_block total spend ----------------------------- 0.05350184440612793
generate_one_block  0.003400087356567383
generate_one_block  0.0033600330352783203
generate_one_block  0.0038840770721435547
generate_one_block  0.0036857128143310547
generate_one_block  0.003426790237426758
generate_one_block  0.0032389163970947266
generate_one_block  0.0038547515869140625
generate_one_block  0.0042035579681396484
generate_one_block  0.003813028335571289
generate_one_block  0.003345012664794922
generate_one_block  0.0031816959381103516
generate_one_block  0.003325223922729492
generate_one_block  0.003144502639770508
generate_one_block  0.003674030303955078
generate_one_block  0.003638744354248047
generate_one_block  0.0034449100494384766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.2618374824523926  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

connection checking time:  0.10627055168151855
block generation total time  0.14053130149841309
average batch blocks generation time:  0.008783206343650818
block dataloader generation time/epoch 0.3937489986419678
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.26227426528930664  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

torch.Size([1767, 1433])
torch.Size([1047, 32])
torch.Size([423, 32])
torch.Size([117, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.7064189910888672  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.2625393867492676  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

torch.Size([1928, 1433])
torch.Size([1281, 32])
torch.Size([539, 32])
torch.Size([136, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.7982058525085449  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.2640080451965332  GigaBytes
Max Memory Allocated: 0.929814338684082  GigaBytes

torch.Size([2196, 1433])
torch.Size([1750, 32])
torch.Size([988, 32])
torch.Size([385, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.9446139335632324  GigaBytes
Max Memory Allocated: 0.9883303642272949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.26308679580688477  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

torch.Size([2028, 1433])
torch.Size([1451, 32])
torch.Size([737, 32])
torch.Size([277, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.841590404510498  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.26297521591186523  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

torch.Size([2008, 1433])
torch.Size([1433, 32])
torch.Size([710, 32])
torch.Size([271, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.8215937614440918  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.26239633560180664  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

torch.Size([1901, 1433])
torch.Size([1244, 32])
torch.Size([571, 32])
torch.Size([213, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.7762646675109863  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.2638692855834961  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

torch.Size([2171, 1433])
torch.Size([1720, 32])
torch.Size([939, 32])
torch.Size([270, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.9420986175537109  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.2635321617126465  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

torch.Size([2109, 1433])
torch.Size([1632, 32])
torch.Size([841, 32])
torch.Size([263, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.9068241119384766  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.263763427734375  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

torch.Size([2150, 1433])
torch.Size([1740, 32])
torch.Size([1033, 32])
torch.Size([377, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.9345874786376953  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.26275157928466797  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

torch.Size([1967, 1433])
torch.Size([1321, 32])
torch.Size([601, 32])
torch.Size([179, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.8071918487548828  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.26194190979003906  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

torch.Size([1815, 1433])
torch.Size([1251, 32])
torch.Size([670, 32])
torch.Size([260, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.7693872451782227  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.2625155448913574  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

torch.Size([1923, 1433])
torch.Size([1350, 32])
torch.Size([580, 32])
torch.Size([190, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.8107328414916992  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.2617983818054199  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

torch.Size([1791, 1433])
torch.Size([1125, 32])
torch.Size([519, 32])
torch.Size([137, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.7253131866455078  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.26374053955078125  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

torch.Size([2148, 1433])
torch.Size([1605, 32])
torch.Size([866, 32])
torch.Size([325, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.8954744338989258  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.2633800506591797  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

torch.Size([2081, 1433])
torch.Size([1558, 32])
torch.Size([809, 32])
torch.Size([281, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.8915538787841797  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.2631802558898926  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

torch.Size([2047, 1433])
torch.Size([1423, 32])
torch.Size([644, 32])
torch.Size([174, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.8333139419555664  GigaBytes
Max Memory Allocated: 1.0411286354064941  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06190776824951172 |0.0009276717901229858 |0.1926773637533188 |0.0001230984926223755 |0.2615461051464081 |0.010657072067260742 |
----------------------------------------------------------pseudo_mini_loss sum 2.2850592136383057
Total (block generation + training)time/epoch 8.754148721694946
Training time/epoch 8.360150575637817
Training time without block to device /epoch 8.34530782699585
Training time without total dataloading part /epoch 7.280202150344849
load block tensor time/epoch 0.9905242919921875
block to device time/epoch 0.014842748641967773
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  71056
Number of first layer input nodes during this epoch:  32030
