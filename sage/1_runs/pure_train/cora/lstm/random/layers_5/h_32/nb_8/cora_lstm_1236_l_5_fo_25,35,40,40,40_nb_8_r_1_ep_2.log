main start at this time 1648432482.45664
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06304550170898438  GigaBytes
Max Memory Allocated: 0.06304550170898438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011260509490966797
random selection method range initialization spend 0.00019931793212890625
time for parepare:  6.604194641113281e-05
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0012459754943847656
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  3.0517578125e-05
----------------------check_connections_block total spend ----------------------------- 0.003088712692260742
generate_one_block  0.001283407211303711
generate_one_block  0.001065969467163086
generate_one_block  0.0010280609130859375
generate_one_block  0.001039266586303711
generate_one_block  0.0010612010955810547
generate_one_block  0.001003265380859375
generate_one_block  0.001001596450805664
generate_one_block  0.0010488033294677734
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005002021789550781
gen group dst list time:  5.888938903808594e-05
time for parepare:  0.00013971328735351562
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00015997886657714844
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00024771690368652344
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.000232696533203125
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00028204917907714844
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0003445148468017578
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0002028942108154297
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00018334388732910156
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00016045570373535156
----------------------check_connections_block total spend ----------------------------- 0.0040476322174072266
generate_one_block  0.0011806488037109375
generate_one_block  0.0013172626495361328
generate_one_block  0.0012819766998291016
generate_one_block  0.0013191699981689453
generate_one_block  0.0013949871063232422
generate_one_block  0.0012366771697998047
generate_one_block  0.001234292984008789
generate_one_block  0.0011560916900634766
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006921291351318359
gen group dst list time:  0.00010228157043457031
time for parepare:  0.0001876354217529297
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00024366378784179688
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0005636215209960938
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  9.584426879882812e-05
r_  generation:  0.0009329319000244141
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0007889270782470703
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.0009143352508544922
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.00010943412780761719
r_  generation:  0.0010161399841308594
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  9.465217590332031e-05
r_  generation:  0.0007290840148925781
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0006310939788818359
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0005323886871337891
----------------------check_connections_block total spend ----------------------------- 0.010389566421508789
generate_one_block  0.0017261505126953125
generate_one_block  0.002086162567138672
generate_one_block  0.0018062591552734375
generate_one_block  0.0019762516021728516
generate_one_block  0.002054929733276367
generate_one_block  0.001825571060180664
generate_one_block  0.0016527175903320312
generate_one_block  0.0015461444854736328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007488727569580078
gen group dst list time:  0.0001952648162841797
time for parepare:  0.000194549560546875
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.0003418922424316406
mini_batch_src_global generation:  0.00010824203491210938
r_  generation:  0.0013310909271240234
local_output_nid generation:  9.584426879882812e-05
local_in_edges_tensor generation:  0.0002713203430175781
mini_batch_src_global generation:  0.0001823902130126953
r_  generation:  0.002024412155151367
local_output_nid generation:  9.465217590332031e-05
local_in_edges_tensor generation:  0.00024509429931640625
mini_batch_src_global generation:  0.00019979476928710938
r_  generation:  0.0018923282623291016
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.0002608299255371094
mini_batch_src_global generation:  0.00018310546875
r_  generation:  0.0019540786743164062
local_output_nid generation:  9.608268737792969e-05
local_in_edges_tensor generation:  0.00028777122497558594
mini_batch_src_global generation:  0.00019812583923339844
r_  generation:  0.0020639896392822266
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  0.00016307830810546875
r_  generation:  0.0017015933990478516
local_output_nid generation:  7.343292236328125e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  0.00014925003051757812
r_  generation:  0.0015099048614501953
local_output_nid generation:  6.842613220214844e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  0.00014472007751464844
r_  generation:  0.00141143798828125
----------------------check_connections_block total spend ----------------------------- 0.021468162536621094
generate_one_block  0.002731800079345703
generate_one_block  0.003044605255126953
generate_one_block  0.0029363632202148438
generate_one_block  0.003057241439819336
generate_one_block  0.0033478736877441406
generate_one_block  0.002748727798461914
generate_one_block  0.0026171207427978516
generate_one_block  0.0025873184204101562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007557868957519531
gen group dst list time:  0.00031566619873046875
time for parepare:  0.00018596649169921875
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.00041675567626953125
mini_batch_src_global generation:  0.00020575523376464844
r_  generation:  0.002199888229370117
local_output_nid generation:  0.00014019012451171875
local_in_edges_tensor generation:  0.00032591819763183594
mini_batch_src_global generation:  0.00031828880310058594
r_  generation:  0.0027217864990234375
local_output_nid generation:  0.00013756752014160156
local_in_edges_tensor generation:  0.0003509521484375
mini_batch_src_global generation:  0.00024127960205078125
r_  generation:  0.0027115345001220703
local_output_nid generation:  0.0001385211944580078
local_in_edges_tensor generation:  0.00034618377685546875
mini_batch_src_global generation:  0.00024366378784179688
r_  generation:  0.0027573108673095703
local_output_nid generation:  0.0001399517059326172
local_in_edges_tensor generation:  0.00035071372985839844
mini_batch_src_global generation:  0.00025010108947753906
r_  generation:  0.002665996551513672
local_output_nid generation:  0.00011944770812988281
local_in_edges_tensor generation:  0.00030994415283203125
mini_batch_src_global generation:  0.00021576881408691406
r_  generation:  0.002297639846801758
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.0002765655517578125
mini_batch_src_global generation:  0.00020003318786621094
r_  generation:  0.0022478103637695312
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.0002703666687011719
mini_batch_src_global generation:  0.0001995563507080078
r_  generation:  0.0022203922271728516
----------------------check_connections_block total spend ----------------------------- 0.030279159545898438
generate_one_block  0.004239559173583984
generate_one_block  0.003755331039428711
generate_one_block  0.0037927627563476562
generate_one_block  0.004345893859863281
generate_one_block  0.003943204879760742
generate_one_block  0.0035393238067626953
generate_one_block  0.003515481948852539
generate_one_block  0.0035021305084228516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06304550170898438  GigaBytes
Max Memory Allocated: 0.06304550170898438  GigaBytes

connection checking time:  0.06618452072143555
block generation total time  0.07850003242492676
average batch blocks generation time:  0.009812504053115845
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07486486434936523  GigaBytes
Max Memory Allocated: 0.07486486434936523  GigaBytes

torch.Size([2111, 1433])
torch.Size([1519, 32])
torch.Size([792, 32])
torch.Size([302, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9217529296875 GB
    Memory Allocated: 0.6753864288330078  GigaBytes
Max Memory Allocated: 0.7151975631713867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0155029296875 GB
    Memory Allocated: 0.1383366584777832  GigaBytes
Max Memory Allocated: 0.7765974998474121  GigaBytes

torch.Size([2269, 1433])
torch.Size([1943, 32])
torch.Size([1266, 32])
torch.Size([534, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.8782806396484375  GigaBytes
Max Memory Allocated: 0.9231371879577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.13844823837280273  GigaBytes
Max Memory Allocated: 0.9694762229919434  GigaBytes

torch.Size([2291, 1433])
torch.Size([1929, 32])
torch.Size([1170, 32])
torch.Size([405, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.8716702461242676  GigaBytes
Max Memory Allocated: 0.9694762229919434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.13840341567993164  GigaBytes
Max Memory Allocated: 0.9694762229919434  GigaBytes

torch.Size([2281, 1433])
torch.Size([1954, 32])
torch.Size([1241, 32])
torch.Size([518, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.8837985992431641  GigaBytes
Max Memory Allocated: 0.9694762229919434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.1385960578918457  GigaBytes
Max Memory Allocated: 0.9739556312561035  GigaBytes

torch.Size([2316, 1433])
torch.Size([2006, 32])
torch.Size([1343, 32])
torch.Size([583, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.9049177169799805  GigaBytes
Max Memory Allocated: 0.9739556312561035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.1379232406616211  GigaBytes
Max Memory Allocated: 0.9928250312805176  GigaBytes

torch.Size([2125, 1433])
torch.Size([1690, 32])
torch.Size([1024, 32])
torch.Size([405, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 0.7881636619567871  GigaBytes
Max Memory Allocated: 0.9928250312805176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 0.13791751861572266  GigaBytes
Max Memory Allocated: 0.9928250312805176  GigaBytes

torch.Size([2114, 1433])
torch.Size([1657, 32])
torch.Size([929, 32])
torch.Size([346, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 0.7839641571044922  GigaBytes
Max Memory Allocated: 0.9928250312805176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 0.13791275024414062  GigaBytes
Max Memory Allocated: 0.9928250312805176  GigaBytes

torch.Size([2103, 1433])
torch.Size([1607, 32])
torch.Size([869, 32])
torch.Size([271, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 0.7766666412353516  GigaBytes
Max Memory Allocated: 0.9928250312805176  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.058837950229644775 |0.04329976439476013 |0.2755005955696106 |0.00012606382369995117 |0.3002760112285614 |0.01758599281311035 |
----------------------------------------------------------pseudo_mini_loss sum 2.9823179244995117
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  44670
Number of first layer input nodes during this epoch:  17610
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.2641744613647461  GigaBytes
Max Memory Allocated: 0.9928250312805176  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005545616149902344
random selection method range initialization spend 0.00015282630920410156
time for parepare:  8.368492126464844e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.078315734863281e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.029273986816406e-05
----------------------check_connections_block total spend ----------------------------- 0.0019974708557128906
generate_one_block  0.0012412071228027344
generate_one_block  0.0010914802551269531
generate_one_block  0.001117706298828125
generate_one_block  0.0010960102081298828
generate_one_block  0.0011227130889892578
generate_one_block  0.0010619163513183594
generate_one_block  0.0010485649108886719
generate_one_block  0.0010652542114257812
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005419254302978516
gen group dst list time:  6.699562072753906e-05
time for parepare:  0.00017786026000976562
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0001461505889892578
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00027060508728027344
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0002598762512207031
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0002803802490234375
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003020763397216797
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0002219676971435547
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00022292137145996094
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00024056434631347656
----------------------check_connections_block total spend ----------------------------- 0.004462242126464844
generate_one_block  0.0012314319610595703
generate_one_block  0.0014019012451171875
generate_one_block  0.001361846923828125
generate_one_block  0.0014393329620361328
generate_one_block  0.001394033432006836
generate_one_block  0.0012845993041992188
generate_one_block  0.0012764930725097656
generate_one_block  0.001275777816772461
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007326602935791016
gen group dst list time:  0.00011849403381347656
time for parepare:  0.00020599365234375
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0003058910369873047
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0004901885986328125
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.0009694099426269531
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.0008466243743896484
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.00011396408081054688
r_  generation:  0.0008988380432128906
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  0.00011992454528808594
r_  generation:  0.0009369850158691406
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  0.00011467933654785156
r_  generation:  0.0008175373077392578
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.0007350444793701172
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  0.00010919570922851562
r_  generation:  0.0008203983306884766
----------------------check_connections_block total spend ----------------------------- 0.011496782302856445
generate_one_block  0.001703500747680664
generate_one_block  0.002144336700439453
generate_one_block  0.0019986629486083984
generate_one_block  0.002080202102661133
generate_one_block  0.002104520797729492
generate_one_block  0.001977205276489258
generate_one_block  0.0018777847290039062
generate_one_block  0.0019614696502685547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007963180541992188
gen group dst list time:  0.00021791458129882812
time for parepare:  0.00020456314086914062
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.00038123130798339844
mini_batch_src_global generation:  0.00016450881958007812
r_  generation:  0.0014488697052001953
local_output_nid generation:  0.00012230873107910156
local_in_edges_tensor generation:  0.0002722740173339844
mini_batch_src_global generation:  0.00021886825561523438
r_  generation:  0.0019621849060058594
local_output_nid generation:  0.00010085105895996094
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  0.00017762184143066406
r_  generation:  0.0018270015716552734
local_output_nid generation:  0.00011897087097167969
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  0.00018215179443359375
r_  generation:  0.0019855499267578125
local_output_nid generation:  0.00011038780212402344
local_in_edges_tensor generation:  0.00027060508728027344
mini_batch_src_global generation:  0.0001957416534423828
r_  generation:  0.0019652843475341797
local_output_nid generation:  0.00010156631469726562
local_in_edges_tensor generation:  0.00046634674072265625
mini_batch_src_global generation:  0.000179290771484375
r_  generation:  0.0018205642700195312
local_output_nid generation:  9.083747863769531e-05
local_in_edges_tensor generation:  0.00024390220642089844
mini_batch_src_global generation:  0.00017642974853515625
r_  generation:  0.0016312599182128906
local_output_nid generation:  9.965896606445312e-05
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  0.00017714500427246094
r_  generation:  0.0018112659454345703
----------------------check_connections_block total spend ----------------------------- 0.0230560302734375
generate_one_block  0.0028617382049560547
generate_one_block  0.003194570541381836
generate_one_block  0.0030574798583984375
generate_one_block  0.0032148361206054688
generate_one_block  0.0031850337982177734
generate_one_block  0.0030336380004882812
generate_one_block  0.002889871597290039
generate_one_block  0.003120899200439453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007627010345458984
gen group dst list time:  0.00039958953857421875
time for parepare:  0.0002200603485107422
local_output_nid generation:  0.00014352798461914062
local_in_edges_tensor generation:  0.0004620552062988281
mini_batch_src_global generation:  0.0001957416534423828
r_  generation:  0.0024118423461914062
local_output_nid generation:  0.00016832351684570312
local_in_edges_tensor generation:  0.00033974647521972656
mini_batch_src_global generation:  0.00027060508728027344
r_  generation:  0.0027735233306884766
local_output_nid generation:  0.0001595020294189453
local_in_edges_tensor generation:  0.0003266334533691406
mini_batch_src_global generation:  0.00023627281188964844
r_  generation:  0.002783536911010742
local_output_nid generation:  0.000164031982421875
local_in_edges_tensor generation:  0.0003314018249511719
mini_batch_src_global generation:  0.00023984909057617188
r_  generation:  0.002829313278198242
local_output_nid generation:  0.00015974044799804688
local_in_edges_tensor generation:  0.00032448768615722656
mini_batch_src_global generation:  0.00023293495178222656
r_  generation:  0.002706766128540039
local_output_nid generation:  0.00014257431030273438
local_in_edges_tensor generation:  0.00030350685119628906
mini_batch_src_global generation:  0.0002181529998779297
r_  generation:  0.0024945735931396484
local_output_nid generation:  0.00014400482177734375
local_in_edges_tensor generation:  0.00029754638671875
mini_batch_src_global generation:  0.00021505355834960938
r_  generation:  0.0025098323822021484
local_output_nid generation:  0.00015473365783691406
local_in_edges_tensor generation:  0.00031065940856933594
mini_batch_src_global generation:  0.00022602081298828125
r_  generation:  0.0025730133056640625
----------------------check_connections_block total spend ----------------------------- 0.03194546699523926
generate_one_block  0.004546165466308594
generate_one_block  0.004096269607543945
generate_one_block  0.0039000511169433594
generate_one_block  0.0039730072021484375
generate_one_block  0.004289865493774414
generate_one_block  0.003753662109375
generate_one_block  0.0038230419158935547
generate_one_block  0.003882884979248047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.2641744613647461  GigaBytes
Max Memory Allocated: 0.9928250312805176  GigaBytes

connection checking time:  0.07096052169799805
block generation total time  0.08333611488342285
average batch blocks generation time:  0.010417014360427856
block dataloader generation time/epoch 0.2370612621307373
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.26398754119873047  GigaBytes
Max Memory Allocated: 0.9928250312805176  GigaBytes

torch.Size([2096, 1433])
torch.Size([1617, 32])
torch.Size([837, 32])
torch.Size([244, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.9077110290527344  GigaBytes
Max Memory Allocated: 0.9928250312805176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.2645230293273926  GigaBytes
Max Memory Allocated: 1.006631851196289  GigaBytes

torch.Size([2289, 1433])
torch.Size([1923, 32])
torch.Size([1220, 32])
torch.Size([531, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 1.0026068687438965  GigaBytes
Max Memory Allocated: 1.0486712455749512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.26436567306518555  GigaBytes
Max Memory Allocated: 1.093554973602295  GigaBytes

torch.Size([2261, 1433])
torch.Size([1867, 32])
torch.Size([1133, 32])
torch.Size([470, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.979550838470459  GigaBytes
Max Memory Allocated: 1.093554973602295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.26427173614501953  GigaBytes
Max Memory Allocated: 1.093554973602295  GigaBytes

torch.Size([2242, 1433])
torch.Size([1917, 32])
torch.Size([1247, 32])
torch.Size([463, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.9952607154846191  GigaBytes
Max Memory Allocated: 1.093554973602295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.26431894302368164  GigaBytes
Max Memory Allocated: 1.093554973602295  GigaBytes

torch.Size([2251, 1433])
torch.Size([1882, 32])
torch.Size([1236, 32])
torch.Size([498, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.9824700355529785  GigaBytes
Max Memory Allocated: 1.093554973602295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.2640094757080078  GigaBytes
Max Memory Allocated: 1.093554973602295  GigaBytes

torch.Size([2146, 1433])
torch.Size([1760, 32])
torch.Size([1116, 32])
torch.Size([441, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.9490437507629395  GigaBytes
Max Memory Allocated: 1.093554973602295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.2643723487854004  GigaBytes
Max Memory Allocated: 1.093554973602295  GigaBytes

torch.Size([2264, 1433])
torch.Size([1769, 32])
torch.Size([1043, 32])
torch.Size([402, 32])Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.9527950286865234  GigaBytes
Max Memory Allocated: 1.093554973602295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.26418066024780273  GigaBytes
Max Memory Allocated: 1.093554973602295  GigaBytes

torch.Size([2226, 1433])
torch.Size([1891, 32])
torch.Size([1196, 32])
torch.Size([442, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.9832220077514648  GigaBytes
Max Memory Allocated: 1.093554973602295  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.060693591833114624 |0.0008851885795593262 |0.21870648860931396 |0.0001208186149597168 |0.29507747292518616 |0.014148235321044922 |
----------------------------------------------------------pseudo_mini_loss sum 2.1919758319854736
Total (block generation + training)time/epoch 4.922166347503662
Training time/epoch 4.684866905212402
Training time without block to device /epoch 4.677785396575928
Training time without total dataloading part /epoch 4.125386476516724
load block tensor time/epoch 0.485548734664917
block to device time/epoch 0.007081508636474609
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  45681
Number of first layer input nodes during this epoch:  17775
