main start at this time 1648432468.0820806
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06304550170898438  GigaBytes
Max Memory Allocated: 0.06304550170898438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0014395713806152344
random selection method range initialization spend 0.0001952648162841797
time for parepare:  6.723403930664062e-05
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.001990079879760742
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.106231689453125e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.650520324707031e-05
----------------------check_connections_block total spend ----------------------------- 0.003251314163208008
generate_one_block  0.0014772415161132812
generate_one_block  0.001096963882446289
generate_one_block  0.0010921955108642578
generate_one_block  0.0010633468627929688
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004916191101074219
gen group dst list time:  3.981590270996094e-05
time for parepare:  0.00014019012451171875
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0003399848937988281
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0004417896270751953
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0004749298095703125
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0003190040588378906
----------------------check_connections_block total spend ----------------------------- 0.0030794143676757812
generate_one_block  0.0014271736145019531
generate_one_block  0.0015177726745605469
generate_one_block  0.0015757083892822266
generate_one_block  0.0014178752899169922
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005815029144287109
gen group dst list time:  7.390975952148438e-05
time for parepare:  0.00017690658569335938
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.0002799034118652344
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0010936260223388672
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00020956993103027344
mini_batch_src_global generation:  0.000133514404296875
r_  generation:  0.0013103485107421875
local_output_nid generation:  6.222724914550781e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.0001461505889892578
r_  generation:  0.0013854503631591797
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.0009419918060302734
----------------------check_connections_block total spend ----------------------------- 0.0077021121978759766
generate_one_block  0.002306222915649414
generate_one_block  0.002531290054321289
generate_one_block  0.0025479793548583984
generate_one_block  0.0020265579223632812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007374286651611328
gen group dst list time:  0.00012993812561035156
time for parepare:  0.0001881122589111328
local_output_nid generation:  9.34600830078125e-05
local_in_edges_tensor generation:  0.0003733634948730469
mini_batch_src_global generation:  0.00015926361083984375
r_  generation:  0.002182483673095703
local_output_nid generation:  0.00011134147644042969
local_in_edges_tensor generation:  0.00029349327087402344
mini_batch_src_global generation:  0.0002777576446533203
r_  generation:  0.0024118423461914062
local_output_nid generation:  0.00011396408081054688
local_in_edges_tensor generation:  0.00029349327087402344
mini_batch_src_global generation:  0.00021195411682128906
r_  generation:  0.002415895462036133
local_output_nid generation:  9.465217590332031e-05
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.00018858909606933594
r_  generation:  0.002022981643676758
----------------------check_connections_block total spend ----------------------------- 0.013938426971435547
generate_one_block  0.0034112930297851562
generate_one_block  0.003509521484375
generate_one_block  0.0036537647247314453
generate_one_block  0.003125429153442383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007560253143310547
gen group dst list time:  0.00018167495727539062
time for parepare:  0.00020241737365722656
local_output_nid generation:  0.0001342296600341797
local_in_edges_tensor generation:  0.00046563148498535156
mini_batch_src_global generation:  0.000232696533203125
r_  generation:  0.002850770950317383
local_output_nid generation:  0.00014972686767578125
local_in_edges_tensor generation:  0.0003521442413330078
mini_batch_src_global generation:  0.00030159950256347656
r_  generation:  0.0029501914978027344
local_output_nid generation:  0.00014853477478027344
local_in_edges_tensor generation:  0.00034332275390625
mini_batch_src_global generation:  0.000244140625
r_  generation:  0.0029544830322265625
local_output_nid generation:  0.00014090538024902344
local_in_edges_tensor generation:  0.0003237724304199219
mini_batch_src_global generation:  0.00023674964904785156
r_  generation:  0.002766847610473633
----------------------check_connections_block total spend ----------------------------- 0.017426013946533203
generate_one_block  0.004166841506958008
generate_one_block  0.004760265350341797
generate_one_block  0.004106044769287109
generate_one_block  0.0038366317749023438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06304550170898438  GigaBytes
Max Memory Allocated: 0.06304550170898438  GigaBytes

connection checking time:  0.04214596748352051
block generation total time  0.045920372009277344
average batch blocks generation time:  0.011480093002319336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07563161849975586  GigaBytes
Max Memory Allocated: 0.07563161849975586  GigaBytes

torch.Size([2329, 1433])
torch.Size([2068, 32])
torch.Size([1425, 32])
torch.Size([645, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1112060546875 GB
    Memory Allocated: 0.8550014495849609  GigaBytes
Max Memory Allocated: 0.9012660980224609  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.13826799392700195  GigaBytes
Max Memory Allocated: 0.9421210289001465  GigaBytes

torch.Size([2372, 1433])
torch.Size([2160, 32])
torch.Size([1594, 32])
torch.Size([759, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.9396581649780273  GigaBytes
Max Memory Allocated: 0.9841036796569824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.13814592361450195  GigaBytes
Max Memory Allocated: 1.0222759246826172  GigaBytes

torch.Size([2349, 1433])
torch.Size([2156, 32])
torch.Size([1635, 32])
torch.Size([846, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.9388165473937988  GigaBytes
Max Memory Allocated: 1.0222759246826172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.13774681091308594  GigaBytes
Max Memory Allocated: 1.0222759246826172  GigaBytes

torch.Size([2279, 1433])
torch.Size([1968, 32])
torch.Size([1295, 32])
torch.Size([556, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.8904690742492676  GigaBytes
Max Memory Allocated: 1.0222759246826172  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05962103605270386 |0.08646512031555176 |0.36279362440109253 |0.00016677379608154297 |0.3153480291366577 |0.018100738525390625 |
----------------------------------------------------------pseudo_mini_loss sum 3.127405881881714
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27162
Number of first layer input nodes during this epoch:  9329
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4139404296875 GB
    Memory Allocated: 0.2640819549560547  GigaBytes
Max Memory Allocated: 1.0222759246826172  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000537872314453125
random selection method range initialization spend 0.00012993812561035156
time for parepare:  8.034706115722656e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  6.67572021484375e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  7.700920104980469e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.2479248046875e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  6.67572021484375e-05
----------------------check_connections_block total spend ----------------------------- 0.0013153553009033203
generate_one_block  0.0012466907501220703
generate_one_block  0.0011456012725830078
generate_one_block  0.0011403560638427734
generate_one_block  0.0011811256408691406
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005390644073486328
gen group dst list time:  6.794929504394531e-05
time for parepare:  0.0001621246337890625
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.00035953521728515625
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.00044345855712890625
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.00042819976806640625
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0004382133483886719
----------------------check_connections_block total spend ----------------------------- 0.003390789031982422
generate_one_block  0.0017092227935791016
generate_one_block  0.0016248226165771484
generate_one_block  0.0015587806701660156
generate_one_block  0.0015821456909179688
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005934238433837891
gen group dst list time:  8.58306884765625e-05
time for parepare:  0.00019049644470214844
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00027561187744140625
mini_batch_src_global generation:  0.0001266002655029297
r_  generation:  0.0011115074157714844
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.0001552104949951172
r_  generation:  0.0012984275817871094
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.0012364387512207031
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.00014019012451171875
r_  generation:  0.0013782978057861328
----------------------check_connections_block total spend ----------------------------- 0.008254766464233398
generate_one_block  0.0024950504302978516
generate_one_block  0.0026531219482421875
generate_one_block  0.002466917037963867
generate_one_block  0.0025873184204101562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007927417755126953
gen group dst list time:  0.0001423358917236328
time for parepare:  0.00019049644470214844
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.00040268898010253906
mini_batch_src_global generation:  0.0001888275146484375
r_  generation:  0.0021517276763916016
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.0002980232238769531
mini_batch_src_global generation:  0.00024628639221191406
r_  generation:  0.002377033233642578
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.00028705596923828125
mini_batch_src_global generation:  0.00020813941955566406
r_  generation:  0.002216815948486328
local_output_nid generation:  0.00013113021850585938
local_in_edges_tensor generation:  0.0002970695495605469
mini_batch_src_global generation:  0.0002262592315673828
r_  generation:  0.002471446990966797
----------------------check_connections_block total spend ----------------------------- 0.014402389526367188
generate_one_block  0.0038895606994628906
generate_one_block  0.0036427974700927734
generate_one_block  0.0034482479095458984
generate_one_block  0.0037031173706054688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008053779602050781
gen group dst list time:  0.0001926422119140625
time for parepare:  0.0002071857452392578
local_output_nid generation:  0.00016427040100097656
local_in_edges_tensor generation:  0.00044226646423339844
mini_batch_src_global generation:  0.0002586841583251953
r_  generation:  0.002864837646484375
local_output_nid generation:  0.000171661376953125
local_in_edges_tensor generation:  0.00036716461181640625
mini_batch_src_global generation:  0.0003228187561035156
r_  generation:  0.0030450820922851562
local_output_nid generation:  0.0001647472381591797
local_in_edges_tensor generation:  0.0003426074981689453
mini_batch_src_global generation:  0.00023674964904785156
r_  generation:  0.0028111934661865234
local_output_nid generation:  0.00017333030700683594
local_in_edges_tensor generation:  0.00035858154296875
mini_batch_src_global generation: Using backend: pytorch
 0.0002498626708984375
r_  generation:  0.0030138492584228516
----------------------check_connections_block total spend ----------------------------- 0.019066572189331055
generate_one_block  0.004148244857788086
generate_one_block  0.00437617301940918
generate_one_block  0.003964424133300781
generate_one_block  0.00418853759765625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4139404296875 GB
    Memory Allocated: 0.2640819549560547  GigaBytes
Max Memory Allocated: 1.0222759246826172  GigaBytes

connection checking time:  0.04511451721191406
block generation total time  0.048038482666015625
average batch blocks generation time:  0.012009620666503906
block dataloader generation time/epoch 0.14047789573669434
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4139404296875 GB
    Memory Allocated: 0.2640986442565918  GigaBytes
Max Memory Allocated: 1.0222759246826172  GigaBytes

torch.Size([2329, 1433])
torch.Size([2035, 32])
torch.Size([1394, 32])
torch.Size([647, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4139404296875 GB
    Memory Allocated: 1.0316176414489746  GigaBytes
Max Memory Allocated: 1.0763354301452637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4139404296875 GB
    Memory Allocated: 0.26430511474609375  GigaBytes
Max Memory Allocated: 1.119469165802002  GigaBytes

torch.Size([2365, 1433])
torch.Size([2153, 32])
torch.Size([1558, 32])
torch.Size([727, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4158935546875 GB
    Memory Allocated: 1.0662670135498047  GigaBytes
Max Memory Allocated: 1.119469165802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 0.26399660110473633  GigaBytes
Max Memory Allocated: 1.1506619453430176  GigaBytes

torch.Size([2309, 1433])
torch.Size([2005, 32])
torch.Size([1447, 32])
torch.Size([697, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 1.0158610343933105  GigaBytes
Max Memory Allocated: 1.1506619453430176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 0.2645416259765625  GigaBytes
Max Memory Allocated: 1.1506619453430176  GigaBytes

torch.Size([2408, 1433])
torch.Size([2189, 32])
torch.Size([1644, 32])
torch.Size([784, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 1.0867795944213867  GigaBytes
Max Memory Allocated: 1.1506619453430176  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.052603065967559814 |0.0010633468627929688 |0.2483929991722107 |0.00012820959091186523 |0.3244445323944092 |0.013222455978393555 |
----------------------------------------------------------pseudo_mini_loss sum 2.418168306350708
Total (block generation + training)time/epoch 2.7262468338012695
Training time/epoch 2.5854969024658203
Training time without block to device /epoch 2.5812435150146484
Training time without total dataloading part /epoch 2.3050854206085205
load block tensor time/epoch 0.21041226387023926
block to device time/epoch 0.004253387451171875
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27425
Number of first layer input nodes during this epoch:  9411
