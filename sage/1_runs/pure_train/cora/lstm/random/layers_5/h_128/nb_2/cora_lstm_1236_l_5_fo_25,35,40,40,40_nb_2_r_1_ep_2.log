main start at this time 1648432600.0554736
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06626033782958984  GigaBytes
Max Memory Allocated: 0.06626033782958984  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012481212615966797
random selection method range initialization spend 0.0001990795135498047
time for parepare:  6.29425048828125e-05
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0026323795318603516
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001270771026611328
----------------------check_connections_block total spend ----------------------------- 0.0034515857696533203
generate_one_block  0.0013208389282226562
generate_one_block  0.0012271404266357422
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000492095947265625
gen group dst list time:  2.8133392333984375e-05
time for parepare:  0.00013375282287597656
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0005872249603271484
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0007038116455078125
----------------------check_connections_block total spend ----------------------------- 0.0023589134216308594
generate_one_block  0.0017547607421875
generate_one_block  0.001800537109375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005848407745361328
gen group dst list time:  5.5789947509765625e-05
time for parepare:  0.00017690658569335938
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.0003387928009033203
mini_batch_src_global generation:  0.0001659393310546875
r_  generation:  0.0016021728515625
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.00024247169494628906
mini_batch_src_global generation:  0.00018024444580078125
r_  generation:  0.0018193721771240234
----------------------check_connections_block total spend ----------------------------- 0.0055086612701416016
generate_one_block  0.0028688907623291016
generate_one_block  0.002941131591796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006589889526367188
gen group dst list time:  8.678436279296875e-05
time for parepare:  0.0001926422119140625
local_output_nid generation:  0.00012230873107910156
local_in_edges_tensor generation:  0.0004076957702636719
mini_batch_src_global generation:  0.00017881393432617188
r_  generation:  0.0025839805603027344
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.00033020973205566406
mini_batch_src_global generation:  0.0002624988555908203
r_  generation:  0.0027358531951904297
----------------------check_connections_block total spend ----------------------------- 0.008188247680664062
generate_one_block  0.003787517547607422
generate_one_block  0.003991127014160156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007429122924804688
gen group dst list time:  0.00010323524475097656
time for parepare:  0.00017595291137695312
local_output_nid generation:  0.0001404285430908203
local_in_edges_tensor generation:  0.0004420280456542969
mini_batch_src_global generation:  0.00019741058349609375
r_  generation:  0.003024578094482422
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.0003578662872314453
mini_batch_src_global generation:  0.0002582073211669922
r_  generation:  0.0031023025512695312
----------------------check_connections_block total spend ----------------------------- 0.00914311408996582
generate_one_block  0.004178762435913086
generate_one_block  0.004274606704711914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06626033782958984  GigaBytes
Max Memory Allocated: 0.06626033782958984  GigaBytes

connection checking time:  0.025198936462402344
block generation total time  0.025597333908081055
average batch blocks generation time:  0.012798666954040527
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.0801229476928711  GigaBytes
Max Memory Allocated: 0.0801229476928711  GigaBytes

torch.Size([2453, 1433])
torch.Size([2285, 128])
torch.Size([1850, 128])
torch.Size([1047, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2908935546875 GB
    Memory Allocated: 1.0206904411315918  GigaBytes
Max Memory Allocated: 1.0209031105041504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3865966796875 GB
    Memory Allocated: 0.14574050903320312  GigaBytes
Max Memory Allocated: 1.0215187072753906  GigaBytes

torch.Size([2481, 1433])
torch.Size([2361, 128])
torch.Size([1971, 128])
torch.Size([1178, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4530029296875 GB
    Memory Allocated: 1.119922161102295  GigaBytes
Max Memory Allocated: 1.1201729774475098  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04478931427001953 |0.1731867790222168 |0.4980435371398926 |0.00021207332611083984 |0.36120593547821045 |0.01810908317565918 |
----------------------------------------------------------pseudo_mini_loss sum 3.1471986770629883
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16327
Number of first layer input nodes during this epoch:  4934
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6092529296875 GB
    Memory Allocated: 0.27797508239746094  GigaBytes
Max Memory Allocated: 1.1207060813903809  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000492095947265625
random selection method range initialization spend 0.00011801719665527344
time for parepare:  7.081031799316406e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00011587142944335938
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00012636184692382812
----------------------check_connections_block total spend ----------------------------- 0.0008950233459472656
generate_one_block  0.0013012886047363281
generate_one_block  0.0011925697326660156
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00048732757568359375
gen group dst list time:  3.1948089599609375e-05
time for parepare:  0.00014829635620117188
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00023174285888671875
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0006768703460693359
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00015926361083984375Using backend: pytorch

mini_batch_src_global generation:  0.00010514259338378906
r_  generation:  0.0006613731384277344
----------------------check_connections_block total spend ----------------------------- 0.0026268959045410156
generate_one_block  0.0019681453704833984
generate_one_block  0.0022504329681396484
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005748271942138672
gen group dst list time:  5.793571472167969e-05
time for parepare:  0.00018167495727539062
local_output_nid generation:  9.417533874511719e-05
local_in_edges_tensor generation:  0.00032973289489746094
mini_batch_src_global generation:  0.00017118453979492188
r_  generation:  0.0018434524536132812
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  0.00021767616271972656
r_  generation:  0.001617431640625
----------------------check_connections_block total spend ----------------------------- 0.005654573440551758
generate_one_block  0.0032401084899902344
generate_one_block  0.002972841262817383
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005996227264404297
gen group dst list time:  8.58306884765625e-05
time for parepare:  0.00018715858459472656
local_output_nid generation:  0.00013303756713867188
local_in_edges_tensor generation:  0.0004143714904785156
mini_batch_src_global generation:  0.0001990795135498047
r_  generation:  0.0026810169219970703
local_output_nid generation:  0.00013256072998046875
local_in_edges_tensor generation:  0.0004394054412841797
mini_batch_src_global generation:  0.0002865791320800781
r_  generation:  0.0025517940521240234
----------------------check_connections_block total spend ----------------------------- 0.008446455001831055
generate_one_block  0.004015445709228516
generate_one_block  0.0039064884185791016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007464885711669922
gen group dst list time:  0.00010633468627929688
time for parepare:  0.0001742839813232422
local_output_nid generation:  0.0001513957977294922
local_in_edges_tensor generation:  0.0004398822784423828
mini_batch_src_global generation:  0.00019931793212890625
r_  generation:  0.002979755401611328
local_output_nid generation:  0.00016069412231445312
local_in_edges_tensor generation:  0.0003533363342285156
mini_batch_src_global generation:  0.0003018379211425781
r_  generation:  0.0030829906463623047
----------------------check_connections_block total spend ----------------------------- 0.009212255477905273
generate_one_block  0.004457712173461914
generate_one_block  0.005414485931396484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6092529296875 GB
    Memory Allocated: 0.27797508239746094  GigaBytes
Max Memory Allocated: 1.1207060813903809  GigaBytes

connection checking time:  0.0259401798248291
block generation total time  0.02822566032409668
average batch blocks generation time:  0.01411283016204834
block dataloader generation time/epoch 0.08030176162719727
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6092529296875 GB
    Memory Allocated: 0.27759456634521484  GigaBytes
Max Memory Allocated: 1.1207060813903809  GigaBytes

torch.Size([2419, 1433])
torch.Size([2291, 128])
torch.Size([1917, 128])
torch.Size([1178, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 1.221527099609375  GigaBytes
Max Memory Allocated: 1.2217564582824707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.2775907516479492  GigaBytes
Max Memory Allocated: 1.2223248481750488  GigaBytes

torch.Size([2459, 1433])
torch.Size([2304, 128])
torch.Size([1853, 128])
torch.Size([1052, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 1.2205605506896973  GigaBytes
Max Memory Allocated: 1.2223248481750488  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03802490234375 |0.0008903741836547852 |0.2652527093887329 |0.00013113021850585938 |0.37022340297698975 |0.013810157775878906 |
----------------------------------------------------------pseudo_mini_loss sum 2.5657224655151367
Total (block generation + training)time/epoch 1.5070512294769287
Training time/epoch 1.4264750480651855
Training time without block to device /epoch 1.424694299697876
Training time without total dataloading part /epoch 1.285024642944336
load block tensor time/epoch 0.0760498046875
block to device time/epoch 0.0017807483673095703
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16173
Number of first layer input nodes during this epoch:  4878
