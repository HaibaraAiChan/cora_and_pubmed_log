main start at this time 1648432645.803488
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06626033782958984  GigaBytes
Max Memory Allocated: 0.06626033782958984  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0014767646789550781
random selection method range initialization spend 0.0001976490020751953
time for parepare:  6.341934204101562e-05
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.0020673274993896484
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.726119995117188e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6689300537109375e-05
----------------------check_connections_block total spend ----------------------------- 0.0050809383392333984
generate_one_block  0.0012335777282714844
generate_one_block  0.0010385513305664062
generate_one_block  0.0010287761688232422
generate_one_block  0.0010967254638671875
generate_one_block  0.0010325908660888672
generate_one_block  0.0010194778442382812
generate_one_block  0.0010938644409179688
generate_one_block  0.001066446304321289
generate_one_block  0.0010175704956054688
generate_one_block  0.0010156631469726562
generate_one_block  0.0010783672332763672
generate_one_block  0.0010166168212890625
generate_one_block  0.0010297298431396484
generate_one_block  0.0010275840759277344
generate_one_block  0.0010764598846435547
generate_one_block  0.001007080078125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00057220458984375
gen group dst list time:  8.58306884765625e-05
time for parepare:  0.0001392364501953125
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.000133514404296875
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00010442733764648438
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001456737518310547
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00011730194091796875
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00011897087097167969
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00010561943054199219
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.00010418891906738281
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00018525123596191406
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  8.654594421386719e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.4849853515625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00013303756713867188
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00010657310485839844
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00012445449829101562
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00011110305786132812
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00024700164794921875
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  8.535385131835938e-05
----------------------check_connections_block total spend ----------------------------- 0.005404472351074219
generate_one_block  0.0011780261993408203
generate_one_block  0.0011200904846191406
generate_one_block  0.0012447834014892578
generate_one_block  0.0011577606201171875
generate_one_block  0.0011951923370361328
generate_one_block  0.0011870861053466797
generate_one_block  0.00113677978515625
generate_one_block  0.0012269020080566406
generate_one_block  0.0011057853698730469
generate_one_block  0.0010640621185302734
generate_one_block  0.0011620521545410156
generate_one_block  0.0011353492736816406
generate_one_block  0.0011935234069824219
generate_one_block  0.0011382102966308594
generate_one_block  0.0013086795806884766
generate_one_block  0.001085519790649414
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006809234619140625
gen group dst list time:  0.0002110004425048828
time for parepare:  0.00019407272338867188
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00024890899658203125
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0005199909210205078
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00040411949157714844
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0005879402160644531
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00039696693420410156
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0004661083221435547
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0003876686096191406
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  7.677078247070312e-05
r_  generation:  0.0003662109375
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0006449222564697266
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0002789497375488281
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00018477439880371094
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0004832744598388672
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0004284381866455078
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.0005047321319580078
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004057884216308594
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0008018016815185547
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.00025725364685058594
----------------------check_connections_block total spend ----------------------------- 0.013132572174072266
generate_one_block  0.0016956329345703125
generate_one_block  0.001483917236328125
generate_one_block  0.002093076705932617
generate_one_block  0.0014753341674804688
generate_one_block  0.0015454292297363281
generate_one_block  0.001459360122680664
generate_one_block  0.001407623291015625
generate_one_block  0.001775503158569336
generate_one_block  0.0013217926025390625
generate_one_block  0.0012276172637939453
generate_one_block  0.001621246337890625
generate_one_block  0.0014922618865966797
generate_one_block  0.001569509506225586
generate_one_block  0.0014846324920654297
generate_one_block  0.0020775794982910156
generate_one_block  0.0013136863708496094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007348060607910156
gen group dst list time:  0.0002617835998535156
time for parepare:  0.0001995563507080078
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.0003376007080078125
mini_batch_src_global generation:  0.000152587890625
r_  generation:  0.0012941360473632812
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  0.0001239776611328125
r_  generation:  0.0009598731994628906
local_output_nid generation:  7.653236389160156e-05
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  0.000152587890625
r_  generation:  0.0014531612396240234
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0011470317840576172
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  0.0001266002655029297
r_  generation:  0.0011811256408691406
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.00012087821960449219
r_  generation:  0.0011370182037353516
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  0.0001049041748046875
r_  generation:  0.0009393692016601562
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0015397071838378906
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  0.00010752677917480469
r_  generation:  0.000873565673828125
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0005774497985839844
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.00011944770812988281
r_  generation:  0.0012726783752441406
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  0.0001266002655029297
r_  generation:  0.0011413097381591797
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  0.00013971328735351562
r_  generation:  0.0012884140014648438
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.00013494491577148438
r_  generation:  0.0011310577392578125
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.0002384185791015625
mini_batch_src_global generation:  0.00018215179443359375
r_  generation:  0.0018343925476074219
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  0.0001125335693359375
r_  generation:  0.0007903575897216797
----------------------check_connections_block total spend ----------------------------- 0.02990865707397461
generate_one_block  0.0025222301483154297
generate_one_block  0.0022416114807128906
generate_one_block  0.0026929378509521484
generate_one_block  0.0023140907287597656
generate_one_block  0.002258777618408203
generate_one_block  0.0023436546325683594
generate_one_block  0.002205371856689453
generate_one_block  0.002711772918701172
generate_one_block  0.0019292831420898438
generate_one_block  0.001659393310546875
generate_one_block  0.002537250518798828
generate_one_block  0.0022077560424804688
generate_one_block  0.0024652481079101562
generate_one_block  0.0022852420806884766
generate_one_block  0.0030345916748046875
generate_one_block  0.0019030570983886719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007472038269042969
gen group dst list time:  0.0005977153778076172
time for parepare:  0.00018167495727539062
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.0004134178161621094
mini_batch_src_global generation:  0.0001518726348876953
r_  generation:  0.0021240711212158203
local_output_nid generation:  9.965896606445312e-05
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.00020265579223632812
r_  generation:  0.001897573471069336
local_output_nid generation:  0.00012350082397460938
local_in_edges_tensor generation:  0.0002799034118652344
mini_batch_src_global generation:  0.0002155303955078125
r_  generation:  0.0023546218872070312
local_output_nid generation:  0.00012087821960449219
local_in_edges_tensor generation:  0.0002772808074951172
mini_batch_src_global generation:  0.00019812583923339844
r_  generation:  0.002135038375854492
local_output_nid generation:  0.00011610984802246094
local_in_edges_tensor generation:  0.0002677440643310547
mini_batch_src_global generation:  0.00019693374633789062
r_  generation:  0.0019505023956298828
local_output_nid generation:  0.0001163482666015625
local_in_edges_tensor generation:  0.00026226043701171875
mini_batch_src_global generation:  0.000194549560546875
r_  generation:  0.0021257400512695312
local_output_nid generation:  9.655952453613281e-05
local_in_edges_tensor generation:  0.0002384185791015625
mini_batch_src_global generation:  0.00017595291137695312
r_  generation:  0.0018219947814941406
local_output_nid generation:  0.00012493133544921875
local_in_edges_tensor generation:  0.00027871131896972656
mini_batch_src_global generation:  0.00020360946655273438
r_  generation:  0.002338409423828125
local_output_nid generation:  0.00010538101196289062
local_in_edges_tensor generation:  0.0002529621124267578
mini_batch_src_global generation:  0.00020241737365722656
r_  generation:  0.001821756362915039
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.0001499652862548828
r_  generation:  0.0013878345489501953
local_output_nid generation:  0.000118255615234375
local_in_edges_tensor generation:  0.0002713203430175781
mini_batch_src_global generation:  0.0001938343048095703
r_  generation:  0.0022127628326416016
local_output_nid generation:  0.00010585784912109375
local_in_edges_tensor generation:  0.00025534629821777344
mini_batch_src_global generation:  0.00019240379333496094
r_  generation:  0.0019690990447998047
local_output_nid generation:  0.00011658668518066406
local_in_edges_tensor generation:  0.0002803802490234375
mini_batch_src_global generation:  0.00020503997802734375
r_  generation:  0.0022139549255371094
local_output_nid generation:  0.00010991096496582031
local_in_edges_tensor generation:  0.0002636909484863281
mini_batch_src_global generation:  0.00020003318786621094
r_  generation:  0.002069711685180664
local_output_nid generation:  0.000133514404296875
local_in_edges_tensor generation:  0.00030231475830078125
mini_batch_src_global generation:  0.00023937225341796875
r_  generation:  0.002554655075073242
local_output_nid generation:  9.202957153320312e-05
local_in_edges_tensor generation:  0.00023436546325683594
mini_batch_src_global generation:  0.0001811981201171875
r_  generation:  0.0017135143280029297
----------------------check_connections_block total spend ----------------------------- 0.049880266189575195
generate_one_block  0.003535032272338867
generate_one_block  0.002956867218017578
generate_one_block  0.003891468048095703
generate_one_block  0.0034933090209960938
generate_one_block  0.0031747817993164062
generate_one_block  0.0033075809478759766
generate_one_block  0.0029201507568359375
generate_one_block  0.00354766845703125
generate_one_block  0.003031015396118164
generate_one_block  0.002572298049926758
generate_one_block  0.0034325122833251953
generate_one_block  0.003284454345703125
generate_one_block  0.003453493118286133
generate_one_block  0.0033600330352783203
generate_one_block  0.003759622573852539
generate_one_block  0.0029883384704589844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06626033782958984  GigaBytes
Max Memory Allocated: 0.06626033782958984  GigaBytes

connection checking time:  0.09832596778869629
block generation total time  0.13370490074157715
average batch blocks generation time:  0.008356556296348572
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.0780797004699707  GigaBytes
Max Memory Allocated: 0.0780797004699707  GigaBytes

torch.Size([2036, 1433])
torch.Size([1506, 128])
torch.Size([799, 128])
torch.Size([268, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9647216796875 GB
    Memory Allocated: 0.7161698341369629  GigaBytes
Max Memory Allocated: 0.7181425094604492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0604248046875 GB
    Memory Allocated: 0.14243221282958984  GigaBytes
Max Memory Allocated: 0.7829632759094238  GigaBytes

torch.Size([1842, 1433])
torch.Size([1226, 128])
torch.Size([567, 128])
torch.Size([196, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0604248046875 GB
    Memory Allocated: 0.6794466972351074  GigaBytes
Max Memory Allocated: 0.7829632759094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1229248046875 GB
    Memory Allocated: 0.1443462371826172  GigaBytes
Max Memory Allocated: 0.7829632759094238  GigaBytes

torch.Size([2189, 1433])
torch.Size([1665, 128])
torch.Size([917, 128])
torch.Size([320, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.8497161865234375  GigaBytes
Max Memory Allocated: 0.8497495651245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.1436290740966797  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

torch.Size([2064, 1433])
torch.Size([1505, 128])
torch.Size([694, 128])
torch.Size([230, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.7805976867675781  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.14321041107177734  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

torch.Size([1986, 1433])
torch.Size([1399, 128])
torch.Size([705, 128])
torch.Size([260, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.7369866371154785  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.14362239837646484  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

torch.Size([2063, 1433])
torch.Size([1490, 128])
torch.Size([706, 128])
torch.Size([209, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.7655754089355469  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.1422896385192871  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

torch.Size([1816, 1433])
torch.Size([1212, 128])
torch.Size([534, 128])
torch.Size([180, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.6703252792358398  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.14407682418823242  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

torch.Size([2144, 1433])
torch.Size([1665, 128])
torch.Size([985, 128])
torch.Size([327, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.8385281562805176  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.14293909072875977  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

torch.Size([1938, 1433])
torch.Size([1267, 128])
torch.Size([473, 128])
torch.Size([155, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.6913871765136719  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.14137649536132812  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

torch.Size([1649, 1433])
torch.Size([913, 128])
torch.Size([354, 128])
torch.Size([92, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.5469489097595215  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.14433860778808594  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

torch.Size([2145, 1433])
torch.Size([1579, 128])
torch.Size([819, 128])
torch.Size([284, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.815528392791748  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.1433730125427246  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

torch.Size([2017, 1433])
torch.Size([1403, 128])
torch.Size([686, 128])
torch.Size([203, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.7324247360229492  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.14433860778808594  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

torch.Size([2115, 1433])
torch.Size([1593, 128])
torch.Size([801, 128])
torch.Size([248, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.8260078430175781  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.14371776580810547  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

torch.Size([2081, 1433])
torch.Size([1503, 128])
torch.Size([712, 128])
torch.Size([233, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.7719006538391113  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.14458894729614258  GigaBytes
Max Memory Allocated: 0.9047365188598633  GigaBytes

torch.Size([2236, 1433])
torch.Size([1916, 128])
torch.Size([1244, 128])
torch.Size([482, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.9331622123718262  GigaBytes
Max Memory Allocated: 0.9332280158996582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.14259815216064453  GigaBytes
Max Memory Allocated: 0.9655680656433105  GigaBytes

torch.Size([1875, 1433])
torch.Size([1178, 128])
torch.Size([476, 128])
torch.Size([135, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.6558017730712891  GigaBytes
Max Memory Allocated: 0.9655680656433105  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06144966185092926 |0.02203361690044403 |0.22863145172595978 |0.00013175606727600098 |0.2674967795610428 |0.01803898811340332 |
----------------------------------------------------------pseudo_mini_loss sum 2.963557720184326
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  71277
Number of first layer input nodes during this epoch:  32196
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.2752237319946289  GigaBytes
Max Memory Allocated: 0.9655680656433105  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007042884826660156
random selection method range initialization spend 0.00017976760864257812
time for parepare:  9.059906005859375e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  6.246566772460938e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  1.4781951904296875e-05
----------------------check_connections_block total spend ----------------------------- 0.003383159637451172
generate_one_block  0.001163482666015625
generate_one_block  0.0013065338134765625
generate_one_block  0.0010218620300292969
generate_one_block  0.0010223388671875
generate_one_block  0.001024007797241211
generate_one_block  0.0009942054748535156
generate_one_block  0.0009870529174804688
generate_one_block  0.0010852813720703125
generate_one_block  0.0010328292846679688
generate_one_block  0.0009768009185791016
generate_one_block  0.0010063648223876953
generate_one_block  0.0010478496551513672
generate_one_block  0.0009794235229492188
generate_one_block  0.0009827613830566406
generate_one_block  0.0010709762573242188
generate_one_block  0.000990152359008789
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005779266357421875
gen group dst list time:  9.369850158691406e-05
time for parepare:  0.0001895427703857422
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0002560615539550781
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.000148773193359375
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0002117156982421875
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.00018835067749023438
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00011134147644042969
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  9.012222290039062e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0001220703125
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00012755393981933594
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00016117095947265625
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00011348724365234375
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  6.079673767089844e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0001780986785888672
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  9.441375732421875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00012874603271484375
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00011706352233886719
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.008148193359375e-05
----------------------check_connections_block total spend ----------------------------- 0.005708932876586914
generate_one_block  0.0012485980987548828
generate_one_block  0.0012357234954833984
generate_one_block  0.00122833251953125
generate_one_block  0.0011229515075683594
generate_one_block  0.0010571479797363281
generate_one_block  0.0010912418365478516
generate_one_block  0.0011494159698486328
generate_one_block  0.0010311603546142578
generate_one_block  0.0011937618255615234
generate_one_block  0.001100778579711914
generate_one_block  0.0015163421630859375
generate_one_block  0.0011944770812988281
generate_one_block  0.0010876655578613281
generate_one_block  0.0011315345764160156
generate_one_block  0.001062154769897461
generate_one_block  0.001024484634399414
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007536411285400391
gen group dst list time:  0.00015115737915039062
time for parepare:  0.00021600723266601562
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00031638145446777344
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0004999637603759766
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  0.00012421607971191406
r_  generation:  0.0007236003875732422
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  0.00010442733764648438
r_  generation:  0.0006976127624511719
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0003657341003417969
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.00030350685119628906
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0003952980041503906
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0004954338073730469
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00017023086547851562
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0005736351013183594
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.00041294097900390625
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00015616416931152344
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0006415843963623047
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0003077983856201172
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0004973411560058594
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.000354766845703125
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00015926361083984375
----------------------check_connections_block total spend ----------------------------- 0.013436317443847656
generate_one_block  0.0017313957214355469
generate_one_block  0.0019483566284179688
generate_one_block  0.0018856525421142578
generate_one_block  0.0014100074768066406
generate_one_block  0.0013506412506103516
generate_one_block  0.0015194416046142578
generate_one_block  0.001653432846069336
generate_one_block  0.001153707504272461
generate_one_block  0.0016832351684570312
generate_one_block  0.0014810562133789062
generate_one_block  0.0011463165283203125
generate_one_block  0.0017342567443847656
generate_one_block  0.0013513565063476562
generate_one_block  0.001645803451538086
generate_one_block  0.0014674663543701172
generate_one_block  0.0011327266693115234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007910728454589844
gen group dst list time:  0.0003414154052734375
time for parepare:  0.00021147727966308594
local_output_nid generation:  8.463859558105469e-05
local_in_edges_tensor generation:  0.00039768218994140625
mini_batch_src_global generation:  0.0001938343048095703
r_  generation:  0.0014505386352539062
local_output_nid generation:  0.00010013580322265625
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.0017087459564208984
local_output_nid generation:  8.797645568847656e-05
local_in_edges_tensor generation:  0.00025582313537597656
mini_batch_src_global generation:  0.00017309188842773438
r_  generation:  0.001535654067993164
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  0.00012063980102539062
r_  generation:  0.0008854866027832031
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.0008497238159179688
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0009834766387939453
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.00011539459228515625
r_  generation:  0.0011186599731445312
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.00044727325439453125
local_output_nid generation:  8.249282836914062e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  0.00013875961303710938
r_  generation:  0.0014662742614746094
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.00014281272888183594
r_  generation:  0.0011475086212158203
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0004966259002685547
local_output_nid generation:  8.988380432128906e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.001455068588256836
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.00011873245239257812
r_  generation:  0.0008814334869384766
local_output_nid generation:  8.416175842285156e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.0001475811004638672
r_  generation:  0.0014634132385253906
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.00014472007751464844
r_  generation:  0.0012044906616210938
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0004074573516845703
----------------------check_connections_block total spend ----------------------------- 0.029120445251464844
generate_one_block  0.002840757369995117
generate_one_block  0.0030405521392822266
generate_one_block  0.00287628173828125
generate_one_block  0.0022492408752441406
generate_one_block  0.002079486846923828
generate_one_block  0.0022478103637695312
generate_one_block  0.0023241043090820312
generate_one_block  0.001505136489868164
generate_one_block  0.002732992172241211
generate_one_block  0.002389192581176758
generate_one_block  0.0015790462493896484
generate_one_block  0.0026624202728271484
generate_one_block  0.002103567123413086
generate_one_block  0.002797842025756836
generate_one_block  0.002428293228149414
generate_one_block  0.0014595985412597656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008511543273925781
gen group dst list time:  0.0006010532379150391
time for parepare:  0.00020837783813476562
local_output_nid generation:  0.00014352798461914062
local_in_edges_tensor generation:  0.0004639625549316406
mini_batch_src_global generation:  0.00020766258239746094
r_  generation:  0.0024085044860839844
local_output_nid generation:  0.0001583099365234375
local_in_edges_tensor generation:  0.0003490447998046875
mini_batch_src_global generation:  0.0003132820129394531
r_  generation:  0.004164695739746094
local_output_nid generation:  0.00020003318786621094
local_in_edges_tensor generation:  0.00045371055603027344
mini_batch_src_global generation:  0.0002760887145996094
r_  generation:  0.0024657249450683594
local_output_nid generation:  0.00010275840759277344
local_in_edges_tensor generation:  0.00030517578125
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.0017151832580566406
local_output_nid generation:  0.00010180473327636719
local_in_edges_tensor generation:  0.0002834796905517578
mini_batch_src_global generation:  0.00018215179443359375
r_  generation:  0.001847982406616211
local_output_nid generation:  0.00010919570922851562
local_in_edges_tensor generation:  0.0003063678741455078
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.0017750263214111328
local_output_nid generation:  0.00012826919555664062
local_in_edges_tensor generation:  0.00029969215393066406
mini_batch_src_global generation:  0.00021266937255859375
r_  generation:  0.0019960403442382812
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.0002624988555908203
mini_batch_src_global generation:  0.0001461505889892578
r_  generation:  0.0010733604431152344
local_output_nid generation:  0.00015783309936523438
local_in_edges_tensor generation:  0.0003376007080078125
mini_batch_src_global generation:  0.00020432472229003906
r_  generation:  0.0023806095123291016
local_output_nid generation:  0.00012636184692382812
local_in_edges_tensor generation:  0.0006730556488037109
mini_batch_src_global generation:  0.0002307891845703125
r_  generation:  0.0020694732666015625
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  0.00015926361083984375
r_  generation:  0.0012578964233398438
local_output_nid generation:  0.0001373291015625
local_in_edges_tensor generation:  0.0003209114074707031
mini_batch_src_global generation:  0.0002071857452392578
r_  generation:  0.0022995471954345703
local_output_nid generation:  0.00011157989501953125
local_in_edges_tensor generation:  0.00031113624572753906
mini_batch_src_global generation:  0.00023102760314941406
r_  generation:  0.0018696784973144531
local_output_nid generation:  0.00014734268188476562
local_in_edges_tensor generation:  0.0003705024719238281
mini_batch_src_global generation:  0.00023984909057617188
r_  generation:  0.0024220943450927734
local_output_nid generation:  0.0001227855682373047
local_in_edges_tensor generation:  0.00033020973205566406
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.0021626949310302734
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.0002486705780029297
mini_batch_src_global generation:  0.00013518333435058594
r_  generation:  0.0009016990661621094
----------------------check_connections_block total spend ----------------------------- 0.052316904067993164
generate_one_block  0.0043065547943115234
generate_one_block  0.004049777984619141
generate_one_block  0.0038466453552246094
generate_one_block  0.0030608177185058594
generate_one_block  0.0030906200408935547
generate_one_block  0.003144502639770508
generate_one_block  0.003459930419921875
generate_one_block  0.0023651123046875
generate_one_block  0.003741741180419922
generate_one_block  0.003450155258178711
generate_one_block  0.0025746822357177734
generate_one_block  0.0037145614624023438
generate_one_block  0.003452777862548828
generate_one_block  0.0038328170776367188
generate_one_block  0.003618955612182617
generate_one_block  0.002119302749633789
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.2752237319946289  GigaBytes
Max Memory Allocated: 0.9655680656433105  GigaBytes

connection checking time:  0.10058259963989258
block generation total time  0.13391590118408203
average batch blocks generation time:  0.008369743824005127
block dataloader generation time/epoch 0.3715980052947998
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.2763962745666504  GigaBytes
Max Memory Allocated: 0.9655680656433105  GigaBytes

torch.Size([2110, 1433])
torch.Size([1613, 128])
torch.Size([870, 128])
torch.Size([266, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.9595785140991211  GigaBytes
Max Memory Allocated: 0.9655680656433105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3514404296875 GB
    Memory Allocated: 0.2768669128417969  GigaBytes
Max Memory Allocated: 1.019172191619873  GigaBytes

torch.Size([2161, 1433])
torch.Size([1767, 128])
torch.Size([1092, 128])
torch.Size([380, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3514404296875 GB
    Memory Allocated: 1.0067243576049805  GigaBytes
Max Memory Allocated: 1.019172191619873  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.27646446228027344  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

torch.Size([2121, 1433])
torch.Size([1707, 128])
torch.Size([978, 128])
torch.Size([364, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9847664833068848  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.2747993469238281  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

torch.Size([1817, 1433])
torch.Size([1134, 128])
torch.Size([487, 128])
torch.Size([184, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7665247917175293  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.2748093605041504  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

torch.Size([1819, 1433])
torch.Size([1166, 128])
torch.Size([473, 128])
torch.Size([148, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7863140106201172  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.2749652862548828  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

torch.Size([1847, 1433])
torch.Size([1222, 128])
torch.Size([596, 128])
torch.Size([196, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.7936282157897949  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.27579784393310547  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

torch.Size([2001, 1433])
torch.Size([1372, 128])
torch.Size([658, 128])
torch.Size([265, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8679594993591309  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.2723712921142578  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

torch.Size([1368, 1433])
torch.Size([649, 128])
torch.Size([240, 128])
torch.Size([84, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.5811800956726074  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.2768545150756836  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

torch.Size([2127, 1433])
torch.Size([1660, 128])
torch.Size([883, 128])
torch.Size([324, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9684877395629883  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.27579259872436523  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

torch.Size([2000, 1433])
torch.Size([1422, 128])
torch.Size([676, 128])
torch.Size([219, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8763713836669922  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.2739272117614746  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

torch.Size([1500, 1433])
torch.Size([793, 128])
torch.Size([279, 128])
torch.Size([76, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.6232309341430664  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.2768545150756836  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

torch.Size([2170, 1433])
torch.Size([1617, 128])
torch.Size([888, 128])
torch.Size([307, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9627299308776855  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.27550172805786133  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

torch.Size([1948, 1433])
torch.Size([1262, 128])
torch.Size([502, 128])
torch.Size([167, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.8207435607910156  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.2768535614013672  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

torch.Size([2147, 1433])
torch.Size([1743, 128])
torch.Size([910, 128])
torch.Size([273, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9908137321472168  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.27612972259521484  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

torch.Size([2063, 1433])
torch.Size([1484, 128])
torch.Size([693, 128])
torch.Size([180, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.9062471389770508  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.27132558822631836  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

torch.Size([1173, 1433])
torch.Size([566, 128])
torch.Size([215, 128])
torch.Size([74, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.5247859954833984  GigaBytes
Max Memory Allocated: 1.051093578338623  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06073997914791107 |0.0009777992963790894 |0.18987944722175598 |0.0001531541347503662 |0.25501321256160736 |0.014877557754516602 |
----------------------------------------------------------pseudo_mini_loss sum 2.6214423179626465
Total (block generation + training)time/epoch 8.560855150222778
Training time/epoch 8.188925504684448
Training time without block to device /epoch 8.173280715942383
Training time without total dataloading part /epoch 7.135610580444336
load block tensor time/epoch 0.9718396663665771
block to device time/epoch 0.01564478874206543
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  66253
Number of first layer input nodes during this epoch:  30372
