main start at this time 1648432626.7222848
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06626033782958984  GigaBytes
Max Memory Allocated: 0.06626033782958984  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013079643249511719
random selection method range initialization spend 0.00023365020751953125
time for parepare:  7.176399230957031e-05
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.002654552459716797
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  5.221366882324219e-05
----------------------check_connections_block total spend ----------------------------- 0.004666566848754883
generate_one_block  0.0018296241760253906
generate_one_block  0.0012445449829101562
generate_one_block  0.0011734962463378906
generate_one_block  0.001130819320678711
generate_one_block  0.0010924339294433594
generate_one_block  0.0011093616485595703
generate_one_block  0.0011246204376220703
generate_one_block  0.00110626220703125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005197525024414062
gen group dst list time:  6.29425048828125e-05
time for parepare:  0.00016117095947265625
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00024056434631347656
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00022268295288085938
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00024890899658203125
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0002288818359375
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0003039836883544922
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00014543533325195312
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.0002357959747314453
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00024318695068359375
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002911090850830078
----------------------check_connections_block total spend ----------------------------- 0.004308938980102539
generate_one_block  0.0013461112976074219
generate_one_block  0.0013680458068847656
generate_one_block  0.0013375282287597656
generate_one_block  0.0014140605926513672
generate_one_block  0.0012154579162597656
generate_one_block  0.0013408660888671875
generate_one_block  0.0014162063598632812
generate_one_block  0.0013196468353271484
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007107257843017578
gen group dst list time:  0.00011682510375976562
time for parepare:  0.0002205371856689453
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00026917457580566406
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.0007727146148681641
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.0008759498596191406
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0008695125579833984
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.0008690357208251953
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0004611015319824219
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0008344650268554688
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.0008797645568847656
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00011324882507324219
r_  generation:  0.0009839534759521484
----------------------check_connections_block total spend ----------------------------- 0.011194705963134766
generate_one_block  0.001996278762817383
generate_one_block  0.0020689964294433594
generate_one_block  0.0019183158874511719
generate_one_block  0.0018918514251708984
generate_one_block  0.0014367103576660156
generate_one_block  0.0019526481628417969
generate_one_block  0.0019299983978271484
generate_one_block  0.00205230712890625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000766754150390625
gen group dst list time:  0.0002067089080810547
time for parepare:  0.00019359588623046875
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.0003376007080078125
mini_batch_src_global generation:  0.00014901161193847656
r_  generation:  0.0017321109771728516
local_output_nid generation:  9.34600830078125e-05
local_in_edges_tensor generation:  0.00027060508728027344
mini_batch_src_global generation:  0.0002617835998535156
r_  generation:  0.001959085464477539
local_output_nid generation:  0.00010204315185546875
local_in_edges_tensor generation:  0.0002713203430175781
mini_batch_src_global generation:  0.00021576881408691406
r_  generation:  0.0020074844360351562
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.0002551078796386719
mini_batch_src_global generation:  0.00018596649169921875
r_  generation:  0.0018947124481201172
local_output_nid generation:  6.222724914550781e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  0.0001392364501953125
r_  generation:  0.0012898445129394531
local_output_nid generation:  9.083747863769531e-05
local_in_edges_tensor generation:  0.0002522468566894531
mini_batch_src_global generation:  0.00018072128295898438
r_  generation:  0.0019307136535644531
local_output_nid generation:  9.894371032714844e-05
local_in_edges_tensor generation:  0.0002694129943847656
mini_batch_src_global generation:  0.00018787384033203125
r_  generation:  0.0019609928131103516
local_output_nid generation:  0.00010061264038085938
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  0.0002033710479736328
r_  generation:  0.0019521713256835938
----------------------check_connections_block total spend ----------------------------- 0.02283024787902832
generate_one_block  0.003055095672607422
generate_one_block  0.002996206283569336
generate_one_block  0.003034830093383789
generate_one_block  0.002896547317504883
generate_one_block  0.002579212188720703
generate_one_block  0.003010988235473633
generate_one_block  0.0030813217163085938
generate_one_block  0.0032117366790771484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007696151733398438
gen group dst list time:  0.0003509521484375
time for parepare:  0.0002002716064453125
local_output_nid generation:  0.00012445449829101562
local_in_edges_tensor generation:  0.00042438507080078125
mini_batch_src_global generation:  0.00021791458129882812
r_  generation:  0.002567768096923828
local_output_nid generation:  0.00014519691467285156
local_in_edges_tensor generation:  0.00033545494079589844
mini_batch_src_global generation:  0.0002994537353515625
r_  generation:  0.0028154850006103516
local_output_nid generation:  0.00014853477478027344
local_in_edges_tensor generation:  0.0003368854522705078
mini_batch_src_global generation:  0.0002465248107910156
r_  generation:  0.0028645992279052734
local_output_nid generation:  0.00014495849609375
local_in_edges_tensor generation:  0.0003285408020019531
mini_batch_src_global generation:  0.00023746490478515625
r_  generation:  0.00276947021484375
local_output_nid generation:  0.00013637542724609375
local_in_edges_tensor generation:  0.00030541419982910156
mini_batch_src_global generation:  0.00022554397583007812
r_  generation:  0.002415180206298828
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.0003159046173095703
mini_batch_src_global generation:  0.00023126602172851562
r_  generation:  0.0027217864990234375
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.0003097057342529297
mini_batch_src_global generation:  0.0002276897430419922
r_  generation:  0.002638101577758789
local_output_nid generation:  0.00014090538024902344
local_in_edges_tensor generation:  0.000308990478515625
mini_batch_src_global generation:  0.0002300739288330078
r_  generation:  0.00262451171875
----------------------check_connections_block total spend ----------------------------- 0.03228020668029785
generate_one_block  0.0037450790405273438
generate_one_block  0.0038471221923828125
generate_one_block  0.004592180252075195
generate_one_block  0.004266262054443359
generate_one_block  0.003463268280029297
generate_one_block  0.003751993179321289
generate_one_block  0.003804922103881836
generate_one_block  0.0038170814514160156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06626033782958984  GigaBytes
Max Memory Allocated: 0.06626033782958984  GigaBytes

connection checking time:  0.07061409950256348
block generation total time  0.08115887641906738
average batch blocks generation time:  0.010144859552383423
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07809686660766602  GigaBytes
Max Memory Allocated: 0.07809686660766602  GigaBytes

torch.Size([2152, 1433])
torch.Size([1683, 128])
torch.Size([1003, 128])
torch.Size([399, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.7861237525939941  GigaBytes
Max Memory Allocated: 0.7861804962158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1229248046875 GB
    Memory Allocated: 0.14413213729858398  GigaBytes
Max Memory Allocated: 0.8377847671508789  GigaBytes

torch.Size([2273, 1433])
torch.Size([1879, 128])
torch.Size([1147, 128])
torch.Size([465, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1873779296875 GB
    Memory Allocated: 0.925419807434082  GigaBytes
Max Memory Allocated: 0.9254794120788574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 0.14417076110839844  GigaBytes
Max Memory Allocated: 0.9631876945495605  GigaBytes

torch.Size([2280, 1433])
torch.Size([1929, 128])
torch.Size([1209, 128])
torch.Size([456, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 0.9328784942626953  GigaBytes
Max Memory Allocated: 0.9631876945495605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 0.1439061164855957  GigaBytes
Max Memory Allocated: 0.9698042869567871  GigaBytes

torch.Size([2231, 1433])
torch.Size([1831, 128])
torch.Size([1137, 128])
torch.Size([433, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 0.9055280685424805  GigaBytes
Max Memory Allocated: 0.9698042869567871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 0.14368247985839844  GigaBytes
Max Memory Allocated: 0.9698042869567871  GigaBytes

torch.Size([2181, 1433])
torch.Size([1633, 128])
torch.Size([708, 128])
torch.Size([234, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 0.8213720321655273  GigaBytes
Max Memory Allocated: 0.9698042869567871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 0.1442737579345703  GigaBytes
Max Memory Allocated: 0.9698042869567871  GigaBytes

torch.Size([2300, 1433])
torch.Size([1902, 128])
torch.Size([1141, 128])
torch.Size([440, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 0.9302778244018555  GigaBytes
Max Memory Allocated: 0.9698042869567871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 0.14419031143188477  GigaBytes
Max Memory Allocated: 0.9698042869567871  GigaBytes

torch.Size([2283, 1433])
torch.Size([1982, 128])
torch.Size([1236, 128])
torch.Size([464, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3299560546875 GB
    Memory Allocated: 0.9504876136779785  GigaBytes
Max Memory Allocated: 0.9698042869567871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3299560546875 GB
    Memory Allocated: 0.14407873153686523  GigaBytes
Max Memory Allocated: 0.9847145080566406  GigaBytes

torch.Size([2261, 1433])
torch.Size([1985, 128])
torch.Size([1317, 128])
torch.Size([533, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.9657211303710938  GigaBytes
Max Memory Allocated: 0.9847145080566406  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06104859709739685 |0.04401484131813049 |0.28094878792762756 |0.00014579296112060547 |0.31027406454086304 |0.017657756805419922 |
----------------------------------------------------------pseudo_mini_loss sum 3.227357864379883
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  45857
Number of first layer input nodes during this epoch:  17961
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3651123046875 GB
    Memory Allocated: 0.2768406867980957  GigaBytes
Max Memory Allocated: 0.9929871559143066  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006122589111328125
random selection method range initialization spend 0.00015974044799804688
time for parepare:  8.20159912109375e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00010418891906738281
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.457069396972656e-05
----------------------check_connections_block total spend ----------------------------- 0.0022220611572265625
generate_one_block  0.0013179779052734375
generate_one_block  0.0011208057403564453
generate_one_block  0.001125335693359375
generate_one_block  0.0011060237884521484
generate_one_block  0.001131296157836914
generate_one_block  0.001140594482421875
generate_one_block  0.0011091232299804688
generate_one_block  0.0010890960693359375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005605220794677734
gen group dst list time:  7.343292236328125e-05
time for parepare:  0.0002205371856689453
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0002396106719970703
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0003662109375
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0002856254577636719
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0002167224884033203
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0001888275146484375
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00029087066650390625
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0002663135528564453
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00023794174194335938
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00015783309936523438
----------------------check_connections_block total spend ----------------------------- 0.004834413528442383
generate_one_block  0.0016090869903564453
generate_one_block  0.0014204978942871094
generate_one_block  0.0013346672058105469
generate_one_block  0.0013859272003173828
generate_one_block  0.0014884471893310547
generate_one_block  0.001356363296508789
generate_one_block  0.0013349056243896484
generate_one_block  0.001135110855102539
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007641315460205078
gen group dst list time:  0.00011706352233886719
time for parepare:  0.00038552284240722656
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.0003516674041748047
mini_batch_src_global generation:  0.0001552104949951172
r_  generation:  0.0010912418365478516
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.0002110004425048828
r_  generation:  0.0009136199951171875
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.0007121562957763672
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.0006310939788818359
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.000995635986328125
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  0.00010800361633300781
r_  generation:  0.00075531005859375
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  9.608268737792969e-05
r_  generation:  0.0007503032684326172
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.0005311965942382812
----------------------check_connections_block total spend ----------------------------- 0.011796236038208008
generate_one_block  0.002527952194213867
generate_one_block  0.002103567123413086
generate_one_block  0.0018231868743896484
generate_one_block  0.0017132759094238281
generate_one_block  0.0021250247955322266
generate_one_block  0.0018420219421386719
generate_one_block  0.0018715858459472656
generate_one_block  0.0016183853149414062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008134841918945312
gen group dst list time:  0.0002200603485107422
time for parepare:  0.0003008842468261719
local_output_nid generation:  0.00016188621520996094
local_in_edges_tensor generation:  0.0004723072052001953
mini_batch_src_global generation:  0.0007214546203613281
r_  generation:  0.002293109893798828
local_output_nid generation:  0.0001125335693359375
local_in_edges_tensor generation:  0.0002818107604980469
mini_batch_src_global generation:  0.0001990795135498047
r_  generation:  0.0019135475158691406
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.00024700164794921875
mini_batch_src_global generation:  0.0001723766326904297
r_  generation:  0.0016965866088867188
local_output_nid generation:  8.034706115722656e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  0.00016021728515625
r_  generation:  0.0014944076538085938
local_output_nid generation:  0.00012183189392089844
local_in_edges_tensor generation:  0.00029349327087402344
mini_batch_src_global generation:  0.00019288063049316406
r_  generation:  0.0021643638610839844
local_output_nid generation:  9.417533874511719e-05
local_in_edges_tensor generation:  0.00047469139099121094
mini_batch_src_global generation:  0.0001773834228515625
r_  generation:  0.0016944408416748047
local_output_nid generation:  0.00010013580322265625
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  0.0001850128173828125
r_  generation:  0.001875162124633789
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.00023746490478515625
mini_batch_src_global generation:  0.00014734268188476562
r_  generation:  0.0013875961303710938
----------------------check_connections_block total spend ----------------------------- 0.023912906646728516
generate_one_block  0.003634214401245117
generate_one_block  0.0032274723052978516
generate_one_block  0.002841949462890625
generate_one_block  0.0026938915252685547
generate_one_block  0.0032961368560791016
generate_one_block  0.0028510093688964844
generate_one_block  0.0030362606048583984
generate_one_block  0.0027344226837158203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008475780487060547
gen group dst list time:  0.0004086494445800781
time for parepare:  0.000240325927734375
local_output_nid generation:  0.00018262863159179688
local_in_edges_tensor generation:  0.0004985332489013672
mini_batch_src_global generation:  0.0002567768096923828
r_  generation:  0.002988100051879883
local_output_nid generation:  0.000164031982421875
local_in_edges_tensor generation:  0.0003509521484375
mini_batch_src_global generation:  0.00029778480529785156
r_  generation:  0.0027904510498046875
local_output_nid generation:  0.0001552104949951172
local_in_edges_tensor generation:  0.0003390312194824219
mini_batch_src_global generation:  0.0002429485321044922
r_  generation:  0.002679586410522461
local_output_nid generation:  0.000148773193359375
local_in_edges_tensor generation:  0.00032591819763183594
mini_batch_src_global generation:  0.00023126602172851562
r_  generation:  0.002570629119873047
local_output_nid generation:  0.000179290771484375
local_in_edges_tensor generation:  0.00035309791564941406
mini_batch_src_global generation:  0.0002601146697998047
r_  generation:  0.0030307769775390625
local_output_nid generation:  0.0001919269561767578
local_in_edges_tensor generation:  0.00031566619873046875
mini_batch_src_global generation:  0.00023174285888671875
r_  generation:  0.0024569034576416016
local_output_nid generation:  0.00015234947204589844
local_in_edges_tensor generation:  0.0003230571746826172
mini_batch_src_global generation:  0.0002243518829345703
r_  generation:  0.0026061534881591797
local_output_nid generation:  0.00013971328735351562
local_in_edges_tensor generation:  0.00031065940856933594
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.0023899078369140625
----------------------check_connections_block total spend ----------------------------- 0.032958269119262695
generate_one_block  0.004329204559326172
generate_one_block  0.003904581069946289
generate_one_block  0.003752470016479492
generate_one_block  0.0037157535552978516
generate_one_block  0.004389762878417969
generate_one_block  0.003841876983642578
generate_one_block  0.003974437713623047
generate_one_block  0.0037899017333984375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3651123046875 GB
    Memory Allocated: 0.2768406867980957  GigaBytes
Max Memory Allocated: 0.9929871559143066  GigaBytes

connection checking time:  0.0735018253326416
block generation total time  0.0827033519744873
average batch blocks generation time:  0.010337918996810913
block dataloader generation time/epoch 0.23759722709655762
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3651123046875 GB
    Memory Allocated: 0.2767491340637207  GigaBytes
Max Memory Allocated: 0.9929871559143066  GigaBytes

torch.Size([2291, 1433])
torch.Size([1970, 128])
torch.Size([1369, 128])
torch.Size([579, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3787841796875 GB
    Memory Allocated: 1.0904650688171387  GigaBytes
Max Memory Allocated: 1.0905532836914062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4412841796875 GB
    Memory Allocated: 0.27622222900390625  GigaBytes
Max Memory Allocated: 1.1141104698181152  GigaBytes

torch.Size([2185, 1433])
torch.Size([1822, 128])
torch.Size([1122, 128])
torch.Size([466, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4412841796875 GB
    Memory Allocated: 1.0252714157104492  GigaBytes
Max Memory Allocated: 1.1141104698181152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4412841796875 GB
    Memory Allocated: 0.2760753631591797  GigaBytes
Max Memory Allocated: 1.1141104698181152  GigaBytes

torch.Size([2170, 1433])
torch.Size([1711, 128])
torch.Size([953, 128])
torch.Size([343, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4412841796875 GB
    Memory Allocated: 0.9926490783691406  GigaBytes
Max Memory Allocated: 1.1141104698181152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4412841796875 GB
    Memory Allocated: 0.2762002944946289  GigaBytes
Max Memory Allocated: 1.1141104698181152  GigaBytes

torch.Size([2158, 1433])
torch.Size([1615, 128])
torch.Size([833, 128])
torch.Size([330, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4412841796875 GB
    Memory Allocated: 0.9571213722229004  GigaBytes
Max Memory Allocated: 1.1141104698181152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4412841796875 GB
    Memory Allocated: 0.2768688201904297  GigaBytes
Max Memory Allocated: 1.1141104698181152  GigaBytes

torch.Size([2314, 1433])
torch.Size([1995, 128])
torch.Size([1273, 128])
torch.Size([523, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4412841796875 GB
    Memory Allocated: 1.095381736755371  GigaBytes
Max Memory Allocated: 1.1141104698181152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4725341796875 GB
    Memory Allocated: 0.276397705078125  GigaBytes
Max Memory Allocated: 1.1251130104064941  GigaBytes

torch.Size([2230, 1433])
torch.Size([1751, 128])
torch.Size([989, 128])
torch.Size([363, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4725341796875 GB
    Memory Allocated: 1.0087823867797852  GigaBytes
Max Memory Allocated: 1.1251130104064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4725341796875 GB
    Memory Allocated: 0.276613712310791  GigaBytes
Max Memory Allocated: 1.1251130104064941  GigaBytes

torch.Size([2269, 1433])
torch.Size([1889, 128])
torch.Size([1076, 128])
torch.Size([388, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4725341796875 GB
    Memory Allocated: 1.0542011260986328  GigaBytes
Max Memory Allocated: 1.1251130104064941  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4725341796875 GB
    Memory Allocated: 0.27643442153930664  GigaBytes
Max Memory Allocated: 1.1251130104064941  GigaBytes

torch.Size([2239, 1433])
torch.Size([1701, 128])
torch.Size([860, 128])
torch.Size([253, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4725341796875 GB
    Memory Allocated: 0.9859814643859863  GigaBytes
Max Memory Allocated: 1.1251130104064941  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06127190589904785 |0.0011638998985290527 |0.2167166769504547 |0.00012615323066711426 |0.2990233898162842 |0.01405787467956543 |
----------------------------------------------------------pseudo_mini_loss sum 2.6155083179473877
Total (block generation + training)time/epoch 4.9455413818359375
Training time/epoch 4.707643747329712
Training time without block to device /epoch 4.6983325481414795
Training time without total dataloading part /epoch 4.1409876346588135
load block tensor time/epoch 0.4901752471923828
block to device time/epoch 0.009311199188232422
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  44774
Number of first layer input nodes during this epoch:  17856
