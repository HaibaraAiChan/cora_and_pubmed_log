main start at this time 1648432396.797986
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00099945068359375
random selection method range initialization spend 0.00020074844360351562
time for parepare:  8.082389831542969e-05
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.002765655517578125
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  9.489059448242188e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  8.153915405273438e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.793571472167969e-05
----------------------check_connections_block total spend ----------------------------- 0.0042307376861572266
generate_one_block  0.0017652511596679688
generate_one_block  0.0013611316680908203
generate_one_block  0.0013298988342285156
generate_one_block  0.0012969970703125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005755424499511719
gen group dst list time:  5.14984130859375e-05
time for parepare:  0.00017905235290527344
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0005309581756591797
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0005962848663330078
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0005435943603515625
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.00036215782165527344
----------------------check_connections_block total spend ----------------------------- 0.003871917724609375
generate_one_block  0.001859426498413086
generate_one_block  0.0019061565399169922
generate_one_block  0.0018377304077148438
generate_one_block  0.0016922950744628906
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006897449493408203
gen group dst list time:  9.965896606445312e-05
time for parepare:  0.00022411346435546875
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.00031638145446777344
mini_batch_src_global generation:  0.00016736984252929688
r_  generation:  0.001562356948852539
local_output_nid generation:  8.296966552734375e-05
local_in_edges_tensor generation:  0.0002658367156982422
mini_batch_src_global generation:  0.00018405914306640625
r_  generation:  0.0017538070678710938
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  0.0001690387725830078
r_  generation:  0.0016083717346191406
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00022482872009277344
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.0012063980102539062
----------------------check_connections_block total spend ----------------------------- 0.009887456893920898
generate_one_block  0.003033161163330078
generate_one_block  0.002801656723022461
generate_one_block  0.0023310184478759766
generate_one_block  0.0020170211791992188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006930828094482422
gen group dst list time:  0.00017714500427246094
time for parepare:  0.0002434253692626953
local_output_nid generation:  0.00014662742614746094
local_in_edges_tensor generation:  0.00043964385986328125
mini_batch_src_global generation:  0.00022482872009277344
r_  generation:  0.0030312538146972656
local_output_nid generation:  0.00015401840209960938
local_in_edges_tensor generation:  0.00035953521728515625
mini_batch_src_global generation:  0.0003409385681152344
r_  generation:  0.003008604049682617
local_output_nid generation:  0.00015234947204589844
local_in_edges_tensor generation:  0.0003552436828613281
mini_batch_src_global generation:  0.0002658367156982422
r_  generation:  0.0029816627502441406
local_output_nid generation:  0.0001385211944580078
local_in_edges_tensor generation:  0.0003287792205810547
mini_batch_src_global generation:  0.0002448558807373047
r_  generation:  0.002217531204223633
----------------------check_connections_block total spend ----------------------------- 0.017297983169555664
generate_one_block  0.003663301467895508
generate_one_block  0.003377676010131836
generate_one_block  0.003497600555419922
generate_one_block  0.0032110214233398438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007882118225097656
gen group dst list time:  0.0002491474151611328
time for parepare:  0.0002505779266357422
local_output_nid generation:  0.00019788742065429688
local_in_edges_tensor generation:  0.00052642822265625
mini_batch_src_global generation:  0.0003123283386230469
r_  generation:  0.0037970542907714844
local_output_nid generation:  0.00021076202392578125
local_in_edges_tensor generation:  0.0004305839538574219
mini_batch_src_global generation:  0.0003864765167236328
r_  generation:  0.003805875778198242
local_output_nid generation:  0.0002048015594482422
local_in_edges_tensor generation:  0.00042247772216796875
mini_batch_src_global generation:  0.0003204345703125
r_  generation:  0.0032694339752197266
local_output_nid generation:  0.00015306472778320312
local_in_edges_tensor generation:  0.0003523826599121094
mini_batch_src_global generation:  0.00025391578674316406
r_  generation:  0.002969980239868164
----------------------check_connections_block total spend ----------------------------- 0.021138906478881836
generate_one_block  0.004924297332763672
generate_one_block  0.003941774368286133
generate_one_block  0.003877401351928711
generate_one_block  0.003920316696166992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

connection checking time:  0.05219626426696777
block generation total time  0.047891855239868164
average batch blocks generation time:  0.011972963809967041
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07561206817626953  GigaBytes
Max Memory Allocated: 0.07561206817626953  GigaBytes

torch.Size([2376, 1433])
torch.Size([2131, 16])
torch.Size([1559, 16])
torch.Size([726, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1287841796875 GB
    Memory Allocated: 0.8615937232971191  GigaBytes
Max Memory Allocated: 0.9176926612854004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.1375279426574707  GigaBytes
Max Memory Allocated: 0.958000659942627  GigaBytes

torch.Size([2339, 1433])
torch.Size([2119, 16])
torch.Size([1549, 16])
torch.Size([814, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2713623046875 GB
    Memory Allocated: 0.9136838912963867  GigaBytes
Max Memory Allocated: 0.9688920974731445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.13756084442138672  GigaBytes
Max Memory Allocated: 1.0097475051879883  GigaBytes

torch.Size([2346, 1433])
torch.Size([2090, 16])
torch.Size([1532, 16])
torch.Size([731, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.9096817970275879  GigaBytes
Max Memory Allocated: 1.0097475051879883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.1378774642944336  GigaBytes
Max Memory Allocated: 1.0097475051879883  GigaBytes

torch.Size([2408, 1433])
torch.Size([2100, 16])
torch.Size([1368, 16])
torch.Size([552, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.9183516502380371  GigaBytes
Max Memory Allocated: 1.0097475051879883  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05722838640213013 |0.08582949638366699 |0.3584103584289551 |0.00016838312149047852 |0.3292269706726074 |0.017771482467651367 |
----------------------------------------------------------pseudo_mini_loss sum 2.697658061981201
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27471
Number of first layer input nodes during this epoch:  9469
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.2630043029785156  GigaBytes
Max Memory Allocated: 1.0173702239990234  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006139278411865234
random selection method range initialization spend 0.000148773193359375
time for parepare:  9.870529174804688e-05
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00012683868408203125
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  7.009506225585938e-05
----------------------check_connections_block total spend ----------------------------- 0.001552581787109375
generate_one_block  0.00147247314453125
generate_one_block  0.0013897418975830078
generate_one_block  0.0013604164123535156
generate_one_block  0.0013697147369384766
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006318092346191406
gen group dst list time:  5.793571472167969e-05
time for parepare:  0.00020647048950195312
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00025010108947753906
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0006208419799804688
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0005457401275634766
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0004115104675292969
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.0005033016204833984
----------------------check_connections_block total spend ----------------------------- 0.004172801971435547
generate_one_block  0.0022940635681152344
generate_one_block  0.0019571781158447266
generate_one_block  0.0017704963684082031
generate_one_block  0.0018835067749023438
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007004737854003906
gen group dst list time:  0.00010991096496582031
time for parepare:  0.00024580955505371094
local_output_nid generation:  9.34600830078125e-05
local_in_edges_tensor generation:  0.0003299713134765625
mini_batch_src_global generation:  0.00017714500427246094
r_  generation:  0.0017735958099365234
local_output_nid generation:  9.1552734375e-05
local_in_edges_tensor generation:  0.00025844573974609375
mini_batch_src_global generation:  0.000225067138671875
r_  generation:  0.0017285346984863281
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.000247955322265625
mini_batch_src_global generation:  0.00015926361083984375
r_  generation:  0.0013186931610107422
local_output_nid generation:  7.915496826171875e-05
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  0.00016570091247558594
r_  generation:  0.0015759468078613281
----------------------check_connections_block total spend ----------------------------- 0.010404825210571289
generate_one_block  0.003389596939086914
generate_one_block  0.002717733383178711
generate_one_block  0.002172708511352539
generate_one_block  0.0023572444915771484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007526874542236328
gen group dst list time:  0.0001900196075439453
time for parepare:  0.0002505779266357422
local_output_nid generation:  0.00017762184143066406
local_in_edges_tensor generation:  0.00044989585876464844
mini_batch_src_global generation:  0.0002925395965576172
r_  generation:  0.0031082630157470703
local_output_nid generation:  0.00018358230590820312
local_in_edges_tensor generation:  0.00037384033203125
mini_batch_src_global generation:  0.0003311634063720703
r_  generation:  0.0032203197479248047
local_output_nid generation:  0.00016641616821289062
local_in_edges_tensor generation:  0.0003380775451660156
mini_batch_src_global generation:  0.00026106834411621094
r_  generation:  0.0028371810913085938
local_output_nid generation:  0.00017142295837402344
local_in_edges_tensor generation:  0.00033664703369140625
mini_batch_src_global generation:  0.00021791458129882812
r_  generation:  0.002439737319946289
----------------------check_connections_block total spend ----------------------------- 0.01795792579650879
generate_one_block  0.0037364959716796875
generate_one_block  0.003675699234008789
generate_one_block  0.0034096240997314453
generate_one_block  0.003504514694213867
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007417201995849609
gen group dst list time:  0.0002593994140625
time for parepare:  0.00025081634521484375
local_output_nid generation:  0.00022649765014648438
local_in_edges_tensor generation:  0.0005400180816650391
mini_batch_src_global generation:  0.00034165382385253906
r_  generation:  0.004811525344848633
local_output_nid generation:  0.00019431114196777344
local_in_edges_tensor generation:  0.0003750324249267578
mini_batch_src_global generation:  0.00033211708068847656
r_  generation:  0.003244161605834961
local_output_nid generation:  0.00018310546875
local_in_edges_tensor generation:  0.00036263465881347656
mini_batch_src_global generation:  0.0002579689025878906
r_  generation:  0.003123760223388672
local_output_nid generation:  0.00018143653869628906
local_in_edges_tensor generation:  0.00035691261291503906
mini_batch_src_global generation:  0.00028324127197265625Using backend: pytorch

r_  generation:  0.002873659133911133
----------------------check_connections_block total spend ----------------------------- 0.02102208137512207
generate_one_block  0.004580259323120117
generate_one_block  0.004411220550537109
generate_one_block  0.004083871841430664
generate_one_block  0.004034757614135742
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.2630043029785156  GigaBytes
Max Memory Allocated: 1.0173702239990234  GigaBytes

connection checking time:  0.053557634353637695
block generation total time  0.04997897148132324
average batch blocks generation time:  0.01249474287033081
block dataloader generation time/epoch 0.15398764610290527
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.2625727653503418  GigaBytes
Max Memory Allocated: 1.0173702239990234  GigaBytes

torch.Size([2372, 1433])
torch.Size([2120, 16])
torch.Size([1570, 16])
torch.Size([778, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4764404296875 GB
    Memory Allocated: 1.0474286079406738  GigaBytes
Max Memory Allocated: 1.103832721710205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4764404296875 GB
    Memory Allocated: 0.2627720832824707  GigaBytes
Max Memory Allocated: 1.144045352935791  GigaBytes

torch.Size([2409, 1433])
torch.Size([2198, 16])
torch.Size([1606, 16])
torch.Size([757, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4783935546875 GB
    Memory Allocated: 1.0697412490844727  GigaBytes
Max Memory Allocated: 1.144045352935791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4783935546875 GB
    Memory Allocated: 0.2624626159667969  GigaBytes
Max Memory Allocated: 1.1661763191223145  GigaBytes

torch.Size([2355, 1433])
torch.Size([2104, 16])
torch.Size([1391, 16])
torch.Size([605, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4783935546875 GB
    Memory Allocated: 1.039724349975586  GigaBytes
Max Memory Allocated: 1.1661763191223145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4783935546875 GB
    Memory Allocated: 0.2624192237854004  GigaBytes
Max Memory Allocated: 1.1661763191223145  GigaBytes

torch.Size([2345, 1433])
torch.Size([2071, 16])
torch.Size([1479, 16])
torch.Size([664, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4783935546875 GB
    Memory Allocated: 1.0308794975280762  GigaBytes
Max Memory Allocated: 1.1661763191223145  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05503588914871216 |0.0011265873908996582 |0.23942077159881592 |0.00013023614883422852 |0.327328085899353 |0.013922929763793945 |
----------------------------------------------------------pseudo_mini_loss sum 2.179649591445923
Total (block generation + training)time/epoch 2.724703073501587
Training time/epoch 2.5703632831573486
Training time without block to device /epoch 2.56585693359375
Training time without total dataloading part /epoch 2.2814393043518066
load block tensor time/epoch 0.22014355659484863
block to device time/epoch 0.004506349563598633
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27555
Number of first layer input nodes during this epoch:  9481
