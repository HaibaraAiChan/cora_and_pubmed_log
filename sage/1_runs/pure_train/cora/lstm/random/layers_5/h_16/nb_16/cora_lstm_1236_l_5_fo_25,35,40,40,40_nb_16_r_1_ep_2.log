main start at this time 1648432429.9708283
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0010952949523925781
random selection method range initialization spend 0.00016546249389648438
time for parepare:  6.4849853515625e-05
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.0012807846069335938
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.3828277587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.004397392272949219
generate_one_block  0.001329183578491211
generate_one_block  0.0010039806365966797
generate_one_block  0.0010008811950683594
generate_one_block  0.0010099411010742188
generate_one_block  0.0010018348693847656
generate_one_block  0.001004934310913086
generate_one_block  0.001043081283569336
generate_one_block  0.0009925365447998047
generate_one_block  0.0010344982147216797
generate_one_block  0.0009870529174804688
generate_one_block  0.0009982585906982422
generate_one_block  0.0009887218475341797
generate_one_block  0.000990152359008789
generate_one_block  0.0009872913360595703
generate_one_block  0.0010128021240234375
generate_one_block  0.0009386539459228516
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005967617034912109
gen group dst list time:  8.988380432128906e-05
time for parepare:  0.00013947486877441406
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0001766681671142578
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  8.296966552734375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00017189979553222656
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00012731552124023438
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.000171661376953125
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00016236305236816406
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00011157989501953125
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00014781951904296875
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0001163482666015625
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00015592575073242188
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00010824203491210938
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00010895729064941406
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  8.726119995117188e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  9.512901306152344e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.482269287109375e-05
----------------------check_connections_block total spend ----------------------------- 0.005402565002441406
generate_one_block  0.0012078285217285156
generate_one_block  0.0010662078857421875
generate_one_block  0.0010783672332763672
generate_one_block  0.0011949539184570312
generate_one_block  0.0011699199676513672
generate_one_block  0.0011887550354003906
generate_one_block  0.001224517822265625
generate_one_block  0.0010547637939453125
generate_one_block  0.0011112689971923828
generate_one_block  0.001115560531616211
generate_one_block  0.0011420249938964844
generate_one_block  0.0010576248168945312
generate_one_block  0.001131296157836914
generate_one_block  0.0010673999786376953
generate_one_block  0.0010325908660888672
generate_one_block  0.0009710788726806641
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007193088531494141
gen group dst list time:  0.00017404556274414062
time for parepare:  0.000194549560546875
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0006175041198730469
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00023746490478515625
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.000331878662109375
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0006518363952636719
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00039958953857421875
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0005953311920166016
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.0005633831024169922
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00037789344787597656
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.00055694580078125
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0004603862762451172
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0005698204040527344
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0004296302795410156
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.00042319297790527344
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00033545494079589844
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.000247955322265625
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001373291015625
----------------------check_connections_block total spend ----------------------------- 0.012781620025634766
generate_one_block  0.0017211437225341797
generate_one_block  0.0012705326080322266
generate_one_block  0.0016336441040039062
generate_one_block  0.0016570091247558594
generate_one_block  0.0013914108276367188
generate_one_block  0.0015888214111328125
generate_one_block  0.0016543865203857422
generate_one_block  0.0013439655303955078
generate_one_block  0.0016024112701416016
generate_one_block  0.0015451908111572266
generate_one_block  0.0016186237335205078
generate_one_block  0.0014088153839111328
generate_one_block  0.0013866424560546875
generate_one_block  0.0013332366943359375
generate_one_block  0.0011799335479736328
generate_one_block  0.001085519790649414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007259845733642578
gen group dst list time:  0.0003457069396972656
time for parepare:  0.00019216537475585938
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.0003361701965332031
mini_batch_src_global generation:  0.00018787384033203125
r_  generation:  0.001453399658203125
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0006573200225830078
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0009217262268066406
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  0.00012755393981933594
r_  generation:  0.00142669677734375
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  0.00011682510375976562
r_  generation:  0.0009918212890625
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  0.00012826919555664062
r_  generation:  0.0013680458068847656
local_output_nid generation:  6.151199340820312e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.001346588134765625
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00011754035949707031
r_  generation:  0.0010542869567871094
local_output_nid generation:  6.842613220214844e-05
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  0.00013399124145507812
r_  generation:  0.0014433860778808594
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0014312267303466797
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.0012879371643066406
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  0.00010967254638671875
r_  generation:  0.0009722709655761719
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.00010967254638671875
r_  generation:  0.0010488033294677734
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.001032114028930664
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0005605220794677734
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00043511390686035156
----------------------check_connections_block total spend ----------------------------- 0.02786087989807129
generate_one_block  0.0026178359985351562
generate_one_block  0.0016849040985107422
generate_one_block  0.001986980438232422
generate_one_block  0.003304004669189453
generate_one_block  0.0020399093627929688
generate_one_block  0.0024213790893554688
generate_one_block  0.0026297569274902344
generate_one_block  0.0021238327026367188
generate_one_block  0.0025186538696289062
generate_one_block  0.002550840377807617
generate_one_block  0.0024178028106689453
generate_one_block  0.0020837783813476562
generate_one_block  0.0021855831146240234
generate_one_block  0.0021529197692871094
generate_one_block  0.0015769004821777344
generate_one_block  0.0014412403106689453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007596015930175781
gen group dst list time:  0.0005896091461181641
time for parepare:  0.00020051002502441406
local_output_nid generation:  0.00011420249938964844
local_in_edges_tensor generation:  0.00042510032653808594
mini_batch_src_global generation:  0.00018858909606933594
r_  generation:  0.0023376941680908203
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.001405954360961914
local_output_nid generation:  0.00010967254638671875
local_in_edges_tensor generation:  0.0002505779266357422
mini_batch_src_global generation:  0.000164031982421875
r_  generation:  0.0018355846405029297
local_output_nid generation:  0.00012445449829101562
local_in_edges_tensor generation:  0.00029659271240234375
mini_batch_src_global generation:  0.0002148151397705078
r_  generation:  0.0024023056030273438
local_output_nid generation:  0.000102996826171875
local_in_edges_tensor generation:  0.00025177001953125
mini_batch_src_global generation:  0.00019121170043945312
r_  generation:  0.0019142627716064453
local_output_nid generation:  0.000118255615234375
local_in_edges_tensor generation:  0.00027871131896972656
mini_batch_src_global generation:  0.00019502639770507812
r_  generation:  0.002235889434814453
local_output_nid generation:  0.0001163482666015625
local_in_edges_tensor generation:  0.00027561187744140625
mini_batch_src_global generation:  0.000202178955078125
r_  generation:  0.0022242069244384766
local_output_nid generation:  0.000102996826171875
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  0.00018787384033203125
r_  generation:  0.0019106864929199219
local_output_nid generation:  0.0001125335693359375
local_in_edges_tensor generation:  0.00026702880859375
mini_batch_src_global generation:  0.00019168853759765625
r_  generation:  0.0021674633026123047
local_output_nid generation:  0.0001163482666015625
local_in_edges_tensor generation:  0.00028061866760253906
mini_batch_src_global generation:  0.0002071857452392578
r_  generation:  0.0022509098052978516
local_output_nid generation:  0.00010704994201660156
local_in_edges_tensor generation:  0.00026416778564453125
mini_batch_src_global generation:  0.00019598007202148438
r_  generation:  0.0021696090698242188
local_output_nid generation:  9.679794311523438e-05
local_in_edges_tensor generation:  0.0002429485321044922
mini_batch_src_global generation:  0.00017714500427246094
r_  generation:  0.001855611801147461
local_output_nid generation:  9.989738464355469e-05
local_in_edges_tensor generation:  0.00024628639221191406
mini_batch_src_global generation:  0.00017333030700683594
r_  generation:  0.0018825531005859375
local_output_nid generation:  0.00010585784912109375
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  0.00018143653869628906
r_  generation:  0.0020003318786621094
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.00013971328735351562
r_  generation:  0.0012786388397216797
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0011372566223144531
----------------------check_connections_block total spend ----------------------------- 0.04725289344787598
generate_one_block  0.004361867904663086
generate_one_block  0.0024995803833007812
generate_one_block  0.0032007694244384766
generate_one_block  0.0034918785095214844
generate_one_block  0.003064393997192383
generate_one_block  0.0033750534057617188
generate_one_block  0.003412485122680664
generate_one_block  0.0031728744506835938
generate_one_block  0.003434896469116211
generate_one_block  0.004244565963745117
generate_one_block  0.003383159637451172
generate_one_block  0.0030336380004882812
generate_one_block  0.0030601024627685547
generate_one_block  0.003204822540283203
generate_one_block  0.002416849136352539
generate_one_block  0.002335786819458008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

connection checking time:  0.09329795837402344
block generation total time  0.12866449356079102
average batch blocks generation time:  0.008041530847549438
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07459497451782227  GigaBytes
Max Memory Allocated: 0.07459497451782227  GigaBytes

torch.Size([2116, 1433])
torch.Size([1631, 16])
torch.Size([906, 16])
torch.Size([327, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.7084083557128906  GigaBytes
Max Memory Allocated: 0.7573609352111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.13402175903320312  GigaBytes
Max Memory Allocated: 0.8134016990661621  GigaBytes

torch.Size([1581, 1433])
torch.Size([889, 16])
torch.Size([371, 16])
torch.Size([118, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5063443183898926  GigaBytes
Max Memory Allocated: 0.8134016990661621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1502685546875 GB
    Memory Allocated: 0.13541841506958008  GigaBytes
Max Memory Allocated: 0.8134016990661621  GigaBytes

torch.Size([1839, 1433])
torch.Size([1189, 16])
torch.Size([563, 16])
torch.Size([172, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.6147623062133789  GigaBytes
Max Memory Allocated: 0.8134016990661621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.13741731643676758  GigaBytes
Max Memory Allocated: 0.8134016990661621  GigaBytes

torch.Size([2207, 1433])
torch.Size([1644, 16])
torch.Size([897, 16])
torch.Size([322, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.7787919044494629  GigaBytes
Max Memory Allocated: 0.8272256851196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.1358041763305664  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

torch.Size([1910, 1433])
torch.Size([1267, 16])
torch.Size([570, 16])
torch.Size([193, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.6484665870666504  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.13664913177490234  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

torch.Size([2064, 1433])
torch.Size([1547, 16])
torch.Size([842, 16])
torch.Size([347, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.741492748260498  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.13636302947998047  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

torch.Size([2011, 1433])
torch.Size([1530, 16])
torch.Size([787, 16])
torch.Size([300, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.7334146499633789  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.13605880737304688  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

torch.Size([1957, 1433])
torch.Size([1331, 16])
torch.Size([612, 16])
torch.Size([176, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.681088924407959  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.13735103607177734  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

torch.Size([2058, 1433])
torch.Size([1571, 16])
torch.Size([898, 16])
torch.Size([286, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.7548079490661621  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.1368722915649414  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

torch.Size([2106, 1433])
torch.Size([1653, 16])
torch.Size([860, 16])
torch.Size([233, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.772519588470459  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.13734722137451172  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

torch.Size([2107, 1433])
torch.Size([1539, 16])
torch.Size([808, 16])
torch.Size([312, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2108154296875 GB
    Memory Allocated: 0.7448763847351074  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2108154296875 GB
    Memory Allocated: 0.13617610931396484  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

torch.Size([1979, 1433])
torch.Size([1300, 16])
torch.Size([611, 16])
torch.Size([205, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2108154296875 GB
    Memory Allocated: 0.6600427627563477  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2108154296875 GB
    Memory Allocated: 0.13586091995239258  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

torch.Size([1920, 1433])
torch.Size([1356, 16])
torch.Size([657, 16])
torch.Size([211, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2108154296875 GB
    Memory Allocated: 0.6656656265258789  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2108154296875 GB
    Memory Allocated: 0.13635873794555664  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

torch.Size([2013, 1433])
torch.Size([1416, 16])
torch.Size([631, 16])
torch.Size([168, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.7028656005859375  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.13436460494995117  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

torch.Size([1530, 1433])
torch.Size([813, 16])
torch.Size([321, 16])
torch.Size([125, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.49327754974365234  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.13337421417236328  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

torch.Size([1462, 1433])
torch.Size([751, 16])
torch.Size([232, 16])
torch.Size([65, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.45029783248901367  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.060225263237953186 |0.021945595741271973 |0.21898320317268372 |0.00012686848640441895 |0.25246386229991913 |0.020427465438842773 |
----------------------------------------------------------pseudo_mini_loss sum 3.072831869125366
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  67178
Number of first layer input nodes during this epoch:  30860
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.2589607238769531  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007636547088623047
random selection method range initialization spend 0.0001609325408935547
time for parepare:  9.298324584960938e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  6.389617919921875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.86102294921875e-05
----------------------check_connections_block total spend ----------------------------- 0.0034942626953125
generate_one_block  0.0012483596801757812
generate_one_block  0.0013189315795898438
generate_one_block  0.0010638236999511719
generate_one_block  0.0010459423065185547
generate_one_block  0.0010268688201904297
generate_one_block  0.0010225772857666016
generate_one_block  0.0010347366333007812
generate_one_block  0.0010159015655517578
generate_one_block  0.0010197162628173828
generate_one_block  0.0010149478912353516
generate_one_block  0.001016378402709961
generate_one_block  0.0010228157043457031
generate_one_block  0.0010137557983398438
generate_one_block  0.001020193099975586
generate_one_block  0.0010476112365722656
generate_one_block  0.0009839534759521484
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006389617919921875
gen group dst list time:  9.703636169433594e-05
time for parepare:  0.0002067089080810547
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.0007474422454833984
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00022149085998535156
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00017714500427246094
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00011801719665527344
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00014090538024902344
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00011873245239257812
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00015687942504882812
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00012350082397460938
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001068115234375
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00012254714965820312
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00010085105895996094
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00012493133544921875
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00010204315185546875
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00010228157043457031
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00012993812561035156
----------------------check_connections_block total spend ----------------------------- 0.006501913070678711
generate_one_block  0.0013172626495361328
generate_one_block  0.0012691020965576172
generate_one_block  0.001224517822265625
generate_one_block  0.0011434555053710938
generate_one_block  0.0011866092681884766
generate_one_block  0.0011343955993652344
generate_one_block  0.0011515617370605469
generate_one_block  0.001123666763305664
generate_one_block  0.0010864734649658203
generate_one_block  0.0010983943939208984
generate_one_block  0.0015747547149658203
generate_one_block  0.0011143684387207031
generate_one_block  0.0010762214660644531
generate_one_block  0.0010824203491210938
generate_one_block  0.0010311603546142578
generate_one_block  0.0011165142059326172
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007805824279785156
gen group dst list time:  0.00016832351684570312
time for parepare:  0.00022673606872558594
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.0003261566162109375
mini_batch_src_global generation:  0.00010895729064941406
r_  generation:  0.0006823539733886719
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.00011754035949707031
r_  generation:  0.0006868839263916016
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  0.00012063980102539062
r_  generation:  0.0006237030029296875
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0004067420959472656
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0005364418029785156
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0004315376281738281
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0005509853363037109
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.0005061626434326172
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0004138946533203125
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0004088878631591797
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00035500526428222656
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0004887580871582031
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.0004038810729980469
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00034332275390625
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0002307891845703125
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.000438690185546875
----------------------check_connections_block total spend ----------------------------- 0.0146636962890625
generate_one_block  0.0019829273223876953
generate_one_block  0.0019061565399169922
generate_one_block  0.001855611801147461
generate_one_block  0.0014336109161376953
generate_one_block  0.001592397689819336
generate_one_block  0.00148773193359375
generate_one_block  0.0017774105072021484
generate_one_block  0.0015642642974853516
generate_one_block  0.0014634132385253906
generate_one_block  0.001491546630859375
generate_one_block  0.001455068588256836
generate_one_block  0.0015327930450439453
generate_one_block  0.0014297962188720703
generate_one_block  0.001375436782836914
generate_one_block  0.0012159347534179688
generate_one_block  0.001491546630859375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008261203765869141
gen group dst list time:  0.0003783702850341797
time for parepare:  0.00022935867309570312
local_output_nid generation:  9.775161743164062e-05
local_in_edges_tensor generation:  0.0003752708435058594
mini_batch_src_global generation:  0.0001881122589111328
r_  generation:  0.001577615737915039
local_output_nid generation:  9.584426879882812e-05
local_in_edges_tensor generation:  0.0002541542053222656
mini_batch_src_global generation:  0.00023102760314941406
r_  generation:  0.001674652099609375
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.0002384185791015625
mini_batch_src_global generation:  0.0001995563507080078
r_  generation:  0.0014767646789550781
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0010085105895996094
local_output_nid generation:  8.893013000488281e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.00013637542724609375
r_  generation:  0.0012555122375488281
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  0.00013446807861328125
r_  generation:  0.0011816024780273438
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  0.0001506805419921875
r_  generation:  0.001512765884399414
local_output_nid generation:  6.842613220214844e-05
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  0.00014591217041015625
r_  generation:  0.0012962818145751953
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  0.00013184547424316406
r_  generation:  0.0012156963348388672
local_output_nid generation:  7.05718994140625e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  0.0001277923583984375
r_  generation:  0.0012392997741699219
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  0.00011682510375976562
r_  generation:  0.0009210109710693359
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  0.00014019012451171875
r_  generation:  0.0012831687927246094
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.0011167526245117188
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00012540817260742188
r_  generation:  0.0008878707885742188
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  0.000102996826171875
r_  generation:  0.0006520748138427734
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  0.000110626220703125
r_  generation:  0.0009686946868896484
----------------------check_connections_block total spend ----------------------------- 0.03185844421386719
generate_one_block  0.003022909164428711
generate_one_block  0.0029354095458984375
generate_one_block  0.0027496814727783203
generate_one_block  0.002400636672973633
generate_one_block  0.0024924278259277344
generate_one_block  0.002369403839111328
generate_one_block  0.0027625560760498047
generate_one_block  0.0025091171264648438
generate_one_block  0.0024313926696777344
generate_one_block  0.0024247169494628906
generate_one_block  0.002167940139770508
generate_one_block  0.0025713443756103516
generate_one_block  0.0023641586303710938
generate_one_block  0.002120494842529297
generate_one_block  0.0018343925476074219
generate_one_block  0.0022194385528564453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008542537689208984
gen group dst list time:  0.0007293224334716797
time for parepare:  0.00021219253540039062
local_output_nid generation:  0.0001571178436279297
local_in_edges_tensor generation:  0.0004930496215820312
mini_batch_src_global generation:  0.0001964569091796875
r_  generation:  0.0024290084838867188
local_output_nid generation:  0.00017023086547851562
local_in_edges_tensor generation:  0.00035953521728515625
mini_batch_src_global generation:  0.00026798248291015625
r_  generation:  0.0025734901428222656
local_output_nid generation:  0.00014662742614746094
local_in_edges_tensor generation:  0.0003275871276855469
mini_batch_src_global generation:  0.00024199485778808594
r_  generation:  0.0024127960205078125
local_output_nid generation:  0.00011301040649414062
local_in_edges_tensor generation:  0.00027942657470703125
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.001965761184692383
local_output_nid generation:  0.0001277923583984375
local_in_edges_tensor generation:  0.0003006458282470703
mini_batch_src_global generation:  0.000213623046875
r_  generation:  0.0021860599517822266
local_output_nid generation:  0.00012183189392089844
local_in_edges_tensor generation:  0.0002980232238769531
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.002124786376953125
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.00033402442932128906
mini_batch_src_global generation:  0.00022745132446289062
r_  generation:  0.002454519271850586
local_output_nid generation:  0.000125885009765625
local_in_edges_tensor generation:  0.00029277801513671875
mini_batch_src_global generation:  0.000217437744140625
r_  generation:  0.002130270004272461
local_output_nid generation:  0.0001246929168701172
local_in_edges_tensor generation:  0.00029087066650390625
mini_batch_src_global generation:  0.00020051002502441406
r_  generation:  0.002137422561645508
local_output_nid generation:  0.0001270771026611328
local_in_edges_tensor generation:  0.0006222724914550781
mini_batch_src_global generation:  0.000209808349609375
r_  generation:  0.002133607864379883
local_output_nid generation:  0.00010895729064941406
local_in_edges_tensor generation:  0.0002689361572265625
mini_batch_src_global generation:  0.00018262863159179688
r_  generation:  0.0018510818481445312
local_output_nid generation:  0.00013780593872070312
local_in_edges_tensor generation:  0.00030493736267089844
mini_batch_src_global generation:  0.00021457672119140625
r_  generation:  0.0022940635681152344
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.0002853870391845703
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.0020360946655273438
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.0002655982971191406
mini_batch_src_global generation:  0.0001914501190185547
r_  generation:  0.001753091812133789
local_output_nid generation:  9.34600830078125e-05
local_in_edges_tensor generation:  0.0002434253692626953
mini_batch_src_global generation:  0.00018095970153808594
r_  generation:  0.0016400814056396484
local_output_nid generation:  0.00011610984802246094
local_in_edges_tensor generation:  0.00027561187744140625
mini_batch_src_global generation:  0.0002048015594482422
r_  generation:  0.001959562301635742
----------------------check_connections_block total spend ----------------------------- 0.05361485481262207
generate_one_block  0.004119873046875
generate_one_block  0.004369974136352539
generate_one_block  0.0037391185760498047
generate_one_block  0.0032470226287841797
generate_one_block  0.0034551620483398438
generate_one_block  0.0034034252166748047
generate_one_block  0.003855466842651367
generate_one_block  0.0034940242767333984
generate_one_block  0.0035262107849121094
generate_one_block  0.0034894943237304688
generate_one_block  0.003219127655029297
generate_one_block  0.0036673545837402344
generate_one_block  0.0035550594329833984
generate_one_block  0.0031096935272216797
generate_one_block  0.002994537353515625
generate_one_block  0.003346681594848633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.2589607238769531  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

connection checking time:  0.10663890838623047
block generation total time  0.1397547721862793
average batch blocks generation time:  0.008734673261642456
block dataloader generation time/epoch 0.3879241943359375
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.2628746032714844  GigaBytes
Max Memory Allocated: 0.8845944404602051  GigaBytes

torch.Size([2124, 1433])
torch.Size([1647, 16])
torch.Size([933, 16])
torch.Size([351, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.8895750045776367  GigaBytes
Max Memory Allocated: 0.9375748634338379  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.26286983489990234  GigaBytes
Max Memory Allocated: 0.9934177398681641  GigaBytes

torch.Size([2193, 1433])
torch.Size([1732, 16])
torch.Size([1013, 16])
torch.Size([350, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.927370548248291  GigaBytes
Max Memory Allocated: 0.9934177398681641  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.26287174224853516  GigaBytes
Max Memory Allocated: 1.030207633972168  GigaBytes

torch.Size([2080, 1433])
torch.Size([1609, 16])
torch.Size([869, 16])
torch.Size([306, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.8937430381774902  GigaBytes
Max Memory Allocated: 1.030207633972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.2614455223083496  GigaBytes
Max Memory Allocated: 1.030207633972168  GigaBytes

torch.Size([1933, 1433])
torch.Size([1224, 16])
torch.Size([569, 16])
torch.Size([166, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.7793340682983398  GigaBytes
Max Memory Allocated: 1.030207633972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.26285743713378906  GigaBytes
Max Memory Allocated: 1.030207633972168  GigaBytes

torch.Size([2073, 1433])
torch.Size([1450, 16])
torch.Size([732, 16])
torch.Size([269, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.8349299430847168  GigaBytes
Max Memory Allocated: 1.030207633972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.26175737380981445  GigaBytes
Max Memory Allocated: 1.030207633972168  GigaBytes

torch.Size([1990, 1433])
torch.Size([1371, 16])
torch.Size([666, 16])
torch.Size([204, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.8177156448364258  GigaBytes
Max Memory Allocated: 1.030207633972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.26287269592285156  GigaBytes
Max Memory Allocated: 1.030207633972168  GigaBytes

torch.Size([2191, 1433])
torch.Size([1707, 16])
torch.Size([888, 16])
torch.Size([291, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.9310369491577148  GigaBytes
Max Memory Allocated: 1.030207633972168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.26186037063598633  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes
Using backend: pytorch

torch.Size([2008, 1433])
torch.Size([1487, 16])
torch.Size([730, 16])
torch.Size([225, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.8509535789489746  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.26285552978515625  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

torch.Size([2061, 1433])
torch.Size([1487, 16])
torch.Size([690, 16])
torch.Size([206, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.8509101867675781  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.2619953155517578  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

torch.Size([2034, 1433])
torch.Size([1477, 16])
torch.Size([676, 16])
torch.Size([209, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.847775936126709  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.2613072395324707  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

torch.Size([1908, 1433])
torch.Size([1278, 16])
torch.Size([567, 16])
torch.Size([197, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.7685799598693848  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.2623782157897949  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

torch.Size([2104, 1433])
torch.Size([1591, 16])
torch.Size([761, 16])
torch.Size([234, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 0.891423225402832  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 0.2616763114929199  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

torch.Size([1975, 1433])
torch.Size([1400, 16])
torch.Size([640, 16])
torch.Size([183, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 0.8311929702758789  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 0.2609372138977051  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

torch.Size([1839, 1433])
torch.Size([1157, 16])
torch.Size([505, 16])
torch.Size([167, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 0.7477469444274902  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 0.2608218193054199  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

torch.Size([1810, 1433])
torch.Size([1064, 16])
torch.Size([362, 16])
torch.Size([110, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 0.7121238708496094  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 0.2628488540649414  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

torch.Size([2025, 1433])
torch.Size([1330, 16])
torch.Size([606, 16])
torch.Size([196, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 0.8082022666931152  GigaBytes
Max Memory Allocated: 1.0354204177856445  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06260193884372711 |0.0009673535823822021 |0.1974078267812729 |0.00014705955982208252 |0.2598349004983902 |0.012075662612915039 |
----------------------------------------------------------pseudo_mini_loss sum 2.2046875953674316
Total (block generation + training)time/epoch 8.807326555252075
Training time/epoch 8.419177532196045
Training time without block to device /epoch 8.40369987487793
Training time without total dataloading part /epoch 7.330312252044678
load block tensor time/epoch 1.0016310214996338
block to device time/epoch 0.015477657318115234
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  70994
Number of first layer input nodes during this epoch:  32348
