main start at this time 1648432411.2567275
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0008325576782226562
random selection method range initialization spend 0.0001926422119140625
time for parepare:  6.079673767089844e-05
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0019414424896240234
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.7894973754882812e-05
----------------------check_connections_block total spend ----------------------------- 0.003744363784790039
generate_one_block  0.001226186752319336
generate_one_block  0.0009946823120117188
generate_one_block  0.0010035037994384766
generate_one_block  0.0009870529174804688
generate_one_block  0.0009870529174804688
generate_one_block  0.0009746551513671875
generate_one_block  0.0009717941284179688
generate_one_block  0.0009679794311523438
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004723072052001953
gen group dst list time:  5.316734313964844e-05
time for parepare:  0.00013399124145507812
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0002231597900390625
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00022554397583007812
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0002524852752685547
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00024175643920898438
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00024175643920898438
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00021529197692871094
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0002079010009765625
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00015997886657714844
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00011610984802246094
----------------------check_connections_block total spend ----------------------------- 0.003789663314819336
generate_one_block  0.001233816146850586
generate_one_block  0.001251220703125
generate_one_block  0.0012364387512207031
generate_one_block  0.0012459754943847656
generate_one_block  0.0012574195861816406
generate_one_block  0.0011930465698242188
generate_one_block  0.0011799335479736328
generate_one_block  0.001073598861694336
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006246566772460938
gen group dst list time:  9.465217590332031e-05
time for parepare:  0.00018095970153808594
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.0002884864807128906
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.0007343292236328125
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  9.1552734375e-05
r_  generation:  0.0007977485656738281
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0007460117340087891
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0007829666137695312
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0007107257843017578
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0006871223449707031
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0005662441253662109
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.000331878662109375
----------------------check_connections_block total spend ----------------------------- 0.009373903274536133
generate_one_block  0.0018477439880371094
generate_one_block  0.0018963813781738281
generate_one_block  0.001802682876586914
generate_one_block  0.0018856525421142578
generate_one_block  0.0018198490142822266
generate_one_block  0.0018529891967773438
generate_one_block  0.0016446113586425781
generate_one_block  0.001317739486694336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007145404815673828
gen group dst list time:  0.0001709461212158203
time for parepare:  0.00017952919006347656
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00037097930908203125
mini_batch_src_global generation:  0.0001347064971923828
r_  generation:  0.0016314983367919922
local_output_nid generation:  8.749961853027344e-05
local_in_edges_tensor generation:  0.00023674964904785156
mini_batch_src_global generation:  0.00019598007202148438
r_  generation:  0.0017235279083251953
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.00022363662719726562
mini_batch_src_global generation:  0.00016117095947265625
r_  generation:  0.0015552043914794922
local_output_nid generation:  7.915496826171875e-05
local_in_edges_tensor generation:  0.00022721290588378906
mini_batch_src_global generation:  0.00015783309936523438
r_  generation:  0.0016770362854003906
local_output_nid generation:  8.630752563476562e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  0.00016832351684570312
r_  generation:  0.0017266273498535156
local_output_nid generation:  7.534027099609375e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  0.0001544952392578125
r_  generation:  0.0015439987182617188
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  0.00014972686767578125
r_  generation:  0.0015101432800292969
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.000110626220703125
r_  generation:  0.0008809566497802734
----------------------check_connections_block total spend ----------------------------- 0.019068479537963867
generate_one_block  0.002905130386352539
generate_one_block  0.0029113292694091797
generate_one_block  0.0027091503143310547
generate_one_block  0.002886056900024414
generate_one_block  0.0030918121337890625
generate_one_block  0.0027437210083007812
generate_one_block  0.0027282238006591797
generate_one_block  0.0020835399627685547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007386207580566406
gen group dst list time:  0.00028014183044433594
time for parepare:  0.0001780986785888672
local_output_nid generation:  0.00011706352233886719
local_in_edges_tensor generation:  0.00043487548828125
mini_batch_src_global generation:  0.000232696533203125
r_  generation:  0.002455472946166992
local_output_nid generation:  0.00012922286987304688
local_in_edges_tensor generation:  0.0003046989440917969
mini_batch_src_global generation:  0.0002834796905517578
r_  generation:  0.0025229454040527344
local_output_nid generation:  0.0001227855682373047
local_in_edges_tensor generation:  0.0002849102020263672
mini_batch_src_global generation:  0.0002498626708984375
r_  generation:  0.002320528030395508
local_output_nid generation:  0.0001285076141357422
local_in_edges_tensor generation:  0.0002942085266113281
mini_batch_src_global generation:  0.00021076202392578125
r_  generation:  0.0024318695068359375
local_output_nid generation:  0.0001304149627685547
local_in_edges_tensor generation:  0.0003008842468261719
mini_batch_src_global generation:  0.00021696090698242188
r_  generation:  0.0024967193603515625
local_output_nid generation:  0.00012540817260742188
local_in_edges_tensor generation:  0.00029277801513671875
mini_batch_src_global generation:  0.0002167224884033203
r_  generation:  0.0024323463439941406
local_output_nid generation:  0.00012826919555664062
local_in_edges_tensor generation:  0.0002942085266113281
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.002445697784423828
local_output_nid generation:  9.799003601074219e-05
local_in_edges_tensor generation:  0.00024890899658203125
mini_batch_src_global generation:  0.00018143653869628906
r_  generation:  0.0018477439880371094
----------------------check_connections_block total spend ----------------------------- 0.028850317001342773
generate_one_block  0.0038063526153564453
generate_one_block  0.0037386417388916016
generate_one_block  0.0035161972045898438
generate_one_block  0.004124641418457031
generate_one_block  0.0038499832153320312
generate_one_block  0.0036993026733398438
generate_one_block  0.0036466121673583984
generate_one_block  0.0030198097229003906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

connection checking time:  0.06108236312866211
block generation total time  0.07519960403442383
average batch blocks generation time:  0.009399950504302979
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07483911514282227  GigaBytes
Max Memory Allocated: 0.07483911514282227  GigaBytes

torch.Size([2238, 1433])
torch.Size([1821, 16])
torch.Size([1107, 16])
torch.Size([437, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0194091796875 GB
    Memory Allocated: 0.7690238952636719  GigaBytes
Max Memory Allocated: 0.8214011192321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1131591796875 GB
    Memory Allocated: 0.1373767852783203  GigaBytes
Max Memory Allocated: 0.8714132308959961  GigaBytes

torch.Size([2302, 1433])
torch.Size([1896, 16])
torch.Size([1178, 16])
torch.Size([477, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.8559813499450684  GigaBytes
Max Memory Allocated: 0.9102063179016113  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.1366872787475586  GigaBytes
Max Memory Allocated: 0.9575109481811523  GigaBytes

torch.Size([2190, 1433])
torch.Size([1719, 16])
torch.Size([1043, 16])
torch.Size([465, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.7985897064208984  GigaBytes
Max Memory Allocated: 0.9575109481811523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.1373729705810547  GigaBytes
Max Memory Allocated: 0.9575109481811523  GigaBytes

torch.Size([2206, 1433])
torch.Size([1812, 16])
torch.Size([1103, 16])
torch.Size([459, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.8300824165344238  GigaBytes
Max Memory Allocated: 0.9575109481811523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.13682842254638672  GigaBytes
Max Memory Allocated: 0.9575109481811523  GigaBytes

torch.Size([2215, 1433])
torch.Size([1860, 16])
torch.Size([1166, 16])
torch.Size([415, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.8477072715759277  GigaBytes
Max Memory Allocated: 0.9575109481811523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.13736534118652344  GigaBytes
Max Memory Allocated: 0.9575109481811523  GigaBytes

torch.Size([2216, 1433])
torch.Size([1787, 16])
torch.Size([1028, 16])
torch.Size([405, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.8247952461242676  GigaBytes
Max Memory Allocated: 0.9575109481811523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.13687992095947266  GigaBytes
Max Memory Allocated: 0.9575109481811523  GigaBytes

torch.Size([2227, 1433])
torch.Size([1804, 16])
torch.Size([986, 16])
torch.Size([338, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.8250422477722168  GigaBytes
Max Memory Allocated: 0.9575109481811523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.1352839469909668  GigaBytes
Max Memory Allocated: 0.9575109481811523  GigaBytes

torch.Size([1935, 1433])
torch.Size([1258, 16])
torch.Size([531, 16])
torch.Size([190, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.6543025970458984  GigaBytes
Max Memory Allocated: 0.9575109481811523  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06137832999229431 |0.04307219386100769 |0.2732987403869629 |0.0001398026943206787 |0.29002895951271057 |0.018350601196289062 |
----------------------------------------------------------pseudo_mini_loss sum 2.7208681106567383
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  43562
Number of first layer input nodes during this epoch:  17529
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.26093149185180664  GigaBytes
Max Memory Allocated: 0.9575109481811523  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012042522430419922
random selection method range initialization spend 0.00015163421630859375
time for parepare:  7.963180541992188e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  7.677078247070312e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  5.555152893066406e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.649162292480469e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.458427429199219e-05
----------------------check_connections_block total spend ----------------------------- 0.0020589828491210938
generate_one_block  0.0013065338134765625
generate_one_block  0.0011081695556640625
generate_one_block  0.0010738372802734375
generate_one_block  0.001079559326171875
generate_one_block  0.0010683536529541016
generate_one_block  0.0010609626770019531
generate_one_block  0.0010538101196289062
generate_one_block  0.0010421276092529297
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005309581756591797
gen group dst list time:  6.461143493652344e-05
time for parepare:  0.00019168853759765625
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.0003421306610107422
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00025653839111328125
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0002396106719970703
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0002562999725341797
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0001952648162841797
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0002162456512451172
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0001952648162841797
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00019025802612304688
----------------------check_connections_block total spend ----------------------------- 0.004361867904663086
generate_one_block  0.0015347003936767578
generate_one_block  0.0013141632080078125
generate_one_block  0.0013308525085449219
generate_one_block  0.0014352798461914062
generate_one_block  0.0012552738189697266
generate_one_block  0.001275777816772461
generate_one_block  0.0012516975402832031
generate_one_block  0.0011894702911376953
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007393360137939453
gen group dst list time:  0.00011467933654785156
time for parepare:  0.0002117156982421875
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.00028896331787109375
mini_batch_src_global generation:  0.00014710426330566406
r_  generation:  0.0010714530944824219
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0007684230804443359
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.0008499622344970703
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  0.0001125335693359375
r_  generation:  0.0008561611175537109
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.0006351470947265625
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0007383823394775391
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  0.00010442733764648438
r_  generation:  0.0006608963012695312
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  8.511543273925781e-05
r_  generation:  0.0006000995635986328
----------------------check_connections_block total spend ----------------------------- 0.011101961135864258
generate_one_block  0.0024678707122802734
generate_one_block  0.0019371509552001953
generate_one_block  0.0020051002502441406
generate_one_block  0.00215911865234375
generate_one_block  0.0017731189727783203
generate_one_block  0.0018856525421142578
generate_one_block  0.0018057823181152344
generate_one_block  0.001680135726928711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000766754150390625
gen group dst list time:  0.00021266937255859375
time for parepare:  0.00020766258239746094
local_output_nid generation:  0.00012373924255371094
local_in_edges_tensor generation:  0.00044846534729003906
mini_batch_src_global generation:  0.00024580955505371094
r_  generation:  0.0021440982818603516
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.0002684593200683594
mini_batch_src_global generation:  0.0001971721649169922
r_  generation:  0.0017230510711669922
local_output_nid generation:  0.00010132789611816406
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  0.00017690658569335938
r_  generation:  0.0018773078918457031
local_output_nid generation:  0.00010991096496582031
local_in_edges_tensor generation:  0.00026798248291015625
mini_batch_src_global generation:  0.00018835067749023438
r_  generation:  0.0019500255584716797
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  0.0001659393310546875
r_  generation:  0.0016140937805175781
local_output_nid generation:  9.822845458984375e-05
local_in_edges_tensor generation:  0.0004620552062988281
mini_batch_src_global generation:  0.00018477439880371094
r_  generation:  0.001791238784790039
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.0002474784851074219
mini_batch_src_global generation:  0.00016880035400390625
r_  generation:  0.001714468002319336
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.0002231597900390625
mini_batch_src_global generation:  0.0001418590545654297
r_  generation:  0.0012865066528320312
----------------------check_connections_block total spend ----------------------------- 0.022637605667114258
generate_one_block  0.0035810470581054688
generate_one_block  0.0030488967895507812
generate_one_block  0.003187417984008789
generate_one_block  0.003204822540283203
generate_one_block  0.002846240997314453
generate_one_block  0.0031173229217529297
generate_one_block  0.0029404163360595703
generate_one_block  0.002549409866333008
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007956027984619141
gen group dst list time:  0.0004076957702636719
time for parepare:  0.00023627281188964844
local_output_nid generation:  0.0001895427703857422
local_in_edges_tensor generation:  0.0004775524139404297
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.0027763843536376953
local_output_nid generation:  0.00015616416931152344
local_in_edges_tensor generation:  0.0003333091735839844
mini_batch_src_global generation:  0.000278472900390625
r_  generation:  0.0025975704193115234
local_output_nid generation:  0.00016689300537109375
local_in_edges_tensor generation:  0.0003345012664794922
mini_batch_src_global generation:  0.00023436546325683594
r_  generation:  0.0028243064880371094
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.0003287792205810547
mini_batch_src_global generation:  0.00024962425231933594
r_  generation:  0.002741575241088867
local_output_nid generation:  0.0001513957977294922
local_in_edges_tensor generation:  0.00031566619873046875
mini_batch_src_global generation:  0.00023984909057617188
r_  generation:  0.0025877952575683594
local_output_nid generation:  0.00016045570373535156
local_in_edges_tensor generation:  0.00033283233642578125
mini_batch_src_global generation:  0.00023746490478515625
r_  generation:  0.0027589797973632812
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.00031280517578125
mini_batch_src_global generation:  0.00023293495178222656
r_  generation:  0.002412557601928711
local_output_nid generation:  0.00013208389282226562
local_in_edges_tensor generation:  0.00029206275939941406
mini_batch_src_global generation:  0.00020766258239746094
r_  generation:  0.0022542476654052734
----------------------check_connections_block total spend ----------------------------- 0.03211164474487305
generate_one_block  0.004247903823852539
generate_one_block  0.003919124603271484
generate_one_block  0.0040204524993896484
generate_one_block  0.0040094852447509766
generate_one_block  0.004076242446899414
generate_one_block  0.004053592681884766
generate_one_block  0.003757953643798828
generate_one_block  0.003598451614379883
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.26093149185180664  GigaBytes
Max Memory Allocated: 0.9575109481811523  GigaBytes

connection checking time:  0.07021307945251465
block generation total time  0.08245992660522461
average batch blocks generation time:  0.010307490825653076
block dataloader generation time/epoch 0.240217924118042
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.2627711296081543  GigaBytes
Max Memory Allocated: 0.9575109481811523  GigaBytes

torch.Size([2291, 1433])
torch.Size([1965, 16])
torch.Size([1352, 16])
torch.Size([605, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.995945930480957  GigaBytes
Max Memory Allocated: 1.0494074821472168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 0.26288700103759766  GigaBytes
Max Memory Allocated: 1.0950288772583008  GigaBytes

torch.Size([2191, 1433])
torch.Size([1776, 16])
torch.Size([1050, 16])
torch.Size([379, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 0.951812744140625  GigaBytes
Max Memory Allocated: 1.0950288772583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 0.2628359794616699  GigaBytes
Max Memory Allocated: 1.0950288772583008  GigaBytes

torch.Size([2306, 1433])
torch.Size([1922, 16])
torch.Size([1150, 16])
torch.Size([458, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 0.9864087104797363  GigaBytes
Max Memory Allocated: 1.0950288772583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 0.2628974914550781  GigaBytes
Max Memory Allocated: 1.0950288772583008  GigaBytes

torch.Size([2245, 1433])
torch.Size([1914, 16])
torch.Size([1212, 16])
torch.Size([467, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 0.9876537322998047  GigaBytes
Max Memory Allocated: 1.0950288772583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 0.2621469497680664  GigaBytes
Max Memory Allocated: 1.0950288772583008  GigaBytes

torch.Size([2180, 1433])
torch.Size([1779, 16])
torch.Size([970, 16])
torch.Size([351, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 0.9316239356994629  GigaBytes
Max Memory Allocated: 1.0950288772583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 0.2628908157348633  GigaBytes
Max Memory Allocated: 1.0950288772583008  GigaBytes

torch.Size([2275, 1433])
torch.Size([1924, 16])
torch.Size([1086, 16])
torch.Size([418, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.9929137229919434  GigaBytes
Max Memory Allocated: 1.0950288772583008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.2619204521179199  GigaBytes
Max Memory Allocated: 1.0951652526855469  GigaBytes

torch.Size([2137, 1433])
torch.Size([1733, 16])
torch.Size([997, 16])
torch.Size([346, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.9319796562194824  GigaBytes
Max Memory Allocated: 1.0951652526855469  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.2628669738769531  GigaBytes
Max Memory Allocated: 1.0951652526855469  GigaBytes

torch.Size([2137, 1433])
torch.Size([1585, 16])
torch.Size([812, 16])
torch.Size([298, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.8902945518493652  GigaBytes
Max Memory Allocated: 1.0951652526855469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.057297468185424805 |0.0011130273342132568 |0.21597963571548462 |0.00012570619583129883 |0.29556941986083984 |0.014463424682617188 |
----------------------------------------------------------pseudo_mini_loss sum 2.2386133670806885
Total (block generation + training)time/epoch 4.881114721298218
Training time/epoch 4.640304088592529
Training time without block to device /epoch 4.631399869918823
Training time without total dataloading part /epoch 4.107861518859863
load block tensor time/epoch 0.45837974548339844
block to device time/epoch 0.008904218673706055
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  45061
Number of first layer input nodes during this epoch:  17762
