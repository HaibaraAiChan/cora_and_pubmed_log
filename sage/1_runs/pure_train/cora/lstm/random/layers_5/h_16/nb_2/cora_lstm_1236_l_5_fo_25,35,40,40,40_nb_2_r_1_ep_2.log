main start at this time 1648432384.803839
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012695789337158203
random selection method range initialization spend 0.00017499923706054688
time for parepare:  6.341934204101562e-05
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.002590656280517578
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00011277198791503906
----------------------check_connections_block total spend ----------------------------- 0.0034558773040771484
generate_one_block  0.0016181468963623047
generate_one_block  0.0012097358703613281
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005338191986083984
gen group dst list time:  3.0994415283203125e-05
time for parepare:  0.0001361370086669922
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0007219314575195312
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.000637054443359375
----------------------check_connections_block total spend ----------------------------- 0.0024788379669189453
generate_one_block  0.0019176006317138672
generate_one_block  0.001728057861328125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000568389892578125
gen group dst list time:  5.507469177246094e-05
time for parepare:  0.0001723766326904297
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.0003273487091064453
mini_batch_src_global generation:  0.00019288063049316406
r_  generation:  0.0017731189727783203
local_output_nid generation:  7.700920104980469e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  0.00017523765563964844
r_  generation:  0.0016696453094482422
----------------------check_connections_block total spend ----------------------------- 0.005536079406738281
generate_one_block  0.0030469894409179688
generate_one_block  0.0029020309448242188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006046295166015625
gen group dst list time:  8.654594421386719e-05
time for parepare:  0.0001964569091796875
local_output_nid generation:  0.00012159347534179688
local_in_edges_tensor generation:  0.0004124641418457031
mini_batch_src_global generation:  0.00019216537475585938
r_  generation:  0.0026865005493164062
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.0003170967102050781
mini_batch_src_global generation:  0.00025963783264160156
r_  generation:  0.002686738967895508
----------------------check_connections_block total spend ----------------------------- 0.00824284553527832
generate_one_block  0.003936767578125
generate_one_block  0.004081010818481445
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007615089416503906
gen group dst list time:  0.00010657310485839844
time for parepare:  0.00018525123596191406
local_output_nid generation:  0.00014829635620117188
local_in_edges_tensor generation:  0.0004584789276123047
mini_batch_src_global generation:  0.0002105236053466797
r_  generation:  0.0031707286834716797
local_output_nid generation:  0.00016045570373535156
local_in_edges_tensor generation:  0.00035881996154785156
mini_batch_src_global generation:  0.0002713203430175781
r_  generation:  0.003126382827758789
----------------------check_connections_block total spend ----------------------------- 0.009470701217651367
generate_one_block  0.004326343536376953
generate_one_block  0.004128456115722656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

connection checking time:  0.025728464126586914
block generation total time  0.026067256927490234
average batch blocks generation time:  0.013033628463745117
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07663536071777344  GigaBytes
Max Memory Allocated: 0.07663536071777344  GigaBytes

torch.Size([2459, 1433])
torch.Size([2316, 16])
torch.Size([1884, 16])
torch.Size([1143, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1873779296875 GB
    Memory Allocated: 0.9173192977905273  GigaBytes
Max Memory Allocated: 0.9737420082092285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.13874053955078125  GigaBytes
Max Memory Allocated: 1.008570671081543  GigaBytes

torch.Size([2456, 1433])
torch.Size([2322, 16])
torch.Size([1873, 16])
torch.Size([1053, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.9791436195373535  GigaBytes
Max Memory Allocated: 1.0369219779968262  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04592001438140869 |0.17099809646606445 |0.5018987655639648 |0.00021541118621826172 |0.3531351089477539 |0.018015146255493164 |
----------------------------------------------------------pseudo_mini_loss sum 2.7964084148406982
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16201
Number of first layer input nodes during this epoch:  4915
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 0.2639636993408203  GigaBytes
Max Memory Allocated: 1.0714216232299805  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005307197570800781
random selection method range initialization spend 0.00012445449829101562
time for parepare:  7.319450378417969e-05
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00014257431030273438
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0001087188720703125
----------------------check_connections_block total spend ----------------------------- 0.0009348392486572266
generate_one_block  0.0014717578887939453
generate_one_block  0.0012087821960449219
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005118846893310547
gen group dst list time:  3.266334533691406e-05
time for parepare:  0.00015997886657714844
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.0002357959747314453
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0007646083831787109
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.0001728534698486328Using backend: pytorch

mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.0006303787231445312
----------------------check_connections_block total spend ----------------------------- 0.0027611255645751953
generate_one_block  0.002141714096069336
generate_one_block  0.0018489360809326172
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005850791931152344
gen group dst list time:  6.365776062011719e-05
time for parepare:  0.00018286705017089844
local_output_nid generation:  9.775161743164062e-05
local_in_edges_tensor generation:  0.0003426074981689453
mini_batch_src_global generation:  0.0002079010009765625
r_  generation:  0.0019681453704833984
local_output_nid generation:  9.1552734375e-05
local_in_edges_tensor generation:  0.0002429485321044922
mini_batch_src_global generation:  0.00019407272338867188
r_  generation:  0.0017590522766113281
----------------------check_connections_block total spend ----------------------------- 0.006020307540893555
generate_one_block  0.003747224807739258
generate_one_block  0.003111124038696289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006406307220458984
gen group dst list time:  9.083747863769531e-05
time for parepare:  0.00018668174743652344
local_output_nid generation:  0.0001437664031982422
local_in_edges_tensor generation:  0.0004184246063232422
mini_batch_src_global generation:  0.00020575523376464844
r_  generation:  0.0028722286224365234
local_output_nid generation:  0.00014734268188476562
local_in_edges_tensor generation:  0.0003256797790527344
mini_batch_src_global generation:  0.00030112266540527344
r_  generation:  0.0028481483459472656
----------------------check_connections_block total spend ----------------------------- 0.008910655975341797
generate_one_block  0.0043184757232666016
generate_one_block  0.004118204116821289
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007722377777099609
gen group dst list time:  0.0001399517059326172
time for parepare:  0.00019502639770507812
local_output_nid generation:  0.00017189979553222656
local_in_edges_tensor generation:  0.00047206878662109375
mini_batch_src_global generation:  0.00022673606872558594
r_  generation:  0.0032160282135009766
local_output_nid generation:  0.00018358230590820312
local_in_edges_tensor generation:  0.000362396240234375
mini_batch_src_global generation:  0.0003209114074707031
r_  generation:  0.003249645233154297
----------------------check_connections_block total spend ----------------------------- 0.009869813919067383
generate_one_block  0.004889249801635742
generate_one_block  0.004510402679443359
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 0.2639636993408203  GigaBytes
Max Memory Allocated: 1.0714216232299805  GigaBytes

connection checking time:  0.02756190299987793
block generation total time  0.028685331344604492
average batch blocks generation time:  0.014342665672302246
block dataloader generation time/epoch 0.0864109992980957
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 0.26361751556396484  GigaBytes
Max Memory Allocated: 1.0714216232299805  GigaBytes

torch.Size([2471, 1433])
torch.Size([2334, 16])
torch.Size([1936, 16])
torch.Size([1174, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5408935546875 GB
    Memory Allocated: 1.1094169616699219  GigaBytes
Max Memory Allocated: 1.1662182807922363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5408935546875 GB
    Memory Allocated: 0.2636079788208008  GigaBytes
Max Memory Allocated: 1.2006125450134277  GigaBytes

torch.Size([2453, 1433])
torch.Size([2319, 16])
torch.Size([1886, 16])
torch.Size([1060, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5408935546875 GB
    Memory Allocated: 1.1011695861816406  GigaBytes
Max Memory Allocated: 1.2006125450134277  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03767704963684082 |0.0009576082229614258 |0.26081764698028564 |0.00013434886932373047 |0.35591626167297363 |0.0141143798828125 |
----------------------------------------------------------pseudo_mini_loss sum 2.196232557296753
Total (block generation + training)time/epoch 1.4749324321746826
Training time/epoch 1.388185977935791
Training time without block to device /epoch 1.3862707614898682
Training time without total dataloading part /epoch 1.2478508949279785
load block tensor time/epoch 0.07535409927368164
block to device time/epoch 0.0019152164459228516
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16330
Number of first layer input nodes during this epoch:  4924
