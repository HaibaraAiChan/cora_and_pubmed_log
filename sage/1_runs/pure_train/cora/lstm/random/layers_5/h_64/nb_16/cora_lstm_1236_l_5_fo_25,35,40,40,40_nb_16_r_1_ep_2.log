main start at this time 1648432573.373878
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0638275146484375  GigaBytes
Max Memory Allocated: 0.0638275146484375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0014955997467041016
random selection method range initialization spend 0.00029206275939941406
time for parepare:  9.298324584960938e-05
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0035288333892822266
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  7.62939453125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  4.7206878662109375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.6927719116210938e-05
----------------------check_connections_block total spend ----------------------------- 0.008036136627197266
generate_one_block  0.0013287067413330078
generate_one_block  0.0010797977447509766
generate_one_block  0.0010547637939453125
generate_one_block  0.0010454654693603516
generate_one_block  0.00103759765625
generate_one_block  0.0010607242584228516
generate_one_block  0.0011053085327148438
generate_one_block  0.0009982585906982422
generate_one_block  0.0009868144989013672
generate_one_block  0.000972747802734375
generate_one_block  0.0009591579437255859
generate_one_block  0.0009734630584716797
generate_one_block  0.0009706020355224609
generate_one_block  0.0009815692901611328
generate_one_block  0.0010228157043457031
generate_one_block  0.0009562969207763672
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006251335144042969
gen group dst list time:  0.00010776519775390625
time for parepare:  0.00016832351684570312
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001239776611328125
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00012063980102539062
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00010085105895996094
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.000118255615234375
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001895427703857422
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00014710426330566406
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00010824203491210938
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001544952392578125
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00017213821411132812
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00012087821960449219
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010609626770019531
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00011110305786132812
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00016260147094726562
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0002422332763671875
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  7.510185241699219e-05
----------------------check_connections_block total spend ----------------------------- 0.0058743953704833984
generate_one_block  0.0012001991271972656
generate_one_block  0.0011785030364990234
generate_one_block  0.0011403560638427734
generate_one_block  0.001173257827758789
generate_one_block  0.0011935234069824219
generate_one_block  0.0012662410736083984
generate_one_block  0.0012085437774658203
generate_one_block  0.0011687278747558594
generate_one_block  0.0012454986572265625
generate_one_block  0.001127481460571289
generate_one_block  0.0010905265808105469
generate_one_block  0.0010464191436767578
generate_one_block  0.0010864734649658203
generate_one_block  0.0011227130889892578
generate_one_block  0.0012083053588867188
generate_one_block  0.001016378402709961
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006685256958007812
gen group dst list time:  0.00014925003051757812
time for parepare:  0.0001895427703857422
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0004401206970214844
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00042748451232910156
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0003578662872314453
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00047016143798828125
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.0003147125244140625
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0006783008575439453
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0005824565887451172
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.00036525726318359375
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0005145072937011719
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0005819797515869141
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0005109310150146484
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.00034546852111816406
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0003712177276611328
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.0005552768707275391
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  9.34600830078125e-05
r_  generation:  0.0008502006530761719
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00031876564025878906
----------------------check_connections_block total spend ----------------------------- 0.014036417007446289
generate_one_block  0.0015826225280761719
generate_one_block  0.0015475749969482422
generate_one_block  0.0016486644744873047
generate_one_block  0.001447916030883789
generate_one_block  0.0012936592102050781
generate_one_block  0.0016818046569824219
generate_one_block  0.0015630722045898438
generate_one_block  0.001312255859375
generate_one_block  0.0014798641204833984
generate_one_block  0.0015625953674316406
generate_one_block  0.0015137195587158203
generate_one_block  0.0013005733489990234
generate_one_block  0.0013408660888671875
generate_one_block  0.0015106201171875
generate_one_block  0.0018811225891113281
generate_one_block  0.0012967586517333984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007207393646240234
gen group dst list time:  0.00036072731018066406
time for parepare:  0.0002448558807373047
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00031113624572753906
mini_batch_src_global generation:  0.0001323223114013672
r_  generation:  0.001312255859375
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.00016236305236816406
r_  generation:  0.0012288093566894531
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.0011258125305175781
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.0012238025665283203
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  0.00011682510375976562
r_  generation:  0.0010440349578857422
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.0016412734985351562
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  0.00014781951904296875
r_  generation:  0.0014190673828125
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.0008645057678222656
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.0013103485107421875
local_output_nid generation:  7.534027099609375e-05
local_in_edges_tensor generation:  0.00022602081298828125
mini_batch_src_global generation:  0.00015234947204589844
r_  generation:  0.001566171646118164
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.0001423358917236328
r_  generation:  0.0012583732604980469
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.0009713172912597656
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.0009186267852783203
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0011708736419677734
local_output_nid generation:  8.296966552734375e-05
local_in_edges_tensor generation:  0.00023317337036132812
mini_batch_src_global generation:  0.00016546249389648438
r_  generation:  0.001787424087524414
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  0.0001251697540283203
r_  generation:  0.0008981227874755859
----------------------check_connections_block total spend ----------------------------- 0.031442880630493164
generate_one_block  0.0027687549591064453
generate_one_block  0.0022821426391601562
generate_one_block  0.0021479129791259766
generate_one_block  0.002218484878540039
generate_one_block  0.0020885467529296875
generate_one_block  0.002650737762451172
generate_one_block  0.002663850784301758
generate_one_block  0.0018768310546875
generate_one_block  0.002323150634765625
generate_one_block  0.0025892257690429688
generate_one_block  0.0023860931396484375
generate_one_block  0.002034425735473633
generate_one_block  0.002077341079711914
generate_one_block  0.003074169158935547
generate_one_block  0.0030236244201660156
generate_one_block  0.0019428730010986328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007503032684326172
gen group dst list time:  0.0006613731384277344
time for parepare:  0.0002009868621826172
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.0004336833953857422
mini_batch_src_global generation:  0.0001919269561767578
r_  generation:  0.002490997314453125
local_output_nid generation:  0.00011801719665527344
local_in_edges_tensor generation:  0.000293731689453125
mini_batch_src_global generation:  0.0002467632293701172
r_  generation:  0.0022623538970947266
local_output_nid generation:  0.00011444091796875
local_in_edges_tensor generation:  0.0002777576446533203
mini_batch_src_global generation:  0.0002009868621826172
r_  generation:  0.0021800994873046875
local_output_nid generation:  0.00011563301086425781
local_in_edges_tensor generation:  0.0002799034118652344
mini_batch_src_global generation:  0.00019884109497070312
r_  generation:  0.0021746158599853516
local_output_nid generation:  0.00011610984802246094
local_in_edges_tensor generation:  0.00027561187744140625
mini_batch_src_global generation:  0.0001990795135498047
r_  generation:  0.0021495819091796875
local_output_nid generation:  0.00013780593872070312
local_in_edges_tensor generation:  0.0003132820129394531
mini_batch_src_global generation:  0.00022792816162109375
r_  generation:  0.002588510513305664
local_output_nid generation:  0.0001277923583984375
local_in_edges_tensor generation:  0.0002779960632324219
mini_batch_src_global generation:  0.00020456314086914062
r_  generation:  0.0021321773529052734
local_output_nid generation:  8.7738037109375e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  0.00016307830810546875
r_  generation:  0.0015757083892822266
local_output_nid generation:  0.00011301040649414062
local_in_edges_tensor generation:  0.0002644062042236328
mini_batch_src_global generation:  0.00018930435180664062
r_  generation:  0.002109527587890625
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.00027751922607421875
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.0022547245025634766
local_output_nid generation:  0.00010848045349121094
local_in_edges_tensor generation:  0.0002617835998535156
mini_batch_src_global generation:  0.00019502639770507812
r_  generation:  0.0020399093627929688
local_output_nid generation:  0.00010085105895996094
local_in_edges_tensor generation:  0.00024318695068359375
mini_batch_src_global generation:  0.0001811981201171875
r_  generation:  0.0018463134765625
local_output_nid generation:  9.441375732421875e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  0.0001697540283203125
r_  generation:  0.0017447471618652344
local_output_nid generation:  0.00010609626770019531
local_in_edges_tensor generation:  0.00025582313537597656
mini_batch_src_global generation:  0.00018477439880371094
r_  generation:  0.001985788345336914
local_output_nid generation:  0.00013136863708496094
local_in_edges_tensor generation:  0.000308990478515625
mini_batch_src_global generation:  0.00023484230041503906
r_  generation:  0.002569437026977539
local_output_nid generation:  8.797645568847656e-05
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  0.00017142295837402344
r_  generation:  0.0015799999237060547
----------------------check_connections_block total spend ----------------------------- 0.051286935806274414
generate_one_block  0.004467964172363281
generate_one_block  0.0032901763916015625
generate_one_block  0.003477334976196289
generate_one_block  0.0031485557556152344
generate_one_block  0.003122091293334961
generate_one_block  0.003539562225341797
generate_one_block  0.003272533416748047
generate_one_block  0.0027582645416259766
generate_one_block  0.0033266544342041016
generate_one_block  0.0035703182220458984
generate_one_block  0.003308534622192383
generate_one_block  0.003118753433227539
generate_one_block  0.003003358840942383
generate_one_block  0.0032622814178466797
generate_one_block  0.0045931339263916016
generate_one_block  0.0028617382049560547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0638275146484375  GigaBytes
Max Memory Allocated: 0.0638275146484375  GigaBytes

connection checking time:  0.10264062881469727
block generation total time  0.1347062587738037
average batch blocks generation time:  0.008419141173362732
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07564401626586914  GigaBytes
Max Memory Allocated: 0.07564401626586914  GigaBytes

torch.Size([2169, 1433])
torch.Size([1620, 64])
torch.Size([736, 64])
torch.Size([221, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.7312393188476562  GigaBytes
Max Memory Allocated: 0.7651515007019043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.13836002349853516  GigaBytes
Max Memory Allocated: 0.8231282234191895  GigaBytes

torch.Size([1989, 1433])
torch.Size([1446, 64])
torch.Size([680, 64])
torch.Size([222, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.7283830642700195  GigaBytes
Max Memory Allocated: 0.8231282234191895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1444091796875 GB
    Memory Allocated: 0.13811826705932617  GigaBytes
Max Memory Allocated: 0.8231282234191895  GigaBytes

torch.Size([1945, 1433])
torch.Size([1359, 64])
torch.Size([616, 64])
torch.Size([153, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1444091796875 GB
    Memory Allocated: 0.7036032676696777  GigaBytes
Max Memory Allocated: 0.8231282234191895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1444091796875 GB
    Memory Allocated: 0.13813495635986328  GigaBytes
Max Memory Allocated: 0.8231282234191895  GigaBytes

torch.Size([1947, 1433])
torch.Size([1380, 64])
torch.Size([643, 64])
torch.Size([226, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1444091796875 GB
    Memory Allocated: 0.7045793533325195  GigaBytes
Max Memory Allocated: 0.8231282234191895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1444091796875 GB
    Memory Allocated: 0.1382908821105957  GigaBytes
Max Memory Allocated: 0.8231282234191895  GigaBytes

torch.Size([1978, 1433])
torch.Size([1339, 64])
torch.Size([558, 64])
torch.Size([155, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.6935591697692871  GigaBytes
Max Memory Allocated: 0.8231282234191895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.13922643661499023  GigaBytes
Max Memory Allocated: 0.8231282234191895  GigaBytes

torch.Size([2147, 1433])
torch.Size([1698, 64])
torch.Size([953, 64])
torch.Size([348, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1893310546875 GB
    Memory Allocated: 0.8172369003295898  GigaBytes
Max Memory Allocated: 0.8455448150634766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1893310546875 GB
    Memory Allocated: 0.13946914672851562  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

torch.Size([2036, 1433])
torch.Size([1505, 64])
torch.Size([821, 64])
torch.Size([270, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1893310546875 GB
    Memory Allocated: 0.7435641288757324  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1893310546875 GB
    Memory Allocated: 0.13725709915161133  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

torch.Size([1786, 1433])
torch.Size([1082, 64])
torch.Size([442, 64])
torch.Size([173, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1893310546875 GB
    Memory Allocated: 0.6003713607788086  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1893310546875 GB
    Memory Allocated: 0.1394662857055664  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

torch.Size([2028, 1433])
torch.Size([1514, 64])
torch.Size([744, 64])
torch.Size([261, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.7559804916381836  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.13919496536254883  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

torch.Size([2142, 1433])
torch.Size([1633, 64])
torch.Size([898, 64])
torch.Size([285, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.7988224029541016  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.1394643783569336  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

torch.Size([2050, 1433])
torch.Size([1476, 64])
torch.Size([755, 64])
torch.Size([265, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.7339434623718262  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.13800668716430664  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

torch.Size([1925, 1433])
torch.Size([1274, 64])
torch.Size([547, 64])
torch.Size([162, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.6778125762939453  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.13780832290649414  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

torch.Size([1888, 1433])
torch.Size([1202, 64])
torch.Size([560, 64])
torch.Size([174, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.6427030563354492  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.13850784301757812  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

torch.Size([2016, 1433])
torch.Size([1421, 64])
torch.Size([728, 64])
torch.Size([264, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.7201619148254395  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.1397533416748047  GigaBytes
Max Memory Allocated: 0.8990340232849121  GigaBytes

torch.Size([2242, 1433])
torch.Size([1925, 64])
torch.Size([1205, 64])
torch.Size([429, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 0.8945231437683105  GigaBytes
Max Memory Allocated: 0.9217095375061035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.13686656951904297  GigaBytes
Max Memory Allocated: 0.9670310020446777  GigaBytes

torch.Size([1713, 1433])
torch.Size([1096, 64])
torch.Size([470, 64])
torch.Size([142, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.5934090614318848  GigaBytes
Max Memory Allocated: 0.9670310020446777  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06042782962322235 |0.022009536623954773 |0.2261079102754593 |0.00013297796249389648 |0.2593012750148773 |0.01824784278869629 |
----------------------------------------------------------pseudo_mini_loss sum 2.809878349304199
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  70846
Number of first layer input nodes during this epoch:  32001
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.26462745666503906  GigaBytes
Max Memory Allocated: 0.9670310020446777  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007627010345458984
random selection method range initialization spend 0.0001647472381591797
time for parepare:  9.489059448242188e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.91278076171875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.4080276489257812e-05
----------------------check_connections_block total spend ----------------------------- 0.0036268234252929688
generate_one_block  0.001180410385131836
generate_one_block  0.0013418197631835938
generate_one_block  0.0011065006256103516
generate_one_block  0.0010764598846435547
generate_one_block  0.0010797977447509766
generate_one_block  0.0010831356048583984
generate_one_block  0.001074075698852539
generate_one_block  0.0010592937469482422
generate_one_block  0.001796722412109375
generate_one_block  0.0010728836059570312
generate_one_block  0.001077890396118164
generate_one_block  0.0010766983032226562
generate_one_block  0.001051187515258789
generate_one_block  0.0009751319885253906
generate_one_block  0.0010504722595214844
generate_one_block  0.0009732246398925781
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006351470947265625
gen group dst list time:  0.00010085105895996094
time for parepare:  0.00022339820861816406
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0002484321594238281
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00013566017150878906
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  9.846687316894531e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00014448165893554688
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  8.440017700195312e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00013375282287597656
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00010633468627929688
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00014781951904296875
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  8.988380432128906e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00017762184143066406
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00015687942504882812
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00017595291137695312
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00016069412231445312
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00021958351135253906
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00013375282287597656
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00019121170043945312
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  7.963180541992188e-05
----------------------check_connections_block total spend ----------------------------- 0.006279468536376953
generate_one_block  0.001264810562133789
generate_one_block  0.0011630058288574219
generate_one_block  0.0012395381927490234
generate_one_block  0.0011386871337890625
generate_one_block  0.0012137889862060547
generate_one_block  0.0011768341064453125
generate_one_block  0.0012233257293701172
generate_one_block  0.0010514259338378906
generate_one_block  0.0011777877807617188
generate_one_block  0.0011510848999023438
generate_one_block  0.001641988754272461
generate_one_block  0.0011713504791259766
generate_one_block  0.0012063980102539062
generate_one_block  0.001104593276977539
generate_one_block  0.0011813640594482422
generate_one_block  0.001046895980834961
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007755756378173828
gen group dst list time:  0.00017070770263671875
time for parepare:  0.000247955322265625
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.0003209114074707031
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00046324729919433594
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0003693103790283203
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0005238056182861328
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.00030231475830078125
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0004837512969970703
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0003745555877685547
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0005080699920654297
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0002512931823730469
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0006189346313476562
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0005905628204345703
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.0006725788116455078
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0006487369537353516
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0007600784301757812
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  8.177757263183594e-05
r_  generation:  0.0005125999450683594
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  9.512901306152344e-05
r_  generation:  0.0006692409515380859
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0002989768981933594
----------------------check_connections_block total spend ----------------------------- 0.01549983024597168
generate_one_block  0.0016722679138183594
generate_one_block  0.0014984607696533203
generate_one_block  0.0015647411346435547
generate_one_block  0.0013053417205810547
generate_one_block  0.00152587890625
generate_one_block  0.0013928413391113281
generate_one_block  0.0016667842864990234
generate_one_block  0.0012226104736328125
generate_one_block  0.0016834735870361328
generate_one_block  0.0016133785247802734
generate_one_block  0.0017855167388916016
generate_one_block  0.001707315444946289
generate_one_block  0.0018038749694824219
generate_one_block  0.001552581787109375
generate_one_block  0.0017583370208740234
generate_one_block  0.0012903213500976562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008113384246826172
gen group dst list time:  0.0003972053527832031
time for parepare:  0.0002319812774658203
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00039649009704589844
mini_batch_src_global generation:  0.0001506805419921875
r_  generation:  0.0011317729949951172
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  0.00014853477478027344
r_  generation:  0.001024484634399414
local_output_nid generation:  7.891654968261719e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  0.0001685619354248047
r_  generation:  0.0014452934265136719
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0008823871612548828
local_output_nid generation:  7.915496826171875e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0014209747314453125
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00020933151245117188
mini_batch_src_global generation:  0.0001251697540283203
r_  generation:  0.0010256767272949219
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  0.00013971328735351562
r_  generation:  0.0013871192932128906
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.0006785392761230469
local_output_nid generation:  8.726119995117188e-05
local_in_edges_tensor generation:  0.00023508071899414062
mini_batch_src_global generation:  0.0001475811004638672
r_  generation:  0.0015027523040771484
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00022602081298828125
mini_batch_src_global generation:  0.0001537799835205078
r_  generation:  0.0014293193817138672
local_output_nid generation:  9.5367431640625e-05
local_in_edges_tensor generation:  0.00023746490478515625
mini_batch_src_global generation:  0.0001804828643798828
r_  generation:  0.0016465187072753906
local_output_nid generation:  8.606910705566406e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.0001621246337890625
r_  generation:  0.0014390945434570312
local_output_nid generation:  8.153915405273438e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.00015115737915039062
r_  generation:  0.0014083385467529297
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.00014662742614746094
r_  generation:  0.0012891292572021484
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.000225067138671875
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0014181137084960938
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  0.0001125335693359375
r_  generation:  0.0007500648498535156
----------------------check_connections_block total spend ----------------------------- 0.0326695442199707
generate_one_block  0.0025320053100585938
generate_one_block  0.0021414756774902344
generate_one_block  0.0025720596313476562
generate_one_block  0.0022211074829101562
generate_one_block  0.002562999725341797
generate_one_block  0.002137899398803711
generate_one_block  0.0025408267974853516
generate_one_block  0.0017113685607910156
generate_one_block  0.0026407241821289062
generate_one_block  0.0025680065155029297
generate_one_block  0.0028803348541259766
generate_one_block  0.002750873565673828
generate_one_block  0.002680063247680664
generate_one_block  0.0026044845581054688
generate_one_block  0.0027141571044921875
generate_one_block  0.0019495487213134766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008826255798339844
gen group dst list time:  0.0007441043853759766
time for parepare:  0.00022292137145996094
local_output_nid generation:  0.0001163482666015625
local_in_edges_tensor generation:  0.00047326087951660156
mini_batch_src_global generation:  0.00017499923706054688
r_  generation:  0.002068758010864258
local_output_nid generation:  0.00011157989501953125
local_in_edges_tensor generation:  0.00029158592224121094
mini_batch_src_global generation:  0.0002143383026123047
r_  generation:  0.00189208984375
local_output_nid generation:  0.00016045570373535156
local_in_edges_tensor generation:  0.0003476142883300781
mini_batch_src_global generation:  0.0002646446228027344
r_  generation:  0.002488374710083008
local_output_nid generation:  0.00010895729064941406
local_in_edges_tensor generation:  0.0002796649932861328
mini_batch_src_global generation:  0.00019407272338867188
r_  generation:  0.0019404888153076172
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.0003368854522705078
mini_batch_src_global generation:  0.00024890899658203125
r_  generation:  0.0025680065155029297
local_output_nid generation:  0.0001163482666015625
local_in_edges_tensor generation:  0.0002944469451904297
mini_batch_src_global generation:  0.00021123886108398438
r_  generation:  0.0020432472229003906
local_output_nid generation:  0.00013375282287597656
local_in_edges_tensor generation:  0.0003306865692138672
mini_batch_src_global generation:  0.00023245811462402344
r_  generation:  0.0024073123931884766
local_output_nid generation:  7.581710815429688e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.000156402587890625
r_  generation:  0.0013661384582519531
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.000301361083984375
mini_batch_src_global generation:  0.00022459030151367188
r_  generation:  0.002370595932006836
local_output_nid generation:  0.00012350082397460938
local_in_edges_tensor generation:  0.0006349086761474609
mini_batch_src_global generation:  0.00023126602172851562
r_  generation:  0.0021774768829345703
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.00032806396484375
mini_batch_src_global generation:  0.00024390220642089844
r_  generation:  0.002483367919921875
local_output_nid generation:  0.0001354217529296875
local_in_edges_tensor generation:  0.00031375885009765625
mini_batch_src_global generation:  0.00022745132446289062
r_  generation:  0.0023980140686035156
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.0003032684326171875
mini_batch_src_global generation:  0.0002129077911376953
r_  generation:  0.002206087112426758
local_output_nid generation:  0.00013518333435058594
local_in_edges_tensor generation:  0.00030994415283203125
mini_batch_src_global generation:  0.0002155303955078125
r_  generation:  0.0022325515747070312
local_output_nid generation:  0.00013875961303710938
local_in_edges_tensor generation:  0.0003123283386230469
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.0023381710052490234
local_output_nid generation:  9.751319885253906e-05
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  0.00017905235290527344
r_  generation:  0.0016143321990966797
----------------------check_connections_block total spend ----------------------------- 0.05479550361633301
generate_one_block  0.003625631332397461
generate_one_block  0.0030655860900878906
generate_one_block  0.003636598587036133
generate_one_block  0.0030579566955566406
generate_one_block  0.0037102699279785156
generate_one_block  0.003189563751220703
generate_one_block  0.0035538673400878906
generate_one_block  0.0026912689208984375
generate_one_block  0.0036606788635253906
generate_one_block  0.003541231155395508
generate_one_block  0.003924131393432617
generate_one_block  0.003740549087524414
generate_one_block  0.0037364959716796875
generate_one_block  0.003648519515991211
generate_one_block  0.0037920475006103516
generate_one_block  0.0029468536376953125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.26462745666503906  GigaBytes
Max Memory Allocated: 0.9670310020446777  GigaBytes

connection checking time:  0.10924434661865234
block generation total time  0.13892579078674316
average batch blocks generation time:  0.008682861924171448
block dataloader generation time/epoch 0.39141178131103516
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.26556873321533203  GigaBytes
Max Memory Allocated: 0.9670310020446777  GigaBytes

torch.Size([1909, 1433])
torch.Size([1291, 64])
torch.Size([628, 64])
torch.Size([234, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.7942538261413574  GigaBytes
Max Memory Allocated: 0.9670310020446777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.2647075653076172  GigaBytes
Max Memory Allocated: 0.9670310020446777  GigaBytes

torch.Size([1726, 1433])
torch.Size([1143, 64])
torch.Size([538, 64])
torch.Size([164, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.7364511489868164  GigaBytes
Max Memory Allocated: 0.9670310020446777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.26711177825927734  GigaBytes
Max Memory Allocated: 0.9670310020446777  GigaBytes

torch.Size([2096, 1433])
torch.Size([1550, 64])
torch.Size([782, 64])
torch.Size([252, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.8908572196960449  GigaBytes
Max Memory Allocated: 0.9670310020446777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.26499414443969727  GigaBytes
Max Memory Allocated: 0.9795694351196289  GigaBytes

torch.Size([1804, 1433])
torch.Size([1140, 64])
torch.Size([461, 64])
torch.Size([117, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.7497138977050781  GigaBytes
Max Memory Allocated: 0.9795694351196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.26711273193359375  GigaBytes
Max Memory Allocated: 0.9795694351196289  GigaBytes

torch.Size([2143, 1433])
torch.Size([1593, 64])
torch.Size([766, 64])
torch.Size([224, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.915626049041748  GigaBytes
Max Memory Allocated: 0.9795694351196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.2653379440307617  GigaBytes
Max Memory Allocated: 1.004384994506836  GigaBytes

torch.Size([1867, 1433])
torch.Size([1251, 64])
torch.Size([543, 64])
torch.Size([184, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.7790775299072266  GigaBytes
Max Memory Allocated: 1.004384994506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.26711082458496094  GigaBytes
Max Memory Allocated: 1.004384994506836  GigaBytes

torch.Size([2052, 1433])
torch.Size([1494, 64])
torch.Size([732, 64])
torch.Size([207, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.880854606628418  GigaBytes
Max Memory Allocated: 1.004384994506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.2638545036315918  GigaBytes
Max Memory Allocated: 1.004384994506836  GigaBytes

torch.Size([1593, 1433])
torch.Size([841, 64])
torch.Size([322, 64])
torch.Size([111, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.6453237533569336  GigaBytes
Max Memory Allocated: 1.004384994506836  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.2671175003051758  GigaBytes
Max Memory Allocated: 1.004384994506836  GigaBytes

torch.Size([2112, 1433])
torch.Size([1573, 64])
torch.Size([832, 64])
torch.Size([278, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.908571720123291  GigaBytes
Max Memory Allocated: 1.004384994506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.26639747619628906  GigaBytes
Max Memory Allocated: 1.004384994506836  GigaBytes

torch.Size([2061, 1433])
torch.Size([1505, 64])
torch.Size([744, 64])
torch.Size([269, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.8795952796936035  GigaBytes
Max Memory Allocated: 1.004384994506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.26731061935424805  GigaBytes
Max Memory Allocated: 1.004384994506836  GigaBytes

torch.Size([2229, 1433])
torch.Size([1759, 64])
torch.Size([956, 64])
torch.Size([330, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.9726376533508301  GigaBytes
Max Memory Allocated: 1.004384994506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.2671232223510742  GigaBytes
Max Memory Allocated: 1.053511142730713  GigaBytes

torch.Size([2129, 1433])
torch.Size([1638, 64])
torch.Size([882, 64])
torch.Size([314, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.9301209449768066  GigaBytes
Max Memory Allocated: 1.053511142730713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.26642656326293945  GigaBytes
Max Memory Allocated: 1.053511142730713  GigaBytes

torch.Size([2065, 1433])
torch.Size([1556, 64])
torch.Size([875, 64])
torch.Size([372, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.892585277557373  GigaBytes
Max Memory Allocated: 1.053511142730713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.26711273193359375  GigaBytes
Max Memory Allocated: 1.053511142730713  GigaBytes

torch.Size([2111, 1433])
torch.Size([1575, 64])
torch.Size([791, 64])
torch.Size([253, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.903132438659668  GigaBytes
Max Memory Allocated: 1.053511142730713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.2672610282897949  GigaBytes
Max Memory Allocated: 1.053511142730713  GigaBytes

torch.Size([2221, 1433])
torch.Size([1659, 64])
torch.Size([900, 64])
torch.Size([320, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 0.9348492622375488  GigaBytes
Max Memory Allocated: 1.053511142730713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 0.26471805572509766  GigaBytes
Max Memory Allocated: 1.053511142730713  GigaBytes

torch.Size([1753, 1433])
torch.Size([1096, 64])
torch.Size([432, 64])
torch.Size([135, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 0.7187705039978027  GigaBytes
Max Memory Allocated: 1.053511142730713  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06145213544368744 |0.0010470151901245117 |0.19849346578121185 |0.00015319883823394775 |0.25846266746520996 |0.008173704147338867 |
----------------------------------------------------------pseudo_mini_loss sum 2.5199952125549316
Total (block generation + training)time/epoch 8.779183387756348
Training time/epoch 8.387535333633423
Training time without block to device /epoch 8.37078309059143
Training time without total dataloading part /epoch 7.321923017501831
load block tensor time/epoch 0.983234167098999
block to device time/epoch 0.016752243041992188
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  70250
Number of first layer input nodes during this epoch:  31871
