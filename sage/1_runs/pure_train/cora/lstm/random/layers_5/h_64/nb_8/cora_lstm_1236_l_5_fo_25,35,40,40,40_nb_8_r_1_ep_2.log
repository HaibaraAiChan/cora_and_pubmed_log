main start at this time 1648432554.968368
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0638275146484375  GigaBytes
Max Memory Allocated: 0.0638275146484375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013756752014160156
random selection method range initialization spend 0.00020313262939453125
time for parepare:  6.604194641113281e-05
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.002388477325439453
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.367134094238281e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.220008850097656e-05
----------------------check_connections_block total spend ----------------------------- 0.004309654235839844
generate_one_block  0.0013163089752197266
generate_one_block  0.0010378360748291016
generate_one_block  0.0010654926300048828
generate_one_block  0.0010499954223632812
generate_one_block  0.0010492801666259766
generate_one_block  0.001024007797241211
generate_one_block  0.0010900497436523438
generate_one_block  0.0010366439819335938
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00049591064453125
gen group dst list time:  5.841255187988281e-05
time for parepare:  0.00014662742614746094
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.0002052783966064453
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00020599365234375
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00022983551025390625
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00021266937255859375
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00026607513427734375
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00019288063049316406
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0002460479736328125
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0002522468566894531
----------------------check_connections_block total spend ----------------------------- 0.0040781497955322266
generate_one_block  0.0012898445129394531
generate_one_block  0.0012502670288085938
generate_one_block  0.0012812614440917969
generate_one_block  0.001251220703125
generate_one_block  0.0013113021850585938
generate_one_block  0.0012233257293701172
generate_one_block  0.001355886459350586
generate_one_block  0.0012798309326171875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006911754608154297
gen group dst list time:  0.0001049041748046875
time for parepare:  0.00019288063049316406
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.0002906322479248047
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0006811618804931641
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0006911754608154297
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0007741451263427734
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0007243156433105469
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0008058547973632812
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  8.463859558105469e-05
r_  generation:  0.0006976127624511719
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.0007762908935546875
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  9.72747802734375e-05
r_  generation:  0.0008625984191894531
----------------------check_connections_block total spend ----------------------------- 0.010362863540649414
generate_one_block  0.001837015151977539
generate_one_block  0.0018274784088134766
generate_one_block  0.0018467903137207031
generate_one_block  0.00176239013671875
generate_one_block  0.001873016357421875
generate_one_block  0.0018384456634521484
generate_one_block  0.001840829849243164
generate_one_block  0.001961231231689453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000732421875
gen group dst list time:  0.000202178955078125
time for parepare:  0.0001842975616455078
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.0004038810729980469
mini_batch_src_global generation:  0.0001366138458251953
r_  generation:  0.001691579818725586
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.0002346038818359375
mini_batch_src_global generation:  0.00019884109497070312
r_  generation:  0.0016531944274902344
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.00024390220642089844
mini_batch_src_global generation:  0.00016617774963378906
r_  generation:  0.0017080307006835938
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.00022673606872558594
mini_batch_src_global generation:  0.0001537799835205078
r_  generation:  0.0015845298767089844
local_output_nid generation:  9.441375732421875e-05
local_in_edges_tensor generation:  0.00024366378784179688
mini_batch_src_global generation:  0.00016498565673828125
r_  generation:  0.001819610595703125
local_output_nid generation:  8.392333984375e-05
local_in_edges_tensor generation:  0.0002334117889404297
mini_batch_src_global generation:  0.0001761913299560547
r_  generation:  0.0016779899597167969
local_output_nid generation:  8.416175842285156e-05
local_in_edges_tensor generation:  0.00023818016052246094
mini_batch_src_global generation:  0.00016355514526367188
r_  generation:  0.0017497539520263672
local_output_nid generation:  8.988380432128906e-05
local_in_edges_tensor generation:  0.0002529621124267578
mini_batch_src_global generation:  0.00019097328186035156
r_  generation:  0.001859426498413086
----------------------check_connections_block total spend ----------------------------- 0.02140355110168457
generate_one_block  0.0032396316528320312
generate_one_block  0.002924203872680664
generate_one_block  0.002840757369995117
generate_one_block  0.0026633739471435547
generate_one_block  0.0030596256256103516
generate_one_block  0.0027756690979003906
generate_one_block  0.0028591156005859375
generate_one_block  0.0030536651611328125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007610321044921875
gen group dst list time:  0.00034046173095703125
time for parepare:  0.0001876354217529297
local_output_nid generation:  0.00012731552124023438
local_in_edges_tensor generation:  0.000461578369140625
mini_batch_src_global generation:  0.0002472400665283203
r_  generation:  0.0027132034301757812
local_output_nid generation:  0.00012683868408203125
local_in_edges_tensor generation:  0.0003097057342529297
mini_batch_src_global generation:  0.00027823448181152344
r_  generation:  0.0024538040161132812
local_output_nid generation:  0.0001316070556640625
local_in_edges_tensor generation:  0.0003108978271484375
mini_batch_src_global generation:  0.0002357959747314453
r_  generation:  0.0025620460510253906
local_output_nid generation:  0.00012373924255371094
local_in_edges_tensor generation:  0.0002994537353515625
mini_batch_src_global generation:  0.00021409988403320312
r_  generation:  0.002437114715576172
local_output_nid generation:  0.00013017654418945312
local_in_edges_tensor generation:  0.00031256675720214844
mini_batch_src_global generation:  0.00022363662719726562
r_  generation:  0.0025815963745117188
local_output_nid generation:  0.00012969970703125
local_in_edges_tensor generation:  0.0003037452697753906
mini_batch_src_global generation:  0.0002205371856689453
r_  generation:  0.002536773681640625
local_output_nid generation:  0.0001430511474609375
local_in_edges_tensor generation:  0.00029921531677246094
mini_batch_src_global generation:  0.00021791458129882812
r_  generation:  0.0024940967559814453
local_output_nid generation:  0.0001304149627685547
local_in_edges_tensor generation:  0.0003058910369873047
mini_batch_src_global generation:  0.0002243518829345703
r_  generation:  0.0025789737701416016
----------------------check_connections_block total spend ----------------------------- 0.03071308135986328
generate_one_block  0.004277944564819336
generate_one_block  0.0043277740478515625
generate_one_block  0.0036673545837402344
generate_one_block  0.0040416717529296875
generate_one_block  0.0036377906799316406
generate_one_block  0.003581523895263672
generate_one_block  0.0036857128143310547
generate_one_block  0.003766298294067383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0638275146484375  GigaBytes
Max Memory Allocated: 0.0638275146484375  GigaBytes

connection checking time:  0.06655764579772949
block generation total time  0.07943224906921387
average batch blocks generation time:  0.009929031133651733
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07640743255615234  GigaBytes
Max Memory Allocated: 0.07640743255615234  GigaBytes

torch.Size([2333, 1433])
torch.Size([1920, 64])
torch.Size([1068, 64])
torch.Size([402, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.8305749893188477  GigaBytes
Max Memory Allocated: 0.8627066612243652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.1388378143310547  GigaBytes
Max Memory Allocated: 0.910670280456543  GigaBytes

torch.Size([2127, 1433])
torch.Size([1739, 64])
torch.Size([1007, 64])
torch.Size([368, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.8239216804504395  GigaBytes
Max Memory Allocated: 0.910670280456543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.13889694213867188  GigaBytes
Max Memory Allocated: 0.910670280456543  GigaBytes

torch.Size([2205, 1433])
torch.Size([1809, 64])
torch.Size([1084, 64])
torch.Size([449, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 0.8565058708190918  GigaBytes
Max Memory Allocated: 0.910670280456543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 0.13883590698242188  GigaBytes
Max Memory Allocated: 0.9339194297790527  GigaBytes

torch.Size([2169, 1433])
torch.Size([1694, 64])
torch.Size([984, 64])
torch.Size([388, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 0.8163590431213379  GigaBytes
Max Memory Allocated: 0.9339194297790527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 0.13885164260864258  GigaBytes
Max Memory Allocated: 0.9339194297790527  GigaBytes

torch.Size([2196, 1433])
torch.Size([1825, 64])
torch.Size([1147, 64])
torch.Size([462, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 0.8625087738037109  GigaBytes
Max Memory Allocated: 0.9339194297790527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 0.1388397216796875  GigaBytes
Max Memory Allocated: 0.9378352165222168  GigaBytes

torch.Size([2192, 1433])
torch.Size([1761, 64])
torch.Size([1056, 64])
torch.Size([392, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 0.837090015411377  GigaBytes
Max Memory Allocated: 0.9378352165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 0.1393418312072754  GigaBytes
Max Memory Allocated: 0.9378352165222168  GigaBytes

torch.Size([2288, 1433])
torch.Size([1849, 64])
torch.Size([1106, 64])
torch.Size([429, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3416748046875 GB
    Memory Allocated: 0.872593879699707  GigaBytes
Max Memory Allocated: 0.9378352165222168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3416748046875 GB
    Memory Allocated: 0.13916397094726562  GigaBytes
Max Memory Allocated: 0.9491729736328125  GigaBytes

torch.Size([2253, 1433])
torch.Size([1938, 64])
torch.Size([1250, 64])
torch.Size([477, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3416748046875 GB
    Memory Allocated: 0.8963394165039062  GigaBytes
Max Memory Allocated: 0.9491729736328125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06358391046524048 |0.04334405064582825 |0.2823443114757538 |0.00013703107833862305 |0.2965771555900574 |0.0168912410736084 |
----------------------------------------------------------pseudo_mini_loss sum 2.870405673980713
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  45126
Number of first layer input nodes during this epoch:  17763
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.26639556884765625  GigaBytes
Max Memory Allocated: 0.9684123992919922  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005705356597900391
random selection method range initialization spend 0.0001552104949951172
time for parepare:  7.796287536621094e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.198883056640625e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.00543212890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0020656585693359375
generate_one_block  0.001230478286743164
generate_one_block  0.0010819435119628906
generate_one_block  0.0010654926300048828
generate_one_block  0.0010859966278076172
generate_one_block  0.001108407974243164
generate_one_block  0.0010788440704345703
generate_one_block  0.0010833740234375
generate_one_block  0.0010657310485839844
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005605220794677734
gen group dst list time:  6.532669067382812e-05
time for parepare:  0.0001926422119140625
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00021195411682128906
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.0002167224884033203
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00018525123596191406
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0002079010009765625
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00028324127197265625
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00028443336486816406
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.00031638145446777344
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.00024175643920898438
----------------------check_connections_block total spend ----------------------------- 0.004499197006225586
generate_one_block  0.0013642311096191406
generate_one_block  0.0012829303741455078
generate_one_block  0.0013039112091064453
generate_one_block  0.00135040283203125
generate_one_block  0.0014328956604003906
generate_one_block  0.0014226436614990234
generate_one_block  0.001424551010131836
generate_one_block  0.0013413429260253906
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007276535034179688
gen group dst list time:  0.00011754035949707031
time for parepare:  0.00021910667419433594
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00027179718017578125
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0007116794586181641
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0006918907165527344
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0005936622619628906
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0006554126739501953
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.00010895729064941406
r_  generation:  0.0009045600891113281
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  0.00013589859008789062
r_  generation:  0.0010099411010742188
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.0010378360748291016
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  0.00011348724365234375
r_  generation:  0.0008218288421630859
----------------------check_connections_block total spend ----------------------------- 0.011439323425292969
generate_one_block  0.0019958019256591797
generate_one_block  0.001867532730102539
generate_one_block  0.0016944408416748047
generate_one_block  0.0017726421356201172
generate_one_block  0.002029895782470703
generate_one_block  0.002191781997680664
generate_one_block  0.002209901809692383
generate_one_block  0.0019524097442626953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007622241973876953
gen group dst list time:  0.0002193450927734375
time for parepare:  0.00019431114196777344
local_output_nid generation:  9.465217590332031e-05
local_in_edges_tensor generation:  0.0004220008850097656
mini_batch_src_global generation:  0.0002224445343017578
r_  generation:  0.0017502307891845703
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  0.00021004676818847656
r_  generation:  0.0017426013946533203
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.0015139579772949219
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  0.00018358230590820312
r_  generation:  0.0016334056854248047
local_output_nid generation:  0.00010228157043457031
local_in_edges_tensor generation:  0.0002532005310058594
mini_batch_src_global generation:  0.00017905235290527344
r_  generation:  0.0018947124481201172
local_output_nid generation:  0.00013518333435058594
local_in_edges_tensor generation:  0.0004858970642089844
mini_batch_src_global generation:  0.00023055076599121094
r_  generation:  0.0022077560424804688
local_output_nid generation:  0.00011682510375976562
local_in_edges_tensor generation:  0.0002846717834472656
mini_batch_src_global generation:  0.00020051002502441406
r_  generation:  0.0021276473999023438
local_output_nid generation:  9.751319885253906e-05
local_in_edges_tensor generation:  0.00025844573974609375
mini_batch_src_global generation:  0.00018143653869628906
r_  generation:  0.0016756057739257812
----------------------check_connections_block total spend ----------------------------- 0.023218631744384766
generate_one_block  0.003266572952270508
generate_one_block  0.0030248165130615234
generate_one_block  0.002716541290283203
generate_one_block  0.0028505325317382812
generate_one_block  0.0030918121337890625
generate_one_block  0.0034227371215820312
generate_one_block  0.003351926803588867
generate_one_block  0.0029387474060058594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007843971252441406
gen group dst list time:  0.00035190582275390625
time for parepare:  0.00020456314086914062
local_output_nid generation:  0.00014972686767578125
local_in_edges_tensor generation:  0.0004935264587402344
mini_batch_src_global generation:  0.0002300739288330078
r_  generation:  0.002663850784301758
local_output_nid generation:  0.00015473365783691406
local_in_edges_tensor generation:  0.00033593177795410156
mini_batch_src_global generation:  0.00026416778564453125
r_  generation:  0.002661466598510742
local_output_nid generation:  0.0001475811004638672
local_in_edges_tensor generation:  0.00032806396484375
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.002584218978881836
local_output_nid generation:  0.0001468658447265625
local_in_edges_tensor generation:  0.00031280517578125
mini_batch_src_global generation:  0.0002219676971435547
r_  generation:  0.002543926239013672
local_output_nid generation:  0.00015783309936523438
local_in_edges_tensor generation:  0.0003261566162109375
mini_batch_src_global generation:  0.00022673606872558594
r_  generation:  0.0027234554290771484
local_output_nid generation:  0.00017523765563964844
local_in_edges_tensor generation:  0.0003414154052734375
mini_batch_src_global generation:  0.0002472400665283203
r_  generation:  0.0028922557830810547
local_output_nid generation:  0.00017714500427246094
local_in_edges_tensor generation:  0.00033855438232421875
mini_batch_src_global generation:  0.0002512931823730469
r_  generation:  0.002727508544921875
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.0003018379211425781
mini_batch_src_global generation:  0.00022220611572265625
r_  generation:  0.002488851547241211
----------------------check_connections_block total spend ----------------------------- 0.03225445747375488
generate_one_block  0.004183769226074219
generate_one_block  0.004038810729980469
generate_one_block  0.0037665367126464844
generate_one_block  0.003723621368408203
generate_one_block  0.004261493682861328
generate_one_block  0.004474163055419922
generate_one_block  0.00412297248840332
generate_one_block  0.0038657188415527344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.26639556884765625  GigaBytes
Max Memory Allocated: 0.9684123992919922  GigaBytes

connection checking time:  0.0714116096496582
block generation total time  0.08373808860778809
average batch blocks generation time:  0.01046726107597351
block dataloader generation time/epoch 0.2321469783782959
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.2659015655517578  GigaBytes
Max Memory Allocated: 0.9684123992919922  GigaBytes

torch.Size([2208, 1433])
torch.Size([1815, 64])
torch.Size([1042, 64])
torch.Size([398, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.9765958786010742  GigaBytes
Max Memory Allocated: 1.005681037902832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.2658567428588867  GigaBytes
Max Memory Allocated: 1.055492877960205  GigaBytes

torch.Size([2200, 1433])
torch.Size([1797, 64])
torch.Size([994, 64])
torch.Size([360, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.9728813171386719  GigaBytes
Max Memory Allocated: 1.055492877960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.2658224105834961  GigaBytes
Max Memory Allocated: 1.055492877960205  GigaBytes

torch.Size([2179, 1433])
torch.Size([1715, 64])
torch.Size([900, 64])
torch.Size([321, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.9508156776428223  GigaBytes
Max Memory Allocated: 1.055492877960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.2658271789550781  GigaBytes
Max Memory Allocated: 1.055492877960205  GigaBytes

torch.Size([2118, 1433])
torch.Size([1676, 64])
torch.Size([949, 64])
torch.Size([316, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.9455599784851074  GigaBytes
Max Memory Allocated: 1.055492877960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.26604557037353516  GigaBytes
Max Memory Allocated: 1.055492877960205  GigaBytes

torch.Size([2233, 1433])
torch.Size([1845, 64])
torch.Size([1143, 64])
torch.Size([469, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.9899368286132812  GigaBytes
Max Memory Allocated: 1.055492877960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.26665401458740234  GigaBytes
Max Memory Allocated: 1.063673973083496  GigaBytes

torch.Size([2344, 1433])
torch.Size([2039, 64])
torch.Size([1368, 64])
torch.Size([558, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4588623046875 GB
    Memory Allocated: 1.065075397491455  GigaBytes
Max Memory Allocated: 1.090336799621582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4588623046875 GB
    Memory Allocated: 0.2665262222290039  GigaBytes
Max Memory Allocated: 1.1312036514282227  GigaBytes

torch.Size([2320, 1433])
torch.Size([2028, 64])
torch.Size([1332, 64])
torch.Size([595, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4608154296875 GB
    Memory Allocated: 1.0553650856018066  GigaBytes
Max Memory Allocated: 1.1312036514282227  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4608154296875 GB
    Memory Allocated: 0.26618289947509766  GigaBytes
Max Memory Allocated: 1.1312036514282227  GigaBytes

torch.Size([2260, 1433])
torch.Size([1808, 64])
torch.Size([1082, 64])
torch.Size([443, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4608154296875 GB
    Memory Allocated: 0.9805417060852051  GigaBytes
Max Memory Allocated: 1.1312036514282227  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061069875955581665 |0.0009019076824188232 |0.21927008032798767 |0.00012412667274475098 |0.2978440523147583 |0.01654505729675293 |
----------------------------------------------------------pseudo_mini_loss sum 2.3844244480133057
Total (block generation + training)time/epoch 4.951208114624023
Training time/epoch 4.718694686889648
Training time without block to device /epoch 4.711479425430298
Training time without total dataloading part /epoch 4.154451131820679
load block tensor time/epoch 0.4885590076446533
block to device time/epoch 0.007215261459350586
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  45614
Number of first layer input nodes during this epoch:  17862
