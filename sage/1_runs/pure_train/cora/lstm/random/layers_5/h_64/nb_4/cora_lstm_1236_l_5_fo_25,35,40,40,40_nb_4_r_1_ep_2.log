main start at this time 1648432539.7694664
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0638275146484375  GigaBytes
Max Memory Allocated: 0.0638275146484375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012025833129882812
random selection method range initialization spend 0.00020575523376464844
time for parepare:  6.723403930664062e-05
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0024509429931640625
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  6.580352783203125e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.390975952148438e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  8.177757263183594e-05
----------------------check_connections_block total spend ----------------------------- 0.0037784576416015625
generate_one_block  0.0015227794647216797
generate_one_block  0.0011115074157714844
generate_one_block  0.0011098384857177734
generate_one_block  0.0011098384857177734
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005085468292236328
gen group dst list time:  4.0531158447265625e-05
time for parepare:  0.00014257431030273438
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.000362396240234375
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.000377655029296875
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0004291534423828125
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004904270172119141
----------------------check_connections_block total spend ----------------------------- 0.003215312957763672
generate_one_block  0.0014715194702148438
generate_one_block  0.0014605522155761719
generate_one_block  0.001508474349975586
generate_one_block  0.001641988754272461
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005965232849121094
gen group dst list time:  7.677078247070312e-05
time for parepare:  0.0001785755157470703
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.0002777576446533203
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.0011987686157226562
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.0011813640594482422
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  0.0001251697540283203
r_  generation:  0.0012700557708740234
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  0.00013756752014160156
r_  generation:  0.0013804435729980469
----------------------check_connections_block total spend ----------------------------- 0.008092164993286133
generate_one_block  0.0024285316467285156
generate_one_block  0.0023925304412841797
generate_one_block  0.0024607181549072266
generate_one_block  0.0024013519287109375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007228851318359375
gen group dst list time:  0.0001347064971923828
time for parepare:  0.00020122528076171875
local_output_nid generation:  0.00010132789611816406
local_in_edges_tensor generation:  0.0003781318664550781
mini_batch_src_global generation:  0.0001735687255859375
r_  generation:  0.002365589141845703
local_output_nid generation:  0.00010561943054199219
local_in_edges_tensor generation:  0.0002834796905517578
mini_batch_src_global generation:  0.0002703666687011719
r_  generation:  0.002255678176879883
local_output_nid generation:  0.00011038780212402344
local_in_edges_tensor generation:  0.0002830028533935547
mini_batch_src_global generation:  0.0002129077911376953
r_  generation:  0.0023353099822998047
local_output_nid generation:  0.00011324882507324219
local_in_edges_tensor generation:  0.00029277801513671875
mini_batch_src_global generation:  0.00020933151245117188
r_  generation:  0.002507925033569336
----------------------check_connections_block total spend ----------------------------- 0.01446390151977539
generate_one_block  0.003596067428588867
generate_one_block  0.003275632858276367
generate_one_block  0.0034856796264648438
generate_one_block  0.0034279823303222656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007872581481933594
gen group dst list time:  0.00018858909606933594
time for parepare:  0.00019121170043945312
local_output_nid generation:  0.00014591217041015625
local_in_edges_tensor generation:  0.0004622936248779297
mini_batch_src_global generation:  0.0002048015594482422
r_  generation:  0.0030913352966308594
local_output_nid generation:  0.0001513957977294922
local_in_edges_tensor generation:  0.0003402233123779297
mini_batch_src_global generation:  0.0003066062927246094
r_  generation:  0.0029218196868896484
local_output_nid generation:  0.00015115737915039062
local_in_edges_tensor generation:  0.00035452842712402344
mini_batch_src_global generation:  0.0002682209014892578
r_  generation:  0.0030090808868408203
local_output_nid generation:  0.0001614093780517578
local_in_edges_tensor generation:  0.0003504753112792969
mini_batch_src_global generation:  0.00025272369384765625
r_  generation:  0.0031020641326904297
----------------------check_connections_block total spend ----------------------------- 0.01824355125427246
generate_one_block  0.004898548126220703
generate_one_block  0.0038764476776123047
generate_one_block  0.0039064884185791016
generate_one_block  0.004030942916870117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0638275146484375  GigaBytes
Max Memory Allocated: 0.0638275146484375  GigaBytes

connection checking time:  0.044014930725097656
block generation total time  0.04626345634460449
average batch blocks generation time:  0.011565864086151123
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07765817642211914  GigaBytes
Max Memory Allocated: 0.07765817642211914  GigaBytes

torch.Size([2389, 1433])
torch.Size([2169, 64])
torch.Size([1506, 64])
torch.Size([678, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.9065399169921875  GigaBytes
Max Memory Allocated: 0.9295978546142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.13946962356567383  GigaBytes
Max Memory Allocated: 0.9694433212280273  GigaBytes

torch.Size([2307, 1433])
torch.Size([2035, 64])
torch.Size([1442, 64])
torch.Size([658, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.9308204650878906  GigaBytes
Max Memory Allocated: 0.9694433212280273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.13968896865844727  GigaBytes
Max Memory Allocated: 0.9949917793273926  GigaBytes

torch.Size([2347, 1433])
torch.Size([2099, 64])
torch.Size([1505, 64])
torch.Size([728, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 0.9504704475402832  GigaBytes
Max Memory Allocated: 0.9949917793273926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 0.14003467559814453  GigaBytes
Max Memory Allocated: 1.0112853050231934  GigaBytes

torch.Size([2410, 1433])
torch.Size([2155, 64])
torch.Size([1592, 64])
torch.Size([782, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.9735260009765625  GigaBytes
Max Memory Allocated: 1.0112853050231934  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05938035249710083 |0.08577543497085571 |0.3601139783859253 |0.0001608729362487793 |0.3998938798904419 |0.013498306274414062 |
----------------------------------------------------------pseudo_mini_loss sum 2.783217430114746
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27539
Number of first layer input nodes during this epoch:  9453
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4862060546875 GB
    Memory Allocated: 0.2673330307006836  GigaBytes
Max Memory Allocated: 1.0307679176330566  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005927085876464844
random selection method range initialization spend 0.00015997886657714844
time for parepare:  9.918212890625e-05
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  9.083747863769531e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  7.557868957519531e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  8.940696716308594e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  6.914138793945312e-05
----------------------check_connections_block total spend ----------------------------- 0.0014197826385498047
generate_one_block  0.0012645721435546875
generate_one_block  0.0011699199676513672
generate_one_block  0.0012001991271972656
generate_one_block  0.0012121200561523438
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005249977111816406
gen group dst list time:  5.269050598144531e-05
time for parepare:  0.0001811981201171875
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0003459453582763672
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.00036334991455078125
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.00048613548278808594
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  7.748603820800781e-05
r_  generation:  0.0004918575286865234
----------------------check_connections_block total spend ----------------------------- 0.003495931625366211
generate_one_block  0.0017518997192382812
generate_one_block  0.0015330314636230469
generate_one_block  0.0017032623291015625
generate_one_block  0.0017061233520507812
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005865097045898438
gen group dst list time:  8.535385131835938e-05
time for parepare:  0.00019931793212890625
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.0003337860107421875
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.0010747909545898438
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0011205673217773438
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  0.0001690387725830078
r_  generation:  0.0014045238494873047
local_output_nid generation:  7.343292236328125e-05
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  0.0001666545867919922
r_  generation:  0.0014679431915283203
----------------------check_connections_block total spend ----------------------------- 0.008489131927490234
generate_one_block  0.002429485321044922
generate_one_block  0.002439260482788086
generate_one_block  0.0026276111602783203
generate_one_block  0.002627134323120117
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000766754150390625
gen group dst list time:  0.00014281272888183594
time for parepare:  0.0001976490020751953
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.0003871917724609375
mini_batch_src_global generation:  0.00020623207092285156
r_  generation:  0.0021677017211914062
local_output_nid generation:  0.00012493133544921875
local_in_edges_tensor generation:  0.0002913475036621094
mini_batch_src_global generation:  0.00023937225341796875
r_  generation:  0.0022988319396972656
local_output_nid generation:  0.00013303756713867188
local_in_edges_tensor generation:  0.000301361083984375
mini_batch_src_global generation:  0.00023746490478515625
r_  generation:  0.002501964569091797
local_output_nid generation:  0.00013375282287597656
local_in_edges_tensor generation:  0.00030517578125
mini_batch_src_global generation:  0.00023484230041503906
r_  generation:  0.002550840377807617
----------------------check_connections_block total spend ----------------------------- 0.014705896377563477
generate_one_block  0.0035486221313476562
generate_one_block  0.003685474395751953
generate_one_block  0.003638029098510742
generate_one_block  0.003679037094116211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008437633514404297
gen group dst list time:  0.0001990795135498047
time for parepare:  0.00020503997802734375
local_output_nid generation:  0.000164031982421875
local_in_edges_tensor generation:  0.0004849433898925781
mini_batch_src_global generation:  0.0002579689025878906
r_  generation:  0.002923727035522461
local_output_nid generation:  0.0001652240753173828
local_in_edges_tensor generation:  0.0003552436828613281
mini_batch_src_global generation:  0.00033545494079589844
r_  generation:  0.002996206283569336
local_output_nid generation:  0.0001723766326904297
local_in_edges_tensor generation:  0.0003662109375
mini_batch_src_global generation:  0.00025272369384765625
r_  generation:  0.003114938735961914
local_output_nid generation:  0.00017976760864257812
local_in_edges_tensor generation:  0.0003592967987060547
mini_batch_src_global generation:  0.0002613067626953125Using backend: pytorch

r_  generation:  0.003173828125
----------------------check_connections_block total spend ----------------------------- 0.01862788200378418
generate_one_block  0.004258632659912109
generate_one_block  0.004293203353881836
generate_one_block  0.004189014434814453
generate_one_block  0.004185914993286133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4862060546875 GB
    Memory Allocated: 0.2673330307006836  GigaBytes
Max Memory Allocated: 1.0307679176330566  GigaBytes

connection checking time:  0.0453188419342041
block generation total time  0.04829573631286621
average batch blocks generation time:  0.012073934078216553
block dataloader generation time/epoch 0.15462279319763184
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4862060546875 GB
    Memory Allocated: 0.26618099212646484  GigaBytes
Max Memory Allocated: 1.0307679176330566  GigaBytes

torch.Size([2256, 1433])
torch.Size([1993, 64])
torch.Size([1338, 64])
torch.Size([601, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4862060546875 GB
    Memory Allocated: 1.032177448272705  GigaBytes
Max Memory Allocated: 1.0544910430908203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4862060546875 GB
    Memory Allocated: 0.26653051376342773  GigaBytes
Max Memory Allocated: 1.1002836227416992  GigaBytes

torch.Size([2320, 1433])
torch.Size([2054, 64])
torch.Size([1426, 64])
torch.Size([585, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4862060546875 GB
    Memory Allocated: 1.0716214179992676  GigaBytes
Max Memory Allocated: 1.1002836227416992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4862060546875 GB
    Memory Allocated: 0.26783227920532227  GigaBytes
Max Memory Allocated: 1.1371431350708008  GigaBytes

torch.Size([2384, 1433])
torch.Size([2130, 64])
torch.Size([1571, 64])
torch.Size([758, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4862060546875 GB
    Memory Allocated: 1.095167636871338  GigaBytes
Max Memory Allocated: 1.1371431350708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 0.2668485641479492  GigaBytes
Max Memory Allocated: 1.152693748474121  GigaBytes

torch.Size([2376, 1433])
torch.Size([2173, 64])
torch.Size([1627, 64])
torch.Size([839, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.0942277908325195  GigaBytes
Max Memory Allocated: 1.152693748474121  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05386728048324585 |0.0008417963981628418 |0.24208098649978638 |0.000125885009765625 |0.395216166973114 |0.013954877853393555 |
----------------------------------------------------------pseudo_mini_loss sum 2.276747226715088
Total (block generation + training)time/epoch 3.0045559406280518
Training time/epoch 2.8495771884918213
Training time without block to device /epoch 2.84621000289917
Training time without total dataloading part /epoch 2.5636470317840576
load block tensor time/epoch 0.2154691219329834
block to device time/epoch 0.003367185592651367
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27155
Number of first layer input nodes during this epoch:  9336
