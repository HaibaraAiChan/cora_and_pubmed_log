main start at this time 1648433527.075213
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06277799606323242  GigaBytes
Max Memory Allocated: 0.06277799606323242  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0014803409576416016
random selection method range initialization spend 0.0001697540283203125
time for parepare:  5.9604644775390625e-05
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.002463102340698242
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.4318695068359375e-05
----------------------check_connections_block total spend ----------------------------- 0.004256486892700195
generate_one_block  0.0013194084167480469
generate_one_block  0.0009968280792236328
generate_one_block  0.0009930133819580078
generate_one_block  0.000986337661743164
generate_one_block  0.0009624958038330078
generate_one_block  0.0009634494781494141
generate_one_block  0.0010046958923339844
generate_one_block  0.0009462833404541016
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004687309265136719
gen group dst list time:  6.175041198730469e-05
time for parepare:  0.00016450881958007812
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00021839141845703125
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00022935867309570312
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00025582313537597656
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0002541542053222656
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00020503997802734375
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00018215179443359375
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0001990795135498047
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00013256072998046875
----------------------check_connections_block total spend ----------------------------- 0.003758668899536133
generate_one_block  0.0012080669403076172
generate_one_block  0.0011980533599853516
generate_one_block  0.0012404918670654297
generate_one_block  0.0012352466583251953
generate_one_block  0.0011985301971435547
generate_one_block  0.0012280941009521484
generate_one_block  0.0011703968048095703
generate_one_block  0.0010955333709716797
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005996227264404297
gen group dst list time:  9.226799011230469e-05
time for parepare:  0.00016188621520996094
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00022745132446289062
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.00064849853515625
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0006773471832275391
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0008563995361328125
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  9.72747802734375e-05
r_  generation:  0.0008523464202880859
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.0007774829864501953
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0006649494171142578
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0006983280181884766
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0004909038543701172
----------------------check_connections_block total spend ----------------------------- 0.009697914123535156
generate_one_block  0.0018777847290039062
generate_one_block  0.001771688461303711
generate_one_block  0.0019049644470214844
generate_one_block  0.001974821090698242
generate_one_block  0.0018889904022216797
generate_one_block  0.0016772747039794922
generate_one_block  0.0017883777618408203
generate_one_block  0.0015065670013427734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007290840148925781
gen group dst list time:  0.00017642974853515625
time for parepare:  0.0001785755157470703
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.0003819465637207031
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0016133785247802734
local_output_nid generation:  8.153915405273438e-05
local_in_edges_tensor generation:  0.00022673606872558594
mini_batch_src_global generation:  0.000202178955078125
r_  generation:  0.001718759536743164
local_output_nid generation:  9.107589721679688e-05
local_in_edges_tensor generation:  0.0002391338348388672
mini_batch_src_global generation:  0.00017523765563964844
r_  generation:  0.0016856193542480469
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.00023126602172851562
mini_batch_src_global generation:  0.00018787384033203125
r_  generation:  0.0017571449279785156
local_output_nid generation:  8.463859558105469e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  0.00017189979553222656
r_  generation:  0.0018432140350341797
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00022721290588378906
mini_batch_src_global generation:  0.00014781951904296875
r_  generation:  0.0014781951904296875
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.00022482872009277344
mini_batch_src_global generation:  0.0001571178436279297
r_  generation:  0.0017762184143066406
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  0.0001354217529296875
r_  generation:  0.001276254653930664
----------------------check_connections_block total spend ----------------------------- 0.020328521728515625
generate_one_block  0.00289154052734375
generate_one_block  0.0028421878814697266
generate_one_block  0.0030198097229003906
generate_one_block  0.0029027462005615234
generate_one_block  0.002966165542602539
generate_one_block  0.0026712417602539062
generate_one_block  0.0029489994049072266
generate_one_block  0.0024306774139404297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007464885711669922
gen group dst list time:  0.00031113624572753906
time for parepare:  0.0001747608184814453
local_output_nid generation:  0.00011801719665527344
local_in_edges_tensor generation:  0.0004487037658691406
mini_batch_src_global generation:  0.000225067138671875
r_  generation:  0.0024547576904296875
local_output_nid generation:  0.00012731552124023438
local_in_edges_tensor generation:  0.00030040740966796875
mini_batch_src_global generation:  0.00027823448181152344
r_  generation:  0.0024602413177490234
local_output_nid generation:  0.0001239776611328125
local_in_edges_tensor generation:  0.0002968311309814453
mini_batch_src_global generation:  0.00021028518676757812
r_  generation:  0.0024251937866210938
local_output_nid generation:  0.0001323223114013672
local_in_edges_tensor generation:  0.00030517578125
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.002539396286010742
local_output_nid generation:  0.00012922286987304688
local_in_edges_tensor generation:  0.0003077983856201172
mini_batch_src_global generation:  0.00022101402282714844
r_  generation:  0.0025424957275390625
local_output_nid generation:  0.00012803077697753906
local_in_edges_tensor generation:  0.00028896331787109375
mini_batch_src_global generation:  0.00020623207092285156
r_  generation:  0.0023109912872314453
local_output_nid generation:  0.0001316070556640625
local_in_edges_tensor generation:  0.0003077983856201172
mini_batch_src_global generation:  0.00022983551025390625
r_  generation:  0.002580404281616211
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.0002770423889160156
mini_batch_src_global generation:  0.0002048015594482422
r_  generation:  0.002221822738647461
----------------------check_connections_block total spend ----------------------------- 0.0296173095703125
generate_one_block  0.004465341567993164
generate_one_block  0.004169464111328125
generate_one_block  0.0036284923553466797
generate_one_block  0.0038514137268066406
generate_one_block  0.004560947418212891
generate_one_block  0.0035445690155029297
generate_one_block  0.0037751197814941406
generate_one_block  0.0034410953521728516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007786750793457031
gen group dst list time:  0.00043487548828125
time for parepare:  0.00017499923706054688
local_output_nid generation:  0.00014257431030273438
local_in_edges_tensor generation:  0.00048804283142089844
mini_batch_src_global generation:  0.00024437904357910156
r_  generation:  0.002841949462890625
local_output_nid generation:  0.00015091896057128906
local_in_edges_tensor generation:  0.0003323554992675781
mini_batch_src_global generation:  0.00029277801513671875
r_  generation:  0.002824544906616211
local_output_nid generation:  0.00014638900756835938
local_in_edges_tensor generation:  0.0003235340118408203
mini_batch_src_global generation:  0.00024199485778808594
r_  generation:  0.002773761749267578
local_output_nid generation:  0.00015664100646972656
local_in_edges_tensor generation:  0.00033664703369140625
mini_batch_src_global generation:  0.00023937225341796875
r_  generation:  0.0029151439666748047
local_output_nid generation:  0.00015234947204589844
local_in_edges_tensor generation:  0.00033164024353027344
mini_batch_src_global generation:  0.0002434253692626953
r_  generation:  0.0029664039611816406
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.0003228187561035156
mini_batch_src_global generation:  0.00023627281188964844
r_  generation:  0.002873659133911133
local_output_nid generation:  0.0001552104949951172
local_in_edges_tensor generation:  0.00033926963806152344
mini_batch_src_global generation:  0.0002460479736328125
r_  generation:  0.0029544830322265625
local_output_nid generation:  0.000148773193359375
local_in_edges_tensor generation:  0.0003197193145751953
mini_batch_src_global generation:  0.00023984909057617188
r_  generation:  0.0027589797973632812
----------------------check_connections_block total spend ----------------------------- 0.03409171104431152
generate_one_block  0.005142927169799805
generate_one_block  0.004019498825073242
generate_one_block  0.00392460823059082
generate_one_block  0.004075050354003906
generate_one_block  0.0040416717529296875
generate_one_block  0.003969430923461914
generate_one_block  0.004144906997680664
generate_one_block  0.004133939743041992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06277799606323242  GigaBytes
Max Memory Allocated: 0.06277799606323242  GigaBytes

connection checking time:  0.09749412536621094
block generation total time  0.1115267276763916
average batch blocks generation time:  0.01394084095954895
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07664203643798828  GigaBytes
Max Memory Allocated: 0.07664203643798828  GigaBytes

torch.Size([2402, 1433])
torch.Size([2207, 16])
torch.Size([1814, 16])
torch.Size([1040, 16])
torch.Size([392, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.8810186386108398  GigaBytes
Max Memory Allocated: 0.9354405403137207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2401123046875 GB
    Memory Allocated: 0.13769149780273438  GigaBytes
Max Memory Allocated: 0.9732875823974609  GigaBytes

torch.Size([2360, 1433])
torch.Size([2204, 16])
torch.Size([1825, 16])
torch.Size([1097, 16])
torch.Size([385, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.9390110969543457  GigaBytes
Max Memory Allocated: 0.9923272132873535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.13753557205200195  GigaBytes
Max Memory Allocated: 1.0306854248046875  GigaBytes

torch.Size([2330, 1433])
torch.Size([2159, 16])
torch.Size([1796, 16])
torch.Size([1128, 16])
torch.Size([481, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.9261531829833984  GigaBytes
Max Memory Allocated: 1.0306854248046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.13877534866333008  GigaBytes
Max Memory Allocated: 1.0306854248046875  GigaBytes

torch.Size([2422, 1433])
torch.Size([2295, 16])
torch.Size([1881, 16])
torch.Size([1164, 16])
torch.Size([475, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3729248046875 GB
    Memory Allocated: 0.9725298881530762  GigaBytes
Max Memory Allocated: 1.0306854248046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3729248046875 GB
    Memory Allocated: 0.13877344131469727  GigaBytes
Max Memory Allocated: 1.062093734741211  GigaBytes

torch.Size([2392, 1433])
torch.Size([2247, 16])
torch.Size([1891, 16])
torch.Size([1179, 16])
torch.Size([454, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3748779296875 GB
    Memory Allocated: 0.9525794982910156  GigaBytes
Max Memory Allocated: 1.062093734741211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3748779296875 GB
    Memory Allocated: 0.13771343231201172  GigaBytes
Max Memory Allocated: 1.062093734741211  GigaBytes

torch.Size([2366, 1433])
torch.Size([2164, 16])
torch.Size([1693, 16])
torch.Size([972, 16])
torch.Size([370, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3748779296875 GB
    Memory Allocated: 0.9258527755737305  GigaBytes
Max Memory Allocated: 1.062093734741211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3748779296875 GB
    Memory Allocated: 0.13877153396606445  GigaBytes
Max Memory Allocated: 1.062093734741211  GigaBytes

torch.Size([2448, 1433])
torch.Size([2317, 16])
torch.Size([1918, 16])
torch.Size([1108, 16])
torch.Size([410, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3748779296875 GB
    Memory Allocated: 0.9826440811157227  GigaBytes
Max Memory Allocated: 1.062093734741211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3748779296875 GB
    Memory Allocated: 0.13776397705078125  GigaBytes
Max Memory Allocated: 1.0726571083068848  GigaBytes

torch.Size([2378, 1433])
torch.Size([2129, 16])
torch.Size([1604, 16])
torch.Size([822, 16])
torch.Size([286, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3748779296875 GB
    Memory Allocated: 0.9251947402954102  GigaBytes
Max Memory Allocated: 1.0726571083068848  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06353062391281128 |0.044205665588378906 |0.3437763750553131 |0.00015154480934143066 |0.3714326024055481 |0.021259784698486328 |
----------------------------------------------------------pseudo_mini_loss sum 2.543490171432495
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  63761
Number of first layer input nodes during this epoch:  19098
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 0.26296520233154297  GigaBytes
Max Memory Allocated: 1.0726571083068848  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006010532379150391
random selection method range initialization spend 0.000152587890625
time for parepare:  8.654594421386719e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.839897155761719e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.267692565917969e-05
----------------------check_connections_block total spend ----------------------------- 0.002007007598876953
generate_one_block  0.0012159347534179688
generate_one_block  0.001039743423461914
generate_one_block  0.0010390281677246094
generate_one_block  0.0010323524475097656
generate_one_block  0.0010497570037841797
generate_one_block  0.0010585784912109375
generate_one_block  0.0010411739349365234
generate_one_block  0.001033782958984375
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005247592926025391
gen group dst list time:  6.175041198730469e-05
time for parepare:  0.00019288063049316406
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0002472400665283203
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00017213821411132812
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002105236053466797
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00022864341735839844
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0002300739288330078
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00029349327087402344
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0002579689025878906
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.00026035308837890625
----------------------check_connections_block total spend ----------------------------- 0.004446983337402344
generate_one_block  0.0015125274658203125
generate_one_block  0.0012142658233642578
generate_one_block  0.0012700557708740234
generate_one_block  0.0012996196746826172
generate_one_block  0.0012919902801513672
generate_one_block  0.0013599395751953125
generate_one_block  0.0012841224670410156
generate_one_block  0.0012698173522949219
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007472038269042969
gen group dst list time:  0.0001163482666015625
time for parepare:  0.0002186298370361328
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.00034499168395996094
mini_batch_src_global generation:  0.0001220703125
r_  generation:  0.0007457733154296875
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  0.000110626220703125
r_  generation:  0.0006313323974609375
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0007233619689941406
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.00011181831359863281
r_  generation:  0.000766754150390625
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0007476806640625
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  0.00012803077697753906
r_  generation:  0.0009005069732666016
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  0.00011301040649414062
r_  generation:  0.0008101463317871094
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0007498264312744141
----------------------check_connections_block total spend ----------------------------- 0.010973930358886719
generate_one_block  0.002042055130004883
generate_one_block  0.0017926692962646484
generate_one_block  0.0019600391387939453
generate_one_block  0.0019898414611816406
generate_one_block  0.0019571781158447266
generate_one_block  0.002268075942993164
generate_one_block  0.0020101070404052734
generate_one_block  0.0019769668579101562
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007612705230712891
gen group dst list time:  0.00020933151245117188
time for parepare:  0.0002040863037109375
local_output_nid generation:  9.5367431640625e-05
local_in_edges_tensor generation:  0.00037479400634765625
mini_batch_src_global generation:  0.00019598007202148438
r_  generation:  0.0016293525695800781
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  0.00019860267639160156
r_  generation:  0.0015256404876708984
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.00025200843811035156
mini_batch_src_global generation:  0.00017881393432617188
r_  generation:  0.0016825199127197266
local_output_nid generation:  9.703636169433594e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.00018167495727539062
r_  generation:  0.001852273941040039
local_output_nid generation:  9.894371032714844e-05
local_in_edges_tensor generation:  0.00025177001953125
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.001806020736694336
local_output_nid generation:  0.00011801719665527344
local_in_edges_tensor generation:  0.0002715587615966797
mini_batch_src_global generation:  0.0002002716064453125
r_  generation:  0.0019023418426513672
local_output_nid generation:  9.72747802734375e-05
local_in_edges_tensor generation:  0.0002415180206298828
mini_batch_src_global generation:  0.00019693374633789062
r_  generation:  0.0018048286437988281
local_output_nid generation:  9.775161743164062e-05
local_in_edges_tensor generation:  0.00024628639221191406
mini_batch_src_global generation:  0.00016832351684570312
r_  generation:  0.0018379688262939453
----------------------check_connections_block total spend ----------------------------- 0.022188901901245117
generate_one_block  0.003107309341430664
generate_one_block  0.002862215042114258
generate_one_block  0.003091096878051758
generate_one_block  0.0031790733337402344
generate_one_block  0.0031135082244873047
generate_one_block  0.003267049789428711
generate_one_block  0.0031037330627441406
generate_one_block  0.0031266212463378906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007982254028320312
gen group dst list time:  0.00036072731018066406
time for parepare:  0.00020194053649902344
local_output_nid generation:  0.000171661376953125
local_in_edges_tensor generation:  0.0005009174346923828
mini_batch_src_global generation:  0.00023603439331054688
r_  generation:  0.002492189407348633
local_output_nid generation:  0.00014400482177734375
local_in_edges_tensor generation:  0.0003180503845214844
mini_batch_src_global generation:  0.0002651214599609375
r_  generation:  0.0023126602172851562
local_output_nid generation:  0.00015592575073242188
local_in_edges_tensor generation:  0.0003123283386230469
mini_batch_src_global generation:  0.0002300739288330078
r_  generation:  0.00254058837890625
local_output_nid generation:  0.00016927719116210938
local_in_edges_tensor generation:  0.0003285408020019531
mini_batch_src_global generation:  0.00023365020751953125
r_  generation:  0.002728700637817383
local_output_nid generation:  0.00015425682067871094
local_in_edges_tensor generation:  0.00030994415283203125
mini_batch_src_global generation:  0.0002281665802001953
r_  generation:  0.0025482177734375
local_output_nid generation:  0.0001621246337890625
local_in_edges_tensor generation:  0.00031828880310058594
mini_batch_src_global generation:  0.00023365020751953125
r_  generation:  0.0026535987854003906
local_output_nid generation:  0.0001742839813232422
local_in_edges_tensor generation:  0.00032782554626464844
mini_batch_src_global generation:  0.0002493858337402344
r_  generation:  0.002629995346069336
local_output_nid generation:  0.00015616416931152344
local_in_edges_tensor generation:  0.0003132820129394531
mini_batch_src_global generation:  0.0002315044403076172
r_  generation:  0.0026390552520751953
----------------------check_connections_block total spend ----------------------------- 0.03147459030151367
generate_one_block  0.004042148590087891
generate_one_block  0.004015684127807617
generate_one_block  0.00391387939453125
generate_one_block  0.004447460174560547
generate_one_block  0.003952980041503906
generate_one_block  0.004029035568237305
generate_one_block  0.003989696502685547
generate_one_block  0.004007816314697266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008394718170166016
gen group dst list time:  0.00041294097900390625
time for parepare:  0.0002071857452392578
local_output_nid generation:  0.00019288063049316406
local_in_edges_tensor generation:  0.0005042552947998047
mini_batch_src_global generation:  0.0002117156982421875
r_  generation:  0.0029277801513671875
local_output_nid generation:  0.0001881122589111328
local_in_edges_tensor generation:  0.00035953521728515625
mini_batch_src_global generation:  0.00030493736267089844
r_  generation:  0.0028264522552490234
local_output_nid generation:  0.0001857280731201172
local_in_edges_tensor generation:  0.0003535747528076172
mini_batch_src_global generation:  0.0002472400665283203
r_  generation:  0.0029108524322509766
local_output_nid generation:  0.00019502639770507812
local_in_edges_tensor generation:  0.0003628730773925781
mini_batch_src_global generation:  0.00025916099548339844
r_  generation:  0.0030264854431152344
local_output_nid generation:  0.00018858909606933594
local_in_edges_tensor generation:  0.0003466606140136719
mini_batch_src_global generation:  0.00029468536376953125
r_  generation:  0.002885580062866211
local_output_nid generation:  0.0001900196075439453
local_in_edges_tensor generation:  0.0003504753112792969
mini_batch_src_global generation:  0.00024700164794921875
r_  generation:  0.0029518604278564453
local_output_nid generation:  0.00019598007202148438
local_in_edges_tensor generation:  0.0003485679626464844Using backend: pytorch

mini_batch_src_global generation:  0.0002551078796386719
r_  generation:  0.00302886962890625
local_output_nid generation:  0.0001971721649169922
local_in_edges_tensor generation:  0.00034999847412109375
mini_batch_src_global generation:  0.00025200843811035156
r_  generation:  0.0029735565185546875
----------------------check_connections_block total spend ----------------------------- 0.03567075729370117
generate_one_block  0.00508880615234375
generate_one_block  0.0042726993560791016
generate_one_block  0.004262447357177734
generate_one_block  0.004375934600830078
generate_one_block  0.0042226314544677734
generate_one_block  0.00428462028503418
generate_one_block  0.004689931869506836
generate_one_block  0.00430750846862793
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 0.26296520233154297  GigaBytes
Max Memory Allocated: 1.0726571083068848  GigaBytes

connection checking time:  0.10475516319274902
block generation total time  0.11925315856933594
average batch blocks generation time:  0.014906644821166992
block dataloader generation time/epoch 0.3284749984741211
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 0.2636532783508301  GigaBytes
Max Memory Allocated: 1.0726571083068848  GigaBytes

torch.Size([2379, 1433])
torch.Size([2225, 16])
torch.Size([1772, 16])
torch.Size([1032, 16])
torch.Size([455, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 1.0732378959655762  GigaBytes
Max Memory Allocated: 1.1277003288269043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 0.26248884201049805  GigaBytes
Max Memory Allocated: 1.1653814315795898  GigaBytes

torch.Size([2345, 1433])
torch.Size([2132, 16])
torch.Size([1634, 16])
torch.Size([929, 16])
torch.Size([316, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 1.0519309043884277  GigaBytes
Max Memory Allocated: 1.1653814315795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 0.2636561393737793  GigaBytes
Max Memory Allocated: 1.1653814315795898  GigaBytes

torch.Size([2394, 1433])
torch.Size([2220, 16])
torch.Size([1829, 16])
torch.Size([1082, 16])
torch.Size([405, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 1.0739984512329102  GigaBytes
Max Memory Allocated: 1.1653814315795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 0.26366758346557617  GigaBytes
Max Memory Allocated: 1.1656160354614258  GigaBytes

torch.Size([2447, 1433])
torch.Size([2333, 16])
torch.Size([2000, 16])
torch.Size([1143, 16])
torch.Size([455, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 1.1097478866577148  GigaBytes
Max Memory Allocated: 1.1656160354614258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 0.26263904571533203  GigaBytes
Max Memory Allocated: 1.1999549865722656  GigaBytes

torch.Size([2370, 1433])
torch.Size([2209, 16])
torch.Size([1854, 16])
torch.Size([1150, 16])
torch.Size([431, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 1.0664100646972656  GigaBytes
Max Memory Allocated: 1.1999549865722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 0.2636713981628418  GigaBytes
Max Memory Allocated: 1.1999549865722656  GigaBytes

torch.Size([2403, 1433])
torch.Size([2248, 16])
torch.Size([1926, 16])
torch.Size([1264, 16])
torch.Size([512, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 1.081904411315918  GigaBytes
Max Memory Allocated: 1.1999549865722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 0.26366662979125977  GigaBytes
Max Memory Allocated: 1.1999549865722656  GigaBytes

torch.Size([2428, 1433])
torch.Size([2291, 16])
torch.Size([1880, 16])
torch.Size([1142, 16])
torch.Size([452, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 1.099611759185791  GigaBytes
Max Memory Allocated: 1.1999549865722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 0.26366472244262695  GigaBytes
Max Memory Allocated: 1.1999549865722656  GigaBytes

torch.Size([2404, 1433])
torch.Size([2271, 16])
torch.Size([1911, 16])
torch.Size([1144, 16])
torch.Size([396, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 1.090904712677002  GigaBytes
Max Memory Allocated: 1.1999549865722656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.062243640422821045 |0.0013905167579650879 |0.287477970123291 |0.00013247132301330566 |0.3775591254234314 |0.019542932510375977 |
----------------------------------------------------------pseudo_mini_loss sum 2.3189854621887207
Total (block generation + training)time/epoch 6.248999118804932
Training time/epoch 5.920147895812988
Training time without block to device /epoch 5.909023761749268
Training time without total dataloading part /epoch 5.340899467468262
load block tensor time/epoch 0.49794912338256836
block to device time/epoch 0.011124134063720703
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64975
Number of first layer input nodes during this epoch:  19170
