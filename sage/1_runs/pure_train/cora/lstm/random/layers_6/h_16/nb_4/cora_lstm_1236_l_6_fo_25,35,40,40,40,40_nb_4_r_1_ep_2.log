main start at this time 1648433510.5603154
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06277799606323242  GigaBytes
Max Memory Allocated: 0.06277799606323242  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001317739486694336
random selection method range initialization spend 0.00016379356384277344
time for parepare:  6.0558319091796875e-05
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0014371871948242188
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00011754035949707031
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.151199340820312e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.412101745605469e-05
----------------------check_connections_block total spend ----------------------------- 0.002725839614868164
generate_one_block  0.0014386177062988281
generate_one_block  0.0010538101196289062
generate_one_block  0.001092672348022461
generate_one_block  0.001046895980834961
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00046896934509277344
gen group dst list time:  3.647804260253906e-05
time for parepare:  0.00012946128845214844
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00038695335388183594
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004215240478515625
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00036978721618652344
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0003528594970703125
----------------------check_connections_block total spend ----------------------------- 0.0030107498168945312
generate_one_block  0.0014209747314453125
generate_one_block  0.001489400863647461
generate_one_block  0.0014700889587402344
generate_one_block  0.0013315677642822266
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005636215209960938
gen group dst list time:  7.104873657226562e-05
time for parepare:  0.00017023086547851562
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00027942657470703125
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.001049041748046875
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.0001277923583984375
r_  generation:  0.0011754035949707031
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  0.00012755393981933594
r_  generation:  0.0012047290802001953
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.00011396408081054688
r_  generation:  0.0011124610900878906
----------------------check_connections_block total spend ----------------------------- 0.007462024688720703
generate_one_block  0.002308368682861328
generate_one_block  0.002385377883911133
generate_one_block  0.002373218536376953
generate_one_block  0.0022711753845214844
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007174015045166016
gen group dst list time:  0.00012373924255371094
time for parepare:  0.00018072128295898438
local_output_nid generation:  9.274482727050781e-05
local_in_edges_tensor generation:  0.00042557716369628906
mini_batch_src_global generation:  0.0001494884490966797
r_  generation:  0.0021677017211914062
local_output_nid generation:  0.00010323524475097656
local_in_edges_tensor generation:  0.0002665519714355469
mini_batch_src_global generation:  0.0002498626708984375
r_  generation:  0.002240419387817383
local_output_nid generation:  0.00010800361633300781
local_in_edges_tensor generation:  0.0002703666687011719
mini_batch_src_global generation:  0.00019502639770507812
r_  generation:  0.002282857894897461
local_output_nid generation:  0.00011229515075683594
local_in_edges_tensor generation:  0.0002830028533935547
mini_batch_src_global generation:  0.0001964569091796875
r_  generation:  0.002247333526611328
----------------------check_connections_block total spend ----------------------------- 0.01367330551147461
generate_one_block  0.0034990310668945312
generate_one_block  0.003360271453857422
generate_one_block  0.003431558609008789
generate_one_block  0.003418445587158203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007541179656982422
gen group dst list time:  0.00017499923706054688
time for parepare:  0.00020575523376464844
local_output_nid generation:  0.0001347064971923828
local_in_edges_tensor generation:  0.0005202293395996094
mini_batch_src_global generation:  0.00023984909057617188
r_  generation:  0.002722024917602539
local_output_nid generation:  0.0001468658447265625
local_in_edges_tensor generation:  0.00033664703369140625
mini_batch_src_global generation:  0.0003097057342529297
r_  generation:  0.0027959346771240234
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.0003504753112792969
mini_batch_src_global generation:  0.0002353191375732422
r_  generation:  0.0028657913208007812
local_output_nid generation:  0.00015211105346679688
local_in_edges_tensor generation:  0.0003459453582763672
mini_batch_src_global generation:  0.00023984909057617188
r_  generation:  0.002931833267211914
----------------------check_connections_block total spend ----------------------------- 0.017238378524780273
generate_one_block  0.004107475280761719
generate_one_block  0.00479435920715332
generate_one_block  0.0040776729583740234
generate_one_block  0.0039997100830078125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007493495941162109
gen group dst list time:  0.00021696090698242188
time for parepare:  0.0001876354217529297
local_output_nid generation:  0.0001544952392578125
local_in_edges_tensor generation:  0.0006706714630126953
mini_batch_src_global generation:  0.00022101402282714844
r_  generation:  0.0029850006103515625
local_output_nid generation:  0.00016379356384277344
local_in_edges_tensor generation:  0.0003693103790283203
mini_batch_src_global generation:  0.000270843505859375
r_  generation:  0.0030434131622314453
local_output_nid generation:  0.0001583099365234375
local_in_edges_tensor generation:  0.0003528594970703125
mini_batch_src_global generation:  0.0002570152282714844
r_  generation:  0.0031011104583740234
local_output_nid generation:  0.00015807151794433594
local_in_edges_tensor generation:  0.00035119056701660156
mini_batch_src_global generation:  0.0002613067626953125
r_  generation:  0.0031054019927978516
----------------------check_connections_block total spend ----------------------------- 0.01852703094482422
generate_one_block  0.004176616668701172
generate_one_block  0.00422978401184082
generate_one_block  0.004262447357177734
generate_one_block  0.005219936370849609
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06277799606323242  GigaBytes
Max Memory Allocated: 0.06277799606323242  GigaBytes

connection checking time:  0.059911489486694336
block generation total time  0.06362748146057129
average batch blocks generation time:  0.015906870365142822
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.0766754150390625  GigaBytes
Max Memory Allocated: 0.0766754150390625  GigaBytes

torch.Size([2427, 1433])
torch.Size([2309, 16])
torch.Size([2047, 16])
torch.Size([1457, 16])
torch.Size([656, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.9062247276306152  GigaBytes
Max Memory Allocated: 0.9594769477844238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2850341796875 GB
    Memory Allocated: 0.13880538940429688  GigaBytes
Max Memory Allocated: 0.993537425994873  GigaBytes

torch.Size([2423, 1433])
torch.Size([2340, 16])
torch.Size([2089, 16])
torch.Size([1511, 16])
torch.Size([735, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 0.981691837310791  GigaBytes
Max Memory Allocated: 1.0342259407043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3690185546875 GB
    Memory Allocated: 0.1388072967529297  GigaBytes
Max Memory Allocated: 1.0676393508911133  GigaBytes

torch.Size([2454, 1433])
torch.Size([2384, 16])
torch.Size([2146, 16])
torch.Size([1569, 16])
torch.Size([723, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4217529296875 GB
    Memory Allocated: 0.9997100830078125  GigaBytes
Max Memory Allocated: 1.0676393508911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4217529296875 GB
    Memory Allocated: 0.13880634307861328  GigaBytes
Max Memory Allocated: 1.08518648147583  GigaBytes

torch.Size([2473, 1433])
torch.Size([2397, 16])
torch.Size([2182, 16])
torch.Size([1568, 16])
torch.Size([692, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4217529296875 GB
    Memory Allocated: 1.0022687911987305  GigaBytes
Max Memory Allocated: 1.08518648147583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05815404653549194 |0.0853387713432312 |0.4160858988761902 |0.0001475214958190918 |0.506044864654541 |0.01680731773376465 |
----------------------------------------------------------pseudo_mini_loss sum 2.6826210021972656
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37314
Number of first layer input nodes during this epoch:  9777
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5155029296875 GB
    Memory Allocated: 0.2641477584838867  GigaBytes
Max Memory Allocated: 1.0879898071289062  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007205009460449219
random selection method range initialization spend 0.00016427040100097656
time for parepare:  8.535385131835938e-05
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00010371208190917969
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  8.392333984375e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  8.106231689453125e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  8.273124694824219e-05
----------------------check_connections_block total spend ----------------------------- 0.0014948844909667969
generate_one_block  0.0013256072998046875
generate_one_block  0.0011267662048339844
generate_one_block  0.0012068748474121094
generate_one_block  0.00115966796875
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005495548248291016
gen group dst list time:  5.221366882324219e-05
time for parepare:  0.00017523765563964844
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0003771781921386719
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.000385284423828125
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0004887580871582031
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.00044608116149902344
----------------------check_connections_block total spend ----------------------------- 0.0035207271575927734
generate_one_block  0.0016016960144042969
generate_one_block  0.0016050338745117188
generate_one_block  0.0017273426055908203
generate_one_block  0.0016100406646728516
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005936622619628906
gen group dst list time:  8.7738037109375e-05
time for parepare:  0.00020432472229003906
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.0002903938293457031
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.0012691020965576172
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.00017690658569335938
r_  generation:  0.0011942386627197266
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  0.00018548965454101562
r_  generation:  0.0015234947204589844
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.0001595020294189453
r_  generation:  0.0012791156768798828
----------------------check_connections_block total spend ----------------------------- 0.008775711059570312
generate_one_block  0.0026450157165527344
generate_one_block  0.002542257308959961
generate_one_block  0.0027360916137695312
generate_one_block  0.0027489662170410156
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007643699645996094
gen group dst list time:  0.00015044212341308594
time for parepare:  0.00020265579223632812
local_output_nid generation:  0.00012874603271484375
local_in_edges_tensor generation:  0.0004150867462158203
mini_batch_src_global generation:  0.00023174285888671875
r_  generation:  0.0022776126861572266
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.00028634071350097656
mini_batch_src_global generation:  0.0002644062042236328
r_  generation:  0.002299070358276367
local_output_nid generation:  0.00014138221740722656
local_in_edges_tensor generation:  0.00030684471130371094
mini_batch_src_global generation: Using backend: pytorch
 0.00023555755615234375
r_  generation:  0.0026035308837890625
local_output_nid generation:  0.00013375282287597656
local_in_edges_tensor generation:  0.00029206275939941406
mini_batch_src_global generation:  0.00021982192993164062
r_  generation:  0.002469301223754883
----------------------check_connections_block total spend ----------------------------- 0.01510477066040039
generate_one_block  0.003887653350830078
generate_one_block  0.0036461353302001953
generate_one_block  0.0038285255432128906
generate_one_block  0.0037326812744140625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007805824279785156
gen group dst list time:  0.0001976490020751953
time for parepare:  0.00019502639770507812
local_output_nid generation:  0.00016951560974121094
local_in_edges_tensor generation:  0.0005178451538085938
mini_batch_src_global generation:  0.00021314620971679688
r_  generation:  0.0029976367950439453
local_output_nid generation:  0.00017833709716796875
local_in_edges_tensor generation:  0.0003590583801269531
mini_batch_src_global generation:  0.00032711029052734375
r_  generation:  0.0029942989349365234
local_output_nid generation:  0.00017595291137695312
local_in_edges_tensor generation:  0.00035262107849121094
mini_batch_src_global generation:  0.00025773048400878906
r_  generation:  0.003009796142578125
local_output_nid generation:  0.0001842975616455078
local_in_edges_tensor generation:  0.00035309791564941406
mini_batch_src_global generation:  0.0002651214599609375
r_  generation:  0.0030736923217773438
----------------------check_connections_block total spend ----------------------------- 0.01842212677001953
generate_one_block  0.004268646240234375
generate_one_block  0.004193544387817383
generate_one_block  0.004154682159423828
generate_one_block  0.0042629241943359375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008151531219482422
gen group dst list time:  0.000225067138671875
time for parepare:  0.00019168853759765625
local_output_nid generation:  0.0001900196075439453
local_in_edges_tensor generation:  0.0005123615264892578
mini_batch_src_global generation:  0.00023651123046875
r_  generation:  0.0031888484954833984
local_output_nid generation:  0.0001914501190185547
local_in_edges_tensor generation:  0.00038242340087890625
mini_batch_src_global generation:  0.00031185150146484375
r_  generation:  0.0032110214233398438
local_output_nid generation:  0.00018477439880371094
local_in_edges_tensor generation:  0.00036334991455078125
mini_batch_src_global generation:  0.0002605915069580078
r_  generation:  0.0031549930572509766
local_output_nid generation:  0.00018978118896484375
local_in_edges_tensor generation:  0.00036597251892089844
mini_batch_src_global generation:  0.0002727508544921875
r_  generation:  0.0032253265380859375
----------------------check_connections_block total spend ----------------------------- 0.019245147705078125
generate_one_block  0.0053865909576416016
generate_one_block  0.004384517669677734
generate_one_block  0.004269599914550781
generate_one_block  0.004626750946044922
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5155029296875 GB
    Memory Allocated: 0.2641477584838867  GigaBytes
Max Memory Allocated: 1.0879898071289062  GigaBytes

connection checking time:  0.06506848335266113
block generation total time  0.06785869598388672
average batch blocks generation time:  0.01696467399597168
block dataloader generation time/epoch 0.19959139823913574
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5155029296875 GB
    Memory Allocated: 0.2636899948120117  GigaBytes
Max Memory Allocated: 1.0879898071289062  GigaBytes

torch.Size([2428, 1433])
torch.Size([2341, 16])
torch.Size([2099, 16])
torch.Size([1460, 16])
torch.Size([681, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5155029296875 GB
    Memory Allocated: 1.1119728088378906  GigaBytes
Max Memory Allocated: 1.1640725135803223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5155029296875 GB
    Memory Allocated: 0.26369285583496094  GigaBytes
Max Memory Allocated: 1.198737621307373  GigaBytes

torch.Size([2459, 1433])
torch.Size([2375, 16])
torch.Size([2127, 16])
torch.Size([1467, 16])
torch.Size([680, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5155029296875 GB
    Memory Allocated: 1.1222782135009766  GigaBytes
Max Memory Allocated: 1.198737621307373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5155029296875 GB
    Memory Allocated: 0.2637062072753906  GigaBytes
Max Memory Allocated: 1.2087593078613281  GigaBytes

torch.Size([2420, 1433])
torch.Size([2323, 16])
torch.Size([2150, 16])
torch.Size([1682, 16])
torch.Size([855, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5174560546875 GB
    Memory Allocated: 1.097447395324707  GigaBytes
Max Memory Allocated: 1.2087593078613281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5174560546875 GB
    Memory Allocated: 0.2637033462524414  GigaBytes
Max Memory Allocated: 1.2087593078613281  GigaBytes

torch.Size([2454, 1433])
torch.Size([2396, 16])
torch.Size([2179, 16])
torch.Size([1555, 16])
torch.Size([711, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5174560546875 GB
    Memory Allocated: 1.1275420188903809  GigaBytes
Max Memory Allocated: 1.2087593078613281  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.055214762687683105 |0.001346588134765625 |0.3044712543487549 |0.0001335740089416504 |0.4988452196121216 |0.015574932098388672 |
----------------------------------------------------------pseudo_mini_loss sum 2.4718728065490723
Total (block generation + training)time/epoch 3.7181942462921143
Training time/epoch 3.518300771713257
Training time without block to device /epoch 3.5129144191741943
Training time without total dataloading part /epoch 3.229375123977661
load block tensor time/epoch 0.22085905075073242
block to device time/epoch 0.0053863525390625
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37573
Number of first layer input nodes during this epoch:  9761
