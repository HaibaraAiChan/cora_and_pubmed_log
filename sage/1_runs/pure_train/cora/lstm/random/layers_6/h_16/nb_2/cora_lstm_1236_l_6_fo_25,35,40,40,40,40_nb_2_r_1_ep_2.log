main start at this time 1648433497.9503367
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06277799606323242  GigaBytes
Max Memory Allocated: 0.06277799606323242  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00103759765625
random selection method range initialization spend 0.00019431114196777344
time for parepare:  8.177757263183594e-05
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.002131938934326172
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0001342296600341797
----------------------check_connections_block total spend ----------------------------- 0.0031113624572753906
generate_one_block  0.0017130374908447266
generate_one_block  0.0014147758483886719
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005910396575927734
gen group dst list time:  3.8623809814453125e-05
time for parepare:  0.00017142295837402344
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.00027179718017578125
mini_batch_src_global generation:  9.489059448242188e-05
r_  generation:  0.0009768009185791016
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.0007426738739013672
----------------------check_connections_block total spend ----------------------------- 0.0031070709228515625
generate_one_block  0.002417325973510742
generate_one_block  0.002108335494995117
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006806850433349609
gen group dst list time:  7.128715515136719e-05
time for parepare:  0.00022602081298828125
local_output_nid generation:  0.00010418891906738281
local_in_edges_tensor generation:  0.0003910064697265625
mini_batch_src_global generation:  0.0002353191375732422
r_  generation:  0.0022788047790527344
local_output_nid generation:  0.00010442733764648438
local_in_edges_tensor generation:  0.00029587745666503906
mini_batch_src_global generation:  0.00023174285888671875
r_  generation:  0.002125263214111328
----------------------check_connections_block total spend ----------------------------- 0.007047414779663086
generate_one_block  0.0038640499114990234
generate_one_block  0.0036051273345947266
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007741451263427734
gen group dst list time:  0.00011563301086425781
time for parepare:  0.00023674964904785156
local_output_nid generation:  0.00017952919006347656
local_in_edges_tensor generation:  0.000522613525390625
mini_batch_src_global generation:  0.0002589225769042969
r_  generation:  0.003751039505004883
local_output_nid generation:  0.00018930435180664062
local_in_edges_tensor generation:  0.0004055500030517578
mini_batch_src_global generation:  0.00039196014404296875
r_  generation:  0.003526926040649414
----------------------check_connections_block total spend ----------------------------- 0.01122283935546875
generate_one_block  0.004701852798461914
generate_one_block  0.0037963390350341797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00070953369140625
gen group dst list time:  0.00014448165893554688
time for parepare:  0.00024127960205078125
local_output_nid generation:  0.00020933151245117188
local_in_edges_tensor generation:  0.0005495548248291016
mini_batch_src_global generation:  0.0002846717834472656
r_  generation:  0.004094600677490234
local_output_nid generation:  0.00022554397583007812
local_in_edges_tensor generation:  0.00045990943908691406
mini_batch_src_global generation:  0.000431060791015625
r_  generation:  0.0033588409423828125
----------------------check_connections_block total spend ----------------------------- 0.011644601821899414
generate_one_block  0.004590034484863281
generate_one_block  0.004378795623779297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007812976837158203
gen group dst list time:  0.00012302398681640625
time for parepare:  0.0001976490020751953
local_output_nid generation:  0.00016760826110839844
local_in_edges_tensor generation:  0.00047087669372558594
mini_batch_src_global generation:  0.0002353191375732422
r_  generation:  0.003430604934692383
local_output_nid generation:  0.00017690658569335938
local_in_edges_tensor generation:  0.0003933906555175781
mini_batch_src_global generation:  0.0003101825714111328
r_  generation:  0.003463268280029297
----------------------check_connections_block total spend ----------------------------- 0.01049661636352539
generate_one_block  0.004975080490112305
generate_one_block  0.005045890808105469
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06277799606323242  GigaBytes
Max Memory Allocated: 0.06277799606323242  GigaBytes

connection checking time:  0.0435185432434082
block generation total time  0.039482831954956055
average batch blocks generation time:  0.019741415977478027
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07672262191772461  GigaBytes
Max Memory Allocated: 0.07672262191772461  GigaBytes

torch.Size([2493, 1433])
torch.Size([2437, 16])
torch.Size([2290, 16])
torch.Size([1910, 16])
torch.Size([1148, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2205810546875 GB
    Memory Allocated: 0.9538321495056152  GigaBytes
Max Memory Allocated: 1.004274845123291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.1388392448425293  GigaBytes
Max Memory Allocated: 1.0343422889709473  GigaBytes

torch.Size([2505, 1433])
torch.Size([2459, 16])
torch.Size([2335, 16])
torch.Size([1899, 16])
torch.Size([1038, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3670654296875 GB
    Memory Allocated: 1.0129437446594238  GigaBytes
Max Memory Allocated: 1.0639195442199707  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04591047763824463 |0.16945505142211914 |0.5575555562973022 |0.0001932382583618164 |0.4277864694595337 |0.02142620086669922 |
----------------------------------------------------------pseudo_mini_loss sum 2.572751998901367
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21215
Number of first layer input nodes during this epoch:  4998
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5233154296875 GB
    Memory Allocated: 0.2642502784729004  GigaBytes
Max Memory Allocated: 1.094008445739746  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005314350128173828
random selection method range initialization spend 0.0001323223114013672
time for parepare:  7.677078247070312e-05
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00012445449829101562
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00012826919555664062
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00015497207641601562
----------------------check_connections_block total spend ----------------------------- 0.0010716915130615234
generate_one_block  0.0013175010681152344
generate_one_block  0.0012967586517333984
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005509853363037109
gen group dst list time:  3.4332275390625e-05
time for parepare:  0.00016641616821289062
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.0006496906280517578
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  0.00011539459228515625
r_  generation:  0.0008184909820556641
----------------------check_connections_block total spend ----------------------------- 0.00275421142578125
generate_one_block  0.0019991397857666016
generate_one_block  0.0021467208862304688
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006155967712402344
gen group dst list time:  6.4849853515625e-05
time for parepare:  0.0001952648162841797
local_output_nid generation:  9.369850158691406e-05
local_in_edges_tensor generation:  0.0003266334533691406
mini_batch_src_global generation:  0.00016546249389648438
r_  generation:  0.001809835433959961
local_output_nid generation:  0.00010013580322265625
local_in_edges_tensor generation:  0.00026416778564453125
mini_batch_src_global generation:  0.0002231597900390625
r_  generation:  0.001999378204345703
----------------------check_connections_block total spend ----------------------------- 0.006130695343017578
generate_one_block  0.003583669662475586
generate_one_block  0.0034704208374023438
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006551742553710938
gen group dst list time:  9.417533874511719e-05
time for parepare:  0.00019359588623046875
local_output_nid generation:  0.00014400482177734375
local_in_edges_tensor generation:  0.00041985511779785156
mini_batch_src_global generation:  0.0002110004425048828
r_  generation:  0.0028667449951171875
local_output_nid generation:  0.0001499652862548828
local_in_edges_tensor generation:  0.00034809112548828125
mini_batch_src_global generation:  0.0003304481506347656
r_  generation:  0.002947568893432617
----------------------check_connections_block total spend ----------------------------- 0.009050369262695312
generate_one_block  0.004435300827026367
generate_one_block  0.004377603530883789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007948875427246094
gen group dst list time:  0.00011539459228515625
time for parepare:  0.0002048015594482422
local_output_nid generation:  0.00017404556274414062
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.003381967544555664
local_output_nid generation:  0.00017881393432617188
local_in_edges_tensor generation:  0.0003941059112548828
mini_batch_src_global generation:  0.0003108978271484375
r_  generation:  0.003359079360961914
----------------------check_connections_block total spend ----------------------------- 0.01042485237121582
generate_one_block  0.00482630729675293
generate_one_block  0.004595041275024414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007376670837402344
gen group dst list time:  0.00012683868408203125
time for parepare:  0.00019788742065429688
local_output_nid generation:  0.00018310546875
local_in_edges_tensor generation:  0.0005030632019042969
mini_batch_src_global generation:  0.0002467632293701172
r_  generation:  0.0034601688385009766
local_output_nid generation:  0.00018739700317382812
local_in_edges_tensor generation:  0.00039649009704589844
mini_batch_src_global generation:  0.00031566619873046875
r_  generation:  0.003444194793701172
----------------------check_connections_block total spend ----------------------------- 0.010567188262939453
generate_one_block  0.004945278167724609
generate_one_block  0.005418539047241211
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5233154296875 GB
    Memory Allocated: 0.2642502784729004  GigaBytes
Max Memory Allocated: 1.094008445739746  GigaBytes

connection checking time:  0.038927316665649414
block generation total time  0.03979802131652832
average batch blocks generation time:  0.01989901065826416
block dataloader generation time/epoch 0.11293554306030273
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5233154296875 GB
    Memory Allocated: 0.26372861862182617  GigaBytes
Max Memory Allocated: 1.094008445739746  GigaBytes

torch.Size([2501, 1433])
torch.Size([2458, 16])
torch.Size([2319, 16])
torch.Size([1854, 16])
torch.Size([1058, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5760498046875 GB
    Memory Allocated: 1.1370110511779785  GigaBytes
Max Memory Allocated: 1.1879305839538574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5760498046875 GB
    Memory Allocated: 0.26373815536499023  GigaBytes
Max Memory Allocated: 1.2189583778381348  GigaBytes

torch.Size([2476, 1433])
torch.Size([2444, 16])
torch.Size([2321, 16])
torch.Size([1941, 16])
torch.Size([1176, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 1.1367878913879395  GigaBytes
Max Memory Allocated: 1.2189583778381348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03757822513580322 |0.001181960105895996 |0.3257945775985718 |0.0001327991485595703 |0.4508790969848633 |0.015485525131225586 |
----------------------------------------------------------pseudo_mini_loss sum 2.1588034629821777
Total (block generation + training)time/epoch 1.824049711227417
Training time/epoch 1.7108628749847412
Training time without block to device /epoch 1.7084989547729492
Training time without total dataloading part /epoch 1.5690984725952148
load block tensor time/epoch 0.07515645027160645
block to device time/epoch 0.002363920211791992
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21240
Number of first layer input nodes during this epoch:  4977
