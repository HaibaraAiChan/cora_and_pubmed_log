main start at this time 1648433742.524943
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0838623046875 GB
    Memory Allocated: 0.06687688827514648  GigaBytes
Max Memory Allocated: 0.06687688827514648  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0018947124481201172
random selection method range initialization spend 0.0003418922424316406
time for parepare:  0.00014328956604003906
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.0003459453582763672
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.004221916198730469
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.0002856254577636719
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0002994537353515625
----------------------check_connections_block total spend ----------------------------- 0.005915403366088867
generate_one_block  0.0028984546661376953
generate_one_block  0.0017516613006591797
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000713348388671875
gen group dst list time:  4.172325134277344e-05
time for parepare:  0.0002129077911376953
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0002853870391845703
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0009927749633789062
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00023293495178222656
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.001074075698852539
----------------------check_connections_block total spend ----------------------------- 0.0037055015563964844
generate_one_block  0.0025014877319335938
generate_one_block  0.0019202232360839844
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006182193756103516
gen group dst list time:  5.936622619628906e-05
time for parepare:  0.00018024444580078125
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.0003361701965332031
mini_batch_src_global generation:  0.00019621849060058594
r_  generation:  0.00182342529296875
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.00025773048400878906
mini_batch_src_global generation:  0.0001876354217529297
r_  generation:  0.0018458366394042969
----------------------check_connections_block total spend ----------------------------- 0.00586700439453125
generate_one_block  0.003016948699951172
generate_one_block  0.0029370784759521484
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006031990051269531
gen group dst list time:  8.344650268554688e-05
time for parepare:  0.0002193450927734375
local_output_nid generation:  0.0001239776611328125
local_in_edges_tensor generation:  0.0004353523254394531
mini_batch_src_global generation:  0.0001995563507080078
r_  generation:  0.0027189254760742188
local_output_nid generation:  0.0001308917999267578
local_in_edges_tensor generation:  0.0003323554992675781
mini_batch_src_global generation:  0.0003228187561035156
r_  generation:  0.002599954605102539
----------------------check_connections_block total spend ----------------------------- 0.008477449417114258
generate_one_block  0.0038633346557617188
generate_one_block  0.0038368701934814453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007855892181396484
gen group dst list time:  0.00010609626770019531
time for parepare:  0.0001838207244873047
local_output_nid generation:  0.0001480579376220703
local_in_edges_tensor generation:  0.0005218982696533203
mini_batch_src_global generation:  0.00022745132446289062
r_  generation:  0.0030579566955566406
local_output_nid generation:  0.00015044212341308594
local_in_edges_tensor generation:  0.000347137451171875
mini_batch_src_global generation:  0.0003211498260498047
r_  generation:  0.0031244754791259766
----------------------check_connections_block total spend ----------------------------- 0.009531021118164062
generate_one_block  0.004183769226074219
generate_one_block  0.004224061965942383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006530284881591797
gen group dst list time:  0.00011706352233886719
time for parepare:  0.00018334388732910156
local_output_nid generation:  0.00016117095947265625
local_in_edges_tensor generation:  0.0004496574401855469
mini_batch_src_global generation:  0.00021314620971679688
r_  generation:  0.0031180381774902344
local_output_nid generation:  0.00015974044799804688
local_in_edges_tensor generation:  0.0003571510314941406
mini_batch_src_global generation:  0.0002796649932861328
r_  generation:  0.003155946731567383
----------------------check_connections_block total spend ----------------------------- 0.009485006332397461
generate_one_block  0.004502773284912109
generate_one_block  0.0043163299560546875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0838623046875 GB
    Memory Allocated: 0.06687688827514648  GigaBytes
Max Memory Allocated: 0.06687688827514648  GigaBytes

connection checking time:  0.037065982818603516
block generation total time  0.03530287742614746
average batch blocks generation time:  0.01765143871307373
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.08081674575805664  GigaBytes
Max Memory Allocated: 0.08081674575805664  GigaBytes

torch.Size([2482, 1433])
torch.Size([2418, 128])
torch.Size([2281, 128])
torch.Size([1893, 128])
torch.Size([1133, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 1.13291597366333  GigaBytes
Max Memory Allocated: 1.1331391334533691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4744873046875 GB
    Memory Allocated: 0.14704179763793945  GigaBytes
Max Memory Allocated: 1.1337294578552246  GigaBytes

torch.Size([2505, 1433])
torch.Size([2453, 128])
torch.Size([2315, 128])
torch.Size([1899, 128])
torch.Size([1132, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 1.207718849182129  GigaBytes
Max Memory Allocated: 1.2079582214355469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.049155354499816895 |0.172876238822937 |0.5670925378799438 |0.00020897388458251953 |0.4532186985015869 |0.021380901336669922 |
----------------------------------------------------------pseudo_mini_loss sum 3.2065792083740234
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21204
Number of first layer input nodes during this epoch:  4987
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6932373046875 GB
    Memory Allocated: 0.28066015243530273  GigaBytes
Max Memory Allocated: 1.208517074584961  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005004405975341797
random selection method range initialization spend 0.00012564659118652344
time for parepare:  7.033348083496094e-05
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0001361370086669922
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00011897087097167969
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00011897087097167969
----------------------check_connections_block total spend ----------------------------- 0.0009810924530029297
generate_one_block  0.001276254653930664
generate_one_block  0.0011594295501708984
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004911422729492188
gen group dst list time:  3.147125244140625e-05
time for parepare:  0.0001456737518310547
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  0.00021719932556152344
r_  generation:  0.0007290840148925781
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0006134510040283203
----------------------check_connections_block total spend ----------------------------- 0.002687692642211914
generate_one_block  0.0020813941955566406
generate_one_block  0.001861572265625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000568389892578125
gen group dst list time:  6.103515625e-05
time for parepare:  0.00018095970153808594
local_output_nid generation:  9.512901306152344e-05
local_in_edges_tensor generation:  0.00032901763916015625
mini_batch_src_global generation:  0.0001709461212158203
r_  generation:  0.0018041133880615234
local_output_nid generation:  8.392333984375e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  0.0001914501190185547
r_  generation:  0.0016472339630126953
----------------------check_connections_block total spend ----------------------------- 0.005588531494140625
generate_one_block  0.0034780502319335938
generate_one_block  0.0031588077545166016
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006289482116699219
gen group dst list time:  8.797645568847656e-05
time for parepare:  0.00017499923706054688
local_output_nid generation:  0.0001354217529296875
local_in_edges_tensor generation:  0.00042748451232910156
mini_batch_src_global generation:  0.00019407272338867188
r_  generation:  0.002679109573364258
local_output_nid generation:  0.00014209747314453125
local_in_edges_tensor generation:  0.00032520294189453125
mini_batch_src_global generation:  0.0002856254577636719
r_  generation:  0.002580881118774414
----------------------check_connections_block total spend ----------------------------- 0.008263349533081055
generate_one_block  0.0040967464447021484
generate_one_block  0.003987312316894531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007700920104980469
gen group dst list time:  0.00010561943054199219
time for parepare:  0.00017833709716796875
local_output_nid generation:  0.00015592575073242188
local_in_edges_tensor generation:  0.0004458427429199219
mini_batch_src_global generation:  0.0003342628479003906
r_  generation:  0.0030329227447509766
local_output_nid generation:  0.00016379356384277344
local_in_edges_tensor generation:  0.0003559589385986328
mini_batch_src_global generation:  0.0002880096435546875
r_  generation:  0.0030226707458496094
----------------------check_connections_block total spend ----------------------------- 0.009476423263549805
generate_one_block  0.004388570785522461
generate_one_block  0.004332780838012695
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007658004760742188
gen group dst list time:  0.00011587142944335938
time for parepare:  0.00017881393432617188
local_output_nid generation:  0.0001652240753173828
local_in_edges_tensor generation:  0.000461578369140625
mini_batch_src_global generation:  0.00022864341735839844
r_  generation:  0.003107309341430664
local_output_nid generation:  0.0001728534698486328
local_in_edges_tensor generation:  0.00036406517028808594
mini_batch_src_global generation:  0.00029206275939941406
r_  generation:  0.003094911575317383
----------------------check_connections_block total spend ----------------------------- 0.009659290313720703
generate_one_block  0.004499912261962891
generate_one_block  0.006484508514404297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6932373046875 GB
    Memory Allocated: 0.28066015243530273  GigaBytes
Max Memory Allocated: 1.208517074584961  GigaBytes

connection checking time:  0.0356752872467041
block generation total time  0.03836965560913086
average batch blocks generation time:  0.01918482780456543
block dataloader generation time/epoch 0.10660386085510254
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6932373046875 GB
    Memory Allocated: 0.2801356315612793  GigaBytes
Max Memory Allocated: 1.208517074584961  GigaBytes

torch.Size([2494, 1433])
torch.Size([2458, 128])
torch.Size([2340, 128])
torch.Size([1958, 128])
torch.Size([1174, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7596435546875 GB
    Memory Allocated: 1.3473119735717773  GigaBytes
Max Memory Allocated: 1.347564697265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7615966796875 GB
    Memory Allocated: 0.28012704849243164  GigaBytes
Max Memory Allocated: 1.3480939865112305  GigaBytes

torch.Size([2506, 1433])
torch.Size([2463, 128])
torch.Size([2339, 128])
torch.Size([1892, 128])
torch.Size([1092, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7615966796875 GB
    Memory Allocated: 1.3356118202209473  GigaBytes
Max Memory Allocated: 1.3480939865112305  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03780961036682129 |0.0011548995971679688 |0.33211493492126465 |0.00014853477478027344 |0.4705519676208496 |0.015843868255615234 |
----------------------------------------------------------pseudo_mini_loss sum 2.6791200637817383
Total (block generation + training)time/epoch 1.8684213161468506
Training time/epoch 1.761502742767334
Training time without block to device /epoch 1.759192943572998
Training time without total dataloading part /epoch 1.6214747428894043
load block tensor time/epoch 0.07561922073364258
block to device time/epoch 0.0023097991943359375
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21419
Number of first layer input nodes during this epoch:  5000
