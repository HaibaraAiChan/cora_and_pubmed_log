main start at this time 1648433755.388024
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0838623046875 GB
    Memory Allocated: 0.06687688827514648  GigaBytes
Max Memory Allocated: 0.06687688827514648  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0011267662048339844
random selection method range initialization spend 0.0002052783966064453
time for parepare:  7.2479248046875e-05
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0025949478149414062
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  8.654594421386719e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  8.916854858398438e-05
----------------------check_connections_block total spend ----------------------------- 0.003934383392333984
generate_one_block  0.001520395278930664
generate_one_block  0.001134634017944336
generate_one_block  0.0011136531829833984
generate_one_block  0.001142263412475586
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005173683166503906
gen group dst list time:  4.100799560546875e-05
time for parepare:  0.0001442432403564453
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0003867149353027344
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0004343986511230469
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.00043320655822753906
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00046753883361816406
----------------------check_connections_block total spend ----------------------------- 0.0033004283905029297
generate_one_block  0.0015308856964111328
generate_one_block  0.0015523433685302734
generate_one_block  0.0016093254089355469
generate_one_block  0.0015635490417480469
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006110668182373047
gen group dst list time:  7.82012939453125e-05
time for parepare:  0.00018906593322753906
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.0002837181091308594
mini_batch_src_global generation:  0.0001506805419921875
r_  generation:  0.0012423992156982422
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.00013589859008789062
r_  generation:  0.0012943744659423828
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.0013158321380615234
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.00013446807861328125
r_  generation:  0.0013315677642822266
----------------------check_connections_block total spend ----------------------------- 0.00835275650024414
generate_one_block  0.0025482177734375
generate_one_block  0.0025415420532226562
generate_one_block  0.0024785995483398438
generate_one_block  0.002320528030395508
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00074005126953125
gen group dst list time:  0.00014019012451171875
time for parepare:  0.0002009868621826172
local_output_nid generation:  0.00011396408081054688
local_in_edges_tensor generation:  0.0004096031188964844
mini_batch_src_global generation:  0.00018358230590820312
r_  generation:  0.002401590347290039
local_output_nid generation:  0.00011014938354492188
local_in_edges_tensor generation:  0.00030612945556640625
mini_batch_src_global generation:  0.0002689361572265625
r_  generation:  0.0023539066314697266
local_output_nid generation:  0.00011277198791503906
local_in_edges_tensor generation:  0.00029349327087402344
mini_batch_src_global generation:  0.0002124309539794922
r_  generation:  0.002388477325439453
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.0002930164337158203
mini_batch_src_global generation:  0.00021266937255859375
r_  generation:  0.0024132728576660156
----------------------check_connections_block total spend ----------------------------- 0.014821290969848633
generate_one_block  0.0036041736602783203
generate_one_block  0.003341197967529297
generate_one_block  0.0033469200134277344
generate_one_block  0.0033829212188720703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007898807525634766
gen group dst list time:  0.0001957416534423828
time for parepare:  0.00020623207092285156
local_output_nid generation:  0.00014638900756835938
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0002562999725341797
r_  generation:  0.0030753612518310547
local_output_nid generation:  0.00015473365783691406
local_in_edges_tensor generation:  0.0003571510314941406
mini_batch_src_global generation:  0.00032210350036621094
r_  generation:  0.003034830093383789
local_output_nid generation:  0.000156402587890625
local_in_edges_tensor generation:  0.0003662109375
mini_batch_src_global generation:  0.00025916099548339844
r_  generation:  0.003115415573120117
local_output_nid generation:  0.0001537799835205078
local_in_edges_tensor generation:  0.000354766845703125
mini_batch_src_global generation:  0.0002598762512207031
r_  generation:  0.003084897994995117
----------------------check_connections_block total spend ----------------------------- 0.018565654754638672
generate_one_block  0.004157543182373047
generate_one_block  0.0041656494140625
generate_one_block  0.003949880599975586
generate_one_block  0.003907442092895508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007901191711425781
gen group dst list time:  0.00022745132446289062
time for parepare:  0.00020170211791992188
local_output_nid generation:  0.0001647472381591797
local_in_edges_tensor generation:  0.0006425380706787109
mini_batch_src_global generation:  0.00023412704467773438
r_  generation:  0.0033326148986816406
local_output_nid generation:  0.00017404556274414062
local_in_edges_tensor generation:  0.0003859996795654297
mini_batch_src_global generation:  0.000339508056640625
r_  generation:  0.0033075809478759766
local_output_nid generation:  0.0001735687255859375
local_in_edges_tensor generation:  0.0003795623779296875
mini_batch_src_global generation:  0.0002701282501220703
r_  generation:  0.0032927989959716797
local_output_nid generation:  0.00017595291137695312
local_in_edges_tensor generation:  0.0003840923309326172
mini_batch_src_global generation:  0.0002655982971191406
r_  generation:  0.0033507347106933594
----------------------check_connections_block total spend ----------------------------- 0.020218610763549805
generate_one_block  0.00429534912109375
generate_one_block  0.0041768550872802734
generate_one_block  0.004153251647949219
generate_one_block  0.0049991607666015625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0838623046875 GB
    Memory Allocated: 0.06687688827514648  GigaBytes
Max Memory Allocated: 0.06687688827514648  GigaBytes

connection checking time:  0.06525874137878418
block generation total time  0.06362533569335938
average batch blocks generation time:  0.015906333923339844
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.0807790756225586  GigaBytes
Max Memory Allocated: 0.0807790756225586  GigaBytes

torch.Size([2441, 1433])
torch.Size([2339, 128])
torch.Size([2102, 128])
torch.Size([1517, 128])
torch.Size([680, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 1.0764541625976562  GigaBytes
Max Memory Allocated: 1.076563835144043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4276123046875 GB
    Memory Allocated: 0.14700031280517578  GigaBytes
Max Memory Allocated: 1.0773491859436035  GigaBytes

torch.Size([2430, 1433])
torch.Size([2348, 128])
torch.Size([2088, 128])
torch.Size([1493, 128])
torch.Size([737, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4822998046875 GB
    Memory Allocated: 1.1444578170776367  GigaBytes
Max Memory Allocated: 1.1445798873901367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.1470022201538086  GigaBytes
Max Memory Allocated: 1.1453380584716797  GigaBytes

torch.Size([2403, 1433])
torch.Size([2320, 128])
torch.Size([2124, 128])
torch.Size([1502, 128])
torch.Size([748, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 1.1314988136291504  GigaBytes
Max Memory Allocated: 1.1453380584716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.1470041275024414  GigaBytes
Max Memory Allocated: 1.1453380584716797  GigaBytes

torch.Size([2470, 1433])
torch.Size([2377, 128])
torch.Size([2099, 128])
torch.Size([1511, 128])
torch.Size([707, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5701904296875 GB
    Memory Allocated: 1.1592926979064941  GigaBytes
Max Memory Allocated: 1.159428596496582  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05676078796386719 |0.08606255054473877 |0.42387527227401733 |0.00016325712203979492 |0.4335682988166809 |0.008398056030273438 |
----------------------------------------------------------pseudo_mini_loss sum 2.950737476348877
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37169
Number of first layer input nodes during this epoch:  9744
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.28054237365722656  GigaBytes
Max Memory Allocated: 1.1601638793945312  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005481243133544922
random selection method range initialization spend 0.00013399124145507812
time for parepare:  7.963180541992188e-05
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  9.465217590332031e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.772445678710938e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.508827209472656e-05
----------------------check_connections_block total spend ----------------------------- 0.0014142990112304688
generate_one_block  0.0012469291687011719
generate_one_block  0.0011982917785644531
generate_one_block  0.0011551380157470703
generate_one_block  0.0011358261108398438
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005450248718261719
gen group dst list time:  4.76837158203125e-05
time for parepare:  0.00017023086547851562
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00040221214294433594
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0005557537078857422
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.00046896934509277344
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0003437995910644531
----------------------check_connections_block total spend ----------------------------- 0.003602266311645508
generate_one_block  0.0016613006591796875
generate_one_block  0.0017955303192138672
generate_one_block  0.0016932487487792969
generate_one_block  0.002824068069458008
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006916522979736328
gen group dst list time:  0.00011420249938964844
time for parepare:  0.0002224445343017578
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.00037217140197753906
mini_batch_src_global generation:  0.00016999244689941406
r_  generation:  0.0013053417205810547
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.00022363662719726562
mini_batch_src_global generation:  0.0002167224884033203
r_  generation:  0.0014955997467041016
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  0.0001609325408935547
r_  generation:  0.0014407634735107422
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00013756752014160156
r_  generation:  0.0011284351348876953
----------------------check_connections_block total spend ----------------------------- 0.009027719497680664
generate_one_block  0.0027709007263183594
generate_one_block  0.0029158592224121094
generate_one_block  0.002566814422607422
generate_one_block  0.002367734909057617
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007340908050537109
gen group dst list time:  0.00015234947204589844
time for parepare:  0.0002086162567138672
local_output_nid generation:  0.00013375282287597656
local_in_edges_tensor generation:  0.000400543212890625
mini_batch_src_global generation:  0.00022864341735839844
r_  generation:  0.0024242401123046875
local_output_nid generation:  0.0001404285430908203
local_in_edges_tensor generation:  0.0003154277801513672
mini_batch_src_global generation:  0.00027751922607421875
r_  generation:  0.0026159286499023438
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.0003037452697753906
mini_batch_src_global generation: Using backend: pytorch
 0.00022411346435546875
r_  generation:  0.002475738525390625
local_output_nid generation:  0.0001246929168701172
local_in_edges_tensor generation:  0.00028824806213378906
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.002281665802001953
----------------------check_connections_block total spend ----------------------------- 0.015261173248291016
generate_one_block  0.00400853157043457
generate_one_block  0.00396418571472168
generate_one_block  0.0037322044372558594
generate_one_block  0.0034563541412353516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007610321044921875
gen group dst list time:  0.00021529197692871094
time for parepare:  0.00021123886108398438
local_output_nid generation:  0.00017642974853515625
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.00028634071350097656
r_  generation:  0.0031545162200927734
local_output_nid generation:  0.000186920166015625
local_in_edges_tensor generation:  0.0003707408905029297
mini_batch_src_global generation:  0.0003390312194824219
r_  generation:  0.0032024383544921875
local_output_nid generation:  0.0001800060272216797
local_in_edges_tensor generation:  0.00036025047302246094
mini_batch_src_global generation:  0.00025725364685058594
r_  generation:  0.003104686737060547
local_output_nid generation:  0.00017952919006347656
local_in_edges_tensor generation:  0.00036787986755371094
mini_batch_src_global generation:  0.0002586841583251953
r_  generation:  0.0031037330627441406
----------------------check_connections_block total spend ----------------------------- 0.019155025482177734
generate_one_block  0.0043752193450927734
generate_one_block  0.0044209957122802734
generate_one_block  0.004217624664306641
generate_one_block  0.004183292388916016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007596015930175781
gen group dst list time:  0.00023365020751953125
time for parepare:  0.00020122528076171875
local_output_nid generation:  0.00020265579223632812
local_in_edges_tensor generation:  0.0005080699920654297
mini_batch_src_global generation:  0.00024890899658203125
r_  generation:  0.003359079360961914
local_output_nid generation:  0.00019812583923339844
local_in_edges_tensor generation:  0.0003895759582519531
mini_batch_src_global generation:  0.0003223419189453125
r_  generation:  0.0034012794494628906
local_output_nid generation:  0.00019741058349609375
local_in_edges_tensor generation:  0.0003819465637207031
mini_batch_src_global generation:  0.0002734661102294922
r_  generation:  0.006749629974365234
local_output_nid generation:  0.00020384788513183594
local_in_edges_tensor generation:  0.0006039142608642578
mini_batch_src_global generation:  0.0002918243408203125
r_  generation:  0.0032405853271484375
----------------------check_connections_block total spend ----------------------------- 0.023853540420532227
generate_one_block  0.005129098892211914
generate_one_block  0.005173444747924805
generate_one_block  0.0042896270751953125
generate_one_block  0.004599571228027344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.28054237365722656  GigaBytes
Max Memory Allocated: 1.1601638793945312  GigaBytes

connection checking time:  0.07089972496032715
block generation total time  0.0701456069946289
average batch blocks generation time:  0.017536401748657227
block dataloader generation time/epoch 0.2068939208984375
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.2800884246826172  GigaBytes
Max Memory Allocated: 1.1601638793945312  GigaBytes

torch.Size([2437, 1433])
torch.Size([2343, 128])
torch.Size([2094, 128])
torch.Size([1506, 128])
torch.Size([716, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6697998046875 GB
    Memory Allocated: 1.278696060180664  GigaBytes
Max Memory Allocated: 1.278806209564209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.2801036834716797  GigaBytes
Max Memory Allocated: 1.279588222503662  GigaBytes

torch.Size([2457, 1433])
torch.Size([2385, 128])
torch.Size([2161, 128])
torch.Size([1645, 128])
torch.Size([795, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6854248046875 GB
    Memory Allocated: 1.3082985877990723  GigaBytes
Max Memory Allocated: 1.3084526062011719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6854248046875 GB
    Memory Allocated: 0.2800941467285156  GigaBytes
Max Memory Allocated: 1.3091506958007812  GigaBytes

torch.Size([2418, 1433])
torch.Size([2335, 128])
torch.Size([2090, 128])
torch.Size([1552, 128])
torch.Size([817, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6854248046875 GB
    Memory Allocated: 1.269057273864746  GigaBytes
Max Memory Allocated: 1.3091506958007812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6854248046875 GB
    Memory Allocated: 0.28007984161376953  GigaBytes
Max Memory Allocated: 1.3091506958007812  GigaBytes

torch.Size([2472, 1433])
torch.Size([2373, 128])
torch.Size([2081, 128])
torch.Size([1370, 128])
torch.Size([605, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6854248046875 GB
    Memory Allocated: 1.2792668342590332  GigaBytes
Max Memory Allocated: 1.3091506958007812  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.054388225078582764 |0.001213371753692627 |0.3162289261817932 |0.00013709068298339844 |0.43483251333236694 |0.016531705856323242 |
----------------------------------------------------------pseudo_mini_loss sum 2.677511215209961
Total (block generation + training)time/epoch 3.51336407661438
Training time/epoch 3.306131362915039
Training time without block to device /epoch 3.3012778759002686
Training time without total dataloading part /epoch 3.0213258266448975
load block tensor time/epoch 0.21755290031433105
block to device time/epoch 0.004853487014770508
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37387
Number of first layer input nodes during this epoch:  9784
