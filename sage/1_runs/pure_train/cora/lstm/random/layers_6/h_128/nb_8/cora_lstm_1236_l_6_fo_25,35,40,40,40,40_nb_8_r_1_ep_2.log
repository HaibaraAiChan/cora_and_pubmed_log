main start at this time 1648433771.4388826
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0838623046875 GB
    Memory Allocated: 0.06687688827514648  GigaBytes
Max Memory Allocated: 0.06687688827514648  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0015082359313964844
random selection method range initialization spend 0.00021886825561523438
time for parepare:  6.771087646484375e-05
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.003618001937866211
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.9577484130859375e-05
----------------------check_connections_block total spend ----------------------------- 0.00563359260559082
generate_one_block  0.0014569759368896484
generate_one_block  0.0010569095611572266
generate_one_block  0.001074075698852539
generate_one_block  0.0010404586791992188
generate_one_block  0.0010390281677246094
generate_one_block  0.0010612010955810547
generate_one_block  0.0011043548583984375
generate_one_block  0.001035451889038086
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005178451538085938
gen group dst list time:  6.008148193359375e-05
time for parepare:  0.0001418590545654297
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00020694732666015625
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00022864341735839844
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.0002942085266113281
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.000179290771484375
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001976490020751953
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00028204917907714844
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002918243408203125
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.0001888275146484375
----------------------check_connections_block total spend ----------------------------- 0.00413060188293457
generate_one_block  0.001283407211303711
generate_one_block  0.0012822151184082031
generate_one_block  0.0013704299926757812
generate_one_block  0.0012164115905761719
generate_one_block  0.0012469291687011719
generate_one_block  0.0014312267303466797
generate_one_block  0.001367330551147461
generate_one_block  0.0011796951293945312
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006973743438720703
gen group dst list time:  0.00010728836059570312
time for parepare:  0.00021219253540039062
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0002758502960205078
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0006999969482421875
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  9.894371032714844e-05
r_  generation:  0.0008406639099121094
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.00011301040649414062
r_  generation:  0.000982046127319336
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0005843639373779297
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0006966590881347656
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  0.000102996826171875
r_  generation:  0.0010221004486083984
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  0.00010752677917480469
r_  generation:  0.0009458065032958984
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0006809234619140625
----------------------check_connections_block total spend ----------------------------- 0.011017322540283203
generate_one_block  0.0018901824951171875
generate_one_block  0.0020067691802978516
generate_one_block  0.0020720958709716797
generate_one_block  0.0016546249389648438
generate_one_block  0.001773834228515625
generate_one_block  0.002077341079711914
generate_one_block  0.0019829273223876953
generate_one_block  0.0016968250274658203
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007534027099609375
gen group dst list time:  0.00019979476928710938
time for parepare:  0.00018405914306640625
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00036072731018066406
mini_batch_src_global generation:  0.0001933574676513672
r_  generation:  0.0017325878143310547
local_output_nid generation:  9.202957153320312e-05
local_in_edges_tensor generation:  0.0002665519714355469
mini_batch_src_global generation:  0.00022482872009277344
r_  generation:  0.001903533935546875
local_output_nid generation:  0.00010466575622558594
local_in_edges_tensor generation:  0.0002696514129638672
mini_batch_src_global generation:  0.0001952648162841797
r_  generation:  0.0020339488983154297
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  0.0001614093780517578
r_  generation:  0.0015716552734375
local_output_nid generation:  8.034706115722656e-05
local_in_edges_tensor generation:  0.00024056434631347656
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.0016391277313232422
local_output_nid generation:  9.799003601074219e-05
local_in_edges_tensor generation:  0.00026917457580566406
mini_batch_src_global generation:  0.00019693374633789062
r_  generation:  0.0021038055419921875
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.00025081634521484375
mini_batch_src_global generation:  0.00018143653869628906
r_  generation:  0.0017960071563720703
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  0.00015425682067871094
r_  generation:  0.0015184879302978516
----------------------check_connections_block total spend ----------------------------- 0.02233433723449707
generate_one_block  0.002962827682495117
generate_one_block  0.003073453903198242
generate_one_block  0.0033197402954101562
generate_one_block  0.002644777297973633
generate_one_block  0.0027008056640625
generate_one_block  0.0032291412353515625
generate_one_block  0.0029861927032470703
generate_one_block  0.002703428268432617
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007586479187011719
gen group dst list time:  0.0003883838653564453
time for parepare:  0.0001919269561767578
local_output_nid generation:  0.00012159347534179688
local_in_edges_tensor generation:  0.0004642009735107422
mini_batch_src_global generation:  0.0002377033233642578
r_  generation:  0.0026760101318359375
local_output_nid generation:  0.00013875961303710938
local_in_edges_tensor generation:  0.00033211708068847656
mini_batch_src_global generation:  0.0003077983856201172
r_  generation:  0.002719879150390625
local_output_nid generation:  0.00014066696166992188
local_in_edges_tensor generation:  0.0003306865692138672
mini_batch_src_global generation:  0.00023984909057617188
r_  generation:  0.002813100814819336
local_output_nid generation:  0.00013518333435058594
local_in_edges_tensor generation:  0.00031280517578125
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.002657651901245117
local_output_nid generation:  0.00013136863708496094
local_in_edges_tensor generation:  0.0003333091735839844
mini_batch_src_global generation:  0.00021409988403320312
r_  generation:  0.0024776458740234375
local_output_nid generation:  0.00013065338134765625
local_in_edges_tensor generation:  0.0003066062927246094
mini_batch_src_global generation:  0.0002243518829345703
r_  generation:  0.002633333206176758
local_output_nid generation:  0.0001423358917236328
local_in_edges_tensor generation:  0.0003039836883544922
mini_batch_src_global generation:  0.00022673606872558594
r_  generation:  0.002582073211669922
local_output_nid generation:  0.00012063980102539062
local_in_edges_tensor generation:  0.0002872943878173828
mini_batch_src_global generation:  0.0002162456512451172
r_  generation:  0.002376079559326172
----------------------check_connections_block total spend ----------------------------- 0.03158307075500488
generate_one_block  0.0037822723388671875
generate_one_block  0.004270076751708984
generate_one_block  0.00456690788269043
generate_one_block  0.003698587417602539
generate_one_block  0.003584623336791992
generate_one_block  0.003770589828491211
generate_one_block  0.0037636756896972656
generate_one_block  0.0035753250122070312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008034706115722656
gen group dst list time:  0.0004742145538330078
time for parepare:  0.00019216537475585938
local_output_nid generation:  0.0001518726348876953
local_in_edges_tensor generation:  0.0005168914794921875
mini_batch_src_global generation:  0.0002560615539550781
r_  generation:  0.0030875205993652344
local_output_nid generation:  0.0001647472381591797
local_in_edges_tensor generation:  0.0003681182861328125
mini_batch_src_global generation:  0.00031566619873046875
r_  generation:  0.0030701160430908203
local_output_nid generation:  0.00016450881958007812
local_in_edges_tensor generation:  0.00036263465881347656
mini_batch_src_global generation:  0.0002689361572265625
r_  generation:  0.0031349658966064453
local_output_nid generation:  0.0001666545867919922
local_in_edges_tensor generation:  0.00036025047302246094
mini_batch_src_global generation:  0.00025916099548339844
r_  generation:  0.0031290054321289062
local_output_nid generation:  0.0001628398895263672
local_in_edges_tensor generation:  0.0003540515899658203
mini_batch_src_global generation:  0.0002570152282714844
r_  generation:  0.0030481815338134766
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.00035953521728515625
mini_batch_src_global generation:  0.0002598762512207031
r_  generation:  0.002946615219116211
local_output_nid generation:  0.0001552104949951172
local_in_edges_tensor generation:  0.00034165382385253906
mini_batch_src_global generation:  0.00025010108947753906
r_  generation:  0.0029664039611816406
local_output_nid generation:  0.00015020370483398438
local_in_edges_tensor generation:  0.00033211708068847656
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.0028533935546875
----------------------check_connections_block total spend ----------------------------- 0.03614163398742676
generate_one_block  0.0053784847259521484
generate_one_block  0.004096269607543945
generate_one_block  0.0040700435638427734
generate_one_block  0.004046916961669922
generate_one_block  0.004017829895019531
generate_one_block  0.004096031188964844
generate_one_block  0.0049860477447509766
generate_one_block  0.004035472869873047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0838623046875 GB
    Memory Allocated: 0.06687688827514648  GigaBytes
Max Memory Allocated: 0.06687688827514648  GigaBytes

connection checking time:  0.10520696640014648
block generation total time  0.11489176750183105
average batch blocks generation time:  0.014361470937728882
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.08073997497558594  GigaBytes
Max Memory Allocated: 0.08073997497558594  GigaBytes

torch.Size([2382, 1433])
torch.Size([2214, 128])
torch.Size([1808, 128])
torch.Size([1051, 128])
torch.Size([362, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 0.9995384216308594  GigaBytes
Max Memory Allocated: 0.999600887298584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3514404296875 GB
    Memory Allocated: 0.14591217041015625  GigaBytes
Max Memory Allocated: 1.000471591949463  GigaBytes

torch.Size([2363, 1433])
torch.Size([2193, 128])
torch.Size([1861, 128])
torch.Size([1174, 128])
torch.Size([447, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4119873046875 GB
    Memory Allocated: 1.066514492034912  GigaBytes
Max Memory Allocated: 1.066572666168213  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.14598560333251953  GigaBytes
Max Memory Allocated: 1.06744384765625  GigaBytes

torch.Size([2375, 1433])
torch.Size([2245, 128])
torch.Size([1914, 128])
torch.Size([1266, 128])
torch.Size([554, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4530029296875 GB
    Memory Allocated: 1.0874991416931152  GigaBytes
Max Memory Allocated: 1.0875730514526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4530029296875 GB
    Memory Allocated: 0.14695310592651367  GigaBytes
Max Memory Allocated: 1.0884137153625488  GigaBytes

torch.Size([2412, 1433])
torch.Size([2222, 128])
torch.Size([1758, 128])
torch.Size([927, 128])
torch.Size([290, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 1.0634546279907227  GigaBytes
Max Memory Allocated: 1.0884137153625488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.14568853378295898  GigaBytes
Max Memory Allocated: 1.0884137153625488  GigaBytes

torch.Size([2324, 1433])
torch.Size([2161, 128])
torch.Size([1744, 128])
torch.Size([973, 128])
torch.Size([379, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 1.0435404777526855  GigaBytes
Max Memory Allocated: 1.0884137153625488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.14697980880737305  GigaBytes
Max Memory Allocated: 1.0884137153625488  GigaBytes

torch.Size([2379, 1433])
torch.Size([2229, 128])
torch.Size([1951, 128])
torch.Size([1324, 128])
torch.Size([565, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5076904296875 GB
    Memory Allocated: 1.0902409553527832  GigaBytes
Max Memory Allocated: 1.090311050415039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5076904296875 GB
    Memory Allocated: 0.14697790145874023  GigaBytes
Max Memory Allocated: 1.091160774230957  GigaBytes

torch.Size([2447, 1433])
torch.Size([2311, 128])
torch.Size([1914, 128])
torch.Size([1217, 128])
torch.Size([492, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5076904296875 GB
    Memory Allocated: 1.114346981048584  GigaBytes
Max Memory Allocated: 1.1144280433654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5076904296875 GB
    Memory Allocated: 0.1469559669494629  GigaBytes
Max Memory Allocated: 1.1152563095092773  GigaBytes

torch.Size([2403, 1433])
torch.Size([2201, 128])
torch.Size([1724, 128])
torch.Size([967, 128])
torch.Size([350, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5076904296875 GB
    Memory Allocated: 1.059770107269287  GigaBytes
Max Memory Allocated: 1.1152563095092773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.062440454959869385 |0.04444018006324768 |0.34954968094825745 |0.00015738606452941895 |0.38633450865745544 |0.020887136459350586 |
----------------------------------------------------------pseudo_mini_loss sum 3.4447543621063232
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  64633
Number of first layer input nodes during this epoch:  19085
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6014404296875 GB
    Memory Allocated: 0.28039026260375977  GigaBytes
Max Memory Allocated: 1.1152563095092773  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007257461547851562
random selection method range initialization spend 0.000164031982421875
time for parepare:  8.678436279296875e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  6.437301635742188e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.125999450683594e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.0994415283203125e-05
----------------------check_connections_block total spend ----------------------------- 0.0021734237670898438
generate_one_block  0.0012426376342773438
generate_one_block  0.0011429786682128906
generate_one_block  0.0011358261108398438
generate_one_block  0.0011260509490966797
generate_one_block  0.0010912418365478516
generate_one_block  0.0011408329010009766
generate_one_block  0.0010781288146972656
generate_one_block  0.0010464191436767578
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005676746368408203
gen group dst list time:  6.747245788574219e-05
time for parepare:  0.0001952648162841797
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0001838207244873047
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.00024890899658203125
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0002834796905517578
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0003178119659423828
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.00026607513427734375
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00026869773864746094
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00018858909606933594
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0001666545867919922
----------------------check_connections_block total spend ----------------------------- 0.00455927848815918
generate_one_block  0.0014417171478271484
generate_one_block  0.0014128684997558594
generate_one_block  0.0014462471008300781
generate_one_block  0.001447916030883789
generate_one_block  0.0014269351959228516
generate_one_block  0.0014100074768066406
generate_one_block  0.0012497901916503906
generate_one_block  0.0012392997741699219
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007998943328857422
gen group dst list time:  0.00011706352233886719
time for parepare:  0.00023746490478515625
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00030350685119628906
mini_batch_src_global generation:  9.632110595703125e-05
r_  generation:  0.0006351470947265625
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.00015211105346679688
r_  generation:  0.0008974075317382812
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.0001304149627685547
r_  generation:  0.0009505748748779297
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  0.00011849403381347656
r_  generation:  0.0008995532989501953
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  0.00011920928955078125
r_  generation:  0.0008780956268310547
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.00011754035949707031
r_  generation:  0.0009131431579589844
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.00010561943054199219
r_  generation:  0.0006632804870605469
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.00063323974609375
----------------------check_connections_block total spend ----------------------------- 0.011555671691894531
generate_one_block  0.0019316673278808594
generate_one_block  0.0021343231201171875
generate_one_block  0.002238035202026367
generate_one_block  0.0020813941955566406
generate_one_block  0.002071857452392578
generate_one_block  0.0022513866424560547
generate_one_block  0.0018506050109863281
generate_one_block  0.0017383098602294922
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008132457733154297
gen group dst list time:  0.00021529197692871094
time for parepare:  0.00021529197692871094
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.00043272972106933594
mini_batch_src_global generation:  0.00019073486328125
r_  generation:  0.0016090869903564453
local_output_nid generation:  0.00010347366333007812
local_in_edges_tensor generation:  0.0002646446228027344
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.0018529891967773438
local_output_nid generation:  0.00011372566223144531
local_in_edges_tensor generation:  0.00027823448181152344
mini_batch_src_global generation:  0.00021719932556152344
r_  generation:  0.0021092891693115234
local_output_nid generation:  0.0001049041748046875
local_in_edges_tensor generation:  0.0002589225769042969
mini_batch_src_global generation:  0.00018286705017089844
r_  generation:  0.0018973350524902344
local_output_nid generation:  9.822845458984375e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  0.00017380714416503906
r_  generation:  0.0018045902252197266
local_output_nid generation:  0.00010895729064941406
local_in_edges_tensor generation:  0.00026607513427734375
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.0019767284393310547
local_output_nid generation:  8.702278137207031e-05
local_in_edges_tensor generation:  0.0002396106719970703
mini_batch_src_global generation:  0.0001690387725830078
r_  generation:  0.0016546249389648438
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.00022745132446289062
mini_batch_src_global generation:  0.0001647472381591797
r_  generation:  0.0014071464538574219
----------------------check_connections_block total spend ----------------------------- 0.02266693115234375
generate_one_block  0.0030164718627929688
generate_one_block  0.0030798912048339844
generate_one_block  0.0033130645751953125
generate_one_block  0.003095865249633789
generate_one_block  0.002964019775390625
generate_one_block  0.003283977508544922
generate_one_block  0.0029077529907226562
generate_one_block  0.002787351608276367
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008285045623779297
gen group dst list time:  0.0003662109375
time for parepare:  0.0002143383026123047
local_output_nid generation:  0.00015544891357421875
local_in_edges_tensor generation:  0.0005390644073486328
mini_batch_src_global generation:  0.00023818016052246094
r_  generation:  0.0026514530181884766
local_output_nid generation:  0.00017189979553222656
local_in_edges_tensor generation:  0.00036263465881347656
mini_batch_src_global generation:  0.0003139972686767578
r_  generation:  0.002796173095703125
local_output_nid generation:  0.00017023086547851562
local_in_edges_tensor generation:  0.00035500526428222656
mini_batch_src_global generation:  0.0002677440643310547
r_  generation:  0.002870798110961914
local_output_nid generation:  0.0001590251922607422
local_in_edges_tensor generation:  0.0003457069396972656
mini_batch_src_global generation:  0.0002415180206298828
r_  generation:  0.0027496814727783203
local_output_nid generation:  0.00015664100646972656
local_in_edges_tensor generation:  0.00034999847412109375
mini_batch_src_global generation:  0.00023555755615234375
r_  generation:  0.002641439437866211
local_output_nid generation:  0.00016355514526367188
local_in_edges_tensor generation:  0.00036454200744628906
mini_batch_src_global generation:  0.00023651123046875
r_  generation:  0.002615690231323242
local_output_nid generation:  0.00015306472778320312
local_in_edges_tensor generation:  0.0003142356872558594
mini_batch_src_global generation:  0.0002262592315673828
r_  generation:  0.002519845962524414
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.0003039836883544922
mini_batch_src_global generation:  0.00022339820861816406
r_  generation:  0.002341747283935547
----------------------check_connections_block total spend ----------------------------- 0.032732248306274414
generate_one_block  0.0041162967681884766
generate_one_block  0.004312276840209961
generate_one_block  0.004067182540893555
generate_one_block  0.0039501190185546875
generate_one_block  0.003813028335571289
generate_one_block  0.003933429718017578
generate_one_block  0.0039331912994384766
generate_one_block  0.0037453174591064453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007982254028320312
gen group dst list time:  0.0004639625549316406
time for parepare:  0.0002162456512451172
local_output_nid generation:  0.00019073486328125
local_in_edges_tensor generation:  0.0005331039428710938
mini_batch_src_global generation:  0.00024962425231933594
r_  generation:  0.0031595230102539062
local_output_nid generation:  0.00020170211791992188
local_in_edges_tensor generation:  0.00038743019104003906
mini_batch_src_global generation:  0.00033855438232421875
r_  generation:  0.0032279491424560547
local_output_nid generation:  0.00020122528076171875
local_in_edges_tensor generation:  0.00037789344787597656
mini_batch_src_global generation:  0.0002715587615966797
r_  generation:  0.003207683563232422
local_output_nid generation:  0.00020074844360351562
local_in_edges_tensor generation:  0.00037217140197753906
mini_batch_src_global generation:  0.00026535987854003906
r_  generation:  0.0032134056091308594
local_output_nid generation:  0.0001926422119140625
local_in_edges_tensor generation:  0.0003657341003417969
mini_batch_src_global generation:  0.0002605915069580078
r_  generation:  0.003101825714111328
local_output_nid generation:  0.00019550323486328125
local_in_edges_tensor generation:  0.00036525726318359375
mini_batch_src_global generation:  0.0002727508544921875
r_  generation:  0.0028960704803466797
local_output_nid generation:  0.00018596649169921875Using backend: pytorch

local_in_edges_tensor generation:  0.00035572052001953125
mini_batch_src_global generation:  0.00024700164794921875
r_  generation:  0.002939462661743164
local_output_nid generation:  0.0001838207244873047
local_in_edges_tensor generation:  0.0003426074981689453
mini_batch_src_global generation:  0.000247955322265625
r_  generation:  0.0029251575469970703
----------------------check_connections_block total spend ----------------------------- 0.03722810745239258
generate_one_block  0.00479435920715332
generate_one_block  0.004399299621582031
generate_one_block  0.004275798797607422
generate_one_block  0.004304170608520508
generate_one_block  0.004152774810791016
generate_one_block  0.004169940948486328
generate_one_block  0.004952669143676758
generate_one_block  0.004246950149536133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6014404296875 GB
    Memory Allocated: 0.28039026260375977  GigaBytes
Max Memory Allocated: 1.1152563095092773  GigaBytes

connection checking time:  0.10874223709106445
block generation total time  0.1189875602722168
average batch blocks generation time:  0.0148734450340271
block dataloader generation time/epoch 0.3378260135650635
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6014404296875 GB
    Memory Allocated: 0.28003931045532227  GigaBytes
Max Memory Allocated: 1.1152563095092773  GigaBytes

torch.Size([2382, 1433])
torch.Size([2204, 128])
torch.Size([1729, 128])
torch.Size([928, 128])
torch.Size([335, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6014404296875 GB
    Memory Allocated: 1.1902241706848145  GigaBytes
Max Memory Allocated: 1.1902790069580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6014404296875 GB
    Memory Allocated: 0.280057430267334  GigaBytes
Max Memory Allocated: 1.191157341003418  GigaBytes

torch.Size([2417, 1433])
torch.Size([2262, 128])
torch.Size([1852, 128])
torch.Size([1088, 128])
torch.Size([442, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6014404296875 GB
    Memory Allocated: 1.218656063079834  GigaBytes
Max Memory Allocated: 1.2187223434448242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6014404296875 GB
    Memory Allocated: 0.28006696701049805  GigaBytes
Max Memory Allocated: 1.2195816040039062  GigaBytes

torch.Size([2388, 1433])
torch.Size([2268, 128])
torch.Size([1920, 128])
torch.Size([1257, 128])
torch.Size([502, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.2259750366210938  GigaBytes
Max Memory Allocated: 1.2260494232177734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2800593376159668  GigaBytes
Max Memory Allocated: 1.2268900871276855  GigaBytes

torch.Size([2416, 1433])
torch.Size([2254, 128])
torch.Size([1818, 128])
torch.Size([1153, 128])
torch.Size([441, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.2213263511657715  GigaBytes
Max Memory Allocated: 1.2268900871276855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2789926528930664  GigaBytes
Max Memory Allocated: 1.2268900871276855  GigaBytes

torch.Size([2363, 1433])
torch.Size([2167, 128])
torch.Size([1749, 128])
torch.Size([1086, 128])
torch.Size([467, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1892542839050293  GigaBytes
Max Memory Allocated: 1.2268900871276855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2789435386657715  GigaBytes
Max Memory Allocated: 1.2268900871276855  GigaBytes

torch.Size([2352, 1433])
torch.Size([2207, 128])
torch.Size([1894, 128])
torch.Size([1203, 128])
torch.Size([497, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.2069082260131836  GigaBytes
Max Memory Allocated: 1.2268900871276855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.2800450325012207  GigaBytes
Max Memory Allocated: 1.2268900871276855  GigaBytes

torch.Size([2385, 1433])
torch.Size([2220, 128])
torch.Size([1783, 128])
torch.Size([959, 128])
torch.Size([326, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1965765953063965  GigaBytes
Max Memory Allocated: 1.2268900871276855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.28003740310668945  GigaBytes
Max Memory Allocated: 1.2268900871276855  GigaBytes

torch.Size([2416, 1433])
torch.Size([2208, 128])
torch.Size([1643, 128])
torch.Size([866, 128])
torch.Size([317, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1876683235168457  GigaBytes
Max Memory Allocated: 1.2268900871276855  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06208878755569458 |0.0013122260570526123 |0.2873038947582245 |0.00013118982315063477 |0.3860020637512207 |0.017066001892089844 |
----------------------------------------------------------pseudo_mini_loss sum 2.445802927017212
Total (block generation + training)time/epoch 6.323616027832031
Training time/epoch 5.985295534133911
Training time without block to device /epoch 5.97479772567749
Training time without total dataloading part /epoch 5.4045631885528564
load block tensor time/epoch 0.49671030044555664
block to device time/epoch 0.010497808456420898
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  63918
Number of first layer input nodes during this epoch:  19119
