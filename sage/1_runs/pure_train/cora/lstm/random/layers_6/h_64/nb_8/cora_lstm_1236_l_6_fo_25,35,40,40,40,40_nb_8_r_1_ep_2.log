main start at this time 1648433689.2292063
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06398439407348633  GigaBytes
Max Memory Allocated: 0.06398439407348633  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0010526180267333984
random selection method range initialization spend 0.00021076202392578125
time for parepare:  7.152557373046875e-05
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.002335786819458008
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.482269287109375e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.888938903808594e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.62396240234375e-05
----------------------check_connections_block total spend ----------------------------- 0.0042841434478759766
generate_one_block  0.0012938976287841797
generate_one_block  0.0010690689086914062
generate_one_block  0.0010669231414794922
generate_one_block  0.0010445117950439453
generate_one_block  0.0010924339294433594
generate_one_block  0.0010590553283691406
generate_one_block  0.0011286735534667969
generate_one_block  0.0010619163513183594
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005159378051757812
gen group dst list time:  6.008148193359375e-05
time for parepare:  0.00014901161193847656
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00021767616271972656
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00021386146545410156
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0002243518829345703
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001544952392578125
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00026917457580566406
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00022721290588378906
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.00033211708068847656
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00022554397583007812
----------------------check_connections_block total spend ----------------------------- 0.004118919372558594
generate_one_block  0.0012993812561035156
generate_one_block  0.001280069351196289
generate_one_block  0.0012764930725097656
generate_one_block  0.0012087821960449219
generate_one_block  0.0013580322265625
generate_one_block  0.0013434886932373047
generate_one_block  0.0014181137084960938
generate_one_block  0.0012807846069335938
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006358623504638672
gen group dst list time:  0.0001049041748046875
time for parepare:  0.0002086162567138672
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00023293495178222656
mini_batch_src_global generation:  8.845329284667969e-05
r_  generation:  0.0007243156433105469
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0007643699645996094
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0007193088531494141
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0005853176116943359
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  9.107589721679688e-05
r_  generation:  0.0009095668792724609
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  9.417533874511719e-05
r_  generation:  0.0008139610290527344
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  0.00010967254638671875
r_  generation:  0.0010564327239990234
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0007431507110595703
----------------------check_connections_block total spend ----------------------------- 0.01065373420715332
generate_one_block  0.0018584728240966797
generate_one_block  0.0019419193267822266
generate_one_block  0.0017518997192382812
generate_one_block  0.0016341209411621094
generate_one_block  0.0019178390502929688
generate_one_block  0.0018351078033447266
generate_one_block  0.0020499229431152344
generate_one_block  0.0017099380493164062
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007083415985107422
gen group dst list time:  0.00019621849060058594
time for parepare:  0.00019979476928710938
local_output_nid generation:  6.628036499023438e-05
local_in_edges_tensor generation:  0.0003180503845214844
mini_batch_src_global generation:  0.00016736984252929688
r_  generation:  0.0015616416931152344
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.0002491474151611328
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.0018270015716552734
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.00023555755615234375
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0016896724700927734
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  0.0001461505889892578
r_  generation:  0.0014734268188476562
local_output_nid generation:  8.988380432128906e-05
local_in_edges_tensor generation:  0.00026416778564453125
mini_batch_src_global generation:  0.00017404556274414062
r_  generation:  0.001968860626220703
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  0.00017976760864257812
r_  generation:  0.0019342899322509766
local_output_nid generation:  0.00010061264038085938
local_in_edges_tensor generation:  0.00026988983154296875
mini_batch_src_global generation:  0.00020623207092285156
r_  generation:  0.002180814743041992
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.00023674964904785156
mini_batch_src_global generation:  0.0001709461212158203
r_  generation:  0.0017075538635253906
----------------------check_connections_block total spend ----------------------------- 0.022179841995239258
generate_one_block  0.0027904510498046875
generate_one_block  0.002917051315307617
generate_one_block  0.0028231143951416016
generate_one_block  0.002481222152709961
generate_one_block  0.0034971237182617188
generate_one_block  0.002956390380859375
generate_one_block  0.0031266212463378906
generate_one_block  0.0027289390563964844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007383823394775391
gen group dst list time:  0.0004203319549560547
time for parepare:  0.00019979476928710938
local_output_nid generation:  0.00012183189392089844
local_in_edges_tensor generation:  0.0004184246063232422
mini_batch_src_global generation:  0.0002384185791015625
r_  generation:  0.002639293670654297
local_output_nid generation:  0.00014090538024902344
local_in_edges_tensor generation:  0.0003330707550048828
mini_batch_src_global generation:  0.0003085136413574219
r_  generation:  0.0028090476989746094
local_output_nid generation:  0.00013685226440429688
local_in_edges_tensor generation:  0.0003192424774169922
mini_batch_src_global generation:  0.00023412704467773438
r_  generation:  0.002737283706665039
local_output_nid generation:  0.0001251697540283203
local_in_edges_tensor generation:  0.00030231475830078125
mini_batch_src_global generation:  0.00022101402282714844
r_  generation:  0.0025026798248291016
local_output_nid generation:  0.00013637542724609375
local_in_edges_tensor generation:  0.0003299713134765625
mini_batch_src_global generation:  0.00023794174194335938
r_  generation:  0.002844572067260742
local_output_nid generation:  0.00013971328735351562
local_in_edges_tensor generation:  0.00033092498779296875
mini_batch_src_global generation:  0.00024175643920898438
r_  generation:  0.002803325653076172
local_output_nid generation:  0.00013327598571777344
local_in_edges_tensor generation:  0.0003077983856201172
mini_batch_src_global generation:  0.0002276897430419922
r_  generation:  0.002655506134033203
local_output_nid generation:  0.00012373924255371094
local_in_edges_tensor generation:  0.00029015541076660156
mini_batch_src_global generation:  0.0002162456512451172
r_  generation:  0.0024480819702148438
----------------------check_connections_block total spend ----------------------------- 0.03221893310546875
generate_one_block  0.0037839412689208984
generate_one_block  0.004968881607055664
generate_one_block  0.0036537647247314453
generate_one_block  0.0034284591674804688
generate_one_block  0.0037093162536621094
generate_one_block  0.0037255287170410156
generate_one_block  0.0038137435913085938
generate_one_block  0.0036194324493408203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007603168487548828
gen group dst list time:  0.0004756450653076172
time for parepare:  0.00019979476928710938
local_output_nid generation:  0.00015926361083984375
local_in_edges_tensor generation:  0.0005061626434326172
mini_batch_src_global generation:  0.0002605915069580078
r_  generation:  0.0032346248626708984
local_output_nid generation:  0.00017213821411132812
local_in_edges_tensor generation:  0.0003674030303955078
mini_batch_src_global generation:  0.00032448768615722656
r_  generation:  0.003188610076904297
local_output_nid generation:  0.00017023086547851562
local_in_edges_tensor generation:  0.00036597251892089844
mini_batch_src_global generation:  0.0002703666687011719
r_  generation:  0.003221273422241211
local_output_nid generation:  0.00016045570373535156
local_in_edges_tensor generation:  0.0003561973571777344
mini_batch_src_global generation:  0.0002560615539550781
r_  generation:  0.0030868053436279297
local_output_nid generation:  0.00016689300537109375
local_in_edges_tensor generation:  0.00036525726318359375
mini_batch_src_global generation:  0.00026416778564453125
r_  generation:  0.003168344497680664
local_output_nid generation:  0.00016641616821289062
local_in_edges_tensor generation:  0.0003311634063720703
mini_batch_src_global generation:  0.00023984909057617188
r_  generation:  0.0028638839721679688
local_output_nid generation:  0.00015211105346679688
local_in_edges_tensor generation:  0.0003368854522705078
mini_batch_src_global generation:  0.0002446174621582031
r_  generation:  0.002940654754638672
local_output_nid generation:  0.00015044212341308594
local_in_edges_tensor generation:  0.0003275871276855469
mini_batch_src_global generation:  0.00024628639221191406
r_  generation:  0.0028264522552490234
----------------------check_connections_block total spend ----------------------------- 0.036423683166503906
generate_one_block  0.005309581756591797
generate_one_block  0.004025936126708984
generate_one_block  0.0040051937103271484
generate_one_block  0.004001140594482422
generate_one_block  0.004078388214111328
generate_one_block  0.004808664321899414
generate_one_block  0.004089832305908203
generate_one_block  0.003960609436035156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06398439407348633  GigaBytes
Max Memory Allocated: 0.06398439407348633  GigaBytes

connection checking time:  0.10559511184692383
block generation total time  0.11346769332885742
average batch blocks generation time:  0.014183461666107178
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07784080505371094  GigaBytes
Max Memory Allocated: 0.07784080505371094  GigaBytes

torch.Size([2463, 1433])
torch.Size([2249, 64])
torch.Size([1715, 64])
torch.Size([914, 64])
torch.Size([386, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2108154296875 GB
    Memory Allocated: 0.9444494247436523  GigaBytes
Max Memory Allocated: 0.9573249816894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.1401534080505371  GigaBytes
Max Memory Allocated: 0.9944047927856445  GigaBytes

torch.Size([2369, 1433])
torch.Size([2232, 64])
torch.Size([1857, 64])
torch.Size([1096, 64])
torch.Size([413, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.9964051246643066  GigaBytes
Max Memory Allocated: 1.0022258758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 0.1411738395690918  GigaBytes
Max Memory Allocated: 1.039379596710205  GigaBytes

torch.Size([2388, 1433])
torch.Size([2227, 64])
torch.Size([1761, 64])
torch.Size([953, 64])
torch.Size([356, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4412841796875 GB
    Memory Allocated: 0.9999909400939941  GigaBytes
Max Memory Allocated: 1.039379596710205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4412841796875 GB
    Memory Allocated: 0.1399831771850586  GigaBytes
Max Memory Allocated: 1.0462393760681152  GigaBytes

torch.Size([2341, 1433])
torch.Size([2122, 64])
torch.Size([1606, 64])
torch.Size([838, 64])
torch.Size([290, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4412841796875 GB
    Memory Allocated: 0.9647231101989746  GigaBytes
Max Memory Allocated: 1.0462393760681152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4412841796875 GB
    Memory Allocated: 0.14014053344726562  GigaBytes
Max Memory Allocated: 1.0462393760681152  GigaBytes

torch.Size([2365, 1433])
torch.Size([2233, 64])
torch.Size([1880, 64])
torch.Size([1178, 64])
torch.Size([471, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 1.0042166709899902  GigaBytes
Max Memory Allocated: 1.0462393760681152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 0.14118337631225586  GigaBytes
Max Memory Allocated: 1.0462393760681152  GigaBytes

torch.Size([2385, 1433])
torch.Size([2247, 64])
torch.Size([1890, 64])
torch.Size([1155, 64])
torch.Size([413, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 1.0090136528015137  GigaBytes
Max Memory Allocated: 1.0462393760681152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 0.14120244979858398  GigaBytes
Max Memory Allocated: 1.0491480827331543  GigaBytes

torch.Size([2424, 1433])
torch.Size([2311, 64])
torch.Size([1986, 64])
torch.Size([1336, 64])
torch.Size([560, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4549560546875 GB
    Memory Allocated: 1.0350604057312012  GigaBytes
Max Memory Allocated: 1.0491480827331543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.14014339447021484  GigaBytes
Max Memory Allocated: 1.0658693313598633  GigaBytes

torch.Size([2368, 1433])
torch.Size([2208, 64])
torch.Size([1811, 64])
torch.Size([989, 64])
torch.Size([406, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.9892926216125488  GigaBytes
Max Memory Allocated: 1.0658693313598633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061707109212875366 |0.043429404497146606 |0.33777448534965515 |0.00014764070510864258 |0.37960946559906006 |0.020838260650634766 |
----------------------------------------------------------pseudo_mini_loss sum 3.462367057800293
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  63941
Number of first layer input nodes during this epoch:  19103
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.26780128479003906  GigaBytes
Max Memory Allocated: 1.0658693313598633  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005884170532226562
random selection method range initialization spend 0.00015115737915039062
time for parepare:  9.250640869140625e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  3.266334533691406e-05
----------------------check_connections_block total spend ----------------------------- 0.0021288394927978516
generate_one_block  0.0012099742889404297
generate_one_block  0.0011281967163085938
generate_one_block  0.0011372566223144531
generate_one_block  0.0010938644409179688
generate_one_block  0.001142740249633789
generate_one_block  0.0011065006256103516
generate_one_block  0.0011014938354492188
generate_one_block  0.0010755062103271484
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005655288696289062
gen group dst list time:  6.866455078125e-05
time for parepare:  0.0001952648162841797
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00023627281188964844
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0002772808074951172
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0003159046173095703
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.00022983551025390625
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.00034999847412109375
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0002467632293701172
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.0002155303955078125
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001804828643798828
----------------------check_connections_block total spend ----------------------------- 0.004751443862915039
generate_one_block  0.001531839370727539
generate_one_block  0.0014259815216064453
generate_one_block  0.0014603137969970703
generate_one_block  0.001331329345703125
generate_one_block  0.001505136489868164
generate_one_block  0.0013742446899414062
generate_one_block  0.0013172626495361328
generate_one_block  0.0011627674102783203
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007154941558837891
gen group dst list time:  0.00011968612670898438
time for parepare:  0.00024580955505371094
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.00032973289489746094
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0007891654968261719
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00012969970703125
r_  generation:  0.00086212158203125
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.0001347064971923828
r_  generation:  0.0010230541229248047
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0007116794586181641
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00013113021850585938
r_  generation:  0.001043081283569336
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  0.00011992454528808594
r_  generation:  0.0008087158203125
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.0007293224334716797
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.0006906986236572266
----------------------check_connections_block total spend ----------------------------- 0.011879205703735352
generate_one_block  0.0020990371704101562
generate_one_block  0.0020647048950195312
generate_one_block  0.0021889209747314453
generate_one_block  0.001779317855834961
generate_one_block  0.0021746158599853516
generate_one_block  0.0020151138305664062
generate_one_block  0.0018410682678222656
generate_one_block  0.0018086433410644531
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007638931274414062
gen group dst list time:  0.00022268295288085938
time for parepare:  0.00022292137145996094
local_output_nid generation:  9.369850158691406e-05
local_in_edges_tensor generation:  0.0004227161407470703
mini_batch_src_global generation:  0.0001995563507080078
r_  generation:  0.0017728805541992188
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.00025463104248046875
mini_batch_src_global generation:  0.00021338462829589844
r_  generation:  0.0017666816711425781
local_output_nid generation:  0.00012183189392089844
local_in_edges_tensor generation:  0.0002913475036621094
mini_batch_src_global generation:  0.00023055076599121094
r_  generation:  0.0022306442260742188
local_output_nid generation:  8.7738037109375e-05
local_in_edges_tensor generation:  0.00023794174194335938
mini_batch_src_global generation:  0.0001685619354248047
r_  generation:  0.001615285873413086
local_output_nid generation:  0.00011968612670898438
local_in_edges_tensor generation:  0.00028133392333984375
mini_batch_src_global generation:  0.00019073486328125
r_  generation:  0.0022101402282714844
local_output_nid generation:  0.000102996826171875
local_in_edges_tensor generation:  0.000263214111328125
mini_batch_src_global generation:  0.0001811981201171875
r_  generation:  0.001878499984741211
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.0002593994140625
mini_batch_src_global generation:  0.0001766681671142578
r_  generation:  0.0018715858459472656
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.0001735687255859375
r_  generation:  0.0017008781433105469
----------------------check_connections_block total spend ----------------------------- 0.023656606674194336
generate_one_block  0.0031845569610595703
generate_one_block  0.002866029739379883
generate_one_block  0.003342151641845703
generate_one_block  0.0027933120727539062
generate_one_block  0.00331878662109375
generate_one_block  0.0030448436737060547
generate_one_block  0.0029914379119873047
generate_one_block  0.0029387474060058594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008132457733154297
gen group dst list time:  0.0003821849822998047
time for parepare:  0.00022840499877929688
local_output_nid generation:  0.0001609325408935547
local_in_edges_tensor generation:  0.0005095005035400391
mini_batch_src_global generation:  0.0002493858337402344
r_  generation:  0.00275421142578125
local_output_nid generation:  0.0001583099365234375
local_in_edges_tensor generation:  0.0003390312194824219
mini_batch_src_global generation:  0.00028586387634277344
r_  generation:  0.0026628971099853516
local_output_nid generation:  0.00017905235290527344
local_in_edges_tensor generation:  0.0003528594970703125
mini_batch_src_global generation:  0.00024890899658203125
r_  generation:  0.0030324459075927734
local_output_nid generation:  0.00015306472778320312
local_in_edges_tensor generation:  0.0003285408020019531
mini_batch_src_global generation:  0.000232696533203125
r_  generation:  0.002650737762451172
local_output_nid generation:  0.00018024444580078125
local_in_edges_tensor generation:  0.0003528594970703125
mini_batch_src_global generation:  0.00025343894958496094
r_  generation:  0.003083944320678711
local_output_nid generation:  0.0001728534698486328
local_in_edges_tensor generation:  0.0003428459167480469
mini_batch_src_global generation:  0.0002493858337402344
r_  generation:  0.0028908252716064453
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.0003037452697753906
mini_batch_src_global generation:  0.0002281665802001953
r_  generation:  0.0025243759155273438
local_output_nid generation:  0.0001494884490966797
local_in_edges_tensor generation:  0.00029921531677246094
mini_batch_src_global generation:  0.0002219676971435547
r_  generation:  0.002513885498046875
----------------------check_connections_block total spend ----------------------------- 0.03347969055175781
generate_one_block  0.0039520263671875
generate_one_block  0.0040400028228759766
generate_one_block  0.004051923751831055
generate_one_block  0.003747701644897461
generate_one_block  0.004246950149536133
generate_one_block  0.004036664962768555
generate_one_block  0.003885030746459961
generate_one_block  0.0038809776306152344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007994174957275391
gen group dst list time:  0.00044798851013183594
time for parepare:  0.00022125244140625
local_output_nid generation:  0.0001919269561767578
local_in_edges_tensor generation:  0.0005140304565429688
mini_batch_src_global generation:  0.0002319812774658203
r_  generation:  0.0032067298889160156
local_output_nid generation:  0.000194549560546875
local_in_edges_tensor generation:  0.00038552284240722656
mini_batch_src_global generation:  0.00032591819763183594
r_  generation:  0.0032188892364501953
local_output_nid generation:  0.0002071857452392578
local_in_edges_tensor generation:  0.0003848075866699219
mini_batch_src_global generation:  0.00028204917907714844
r_  generation:  0.0032951831817626953
local_output_nid generation:  0.00020456314086914062
local_in_edges_tensor generation:  0.0003800392150878906
mini_batch_src_global generation:  0.0002734661102294922
r_  generation:  0.0032472610473632812
local_output_nid generation:  0.00021028518676757812
local_in_edges_tensor generation:  0.00039124488830566406
mini_batch_src_global generation:  0.00027632713317871094
r_  generation:  0.003294229507446289
local_output_nid generation:  0.00020265579223632812
local_in_edges_tensor generation:  0.00037097930908203125
mini_batch_src_global generation:  0.0002658367156982422
r_  generation:  0.0029647350311279297
local_output_nid generation:  0.00019073486328125
local_in_edges_tensor generation:  0.00034356117248535156Using backend: pytorch

mini_batch_src_global generation:  0.0002484321594238281
r_  generation:  0.002965211868286133
local_output_nid generation:  0.0001876354217529297
local_in_edges_tensor generation:  0.0003428459167480469
mini_batch_src_global generation:  0.00024175643920898438
r_  generation:  0.0029366016387939453
----------------------check_connections_block total spend ----------------------------- 0.0379178524017334
generate_one_block  0.004366636276245117
generate_one_block  0.004238605499267578
generate_one_block  0.004764080047607422
generate_one_block  0.0042650699615478516
generate_one_block  0.004348039627075195
generate_one_block  0.004283428192138672
generate_one_block  0.004662752151489258
generate_one_block  0.004210710525512695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.26780128479003906  GigaBytes
Max Memory Allocated: 1.0658693313598633  GigaBytes

connection checking time:  0.11168479919433594
block generation total time  0.11854076385498047
average batch blocks generation time:  0.014817595481872559
block dataloader generation time/epoch 0.33254146575927734
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.26726293563842773  GigaBytes
Max Memory Allocated: 1.0658693313598633  GigaBytes

torch.Size([2334, 1433])
torch.Size([2183, 64])
torch.Size([1764, 64])
torch.Size([1006, 64])
torch.Size([416, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.1077747344970703  GigaBytes
Max Memory Allocated: 1.11444091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.2684779167175293  GigaBytes
Max Memory Allocated: 1.1532325744628906  GigaBytes

torch.Size([2414, 1433])
torch.Size([2196, 64])
torch.Size([1705, 64])
torch.Size([1020, 64])
torch.Size([437, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.1207695007324219  GigaBytes
Max Memory Allocated: 1.1532325744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.26850080490112305  GigaBytes
Max Memory Allocated: 1.1663951873779297  GigaBytes

torch.Size([2390, 1433])
torch.Size([2267, 64])
torch.Size([1975, 64])
torch.Size([1347, 64])
torch.Size([519, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.1426019668579102  GigaBytes
Max Memory Allocated: 1.1663951873779297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.26847028732299805  GigaBytes
Max Memory Allocated: 1.1758804321289062  GigaBytes

torch.Size([2406, 1433])
torch.Size([2217, 64])
torch.Size([1672, 64])
torch.Size([897, 64])
torch.Size([350, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.1210956573486328  GigaBytes
Max Memory Allocated: 1.1758804321289062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.2685055732727051  GigaBytes
Max Memory Allocated: 1.1758804321289062  GigaBytes

torch.Size([2443, 1433])
torch.Size([2334, 64])
torch.Size([1985, 64])
torch.Size([1316, 64])
torch.Size([521, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 1.1696739196777344  GigaBytes
Max Memory Allocated: 1.1758804321289062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 0.26848459243774414  GigaBytes
Max Memory Allocated: 1.2013053894042969  GigaBytes

torch.Size([2411, 1433])
torch.Size([2260, 64])
torch.Size([1880, 64])
torch.Size([1103, 64])
torch.Size([432, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 1.1359248161315918  GigaBytes
Max Memory Allocated: 1.2013053894042969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 0.2684807777404785  GigaBytes
Max Memory Allocated: 1.2013053894042969  GigaBytes

torch.Size([2400, 1433])
torch.Size([2238, 64])
torch.Size([1813, 64])
torch.Size([1079, 64])
torch.Size([357, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 1.1273918151855469  GigaBytes
Max Memory Allocated: 1.2013053894042969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 0.26743602752685547  GigaBytes
Max Memory Allocated: 1.2013053894042969  GigaBytes

torch.Size([2366, 1433])
torch.Size([2227, 64])
torch.Size([1791, 64])
torch.Size([1016, 64])
torch.Size([342, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5526123046875 GB
    Memory Allocated: 1.1235432624816895  GigaBytes
Max Memory Allocated: 1.2013053894042969  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06174224615097046 |0.001522451639175415 |0.28472548723220825 |0.00013080239295959473 |0.38570544123649597 |0.01717662811279297 |
----------------------------------------------------------pseudo_mini_loss sum 2.4427051544189453
Total (block generation + training)time/epoch 6.291846036911011
Training time/epoch 5.958932876586914
Training time without block to device /epoch 5.946753263473511
Training time without total dataloading part /epoch 5.3816704750061035
load block tensor time/epoch 0.49393796920776367
block to device time/epoch 0.01217961311340332
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64584
Number of first layer input nodes during this epoch:  19164
