main start at this time 1648433661.5305243
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06398439407348633  GigaBytes
Max Memory Allocated: 0.06398439407348633  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0010330677032470703
random selection method range initialization spend 0.00017595291137695312
time for parepare:  7.104873657226562e-05
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.001386880874633789
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00014162063598632812
----------------------check_connections_block total spend ----------------------------- 0.0022351741790771484
generate_one_block  0.0013532638549804688
generate_one_block  0.0012116432189941406
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005085468292236328
gen group dst list time:  2.956390380859375e-05
time for parepare:  0.0001513957977294922
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.000579833984375
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.0007863044738769531
----------------------check_connections_block total spend ----------------------------- 0.0025129318237304688
generate_one_block  0.001730203628540039
generate_one_block  0.001961946487426758
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005667209625244141
gen group dst list time:  5.7697296142578125e-05
time for parepare:  0.00018358230590820312
local_output_nid generation:  6.628036499023438e-05
local_in_edges_tensor generation:  0.00031828880310058594
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.0016193389892578125
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.0002505779266357422
mini_batch_src_global generation:  0.00018668174743652344
r_  generation:  0.0019178390502929688
----------------------check_connections_block total spend ----------------------------- 0.005633354187011719
generate_one_block  0.0029141902923583984
generate_one_block  0.003195047378540039
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006198883056640625
gen group dst list time:  8.845329284667969e-05
time for parepare:  0.00018477439880371094
local_output_nid generation:  0.00011897087097167969
local_in_edges_tensor generation:  0.00040030479431152344
mini_batch_src_global generation:  0.00019598007202148438
r_  generation:  0.0028603076934814453
local_output_nid generation:  0.00013136863708496094
local_in_edges_tensor generation:  0.0003287792205810547
mini_batch_src_global generation:  0.00026607513427734375
r_  generation:  0.0028183460235595703
----------------------check_connections_block total spend ----------------------------- 0.008573532104492188
generate_one_block  0.004048824310302734
generate_one_block  0.0038912296295166016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007576942443847656
gen group dst list time:  0.00011157989501953125
time for parepare:  0.00018787384033203125
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.0004911422729492188
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.003231048583984375
local_output_nid generation:  0.000164031982421875
local_in_edges_tensor generation:  0.0003647804260253906
mini_batch_src_global generation:  0.0002925395965576172
r_  generation:  0.003185272216796875
----------------------check_connections_block total spend ----------------------------- 0.009695291519165039
generate_one_block  0.004464864730834961
generate_one_block  0.00414586067199707
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006814002990722656
gen group dst list time:  0.0001201629638671875
time for parepare:  0.0001888275146484375
local_output_nid generation:  0.00016307830810546875
local_in_edges_tensor generation:  0.00046825408935546875
mini_batch_src_global generation:  0.00022101402282714844
r_  generation:  0.0033533573150634766
local_output_nid generation:  0.00016832351684570312
local_in_edges_tensor generation:  0.0003790855407714844
mini_batch_src_global generation:  0.0003020763397216797
r_  generation:  0.003325939178466797
----------------------check_connections_block total spend ----------------------------- 0.010146617889404297
generate_one_block  0.004712104797363281
generate_one_block  0.0044252872467041016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06398439407348633  GigaBytes
Max Memory Allocated: 0.06398439407348633  GigaBytes

connection checking time:  0.03656172752380371
block generation total time  0.035489559173583984
average batch blocks generation time:  0.017744779586791992
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07791757583618164  GigaBytes
Max Memory Allocated: 0.07791757583618164  GigaBytes

torch.Size([2504, 1433])
torch.Size([2458, 64])
torch.Size([2301, 64])
torch.Size([1823, 64])
torch.Size([979, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 1.0292534828186035  GigaBytes
Max Memory Allocated: 1.0293593406677246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3963623046875 GB
    Memory Allocated: 0.14125776290893555  GigaBytes
Max Memory Allocated: 1.0384788513183594  GigaBytes

torch.Size([2492, 1433])
torch.Size([2428, 64])
torch.Size([2272, 64])
torch.Size([1924, 64])
torch.Size([1189, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 1.0923576354980469  GigaBytes
Max Memory Allocated: 1.0924992561340332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04329240322113037 |0.1690899133682251 |0.5607917308807373 |0.00018870830535888672 |0.43658506870269775 |0.021555185317993164 |
----------------------------------------------------------pseudo_mini_loss sum 3.3071999549865723
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21062
Number of first layer input nodes during this epoch:  4996
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.26909494400024414  GigaBytes
Max Memory Allocated: 1.0943756103515625  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005273818969726562
random selection method range initialization spend 0.0001246929168701172
time for parepare:  7.700920104980469e-05
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00013399124145507812
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00012803077697753906
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00013756752014160156
----------------------check_connections_block total spend ----------------------------- 0.0010530948638916016
generate_one_block  0.0013225078582763672
generate_one_block  0.0012466907501220703
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005295276641845703
gen group dst list time:  3.647804260253906e-05
time for parepare:  0.00016188621520996094
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00023627281188964844
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0007238388061523438
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  0.00010371208190917969
r_  generation:  0.0006968975067138672
----------------------check_connections_block total spend ----------------------------- 0.0027008056640625
generate_one_block  0.002108335494995117
generate_one_block  0.0021123886108398438
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005970001220703125
gen group dst list time:  6.318092346191406e-05
time for parepare:  0.0001888275146484375
local_output_nid generation:  9.655952453613281e-05
local_in_edges_tensor generation:  0.0003418922424316406
mini_batch_src_global generation:  0.00017571449279785156
r_  generation:  0.001878499984741211
local_output_nid generation:  8.821487426757812e-05
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  0.0002143383026123047
r_  generation:  0.0018258094787597656
----------------------check_connections_block total spend ----------------------------- 0.0059719085693359375
generate_one_block  0.0036165714263916016
generate_one_block  0.0032973289489746094
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000652313232421875
gen group dst list time:  9.441375732421875e-05
time for parepare:  0.00018858909606933594
local_output_nid generation:  0.00014066696166992188
local_in_edges_tensor generation:  0.00041747093200683594
mini_batch_src_global generation:  0.00021004676818847656
r_  generation:  0.0028450489044189453
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.00034356117248535156
mini_batch_src_global generation:  0.000431060791015625
r_  generation:  0.002818584442138672
----------------------check_connections_block total spend ----------------------------- 0.008973836898803711
generate_one_block  0.004334688186645508
generate_one_block  0.00405120849609375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008273124694824219
gen group dst list time:  0.00011706352233886719
time for parepare:  0.00019168853759765625
local_output_nid generation:  0.00016808509826660156
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.00023603439331054688
r_  generation:  0.0033049583435058594
local_output_nid generation:  0.00017333030700683594
local_in_edges_tensor generation:  0.0003757476806640625
mini_batch_src_global generation:  0.0002989768981933594
r_  generation:  0.0032503604888916016
----------------------check_connections_block total spend ----------------------------- 0.010065793991088867
generate_one_block  0.004734039306640625
generate_one_block  0.0044460296630859375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008161067962646484
gen group dst list time:  0.00012755393981933594
time for parepare:  0.00019311904907226562
local_output_nid generation:  0.0001761913299560547
local_in_edges_tensor generation:  0.0004837512969970703
mini_batch_src_global generation:  0.00024580955505371094
r_  generation:  0.0033791065216064453
local_output_nid generation:  0.00018477439880371094
local_in_edges_tensor generation:  0.0003898143768310547
mini_batch_src_global generation:  0.00030994415283203125
r_  generation:  0.003353118896484375
----------------------check_connections_block total spend ----------------------------- 0.010322093963623047
generate_one_block  0.004864931106567383
generate_one_block  0.005293607711791992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.26909494400024414  GigaBytes
Max Memory Allocated: 1.0943756103515625  GigaBytes

connection checking time:  0.03803443908691406
block generation total time  0.03885912895202637
average batch blocks generation time:  0.019429564476013184
block dataloader generation time/epoch 0.11168527603149414
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 0.26856088638305664  GigaBytes
Max Memory Allocated: 1.0943756103515625  GigaBytes

torch.Size([2506, 1433])
torch.Size([2467, 64])
torch.Size([2329, 64])
torch.Size([1905, 64])
torch.Size([1125, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 1.221034049987793  GigaBytes
Max Memory Allocated: 1.221158504486084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.2685580253601074  GigaBytes
Max Memory Allocated: 1.2247710227966309  GigaBytes

torch.Size([2502, 1433])
torch.Size([2455, 64])
torch.Size([2297, 64])
torch.Size([1897, 64])
torch.Size([1086, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 1.2177720069885254  GigaBytes
Max Memory Allocated: 1.2247710227966309  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04039144515991211 |0.0018382072448730469 |0.33460164070129395 |0.00015473365783691406 |0.4495124816894531 |0.015753984451293945 |
----------------------------------------------------------pseudo_mini_loss sum 2.638247489929199
Total (block generation + training)time/epoch 1.840527057647705
Training time/epoch 1.72859787940979
Training time without block to device /epoch 1.724921464920044
Training time without total dataloading part /epoch 1.584291696548462
load block tensor time/epoch 0.08078289031982422
block to device time/epoch 0.0036764144897460938
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21265
Number of first layer input nodes during this epoch:  5008
