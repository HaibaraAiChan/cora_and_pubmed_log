main start at this time 1648433673.3763797
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06398439407348633  GigaBytes
Max Memory Allocated: 0.06398439407348633  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0010614395141601562
random selection method range initialization spend 0.00017070770263671875
time for parepare:  6.341934204101562e-05
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0017631053924560547
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  6.651878356933594e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  7.367134094238281e-05
----------------------check_connections_block total spend ----------------------------- 0.002986431121826172
generate_one_block  0.001413106918334961
generate_one_block  0.0010585784912109375
generate_one_block  0.001035451889038086
generate_one_block  0.0010364055633544922
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004961490631103516
gen group dst list time:  3.790855407714844e-05
time for parepare:  0.00014710426330566406
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.0003135204315185547
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00030541419982910156
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0003974437713623047
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.000453948974609375
----------------------check_connections_block total spend ----------------------------- 0.002931356430053711
generate_one_block  0.001356363296508789
generate_one_block  0.001306772232055664
generate_one_block  0.0014603137969970703
generate_one_block  0.0015025138854980469
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005462169647216797
gen group dst list time:  6.937980651855469e-05
time for parepare:  0.0001671314239501953
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.0002608299255371094
mini_batch_src_global generation:  0.0001227855682373047
r_  generation:  0.0010390281677246094
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.0001163482666015625
r_  generation:  0.0009531974792480469
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  0.00012040138244628906
r_  generation:  0.0012180805206298828
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0013132095336914062
----------------------check_connections_block total spend ----------------------------- 0.007364749908447266
generate_one_block  0.002197265625
generate_one_block  0.002086162567138672
generate_one_block  0.0023696422576904297
generate_one_block  0.002494335174560547
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007376670837402344
gen group dst list time:  0.00012612342834472656
time for parepare:  0.0001842975616455078
local_output_nid generation:  9.34600830078125e-05
local_in_edges_tensor generation:  0.00039196014404296875
mini_batch_src_global generation:  0.00016450881958007812
r_  generation:  0.0020873546600341797
local_output_nid generation:  9.322166442871094e-05
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.001953601837158203
local_output_nid generation:  0.00010538101196289062
local_in_edges_tensor generation:  0.00027060508728027344
mini_batch_src_global generation:  0.00019741058349609375
r_  generation:  0.0022401809692382812
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.00027871131896972656
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.002335071563720703
----------------------check_connections_block total spend ----------------------------- 0.013152599334716797
generate_one_block  0.0035469532012939453
generate_one_block  0.003169536590576172
generate_one_block  0.003426074981689453
generate_one_block  0.0035355091094970703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000759124755859375
gen group dst list time:  0.00017905235290527344
time for parepare:  0.0001850128173828125
local_output_nid generation:  0.00013208389282226562
local_in_edges_tensor generation:  0.0004322528839111328
mini_batch_src_global generation:  0.000194549560546875
r_  generation:  0.0028061866760253906
local_output_nid generation:  0.00013875961303710938
local_in_edges_tensor generation:  0.00031638145446777344
mini_batch_src_global generation:  0.0002932548522949219
r_  generation:  0.002704143524169922
local_output_nid generation:  0.00014209747314453125
local_in_edges_tensor generation:  0.00032401084899902344
mini_batch_src_global generation:  0.00023865699768066406
r_  generation:  0.0027871131896972656
local_output_nid generation:  0.00014495849609375
local_in_edges_tensor generation:  0.00032830238342285156
mini_batch_src_global generation:  0.00024127960205078125
r_  generation:  0.0029370784759521484
----------------------check_connections_block total spend ----------------------------- 0.016954421997070312
generate_one_block  0.004119396209716797
generate_one_block  0.004694938659667969
generate_one_block  0.003960132598876953
generate_one_block  0.004014730453491211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007996559143066406
gen group dst list time:  0.00022172927856445312
time for parepare:  0.00018453598022460938
local_output_nid generation:  0.00015354156494140625
local_in_edges_tensor generation:  0.0006046295166015625
mini_batch_src_global generation:  0.00021076202392578125
r_  generation:  0.003148794174194336
local_output_nid generation:  0.0001583099365234375
local_in_edges_tensor generation:  0.00034999847412109375
mini_batch_src_global generation:  0.0003170967102050781
r_  generation:  0.0030517578125
local_output_nid generation:  0.0001552104949951172
local_in_edges_tensor generation:  0.0003409385681152344
mini_batch_src_global generation:  0.000247955322265625
r_  generation:  0.003037691116333008
local_output_nid generation:  0.00015854835510253906
local_in_edges_tensor generation:  0.0003490447998046875
mini_batch_src_global generation:  0.00026535987854003906
r_  generation:  0.0031037330627441406
----------------------check_connections_block total spend ----------------------------- 0.01873016357421875
generate_one_block  0.004299640655517578
generate_one_block  0.004270792007446289
generate_one_block  0.004209041595458984
generate_one_block  0.004992246627807617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06398439407348633  GigaBytes
Max Memory Allocated: 0.06398439407348633  GigaBytes

connection checking time:  0.059133291244506836
block generation total time  0.06301236152648926
average batch blocks generation time:  0.015753090381622314
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07788467407226562  GigaBytes
Max Memory Allocated: 0.07788467407226562  GigaBytes

torch.Size([2493, 1433])
torch.Size([2398, 64])
torch.Size([2124, 64])
torch.Size([1463, 64])
torch.Size([628, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 1.000967025756836  GigaBytes
Max Memory Allocated: 1.0010251998901367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3651123046875 GB
    Memory Allocated: 0.1412038803100586  GigaBytes
Max Memory Allocated: 1.0273079872131348  GigaBytes

torch.Size([2420, 1433])
torch.Size([2338, 64])
torch.Size([2023, 64])
torch.Size([1330, 64])
torch.Size([575, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4158935546875 GB
    Memory Allocated: 1.0451350212097168  GigaBytes
Max Memory Allocated: 1.0451960563659668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 0.1412210464477539  GigaBytes
Max Memory Allocated: 1.0757660865783691  GigaBytes

torch.Size([2407, 1433])
torch.Size([2334, 64])
torch.Size([2126, 64])
torch.Size([1589, 64])
torch.Size([757, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 1.0387544631958008  GigaBytes
Max Memory Allocated: 1.0757660865783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 0.14123058319091797  GigaBytes
Max Memory Allocated: 1.0757660865783691  GigaBytes

torch.Size([2472, 1433])
torch.Size([2407, 64])
torch.Size([2179, 64])
torch.Size([1675, 64])
torch.Size([810, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5096435546875 GB
    Memory Allocated: 1.0756163597106934  GigaBytes
Max Memory Allocated: 1.0757660865783691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06013190746307373 |0.08603072166442871 |0.4287751317024231 |0.00016260147094726562 |0.4213030934333801 |0.011141061782836914 |
----------------------------------------------------------pseudo_mini_loss sum 3.451907157897949
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37272
Number of first layer input nodes during this epoch:  9792
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6033935546875 GB
    Memory Allocated: 0.2690095901489258  GigaBytes
Max Memory Allocated: 1.0921506881713867  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006597042083740234
random selection method range initialization spend 0.0001647472381591797
time for parepare:  9.202957153320312e-05
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00010180473327636719
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  9.560585021972656e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  5.9604644775390625e-05
----------------------check_connections_block total spend ----------------------------- 0.0015048980712890625
generate_one_block  0.001399993896484375
generate_one_block  0.0012998580932617188
generate_one_block  0.0012946128845214844
generate_one_block  0.0012545585632324219
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005860328674316406
gen group dst list time:  5.459785461425781e-05
time for parepare:  0.00019860267639160156
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00029158592224121094
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0004634857177734375
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0005159378051757812
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0005564689636230469
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.00035858154296875
----------------------check_connections_block total spend ----------------------------- 0.0039899349212646484
generate_one_block  0.0018603801727294922
generate_one_block  0.0018939971923828125
generate_one_block  0.0018928050994873047
generate_one_block  0.0016317367553710938
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006532669067382812
gen group dst list time:  0.0001087188720703125
time for parepare:  0.00023818016052246094
local_output_nid generation:  8.392333984375e-05
local_in_edges_tensor generation:  0.00037550926208496094
mini_batch_src_global generation:  0.00019240379333496094
r_  generation:  0.0014293193817138672
local_output_nid generation:  9.083747863769531e-05
local_in_edges_tensor generation:  0.0002465248107910156
mini_batch_src_global generation:  0.0002384185791015625
r_  generation:  0.0017080307006835938
local_output_nid generation:  9.322166442871094e-05
local_in_edges_tensor generation:  0.0002617835998535156
mini_batch_src_global generation:  0.000194549560546875
r_  generation:  0.0017447471618652344
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  0.00015234947204589844
r_  generation:  0.0011944770812988281
----------------------check_connections_block total spend ----------------------------- 0.010207414627075195
generate_one_block  0.003186941146850586
generate_one_block  0.00281524658203125
generate_one_block  0.002774477005004883
generate_one_block  0.0024645328521728516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008497238159179688
gen group dst list time:  0.00020122528076171875
time for parepare:  0.00025725364685058594
local_output_nid generation:  0.0001728534698486328
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.00026702880859375
r_  generation:  0.0027399063110351562
local_output_nid generation:  0.00017333030700683594
local_in_edges_tensor generation:  0.00037932395935058594
mini_batch_src_global generation:  0.00031638145446777344
r_  generation:  0.0030088424682617188
local_output_nid generation:  0.0001728534698486328
local_in_edges_tensor generation:  0.0003895759582519531
mini_batch_src_global generation: Using backend: pytorch
 0.0002865791320800781
r_  generation:  0.003027200698852539
local_output_nid generation:  0.00011944770812988281
local_in_edges_tensor generation:  0.0002703666687011719
mini_batch_src_global generation:  0.00019741058349609375
r_  generation:  0.002209186553955078
----------------------check_connections_block total spend ----------------------------- 0.017166852951049805
generate_one_block  0.004158496856689453
generate_one_block  0.004439115524291992
generate_one_block  0.004093170166015625
generate_one_block  0.003748655319213867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009348392486572266
gen group dst list time:  0.00031948089599609375
time for parepare:  0.00024819374084472656
local_output_nid generation:  0.000270843505859375
local_in_edges_tensor generation:  0.0006206035614013672
mini_batch_src_global generation:  0.0003497600555419922
r_  generation:  0.003640413284301758
local_output_nid generation:  0.0002682209014892578
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.0004401206970214844
r_  generation:  0.0037713050842285156
local_output_nid generation:  0.0002624988555908203
local_in_edges_tensor generation:  0.0004794597625732422
mini_batch_src_global generation:  0.0004143714904785156
r_  generation:  0.0030465126037597656
local_output_nid generation:  0.00016951560974121094
local_in_edges_tensor generation:  0.0003476142883300781
mini_batch_src_global generation:  0.00023984909057617188
r_  generation:  0.0029048919677734375
----------------------check_connections_block total spend ----------------------------- 0.02110123634338379
generate_one_block  0.005086183547973633
generate_one_block  0.004522562026977539
generate_one_block  0.004552125930786133
generate_one_block  0.0042705535888671875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008864402770996094
gen group dst list time:  0.00028324127197265625
time for parepare:  0.0002269744873046875
local_output_nid generation:  0.00024080276489257812
local_in_edges_tensor generation:  0.0006356239318847656
mini_batch_src_global generation:  0.00032329559326171875
r_  generation:  0.003929853439331055
local_output_nid generation:  0.0002727508544921875
local_in_edges_tensor generation:  0.0004532337188720703
mini_batch_src_global generation:  0.00036644935607910156
r_  generation:  0.0038568973541259766
local_output_nid generation:  0.0002491474151611328
local_in_edges_tensor generation:  0.00044274330139160156
mini_batch_src_global generation:  0.00032782554626464844
r_  generation:  0.0031366348266601562
local_output_nid generation:  0.0001876354217529297
local_in_edges_tensor generation:  0.0003933906555175781
mini_batch_src_global generation:  0.00026535987854003906
r_  generation:  0.0030646324157714844
----------------------check_connections_block total spend ----------------------------- 0.021681785583496094
generate_one_block  0.005293130874633789
generate_one_block  0.004481077194213867
generate_one_block  0.004506826400756836
generate_one_block  0.004713535308837891
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6033935546875 GB
    Memory Allocated: 0.2690095901489258  GigaBytes
Max Memory Allocated: 1.0921506881713867  GigaBytes

connection checking time:  0.07414722442626953
block generation total time  0.07238554954528809
average batch blocks generation time:  0.01809638738632202
block dataloader generation time/epoch 0.2362525463104248
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6033935546875 GB
    Memory Allocated: 0.2685203552246094  GigaBytes
Max Memory Allocated: 1.0921506881713867  GigaBytes

torch.Size([2461, 1433])
torch.Size([2374, 64])
torch.Size([2115, 64])
torch.Size([1490, 64])
torch.Size([714, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6033935546875 GB
    Memory Allocated: 1.1907992362976074  GigaBytes
Max Memory Allocated: 1.1908636093139648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6033935546875 GB
    Memory Allocated: 0.26853084564208984  GigaBytes
Max Memory Allocated: 1.2149085998535156  GigaBytes

torch.Size([2457, 1433])
torch.Size([2380, 64])
torch.Size([2182, 64])
torch.Size([1644, 64])
torch.Size([777, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6033935546875 GB
    Memory Allocated: 1.1946806907653809  GigaBytes
Max Memory Allocated: 1.2149085998535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6033935546875 GB
    Memory Allocated: 0.26853466033935547  GigaBytes
Max Memory Allocated: 1.2149085998535156  GigaBytes

torch.Size([2479, 1433])
torch.Size([2421, 64])
torch.Size([2188, 64])
torch.Size([1636, 64])
torch.Size([811, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 1.202892780303955  GigaBytes
Max Memory Allocated: 1.2149085998535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.2685089111328125  GigaBytes
Max Memory Allocated: 1.2197456359863281  GigaBytes

torch.Size([2467, 1433])
torch.Size([2352, 64])
torch.Size([2055, 64])
torch.Size([1397, 64])
torch.Size([567, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 1.1844921112060547  GigaBytes
Max Memory Allocated: 1.2197456359863281  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05417555570602417 |0.001123666763305664 |0.3067741394042969 |0.00013571977615356445 |0.4097840189933777 |0.016976118087768555 |
----------------------------------------------------------pseudo_mini_loss sum 2.426234006881714
Total (block generation + training)time/epoch 3.4072844982147217
Training time/epoch 3.1706953048706055
Training time without block to device /epoch 3.166200637817383
Training time without total dataloading part /epoch 2.883751630783081
load block tensor time/epoch 0.21670222282409668
block to device time/epoch 0.004494667053222656
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37702
Number of first layer input nodes during this epoch:  9864
