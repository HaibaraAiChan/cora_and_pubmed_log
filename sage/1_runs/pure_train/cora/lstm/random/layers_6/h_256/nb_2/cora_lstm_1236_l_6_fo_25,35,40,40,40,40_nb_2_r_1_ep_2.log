main start at this time 1648433825.2034836
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.07706785202026367  GigaBytes
Max Memory Allocated: 0.07706785202026367  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0009512901306152344
random selection method range initialization spend 0.00016570091247558594
time for parepare:  6.389617919921875e-05
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0013442039489746094
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00011420249938964844
----------------------check_connections_block total spend ----------------------------- 0.002117156982421875
generate_one_block  0.0012738704681396484
generate_one_block  0.0011036396026611328
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00046563148498535156
gen group dst list time:  3.7670135498046875e-05
time for parepare:  0.00013756752014160156
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0006155967712402344
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0006651878356933594
----------------------check_connections_block total spend ----------------------------- 0.002353191375732422
generate_one_block  0.0017037391662597656
generate_one_block  0.0017371177673339844
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005545616149902344
gen group dst list time:  5.412101745605469e-05
time for parepare:  0.00016498565673828125
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.0003159046173095703
mini_batch_src_global generation:  0.00017142295837402344
r_  generation:  0.0017571449279785156
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.00023627281188964844
mini_batch_src_global generation:  0.00018143653869628906
r_  generation:  0.0016884803771972656
----------------------check_connections_block total spend ----------------------------- 0.005520820617675781
generate_one_block  0.002884387969970703
generate_one_block  0.002949237823486328
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006017684936523438
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.00017142295837402344
local_output_nid generation:  0.00011396408081054688
local_in_edges_tensor generation:  0.0003905296325683594
mini_batch_src_global generation:  0.00019049644470214844
r_  generation:  0.0026938915252685547
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.0003037452697753906
mini_batch_src_global generation:  0.00024271011352539062
r_  generation:  0.002592802047729492
----------------------check_connections_block total spend ----------------------------- 0.008112907409667969
generate_one_block  0.003785371780395508
generate_one_block  0.0038213729858398438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007486343383789062
gen group dst list time:  0.0001232624053955078
time for parepare:  0.00018858909606933594
local_output_nid generation:  0.0001475811004638672
local_in_edges_tensor generation:  0.0004589557647705078
mini_batch_src_global generation:  0.0002162456512451172
r_  generation:  0.003027200698852539
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.000362396240234375
mini_batch_src_global generation:  0.00027251243591308594
r_  generation:  0.003025531768798828
----------------------check_connections_block total spend ----------------------------- 0.009196996688842773
generate_one_block  0.004140377044677734
generate_one_block  0.00410914421081543
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007555484771728516
gen group dst list time:  0.00010991096496582031
time for parepare:  0.0001747608184814453
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.0004572868347167969
mini_batch_src_global generation:  0.00022602081298828125
r_  generation:  0.0030701160430908203
local_output_nid generation:  0.0001571178436279297
local_in_edges_tensor generation:  0.00036454200744628906
mini_batch_src_global generation:  0.0002830028533935547
r_  generation:  0.0030815601348876953
----------------------check_connections_block total spend ----------------------------- 0.009448528289794922
generate_one_block  0.0042591094970703125
generate_one_block  0.004155397415161133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.07706785202026367  GigaBytes
Max Memory Allocated: 0.07706785202026367  GigaBytes

connection checking time:  0.03463244438171387
block generation total time  0.03354525566101074
average batch blocks generation time:  0.01677262783050537
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09066581726074219  GigaBytes
Max Memory Allocated: 0.09066581726074219  GigaBytes

torch.Size([2497, 1433])
torch.Size([2453, 256])
torch.Size([2307, 256])
torch.Size([1875, 256])
torch.Size([1086, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5565185546875 GB
    Memory Allocated: 1.35905122756958  GigaBytes
Max Memory Allocated: 1.359494686126709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 0.16787052154541016  GigaBytes
Max Memory Allocated: 1.3626351356506348  GigaBytes

torch.Size([2473, 1433])
torch.Size([2421, 256])
torch.Size([2281, 256])
torch.Size([1878, 256])
torch.Size([1134, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.4321775436401367  GigaBytes
Max Memory Allocated: 1.4326343536376953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0432133674621582 |0.16782867908477783 |0.5714242458343506 |0.0001653432846069336 |0.4727131128311157 |0.020502090454101562 |
----------------------------------------------------------pseudo_mini_loss sum 3.037202835083008
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21101
Number of first layer input nodes during this epoch:  4970
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.3221454620361328  GigaBytes
Max Memory Allocated: 1.4357247352600098  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005211830139160156
random selection method range initialization spend 0.00013208389282226562
time for parepare:  7.414817810058594e-05
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.0001583099365234375
r_  generation:  0.0001327991485595703
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00013589859008789062
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00012683868408203125
----------------------check_connections_block total spend ----------------------------- 0.0011813640594482422
generate_one_block  0.0013039112091064453
generate_one_block  0.0012142658233642578
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000507354736328125
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.00016069412231445312
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  8.7738037109375e-05
r_  generation:  0.0006992816925048828
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0007066726684570312
----------------------check_connections_block total spend ----------------------------- 0.0026655197143554688
generate_one_block  0.002054929733276367
generate_one_block  0.0019693374633789062
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005824565887451172
gen group dst list time:  6.29425048828125e-05
time for parepare:  0.00018310546875
local_output_nid generation:  0.00010633468627929688
local_in_edges_tensor generation:  0.0003287792205810547
mini_batch_src_global generation:  0.0001728534698486328
r_  generation:  0.0017936229705810547
local_output_nid generation:  9.107589721679688e-05
local_in_edges_tensor generation:  0.00024580955505371094
mini_batch_src_global generation:  0.00022172927856445312
r_  generation:  0.0018415451049804688
----------------------check_connections_block total spend ----------------------------- 0.0058820247650146484
generate_one_block  0.003651857376098633
generate_one_block  0.0032663345336914062
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006477832794189453
gen group dst list time:  9.059906005859375e-05
time for parepare:  0.0001850128173828125
local_output_nid generation:  0.0001385211944580078
local_in_edges_tensor generation:  0.000415802001953125
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.002788066864013672
local_output_nid generation:  0.000141143798828125
local_in_edges_tensor generation:  0.0003349781036376953
mini_batch_src_global generation:  0.00031256675720214844
r_  generation:  0.0028123855590820312
----------------------check_connections_block total spend ----------------------------- 0.008723735809326172
generate_one_block  0.004281759262084961
generate_one_block  0.004227638244628906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007536411285400391
gen group dst list time:  0.00011134147644042969
time for parepare:  0.0001976490020751953
local_output_nid generation:  0.00016117095947265625
local_in_edges_tensor generation:  0.00046634674072265625
mini_batch_src_global generation:  0.0002315044403076172
r_  generation:  0.003199338912963867
local_output_nid generation:  0.0001728534698486328
local_in_edges_tensor generation:  0.00036597251892089844
mini_batch_src_global generation:  0.00029921531677246094
r_  generation:  0.0032072067260742188
----------------------check_connections_block total spend ----------------------------- 0.009854793548583984
generate_one_block  0.004567623138427734
generate_one_block  0.004359006881713867
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008027553558349609
gen group dst list time:  0.00011968612670898438
time for parepare:  0.0001881122589111328
local_output_nid generation:  0.0001728534698486328
local_in_edges_tensor generation:  0.0005195140838623047
mini_batch_src_global generation:  0.00023746490478515625
r_  generation:  0.0032682418823242188
local_output_nid generation:  0.0001800060272216797
local_in_edges_tensor generation:  0.0003807544708251953
mini_batch_src_global generation:  0.00030231475830078125
r_  generation:  0.003299713134765625
----------------------check_connections_block total spend ----------------------------- 0.010092735290527344
generate_one_block  0.005480527877807617
generate_one_block  0.004561424255371094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.3221454620361328  GigaBytes
Max Memory Allocated: 1.4357247352600098  GigaBytes

connection checking time:  0.03721880912780762
block generation total time  0.03842043876647949
average batch blocks generation time:  0.019210219383239746
block dataloader generation time/epoch 0.11562967300415039
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 0.3216228485107422  GigaBytes
Max Memory Allocated: 1.4357247352600098  GigaBytes

torch.Size([2496, 1433])
torch.Size([2449, 256])
torch.Size([2305, 256])
torch.Size([1895, 256])
torch.Size([1117, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.5909934043884277  GigaBytes
Max Memory Allocated: 1.5914502143859863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 0.3216276168823242  GigaBytes
Max Memory Allocated: 1.594550609588623  GigaBytes

torch.Size([2510, 1433])
torch.Size([2470, 256])
torch.Size([2342, 256])
torch.Size([1938, 256])
torch.Size([1118, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.5986413955688477  GigaBytes
Max Memory Allocated: 1.5990877151489258  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04043292999267578 |0.0014704465866088867 |0.3413015604019165 |0.00014138221740722656 |0.4772770404815674 |0.015669584274291992 |
----------------------------------------------------------pseudo_mini_loss sum 3.457340955734253
Total (block generation + training)time/epoch 1.9167239665985107
Training time/epoch 1.800825834274292
Training time without block to device /epoch 1.7978849411010742
Training time without total dataloading part /epoch 1.6531095504760742
load block tensor time/epoch 0.08086585998535156
block to device time/epoch 0.0029408931732177734
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21343
Number of first layer input nodes during this epoch:  5006
