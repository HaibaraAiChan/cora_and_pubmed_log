main start at this time 1648433853.3702202
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.07706785202026367  GigaBytes
Max Memory Allocated: 0.07706785202026367  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0009136199951171875
random selection method range initialization spend 0.0001933574676513672
time for parepare:  8.368492126464844e-05
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0016803741455078125
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  5.602836608886719e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.125999450683594e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.7206878662109375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.933906555175781e-05
----------------------check_connections_block total spend ----------------------------- 0.003905057907104492
generate_one_block  0.001634359359741211
generate_one_block  0.0012707710266113281
generate_one_block  0.0012478828430175781
generate_one_block  0.0012862682342529297
generate_one_block  0.0012462139129638672
generate_one_block  0.0012729167938232422
generate_one_block  0.0013196468353271484
generate_one_block  0.0010764598846435547
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005245208740234375
gen group dst list time:  7.343292236328125e-05
time for parepare:  0.000179290771484375
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00033783912658691406
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00026726722717285156
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.000179290771484375
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0003237724304199219
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0001919269561767578
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0003719329833984375
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0002703666687011719
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00025010108947753906
----------------------check_connections_block total spend ----------------------------- 0.0048253536224365234
generate_one_block  0.0016536712646484375
generate_one_block  0.0015382766723632812
generate_one_block  0.001428365707397461
generate_one_block  0.0015912055969238281
generate_one_block  0.001428842544555664
generate_one_block  0.0016639232635498047
generate_one_block  0.0011966228485107422
generate_one_block  0.0011734962463378906
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006718635559082031
gen group dst list time:  0.00012969970703125
time for parepare:  0.0002522468566894531
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.0003879070281982422
mini_batch_src_global generation:  0.0001373291015625
r_  generation:  0.0011472702026367188
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  0.00011920928955078125
r_  generation:  0.0009100437164306641
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.0006151199340820312
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  0.00010514259338378906
r_  generation:  0.001020669937133789
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0006399154663085938
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.00013303756713867188
r_  generation:  0.0013463497161865234
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.00011515617370605469
r_  generation:  0.0008885860443115234
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  9.608268737792969e-05
r_  generation:  0.0007841587066650391
----------------------check_connections_block total spend ----------------------------- 0.012606143951416016
generate_one_block  0.00244140625
generate_one_block  0.00177001953125
generate_one_block  0.0014715194702148438
generate_one_block  0.0019316673278808594
generate_one_block  0.0014922618865966797
generate_one_block  0.002133607864379883
generate_one_block  0.0017344951629638672
generate_one_block  0.0016028881072998047
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007963180541992188
gen group dst list time:  0.00024509429931640625
time for parepare:  0.00023889541625976562
local_output_nid generation:  0.00010943412780761719
local_in_edges_tensor generation:  0.0004143714904785156
mini_batch_src_global generation:  0.0002529621124267578
r_  generation:  0.0023686885833740234
local_output_nid generation:  0.00011324882507324219
local_in_edges_tensor generation:  0.00030040740966796875
mini_batch_src_global generation:  0.00024700164794921875
r_  generation:  0.002196788787841797
local_output_nid generation:  8.821487426757812e-05
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  0.00017786026000976562
r_  generation:  0.0016319751739501953
local_output_nid generation:  0.00011801719665527344
local_in_edges_tensor generation:  0.00030541419982910156
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.0022339820861816406
local_output_nid generation:  7.05718994140625e-05
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  0.00014925003051757812
r_  generation:  0.0014722347259521484
local_output_nid generation:  0.00010323524475097656
local_in_edges_tensor generation:  0.0002753734588623047
mini_batch_src_global generation:  0.00020051002502441406
r_  generation:  0.002208232879638672
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.00022101402282714844
mini_batch_src_global generation:  0.00015878677368164062
r_  generation:  0.0016231536865234375
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.00013589859008789062
r_  generation:  0.0012269020080566406
----------------------check_connections_block total spend ----------------------------- 0.023390769958496094
generate_one_block  0.0031490325927734375
generate_one_block  0.0027899742126464844
generate_one_block  0.002492666244506836
generate_one_block  0.002938985824584961
generate_one_block  0.0024840831756591797
generate_one_block  0.0032591819763183594
generate_one_block  0.0027723312377929688
generate_one_block  0.0023632049560546875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007622241973876953
gen group dst list time:  0.00036215782165527344
time for parepare:  0.0001995563507080078
local_output_nid generation:  0.0001342296600341797
local_in_edges_tensor generation:  0.0004284381866455078
mini_batch_src_global generation:  0.0002593994140625
r_  generation:  0.002839803695678711
local_output_nid generation:  0.00013828277587890625
local_in_edges_tensor generation:  0.0003254413604736328
mini_batch_src_global generation:  0.0002911090850830078
r_  generation:  0.0026586055755615234
local_output_nid generation:  0.00012230873107910156
local_in_edges_tensor generation:  0.00029850006103515625
mini_batch_src_global generation:  0.00023746490478515625
r_  generation:  0.0024573802947998047
local_output_nid generation:  0.00013709068298339844
local_in_edges_tensor generation:  0.00033855438232421875
mini_batch_src_global generation:  0.00023508071899414062
r_  generation:  0.002810239791870117
local_output_nid generation:  0.00013446807861328125
local_in_edges_tensor generation:  0.00030112266540527344
mini_batch_src_global generation:  0.0002238750457763672
r_  generation:  0.0025033950805664062
local_output_nid generation:  0.0001475811004638672
local_in_edges_tensor generation:  0.0003561973571777344
mini_batch_src_global generation:  0.00025010108947753906
r_  generation:  0.002740621566772461
local_output_nid generation:  0.00012302398681640625
local_in_edges_tensor generation:  0.0002961158752441406
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.0023937225341796875
local_output_nid generation:  9.965896606445312e-05
local_in_edges_tensor generation:  0.0002532005310058594
mini_batch_src_global generation:  0.00018787384033203125
r_  generation:  0.001972198486328125
----------------------check_connections_block total spend ----------------------------- 0.03107452392578125
generate_one_block  0.003925323486328125
generate_one_block  0.004099130630493164
generate_one_block  0.0034477710723876953
generate_one_block  0.003725767135620117
generate_one_block  0.003472566604614258
generate_one_block  0.0039052963256835938
generate_one_block  0.00360870361328125
generate_one_block  0.0031936168670654297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007791519165039062
gen group dst list time:  0.00044536590576171875
time for parepare:  0.000202178955078125
local_output_nid generation:  0.0001614093780517578
local_in_edges_tensor generation:  0.0004811286926269531
mini_batch_src_global generation:  0.0002713203430175781
r_  generation:  0.0032563209533691406
local_output_nid generation:  0.0001685619354248047
local_in_edges_tensor generation:  0.0003685951232910156
mini_batch_src_global generation:  0.0003209114074707031
r_  generation:  0.0031266212463378906
local_output_nid generation:  0.0001659393310546875
local_in_edges_tensor generation:  0.0003566741943359375
mini_batch_src_global generation:  0.0002636909484863281
r_  generation:  0.003106355667114258
local_output_nid generation:  0.000171661376953125
local_in_edges_tensor generation:  0.0003781318664550781
mini_batch_src_global generation:  0.0002689361572265625
r_  generation:  0.003312349319458008
local_output_nid generation:  0.00016832351684570312
local_in_edges_tensor generation:  0.0003609657287597656
mini_batch_src_global generation:  0.00026416778564453125
r_  generation:  0.003087282180786133
local_output_nid generation:  0.0001647472381591797
local_in_edges_tensor generation:  0.00035643577575683594
mini_batch_src_global generation:  0.0002560615539550781
r_  generation:  0.0029931068420410156
local_output_nid generation:  0.00014781951904296875
local_in_edges_tensor generation:  0.000324249267578125
mini_batch_src_global generation:  0.00024008750915527344
r_  generation:  0.002803325653076172
local_output_nid generation:  0.00013875961303710938
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  0.00022649765014648438
r_  generation:  0.0025870800018310547
----------------------check_connections_block total spend ----------------------------- 0.03630328178405762
generate_one_block  0.004551887512207031
generate_one_block  0.003971099853515625
generate_one_block  0.00397181510925293
generate_one_block  0.004113197326660156
generate_one_block  0.0039865970611572266
generate_one_block  0.004108905792236328
generate_one_block  0.003997325897216797
generate_one_block  0.003794431686401367
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.07706785202026367  GigaBytes
Max Memory Allocated: 0.07706785202026367  GigaBytes

connection checking time:  0.1082000732421875
block generation total time  0.11037516593933105
average batch blocks generation time:  0.013796895742416382
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09028100967407227  GigaBytes
Max Memory Allocated: 0.09028100967407227  GigaBytes

torch.Size([2437, 1433])
torch.Size([2290, 256])
torch.Size([1892, 256])
torch.Size([1173, 256])
torch.Size([514, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 1.188338279724121  GigaBytes
Max Memory Allocated: 1.1884760856628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.16645097732543945  GigaBytes
Max Memory Allocated: 1.19232177734375  GigaBytes

torch.Size([2370, 1433])
torch.Size([2183, 256])
torch.Size([1761, 256])
torch.Size([1059, 256])
torch.Size([392, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5623779296875 GB
    Memory Allocated: 1.2060785293579102  GigaBytes
Max Memory Allocated: 1.206191062927246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5936279296875 GB
    Memory Allocated: 0.16636419296264648  GigaBytes
Max Memory Allocated: 1.209886074066162  GigaBytes

torch.Size([2358, 1433])
torch.Size([2132, 256])
torch.Size([1564, 256])
torch.Size([743, 256])
torch.Size([279, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5936279296875 GB
    Memory Allocated: 1.1529841423034668  GigaBytes
Max Memory Allocated: 1.209886074066162  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5936279296875 GB
    Memory Allocated: 0.1674795150756836  GigaBytes
Max Memory Allocated: 1.209886074066162  GigaBytes

torch.Size([2462, 1433])
torch.Size([2318, 256])
torch.Size([1860, 256])
torch.Size([1139, 256])
torch.Size([438, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6444091796875 GB
    Memory Allocated: 1.2671160697937012  GigaBytes
Max Memory Allocated: 1.2672524452209473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6463623046875 GB
    Memory Allocated: 0.16745281219482422  GigaBytes
Max Memory Allocated: 1.270904541015625  GigaBytes

torch.Size([2393, 1433])
torch.Size([2154, 256])
torch.Size([1603, 256])
torch.Size([838, 256])
torch.Size([254, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6463623046875 GB
    Memory Allocated: 1.1721343994140625  GigaBytes
Max Memory Allocated: 1.270904541015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6463623046875 GB
    Memory Allocated: 0.16750049591064453  GigaBytes
Max Memory Allocated: 1.270904541015625  GigaBytes

torch.Size([2425, 1433])
torch.Size([2329, 256])
torch.Size([2043, 256])
torch.Size([1373, 256])
torch.Size([607, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 1.315701961517334  GigaBytes
Max Memory Allocated: 1.3158421516418457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6697998046875 GB
    Memory Allocated: 0.16639137268066406  GigaBytes
Max Memory Allocated: 1.319488525390625  GigaBytes

torch.Size([2359, 1433])
torch.Size([2185, 256])
torch.Size([1752, 256])
torch.Size([1067, 256])
torch.Size([381, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6697998046875 GB
    Memory Allocated: 1.206559658050537  GigaBytes
Max Memory Allocated: 1.319488525390625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6697998046875 GB
    Memory Allocated: 0.16614770889282227  GigaBytes
Max Memory Allocated: 1.319488525390625  GigaBytes

torch.Size([2260, 1433])
torch.Size([1964, 256])
torch.Size([1401, 256])
torch.Size([755, 256])
torch.Size([326, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6697998046875 GB
    Memory Allocated: 1.1047697067260742  GigaBytes
Max Memory Allocated: 1.319488525390625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061662375926971436 |0.04317164421081543 |0.3443925082683563 |0.00013723969459533691 |0.3969733417034149 |0.022004365921020508 |
----------------------------------------------------------pseudo_mini_loss sum 3.134477376937866
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  62586
Number of first layer input nodes during this epoch:  19064
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.31990575790405273  GigaBytes
Max Memory Allocated: 1.319488525390625  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007388591766357422
random selection method range initialization spend 0.00015234947204589844
time for parepare:  8.58306884765625e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.316734313964844e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.9114227294921875e-05
----------------------check_connections_block total spend ----------------------------- 0.002077341079711914
generate_one_block  0.001262664794921875
generate_one_block  0.0011277198791503906
generate_one_block  0.0011425018310546875
generate_one_block  0.0011205673217773438
generate_one_block  0.001112222671508789
generate_one_block  0.001089334487915039
generate_one_block  0.0010998249053955078
generate_one_block  0.0011124610900878906
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005476474761962891
gen group dst list time:  6.556510925292969e-05
time for parepare:  0.00020766258239746094
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00020956993103027344
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00022268295288085938
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00023245811462402344
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0003840923309326172
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00027370452880859375
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.00023984909057617188
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00022745132446289062
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00023126602172851562
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00025725364685058594
----------------------check_connections_block total spend ----------------------------- 0.004720449447631836
generate_one_block  0.0015025138854980469
generate_one_block  0.001367807388305664
generate_one_block  0.0015478134155273438
generate_one_block  0.0014247894287109375
generate_one_block  0.0013568401336669922
generate_one_block  0.0013318061828613281
generate_one_block  0.0013298988342285156
generate_one_block  0.0013318061828613281
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007159709930419922
gen group dst list time:  0.0001201629638671875
time for parepare:  0.00024390220642089844
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00028228759765625
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.0007126331329345703
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  0.0001308917999267578
r_  generation:  0.0007643699645996094
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00021648406982421875
mini_batch_src_global generation:  0.0001678466796875
r_  generation:  0.001249551773071289
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.00012636184692382812
r_  generation:  0.0008728504180908203
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0007548332214355469
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  0.00010132789611816406
r_  generation:  0.0007650852203369141
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  0.00010371208190917969
r_  generation:  0.0007102489471435547
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.0001049041748046875
r_  generation:  0.0008363723754882812
----------------------check_connections_block total spend ----------------------------- 0.011831045150756836
generate_one_block  0.0020203590393066406
generate_one_block  0.0019791126251220703
generate_one_block  0.002424001693725586
generate_one_block  0.002028942108154297
generate_one_block  0.001886606216430664
generate_one_block  0.0019974708557128906
generate_one_block  0.001819610595703125
generate_one_block  0.001993417739868164
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007305145263671875
gen group dst list time:  0.0002243518829345703
time for parepare:  0.0002117156982421875
local_output_nid generation:  8.893013000488281e-05
local_in_edges_tensor generation:  0.0003676414489746094
mini_batch_src_global generation:  0.00019693374633789062
r_  generation:  0.0016872882843017578
local_output_nid generation:  9.083747863769531e-05
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  0.000244140625
r_  generation:  0.0017976760864257812
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.0002923011779785156
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.0022792816162109375
local_output_nid generation:  0.00010633468627929688
local_in_edges_tensor generation:  0.0002684593200683594
mini_batch_src_global generation:  0.000209808349609375
r_  generation:  0.0019466876983642578
local_output_nid generation:  8.96453857421875e-05
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  0.00017189979553222656
r_  generation:  0.0017180442810058594
local_output_nid generation:  9.417533874511719e-05
local_in_edges_tensor generation:  0.00024509429931640625
mini_batch_src_global generation:  0.0001735687255859375
r_  generation:  0.0017905235290527344
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.0002384185791015625
mini_batch_src_global generation:  0.00017380714416503906
r_  generation:  0.0016372203826904297
local_output_nid generation:  9.965896606445312e-05
local_in_edges_tensor generation:  0.0002446174621582031
mini_batch_src_global generation:  0.00017404556274414062
r_  generation:  0.001859903335571289
----------------------check_connections_block total spend ----------------------------- 0.024072885513305664
generate_one_block  0.002938508987426758
generate_one_block  0.002958536148071289
generate_one_block  0.003419637680053711
generate_one_block  0.003117799758911133
generate_one_block  0.002867460250854492
generate_one_block  0.003031015396118164
generate_one_block  0.0028505325317382812
generate_one_block  0.0031533241271972656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007526874542236328
gen group dst list time:  0.0003807544708251953
time for parepare:  0.00021505355834960938
local_output_nid generation:  0.000148773193359375
local_in_edges_tensor generation:  0.0004448890686035156
mini_batch_src_global generation:  0.00025200843811035156
r_  generation:  0.0026450157165527344
local_output_nid generation:  0.00016379356384277344
local_in_edges_tensor generation:  0.0003390312194824219
mini_batch_src_global generation:  0.00030612945556640625
r_  generation:  0.002794504165649414
local_output_nid generation:  0.00018143653869628906
local_in_edges_tensor generation:  0.00035834312438964844
mini_batch_src_global generation:  0.00025200843811035156
r_  generation:  0.00307464599609375
local_output_nid generation:  0.0001671314239501953
local_in_edges_tensor generation:  0.00033926963806152344
mini_batch_src_global generation:  0.00024390220642089844
r_  generation:  0.0028619766235351562
local_output_nid generation:  0.0001595020294189453
local_in_edges_tensor generation:  0.00033211708068847656
mini_batch_src_global generation:  0.00024437904357910156
r_  generation:  0.002806425094604492
local_output_nid generation:  0.00016069412231445312
local_in_edges_tensor generation:  0.00032973289489746094
mini_batch_src_global generation:  0.00024008750915527344
r_  generation:  0.0026679039001464844
local_output_nid generation:  0.00014162063598632812
local_in_edges_tensor generation:  0.0003006458282470703
mini_batch_src_global generation:  0.0002162456512451172
r_  generation:  0.0024175643920898438
local_output_nid generation:  0.0001544952392578125
local_in_edges_tensor generation:  0.0003123283386230469
mini_batch_src_global generation:  0.00022840499877929688
r_  generation:  0.0026395320892333984
----------------------check_connections_block total spend ----------------------------- 0.03328680992126465
generate_one_block  0.0039691925048828125
generate_one_block  0.004224300384521484
generate_one_block  0.004258632659912109
generate_one_block  0.004016876220703125
generate_one_block  0.0039026737213134766
generate_one_block  0.003820180892944336
generate_one_block  0.003771066665649414
generate_one_block  0.004052877426147461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007779598236083984
gen group dst list time:  0.0004832744598388672
time for parepare:  0.00021338462829589844
local_output_nid generation:  0.0001862049102783203
local_in_edges_tensor generation:  0.00049591064453125
mini_batch_src_global generation:  0.0002593994140625
r_  generation:  0.0031702518463134766
local_output_nid generation:  0.00020360946655273438
local_in_edges_tensor generation:  0.00038170814514160156
mini_batch_src_global generation:  0.0003261566162109375
r_  generation:  0.0032341480255126953
local_output_nid generation:  0.0002079010009765625
local_in_edges_tensor generation:  0.00039315223693847656
mini_batch_src_global generation:  0.000301361083984375
r_  generation:  0.0033686161041259766
local_output_nid generation:  0.00020360946655273438
local_in_edges_tensor generation:  0.0003771781921386719
mini_batch_src_global generation:  0.00026988983154296875
r_  generation:  0.0032711029052734375
local_output_nid generation:  0.00020194053649902344
local_in_edges_tensor generation:  0.0003879070281982422
mini_batch_src_global generation:  0.000263214111328125
r_  generation:  0.0031774044036865234
local_output_nid generation:  0.00018262863159179688
local_in_edges_tensor generation:  0.0003380775451660156
mini_batch_src_global generation:  0.00024008750915527344
r_  generation:  0.002858877182006836
local_output_nid generation:  0.00017499923706054688
local_in_edges_tensor generation: Using backend: pytorch
 0.0003325939178466797
mini_batch_src_global generation:  0.0002460479736328125
r_  generation:  0.002923250198364258
local_output_nid generation:  0.000186920166015625
local_in_edges_tensor generation:  0.0003445148468017578
mini_batch_src_global generation:  0.0002503395080566406
r_  generation:  0.0030183792114257812
----------------------check_connections_block total spend ----------------------------- 0.03755593299865723
generate_one_block  0.004380702972412109
generate_one_block  0.00426483154296875
generate_one_block  0.004911184310913086
generate_one_block  0.0042607784271240234
generate_one_block  0.004253387451171875
generate_one_block  0.004160642623901367
generate_one_block  0.0045318603515625
generate_one_block  0.004327058792114258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.31990575790405273  GigaBytes
Max Memory Allocated: 1.319488525390625  GigaBytes

connection checking time:  0.11146712303161621
block generation total time  0.11878585815429688
average batch blocks generation time:  0.01484823226928711
block dataloader generation time/epoch 0.3394308090209961
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.3197450637817383  GigaBytes
Max Memory Allocated: 1.319488525390625  GigaBytes

torch.Size([2340, 1433])
torch.Size([2137, 256])
torch.Size([1659, 256])
torch.Size([952, 256])
torch.Size([339, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.3419828414916992  GigaBytes
Max Memory Allocated: 1.3421010971069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.32093143463134766  GigaBytes
Max Memory Allocated: 1.3457860946655273  GigaBytes

torch.Size([2410, 1433])
torch.Size([2212, 256])
torch.Size([1789, 256])
torch.Size([1003, 256])
torch.Size([381, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.3658843040466309  GigaBytes
Max Memory Allocated: 1.3659892082214355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.3209648132324219  GigaBytes
Max Memory Allocated: 1.369699478149414  GigaBytes

torch.Size([2417, 1433])
torch.Size([2317, 256])
torch.Size([2020, 256])
torch.Size([1396, 256])
torch.Size([643, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.4641361236572266  GigaBytes
Max Memory Allocated: 1.4642887115478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 0.3209409713745117  GigaBytes
Max Memory Allocated: 1.467909336090088  GigaBytes

torch.Size([2392, 1433])
torch.Size([2242, 256])
torch.Size([1857, 256])
torch.Size([1134, 256])
torch.Size([460, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 1.3920750617980957  GigaBytes
Max Memory Allocated: 1.467909336090088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 0.32093048095703125  GigaBytes
Max Memory Allocated: 1.467909336090088  GigaBytes

torch.Size([2402, 1433])
torch.Size([2245, 256])
torch.Size([1784, 256])
torch.Size([974, 256])
torch.Size([378, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 1.3753399848937988  GigaBytes
Max Memory Allocated: 1.467909336090088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 0.319732666015625  GigaBytes
Max Memory Allocated: 1.467909336090088  GigaBytes

torch.Size([2337, 1433])
torch.Size([2173, 256])
torch.Size([1760, 256])
torch.Size([1009, 256])
torch.Size([393, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 1.3471312522888184  GigaBytes
Max Memory Allocated: 1.467909336090088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 0.3209266662597656  GigaBytes
Max Memory Allocated: 1.467909336090088  GigaBytes

torch.Size([2381, 1433])
torch.Size([2164, 256])
torch.Size([1696, 256])
torch.Size([956, 256])
torch.Size([364, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 1.3526926040649414  GigaBytes
Max Memory Allocated: 1.467909336090088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 0.32094383239746094  GigaBytes
Max Memory Allocated: 1.467909336090088  GigaBytes

torch.Size([2440, 1433])
torch.Size([2311, 256])
torch.Size([1908, 256])
torch.Size([1174, 256])
torch.Size([438, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 1.4278812408447266  GigaBytes
Max Memory Allocated: 1.467909336090088  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.062019914388656616 |0.0015634894371032715 |0.2880502939224243 |0.000125885009765625 |0.39807257056236267 |0.016858339309692383 |
----------------------------------------------------------pseudo_mini_loss sum 3.5037682056427
Total (block generation + training)time/epoch 6.4247095584869385
Training time/epoch 6.08498215675354
Training time without block to device /epoch 6.072474241256714
Training time without total dataloading part /epoch 5.506848335266113
load block tensor time/epoch 0.49615931510925293
block to device time/epoch 0.012507915496826172
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64149
Number of first layer input nodes during this epoch:  19119
