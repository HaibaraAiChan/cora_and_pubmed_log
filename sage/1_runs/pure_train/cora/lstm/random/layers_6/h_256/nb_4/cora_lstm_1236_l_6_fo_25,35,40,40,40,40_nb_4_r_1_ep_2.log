main start at this time 1648433837.9383266
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.07706785202026367  GigaBytes
Max Memory Allocated: 0.07706785202026367  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0009930133819580078
random selection method range initialization spend 0.0001659393310546875
time for parepare:  6.175041198730469e-05
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.001283407211303711
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  6.4849853515625e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.128715515136719e-05
----------------------check_connections_block total spend ----------------------------- 0.0024895668029785156
generate_one_block  0.0012316703796386719
generate_one_block  0.001027822494506836
generate_one_block  0.0010063648223876953
generate_one_block  0.0010824203491210938
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00046324729919433594
gen group dst list time:  3.814697265625e-05
time for parepare:  0.00013327598571777344
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0004169940948486328
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.00034928321838378906
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.00036787986755371094
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00043773651123046875
----------------------check_connections_block total spend ----------------------------- 0.0030393600463867188
generate_one_block  0.001493692398071289
generate_one_block  0.0013575553894042969
generate_one_block  0.0014872550964355469
generate_one_block  0.0014276504516601562
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005555152893066406
gen group dst list time:  7.581710815429688e-05
time for parepare:  0.00016689300537109375
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00029778480529785156
mini_batch_src_global generation:  0.000156402587890625
r_  generation:  0.001291036605834961
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.00012230873107910156
r_  generation:  0.0010352134704589844
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.00011920928955078125
r_  generation:  0.0011928081512451172
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.0011458396911621094
----------------------check_connections_block total spend ----------------------------- 0.00761723518371582
generate_one_block  0.0025222301483154297
generate_one_block  0.0021767616271972656
generate_one_block  0.002296924591064453
generate_one_block  0.002277374267578125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007474422454833984
gen group dst list time:  0.000125885009765625
time for parepare:  0.00017380714416503906
local_output_nid generation:  9.72747802734375e-05
local_in_edges_tensor generation:  0.0003743171691894531
mini_batch_src_global generation:  0.00017309188842773438
r_  generation:  0.0023403167724609375
local_output_nid generation:  9.5367431640625e-05
local_in_edges_tensor generation:  0.00026702880859375
mini_batch_src_global generation:  0.00023818016052246094
r_  generation:  0.0020935535430908203
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.0002665519714355469
mini_batch_src_global generation:  0.0001938343048095703
r_  generation:  0.002213716506958008
local_output_nid generation:  0.00010156631469726562
local_in_edges_tensor generation:  0.00026917457580566406
mini_batch_src_global generation:  0.0001933574676513672
r_  generation:  0.0020160675048828125
----------------------check_connections_block total spend ----------------------------- 0.013352155685424805
generate_one_block  0.0036661624908447266
generate_one_block  0.003229379653930664
generate_one_block  0.003366708755493164
generate_one_block  0.0032432079315185547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008180141448974609
gen group dst list time:  0.00018095970153808594
time for parepare:  0.0001823902130126953
local_output_nid generation:  0.00013208389282226562
local_in_edges_tensor generation:  0.0004715919494628906
mini_batch_src_global generation:  0.00028014183044433594
r_  generation:  0.0028018951416015625
local_output_nid generation:  0.00013780593872070312
local_in_edges_tensor generation:  0.00036334991455078125
mini_batch_src_global generation:  0.00031065940856933594
r_  generation:  0.002754688262939453
local_output_nid generation:  0.00016927719116210938
local_in_edges_tensor generation:  0.0003399848937988281
mini_batch_src_global generation:  0.0002636909484863281
r_  generation:  0.002855539321899414
local_output_nid generation:  0.00013947486877441406
local_in_edges_tensor generation:  0.00032782554626464844
mini_batch_src_global generation:  0.0002410411834716797
r_  generation:  0.0026772022247314453
----------------------check_connections_block total spend ----------------------------- 0.0171353816986084
generate_one_block  0.004086017608642578
generate_one_block  0.0040128231048583984
generate_one_block  0.003967761993408203
generate_one_block  0.0038290023803710938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007786750793457031
gen group dst list time:  0.00020885467529296875
time for parepare:  0.0001766681671142578
local_output_nid generation:  0.0001475811004638672
local_in_edges_tensor generation:  0.0006053447723388672
mini_batch_src_global generation:  0.00021982192993164062
r_  generation:  0.003087282180786133
local_output_nid generation:  0.00015401840209960938
local_in_edges_tensor generation:  0.0003578662872314453
mini_batch_src_global generation:  0.00027298927307128906
r_  generation:  0.0030663013458251953
local_output_nid generation:  0.00015735626220703125
local_in_edges_tensor generation:  0.0003764629364013672
mini_batch_src_global generation:  0.00026226043701171875
r_  generation:  0.003076314926147461
local_output_nid generation:  0.0001595020294189453
local_in_edges_tensor generation:  0.0003592967987060547
mini_batch_src_global generation:  0.00026726722717285156
r_  generation:  0.0029447078704833984
----------------------check_connections_block total spend ----------------------------- 0.018541574478149414
generate_one_block  0.004208803176879883
generate_one_block  0.004154682159423828
generate_one_block  0.004159450531005859
generate_one_block  0.004037380218505859
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.07706785202026367  GigaBytes
Max Memory Allocated: 0.07706785202026367  GigaBytes

connection checking time:  0.059685707092285156
block generation total time  0.061000823974609375
average batch blocks generation time:  0.015250205993652344
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09053611755371094  GigaBytes
Max Memory Allocated: 0.09053611755371094  GigaBytes

torch.Size([2478, 1433])
torch.Size([2386, 256])
torch.Size([2143, 256])
torch.Size([1585, 256])
torch.Size([819, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4862060546875 GB
    Memory Allocated: 1.2907590866088867  GigaBytes
Max Memory Allocated: 1.290998935699463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6033935546875 GB
    Memory Allocated: 0.16807985305786133  GigaBytes
Max Memory Allocated: 1.294477939605713  GigaBytes

torch.Size([2454, 1433])
torch.Size([2358, 256])
torch.Size([2090, 256])
torch.Size([1414, 256])
torch.Size([640, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6561279296875 GB
    Memory Allocated: 1.334867000579834  GigaBytes
Max Memory Allocated: 1.3350820541381836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6873779296875 GB
    Memory Allocated: 0.16808748245239258  GigaBytes
Max Memory Allocated: 1.3386006355285645  GigaBytes

torch.Size([2458, 1433])
torch.Size([2390, 256])
torch.Size([2128, 256])
torch.Size([1515, 256])
torch.Size([704, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6971435546875 GB
    Memory Allocated: 1.353541374206543  GigaBytes
Max Memory Allocated: 1.353745937347412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7010498046875 GB
    Memory Allocated: 0.16808176040649414  GigaBytes
Max Memory Allocated: 1.3572807312011719  GigaBytes

torch.Size([2382, 1433])
torch.Size([2278, 256])
torch.Size([2004, 256])
torch.Size([1431, 256])
torch.Size([724, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.303098201751709  GigaBytes
Max Memory Allocated: 1.3572807312011719  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05773961544036865 |0.08564597368240356 |0.4291872978210449 |0.00016510486602783203 |0.4483550786972046 |0.01279139518737793 |
----------------------------------------------------------pseudo_mini_loss sum 3.2125601768493652
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37117
Number of first layer input nodes during this epoch:  9772
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.8338623046875 GB
    Memory Allocated: 0.3219771385192871  GigaBytes
Max Memory Allocated: 1.3572807312011719  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006046295166015625
random selection method range initialization spend 0.0001552104949951172
time for parepare:  8.702278137207031e-05
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  9.1552734375e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  7.224082946777344e-05
----------------------check_connections_block total spend ----------------------------- 0.0013854503631591797
generate_one_block  0.0012869834899902344
generate_one_block  0.001140594482421875
generate_one_block  0.0011000633239746094
generate_one_block  0.0011219978332519531
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005407333374023438
gen group dst list time:  5.269050598144531e-05
time for parepare:  0.00017571449279785156
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00022101402282714844
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.00035500526428222656
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.00048732757568359375
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.00037479400634765625
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.00043320655822753906
----------------------check_connections_block total spend ----------------------------- 0.003442049026489258
generate_one_block  0.00154876708984375
generate_one_block  0.001691579818725586
generate_one_block  0.0015246868133544922
generate_one_block  0.0015811920166015625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005879402160644531
gen group dst list time:  8.416175842285156e-05
time for parepare:  0.00020647048950195312
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.000316619873046875
mini_batch_src_global generation:  0.00014829635620117188
r_  generation:  0.0010402202606201172
local_output_nid generation:  7.915496826171875e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.0001995563507080078
r_  generation:  0.0014100074768066406
local_output_nid generation:  6.842613220214844e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  0.00013971328735351562
r_  generation:  0.001142740249633789
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0012736320495605469
----------------------check_connections_block total spend ----------------------------- 0.008243083953857422
generate_one_block  0.0023844242095947266
generate_one_block  0.002735137939453125
generate_one_block  0.0023336410522460938
generate_one_block  0.002641916275024414
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007712841033935547
gen group dst list time:  0.00014734268188476562
time for parepare:  0.00019359588623046875
local_output_nid generation:  0.000118255615234375
local_in_edges_tensor generation:  0.00038361549377441406
mini_batch_src_global generation:  0.00020456314086914062
r_  generation:  0.002135753631591797
local_output_nid generation:  0.000148773193359375
local_in_edges_tensor generation:  0.0003058910369873047
mini_batch_src_global generation:  0.0002899169921875
r_  generation:  0.0024552345275878906
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.0002827644348144531Using backend: pytorch

mini_batch_src_global generation:  0.00021338462829589844
r_  generation:  0.002275705337524414
local_output_nid generation:  0.00014019012451171875
local_in_edges_tensor generation:  0.00030493736267089844
mini_batch_src_global generation:  0.00022029876708984375
r_  generation:  0.002511739730834961
----------------------check_connections_block total spend ----------------------------- 0.014647483825683594
generate_one_block  0.003574848175048828
generate_one_block  0.0036814212799072266
generate_one_block  0.0034897327423095703
generate_one_block  0.0037457942962646484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007989406585693359
gen group dst list time:  0.00020766258239746094
time for parepare:  0.00019884109497070312
local_output_nid generation:  0.0001666545867919922
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.000202178955078125
r_  generation:  0.002917051315307617
local_output_nid generation:  0.0001690387725830078
local_in_edges_tensor generation:  0.00037026405334472656
mini_batch_src_global generation:  0.0003256797790527344
r_  generation:  0.0030252933502197266
local_output_nid generation:  0.00017404556274414062
local_in_edges_tensor generation:  0.0003600120544433594
mini_batch_src_global generation:  0.00025725364685058594
r_  generation:  0.003001689910888672
local_output_nid generation:  0.00018310546875
local_in_edges_tensor generation:  0.0003676414489746094
mini_batch_src_global generation:  0.0002689361572265625
r_  generation:  0.00310516357421875
----------------------check_connections_block total spend ----------------------------- 0.0183413028717041
generate_one_block  0.004333019256591797
generate_one_block  0.004221200942993164
generate_one_block  0.004156589508056641
generate_one_block  0.004297733306884766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008103847503662109
gen group dst list time:  0.0002281665802001953
time for parepare:  0.0001990795135498047
local_output_nid generation:  0.00019025802612304688
local_in_edges_tensor generation:  0.0005137920379638672
mini_batch_src_global generation:  0.00023674964904785156
r_  generation:  0.003220081329345703
local_output_nid generation:  0.00018739700317382812
local_in_edges_tensor generation:  0.0003733634948730469
mini_batch_src_global generation:  0.0003085136413574219
r_  generation:  0.003190755844116211
local_output_nid generation:  0.0001914501190185547
local_in_edges_tensor generation:  0.00036644935607910156
mini_batch_src_global generation:  0.0003285408020019531
r_  generation:  0.003188610076904297
local_output_nid generation:  0.00018978118896484375
local_in_edges_tensor generation:  0.0003762245178222656
mini_batch_src_global generation:  0.00026535987854003906
r_  generation:  0.003269195556640625
----------------------check_connections_block total spend ----------------------------- 0.019376277923583984
generate_one_block  0.005315303802490234
generate_one_block  0.004340171813964844
generate_one_block  0.0042989253997802734
generate_one_block  0.0046405792236328125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.8338623046875 GB
    Memory Allocated: 0.3219771385192871  GigaBytes
Max Memory Allocated: 1.3572807312011719  GigaBytes

connection checking time:  0.06405019760131836
block generation total time  0.06653666496276855
average batch blocks generation time:  0.01663416624069214
block dataloader generation time/epoch 0.20525598526000977
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8338623046875 GB
    Memory Allocated: 0.3215365409851074  GigaBytes
Max Memory Allocated: 1.3572807312011719  GigaBytes

torch.Size([2452, 1433])
torch.Size([2334, 256])
torch.Size([2033, 256])
torch.Size([1342, 256])
torch.Size([579, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8846435546875 GB
    Memory Allocated: 1.4702019691467285  GigaBytes
Max Memory Allocated: 1.470412254333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8865966796875 GB
    Memory Allocated: 0.32155656814575195  GigaBytes
Max Memory Allocated: 1.4739389419555664  GigaBytes

torch.Size([2451, 1433])
torch.Size([2365, 256])
torch.Size([2137, 256])
torch.Size([1632, 256])
torch.Size([803, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9080810546875 GB
    Memory Allocated: 1.5210599899291992  GigaBytes
Max Memory Allocated: 1.521315097808838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9119873046875 GB
    Memory Allocated: 0.32154417037963867  GigaBytes
Max Memory Allocated: 1.524759292602539  GigaBytes

torch.Size([2445, 1433])
torch.Size([2364, 256])
torch.Size([2126, 256])
torch.Size([1420, 256])
torch.Size([646, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9119873046875 GB
    Memory Allocated: 1.4931635856628418  GigaBytes
Max Memory Allocated: 1.524759292602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9119873046875 GB
    Memory Allocated: 0.32155942916870117  GigaBytes
Max Memory Allocated: 1.524759292602539  GigaBytes

torch.Size([2497, 1433])
torch.Size([2433, 256])
torch.Size([2226, 256])
torch.Size([1641, 256])
torch.Size([743, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5287833213806152  GigaBytes
Max Memory Allocated: 1.5290288925170898  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05543941259384155 |0.0012137293815612793 |0.3072316646575928 |0.00013118982315063477 |0.43573713302612305 |0.01690983772277832 |
----------------------------------------------------------pseudo_mini_loss sum 3.05230712890625
Total (block generation + training)time/epoch 3.487178325653076
Training time/epoch 3.281628370285034
Training time without block to device /epoch 3.276773452758789
Training time without total dataloading part /epoch 2.989309787750244
load block tensor time/epoch 0.2217576503753662
block to device time/epoch 0.004854917526245117
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37404
Number of first layer input nodes during this epoch:  9845
